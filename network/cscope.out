cscope 15 $HOME/ali/container/container_network -q 0000020932 0002646690
	@code/iptable.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	~<sys/ty³s.h
>

13 
	~<sys/sock‘.h
>

15 
	~<Ãtš‘/š.h
>

16 
	~"bË.h
"

17 
	#DEFAULT_CMD_SIZE
 128

	)

19 *
	$dÇt_make_cmd
(
dÇt_ruË
 *
ruË
)

21 *
cmd
;

22 *
c
;

23 
c
 = 
	`š‘_Áß
(
ruË
->
addr
);

24 if(!
c
)

25  
NULL
;

26 
cmd
 = (*)
	`ÿÎoc
(
DEFAULT_CMD_SIZE
, ());

27 if(!
cmd
)

28  
NULL
;

29 if(
ruË
->
´Ùo
 =ğ
PROTO_TCP
)

30 
	`¥rštf
(
cmd
," PREROUTING -pcp --dport %d -j DNAT --to-destination %s:%d",

31 
ruË
->
dpÜt
, 
c
,„uË->
ıÜt
);

32 if(
ruË
->
´Ùo
 =ğ
PROTO_UDP
)

33 
	`¥rštf
(
cmd
," PREROUTING -p udp --dport %d -j DNAT --to-destination %s:%d",

34 
ruË
->
dpÜt
, 
c
,„uË->
ıÜt
);

36  
cmd
;

37 
	}
}

39 *
	$¢©_make_cmd
(
¢©_ruË
 *
ruË
)

41 *
cmd
;

42 *
s
;

45 if(!
ruË
->
š‹rçû
 || (ruË->
´efix
 < 0 ||„ule->prefix > 32))

46  
NULL
;

47 
cmd
 = (*)
	`ÿÎoc
(
DEFAULT_CMD_SIZE
, ());

48 if(!
cmd
)

49  
NULL
;

50 
s
 = 
	`š‘_Áß
(
ruË
->
addr
);

51 
	`¥rštf
(
cmd
," POSTROUTING -s %s/%d -o %s -j MASQUERADE",

52 
s
, 
ruË
->
´efix
,„uË->
š‹rçû
);

53  
cmd
;

54 
	}
}

57 
	$dÇt_ruË_£t
(
dÇt_ruË
 *
ruË
)

59 
»t
;

60 *
d©a
;

61 
cmd
[
DEFAULT_CMD_SIZE
]={0};

62 if(!
ruË
)

64 
d©a
 = 
	`dÇt_make_cmd
(
ruË
);

65 if(!
d©a
)

67 
	`¥rštf
(
cmd
,"bË -ˆÇˆ-A %s", 
d©a
);

68 
»t
 = 
	`sy¡em
(
cmd
);

69 if(
»t
 > 0)

71 
ruË
->
cmd
 = 
d©a
;

72 
ruË
->
cmd_Ën
 = 
	`¡¾’
(
d©a
);

76 
	}
}

78 
	$¢©_ruË_£t
(
¢©_ruË
 * 
ruË
)

80 
»t
;

81 *
d©a
;

82 
cmd
[
DEFAULT_CMD_SIZE
]={0};

83 if(!
ruË
)

85 
d©a
 = 
	`¢©_make_cmd
(
ruË
);

86 if(!
d©a
)

88 
	`¥rštf
(
cmd
,"bË -ˆÇˆ-A %s", 
d©a
);

89 
»t
 = 
	`sy¡em
(
cmd
);

90 if(
»t
 > 0)

92 
ruË
->
cmd
 = 
d©a
;

93 
ruË
->
cmd_Ën
 = 
	`¡¾’
(
d©a
);

97 
	}
}

99 
	$Çt_ruË_d–
(cÚ¡ * 
cmd_d©a
)

101 
»t
;

102 
cmd
[
DEFAULT_CMD_SIZE
]={0};

103 if(!
cmd_d©a
)

105 
	`¥rštf
(
cmd
, "bË -ˆÇˆ-D %s",
cmd_d©a
);

106 
»t
 = 
	`sy¡em
(
cmd
);

107  
»t
;

108 
	}
}

	@code/iptable.h

7 #iâdeà
MATRIX_INTERFACE_H


8 
	#MATRIX_INTERFACE_H


	)

9 
	~<¬·/š‘.h
>

10 
	eÃt_´Ùo


12 
	mPROTO_TCP
 =0,

13 
	mPROTO_UDP


14 }
	tÃt_´Ùo
;

15 
	sdÇt_ruË


17 
Ãt_´Ùo
 
	m´Ùo
;

18 
	mdpÜt
;

19 
š_addr
 
	maddr
;

20 
	mıÜt
;

21 *
	mcmd
;

22 
	mcmd_Ën
;

23 }
	tdÇt_ruË
;

25 
	s¢©_ruË


27 cÚ¡ * 
	mš‹rçû
;

28 
	m´efix
;

29 
š_addr
 
	maddr
;

30 *
	mcmd
;

31 
	mcmd_Ën
;

32 }
	t¢©_ruË
;

34 
dÇt_ruË_£t
(
dÇt_ruË
 *
ruË
);

35 
¢©_ruË_£t
(
¢©_ruË
 * 
ruË
);

36 
Çt_ruË_d–
(cÚ¡ * 
cmd_d©a
);

	@code/main.c

7 
	#_GNU_SOURCE


	)

8 
	~<sys/ty³s.h
>

9 
	~<sys/wa™.h
>

10 
	~<sys/mouÁ.h
>

11 
	~<sched.h
>

12 
	~<sigÇl.h
>

13 
	~<”ºo.h
>

14 
	~<¡dio.h
>

15 
	~<¡dlib.h
>

16 
	~<¡ršg.h
>

17 
	~<sys/sock‘.h
>

18 
	~<Ãtš‘/š.h
>

19 
	~<uni¡d.h
>

20 
	~<¬·/š‘.h
>

21 
	~"ÃtwÜk.h
"

22 
	~"bË.h
"

23 
	#STACK_SIZE
 (1024 * 10240)

	)

26 
	gcheckpošt
[2];

28 
	gchd_¡ack
[
STACK_SIZE
];

31 
	sÃtwÜk_·¿m


33 
	msock‘
;

34 
	m´efix
;

35 
š_addr
 
	maddr
;

36 
š_addr
 
	mbÿ¡
;

37 
š_addr
 
	mg©eway
;

38 cÚ¡ * 
	m‘h_Çme
;

39 }
	tÃtwÜk_·¿m
;

41 
	sm©_br


43 * 
	mÇme
;

44 
	m´efix
;

45 
š_addr
 
	maddr
;

46 
š_addr
 
	mbÿ¡
;

47 }
	tm©_br
;

49 
	$chd_maš
(* 
¬g
)

51 
buf
[10]= {0};

52 
pid
;

53 
ÃtwÜk_·¿m
 * 
·¿m
 = (ÃtwÜk_·¿m *)
¬g
;

55 
	`»ad
(
·¿m
->
sock‘
,
buf
,(buf));

56 if(
	`¡ºcmp
(
buf
, "network", 7) != 0)

58 
	`´štf
("get cmdƒrror\r\n");

59 
	`ex™
(0);

61 
	`ÃtwÜk_dev_up
("lo");

63 
	`v4_addr_add
(
·¿m
->
‘h_Çme
, &·¿m->
addr
, &·¿m->
bÿ¡
,…¬am->
´efix
);

64 
	`ÃtwÜk_dev_up
(
·¿m
->
‘h_Çme
);

67 
	`add_deçuÉ_rou‹
(&
·¿m
->
g©eway
);

69 
	`sy¡em
("ifconfig");

70 
	`sy¡em
("route");

71 
	`´štf
("child…rocess„un......\r\n");

72 
pid
 = 
	`fÜk
();

73 if(
pid
 < 0)

77 if(
pid
 == 0)

80 
	`exeş
("/bš/£rv”","£rv”", 
NULL
);

86 
	`»ad
(
·¿m
->
sock‘
,
buf
,(buf));

87 if(
	`¡ºcmp
(
buf
, "stop", 4) != 0)

89 
	`´štf
("getƒxitƒrror\r\n");

90 
	`ex™
(0);

96 
	}
}

98 
	$maš
(
¬gc
, * 
¬gv
[])

100 
pid
 = 0;

101 
buf
[10];

103 
sock‘s
[2];

104 
dÇt_ruË
 
dÇt
;

105 
¢©_ruË
 
¢©
;

108 
ÃtwÜk_·¿m
 
·¿m
;

109 
m©_br
 
br
;

111 
br
.
Çme
 = "test";

112 cÚ¡ * 
‘h
 = "e_i", * 
v‘h
 = "v_i";

114 
	`br_š™
();

115 
	`br_add_bridge
(
br
.
Çme
);

118 if(
	`š‘_©Ú
("172.16.0.1", &
br
.
addr
) == 0)

120 
	`´štf
("inet_atonƒrror\r\n");

122 if(
	`š‘_©Ú
("172.16.0.255", &
br
.
bÿ¡
) == 0)

124 
	`´štf
("inet_atonƒrror\r\n");

126 
br
.
´efix
 = 24;

127 
	`v4_addr_add
(
br
.
Çme
, &br.
addr
, &br.
bÿ¡
, br.
´efix
);

128 
	`ÃtwÜk_dev_up
(
br
.
Çme
);

131 
	`mem£t
(&
¢©
, 0, (snat));

132 
¢©
.
š‹rçû
 = "eth0";

133 
¢©
.
addr
 = 
br
.addr;

134 
¢©
.
´efix
 = 
br
.prefix;

135 
	`¢©_ruË_£t
(&
¢©
);

138 if(
	`ÃtwÜk_v‘h_ü—‹
(
‘h
, 
v‘h
) != 0)

141 
	`´štf
("create vethƒrror \r\n");

142 
”rÜ1
;

145 
	`ÃtwÜk_dev_up
(
‘h
);

148 
	`br_add_š‹rçû
(
br
.
Çme
, 
‘h
);

152 
·¿m
.
‘h_Çme
 = 
v‘h
;

153 
·¿m
.
g©eway
 = 
br
.
addr
;

154 
·¿m
.
bÿ¡
 = 
br
.bcast;

155 
·¿m
.
´efix
 = 
br
.prefix;

157 
	`š‘_©Ú
("172.16.0.2",&
·¿m
.
addr
);

158 ià(
	`sock‘·œ
(
AF_UNIX
, 
SOCK_STREAM
, 0, 
sock‘s
) < 0) {

159 
	`´štf
("”rÜ %d oÀsock‘·œ:% ", 
”ºo
, 
	`¡»¼Ü
(errno));

160 
”rÜ2
;

162 
·¿m
.
sock‘
 = 
sock‘s
[1];

164 
pid
 = 
	`şÚe
(
chd_maš
, 
chd_¡ack
+
STACK_SIZE
, 
CLONE_NEWUTS
 | 
CLONE_NEWIPC
 | 
CLONE_NEWPID
 | 
CLONE_NEWNS
 | 
CLONE_NEWNET
 | 
SIGCHLD
, &
·¿m
);

165 if(
pid
 == -1)

167 
	`´štf
("create child…rocessƒrror\r\n");

168 
”rÜ2
;

172 
	`Ãtdev_move_to_Çme¥aû
(
v‘h
, 
pid
);

176 
	`mem£t
(&
dÇt
, 0, (dnat));

177 
dÇt
.
´Ùo
 = 
PROTO_TCP
;

179 
dÇt
.
dpÜt
 = 7777;

180 
dÇt
.
addr
 = 
·¿m
.addr;

182 
dÇt
.
ıÜt
 = 9999;

183 
	`dÇt_ruË_£t
(&
dÇt
);

187 
	`wr™e
(
sock‘s
[0], "network", 7);

190 
	`»ad
(0,
buf
, 10);

191 if(
	`¡ºcmp
(
buf
, "exit", 4) == 0)

193 
	`´štf
("end!!\r\n");

194 
	`wr™e
(
sock‘s
[0], "stop", 4);

195 
	`kl
(
pid
, 9);

199 
”rÜ2
:

200 if(
dÇt
.
cmd
)

202 
	`Çt_ruË_d–
(
dÇt
.
cmd
);

203 
	`ä“
(
dÇt
.
cmd
);

205 if(
¢©
.
cmd
)

207 
	`Çt_ruË_d–
(
¢©
.
cmd
);

208 
	`ä“
(
¢©
.
cmd
);

210 
	`ÃtwÜk_dev_down
(
‘h
);

211 
	`Ãtdev_d–‘e_by_Çme
(
‘h
);

212 
”rÜ1
:

214 
	`ÃtwÜk_dev_down
(
br
.
Çme
);

216 
	`br_d–_bridge
(
br
.
Çme
);

218 if(
	`¡rcmp
(
¬gv
[1], "cre") == 0)

219 
	`br_add_bridge
("test");

220 if(
	`¡rcmp
(
¬gv
[1], "del") == 0)

221 
	`br_d–_bridge
("test");

222 if(
	`¡rcmp
(
¬gv
[1], "addr") == 0)

224 
š_addr
 
addr
, 
mask
;

225 if(
	`š‘_©Ú
("172.16.0.1", &
addr
) == 0)

227 
	`´štf
("inet_atonƒrror\r\n");

229 if(
	`š‘_©Ú
("255.255.0.0", &
mask
) == 0)

231 
	`´štf
("inet_atonƒrror\r\n");

233 
	`v4_addr_add
("‹¡", &
addr
, &
mask
, 0);

234 
	`ÃtwÜk_dev_up
("test");

236 if(
	`¡rcmp
(
¬gv
[1], "veth") == 0)

238 
	`´štf
("create veth\r\n");

239 if(
	`ÃtwÜk_v‘h_ü—‹
("e_mar", "v_mar") != 0)

240 
	`´štf
("create vethƒrror \r\n");

241 
	`ÃtwÜk_dev_up
("e_mar");

250 
	}
}

	@code/network.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<uni¡d.h
>

11 
	~<”ºo.h
>

12 
	~<¡ršg.h
>

13 
	~<dœ’t.h
>

14 
	~<sys/ty³s.h
>

15 
	~<sys/¡©.h
>

16 
	~<Ãt/if.h
>

17 
	~<sys/sock‘.h
>

18 
	~<Ãtš‘/š.h
>

19 
	~<lšux/if_bridge.h
>

20 
	~<sys/ioùl.h
>

21 
	~<Ãt/if_¬p.h
>

22 
	~<Ãt/‘h”Ãt.h
>

23 
	~<Ãtš‘/š.h
>

24 
	~<lšux/Ãšk.h
>

25 
	~<lšux/¹Ãšk.h
>

26 
	~<lšux/sockios.h
>

27 
	~<Ãt/rou‹.h
>

28 
	~<Ãt/if.h
>

29 
	~<sys/ioùl.h
>

31 
	~<¬·/š‘.h
>

32 
	~"Æ.h
"

34 
	#mask_š_addr
(
x
è(((
sockaddr_š
 *)&((x).
¹_g’mask
))->
sš_addr
.
s_addr
)

	)

35 
	#fuÎ_mask
(
x
è(x)

	)

37 #iâdeà
VETH_INFO_PEER


38 
	#VETH_INFO_PEER
 1

	)

41 
	gbr_sock‘_fd
 = -1;

43 
	$br_š™
()

45 ià((
br_sock‘_fd
 = 
	`sock‘
(
AF_LOCAL
, 
SOCK_STREAM
, 0)) < 0)

46  
”ºo
;

48 
	}
}

50 
	$br_shutdown
()

52 
	`şo£
(
br_sock‘_fd
);

53 
br_sock‘_fd
 = -1;

54 
	}
}

57 
	$br_add_bridge
(cÚ¡ *
bºame
)

59 
»t
;

61 #ifdeà
SIOCBRADDBR


62 
»t
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCBRADDBR
, 
bºame
);

63 ià(
»t
 < 0)

66 
_br
[
IFNAMSIZ
];

67 
¬g
[3] = { 
BRCTL_ADD_BRIDGE
, (è
_br
 };

69 
	`¡ºıy
(
_br
, 
bºame
, 
IFNAMSIZ
);

70 
»t
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCSIFBR
, 
¬g
);

73  
»t
 < 0 ? 
”ºo
 : 0;

74 
	}
}

76 
	$br_d–_bridge
(cÚ¡ *
bºame
)

78 
»t
;

80 #ifdeà
SIOCBRDELBR


81 
»t
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCBRDELBR
, 
bºame
);

82 ià(
»t
 < 0)

85 
_br
[
IFNAMSIZ
];

86 
¬g
[3] = { 
BRCTL_DEL_BRIDGE
, (è
_br
 };

88 
	`¡ºıy
(
_br
, 
bºame
, 
IFNAMSIZ
);

89 
»t
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCSIFBR
, 
¬g
);

91  
»t
 < 0 ? 
”ºo
 : 0;

92 
	}
}

94 
	$br_add_š‹rçû
(cÚ¡ *
bridge
, cÚ¡ *
dev
)

96 
iäeq
 
iä
;

97 
”r
;

98 
ifšdex
 = 
	`if_Çm‘ošdex
(
dev
);

100 ià(
ifšdex
 == 0)

101  
ENODEV
;

103 
	`¡ºıy
(
iä
.
iä_Çme
, 
bridge
, 
IFNAMSIZ
);

104 #ifdeà
SIOCBRADDIF


105 
iä
.
iä_ifšdex
 = 
ifšdex
;

106 
”r
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCBRADDIF
, &
iä
);

107 ià(
”r
 < 0)

110 
¬gs
[4] = { 
BRCTL_ADD_IF
, 
ifšdex
, 0, 0 };

112 
iä
.
iä_d©a
 = (*è
¬gs
;

113 
”r
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCDEVPRIVATE
, &
iä
);

116  
”r
 < 0 ? 
”ºo
 : 0;

117 
	}
}

119 
	$br_d–_š‹rçû
(cÚ¡ *
bridge
, cÚ¡ *
dev
)

121 
iäeq
 
iä
;

122 
”r
;

123 
ifšdex
 = 
	`if_Çm‘ošdex
(
dev
);

125 ià(
ifšdex
 == 0)

126  
ENODEV
;

128 
	`¡ºıy
(
iä
.
iä_Çme
, 
bridge
, 
IFNAMSIZ
);

129 #ifdeà
SIOCBRDELIF


130 
iä
.
iä_ifšdex
 = 
ifšdex
;

131 
”r
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCBRDELIF
, &
iä
);

132 ià(
”r
 < 0)

135 
¬gs
[4] = { 
BRCTL_DEL_IF
, 
ifšdex
, 0, 0 };

137 
iä
.
iä_d©a
 = (*è
¬gs
;

138 
”r
 = 
	`ioùl
(
br_sock‘_fd
, 
SIOCDEVPRIVATE
, &
iä
);

141  
”r
 < 0 ? 
”ºo
 : 0;

142 
	}
}

144 
	$add_deçuÉ_rou‹
(
š_addr
 *
addr
)

146 
»t
;

147 
skfd
;

148 
sockaddr_š
 * 
¹_addr
;

149 
¹_buf
[(
¹’Œy
)];

150 
¹’Œy
 *cÚ¡ 
¹
 = (¹’Œy *)
¹_buf
;

151 
	`mem£t
(
¹
, 0, (*rt));

154 
¹_addr
 = (
sockaddr_š
 *)&
¹
->
¹_d¡
;

156 
¹_addr
->
sš_çmy
 = 
AF_INET
;

157 
¹_addr
->
sš_pÜt
 = 0;

158 
¹_addr
->
sš_addr
.
s_addr
 = 
INADDR_ANY
;

160 
¹_addr
 = (
sockaddr_š
 *)&
¹
->
¹_g©eway
;

162 
¹_addr
->
sš_çmy
 = 
AF_INET
;

163 
¹_addr
->
sš_pÜt
 = 0;

164 
¹_addr
->
sš_addr
 = *
addr
;

168 
¹
->
¹_æags
 |ğ
RTF_GATEWAY
;

171 
¹_addr
 = (
sockaddr_š
 *)&
¹
->
¹_g’mask
;

180 
´efix_Ën
 = 0;

181 
	`mask_š_addr
(*
¹
èğ
	`htÚl
Ğ~(0xffffffffUL >> 
´efix_Ën
));

186 
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

187 
»t
 = 
	`ioùl
(
skfd
, 
SIOCADDRT
, 
¹
);

188 if(
»t
 != 0)

189 
	`´štf
("£¸”rÜ:%s\r\n", 
	`¡»¼Ü
(
”ºo
));

190 
	`şo£
(
skfd
);

191 
	}
}

193 
	$Ãtdev_£t_æag
(cÚ¡ *
Çme
, 
æag
)

195 
Æ_hªdËr
 
Æh
;

196 
Æmsg
 *Æmsg = 
NULL
, *
ªsw”
 = NULL;

197 
ifšfomsg
 *
ifi
;

198 
šdex
, 
Ën
, 
”r
;

200 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

201 ià(
”r
)

202  
”r
;

204 
”r
 = -
EINVAL
;

205 
Ën
 = 
	`¡¾’
(
Çme
);

206 ià(
Ën
 =ğ1 ||†’ >ğ
IFNAMSIZ
)

207 
out
;

209 
”r
 = -
ENOMEM
;

210 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

211 ià(!
Æmsg
)

212 
out
;

214 
ªsw”
 = 
	`Æmsg_®loc_»£rve
(
NLMSG_GOOD_SIZE
);

215 ià(!
ªsw”
)

216 
out
;

218 
”r
 = -
EINVAL
;

219 
šdex
 = 
	`if_Çm‘ošdex
(
Çme
);

220 ià(!
šdex
)

221 
out
;

223 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 = 
NLM_F_REQUEST
|
NLM_F_ACK
;

224 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_NEWLINK
;

226 
ifi
 = 
	`Æmsg_»£rve
(
Æmsg
, (
ifšfomsg
));

227 
ifi
->
ifi_çmy
 = 
AF_UNSPEC
;

228 
ifi
->
ifi_šdex
 = 
šdex
;

229 
ifi
->
ifi_chªge
 |ğ
IFF_UP
;

230 
ifi
->
ifi_æags
 |ğ
æag
;

232 
”r
 = 
	`Ãšk_Œª§ùiÚ
(&
Æh
, 
Æmsg
, 
ªsw”
);

233 
out
:

234 
	`Ãšk_şo£
(&
Æh
);

235 
	`Æmsg_ä“
(
Æmsg
);

236 
	`Æmsg_ä“
(
ªsw”
);

237  
”r
;

238 
	}
}

242 
	$ÃtwÜk_dev_up
(cÚ¡ *
Çme
)

244  
	`Ãtdev_£t_æag
(
Çme
, 
IFF_UP
);

245 
	}
}

247 
	$ÃtwÜk_dev_down
(cÚ¡ *
Çme
)

249  
	`Ãtdev_£t_æag
(
Çme
, 0);

250 
	}
}

254 
	$Ãtdev_d–‘e_by_šdex
(
ifšdex
)

256 
Æ_hªdËr
 
Æh
;

257 
Æmsg
 *Æmsg = 
NULL
, *
ªsw”
 = NULL;

258 
ifšfomsg
 *
ifi
;

259 
”r
;

261 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

262 ià(
”r
)

263  
”r
;

265 
”r
 = -
ENOMEM
;

266 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

267 ià(!
Æmsg
)

268 
out
;

270 
ªsw”
 = 
	`Æmsg_®loc_»£rve
(
NLMSG_GOOD_SIZE
);

271 ià(!
ªsw”
)

272 
out
;

274 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 = 
NLM_F_ACK
|
NLM_F_REQUEST
;

275 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_DELLINK
;

277 
ifi
 = 
	`Æmsg_»£rve
(
Æmsg
, (
ifšfomsg
));

278 
ifi
->
ifi_çmy
 = 
AF_UNSPEC
;

279 
ifi
->
ifi_šdex
 = 
ifšdex
;

281 
”r
 = 
	`Ãšk_Œª§ùiÚ
(&
Æh
, 
Æmsg
, 
ªsw”
);

282 
out
:

283 
	`Ãšk_şo£
(&
Æh
);

284 
	`Æmsg_ä“
(
ªsw”
);

285 
	`Æmsg_ä“
(
Æmsg
);

286  
”r
;

287 
	}
}

289 
	$Ãtdev_d–‘e_by_Çme
(cÚ¡ *
Çme
)

291 
šdex
;

293 
šdex
 = 
	`if_Çm‘ošdex
(
Çme
);

294 ià(!
šdex
)

295  -
EINVAL
;

297  
	`Ãtdev_d–‘e_by_šdex
(
šdex
);

298 
	}
}

301 
	$Ãtdev_move_to_Çme¥aû
(cÚ¡ * 
iâame
, 
pid_t
 
pid
)

303 
Æ_hªdËr
 
Æh
;

304 
Æmsg
 *Æmsg = 
NULL
;

305 
ifšfomsg
 *
ifi
;

306 
”r
;

308 if(!
iâame
)

311 
ifšdex
;

312 
ifšdex
 = 
	`if_Çm‘ošdex
(
iâame
);

313 if(
ifšdex
 == 0)

316 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

317 ià(
”r
)

318  
”r
;

320 
”r
 = -
ENOMEM
;

321 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

322 ià(!
Æmsg
)

323 
out
;

325 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 = 
NLM_F_REQUEST
|
NLM_F_ACK
;

326 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_NEWLINK
;

328 
ifi
 = 
	`Æmsg_»£rve
(
Æmsg
, (
ifšfomsg
));

329 
ifi
->
ifi_çmy
 = 
AF_UNSPEC
;

330 
ifi
->
ifi_šdex
 = 
ifšdex
;

332 ià(
	`Æa_put_u32
(
Æmsg
, 
IFLA_NET_NS_PID
, 
pid
))

333 
out
;

335 ià(
iâame
 !ğ
NULL
) {

336 ià(
	`Æa_put_¡ršg
(
Æmsg
, 
IFLA_IFNAME
, 
iâame
))

337 
out
;

340 
”r
 = 
	`Ãšk_Œª§ùiÚ
(&
Æh
, 
Æmsg
,‚lmsg);

341 
out
:

342 
	`Ãšk_şo£
(&
Æh
);

343 
	`Æmsg_ä“
(
Æmsg
);

344  
”r
;

345 
	}
}

349 
	$ÃtwÜk_v‘h_ü—‹
(cÚ¡ *
Çme1
, cÚ¡ *
Çme2
)

351 
Æ_hªdËr
 
Æh
;

352 
Æmsg
 *Æmsg = 
NULL
, *
ªsw”
 = NULL;

353 
ifšfomsg
 *
ifi
;

354 
¹©Œ
 *
Ã¡1
, *
Ã¡2
, *
Ã¡3
;

355 
Ën
, 
”r
;

357 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

358 ià(
”r
)

359  
”r
;

361 
”r
 = -
EINVAL
;

362 
Ën
 = 
	`¡¾’
(
Çme1
);

363 ià(
Ën
 =ğ1 ||†’ >ğ
IFNAMSIZ
)

364 
out
;

366 
Ën
 = 
	`¡¾’
(
Çme2
);

367 ià(
Ën
 =ğ1 ||†’ >ğ
IFNAMSIZ
)

368 
out
;

370 
”r
 = -
ENOMEM
;

371 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

372 ià(!
Æmsg
)

373 
out
;

375 
ªsw”
 = 
	`Æmsg_®loc_»£rve
(
NLMSG_GOOD_SIZE
);

376 ià(!
ªsw”
)

377 
out
;

379 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 =

380 
NLM_F_REQUEST
|
NLM_F_CREATE
|
NLM_F_EXCL
|
NLM_F_ACK
;

381 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_NEWLINK
;

383 
ifi
 = 
	`Æmsg_»£rve
(
Æmsg
, (
ifšfomsg
));

384 
ifi
->
ifi_çmy
 = 
AF_UNSPEC
;

386 
”r
 = -
EINVAL
;

387 
Ã¡1
 = 
	`Æa_begš_Ã¡ed
(
Æmsg
, 
IFLA_LINKINFO
);

388 ià(!
Ã¡1
)

389 
out
;

391 ià(
	`Æa_put_¡ršg
(
Æmsg
, 
IFLA_INFO_KIND
, "veth"))

392 
out
;

394 
Ã¡2
 = 
	`Æa_begš_Ã¡ed
(
Æmsg
, 
IFLA_INFO_DATA
);

395 ià(!
Ã¡2
)

396 
out
;

398 
Ã¡3
 = 
	`Æa_begš_Ã¡ed
(
Æmsg
, 
VETH_INFO_PEER
);

399 ià(!
Ã¡3
)

400 
out
;

402 
ifi
 = 
	`Æmsg_»£rve
(
Æmsg
, (
ifšfomsg
));

403 ià(!
ifi
)

404 
out
;

406 ià(
	`Æa_put_¡ršg
(
Æmsg
, 
IFLA_IFNAME
, 
Çme2
))

407 
out
;

409 
	`Æa_’d_Ã¡ed
(
Æmsg
, 
Ã¡3
);

411 
	`Æa_’d_Ã¡ed
(
Æmsg
, 
Ã¡2
);

413 
	`Æa_’d_Ã¡ed
(
Æmsg
, 
Ã¡1
);

415 ià(
	`Æa_put_¡ršg
(
Æmsg
, 
IFLA_IFNAME
, 
Çme1
))

416 
out
;

418 
”r
 = 
	`Ãšk_Œª§ùiÚ
(&
Æh
, 
Æmsg
, 
ªsw”
);

419 
out
:

420 
	`Ãšk_şo£
(&
Æh
);

421 
	`Æmsg_ä“
(
ªsw”
);

422 
	`Æmsg_ä“
(
Æmsg
);

423  
”r
;

424 
	}
}

428 
	$_addr_add
(
çmy
, 
ifšdex
,

429 *
addr
, *
bÿ¡
, *
aÿ¡
, 
´efix
)

431 
Æ_hªdËr
 
Æh
;

432 
Æmsg
 *Æmsg = 
NULL
, *
ªsw”
 = NULL;

433 
içddrmsg
 *
iç
;

434 
add¾’
;

435 
”r
;

437 
add¾’
 = 
çmy
 =ğ
AF_INET
 ? (
š_addr
) :

438 (
š6_addr
);

440 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

441 ià(
”r
)

442  
”r
;

444 
”r
 = -
ENOMEM
;

445 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

446 ià(!
Æmsg
)

447 
out
;

449 
ªsw”
 = 
	`Æmsg_®loc_»£rve
(
NLMSG_GOOD_SIZE
);

450 ià(!
ªsw”
)

451 
out
;

453 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 =

454 
NLM_F_ACK
|
NLM_F_REQUEST
|
NLM_F_CREATE
|
NLM_F_EXCL
;

455 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_NEWADDR
;

457 
iç
 = 
	`Æmsg_»£rve
(
Æmsg
, (
içddrmsg
));

458 
iç
->
iç_´efixËn
 = 
´efix
;

459 
iç
->
iç_šdex
 = 
ifšdex
;

460 
iç
->
iç_çmy
 = 
çmy
;

461 
iç
->
iç_scİe
 = 0;

463 
”r
 = -
EINVAL
;

464 ià(
	`Æa_put_bufãr
(
Æmsg
, 
IFA_LOCAL
, 
addr
, 
add¾’
))

465 
out
;

467 ià(
	`Æa_put_bufãr
(
Æmsg
, 
IFA_ADDRESS
, 
addr
, 
add¾’
))

468 
out
;

470 ià(
	`Æa_put_bufãr
(
Æmsg
, 
IFA_BROADCAST
, 
bÿ¡
, 
add¾’
))

471 
out
;

474 
”r
 = -
EPROTONOSUPPORT
;

475 ià(
çmy
 =ğ
AF_INET6
 &&

476 (
	`memcmp
(
bÿ¡
, &
š6addr_ªy
, (in6addr_any)) ||

477 
	`memcmp
(
aÿ¡
, &
š6addr_ªy
, (in6addr_any))))

478 
out
;

480 
”r
 = 
	`Ãšk_Œª§ùiÚ
(&
Æh
, 
Æmsg
, 
ªsw”
);

481 
out
:

482 
	`Ãšk_şo£
(&
Æh
);

483 
	`Æmsg_ä“
(
ªsw”
);

484 
	`Æmsg_ä“
(
Æmsg
);

485  
”r
;

486 
	}
}

489 
	$v4_addr_add
(cÚ¡ * 
Çme
, 
š_addr
 *
addr
, š_add¸*
bÿ¡
, 
´efix
)

491 
ifšdex
;

492 
ifšdex
 = 
	`if_Çm‘ošdex
(
Çme
);

493 if(
ifšdex
 == 0)

495  
	`_addr_add
(
AF_INET
, 
ifšdex
, 
addr
, 
bÿ¡
, 
NULL
, 
´efix
);

496 
	}
}

	@code/network.h

7 #iâdeà
MATRIX_NETWORK_H


8 
	#MATRIX_NETWORK_H


	)

10 
	~<¬·/š‘.h
>

11 
	sÃtwÜk_cÚf


13 
	m´Ùo
;

14 
	mpÜt
;

15 
ÃtwÜk_cÚf
 * 
	mÃxt
;

16 }
	tÃtwÜk_cÚf
;

18 
	smrx_ÃtwÜk


20 * 
	mbºame
;

21 * 
	mr_‘h
;

22 * 
	mv_‘h
;

23 
	m´Ù
;

24 
	mr_pÜt
;

25 
	mv_pÜt
;

26 
š_addr
 
	mv_addr
;

27 
š_addr
 
	mb_addr
;

28 }
	tmrx_ÃtwÜk
;

29 
br_š™
();

30 
br_shutdown
();

31 
br_add_bridge
(cÚ¡ *
bºame
);

32 
br_d–_bridge
(cÚ¡ *
bºame
);

33 
br_add_š‹rçû
(cÚ¡ *
bridge
, cÚ¡ *
dev
);

34 
br_d–_š‹rçû
(cÚ¡ *
bridge
, cÚ¡ *
dev
);

36 
ÃtwÜk_v‘h_ü—‹
(cÚ¡ *
Çme1
, cÚ¡ *
Çme2
);

39 
Ãtdev_d–‘e_by_Çme
(cÚ¡ *
Çme
);

41 
v4_addr_add
(cÚ¡ * 
Çme
, 
š_addr
 *
addr
,š_add¸*
bÿ¡
, 
´efix
);

43 
ÃtwÜk_dev_up
(cÚ¡ *
Çme
);

44 
ÃtwÜk_dev_down
(cÚ¡ *
Çme
);

48 
add_deçuÉ_rou‹
(
š_addr
 *
addr
);

50 
Ãtdev_move_to_Çme¥aû
(cÚ¡ * 
iâame
, 
pid_t
 
pid
);

	@code/nl.c

23 
	~<sys/sock‘.h
>

24 
	~<¡ršg.h
>

25 
	~<¡dio.h
>

26 
	~<time.h
>

27 
	~<uni¡d.h
>

28 
	~<”ºo.h
>

29 
	~<¡dlib.h
>

30 
	~<lšux/Ãšk.h
>

31 
	~<lšux/¹Ãšk.h
>

33 
	~"Æ.h
"

35 
	#NLMSG_TAIL
(
nmsg
) \

36 ((
¹©Œ
 *è(((*è(
nmsg
)è+ 
	`NLMSG_ALIGN
(Òmsg)->
Æmsg_Ën
)))

	)

38 
size_t
 
	$Æmsg_Ën
(cÚ¡ 
Æmsg
 *nlmsg)

40  
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 - 
NLMSG_HDRLEN
;

41 
	}
}

43 *
	$Æmsg_d©a
(
Æmsg
 *nlmsg)

45 *
d©a
 = ((*)
Æmsg
è+ 
NLMSG_HDRLEN
;

46 ià(!
	`Æmsg_Ën
(
Æmsg
))

47  
NULL
;

48  
d©a
;

49 
	}
}

51 
	$Æa_put
(
Æmsg
 *Æmsg, 
©Œ
,

52 cÚ¡ *
d©a
, 
size_t
 
Ën
)

54 
¹©Œ
 *
¹a
;

55 
size_t
 
¹®’
 = 
	`RTA_LENGTH
(
Ën
);

56 
size_t
 
’
 = 
	`NLMSG_ALIGN
(
Æmsg
->
Æmsghdr
->
Æmsg_Ën
è+ 
	`RTA_ALIGN
(
¹®’
);

58 ià(
’
 > 
Æmsg
->
ÿp
)

59  -
ENOMEM
;

61 
¹a
 = 
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
);

62 
¹a
->
¹a_ty³
 = 
©Œ
;

63 
¹a
->
¹a_Ën
 = 
¹®’
;

64 
	`memıy
(
	`RTA_DATA
(
¹a
), 
d©a
, 
Ën
);

65 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 = 
’
;

67 
	}
}

69 
	$Æa_put_bufãr
(
Æmsg
 *Æmsg, 
©Œ
,

70 cÚ¡ *
d©a
, 
size_t
 
size
)

72  
	`Æa_put
(
Æmsg
, 
©Œ
, 
d©a
, 
size
);

73 
	}
}

75 
	$Æa_put_¡ršg
(
Æmsg
 *Æmsg, 
©Œ
, cÚ¡ *
¡ršg
)

77  
	`Æa_put
(
Æmsg
, 
©Œ
, 
¡ršg
, 
	`¡¾’
(string) + 1);

78 
	}
}

80 
	$Æa_put_u32
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
)

82  
	`Æa_put
(
Æmsg
, 
©Œ
, &
v®ue
, (value));

83 
	}
}

85 
	$Æa_put_u16
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
)

87  
	`Æa_put
(
Æmsg
, 
©Œ
, &
v®ue
, 2);

88 
	}
}

90 
	$Æa_put_©Œ
(
Æmsg
 *Æmsg, 
©Œ
)

92  
	`Æa_put
(
Æmsg
, 
©Œ
, 
NULL
, 0);

93 
	}
}

95 
¹©Œ
 *
	$Æa_begš_Ã¡ed
(
Æmsg
 *Æmsg, 
©Œ
)

97 
¹©Œ
 *¹©Œ = 
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
);

99 ià(
	`Æa_put_©Œ
(
Æmsg
, 
©Œ
))

100  
NULL
;

102  
¹©Œ
;

103 
	}
}

105 
	$Æa_’d_Ã¡ed
(
Æmsg
 *Æmsg, 
¹©Œ
 *
©Œ
)

107 
©Œ
->
¹a_Ën
 = (*)
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
) - (*)attr;

108 
	}
}

110 
Æmsg
 *
	$Æmsg_®loc
(
size_t
 
size
)

112 
Æmsg
 *nlmsg;

113 
size_t
 
Ën
 = 
NLMSG_HDRLEN
 + 
	`NLMSG_ALIGN
(
size
);

115 
Æmsg
 = (Æmsg *)
	`m®loc
((nlmsg));

116 ià(!
Æmsg
)

117  
NULL
;

119 
Æmsg
->
Æmsghdr
 = (Æmsghd¸*)
	`m®loc
(
Ën
);

120 ià(!
Æmsg
->
Æmsghdr
)

121 
”rout
;

123 
	`mem£t
(
Æmsg
->
Æmsghdr
, 0, 
Ën
);

124 
Æmsg
->
ÿp
 = 
Ën
;

125 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 = 
NLMSG_HDRLEN
;

127  
Æmsg
;

128 
”rout
:

129 
	`ä“
(
Æmsg
);

130  
NULL
;

131 
	}
}

133 *
	$Æmsg_»£rve
(
Æmsg
 *Æmsg, 
size_t
 
Ën
)

135 *
buf
;

136 
size_t
 
Æmsg_Ën
 = 
Æmsg
->
Æmsghdr
->nlmsg_len;

137 
size_t
 
’
 = 
	`NLMSG_ALIGN
(
Ën
);

139 ià(
Æmsg_Ën
 + 
’
 > 
Æmsg
->
ÿp
)

140  
NULL
;

142 
buf
 = ((*)(
Æmsg
->
Æmsghdr
)è+ 
Æmsg_Ën
;

143 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 +ğ
’
;

145 ià(
’
 > 
Ën
)

146 
	`mem£t
(
buf
 + 
Ën
, 0, 
’
 -†en);

148  
buf
;

149 
	}
}

151 
Æmsg
 *
	$Æmsg_®loc_»£rve
(
size_t
 
size
)

153 
Æmsg
 *nlmsg;

155 
Æmsg
 = 
	`Æmsg_®loc
(
size
);

156 ià(!
Æmsg
)

157  
NULL
;

160 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 =‚lmsg->
ÿp
;

161  
Æmsg
;

162 
	}
}

164 
	$Æmsg_ä“
(
Æmsg
 *nlmsg)

166 ià(!
Æmsg
)

169 
	`ä“
(
Æmsg
->
Æmsghdr
);

170 
	`ä“
(
Æmsg
);

171 
	}
}

173 
	$Ãšk_rcv
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *
ªsw”
)

175 
»t
;

176 
sockaddr_Æ
 
Æaddr
;

177 
iovec
 
iov
 = {

178 .
iov_ba£
 = 
ªsw”
->
Æmsghdr
,

179 .
iov_Ën
 = 
ªsw”
->
Æmsghdr
->
Æmsg_Ën
,

182 
msghdr
 
msg
 = {

183 .
msg_Çme
 = &
Æaddr
,

184 .
msg_Çm–’
 = (
Æaddr
),

185 .
msg_iov
 = &
iov
,

186 .
msg_iovËn
 = 1,

189 
	`mem£t
(&
Æaddr
, 0, (nladdr));

190 
Æaddr
.
Æ_çmy
 = 
AF_NETLINK
;

191 
Æaddr
.
Æ_pid
 = 0;

192 
Æaddr
.
Æ_groups
 = 0;

194 
agaš
:

195 
»t
 = 
	`»cvmsg
(
hªdËr
->
fd
, &
msg
, 0);

196 ià(
»t
 < 0) {

197 ià(
”ºo
 =ğ
EINTR
)

198 
agaš
;

199  -
”ºo
;

202 ià(!
»t
)

205 ià(
msg
.
msg_æags
 & 
MSG_TRUNC
 &&

206 
»t
 =ğ
ªsw”
->
Æmsghdr
->
Æmsg_Ën
)

207  -
EMSGSIZE
;

209  
»t
;

210 
	}
}

212 
	$Ãšk_£nd
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *nlmsg)

214 
sockaddr_Æ
 
Æaddr
;

215 
iovec
 
iov
 = {

216 .
iov_ba£
 = 
Æmsg
->
Æmsghdr
,

217 .
iov_Ën
 = 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
,

219 
msghdr
 
msg
 = {

220 .
msg_Çme
 = &
Æaddr
,

221 .
msg_Çm–’
 = (
Æaddr
),

222 .
msg_iov
 = &
iov
,

223 .
msg_iovËn
 = 1,

225 
»t
;

227 
	`mem£t
(&
Æaddr
, 0, (nladdr));

228 
Æaddr
.
Æ_çmy
 = 
AF_NETLINK
;

229 
Æaddr
.
Æ_pid
 = 0;

230 
Æaddr
.
Æ_groups
 = 0;

232 
»t
 = 
	`£ndmsg
(
hªdËr
->
fd
, &
msg
, 0);

233 ià(
»t
 < 0)

234  -
”ºo
;

236  
»t
;

237 
	}
}

239 #iâdeà
NLMSG_ERROR


240 
	#NLMSG_ERROR
 0x2

	)

242 
	$Ãšk_Œª§ùiÚ
(
Æ_hªdËr
 *
hªdËr
,

243 
Æmsg
 *
»que¡
, Æmsg *
ªsw”
)

245 
»t
;

247 
»t
 = 
	`Ãšk_£nd
(
hªdËr
, 
»que¡
);

248 ià(
»t
 < 0)

249  
»t
;

251 
»t
 = 
	`Ãšk_rcv
(
hªdËr
, 
ªsw”
);

252 ià(
»t
 < 0)

253  
»t
;

255 ià(
ªsw”
->
Æmsghdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

256 
Æmsg”r
 *
”r
 = (Æmsg”r*)
	`NLMSG_DATA
(
ªsw”
->
Æmsghdr
);

257  
”r
->
”rÜ
;

261 
	}
}

263 
	$Ãšk_İ’
(
Æ_hªdËr
 *
hªdËr
, 
´ÙocŞ
)

265 
sockËn_t
 
sockËn
;

266 
¢dbuf
 = 32768;

267 
rcvbuf
 = 32768;

269 
	`mem£t
(
hªdËr
, 0, (*handler));

271 
hªdËr
->
fd
 = 
	`sock‘
(
AF_NETLINK
, 
SOCK_RAW
, 
´ÙocŞ
);

272 ià(
hªdËr
->
fd
 < 0)

273  -
”ºo
;

275 ià(
	`£tsockİt
(
hªdËr
->
fd
, 
SOL_SOCKET
, 
SO_SNDBUF
,

276 &
¢dbuf
, (sndbuf)) < 0)

277  -
”ºo
;

279 ià(
	`£tsockİt
(
hªdËr
->
fd
, 
SOL_SOCKET
, 
SO_RCVBUF
,

280 &
rcvbuf
,(rcvbuf)) < 0)

281  -
”ºo
;

283 
	`mem£t
(&
hªdËr
->
loÿl
, 0, (handler->local));

284 
hªdËr
->
loÿl
.
Æ_çmy
 = 
AF_NETLINK
;

285 
hªdËr
->
loÿl
.
Æ_groups
 = 0;

287 ià(
	`bšd
(
hªdËr
->
fd
, (
sockaddr
*)&hªdËr->
loÿl
,

288 (
hªdËr
->
loÿl
)) < 0)

289  -
”ºo
;

291 
sockËn
 = (
hªdËr
->
loÿl
);

292 ià(
	`g‘sockÇme
(
hªdËr
->
fd
, (
sockaddr
*)&hªdËr->
loÿl
,

293 &
sockËn
) < 0)

294  -
”ºo
;

296 ià(
sockËn
 !ğ(
hªdËr
->
loÿl
))

297  -
EINVAL
;

299 ià(
hªdËr
->
loÿl
.
Æ_çmy
 !ğ
AF_NETLINK
)

300  -
EINVAL
;

302 
hªdËr
->
£q
 = 
	`time
(
NULL
);

305 
	}
}

307 
	$Ãšk_şo£
(
Æ_hªdËr
 *
hªdËr
)

309 
	`şo£
(
hªdËr
->
fd
);

310 
hªdËr
->
fd
 = -1;

312 
	}
}

	@code/nl.h

23 #iâdeà
__LXC_NL_H


24 
	#__LXC_NL_H


	)

28 
	~<¡ddef.h
>

32 #iâdeà
PAGE_SIZE


33 
	#PAGE_SIZE
 4096

	)

35 
	#NLMSG_GOOD_SIZE
 (2*
PAGE_SIZE
)

	)

36 
	#NLMSG_TAIL
(
nmsg
) \

37 ((
¹©Œ
 *è(((*è(
nmsg
)è+ 
	`NLMSG_ALIGN
(Òmsg)->
Æmsg_Ën
)))

	)

38 
	#NLA_DATA
(
Ç
è((*)((*)Òaè+ 
NLA_HDRLEN
))

	)

39 
	#NLA_NEXT_ATTR
(
©Œ
è((*)((*ï‰rè+ 
	`NLA_ALIGN
×‰r->
Æa_Ën
))

	)

51 
	sÆ_hªdËr
 {

52 
	mfd
;

53 
	m£q
;

54 
sockaddr_Æ
 
	mloÿl
;

55 
sockaddr_Æ
 
	m³”
;

66 
	sÆmsg
 {

67 
Æmsghdr
 *
	mÆmsghdr
;

68 
ssize_t
 
	mÿp
;

82 
Ãšk_İ’
(
Æ_hªdËr
 *
hªdËr
, 
´ÙocŞ
);

92 
Ãšk_şo£
(
Æ_hªdËr
 *
hªdËr
);

104 
Ãšk_rcv
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *nlmsg);

115 
Ãšk_£nd
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *nlmsg);

128 
Ãšk_Œª§ùiÚ
(
Æ_hªdËr
 *
hªdËr
,

129 
Æmsg
 *
»que¡
, Æmsg *
ªw£r
);

141 
Æa_put_¡ršg
(
Æmsg
 *Æmsg, 
©Œ
, cÚ¡ *
¡ršg
);

154 
Æa_put_bufãr
(
Æmsg
 *Æmsg, 
©Œ
,

155 cÚ¡ *
d©a
, 
size_t
 
size
);

166 
Æa_put_u32
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
);

177 
Æa_put_u16
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
);

187 
Æa_put_©Œ
(
Æmsg
 *Æmsg, 
©Œ
);

198 
¹©Œ
 *
Æa_begš_Ã¡ed
(
Æmsg
 *Æmsg, 
©Œ
);

208 
Æa_’d_Ã¡ed
(
Æmsg
 *Æmsg, 
¹©Œ
 *
©Œ
);

225 
Æmsg
 *
Æmsg_®loc
(
size_t
 
size
);

234 
Æmsg
 *
Æmsg_®loc_»£rve
(
size_t
 
size
);

244 *
Æmsg_»£rve
(
Æmsg
 *Æmsg, 
size_t
 
Ën
);

251 
Æmsg_ä“
(
Æmsg
 *nlmsg);

260 *
Æmsg_d©a
(
Æmsg
 *nlmsg);

	@get_eth0/interface.c

8 
	~<¡dio.h
>

9 
	~<¡ršg.h
>

10 
	~<Ãt/if.h
>

11 
	~<sys/ioùl.h
>

12 
	~<¬·/š‘.h
>

13 
	~<”ºo.h
>

14 
	~<uni¡d.h
>

15 
	~<¡dlib.h
>

16 
	$g‘LoÿlInfo
()

18 
fd
;

19 
š‹rçûNum
 = 0;

20 
iäeq
 
buf
[16];

21 
ifcÚf
 
ifc
;

22 
iäeq
 
iäcİy
;

23 
mac
[16] = {0};

24 

[32] = {0};

25 
brßdAddr
[32] = {0};

26 
subÃtMask
[32] = {0};

28 ià((
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0)

30 
	`³¼Ü
("socket");

31 
	`şo£
(
fd
);

35 
ifc
.
ifc_Ën
 = (
buf
);

36 
ifc
.
ifc_buf
 = (
ÿddr_t
)
buf
;

37 ià(!
	`ioùl
(
fd
, 
SIOCGIFCONF
, (*)&
ifc
))

39 
š‹rçûNum
 = 
ifc
.
ifc_Ën
 / (
iäeq
);

40 
	`´štf
("š‹rçû‚um = %d\n", 
š‹rçûNum
);

41 
š‹rçûNum
-- > 0)

43 
	`´štf
("\ndeviû‚ame: %s\n", 
buf
[
š‹rçûNum
].
iä_Çme
);

46 
iäcİy
 = 
buf
[
š‹rçûNum
];

47 ià(
	`ioùl
(
fd
, 
SIOCGIFFLAGS
, &
iäcİy
))

49 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

50 
	`şo£
(
fd
);

55 ià(!
	`ioùl
(
fd
, 
SIOCGIFHWADDR
, (*)(&
buf
[
š‹rçûNum
])))

57 
	`mem£t
(
mac
, 0, (mac));

58 
	`¢´štf
(
mac
, (mac), "%02x%02x%02x%02x%02x%02x",

59 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[0],

60 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[1],

61 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[2],

62 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[3],

63 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[4],

64 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[5]);

65 
	`´štf
("deviû mac: %s\n", 
mac
);

69 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

70 
	`şo£
(
fd
);

75 ià(!
	`ioùl
(
fd
, 
SIOCGIFADDR
, (*)&
buf
[
š‹rçûNum
]))

77 
	`¢´štf
(

, (ip), "%s",

78 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_addr
))->
sš_addr
));

79 
	`´štf
("deviû ip: %s\n", 

);

83 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

84 
	`şo£
(
fd
);

89 ià(!
	`ioùl
(
fd
, 
SIOCGIFBRDADDR
, &
buf
[
š‹rçûNum
]))

91 
	`¢´štf
(
brßdAddr
, (broadAddr), "%s",

92 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_brßdaddr
))->
sš_addr
));

93 
	`´štf
("deviû brßdAddr: %s\n", 
brßdAddr
);

97 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

98 
	`şo£
(
fd
);

103 ià(!
	`ioùl
(
fd
, 
SIOCGIFNETMASK
, &
buf
[
š‹rçûNum
]))

105 
	`¢´štf
(
subÃtMask
, (subnetMask), "%s",

106 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_Ãtmask
))->
sš_addr
));

107 
	`´štf
("deviû subÃtMask: %s\n", 
subÃtMask
);

111 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

112 
	`şo£
(
fd
);

119 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

120 
	`şo£
(
fd
);

124 
	`şo£
(
fd
);

127 
	}
}

129 
	$g‘_‘h0
()

131 
sockaddr_š
 *
addr
;

132 
iäeq
 
iä
;

133 *
add»ss
;

134 
sockfd
;

137 
	`mem£t
(&
iä
, 0, (ifr));

138 
sockfd
 = 
	`sock‘
(
AF_INET
,
SOCK_DGRAM
,0);

139 
	`¡rıy
(
iä
.
iä_Çme
,"wlan0");

141 if(
	`ioùl
(
sockfd
,
SIOCGIFADDR
, &
iä
) < 0) {

142 
	`³¼Ü
("ioctlƒrror");

143 
	`ex™
(1);

145 
addr
 = (
sockaddr_š
 *)&(
iä
.
iä_addr
);

146 
add»ss
 = 
	`š‘_Áß
(
addr
->
sš_addr
);

147 
	`´štf
("š‘‡ddr: % ",
add»ss
);

149 
	}
}

150 
	$maš
()

152 
	`g‘LoÿlInfo
();

153 
	`g‘_‘h0
();

155 
	}
}

	@get_eth0/interface2.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<¡dio.h
>

12 
	~<içddrs.h
>

13 
	~<¬·/š‘.h
>

14 
	$g‘SubÃtMask
()

16 
sockaddr_š
 *
sš
 = 
NULL
;

17 
içddrs
 *
iç
 = 
NULL
, *
ifLi¡
;

18 ià(
	`g‘içddrs
(&
ifLi¡
) < 0)  -1;

19 
iç
 = 
ifLi¡
; iç !ğ
NULL
; iç = iç->
iç_Ãxt
)

21 if(
iç
->
iç_addr
->
§_çmy
 =ğ
AF_INET
)

23 
	`´štf
("\n>>> iÁ”çûName: %s\n", 
iç
->
iç_Çme
);

24 
sš
 = (
sockaddr_š
 *)
iç
->
iç_addr
;

25 
	`´štf
(">>> ipAdd»ss: %s\n", 
	`š‘_Áß
(
sš
->
sš_addr
));

26 
sš
 = (
sockaddr_š
 *)
iç
->
iç_d¡addr
;

27 
	`´štf
(">>> brßdÿ¡: %s\n", 
	`š‘_Áß
(
sš
->
sš_addr
));

28 
sš
 = (
sockaddr_š
 *)
iç
->
iç_Ãtmask
;

29 
	`´štf
(">>> subÃtMask: %s\n", 
	`š‘_Áß
(
sš
->
sš_addr
));

32 
	`ä“içddrs
(
ifLi¡
);

34 
	}
}

35 
	$maš
()

37 
	`g‘SubÃtMask
();

39 
	}
}

	@get_eth0/interface3.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<Ãt/if.h
>

12 
	~<sys/ioùl.h
>

13 
	~<¬·/š‘.h
>

14 
	~<”ºo.h
>

15 
	~<uni¡d.h
>

16 * 
	$g‘_loÿl_mac_by_Çme
(cÚ¡ *
Çme
)

18 
iäeq
 ifreq;

19 
sock
;

20 * 
mac_addr
;

21 if((
sock
=
	`sock‘
(
AF_INET
,
SOCK_STREAM
,0)) <0) {

22  
NULL
;

24 
	`¡rıy
(
iäeq
.
iä_Çme
, 
Çme
);

25 if(
	`ioùl
(
sock
,
SIOCGIFHWADDR
,&
iäeq
) <0) {

26  
NULL
;

28 
mac_addr
 = (*)
	`ÿÎoc
(32, ());

29 if(
mac_addr
) {

30 
	`¥rštf
(
mac_addr
, "%02X-%02X-%02X-%02X-%02X-%02X",

31 ()
iäeq
.
iä_hwaddr
.
§_d©a
[0],

32 ()
iäeq
.
iä_hwaddr
.
§_d©a
[1],

33 ()
iäeq
.
iä_hwaddr
.
§_d©a
[2],

34 ()
iäeq
.
iä_hwaddr
.
§_d©a
[3],

35 ()
iäeq
.
iä_hwaddr
.
§_d©a
[4],

36 ()
iäeq
.
iä_hwaddr
.
§_d©a
[5]);

38  
mac_addr
;

39 
	}
}

40 
	$maš
()

42 
buf
[218] = {0};

43 
FILE
 *
pf
 = 
	`pİ’
("ifconfig -a", "r");

45 ià(!
pf
){

46 
	`´štf
("popen failed\r\n");

50 
	`fg‘s
(
buf
, (buf), 
pf
è!ğ
NULL
 ){

51 ià(
	`¡r¡r
(
buf
, "Linkƒncap:Ethernet")){

52 
	`´štf
("buf=%s\r\n", 
buf
);

53 *
p
ğ
buf
;

54 
i
 = 0;

55  
i
=0; i < 
	`¡¾’
(
buf
); i++) {

56 ià(
buf
[
i
] == ' ') {

57 
buf
[
i
] = '\0';

64 * 
Çme
 = 
	`¡rdup
(
buf
);

65 
	`´štf
("Çmi %s\r\n", 
Çme
);

66 * 
mac
 = 
	`g‘_loÿl_mac_by_Çme
(
Çme
);

67 
	`´štf
("maøadd = %s\r\n", 
mac
);

68 ià(
mac
è
	`ä“
(mac);

69 
	`ä“
(
Çme
);

70 
	`pşo£
(
pf
);

72 
	}
}

	@get_interface/interface.c

8 
	~<lšux/ty³s.h
>

9 
	~<asm/ty³s.h
>

10 
	~<š‰y³s.h
>

11 
	~<sys/fe.h
>

12 
	~<sys/u£r.h
>

13 
	~<sys/sock‘.h
>

14 
	~<lšux/Ãšk.h
>

15 
	~<lšux/¹Ãšk.h
>

16 
	~<lšux/if.h
>

17 
	~<uni¡d.h
>

18 
	~<¡dlib.h
>

19 
	~<¡ršg.h
>

20 
	~<¡dio.h
>

21 
	~<¡dboŞ.h
>

22 
	~<”ºo.h
>

24 
ušt32_t
 
	tu32
;

25 
ušt16_t
 
	tu16
;

27 
	sÆsock
 {

28 
	msock
;

29 
	m£q
;

30 
sockaddr_Æ
 
	m¢l
;

31 *
	mÇme
;

32 } 
	gÆ_cmd
 = { -1, 0, {0}, "netlink-cmd" };

34 
	gšdex_oif
 = 0;

35 
	sÆ_if_šfo
 {

36 
u32
 
	maddr
;

37 *
	mÇme
;

39 
	$Æ_sock‘
 ( 
Æsock
 *
Æ
, 
groups
 )

41 
»t
;

42 
sockaddr_Æ
 
¢l
;

43 
sock
;

44 
Çm–’
;

46 
sock
 = 
	`sock‘
 ( 
AF_NETLINK
, 
SOCK_RAW
, 
NETLINK_ROUTE
 );

47 iàĞ
sock
 < 0 ) {

48 
	`årštf
 ( 
¡d”r
, "Cª'ˆİ’ % sock‘: %s", 
Æ
->
Çme
,

49 
	`¡»¼Ü
 ( 
”ºo
 ) );

53 
»t
 = 
	`fú
 ( 
sock
, 
F_SETFL
, 
O_NONBLOCK
 );

54 iàĞ
»t
 < 0 ) {

55 
	`årštf
 ( 
¡d”r
, "Cª'ˆ£ˆ% sock‘ fÏgs: %s", 
Æ
->
Çme
,

56 
	`¡»¼Ü
 ( 
”ºo
 ) );

57 
	`şo£
 ( 
sock
 );

61 
	`mem£t
 ( &
¢l
, 0,  snl );

62 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

63 
¢l
.
Æ_groups
 = 
groups
;

66 
»t
 = 
	`bšd
 ( 
sock
, ( 
sockaddr
 * ) &
¢l
,  snl );

67 iàĞ
»t
 < 0 ) {

68 
	`årštf
 ( 
¡d”r
, "Can't bind %s socketo group 0x%x: %s",

69 
Æ
->
Çme
, 
¢l
.
Æ_groups
, 
	`¡»¼Ü
 ( 
”ºo
 ) );

70 
	`şo£
 ( 
sock
 );

75 
Çm–’
 =  
¢l
;

76 
»t
 = 
	`g‘sockÇme
 ( 
sock
, ( 
sockaddr
 * ) &
¢l
, &
Çm–’
 );

77 iàĞ
»t
 < 0 || 
Çm–’
 !ğ 
¢l
 ) {

78 
	`årštf
 ( 
¡d”r
, "Cª'ˆg‘ % sock‘‚ame: %s", 
Æ
->
Çme
,

79 
	`¡»¼Ü
 ( 
”ºo
 ) );

80 
	`şo£
 ( 
sock
 );

84 
Æ
->
¢l
 = snl;

85 
Æ
->
sock
 = sock;

86  
»t
;

87 
	}
}

89 
	$Æ_»que¡
 ( 
çmy
, 
ty³
, 
Æsock
 *
Æ
 )

91 
»t
;

92 
sockaddr_Æ
 
¢l
;

95 
Æmsghdr
 
Æh
;

96 
¹g’msg
 
g
;

97 } 
»q
;

101 iàĞ
Æ
->
sock
 < 0 ) {

102 
	`årštf
 ( 
¡d”r
, "% sock‘ i¢'ˆaùive.", 
Æ
->
Çme
 );

106 
	`mem£t
 ( &
¢l
, 0,  snl );

107 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

109 
»q
.
Æh
.
Æmsg_Ën
 = „eq;

110 
»q
.
Æh
.
Æmsg_ty³
 = 
ty³
;

111 
»q
.
Æh
.
Æmsg_æags
 = 
NLM_F_ROOT
 | 
NLM_F_MATCH
 | 
NLM_F_REQUEST
;

112 
»q
.
Æh
.
Æmsg_pid
 = 0;

113 
»q
.
Æh
.
Æmsg_£q
 = ++
Æ
->
£q
;

114 
»q
.
g
.
¹g’_çmy
 = 
çmy
;

116 
»t
 = 
	`£ndto
 ( 
Æ
->
sock
, ( * ) &
»q
, „eq, 0,

117 Ğ
sockaddr
* ) &
¢l
,  snl );

118 iàĞ
»t
 < 0 ) {

119 
	`årštf
 ( 
¡d”r
, "% £ndtØçed: %s", 
Æ
->
Çme
, 
	`¡»¼Ü
 ( 
”ºo
 ) );

123 
	}
}

131 
	$Æ_·r£_¹©Œ
 ( 
¹©Œ
 **
tb
, 
max
, ¹©Œ *
¹a
, 
Ën
 )

133  
	`RTA_OK
 ( 
¹a
, 
Ën
 ) ) {

134 iàĞ
¹a
->
¹a_ty³
 <ğ
max
 )

135 
tb
[
¹a
->
¹a_ty³
] =„ta;

136 
¹a
 = 
	`RTA_NEXT
 („,
Ën
 );

138 
	}
}

140 
	$Æ_g‘_oif
 ( 
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

142 
Ën
;

143 
¹msg
 *
¹m
;

144 
¹©Œ
 *
tb
 [
RTA_MAX
 + 1];

145 
u_ch¬
 
æags
 = 0;

147 
ªyaddr
[16] = {0};

149 
šdex
;

150 
bË
;

151 *
de¡
;

152 *
g©e
;

154 
¹m
 = 
	`NLMSG_DATA
 ( 
h
 );

156 iàĞ
h
->
Æmsg_ty³
 !ğ
RTM_NEWROUTE
 )

158 iàĞ
¹m
->
¹m_ty³
 !ğ
RTN_UNICAST
 )

161 
bË
 = 
¹m
->
¹m_bË
;

163 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
 (  ( 
¹msg
 ) );

164 iàĞ
Ën
 < 0 )

167 
	`mem£t
 ( 
tb
, 0, b );

168 
	`Æ_·r£_¹©Œ
 ( 
tb
, 
RTA_MAX
, 
	`RTM_RTA
 ( 
¹m
 ), 
Ën
 );

170 iàĞ
¹m
->
¹m_æags
 & 
RTM_F_CLONED
 )

172 iàĞ
¹m
->
¹m_´ÙocŞ
 =ğ
RTPROT_REDIRECT
 )

174 iàĞ
¹m
->
¹m_´ÙocŞ
 =ğ
RTPROT_KERNEL
 )

177 iàĞ
¹m
->
¹m_¤c_Ën
 != 0 )

188 iàĞ
tb
[
RTA_OIF
] ) {

189 
šdex
 = * ( * ) 
	`RTA_DATA
 ( 
tb
[
RTA_OIF
] );

192 iàĞ
tb
[
RTA_DST
] )

193 
de¡
 = 
	`RTA_DATA
 ( 
tb
[
RTA_DST
] );

195 
de¡
 = 
ªyaddr
;

198 iàĞ
tb
[
RTA_GATEWAY
] )

199 
g©e
 = 
	`RTA_DATA
 ( 
tb
[
RTA_GATEWAY
] );

205 iàĞ
de¡
 =ğ
ªyaddr
 && 
g©e
 ) {

206 iàĞ
¬g
 !ğ
NULL
 ) {

207 * ( * ) 
¬g
 = 
šdex
;

212 
	}
}

214 
	$Æ_g‘_if_addr
 ( 
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

216 
Ën
;

217 
içddrmsg
 *
iç
;

218 
¹©Œ
 *
tb
 [
IFA_MAX
 + 1];

219 *
addr
 = 
NULL
;

220 *
brßd
 = 
NULL
;

221 
u_ch¬
 
æags
 = 0;

222 *
Ïb–
 = 
NULL
;

223 
u32
 
iç_addr
, 
iç_loÿl
;

224 
iç_Ïb–
[
IFNAMSIZ
 + 1];

226 
iç
 = 
	`NLMSG_DATA
 ( 
h
 );

227 iàĞ
iç
->
iç_çmy
 !ğ
AF_INET
 )

230 iàĞ
h
->
Æmsg_ty³
 !ğ
RTM_NEWADDR
 && h->Æmsg_ty³ !ğ
RTM_DELADDR
 )

233 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
 (  ( 
içddrmsg
 ) );

234 iàĞ
Ën
 < 0 )

237 
	`mem£t
 ( 
tb
, 0, b );

239 
	`Æ_·r£_¹©Œ
 ( 
tb
, 
IFA_MAX
, 
	`IFA_RTA
 ( 
iç
 ), 
Ën
 );

241 ià(
tb
[
IFA_ADDRESS
] =ğ
NULL
)

242 
tb
[
IFA_ADDRESS
] =b[
IFA_LOCAL
];

244 iàĞ
tb
[
IFA_ADDRESS
] )

245 
iç_addr
 = *(
u32
 *è
	`RTA_DATA
 ( 
tb
[
IFA_ADDRESS
] );

247 iàĞ
tb
[
IFA_LOCAL
] )

248 
iç_loÿl
 = *(
u32
 *è
	`RTA_DATA
 ( 
tb
[
IFA_LOCAL
] );

250 iàĞ
tb
[
IFA_LABEL
] )

251 
	`¡ºıy
Ğ
iç_Ïb–
, 
	`RTA_DATA
 ( 
tb
[
IFA_LABEL
] ), 
IFNAMSIZ
 );

255 
	`´štf
Ğ"addr=%08x†ßl=%08x‚ame=%s\r\n", 
iç_addr
, 
iç_loÿl
, 
iç_Ïb–
 );

257 
	}
}

258 
	$Æ_g‘_lšk
(
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

260 
Ën
;

261 
ifšfomsg
 *
iç
;

262 
¹©Œ
 *
tb
[
IFA_MAX
 + 1];

263 *
addr
 = 
NULL
;

264 *
brßd
 = 
NULL
;

265 
u_ch¬
 
æags
 = 0;

266 *
Ïb–
 = 
NULL
;

267 
u32
 
iç_addr
, 
iç_loÿl
;

268 
iç_Ïb–
[
IFNAMSIZ
 + 1];

270 
š‹r_addr
[128] = {0};

271 
loÿl_addr
[128] = {0};

273 
iç
 = (
ifšfomsg
 *)
	`NLMSG_DATA
(
h
);

274 ià(
iç
->
ifi_çmy
 !ğ
AF_UNSPEC
 ) {

275 
	`´štf
("faimilyƒrror\r\n");

279 
	`if_šdextÚame
(
iç
->
ifi_šdex
, 
iç_Ïb–
);

280 
	`´štf
("Çmi %s\r\n", 
iç_Ïb–
);

282 ià(
h
->
Æmsg_ty³
 !ğ
RTM_NEWADDR
 && h->Æmsg_ty³ !ğ
RTM_DELADDR
 )

285 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
((
ifšfomsg
));

286 iàĞ
Ën
 < 0 )

290 
	`mem£t
(
tb
, 0, (tb));

292 
	`Æ_·r£_¹©Œ
(
tb
, 
IFA_MAX
, 
	`IFA_RTA
(
iç
), 
Ën
 );

296 if(
tb
[
IFLA_IFNAME
])

297 
	`¡ºıy
(
iç_Ïb–
, 
	`RTA_DATA
(
tb
[
IFLA_IFNAME
]), 
IFNAMSIZ
);

298 
	`´štf
("Çmi %s\r\n", 
iç_Ïb–
);

300 if(
tb
[
IFA_ADDRESS
] =ğ
NULL
)

302 
tb
[
IFA_ADDRESS
] =b[
IFA_LOCAL
];

303 
	`´štf
("ifa_addres is‚ull\r\n");

306 if(
tb
[
IFA_ADDRESS
])

307 
iç_addr
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]);

310 if(
tb
[
IFA_LOCAL
])

311 
iç_loÿl
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_LOCAL
]);

314 if(
tb
[
IFA_LABEL
])

315 
	`¡ºıy
(
iç_Ïb–
, 
	`RTA_DATA
(
tb
[
IFA_LABEL
]), 
IFNAMSIZ
);

316 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

317 
	`RTA_PAYLOAD
(
tb
[
IFA_ADDRESS
]),

318 
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]),

319 
š‹r_addr
, (inter_addr));

321 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

322 
	`RTA_PAYLOAD
(
tb
[
IFA_LOCAL
]),

323 
	`RTA_DATA
(
tb
[
IFA_LOCAL
]),

324 
loÿl_addr
, (local_addr));

326 
	`´štf
("addr=%08x†ßl=%08x‚ame=% \r\n", 
iç_addr
, 
iç_loÿl
, 
iç_Ïb–
);

327 
	`´štf
("addr=%s/%d†ßl=% Çme=% \r\n", 
š‹r_addr
, ()
iç
->
iç_´efixËn
, 
loÿl_addr
, 
iç_Ïb–
);

329 
	`´štf
("end\r\n");

331 
	}
}

334 
	$maš
()

336 
»t
;

337 
if_Çme
[
PAGE_SIZE
];

338 *
p
;

339 
Æ_if_šfo
 
if_šfo
 = { -1, "eth0" };

341 
»t
 = 
	`Æ_sock‘
 ( &
Æ_cmd
, 0 );

342 iàĞ
»t
 < 0 ) {

343  
»t
;

346 
»t
 = 
	`Æ_»que¡
 ( 
AF_INET
, 
RTM_GETROUTE
, &
Æ_cmd
 );

347 iàĞ
»t
 < 0 ) {

348  
»t
;

350 
»t
 = 
	`Æ_·r£_šfo
 ( 
Æ_g‘_oif
, &
Æ_cmd
, &
šdex_oif
 );

351 iàĞ
»t
 < 0 )

352  
»t
;

354 
	`´štf
 ( "oif=%08x /n", 
šdex_oif
 );

355 iàĞ
šdex_oif
 > 0 ) {

356 
p
 = 
	`if_šdextÚame
 ( 
šdex_oif
, 
if_Çme
 );

357 iàĞ
p
 ) {

358 
	`´štf
 ( "š‹rçû=%s/n", 
p
 );

363 
»t
 = 
	`Æ_»que¡
 ( 
AF_INET
, 
RTM_GETADDR
, &
Æ_cmd
 );

364 iàĞ
»t
 < 0 )

365  
»t
;

367 
»t
 = 
	`Æ_·r£_šfo
 ( 
Æ_g‘_if_addr
, &
Æ_cmd
, &
if_šfo
 );

368 iàĞ
»t
 < 0 )

369  
»t
;

371 
»t
 = 
	`Æ_»que¡
 ( 
AF_INET
, 
RTM_GETLINK
, &
Æ_cmd
 );

372 iàĞ
»t
 < 0 )

373  
»t
;

375 
»t
 = 
	`Æ_·r£_šfo
 ( 
Æ_g‘_lšk
, &
Æ_cmd
, &
if_šfo
 );

376 iàĞ
»t
 < 0 )

377  
»t
;

380 
	}
}

	@get_interface2/interface.c

8 
	~<¡dio.h
>

9 
	~<¡ršg.h
>

10 
	~<Ãt/if.h
>

11 
	~<sys/ioùl.h
>

12 
	~<¬·/š‘.h
>

13 
	~<”ºo.h
>

14 
	~<uni¡d.h
>

15 
	$g‘LoÿlInfo
()

17 
fd
;

18 
š‹rçûNum
 = 0;

19 
iäeq
 
buf
[16];

20 
ifcÚf
 
ifc
;

21 
iäeq
 
iäcİy
;

22 
mac
[16] = {0};

23 

[32] = {0};

24 
brßdAddr
[32] = {0};

25 
subÃtMask
[32] = {0};

27 ià((
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0)

29 
	`³¼Ü
("socket");

30 
	`şo£
(
fd
);

34 
ifc
.
ifc_Ën
 = (
buf
);

35 
ifc
.
ifc_buf
 = (
ÿddr_t
)
buf
;

36 ià(!
	`ioùl
(
fd
, 
SIOCGIFCONF
, (*)&
ifc
))

38 
š‹rçûNum
 = 
ifc
.
ifc_Ën
 / (
iäeq
);

39 
	`´štf
("š‹rçû‚um = %d\n", 
š‹rçûNum
);

40 
š‹rçûNum
-- > 0)

42 
	`´štf
("\ndeviû‚ame: %s\n", 
buf
[
š‹rçûNum
].
iä_Çme
);

45 
iäcİy
 = 
buf
[
š‹rçûNum
];

46 ià(
	`ioùl
(
fd
, 
SIOCGIFFLAGS
, &
iäcİy
))

48 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

49 
	`şo£
(
fd
);

54 ià(!
	`ioùl
(
fd
, 
SIOCGIFHWADDR
, (*)(&
buf
[
š‹rçûNum
])))

56 
	`mem£t
(
mac
, 0, (mac));

57 
	`¢´štf
(
mac
, (mac), "%02x%02x%02x%02x%02x%02x",

58 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[0],

59 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[1],

60 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[2],

61 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[3],

62 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[4],

63 ()
buf
[
š‹rçûNum
].
iä_hwaddr
.
§_d©a
[5]);

64 
	`´štf
("deviû mac: %s\n", 
mac
);

68 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

69 
	`şo£
(
fd
);

74 ià(!
	`ioùl
(
fd
, 
SIOCGIFADDR
, (*)&
buf
[
š‹rçûNum
]))

76 
	`¢´štf
(

, (ip), "%s",

77 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_addr
))->
sš_addr
));

78 
	`´štf
("deviû ip: %s\n", 

);

82 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

83 
	`şo£
(
fd
);

88 ià(!
	`ioùl
(
fd
, 
SIOCGIFBRDADDR
, &
buf
[
š‹rçûNum
]))

90 
	`¢´štf
(
brßdAddr
, (broadAddr), "%s",

91 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_brßdaddr
))->
sš_addr
));

92 
	`´štf
("deviû brßdAddr: %s\n", 
brßdAddr
);

96 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

97 
	`şo£
(
fd
);

102 ià(!
	`ioùl
(
fd
, 
SIOCGIFNETMASK
, &
buf
[
š‹rçûNum
]))

104 
	`¢´štf
(
subÃtMask
, (subnetMask), "%s",

105 (*)
	`š‘_Áß
(((
sockaddr_š
 *)&(
buf
[
š‹rçûNum
].
iä_Ãtmask
))->
sš_addr
));

106 
	`´štf
("deviû subÃtMask: %s\n", 
subÃtMask
);

110 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

111 
	`şo£
(
fd
);

118 
	`´štf
("ioùl: % [%s:%d]\n", 
	`¡»¼Ü
(
”ºo
), 
__FILE__
, 
__LINE__
);

119 
	`şo£
(
fd
);

123 
	`şo£
(
fd
);

126 
	}
}

128 
	$maš
()

130 
	`g‘LoÿlInfo
();

133 
	}
}

	@get_interface3/getinterface.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<¡dlib.h
>

12 
	~<sys/ty³s.h
>

13 
	~<Ãtš‘/š.h
>

14 
	~<Ãtdb.h
>

15 
	~<”ºo.h
>

16 
	~<uni¡d.h
>

18 
	~<sys/sock‘.h
>

19 
	~<Ãtš‘/š.h
>

20 
	~<¬·/š‘.h
>

21 *
	$g‘ho¡Çme_a
(){

22 *
Çme
;

23 
r
, 
Ën
 = 128;

25 
Çme
 = (*)
	`m®loc
(
Ën
);

26 (
r
 = 
	`g‘ho¡Çme
(
Çme
, 
Ën
)) < 0){

27 if(
”ºo
 =ğ
ENAMETOOLONG
){

28 
Ën
 *= 2;

29 
Çme
 = (*)
	`»®loc
Òame, 
Ën
);

36 if(
r
 < 0)

37  
NULL
;

39  
Çme
;

40 
	}
}

42 
	$g‘ho¡addr
(){

43 
i
 = 0;

44 *
ho¡Çme
;

45 
ho¡’t
 *
ho¡šfo
;

48 * 
·ddr
;

49 
ho¡Çme
 = 
	`g‘ho¡Çme_a
();

50 
	`´štf
("ho¡‚ami %s\r\n", 
ho¡Çme
);

51 
ho¡šfo
 = 
	`g‘ho¡byÇme
 (
ho¡Çme
);

52 
	`´štf
("num i %d\r\n", 
ho¡šfo
->
h_Ëngth
);

53 
	`´štf
("add»s i %d\r\n", *(*è
ho¡šfo
->
h_addr
);

54 
	`´štf
("ho¡‚ami %s\r\n", 
ho¡šfo
->
h_Çme
);

55 
·ddr
 = 
ho¡šfo
->
h_addr
;

56 
·ddr
)

58 
	`´štf
("IPAdd»ss:%s\r\n", 
	`š‘_Áß
(*((
š_addr
*)
·ddr
)));

59 
·ddr
 = 
ho¡šfo
->
h_addr_li¡
[++
i
];

62 
	}
}

64 
	$maš
()

66 
	`g‘ho¡addr
();

68 
	}
}

	@get_interface3/libtc/config.h

8 
	#HAVE_ALLOCA_H
 1

	)

11 
	#HAVE_DLFCN_H
 1

	)

14 
	#HAVE_INTTYPES_H
 1

	)

23 
	#HAVE_MEMORY_H
 1

	)

26 
	#HAVE_SNPRINTF
 1

	)

29 
	#HAVE_STDARG_H
 1

	)

32 
	#HAVE_STDINT_H
 1

	)

35 
	#HAVE_STDLIB_H
 1

	)

38 
	#HAVE_STRDUPA
 1

	)

41 
	#HAVE_STRINGS_H
 1

	)

44 
	#HAVE_STRING_H
 1

	)

47 
	#HAVE_STRSEP
 1

	)

50 
	#HAVE_SYS_STAT_H
 1

	)

53 
	#HAVE_SYS_TYPES_H
 1

	)

56 
	#HAVE_UNISTD_H
 1

	)

59 
	#PACKAGE
 "libtc"

	)

62 
	#PACKAGE_BUGREPORT
 ""

	)

65 
	#PACKAGE_NAME
 "libtc"

	)

68 
	#PACKAGE_STRING
 "libtø1.1.0"

	)

71 
	#PACKAGE_TARNAME
 "libtc"

	)

74 
	#PACKAGE_URL
 ""

	)

77 
	#PACKAGE_VERSION
 "1.1.0"

	)

80 
	#SIZEOF_CHAR
 1

	)

83 
	#SIZEOF_INT
 4

	)

86 
	#SIZEOF_LONG
 8

	)

89 
	#SIZEOF_LONG_LONG
 8

	)

92 
	#SIZEOF_SHORT
 2

	)

95 
	#STDC_HEADERS
 1

	)

98 
	#VERSION
 "1.1.0"

	)

102 #ià
defšed
 
AC_APPLE_UNIVERSAL_BUILD


103 #ià
defšed
 
__BIG_ENDIAN__


104 
	#WORDS_BIGENDIAN
 1

	)

107 #iâdeà
WORDS_BIGENDIAN


114 
	#YYTEXT_POINTER
 1

	)

118 #iâdeà
__ılu¥lus


	@get_interface3/libtc/include/tc.h

25 #iâdeà
_TC_H


26 
	#_TC_H


	)

28 
	#TC_LOCK_NONE
 0

	)

29 
	#TC_LOCK_SLOPPY
 1

	)

30 
	#TC_LOCK_STRICT
 2

	)

	@get_interface3/libtc/include/tcalloc.h

25 #iâdeà
_TCALLOC_H


26 
	#_TCALLOC_H


	)

28 
	~<tùy³s.h
>

30 #ifdeà
__ılu¥lus


34 (*
tc_»f_â
)(*);

35 *(*
	ttÿ‰r_»f_t
)(*);

37 
	stÿ‰r
 {

38 *
Çme
;

39 *
v®ue
;

40 } 
	ttÿ‰r_t
;

42 *
tÿÎoc
(
size_t
);

43 *
tÿÎocd
(
size_t
, 
tc_»f_â
, 
tcä“_â
);

44 *
tÿÎocz
(
size_t
);

45 *
tÿÎocdz
(
size_t
, 
tc_»f_â
, 
tcä“_â
);

46 *
tüef
(*);

47 
tcä“
(*);

49 
tÿ‰r_£t
(*
p
, *
Çme
, *
v®
,

50 
tÿ‰r_»f_t
 
r
, 
tcä“_â
 
f
);

51 *
tÿ‰r_g‘
(*
p
, *
Çme
);

52 
tÿ‰r_g‘®l
(*
±r
, 
n
, 
tÿ‰r_t
 *
©Œ
);

53 
tÿ‰r_d–
(*
p
, *
Çme
);

55 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcbyteswap.h

25 #iâdeà
_TCBYTESWAP_H


26 
	#_TCBYTESWAP_H


	)

29 
	~<tûndŸn.h
>

	@get_interface3/libtc/include/tcconf.h

25 #iâdeà
_TCCONF_H


26 
	#_TCCONF_H


	)

28 
	~<¡dio.h
>

29 
	~<tùy³s.h
>

31 #ifdeà
__ılu¥lus


35 
tccÚf_£ùiÚ
 
	ttccÚf_£ùiÚ_t
;

37 
tccÚf_£ùiÚ_t
 *
tccÚf_lßd
ÑccÚf_£ùiÚ_ˆ*, *, 
tcio_â
);

38 
tccÚf_£ùiÚ_t
 *
tccÚf_lßd_fe
ÑccÚf_£ùiÚ_ˆ*, *
fe
);

39 
tccÚf_£ùiÚ_t
 *
tccÚf_lßd_¡ršg
ÑccÚf_£ùiÚ_ˆ*
£c
,

40 cÚ¡ *
cÚf
, 
size
);

41 
tccÚf_wr™e
(
tccÚf_£ùiÚ_t
 *
tcc
, *
fe
, 
tcio_â
);

42 
tccÚf_£ùiÚ_t
 *
tccÚf_g‘£ùiÚ
ÑccÚf_£ùiÚ_ˆ*
£c
, *
Çme
);

43 
tccÚf_g‘v®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, *
fmt
, ...);

44 
tccÚf_£tv®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, *
fmt
, ...);

45 
tccÚf_£ùiÚ_t
 *
tccÚf_Ãw
(*
Çme
);

46 
tccÚf_ş—rv®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
);

47 
tccÚf_Ãxtv®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, **
¡©e
,

48 *
fmt
, ...);

49 
tccÚf_Ãxtv®ue_g
(
tccÚf_£ùiÚ_t
 *
£c
, *
glob
, **
¡©e
,

50 **
Çme
, *
fmt
, ...);

51 
tccÚf_£ùiÚ_t
 *
tccÚf_Ãxt£ùiÚ
ÑccÚf_£ùiÚ_ˆ*
£c
, *
Çme
,

52 **
¡©e
);

53 
tccÚf_£ùiÚ_t
 *
tccÚf_m”ge
ÑccÚf_£ùiÚ_ˆ*
d¡
,

54 
tccÚf_£ùiÚ_t
 *
¤c
);

56 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcdirent.h

25 #iâdeà
_TCDIRENT_H


26 
	#_TCDIRENT_H


	)

28 
	~<dœ’t.h
>

30 
tcmk·th
(*
·th
, 
mode
);

31 *
tı©h_fšd
(*
Çme
, *
·th
, 
how
);

	@get_interface3/libtc/include/tcendian.h

25 #iâdeà
_TCENDIAN_H


26 
	#_TCENDIAN_H


	)

28 
	#TCENDIAN_LITTLE
 1

	)

29 
	#TCENDIAN_BIG
 2

	)

31 
	~<by‹sw­.h
>

32 
	#TCENDIAN
 
TCENDIAN_LITTLE


	)

34 
	#htŞ_16
(
x
è(x)

	)

35 
	#htŞ_32
(
x
è(x)

	)

36 
	#htŞ_64
(
x
è(x)

	)

38 
	#htob_16
(
x
è(
	`bsw­_16
(x))

	)

39 
	#htob_32
(
x
è(
	`bsw­_32
(x))

	)

40 
	#htob_64
(
x
è(
	`bsw­_64
(x))

	)

	@get_interface3/libtc/include/tchash.h

25 #iâdeà
_TCHASH_H


26 
	#_TCHASH_H


	)

28 
	~<tùy³s.h
>

29 
	~<tc.h
>

31 #ifdeà
__ılu¥lus


35 
tchash_bË
 
	ttchash_bË_t
;

36 
u_št
 (*
	ttchash_funùiÚ_t
)(*
	tkey
, 
	tsize_t
 
	tsize
);

39 
	#TCHASH_FROZEN
 0x01

	)

40 
	#TCHASH_NOCOPY
 0x02

	)

44 
tchash_bË_t
 *
tchash_Ãw
(
size
, 
lock
, 
ušt32_t
 
æags
);

49 
tchash_£¬ch
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
,

50 *
d©a
, *
»t
);

54 
tchash_fšd
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
»t
);

58 
tchash_»¶aû
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
,

59 *
d©a
, *
»t
);

63 
tchash_d–‘e
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
»t
);

66 
tchash_de¡roy
(
tchash_bË_t
 *
ht
, 
tcä“_â
 
hf
);

69 
tchash_»hash
(
tchash_bË_t
 *
ht
);

75 **
tchash_keys
(
tchash_bË_t
 *
ht
, *
’Œ›s
, 
ç¡
);

77 
tchash_£thashfunùiÚ
(
tchash_bË_t
 *
ht
, 
tchash_funùiÚ_t
 
hf
);

78 
tchash_£‰h»shŞds
(
tchash_bË_t
 *
ht
, 
low
, 
high
);

80 
tchash_g‘æags
(
tchash_bË_t
 *
ht
);

81 
tchash_£tæags
(
tchash_bË_t
 *
ht
, 
æags
);

82 
tchash_£tæag
(
tchash_bË_t
 *
ht
, 
æag
);

83 
tchash_ş—ræag
(
tchash_bË_t
 *
ht
, 
æag
);

85 #ifdeà
TCHASH_OLDAPI


86 
	#tchash_Ãw
(
s
, 
f
è
	`tchash_Ãw
(s, 
TC_LOCK_STRICT
, f)

	)

87 
	#tchash_£¬ch
(
h
, 
k
, 
d
, 
r
è
	`tchash_£¬ch
(h, k, -1, d,„)

	)

88 
	#tchash_fšd
(
h
, 
k
, 
r
è
	`tchash_fšd
(h, k, -1,„)

	)

89 
	#tchash_»¶aû
(
h
, 
k
, 
d
è
	`tchash_»¶aû
(h, k, -1, d, 
NULL
)

	)

90 
	#tchash_d–‘e
(
h
, 
k
, 
r
è
	`tchash_d–‘e
(h, k, -1,„)

	)

93 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tclist.h

25 #iâdeà
_TCLIST_H


26 
	#_TCLIST_H


	)

28 
	~<¡dlib.h
>

29 
	~<tùy³s.h
>

30 
	~<tc.h
>

32 #ifdeà
__ılu¥lus


36 
tşi¡_™em
 
	ttşi¡_™em_t
;

37 
tşi¡
 
	ttşi¡_t
;

41 
tşi¡_t
 *
tşi¡_Ãw
(
lockšg
);

44 
tşi¡_ä“
(
tşi¡_t
 *);

47 
tşi¡_de¡roy
(
tşi¡_t
 *
l¡
, 
tcä“_â
 
lä“
);

50 
tşi¡_»move
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
, 
tcä“_â
 
ä
);

53 
tşi¡_push
(
tşi¡_t
 *
l¡
, *
p
);

56 
tşi¡_unshiá
(
tşi¡_t
 *
l¡
, *
p
);

59 *
tşi¡_shiá
(
tşi¡_t
 *
l¡
);

62 *
tşi¡_pİ
(
tşi¡_t
 *
l¡
);

66 
tşi¡_fšd
(
tşi¡_t
 *
l¡
, *
p
, *
»t
, 
tccom·»_â
 
cmp
);

70 
tşi¡_£¬ch
(
tşi¡_t
 *
l¡
, *
p
, *
»t
, 
tccom·»_â
 
cmp
);

73 
tşi¡_d–‘e
(
tşi¡_t
 *
l¡
, *
p
, 
tccom·»_â
 
cmp
, 
tcä“_â
);

76 
tşi¡_d–‘e_m©ched
(
tşi¡_t
 *
l¡
, *
p
, 
tccom·»_â
 
cmp
,

77 
tcä“_â
);

79 *
tşi¡_Ãxt
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
);

80 *
tşi¡_Ãxt_m©ched
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
,

81 *
key
, 
tccom·»_â
 
cmp
);

83 *
tşi¡_´ev
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
);

84 *
tşi¡_´ev_m©ched
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
,

85 *
key
, 
tccom·»_â
 
cmp
);

88 
tşi¡_uÆock
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
);

91 
tşi¡_™ems
(
tşi¡_t
 *
l¡
);

93 
tşi¡_isfœ¡
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
li
);

95 
tşi¡_i¦a¡
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
li
);

97 *
tşi¡_h—d
(
tşi¡_t
 *
l¡
);

98 *
tşi¡_
(
tşi¡_t
 *
l¡
);

100 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcmath.h

25 #iâdeà
_TCMATH_H


26 
	#_TCMATH_H


	)

28 #ifdeà
__ılu¥lus


32 
	stcäaùiÚ
 {

33 
num
, 
d’
;

34 } 
	ttcäaùiÚ_t
;

36 
tüeduû
(
tcäaùiÚ_t
 *);

38 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcmempool.h

25 #iâdeà
_TCMEMPOOL_H


26 
	#_TCMEMPOOL_H


	)

28 #ifdeà
__ılu¥lus


32 
tcmempoŞ
 
	ttcmempoŞ_t
;

34 
tcmempoŞ_t
 *
tcmempoŞ_Ãw
(
size_t
 
size
, 
lock
);

35 *
tcmempoŞ_g‘
(
tcmempoŞ_t
 *
mp
);

36 
tcmempoŞ_ä“
(*
p
);

38 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcnet.h

25 #iâdeà
_TCNET_H


26 
	#_TCNET_H


	)

28 #ifdeà
__ılu¥lus


32 *
g‘ho¡Çme_a
();

33 
g‘ho¡addr
();

35 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcprioq.h

25 #iâdeà
_TCPRIOQ_H


26 
	#_TCPRIOQ_H


	)

28 
	~<tc.h
>

29 
	~<tùy³s.h
>

31 #ifdeà
__ılu¥lus


35 
tırioq
 
	ttırioq_t
;

37 
tırioq_t
 *
tırioq_Ãw
(
size
, 
lock
, 
tccom·»_â
 
cmp
);

38 
tırioq_add
(
tırioq_t
 *
pq
, *
d©a
);

39 
tırioq_g‘
(
tırioq_t
 *
pq
, **
»t
);

40 
tırioq_™ems
(
tırioq_t
 *
pq
);

41 
tırioq_ä“
(
tırioq_t
 *
pq
);

43 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tcstring.h

25 #iâdef 
_TCSTRING_H


26 
	#_TCSTRING_H
 1

	)

29 #iâdeà
_REENTRANT


30 
	#_REENTRANT


	)

33 
	~<¡dlib.h
>

34 
	~<¡d¬g.h
>

36 #iâdeà
_GNU_SOURCE


37 
	#_GNU_SOURCE


	)

40 
	~<¡ršg.h
>

43 #iâdeà
¡rdu·


44 #ifdeà
__GNUC__


45 
	#¡rdu·
(
s
) \

47 cÚ¡ *
__Şd
 = (
s
); \

48 
size_t
 
__Ën
 = 
	`¡¾’
(
__Şd
) + 1; \

49 *
__Ãw
 = 
	`®loÿ
(
__Ën
); \

50 (*è
	`memıy
(
__Ãw
, 
__Şd
, 
__Ën
); \

51 })

	)

55 
tc¡»sc
(*
d¡
, cÚ¡ *
¤c
);

57 *
tc¡»xp
(cÚ¡ *
¤c
, cÚ¡ *
sd
, cÚ¡ *
ed
,

58 
fs
, *(*
lookup
)(*, *), *
ld
,

59 
æags
);

61 
	#TCSTREXP_ESCAPE
 0x1

	)

62 
	#TCSTREXP_FREE
 0x2

	)

63 
	#TCSTREXP_KEEPUNDEF
 0x4

	)

65 *
tüegsub
(cÚ¡ *
¡r
, cÚ¡ *
·t
,

66 cÚ¡ *
sub
, 
æags
);

	@get_interface3/libtc/include/tctime.h

25 #iâdeà
_TCTIME_H


26 
	#_TCTIME_H


	)

28 
	~<time.h
>

29 
	~<sys/time.h
>

31 #ifdeà
__ılu¥lus


35 *
¡¹Ùime
(*
time
, 
tm
 *tm, **
fmts
);

37 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tctree.h

25 #iâdeà
_TCTREE_H


26 
	#_TCTREE_H


	)

28 
	~<tc.h
>

29 
	~<tùy³s.h
>

31 #ifdeà
__ılu¥lus


35 
tù»e
 
	ttù»e_t
;

37 
tù»e_t
 *
tù»e_Ãw
(
lockšg
, 
tccom·»_â
 
cmp
, 
ušt32_t
 
æags
);

38 
tù»e_fšd
(
tù»e_t
 *
t
, *
key
, *
»t
);

39 
tù»e_£¬ch
(
tù»e_t
 *
t
, *
key
, *
»t
);

40 
tù»e_»¶aû
(
tù»e_t
 *
t
, *
key
, *
»t
);

41 
tù»e_d–‘e
(
tù»e_t
 *
t
, *
key
, *
»t
);

42 
tù»e_de¡roy
(
tù»e_t
 *
t
, 
tcä“_â
 
f
);

44 #ifdeà
__ılu¥lus


	@get_interface3/libtc/include/tctypes.h

25 #iâdeà
_TCTYPES_H


26 
	#_TCTYPES_H


	)

28 
	~<sys/ty³s.h
>

29 
	~<¡dšt.h
>

40 #ifdeà
__GNUC__


41 
	#_uÇligÃd
(
s
) \

42 
_uÇligÃd
##
s
 { \

43 
ušt
##
s
##
_t
 
i
; \

44 } 
	`__©Œibu‹__
((
·cked
)); \

46 
šlše
 
ušt
##
s
##
_t
 \

47 
uÇligÃd
##
	`s
(cÚ¡ *
v
){ \

48  ((cÚ¡ 
_uÇligÃd
##
s
 *è
v
)->
i
; \

51 
šlše
 \

52 
¡_uÇligÃd
##
	`s
(
ušt
##
s
##
_t
 
v
, *
d
) \

54 ((
_uÇligÃd
##
s
 *è
d
)->
i
 = 
v
; \

55 }

	)

57 
	~<¡ršg.h
>

58 
	#_uÇligÃd
(
s
) \

59 
šlše
 
ušt
##
s
##
_t
 \

60 
uÇligÃd
##
	`s
(cÚ¡ *
v
){ \

61 
ušt
##
s
##
_t
 
i
; \

62 
	`memıy
(&
i
, 
v
, (i)); \

63  
i
; \

66 
šlše
 \

67 
¡_uÇligÃd
##
	`s
(
ušt
##
s
##
_t
 
v
, *
d
){ \

68 
	`memıy
(
d
, &
v
, (v)); \

69 }

	)

72 
	$_uÇligÃd
(16)

73 
	$_uÇligÃd
(32)

74 
	$_uÇligÃd
(64)

76 (*
	ttccom·»_â
) (const *, const *);

77 (*
	ttcä“_â
) (*);

78 
	$size_t
 (*
	ttcio_â
)(*, 
	tsize_t
, size_t, *);

	@get_interface3/libtc/src/alloc.c

25 
	~<tÿÎoc.h
>

26 
	~<¡dlib.h
>

27 
	~<¡ddef.h
>

28 
	~<¡ršg.h
>

30 
	stÿ‰ri
 {

31 *
	mÇme
;

32 *
	mv®ue
;

33 
tÿ‰r_»f_t
 
	m»f
;

34 
tcä“_â
 
	mä“
;

35 
tÿ‰ri
 *
	mÃxt
;

36 } 
	ttÿ‰ri_t
;

38 
	stÿÎoc
 {

39 
	mrc
;

40 
tc_»f_â
 
	m»f
;

41 
tcä“_â
 
	mä“
;

42 
tÿ‰ri_t
 *
	m©Œ
;

44 
	ml
;

45 
	md
;

46 *
	mp
;

47 } 
	md©a
[1];

48 } 
	ttÿÎoc_t
;

50 
tÿ‰r_ä“
(
tÿ‰ri_t
 *
a
);

53 
	$tÿÎocd
(
size_t
 
size
, 
tc_»f_â
 
r
, 
tcä“_â
 
f
)

55 
tÿÎoc_t
 *
tÿ
 = 
	`m®loc
(
size
 + ÑÿÎoc_tè- Ñÿ->
d©a
));

56 
tÿ
->
rc
 = 1;

57 
tÿ
->
»f
 = 
r
;

58 
tÿ
->
ä“
 = 
f
;

59 
tÿ
->
©Œ
 = 
NULL
;

60  
tÿ
->
d©a
;

61 
	}
}

64 
	$tÿÎocdz
(
size_t
 
size
, 
tc_»f_â
 
r
, 
tcä“_â
 
f
)

66 *
p
 = 
	`tÿÎocd
(
size
, 
r
, 
f
);

67 if(
p
)

68 
	`mem£t
(
p
, 0, 
size
);

69  
p
;

70 
	}
}

73 
	$tÿÎoc
(
size_t
 
size
)

75  
	`tÿÎocd
(
size
, 
NULL
, NULL);

76 
	}
}

79 
	$tÿÎocz
(
size_t
 
size
)

81  
	`tÿÎocdz
(
size
, 
NULL
, NULL);

82 
	}
}

85 
	$tüef
(*
±r
)

87 
tÿÎoc_t
 *
tÿ
 = (tÿÎoc_ˆ*)((*è
±r
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

88 
tÿ
->
rc
++;

89 if(
tÿ
->
»f
)

90 
tÿ
->
	`»f
Ñÿ->
d©a
);

91  
±r
;

92 
	}
}

95 
	$tcä“
(*
±r
)

97 
tÿÎoc_t
 *
tÿ
;

99 if(!
±r
)

102 
tÿ
 = (
tÿÎoc_t
 *)((*è
±r
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

103 
tÿ
->
rc
--;

104 if(!
tÿ
->
rc
){

105 
tÿ‰ri_t
 *
a
;

107 if(
tÿ
->
ä“
)

108 
tÿ
->
	`ä“
Ñÿ->
d©a
);

109 
a
 = 
tÿ
->
©Œ
;‡;){

110 
tÿ‰ri_t
 *
n
 = 
a
->
Ãxt
;

111 
	`tÿ‰r_ä“
(
a
);

112 
a
 = 
n
;

114 
	`ä“
(
tÿ
);

116 
	}
}

119 
	$tÿ‰r_ä“
(
tÿ‰ri_t
 *
a
)

121 
	`ä“
(
a
->
Çme
);

122 if(
a
->
ä“
)

123 
a
->
	`ä“
×->
v®ue
);

124 
	`ä“
(
a
);

125 
	}
}

128 
	$tÿ‰r_£t
(*
±r
, *
Çme
, *
v®
, 
tÿ‰r_»f_t
 
r
, 
tcä“_â
 
f
)

130 
tÿÎoc_t
 *
tÿ
 = (tÿÎoc_ˆ*)((*è
±r
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

131 
tÿ‰ri_t
 *
a
, *
n
, *
p
 = 
NULL
;

133 
a
 = 
tÿ
->
©Œ
;‡ &&‡->
Ãxt
 && 
	`¡rcmp
(
Çme
,‡->name);‡ =‡->next)

134 
p
 = 
a
;

136 
n
 = 
	`ÿÎoc
(1, (*n));

137 
n
->
Çme
 = 
	`¡rdup
(name);

138 
n
->
v®ue
 = 
v®
;

139 
n
->
»f
 = 
r
;

140 
n
->
ä“
 = 
f
;

142 if(!
a
){

143 
tÿ
->
©Œ
 = 
n
;

144 } if(
	`¡rcmp
(
Çme
, 
a
->name)){

145 
a
->
Ãxt
 = 
n
;

147 
n
->
Ãxt
 = 
a
->next;

148 if(
p
)

149 
p
->
Ãxt
 = 
n
;

151 
tÿ
->
©Œ
 = 
n
;

152 
	`tÿ‰r_ä“
(
a
);

156 
	}
}

159 
	$tÿ‰r_g‘
(*
p
, *
Çme
)

161 
tÿÎoc_t
 *
tÿ
 = (tÿÎoc_ˆ*)((*è
p
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

162 
tÿ‰ri_t
 *
a
;

163 *
v
 = 
NULL
;

165 
a
 = 
tÿ
->
©Œ
;‡ && 
	`¡rcmp
(
Çme
,‡->Çme);‡ =‡->
Ãxt
);

167 if(
a
)

168 
v
 = 
a
->
»f
?‡->
	`»f
×->
v®ue
):‡->value;

170  
v
;

171 
	}
}

174 
	$tÿ‰r_g‘®l
(*
p
, 
n
, 
tÿ‰r_t
 *
©Œ
)

176 
tÿÎoc_t
 *
tÿ
 = (tÿÎoc_ˆ*)((*è
p
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

177 
tÿ‰ri_t
 *
a
;

178 
i
;

180 
i
 = 0, 
a
 = 
tÿ
->
©Œ
;‡ && i < 
n
;‡ =‡->
Ãxt
, i++){

181 
©Œ
[
i
].
Çme
 = 
a
->name;

182 
©Œ
[
i
].
v®ue
 = 
a
->
»f
?‡->
	`»f
(a->value):‡->value;

185  
i
;

186 
	}
}

189 
	$tÿ‰r_d–
(*
±r
, *
Çme
)

191 
tÿÎoc_t
 *
tÿ
 = (tÿÎoc_ˆ*)((*è
±r
 - 
	`off£tof
ÑÿÎoc_t, 
d©a
));

192 
tÿ‰ri_t
 *
a
, *
p
 = 
NULL
;

194 
a
 = 
tÿ
->
©Œ
;‡ && 
	`¡rcmp
(
Çme
,‡->Çme);‡ =‡->
Ãxt
)

195 
p
 = 
a
;

197 if(
a
){

198 if(
p
)

199 
p
->
Ãxt
 = 
a
->next;

201 
tÿ
->
©Œ
 = 
a
->
Ãxt
;

202 
	`tÿ‰r_ä“
(
a
);

206 
	}
}

	@get_interface3/libtc/src/conf-parse.c

7 
	#FLEX_SCANNER


	)

8 
	#YY_FLEX_MAJOR_VERSION
 2

	)

9 
	#YY_FLEX_MINOR_VERSION
 5

	)

11 
	~<¡dio.h
>

15 #ifdeà
c_¶u¥lus


16 #iâdeà
__ılu¥lus


17 
	#__ılu¥lus


	)

22 #ifdeà
__ılu¥lus


24 
	~<¡dlib.h
>

25 
	~<uni¡d.h
>

28 
	#YY_USE_PROTOS


	)

31 
	#YY_USE_CONST


	)

35 #ià
__STDC__


37 
	#YY_USE_PROTOS


	)

38 
	#YY_USE_CONST


	)

43 #ifdeà
__TURBOC__


44 #´agm¨
w¬n
 -
rch


45 #´agm¨
w¬n
 -
u£


46 
	~<io.h
>

47 
	~<¡dlib.h
>

48 
	#YY_USE_CONST


	)

49 
	#YY_USE_PROTOS


	)

52 #ifdeà
YY_USE_CONST


53 
	#yycÚ¡
 cÚ¡

	)

55 
	#yycÚ¡


	)

59 #ifdeà
YY_USE_PROTOS


60 
	#YY_PROTO
(
´Ùo
è
	)
´Ùo

62 
	#YY_PROTO
(
´Ùo
è()

	)

66 
	#YY_NULL
 0

	)

73 
	#YY_SC_TO_UI
(
c
è((è(èc)

	)

79 
	#BEGIN
 
yy_¡¬t
 = 1 + 2 *

	)

85 
	#YY_START
 ((
yy_¡¬t
 - 1è/ 2)

	)

86 
	#YYSTATE
 
YY_START


	)

89 
	#YY_STATE_EOF
(
¡©e
è(
YY_END_OF_BUFFER
 + s‹ + 1)

	)

92 
	#YY_NEW_FILE
 
	`yy»¡¬t
Ğ
yyš
 )

	)

94 
	#YY_END_OF_BUFFER_CHAR
 0

	)

97 
	#YY_BUF_SIZE
 16384

	)

99 
yy_bufãr_¡©e
 *
	tYY_BUFFER_STATE
;

101 
yyËng
;

102 
FILE
 *
yyš
, *
yyout
;

104 
	#EOB_ACT_CONTINUE_SCAN
 0

	)

105 
	#EOB_ACT_END_OF_FILE
 1

	)

106 
	#EOB_ACT_LAST_MATCH
 2

	)

124 
	#yyËss
(
n
) \

128 *
yy_ı
 = 
yy_hŞd_ch¬
; \

129 
YY_RESTORE_YY_MORE_OFFSET
 \

130 
yy_c_buf_p
 = 
yy_ı
 = 
yy_bp
 + 
n
 - 
YY_MORE_ADJ
; \

131 
YY_DO_BEFORE_ACTION
; \

133  0 )

	)

135 
	#uÅut
(
c
è
	`yyuÅut
Ğc, 
yy‹xt_±r
 )

	)

141 
	tyy_size_t
;

144 
	syy_bufãr_¡©e


146 
FILE
 *
	myy_šput_fe
;

148 *
	myy_ch_buf
;

149 *
	myy_buf_pos
;

154 
yy_size_t
 
	myy_buf_size
;

159 
	myy_n_ch¬s
;

165 
	myy_is_our_bufãr
;

172 
	myy_is_š‹¿ùive
;

178 
	myy_©_bŞ
;

183 
	myy_fl_bufãr
;

185 
	myy_bufãr_¡©us
;

186 
	#YY_BUFFER_NEW
 0

	)

187 
	#YY_BUFFER_NORMAL
 1

	)

198 
	#YY_BUFFER_EOF_PENDING
 2

	)

201 
YY_BUFFER_STATE
 
	gyy_cu¼’t_bufãr
 = 0;

207 
	#YY_CURRENT_BUFFER
 
yy_cu¼’t_bufãr


	)

211 
	gyy_hŞd_ch¬
;

213 
	gyy_n_ch¬s
;

216 
	gyyËng
;

219 *
	gyy_c_buf_p
 = (*) 0;

220 
	gyy_š™
 = 1;

221 
	gyy_¡¬t
 = 0;

226 
	gyy_did_bufãr_sw™ch_Ú_eof
;

228 
yy»¡¬t
 
YY_PROTO
(Ğ
FILE
 *
šput_fe
 ));

230 
yy_sw™ch_to_bufãr
 
YY_PROTO
(Ğ
YY_BUFFER_STATE
 
Ãw_bufãr
 ));

231 
yy_lßd_bufãr_¡©e
 
YY_PROTO
(( ));

232 
YY_BUFFER_STATE
 
yy_ü—‹_bufãr
 
YY_PROTO
(Ğ
FILE
 *
fe
, 
size
 ));

233 
yy_d–‘e_bufãr
 
YY_PROTO
(Ğ
YY_BUFFER_STATE
 
b
 ));

234 
yy_š™_bufãr
 
YY_PROTO
(Ğ
YY_BUFFER_STATE
 
b
, 
FILE
 *
fe
 ));

235 
yy_æush_bufãr
 
YY_PROTO
(Ğ
YY_BUFFER_STATE
 
b
 ));

236 
	#YY_FLUSH_BUFFER
 
	`yy_æush_bufãr
Ğ
yy_cu¼’t_bufãr
 )

	)

238 
YY_BUFFER_STATE
 
yy_sÿn_bufãr
 
YY_PROTO
(Ğ*
ba£
, 
yy_size_t
 
size
 ));

239 
YY_BUFFER_STATE
 
yy_sÿn_¡ršg
 
YY_PROTO
(Ğ
yycÚ¡
 *
yy_¡r
 ));

240 
YY_BUFFER_STATE
 
yy_sÿn_by‹s
 
YY_PROTO
(Ğ
yycÚ¡
 *
by‹s
, 
Ën
 ));

242 *
yy_æex_®loc
 
YY_PROTO
(Ğ
yy_size_t
 ));

243 *
yy_æex_»®loc
 
YY_PROTO
(Ğ*, 
yy_size_t
 ));

244 
yy_æex_ä“
 
YY_PROTO
(( * ));

246 
	#yy_Ãw_bufãr
 
yy_ü—‹_bufãr


	)

248 
	#yy_£t_š‹¿ùive
(
is_š‹¿ùive
) \

250 iàĞ! 
yy_cu¼’t_bufãr
 ) \

251 
yy_cu¼’t_bufãr
 = 
	`yy_ü—‹_bufãr
Ğ
yyš
, 
YY_BUF_SIZE
 ); \

252 
yy_cu¼’t_bufãr
->
yy_is_š‹¿ùive
 = 
is_š‹¿ùive
; \

253 }

	)

255 
	#yy_£t_bŞ
(
©_bŞ
) \

257 iàĞ! 
yy_cu¼’t_bufãr
 ) \

258 
yy_cu¼’t_bufãr
 = 
	`yy_ü—‹_bufãr
Ğ
yyš
, 
YY_BUF_SIZE
 ); \

259 
yy_cu¼’t_bufãr
->
yy_©_bŞ
 = 
©_bŞ
; \

260 }

	)

262 
	#YY_AT_BOL
(è(
yy_cu¼’t_bufãr
->
yy_©_bŞ
)

	)

265 
	#YY_USES_REJECT


	)

267 
	#yyw¿p
(è1

	)

268 
	#YY_SKIP_YYWRAP


	)

269 
	tYY_CHAR
;

270 
FILE
 *
	gyyš
 = (FILE *è0, *
	gyyout
 = (FILE *) 0;

271 
	tyy_¡©e_ty³
;

272 *
yy‹xt
;

273 
	#yy‹xt_±r
 
yy‹xt


	)

275 
yy_¡©e_ty³
 
yy_g‘_´evious_¡©e
 
YY_PROTO
(( ));

276 
yy_¡©e_ty³
 
yy_Œy_NUL_Œªs
 
YY_PROTO
(Ğyy_¡©e_ty³ 
cu¼’t_¡©e
 ));

277 
yy_g‘_Ãxt_bufãr
 
YY_PROTO
(( ));

278 
yy_çl_”rÜ
 
YY_PROTO
(Ğ
yycÚ¡
 
msg
[] ));

283 
	#YY_DO_BEFORE_ACTION
 \

284 
yy‹xt_±r
 = 
yy_bp
; \

285 
yyËng
 = (è(
yy_ı
 - 
yy_bp
); \

286 
yy_hŞd_ch¬
 = *
yy_ı
; \

287 *
yy_ı
 = '\0'; \

288 
yy_c_buf_p
 = 
yy_ı
;

	)

290 
	#YY_NUM_RULES
 24

	)

291 
	#YY_END_OF_BUFFER
 25

	)

292 
yycÚ¡
 
	gyy_acşi¡
[191] =

316 
yycÚ¡
 
	gyy_acû±
[116] =

333 
yycÚ¡
 
	gyy_ec
[256] =

365 
yycÚ¡
 
	gyy_m‘a
[36] =

373 
yycÚ¡
 
	gyy_ba£
[128] =

391 
yycÚ¡
 
	gyy_def
[128] =

409 
yycÚ¡
 
	gyy_nxt
[632] =

483 
yycÚ¡
 
	gyy_chk
[632] =

557 
yy_¡©e_ty³
 
	gyy_¡©e_buf
[
YY_BUF_SIZE
 + 2], *
	gyy_¡©e_±r
;

558 *
	gyy_fuÎ_m©ch
;

559 
	gyy_Í
;

560 
	gyy_lookšg_fÜ_Œa_begš
 = 0;

561 
	gyy_fuÎ_Í
;

562 *
	gyy_fuÎ_¡©e
;

563 
	#YY_TRAILING_MASK
 0x2000

	)

564 
	#YY_TRAILING_HEAD_MASK
 0x4000

	)

565 
	#REJECT
 \

567 *
yy_ı
 = 
yy_hŞd_ch¬
; \

568 
yy_ı
 = 
yy_fuÎ_m©ch
; \

569 
yy_Í
 = 
yy_fuÎ_Í
; \

570 
yy_¡©e_±r
 = 
yy_fuÎ_¡©e
; \

571 
yy_cu¼’t_¡©e
 = *
yy_¡©e_±r
; \

572 ++
yy_Í
; \

573 
fšd_ruË
; \

574 }

	)

575 
	#yymÜe
(è
yymÜe_u£d_but_nÙ_d‘eùed


	)

576 
	#YY_MORE_ADJ
 0

	)

577 
	#YY_RESTORE_YY_MORE_OFFSET


	)

578 *
	gyy‹xt
;

580 
	#INITIAL
 0

	)

604 
	#£ù
 1

	)

606 
	#p_v®
 2

	)

608 
	#s_m”ge
 3

	)

611 
	~<¡ršg.h
>

612 
	~<tşi¡.h
>

613 
	~<tÿÎoc.h
>

614 
	~"tccÚf.h
"

615 
	~"tcc-š‹º®.h
"

617 
	#yy‹rmš©e
() \

618 if(
£ùiÚ_¡ack
è
	`tşi¡_de¡roy
(£ùiÚ_¡ack, 
tcä“
); \

619 
YY_FLUSH_BUFFER
; \

620 
	`BEGIN
(
INITIAL
); \

621  
NULL


	)

623 
	#YY_DECL
 
cÚf_£ùiÚ
 *
	`tcc_Ëx
(*
d©a
, 
tcio_â
 
râ
, \

624 
cÚf_£ùiÚ
 *
£c
)

	)

626 
	#YY_INPUT
(
buf
,
»s
,
size
) { \

627 
»s
 = 
cÚf_fe
.
	`»ad
(
buf
, 1, 
size
, cÚf_fe.
d©a
); \

628 
»s
 =„e <ğ0? 
YY_NULL
:„es; \

629 }

	)

631 
	#PUSH_SECTION
(
q
, 
t
) do { \

632 
tcc_’Œy
 *
‹
; \

633 *
n
 = 
yy‹xt
+
q
; \

634 
yy‹xt
[
yyËng
-
q
] = 0; \

635 
‹
 = 
	`ü—‹_’Œy
(
cur_£ùiÚ
, 
n
, 
t
); \

636 
	`tşi¡_push
(
£ùiÚ_¡ack
, 
cur_£ùiÚ
); \

637 
cur_£ùiÚ
 = 
‹
->
£ùiÚ
; \

638 } 0)

	)

641 *
	md©a
;

642 
tcio_â
 
	m»ad
;

643 } 
	gcÚf_fe
;

651 #iâdeà
YY_SKIP_YYWRAP


652 #ifdeà
__ılu¥lus


653 "C" 
yyw¿p
 
YY_PROTO
(( ));

655 
yyw¿p
 
YY_PROTO
(( ));

659 #iâdeà
YY_NO_UNPUT


660 
yyuÅut
 
YY_PROTO
(Ğ
c
, *
buf_±r
 ));

663 #iâdeà
yy‹xt_±r


664 
yy_æex_¡ºıy
 
YY_PROTO
(Ğ*, 
yycÚ¡
 *, ));

667 #ifdeà
YY_NEED_STRLEN


668 
yy_æex_¡¾’
 
YY_PROTO
(Ğ
yycÚ¡
 * ));

671 #iâdeà
YY_NO_INPUT


672 #ifdeà
__ılu¥lus


673 
yyšput
 
YY_PROTO
(( ));

675 
šput
 
YY_PROTO
(( ));

679 #ià
YY_STACK_USED


680 
	gyy_¡¬t_¡ack_±r
 = 0;

681 
	gyy_¡¬t_¡ack_d•th
 = 0;

682 *
	gyy_¡¬t_¡ack
 = 0;

683 #iâdeà
YY_NO_PUSH_STATE


684 
yy_push_¡©e
 
YY_PROTO
(Ğ
Ãw_¡©e
 ));

686 #iâdeà
YY_NO_POP_STATE


687 
yy_pİ_¡©e
 
YY_PROTO
(( ));

689 #iâdeà
YY_NO_TOP_STATE


690 
yy_tİ_¡©e
 
YY_PROTO
(( ));

694 
	#YY_NO_PUSH_STATE
 1

	)

695 
	#YY_NO_POP_STATE
 1

	)

696 
	#YY_NO_TOP_STATE
 1

	)

699 #ifdeà
YY_MALLOC_DECL


700 
	gYY_MALLOC_DECL


702 #ià
__STDC__


703 #iâdeà
__ılu¥lus


704 
	~<¡dlib.h
>

715 #iâdeà
YY_READ_BUF_SIZE


716 
	#YY_READ_BUF_SIZE
 8192

	)

721 #iâdeà
ECHO


725 
	#ECHO
 (è
	`fwr™e
Ğ
yy‹xt
, 
yyËng
, 1, 
yyout
 )

	)

731 #iâdeà
YY_INPUT


732 
	#YY_INPUT
(
buf
,
»suÉ
,
max_size
) \

733 iàĞ
yy_cu¼’t_bufãr
->
yy_is_š‹¿ùive
 ) \

735 
c
 = '*', 
n
; \

736  
n
 = 0;‚ < 
max_size
 && \

737 (
c
 = 
	`g‘c
Ğ
yyš
 )è!ğ
EOF
 && c !ğ'\n'; ++
n
 ) \

738 
buf
[
n
] = (è
c
; \

739 iàĞ
c
 == '\n' ) \

740 
buf
[
n
++] = (è
c
; \

741 iàĞ
c
 =ğ
EOF
 && 
	`ã¼Ü
Ğ
yyš
 ) ) \

742 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

743 
»suÉ
 = 
n
; \

745 iàĞ((
»suÉ
 = 
	`ä—d
Ğ
buf
, 1, 
max_size
, 
yyš
 )) == 0) \

746 && 
	`ã¼Ü
Ğ
yyš
 ) ) \

747 
	`YY_FATAL_ERROR
Ğ"špuˆš fËx sÿÂ” faed" );

	)

754 #iâdeà
yy‹rmš©e


755 
	#yy‹rmš©e
(è 
YY_NULL


	)

759 #iâdeà
YY_START_STACK_INCR


760 
	#YY_START_STACK_INCR
 25

	)

764 #iâdeà
YY_FATAL_ERROR


765 
	#YY_FATAL_ERROR
(
msg
è
	`yy_çl_”rÜ
Ğmsg )

	)

771 #iâdeà
YY_DECL


772 
	#YY_DECL
 
yyËx
 
	`YY_PROTO
(Ğ))

	)

778 #iâdeà
YY_USER_ACTION


779 
	#YY_USER_ACTION


	)

783 #iâdeà
YY_BREAK


784 
	#YY_BREAK
 ;

	)

787 
	#YY_RULE_SETUP
 \

788 
YY_USER_ACTION


	)

790 
	gYY_DECL


792 
yy_¡©e_ty³
 
	gyy_cu¼’t_¡©e
;

793 *
	gyy_ı
, *
	gyy_bp
;

794 
	gyy_aù
;

798 
tşi¡_t
 *
	g£ùiÚ_¡ack
 = 
tşi¡_Ãw
(
TC_LOCK_SLOPPY
);

799 
cÚf_£ùiÚ
 *
	gcur_£ùiÚ
;

800 
tcc_’Œy
 *
	gcur_’Œy
 = 
NULL
;

801 
	glše_num
 = 1;

802 
	g£ú
 = 0;

803 if(
	g£c
){

804 
	gcur_£ùiÚ
 = 
£c
;

806 
	gcur_£ùiÚ
 = 
cÚf_Ãw
(
NULL
);

808 
	gcÚf_fe
.
	gd©a
 = 
d©a
;

809 
	gcÚf_fe
.
	g»ad
 = 
râ
;

811 
	gYY_FLUSH_BUFFER
;

812 
BEGIN
(
INITIAL
);

816 iàĞ
	gyy_š™
 )

818 
	gyy_š™
 = 0;

820 #ifdeà
YY_USER_INIT


821 
	gYY_USER_INIT
;

824 iàĞ! 
	gyy_¡¬t
 )

825 
	gyy_¡¬t
 = 1;

827 iàĞ! 
	gyyš
 )

828 
	gyyš
 = 
¡dš
;

830 iàĞ! 
	gyyout
 )

831 
	gyyout
 = 
¡dout
;

833 iàĞ! 
	gyy_cu¼’t_bufãr
 )

834 
	gyy_cu¼’t_bufãr
 =

835 
yy_ü—‹_bufãr
Ğ
yyš
, 
YY_BUF_SIZE
 );

837 
yy_lßd_bufãr_¡©e
();

842 
	gyy_ı
 = 
yy_c_buf_p
;

845 *
	gyy_ı
 = 
yy_hŞd_ch¬
;

850 
	gyy_bp
 = 
yy_ı
;

852 
	gyy_cu¼’t_¡©e
 = 
yy_¡¬t
;

853 
	gyy_¡©e_±r
 = 
yy_¡©e_buf
;

854 *
	gyy_¡©e_±r
++ = 
yy_cu¼’t_¡©e
;

855 
	gyy_m©ch
:

858 
YY_CHAR
 
yy_c
 = 
yy_ec
[
YY_SC_TO_UI
(*
yy_ı
)];

859  
	gyy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
	gyy_c
] != yy_current_state )

861 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

862 iàĞ
	gyy_cu¼’t_¡©e
 >= 115 )

863 
yy_c
 = 
yy_m‘a
[() yy_c];

865 
	gyy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[
yy_cu¼’t_¡©e
] + (è
yy_c
];

866 *
	gyy_¡©e_±r
++ = 
yy_cu¼’t_¡©e
;

867 ++
	gyy_ı
;

869  
	gyy_ba£
[
yy_cu¼’t_¡©e
] != 596 );

871 
	gyy_fšd_aùiÚ
:

872 
yy_cu¼’t_¡©e
 = *--
yy_¡©e_±r
;

873 
	gyy_Í
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

874 
	gfšd_ruË
:

877 iàĞ
	gyy_Í
 && yy_Í < 
	gyy_acû±
[
yy_cu¼’t_¡©e
 + 1] )

879 
	gyy_aù
 = 
yy_acşi¡
[
yy_Í
];

880 iàĞ
	gyy_aù
 & 
	gYY_TRAILING_HEAD_MASK
 ||

881 
	gyy_lookšg_fÜ_Œa_begš
 )

883 iàĞ
	gyy_aù
 =ğ
yy_lookšg_fÜ_Œa_begš
 )

885 
yy_lookšg_fÜ_Œa_begš
 = 0;

886 
	gyy_aù
 &ğ~
YY_TRAILING_HEAD_MASK
;

890 iàĞ
	gyy_aù
 & 
	gYY_TRAILING_MASK
 )

892 
	gyy_lookšg_fÜ_Œa_begš
 = 
yy_aù
 & ~
YY_TRAILING_MASK
;

893 
	gyy_lookšg_fÜ_Œa_begš
 |ğ
YY_TRAILING_HEAD_MASK
;

897 
	gyy_fuÎ_m©ch
 = 
yy_ı
;

898 
	gyy_fuÎ_¡©e
 = 
yy_¡©e_±r
;

899 
	gyy_fuÎ_Í
 = 
yy_Í
;

902 ++
	gyy_Í
;

903 
	gfšd_ruË
;

905 --
	gyy_ı
;

906 
	gyy_cu¼’t_¡©e
 = *--
yy_¡©e_±r
;

907 
	gyy_Í
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

910 
	gYY_DO_BEFORE_ACTION
;

913 
	gdo_aùiÚ
:

916  
yy_aù
 )

920 
YY_RULE_SETUP


923 
YY_BREAK


925 *
yy_ı
 = 
yy_hŞd_ch¬
;

926 
	gyy_c_buf_p
 = 
yy_ı
 -= 1;

927 
	gYY_DO_BEFORE_ACTION
;

928 
	gYY_RULE_SETUP


931 
YY_BREAK


935 
YY_RULE_SETUP


938 
£ú
 = 0;

939 
BEGIN
(
£ù
);

941 
YY_BREAK


943 
YY_RULE_SETUP


946 
PUSH_SECTION
(0, 
TCC_SECTION
);

947 
	g£ú
 = 1;

948 
BEGIN
(
£ù
);

950 
YY_BREAK


952 
YY_RULE_SETUP


955 
PUSH_SECTION
(0, 
TCC_MSECTION
);

956 
	g£ú
 = 1;

957 
BEGIN
(
£ù
);

959 
YY_BREAK


961 
YY_RULE_SETUP


964 
cur_’Œy
 = 
ü—‹_’Œy
(
cur_£ùiÚ
, 
yy‹xt
, 
TCC_VALUE
);

965 
BEGIN
(
p_v®
);

967 
YY_BREAK


969 
YY_RULE_SETUP


971 { 
cÚf_£ùiÚ
 *
£c
;

972 if((
	g£c
 = 
tşi¡_pİ
(
£ùiÚ_¡ack
)è!ğ
NULL
){

973 
cur_£ùiÚ
 = 
£c
;

975 
årštf
(
¡d”r
, "lš%d: UÃx³ùed '%c'\n", 
lše_num
, 
yy‹xt
[0]);

976 
yy‹rmš©e
();

979 
YY_BREAK


980 
YY_STATE_EOF
(
INITIAL
):

983 if(
tşi¡_™ems
(
£ùiÚ_¡ack
) == 0){

984 
tşi¡_de¡roy
(
£ùiÚ_¡ack
, 
NULL
);

985 
	gYY_FLUSH_BUFFER
;

986  
	gcur_£ùiÚ
;

988 
årštf
(
¡d”r
, "Unexpectedƒnd of file.\n");

989 
yy‹rmš©e
();

992 
YY_BREAK


998 
YY_RULE_SETUP


1000 
tcc_addšt
(
cur_’Œy
, 
¡¹Şl
(
yy‹xt
, 
NULL
, 0));

1001 
YY_BREAK


1003 
YY_RULE_SETUP


1005 
tcc_addæßt
(
cur_’Œy
, 
¡¹od
(
yy‹xt
, 
NULL
));

1006 
YY_BREAK


1008 
YY_RULE_SETUP


1010 
yy‹xt
[
yyËng
-1]=0; 
tcc_add¡ršg
(
cur_’Œy
,
¡rdup
(yytext+1),0);

1011 
YY_BREAK


1013 
YY_RULE_SETUP


1015 
yy‹xt
[
yyËng
-1]=0; 
tcc_add¡ršg
(
cur_’Œy
,
¡rdup
(yytext+1),1);

1016 
YY_BREAK


1018 
YY_RULE_SETUP


1020 
tcc_add»f
(
cur_’Œy
, 
¡rdup
(
yy‹xt
));

1021 
YY_BREAK


1023 
YY_RULE_SETUP


1025 
tcc_addboŞ
(
cur_’Œy
, 1);

1026 
YY_BREAK


1028 
YY_RULE_SETUP


1030 
tcc_addboŞ
(
cur_’Œy
, 0);

1031 
YY_BREAK


1033 *
yy_ı
 = 
yy_hŞd_ch¬
;

1034 
	gyy_c_buf_p
 = 
yy_ı
 -= 1;

1035 
	gYY_DO_BEFORE_ACTION
;

1038 
YY_RULE_SETUP


1041 
BEGIN
(
INITIAL
);

1042 if(
	gyy‹xt
[0] == '\n')

1043 
lše_num
++;

1045 
YY_BREAK


1046 
YY_STATE_EOF
(
p_v®
):

1048 
årštf
(
¡d”r
, "UÃx³ùedƒnd oàfe.\n"); 
yy‹rmš©e
();

1049 
YY_BREAK


1053 
YY_RULE_SETUP


1056 if(
£ú
 == 0){

1057 
PUSH_SECTION
(1, 
TCC_SECTION
);

1058 
	g£ú
 = 1;

1060 
årštf
(
¡d”r
, "line %d: Expected '{', found %s.\n",

1061 
lše_num
, 
yy‹xt
);

1062 
yy‹rmš©e
();

1065 
YY_BREAK


1067 
YY_RULE_SETUP


1070 if(
£ú
){

1071 
BEGIN
(
INITIAL
);

1073 
årštf
(
¡d”r
, "lš%d: Missšg seùiÚ‚ame.\n", 
lše_num
);

1074 
yy‹rmš©e
();

1077 
YY_BREAK


1079 
YY_RULE_SETUP


1081 
BEGIN
(
s_m”ge
);

1082 
YY_BREAK


1085 
YY_RULE_SETUP


1088 
tşi¡_push
(
cur_£ùiÚ
->
m”ge
, 
¡rdup
(
yy‹xt
));

1089 
BEGIN
(
£ù
);

1091 
YY_BREAK


1093 
YY_RULE_SETUP


1095 
lše_num
++;

1096 
YY_BREAK


1098 
YY_RULE_SETUP


1100 
årštf
(
¡d”r
, "lš%d: SyÁaxƒ¼Ü‚—¸'%s'.\n", 
lše_num
, 
yy‹xt
); 
yy‹rmš©e
();

1101 
YY_BREAK


1103 
YY_RULE_SETUP


1105 
ECHO
;

1106 
	gYY_BREAK


1108 
YY_STATE_EOF
(
£ù
):

1109 
YY_STATE_EOF
(
s_m”ge
):

1110 
yy‹rmš©e
();

1112 
	gYY_END_OF_BUFFER
:

1115 
yy_amouÁ_of_m©ched_‹xt
 = (è(
yy_ı
 - 
yy‹xt_±r
) - 1;

1118 *
	gyy_ı
 = 
yy_hŞd_ch¬
;

1119 
YY_RESTORE_YY_MORE_OFFSET


1121 iàĞ
	gyy_cu¼’t_bufãr
->
	gyy_bufãr_¡©us
 =ğ
YY_BUFFER_NEW
 )

1132 
yy_n_ch¬s
 = 
yy_cu¼’t_bufãr
->yy_n_chars;

1133 
	gyy_cu¼’t_bufãr
->
	gyy_šput_fe
 = 
yyš
;

1134 
	gyy_cu¼’t_bufãr
->
	gyy_bufãr_¡©us
 = 
YY_BUFFER_NORMAL
;

1144 iàĞ
	gyy_c_buf_p
 <ğ&
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
] )

1146 
yy_¡©e_ty³
 
yy_Ãxt_¡©e
;

1148 
	gyy_c_buf_p
 = 
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

1150 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
();

1161 
	gyy_Ãxt_¡©e
 = 
yy_Œy_NUL_Œªs
Ğ
yy_cu¼’t_¡©e
 );

1163 
	gyy_bp
 = 
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1165 iàĞ
	gyy_Ãxt_¡©e
 )

1168 
	gyy_ı
 = ++
yy_c_buf_p
;

1169 
	gyy_cu¼’t_¡©e
 = 
yy_Ãxt_¡©e
;

1170 
	gyy_m©ch
;

1175 
	gyy_ı
 = 
yy_c_buf_p
;

1176 
	gyy_fšd_aùiÚ
;

1180  
yy_g‘_Ãxt_bufãr
() )

1182 
	gEOB_ACT_END_OF_FILE
:

1184 
yy_did_bufãr_sw™ch_Ú_eof
 = 0;

1186 iàĞ
yyw¿p
() )

1197 
	gyy_c_buf_p
 = 
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1199 
	gyy_aù
 = 
YY_STATE_EOF
(
YY_START
);

1200 
	gdo_aùiÚ
;

1205 iàĞ! 
	gyy_did_bufãr_sw™ch_Ú_eof
 )

1206 
	gYY_NEW_FILE
;

1211 
	gEOB_ACT_CONTINUE_SCAN
:

1212 
yy_c_buf_p
 =

1213 
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

1215 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
();

1217 
	gyy_ı
 = 
yy_c_buf_p
;

1218 
	gyy_bp
 = 
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1219 
	gyy_m©ch
;

1221 
	gEOB_ACT_LAST_MATCH
:

1222 
yy_c_buf_p
 =

1223 &
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
];

1225 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
();

1227 
	gyy_ı
 = 
yy_c_buf_p
;

1228 
	gyy_bp
 = 
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1229 
	gyy_fšd_aùiÚ
;

1235 
YY_FATAL_ERROR
(

1250 
	$yy_g‘_Ãxt_bufãr
()

1252 *
de¡
 = 
yy_cu¼’t_bufãr
->
yy_ch_buf
;

1253 *
sourû
 = 
yy‹xt_±r
;

1254 
numb”_to_move
, 
i
;

1255 
»t_v®
;

1257 iàĞ
yy_c_buf_p
 > &
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
 + 1] )

1258 
	`YY_FATAL_ERROR
(

1261 iàĞ
yy_cu¼’t_bufãr
->
yy_fl_bufãr
 == 0 )

1263 iàĞ
yy_c_buf_p
 - 
yy‹xt_±r
 - 
YY_MORE_ADJ
 == 1 )

1268  
EOB_ACT_END_OF_FILE
;

1276  
EOB_ACT_LAST_MATCH
;

1283 
numb”_to_move
 = (è(
yy_c_buf_p
 - 
yy‹xt_±r
) - 1;

1285  
i
 = 0; i < 
numb”_to_move
; ++i )

1286 *(
de¡
++èğ*(
sourû
++);

1288 iàĞ
yy_cu¼’t_bufãr
->
yy_bufãr_¡©us
 =ğ
YY_BUFFER_EOF_PENDING
 )

1292 
yy_cu¼’t_bufãr
->
yy_n_ch¬s
 = yy_n_chars = 0;

1296 
num_to_»ad
 =

1297 
yy_cu¼’t_bufãr
->
yy_buf_size
 - 
numb”_to_move
 - 1;

1299  
num_to_»ad
 <= 0 )

1301 #ifdeà
YY_USES_REJECT


1302 
	`YY_FATAL_ERROR
(

1307 
YY_BUFFER_STATE
 
b
 = 
yy_cu¼’t_bufãr
;

1309 
yy_c_buf_p_off£t
 =

1310 (è(
yy_c_buf_p
 - 
b
->
yy_ch_buf
);

1312 iàĞ
b
->
yy_is_our_bufãr
 )

1314 
Ãw_size
 = 
b
->
yy_buf_size
 * 2;

1316 iàĞ
Ãw_size
 <= 0 )

1317 
b
->
yy_buf_size
 += b->yy_buf_size / 8;

1319 
b
->
yy_buf_size
 *= 2;

1321 
b
->
yy_ch_buf
 = (*)

1323 
	`yy_æex_»®loc
Ğ(*è
b
->
yy_ch_buf
,

1324 
b
->
yy_buf_size
 + 2 );

1328 
b
->
yy_ch_buf
 = 0;

1330 iàĞ! 
b
->
yy_ch_buf
 )

1331 
	`YY_FATAL_ERROR
(

1334 
yy_c_buf_p
 = &
b
->
yy_ch_buf
[
yy_c_buf_p_off£t
];

1336 
num_to_»ad
 = 
yy_cu¼’t_bufãr
->
yy_buf_size
 -

1337 
numb”_to_move
 - 1;

1341 iàĞ
num_to_»ad
 > 
YY_READ_BUF_SIZE
 )

1342 
num_to_»ad
 = 
YY_READ_BUF_SIZE
;

1345 
	`YY_INPUT
Ğ(&
yy_cu¼’t_bufãr
->
yy_ch_buf
[
numb”_to_move
]),

1346 
yy_n_ch¬s
, 
num_to_»ad
 );

1348 
yy_cu¼’t_bufãr
->
yy_n_ch¬s
 = yy_n_chars;

1351 iàĞ
yy_n_ch¬s
 == 0 )

1353 iàĞ
numb”_to_move
 =ğ
YY_MORE_ADJ
 )

1355 
»t_v®
 = 
EOB_ACT_END_OF_FILE
;

1356 
	`yy»¡¬t
Ğ
yyš
 );

1361 
»t_v®
 = 
EOB_ACT_LAST_MATCH
;

1362 
yy_cu¼’t_bufãr
->
yy_bufãr_¡©us
 =

1363 
YY_BUFFER_EOF_PENDING
;

1368 
»t_v®
 = 
EOB_ACT_CONTINUE_SCAN
;

1370 
yy_n_ch¬s
 +ğ
numb”_to_move
;

1371 
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
] = 
YY_END_OF_BUFFER_CHAR
;

1372 
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
 + 1] = 
YY_END_OF_BUFFER_CHAR
;

1374 
yy‹xt_±r
 = &
yy_cu¼’t_bufãr
->
yy_ch_buf
[0];

1376  
»t_v®
;

1377 
	}
}

1382 
yy_¡©e_ty³
 
	$yy_g‘_´evious_¡©e
()

1384 
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
;

1385 *
yy_ı
;

1387 
yy_cu¼’t_¡©e
 = 
yy_¡¬t
;

1388 
yy_¡©e_±r
 = 
yy_¡©e_buf
;

1389 *
yy_¡©e_±r
++ = 
yy_cu¼’t_¡©e
;

1391  
yy_ı
 = 
yy‹xt_±r
 + 
YY_MORE_ADJ
; yy_ı < 
yy_c_buf_p
; ++yy_cp )

1393 
YY_CHAR
 
yy_c
 = (*
yy_ı
 ? 
yy_ec
[
	`YY_SC_TO_UI
(*yy_cp)] : 1);

1394  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1396 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1397 iàĞ
yy_cu¼’t_¡©e
 >= 115 )

1398 
yy_c
 = 
yy_m‘a
[() yy_c];

1400 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1401 *
yy_¡©e_±r
++ = 
yy_cu¼’t_¡©e
;

1404  
yy_cu¼’t_¡©e
;

1405 
	}
}

1414 #ifdeà
YY_USE_PROTOS


1415 
yy_¡©e_ty³
 
	$yy_Œy_NUL_Œªs
Ğ
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
 )

1417 
yy_¡©e_ty³
 
	$yy_Œy_NUL_Œªs
Ğ
yy_cu¼’t_¡©e
 )

1418 
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
;

1421 
yy_is_jam
;

1423 
YY_CHAR
 
yy_c
 = 1;

1424  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1426 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1427 iàĞ
yy_cu¼’t_¡©e
 >= 115 )

1428 
yy_c
 = 
yy_m‘a
[() yy_c];

1430 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1431 
yy_is_jam
 = (
yy_cu¼’t_¡©e
 == 114);

1432 iàĞ! 
yy_is_jam
 )

1433 *
yy_¡©e_±r
++ = 
yy_cu¼’t_¡©e
;

1435  
yy_is_jam
 ? 0 : 
yy_cu¼’t_¡©e
;

1436 
	}
}

1439 #iâdeà
YY_NO_UNPUT


1440 #ifdeà
YY_USE_PROTOS


1441 
	$yyuÅut
Ğ
c
, *
yy_bp
 )

1443 
	$yyuÅut
Ğ
c
, 
yy_bp
 )

1444 
c
;

1445 *
yy_bp
;

1448 *
yy_ı
 = 
yy_c_buf_p
;

1451 *
yy_ı
 = 
yy_hŞd_ch¬
;

1453 iàĞ
yy_ı
 < 
yy_cu¼’t_bufãr
->
yy_ch_buf
 + 2 )

1456 
numb”_to_move
 = 
yy_n_ch¬s
 + 2;

1457 *
de¡
 = &
yy_cu¼’t_bufãr
->
yy_ch_buf
[

1458 
yy_cu¼’t_bufãr
->
yy_buf_size
 + 2];

1459 *
sourû
 =

1460 &
yy_cu¼’t_bufãr
->
yy_ch_buf
[
numb”_to_move
];

1462  
sourû
 > 
yy_cu¼’t_bufãr
->
yy_ch_buf
 )

1463 *--
de¡
 = *--
sourû
;

1465 
yy_ı
 +ğ(è(
de¡
 - 
sourû
);

1466 
yy_bp
 +ğ(è(
de¡
 - 
sourû
);

1467 
yy_cu¼’t_bufãr
->
yy_n_ch¬s
 =

1468 
yy_n_ch¬s
 = 
yy_cu¼’t_bufãr
->
yy_buf_size
;

1470 iàĞ
yy_ı
 < 
yy_cu¼’t_bufãr
->
yy_ch_buf
 + 2 )

1471 
	`YY_FATAL_ERROR
( "flex scanner…ush-back overflow" );

1474 *--
yy_ı
 = (è
c
;

1477 
yy‹xt_±r
 = 
yy_bp
;

1478 
yy_hŞd_ch¬
 = *
yy_ı
;

1479 
yy_c_buf_p
 = 
yy_ı
;

1480 
	}
}

1484 #ifdeà
__ılu¥lus


1485 
	$yyšput
()

1487 
	$šput
()

1490 
c
;

1492 *
yy_c_buf_p
 = 
yy_hŞd_ch¬
;

1494 iàĞ*
yy_c_buf_p
 =ğ
YY_END_OF_BUFFER_CHAR
 )

1500 iàĞ
yy_c_buf_p
 < &
yy_cu¼’t_bufãr
->
yy_ch_buf
[
yy_n_ch¬s
] )

1502 *
yy_c_buf_p
 = '\0';

1506 
off£t
 = 
yy_c_buf_p
 - 
yy‹xt_±r
;

1507 ++
yy_c_buf_p
;

1509  
	`yy_g‘_Ãxt_bufãr
() )

1511 
EOB_ACT_LAST_MATCH
:

1523 
	`yy»¡¬t
Ğ
yyš
 );

1527 
EOB_ACT_END_OF_FILE
:

1529 iàĞ
	`yyw¿p
() )

1530  
EOF
;

1532 iàĞ! 
yy_did_bufãr_sw™ch_Ú_eof
 )

1533 
YY_NEW_FILE
;

1534 #ifdeà
__ılu¥lus


1535  
	`yyšput
();

1537  
	`šput
();

1541 
EOB_ACT_CONTINUE_SCAN
:

1542 
yy_c_buf_p
 = 
yy‹xt_±r
 + 
off£t
;

1548 
c
 = *(*è
yy_c_buf_p
;

1549 *
yy_c_buf_p
 = '\0';

1550 
yy_hŞd_ch¬
 = *++
yy_c_buf_p
;

1553  
c
;

1554 
	}
}

1557 #ifdeà
YY_USE_PROTOS


1558 
	$yy»¡¬t
Ğ
FILE
 *
šput_fe
 )

1560 
	$yy»¡¬t
Ğ
šput_fe
 )

1561 
FILE
 *
šput_fe
;

1564 iàĞ! 
yy_cu¼’t_bufãr
 )

1565 
yy_cu¼’t_bufãr
 = 
	`yy_ü—‹_bufãr
Ğ
yyš
, 
YY_BUF_SIZE
 );

1567 
	`yy_š™_bufãr
Ğ
yy_cu¼’t_bufãr
, 
šput_fe
 );

1568 
	`yy_lßd_bufãr_¡©e
();

1569 
	}
}

1572 #ifdeà
YY_USE_PROTOS


1573 
	$yy_sw™ch_to_bufãr
Ğ
YY_BUFFER_STATE
 
Ãw_bufãr
 )

1575 
	$yy_sw™ch_to_bufãr
Ğ
Ãw_bufãr
 )

1576 
YY_BUFFER_STATE
 
Ãw_bufãr
;

1579 iàĞ
yy_cu¼’t_bufãr
 =ğ
Ãw_bufãr
 )

1582 iàĞ
yy_cu¼’t_bufãr
 )

1585 *
yy_c_buf_p
 = 
yy_hŞd_ch¬
;

1586 
yy_cu¼’t_bufãr
->
yy_buf_pos
 = 
yy_c_buf_p
;

1587 
yy_cu¼’t_bufãr
->
yy_n_ch¬s
 = yy_n_chars;

1590 
yy_cu¼’t_bufãr
 = 
Ãw_bufãr
;

1591 
	`yy_lßd_bufãr_¡©e
();

1598 
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

1599 
	}
}

1602 #ifdeà
YY_USE_PROTOS


1603 
	$yy_lßd_bufãr_¡©e
( )

1605 
	$yy_lßd_bufãr_¡©e
()

1608 
yy_n_ch¬s
 = 
yy_cu¼’t_bufãr
->yy_n_chars;

1609 
yy‹xt_±r
 = 
yy_c_buf_p
 = 
yy_cu¼’t_bufãr
->
yy_buf_pos
;

1610 
yyš
 = 
yy_cu¼’t_bufãr
->
yy_šput_fe
;

1611 
yy_hŞd_ch¬
 = *
yy_c_buf_p
;

1612 
	}
}

1615 #ifdeà
YY_USE_PROTOS


1616 
YY_BUFFER_STATE
 
	$yy_ü—‹_bufãr
Ğ
FILE
 *
fe
, 
size
 )

1618 
YY_BUFFER_STATE
 
	$yy_ü—‹_bufãr
Ğ
fe
, 
size
 )

1619 
FILE
 *
fe
;

1620 
size
;

1623 
YY_BUFFER_STATE
 
b
;

1625 
b
 = (
YY_BUFFER_STATE
è
	`yy_æex_®loc
ĞĞ
yy_bufãr_¡©e
 ) );

1626 iàĞ! 
b
 )

1627 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_create_buffer()" );

1629 
b
->
yy_buf_size
 = 
size
;

1634 
b
->
yy_ch_buf
 = (*è
	`yy_æex_®loc
Ğb->
yy_buf_size
 + 2 );

1635 iàĞ! 
b
->
yy_ch_buf
 )

1636 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_create_buffer()" );

1638 
b
->
yy_is_our_bufãr
 = 1;

1640 
	`yy_š™_bufãr
Ğ
b
, 
fe
 );

1642  
b
;

1643 
	}
}

1646 #ifdeà
YY_USE_PROTOS


1647 
	$yy_d–‘e_bufãr
Ğ
YY_BUFFER_STATE
 
b
 )

1649 
	$yy_d–‘e_bufãr
Ğ
b
 )

1650 
YY_BUFFER_STATE
 
b
;

1653 iàĞ! 
b
 )

1656 iàĞ
b
 =ğ
yy_cu¼’t_bufãr
 )

1657 
yy_cu¼’t_bufãr
 = (
YY_BUFFER_STATE
) 0;

1659 iàĞ
b
->
yy_is_our_bufãr
 )

1660 
	`yy_æex_ä“
Ğ(*è
b
->
yy_ch_buf
 );

1662 
	`yy_æex_ä“
Ğ(*è
b
 );

1663 
	}
}

1666 #iâdeà
YY_ALWAYS_INTERACTIVE


1667 #iâdeà
YY_NEVER_INTERACTIVE


1668 
i§‰y
 
YY_PROTO
(( ));

1672 #ifdeà
YY_USE_PROTOS


1673 
	$yy_š™_bufãr
Ğ
YY_BUFFER_STATE
 
b
, 
FILE
 *
fe
 )

1675 
	$yy_š™_bufãr
Ğ
b
, 
fe
 )

1676 
YY_BUFFER_STATE
 
b
;

1677 
FILE
 *
fe
;

1682 
	`yy_æush_bufãr
Ğ
b
 );

1684 
b
->
yy_šput_fe
 = 
fe
;

1685 
b
->
yy_fl_bufãr
 = 1;

1687 #ià
YY_ALWAYS_INTERACTIVE


1688 
b
->
yy_is_š‹¿ùive
 = 1;

1690 #ià
YY_NEVER_INTERACTIVE


1691 
b
->
yy_is_š‹¿ùive
 = 0;

1693 
b
->
yy_is_š‹¿ùive
 = 
fe
 ? (
	`i§‰y
Ğ
	`f’o
(file) ) > 0) : 0;

1696 
	}
}

1699 #ifdeà
YY_USE_PROTOS


1700 
	$yy_æush_bufãr
Ğ
YY_BUFFER_STATE
 
b
 )

1702 
	$yy_æush_bufãr
Ğ
b
 )

1703 
YY_BUFFER_STATE
 
b
;

1707 iàĞ! 
b
 )

1710 
b
->
yy_n_ch¬s
 = 0;

1716 
b
->
yy_ch_buf
[0] = 
YY_END_OF_BUFFER_CHAR
;

1717 
b
->
yy_ch_buf
[1] = 
YY_END_OF_BUFFER_CHAR
;

1719 
b
->
yy_buf_pos
 = &b->
yy_ch_buf
[0];

1721 
b
->
yy_©_bŞ
 = 1;

1722 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

1724 iàĞ
b
 =ğ
yy_cu¼’t_bufãr
 )

1725 
	`yy_lßd_bufãr_¡©e
();

1726 
	}
}

1729 #iâdeà
YY_NO_SCAN_BUFFER


1730 #ifdeà
YY_USE_PROTOS


1731 
YY_BUFFER_STATE
 
	$yy_sÿn_bufãr
Ğ*
ba£
, 
yy_size_t
 
size
 )

1733 
YY_BUFFER_STATE
 
	$yy_sÿn_bufãr
Ğ
ba£
, 
size
 )

1734 *
ba£
;

1735 
yy_size_t
 
size
;

1738 
YY_BUFFER_STATE
 
b
;

1740 iàĞ
size
 < 2 ||

1741 
ba£
[
size
-2] !ğ
YY_END_OF_BUFFER_CHAR
 ||

1742 
ba£
[
size
-1] !ğ
YY_END_OF_BUFFER_CHAR
 )

1746 
b
 = (
YY_BUFFER_STATE
è
	`yy_æex_®loc
ĞĞ
yy_bufãr_¡©e
 ) );

1747 iàĞ! 
b
 )

1748 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_scan_buffer()" );

1750 
b
->
yy_buf_size
 = 
size
 - 2;

1751 
b
->
yy_buf_pos
 = b->
yy_ch_buf
 = 
ba£
;

1752 
b
->
yy_is_our_bufãr
 = 0;

1753 
b
->
yy_šput_fe
 = 0;

1754 
b
->
yy_n_ch¬s
 = b->
yy_buf_size
;

1755 
b
->
yy_is_š‹¿ùive
 = 0;

1756 
b
->
yy_©_bŞ
 = 1;

1757 
b
->
yy_fl_bufãr
 = 0;

1758 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

1760 
	`yy_sw™ch_to_bufãr
Ğ
b
 );

1762  
b
;

1763 
	}
}

1767 #iâdeà
YY_NO_SCAN_STRING


1768 #ifdeà
YY_USE_PROTOS


1769 
YY_BUFFER_STATE
 
	$yy_sÿn_¡ršg
Ğ
yycÚ¡
 *
yy_¡r
 )

1771 
YY_BUFFER_STATE
 
	$yy_sÿn_¡ršg
Ğ
yy_¡r
 )

1772 
yycÚ¡
 *
yy_¡r
;

1775 
Ën
;

1776  
Ën
 = 0; 
yy_¡r
[len]; ++len )

1779  
	`yy_sÿn_by‹s
Ğ
yy_¡r
, 
Ën
 );

1780 
	}
}

1784 #iâdeà
YY_NO_SCAN_BYTES


1785 #ifdeà
YY_USE_PROTOS


1786 
YY_BUFFER_STATE
 
	$yy_sÿn_by‹s
Ğ
yycÚ¡
 *
by‹s
, 
Ën
 )

1788 
YY_BUFFER_STATE
 
	$yy_sÿn_by‹s
Ğ
by‹s
, 
Ën
 )

1789 
yycÚ¡
 *
by‹s
;

1790 
Ën
;

1793 
YY_BUFFER_STATE
 
b
;

1794 *
buf
;

1795 
yy_size_t
 
n
;

1796 
i
;

1799 
n
 = 
Ën
 + 2;

1800 
buf
 = (*è
	`yy_æex_®loc
Ğ
n
 );

1801 iàĞ! 
buf
 )

1802 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_scan_bytes()" );

1804  
i
 = 0; i < 
Ën
; ++i )

1805 
buf
[
i
] = 
by‹s
[i];

1807 
buf
[
Ën
] = buf[Ën+1] = 
YY_END_OF_BUFFER_CHAR
;

1809 
b
 = 
	`yy_sÿn_bufãr
Ğ
buf
, 
n
 );

1810 iàĞ! 
b
 )

1811 
	`YY_FATAL_ERROR
( "bad buffer in yy_scan_bytes()" );

1816 
b
->
yy_is_our_bufãr
 = 1;

1818  
b
;

1819 
	}
}

1823 #iâdeà
YY_NO_PUSH_STATE


1824 #ifdeà
YY_USE_PROTOS


1825 
	$yy_push_¡©e
Ğ
Ãw_¡©e
 )

1827 
	$yy_push_¡©e
Ğ
Ãw_¡©e
 )

1828 
Ãw_¡©e
;

1831 iàĞ
yy_¡¬t_¡ack_±r
 >ğ
yy_¡¬t_¡ack_d•th
 )

1833 
yy_size_t
 
Ãw_size
;

1835 
yy_¡¬t_¡ack_d•th
 +ğ
YY_START_STACK_INCR
;

1836 
Ãw_size
 = 
yy_¡¬t_¡ack_d•th
 * ( );

1838 iàĞ! 
yy_¡¬t_¡ack
 )

1839 
yy_¡¬t_¡ack
 = (*è
	`yy_æex_®loc
Ğ
Ãw_size
 );

1842 
yy_¡¬t_¡ack
 = (*è
	`yy_æex_»®loc
(

1843 (*è
yy_¡¬t_¡ack
, 
Ãw_size
 );

1845 iàĞ! 
yy_¡¬t_¡ack
 )

1846 
	`YY_FATAL_ERROR
(

1850 
yy_¡¬t_¡ack
[
yy_¡¬t_¡ack_±r
++] = 
YY_START
;

1852 
	`BEGIN
(
Ãw_¡©e
);

1853 
	}
}

1857 #iâdeà
YY_NO_POP_STATE


1858 
	$yy_pİ_¡©e
()

1860 iàĞ--
yy_¡¬t_¡ack_±r
 < 0 )

1861 
	`YY_FATAL_ERROR
( "start-condition stack underflow" );

1863 
	`BEGIN
(
yy_¡¬t_¡ack
[
yy_¡¬t_¡ack_±r
]);

1864 
	}
}

1868 #iâdeà
YY_NO_TOP_STATE


1869 
	$yy_tİ_¡©e
()

1871  
yy_¡¬t_¡ack
[
yy_¡¬t_¡ack_±r
 - 1];

1872 
	}
}

1875 #iâdeà
YY_EXIT_FAILURE


1876 
	#YY_EXIT_FAILURE
 2

	)

1879 #ifdeà
YY_USE_PROTOS


1880 
	$yy_çl_”rÜ
Ğ
yycÚ¡
 
msg
[] )

1882 
	$yy_çl_”rÜ
Ğ
msg
 )

1883 
msg
[];

1886 (è
	`årštf
Ğ
¡d”r
, "%s\n", 
msg
 );

1887 
	`ex™
Ğ
YY_EXIT_FAILURE
 );

1888 
	}
}

1894 #undeà
yyËss


1895 
	#yyËss
(
n
) \

1899 
yy‹xt
[
yyËng
] = 
yy_hŞd_ch¬
; \

1900 
yy_c_buf_p
 = 
yy‹xt
 + 
n
; \

1901 
yy_hŞd_ch¬
 = *
yy_c_buf_p
; \

1902 *
yy_c_buf_p
 = '\0'; \

1903 
yyËng
 = 
n
; \

1905  0 )

	)

1910 #iâdeà
yy‹xt_±r


1911 #ifdeà
YY_USE_PROTOS


1912 
	$yy_æex_¡ºıy
Ğ*
s1
, 
yycÚ¡
 *
s2
, 
n
 )

1914 
	$yy_æex_¡ºıy
Ğ
s1
, 
s2
, 
n
 )

1915 *
s1
;

1916 
yycÚ¡
 *
s2
;

1917 
n
;

1920 
i
;

1921  
i
 = 0; i < 
n
; ++i )

1922 
s1
[
i
] = 
s2
[i];

1923 
	}
}

1926 #ifdeà
YY_NEED_STRLEN


1927 #ifdeà
YY_USE_PROTOS


1928 
	$yy_æex_¡¾’
Ğ
yycÚ¡
 *
s
 )

1930 
	$yy_æex_¡¾’
Ğ
s
 )

1931 
yycÚ¡
 *
s
;

1934 
n
;

1935  
n
 = 0; 
s
[n]; ++n )

1938  
n
;

1939 
	}
}

1943 #ifdeà
YY_USE_PROTOS


1944 *
	$yy_æex_®loc
Ğ
yy_size_t
 
size
 )

1946 *
	$yy_æex_®loc
Ğ
size
 )

1947 
yy_size_t
 
size
;

1950  (*è
	`m®loc
Ğ
size
 );

1951 
	}
}

1953 #ifdeà
YY_USE_PROTOS


1954 *
	$yy_æex_»®loc
Ğ*
±r
, 
yy_size_t
 
size
 )

1956 *
	$yy_æex_»®loc
Ğ
±r
, 
size
 )

1957 *
±r
;

1958 
yy_size_t
 
size
;

1968  (*è
	`»®loc
Ğ(*è
±r
, 
size
 );

1969 
	}
}

1971 #ifdeà
YY_USE_PROTOS


1972 
	$yy_æex_ä“
Ğ*
±r
 )

1974 
	$yy_æex_ä“
Ğ
±r
 )

1975 *
±r
;

1978 
	`ä“
Ğ
±r
 );

1979 
	}
}

1981 #ià
YY_MAIN


1982 
	$maš
()

1984 
	`yyËx
();

1986 
	}
}

	@get_interface3/libtc/src/conf-parse.l

25 %
İtiÚ
 
noyyw¿p


27 %
x
 
£ù


28 %
x
 
p_v®


29 %
x
 
s_m”ge


31 
keywÜd
 [[:
®num
:]
_
/-]+

32 
key»f
 (\.\.\/)*{
keywÜd
}

35 
	~<¡ršg.h
>

36 
	~<tşi¡.h
>

37 
	~<tÿÎoc.h
>

38 
	~"tccÚf.h
"

39 
	~"tcc-š‹º®.h
"

41 
	#yy‹rmš©e
() \

42 if(
£ùiÚ_¡ack
è
	`tşi¡_de¡roy
(£ùiÚ_¡ack, 
tcä“
); \

43 
YY_FLUSH_BUFFER
; \

44 
	`BEGIN
(
INITIAL
); \

45  
NULL


	)

47 
	#YY_DECL
 
cÚf_£ùiÚ
 *
	`tcc_Ëx
(*
d©a
, 
tcio_â
 
râ
, \

48 
cÚf_£ùiÚ
 *
£c
)

	)

50 
	#YY_INPUT
(
buf
,
»s
,
size
) { \

51 
»s
 = 
cÚf_fe
.
	`»ad
(
buf
, 1, 
size
, cÚf_fe.
d©a
); \

52 
»s
 =„e <ğ0? 
YY_NULL
:„es; \

53 }

	)

55 
	#PUSH_SECTION
(
q
, 
t
) do { \

56 
tcc_’Œy
 *
‹
; \

57 *
n
 = 
yy‹xt
+
q
; \

58 
yy‹xt
[
yyËng
-
q
] = 0; \

59 
‹
 = 
	`ü—‹_’Œy
(
cur_£ùiÚ
, 
n
, 
t
); \

60 
	`tşi¡_push
(
£ùiÚ_¡ack
, 
cur_£ùiÚ
); \

61 
cur_£ùiÚ
 = 
‹
->
£ùiÚ
; \

62 } 0)

	)

65 *
	md©a
;

66 
tcio_â
 
	m»ad
;

67 } 
	gcÚf_fe
;

71 %% /* 
	$yyËx
 */

72 
tşi¡_t
 *
£ùiÚ_¡ack
 = 
	`tşi¡_Ãw
(
TC_LOCK_SLOPPY
);

73 
cÚf_£ùiÚ
 *
cur_£ùiÚ
;

74 
tcc_’Œy
 *
cur_’Œy
 = 
NULL
;

75 
lše_num
 = 1;

76 
£ú
 = 0;

77 if(
£c
){

78 
cur_£ùiÚ
 = 
£c
;

80 
cur_£ùiÚ
 = 
	`cÚf_Ãw
(
NULL
);

82 
cÚf_fe
.
d©a
 = data;

83 
cÚf_fe
.
»ad
 = 
râ
;

85 
YY_FLUSH_BUFFER
;

86 
	`BEGIN
(
INITIAL
);

89 [ \
t
]

90 #.*
$


93 <
INITIAL
>{

94 
£ùiÚ
 {

95 
£ú
 = 0;

96 
	`BEGIN
(
£ù
);

98 {
keywÜd
}/([[:
¥aû
:]]*:[[:¥aû:]]*{
key»f
})*[[:space:]]*\{ {

99 
	`PUSH_SECTION
(0, 
TCC_SECTION
);

100 
£ú
 = 1;

101 
	`BEGIN
(
£ù
);

103 {
keywÜd
}/([[:
¥aû
:]]*:[[:¥aû:]]*{
key»f
})*[[:space:]]*\[ {

104 
	`PUSH_SECTION
(0, 
TCC_MSECTION
);

105 
£ú
 = 1;

106 
	`BEGIN
(
£ù
);

108 {
keywÜd
} {

109 
cur_’Œy
 = 
	`ü—‹_’Œy
(
cur_£ùiÚ
, 
yy‹xt
, 
TCC_VALUE
);

110 
	`BEGIN
(
p_v®
);

112 [\}\]] { 
cÚf_£ùiÚ
 *
£c
;

113 if((
£c
 = 
	`tşi¡_pİ
(
£ùiÚ_¡ack
)è!ğ
NULL
){

114 
cur_£ùiÚ
 = 
£c
;

116 
	`årštf
(
¡d”r
, "lš%d: UÃx³ùed '%c'\n", 
lše_num
, 
yy‹xt
[0]);

117 
	`yy‹rmš©e
();

120 <<
EOF
>> {

121 if(
	`tşi¡_™ems
(
£ùiÚ_¡ack
) == 0){

122 
	`tşi¡_de¡roy
(
£ùiÚ_¡ack
, 
NULL
);

123 
YY_FLUSH_BUFFER
;

124  
cur_£ùiÚ
;

126 
	`årštf
(
¡d”r
, "Unexpectedƒnd of file.\n");

127 
	`yy‹rmš©e
();

132 <
p_v®
>{

133 [+\-]?0x[[:
xdig™
:]]+ |

134 [+\-]?[[:
dig™
:]]+ 
	`tcc_addšt
(
cur_’Œy
, 
	`¡¹Şl
(
yy‹xt
, 
NULL
, 0));

135 [+\-]?[[:
dig™
:]]+\.[[:dig™:]]*([
eE
][+\-]?[[:dig™:]]+)? 
	`tcc_addæßt
(
cur_’Œy
, 
	`¡¹od
(
yy‹xt
, 
NULL
));

138 {
key»f
} 
	`tcc_add»f
(
cur_’Œy
, 
	`¡rdup
(
yy‹xt
));

139 
Œue
 
	`tcc_addboŞ
(
cur_’Œy
, 1);

140 
çl£
 
	`tcc_addboŞ
(
cur_’Œy
, 0);

141 [[:
¥aû
:]]*/[\]\}] |

142 [;\
n
] {

143 
	`BEGIN
(
INITIAL
);

144 if(
yy‹xt
[0] == '\n')

145 
lše_num
++;

147 <<
EOF
>> 
	`årštf
(
¡d”r
, "UÃx³ùedƒnd oàfe.\n"); 
	`yy‹rmš©e
();

150 <
£ù
>{

152 if(
£ú
 == 0){

153 
	`PUSH_SECTION
(1, 
TCC_SECTION
);

154 
£ú
 = 1;

156 
	`årštf
(
¡d”r
, "line %d: Expected '{', found %s.\n",

157 
lše_num
, 
yy‹xt
);

158 
	`yy‹rmš©e
();

162 if(
£ú
){

163 
	`BEGIN
(
INITIAL
);

165 
	`årštf
(
¡d”r
, "lš%d: Missšg seùiÚ‚ame.\n", 
lše_num
);

166 
	`yy‹rmš©e
();

169 : 
	`BEGIN
(
s_m”ge
);

172 <
s_m”ge
>[[:
®num
:]
_
/.-]+ {

173 
	`tşi¡_push
(
cur_£ùiÚ
->
m”ge
, 
	`¡rdup
(
yy‹xt
));

174 
	`BEGIN
(
£ù
);

177 <*>\
n
 
lše_num
++;

178 <*>[^ \
t
\
n
;]+ 
	`årštf
(
¡d”r
, "lš%d: SyÁaxƒ¼Ü‚—¸'%s'.\n", 
lše_num
, 
yy‹xt
); 
	`yy‹rmš©e
();

	@get_interface3/libtc/src/conf.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<tùy³s.h
>

28 
	~<tc¡ršg.h
>

29 
	~<tşi¡.h
>

30 
	~<¡d¬g.h
>

31 
	~<±h»ad.h
>

32 
	~<tÿÎoc.h
>

33 
	~<ùy³.h
>

34 
	~<âm©ch.h
>

35 
	~<tccÚf.h
>

36 
	~"tcc-š‹º®.h
"

38 
tcc_wr™“Áry
(
tcc_’Œy
 *, *
fe
, 
lv
, 
tcio_â
);

39 
tcc_wr™e£ùiÚ
(
cÚf_£ùiÚ
 *
ts
, *
fe
, 
lv
,

40 *
d
, 
tcio_â
);

41 
tcc_wr™–i¡
(
tşi¡_t
 *
l
, *
fe
, 
lv
, 
tcio_â
);

43 
±h»ad_mu‹x_t
 
	gæex_mut
 = 
PTHREAD_MUTEX_INITIALIZER
;

45 
	#mš
(
a
, 
b
è(×)<(b)?×):(b))

	)

48 
	$dumµ©h
(
tccÚf_£ùiÚ_t
 *
ts
)

50 if(
ts
->
·»Á
)

51 
	`dumµ©h
(
ts
->
·»Á
);

52 
	`årštf
(
¡d”r
, "%s/", 
ts
->
£c
->
Çme
);

53 
	}
}

56 
	$tccÚf_dumµ©h
(
tccÚf_£ùiÚ_t
 *
ts
)

58 if(
ts
){

59 
	`dumµ©h
(
ts
);

60 
	`årštf
(
¡d”r
, "\n");

62 
	`årštf
(
¡d”r
, "path = NULL\n");

64 
	}
}

67 
	$tccÚf_ä“
(*
p
)

69 
tccÚf_£ùiÚ_t
 *
s
 = 
p
;

70 
	`tcä“
(
s
->
£c
);

71 if(
s
->
·»Á
)

72 
	`tcä“
(
s
->
·»Á
);

73 
	}
}

76 
tccÚf_£ùiÚ_t
 *

77 
	$tccÚf_lßd
(
tccÚf_£ùiÚ_t
 *
ts
, *
d©a
, 
tcio_â
 
râ
)

79 
cÚf_£ùiÚ
 *
£c
 = 
ts
?s->£c: 
NULL
;

80 
	`±h»ad_mu‹x_lock
(&
æex_mut
);

81 
£c
 = 
	`tcc_Ëx
(
d©a
, 
râ
, sec);

82 
	`±h»ad_mu‹x_uÆock
(&
æex_mut
);

84 if(!
ts
 && 
£c
)

85 
ts
 = 
	`tÿÎocdz
((*ts), 
NULL
, 
tccÚf_ä“
);

86 if(
ts
 && 
£c
)

87 
ts
->
£c
 = sec;

89  
£c
? 
ts
: 
NULL
;

90 
	}
}

92 
tccÚf_£ùiÚ_t
 *

93 
	$tccÚf_lßd_fe
(
tccÚf_£ùiÚ_t
 *
£c
, *
fe
)

95 
FILE
 *
f
;

96 
tccÚf_£ùiÚ_t
 *
s
;

97 if((
f
 = 
	`fİ’
(
fe
, "r")è=ğ
NULL
)

98  
£c
;

99 
s
 = 
	`tccÚf_lßd
(
£c
, 
f
, (
tcio_â
è
ä—d
);

100 
	`fşo£
(
f
);

101  
s
;

102 
	}
}

104 
	s¡ršg_»ad
 {

105 cÚ¡ *
d
;

106 
s
;

107 
p
;

110 
size_t


111 
	$»ad_¡ršg
(*
p
, 
size_t
 
s
, size_ˆ
c
, *
d
)

113 
¡ršg_»ad
 *
¤
 = 
d
;

114 
b
 = 
s
 * 
c
;

116 
b
 = 
	`mš
(b, 
¤
->
s
 - sr->
p
);

117 
	`memıy
(
p
, 
¤
->
d
 + sr->p, 
b
);

118 
¤
->
p
 +ğ
b
;

120  
b
 / 
s
;

121 
	}
}

123 
tccÚf_£ùiÚ_t
 *

124 
	$tccÚf_lßd_¡ršg
(
tccÚf_£ùiÚ_t
 *
£c
, cÚ¡ *
cÚf
, 
size
)

126 
¡ršg_»ad
 
¤
;

128 if(
size
 < 0)

129 
size
 = 
	`¡¾’
(
cÚf
);

130 
¤
.
d
 = 
cÚf
;

131 
¤
.
s
 = 
size
;

132 
¤
.
p
 = 0;

134  
	`tccÚf_lßd
(
£c
, &
¤
, 
»ad_¡ršg
);

135 
	}
}

139 
	$tccÚf_wr™e
(
tccÚf_£ùiÚ_t
 *
tcc
, *
fe
, 
tcio_â
 
oâ
)

141 
	`tcc_wr™–i¡
(
tcc
->
£c
->
’Œ›s
, 
fe
, 0, 
oâ
);

143 
	}
}

146 
	$cmp_¡r_£c
(cÚ¡ *
p1
, cÚ¡ *
p2
)

148 cÚ¡ *
n
 = 
p1
;

149 cÚ¡ 
tcc_’Œy
 *
‹
 = 
p2
;

150 
‹
->
ty³
){

151 
TCC_SECTION
:

152 
TCC_MSECTION
:

153  
	`¡rcmp
(
n
, 
‹
->
£ùiÚ
->
Çme
);

156 
	}
}

158 
cÚf_£ùiÚ
 *

159 
	$g‘£ùiÚ
(
tccÚf_£ùiÚ_t
 **
ts
, 
cÚf_£ùiÚ
 *
£c
, *
Çme
)

161 
tccÚf_£ùiÚ_t
 *
·th
 = 
NULL
;

162 *
tmp
 = 
	`¡rdup
(
Çme
);

163 *
Š
 = 
tmp
;

164 *
s
;

166 if(
ts
)

167 
·th
 = *
ts
;

176 (
s
 = 
	`¡r£p
(&
tmp
, "/")è!ğ
NULL
){

177 if(*
s
 == 0)

180 if(!
	`¡rcmp
(
s
, "..")){

181 if(
·th
 &&…©h->
·»Á
){

182 
tccÚf_£ùiÚ_t
 *
p
 = 
·th
;

183 
·th
 = 
	`tüef
Õ©h->
·»Á
);

184 
£c
 = 
·th
->sec;

185 
	`tcä“
(
p
);

186 } if(
£c
->
·»Á
){

187 
£c
 = sec->
·»Á
;

190 
tccÚf_£ùiÚ_t
 *
Å
;

191 
tcc_’Œy
 *
‹
;

193 if(
	`tşi¡_fšd
(
£c
->
’Œ›s
, 
s
, &
‹
, 
cmp_¡r_£c
)){

194 
tşi¡_t
 *
mli¡
 = 
£c
->
m”ge
;

195 
tşi¡_™em_t
 *
li
 = 
NULL
;

196 *
m
;

198 
£c
 = 
NULL
;

200 (
m
 = 
	`tşi¡_´ev
(
mli¡
, &
li
))){

201 
cÚf_£ùiÚ
 *
ps
, *
ms
;

202 if(
·th
)

203 
ps
 = 
·th
->
·»Á
?…©h->·»Á->
£c
:…ath->sec;

205 
ps
 = 
£c
->
·»Á
? sec->parent: sec;

206 
ms
 = 
	`g‘£ùiÚ
(
NULL
, 
ps
, 
m
);

207 if(
ms
 && (
£c
 = 
	`g‘£ùiÚ
(
NULL
, ms, 
s
)))

210 if(
li
)

211 
	`tşi¡_uÆock
(
£c
->
m”ge
, 
li
);

213 
£c
 = 
‹
->
£ùiÚ
;

216 if(!
£c
)

219 if(
·th
){

220 
Å
 = 
	`tÿÎocdz
((*Å), 
NULL
, 
tccÚf_ä“
);

221 
Å
->
£c
 = 
	`tüef
(sec);

222 
Å
->
·»Á
 = 
·th
;

223 
·th
 = 
Å
;

229 if(
ts
)

230 *
ts
 = 
·th
;

232 
	`ä“
(
Š
);

233  
£c
;

234 
	}
}

236 
tccÚf_£ùiÚ_t
 *

237 
	$tccÚf_g‘£ùiÚ
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
)

239 
	`tüef
(
ts
);

240 if(!
Çme
 || 
	`g‘£ùiÚ
(&
ts
,s->
£c
,‚ame))

241  
ts
;

242 
	`tcä“
(
ts
);

243  
NULL
;

244 
	}
}

247 
	$cmp_¡r_v®
(cÚ¡ *
p1
, cÚ¡ *
p2
)

249 cÚ¡ *
n
 = 
p1
;

250 cÚ¡ 
tcc_’Œy
 *
‹
 = 
p2
;

252 if(
‹
->
ty³
 =ğ
TCC_VALUE
)

253  
	`¡rcmp
(
n
, 
‹
->
v®ue
.
key
);

255 
	}
}

258 
	$cmp_glob_v®
(cÚ¡ *
p1
, cÚ¡ *
p2
)

260 cÚ¡ *
n
 = 
p1
;

261 cÚ¡ 
tcc_’Œy
 *
‹
 = 
p2
;

263 if(
‹
->
ty³
 =ğ
TCC_VALUE
)

264  
	`âm©ch
(
n
, 
‹
->
v®ue
.
key
, 0);

266 
	}
}

268 
tcc_’Œy
 *

269 
	$g‘v®ue
(
cÚf_£ùiÚ
 *
£c
, *
Çme
, 
tccÚf_£ùiÚ_t
 **
ts
)

271 
tccÚf_£ùiÚ_t
 *
·th
 = 
NULL
;

272 *
tmp
 = 
	`¡rdup
(
Çme
);

273 *
v
;

274 
tcc_’Œy
 *
‹
 = 
NULL
;

283 if((
v
 = 
	`¡¼chr
(
tmp
, '/')è!ğ
NULL
){

284 *
v
++ = 0;

285 if(!(
£c
 = 
	`g‘£ùiÚ
(
ts
, sec, 
tmp
)))

286 
’d
;

288 
v
 = 
tmp
;

291 if(
	`tşi¡_fšd
(
£c
->
’Œ›s
, 
v
, &
‹
, 
cmp_¡r_v®
)){

292 
tşi¡_™em_t
 *
li
 = 
NULL
;

293 *
m
;

294 (
m
 = 
	`tşi¡_´ev
(
£c
->
m”ge
, &
li
))){

295 
cÚf_£ùiÚ
 *
ps
, *
ms
;

296 if(
·th
)

297 
ps
 = 
·th
->
·»Á
?…©h->·»Á->
£c
:…ath->sec;

299 
ps
 = 
£c
->
·»Á
? sec->parent: sec;

300 
ms
 = 
	`g‘£ùiÚ
(
NULL
, 
ps
, 
m
);

301 if(
ms
 && (
‹
 = 
	`g‘v®ue
(ms, 
v
, 
NULL
)))

304 if(
li
)

305 
	`tşi¡_uÆock
(
£c
->
m”ge
, 
li
);

309 
’d
:

310 
	`ä“
(
tmp
);

311  
‹
;

312 
	}
}

314 
ı_v®
(
tccÚf_£ùiÚ_t
 *
£c
, 
tcc_v®ue
 *
tv
, 
ty³
, *
d¡
);

317 
	$vto¡r
(*
Çme
, *
_ts
)

319 
tccÚf_£ùiÚ_t
 *
ts
 = 
_ts
;

320 
tşi¡_™em_t
 *
li
 = 
NULL
;

321 
tcc_v®ue
 *
tv
;

322 
tcc_’Œy
 *
‹
;

323 
l
 = 0;

324 *
s
 = 
NULL
;

325 *
p
 = 
s
;

326 
¥
 = 0;

328 
	#ext
(
n
) do { \

329 
o
 = 
p
 - 
s
; \

330 
s
 = 
	`»®loc
(s, 
l
 +ğ
n
); \

331 
p
 = 
s
 + 
o
; \

332 } 0)

	)

334 
	`tüef
(
ts
);

336 if(!(
‹
 = 
	`g‘v®ue
(
ts
->
£c
, 
Çme
, &ts)))

337  
NULL
;

339 (
tv
 = 
	`tşi¡_Ãxt
(
‹
->
v®ue
.
v®ues
, &
li
))){

341 
ušt64_t
 
i
;

342 
d
;

343 *
s
;

344 } 
v
;

345 
¦
;

347 
	`ı_v®
(
ts
, 
tv
,v->
ty³
 | 
TCC_LONG
, &
v
);

349 if(
¥
)

350 *
p
++ = ' ';

352 
tv
->
ty³
 & 
TCC_TYPEMASK
){

353 
TCC_INTEGER
:

354 
	`ext
(22);

355 
p
 +ğ
	`¢´štf
Õ, 22, "%Îi", 
v
.
i
);

357 
TCC_FLOAT
:

358 
	`ext
(40);

359 
p
 +ğ
	`¢´štf
Õ, 40, "%lf", 
v
.
d
);

361 
TCC_REF
:

362 
v
.
s
 = 
	`vto¡r
(
tv
->
v®ue
.
¡ršg
, 
ts
);

363 
TCC_STRING
:

364 
¦
 = 
	`¡¾’
(
v
.
s
);

365 
	`ext
(
¦
 + 1);

366 
	`¡rıy
(
p
, 
v
.
s
);

367 
	`ä“
(
v
.
s
);

368 
p
 +ğ
¦
;

371 
¥
 = 1;

374 *
p
 = 0;

376 #undeà
ext


377 
	`tcä“
(
ts
);

378  
s
;

379 
	}
}

382 
	$ı_v®
(
tccÚf_£ùiÚ_t
 *
ts
, 
tcc_v®ue
 *
tv
, 
ty³
, *
d¡
)

384 
tv
->
ty³
 & 
TCC_TYPEMASK
){

385 
TCC_STRING
:

386 if(
tv
->
ty³
 & 
TCC_EXPAND
)

387 *(**è
d¡
 = 
	`tc¡»xp
(
tv
->
v®ue
.
¡ršg
, "(", ")", ':',

388 
vto¡r
, 
ts
,

389 
TCSTREXP_ESCAPE
 | 
TCSTREXP_FREE
);

391 *(**è
d¡
 = 
	`¡rdup
(
tv
->
v®ue
.
¡ršg
);

394 
TCC_INTEGER
:

395 
ty³
 & ~
TCC_TYPEMASK
){

397 *(
št32_t
 *è
d¡
 = (št32_tè
tv
->
v®ue
.
š‹g”
;

399 
TCC_UNSIGNED
:

400 *(
ušt32_t
 *è
d¡
 = (ušt32_tè
tv
->
v®ue
.
š‹g”
;

402 
TCC_LONG
:

403 *(
št64_t
 *è
d¡
 = (št64_tè
tv
->
v®ue
.
š‹g”
;

405 
TCC_LONG
|
TCC_UNSIGNED
:

406 *(
ušt64_t
 *è
d¡
 = (ušt64_tè
tv
->
v®ue
.
š‹g”
;

411 
TCC_FLOAT
:

412 
ty³
 & ~
TCC_TYPEMASK
){

414 *(*è
d¡
 = (è
tv
->
v®ue
.
æßtšg
;

416 
TCC_LONG
:

417 *(*è
d¡
 = (è
tv
->
v®ue
.
æßtšg
;

424 
TCC_REF
:

425 if(
ty³
 & 
TCC_IGNORE
)

428 
ty³
 & ~
TCC_UNSIGNED
){

429 
TCC_INTEGER
:

430 *(
ušt32_t
 *è
d¡
 = 0;

432 
TCC_INTEGER
|
TCC_LONG
:

433 *(
št64_t
 *è
d¡
 = 0;

435 
TCC_FLOAT
:

436 *(*è
d¡
 = 0;

438 
TCC_FLOAT
|
TCC_LONG
:

439 *(*è
d¡
 = 0;

441 
TCC_STRING
:

442 *(**è
d¡
 = 
NULL
;

448 
	`årštf
(
¡d”r
, "BUG: bady³ %x\n", 
ty³
);

452 
	}
}

455 
	$g‘’Œy
(
tccÚf_£ùiÚ_t
 *
ts
, 
tcc_’Œy
 *
‹
, *
fmt
,

456 
va_li¡
 
¬gs
, **

)

458 *
f
 = 
fmt
, *
p
;

459 
n
 = 0;

460 
tşi¡_™em_t
 *
li
 = 
NULL
;

461 
tcc_v®ue
 *
tv
;

462 
va_li¡
 
ac
;

464 (
p
 = 
	`¡rchr
(
f
, '%')è!ğ
NULL
){

465 *
de¡
;

466 
ty³
 = 0;

468 if((
tv
 = 
	`tşi¡_Ãxt
(
‹
->
v®ue
.
v®ues
, &
li
)è=ğ
NULL
)

471 
f
 = 
p
;

473 if(
tv
->
ty³
 =ğ
TCC_REF
 && 
	`¡rcmp
Ñv->
v®ue
.
¡ršg
, "NULL")){

474 
tccÚf_£ùiÚ_t
 *
rs
 = 
	`tüef
(
ts
);

475 
tcc_’Œy
 *
»
;

476 
r
;

478 if(!(
»
 = 
	`g‘v®ue
(
rs
->
£c
, 
tv
->
v®ue
.
¡ršg
, &rs))){

479 
n
 = -n;

482 #ifdeà
__va_cİy


483 
	`__va_cİy
(
ac
, 
¬gs
);

485 
ac
 = 
¬gs
;

487 
r
 = 
	`g‘’Œy
(
ts
, 
»
, 
f
, 
ac
, &f);

488 
	`tcä“
(
rs
);

489 if(
r
 < 0){

490 
n
 +ğ-
r
;

493 
n
 +ğ
r
;

494 
r
--)

495 
	`va_¬g
(
¬gs
, *);

499 
de¡
 = 
	`va_¬g
(
¬gs
, *);

500 
f
++;

502 !(
ty³
 & 
TCC_TYPEMASK
è&& *
f
){

503 *
f
){

505 
ty³
 |ğ
TCC_STRING
;

510 
ty³
 |ğ
TCC_INTEGER
;

514 
ty³
 |ğ
TCC_FLOAT
;

518 
ty³
 |ğ
TCC_LONG
;

522 
ty³
 |ğ
TCC_UNSIGNED
;

526 
ty³
 |ğ
TCC_IGNORE
;

529 
f
++;

532 if(
	`ı_v®
(
ts
, 
tv
, 
ty³
, 
de¡
) < 0){

533 
	`årštf
(
¡d”r
, "Ty³ mism©ch iÀ'%s'.\n", 
‹
->
v®ue
.
key
);

534 
n
 = -n;

537 
n
++;

541 if(

)

542 *

 = 
f
;

544 if(
li
)

545 
	`tşi¡_uÆock
(
‹
->
v®ue
.
v®ues
, 
li
);

547  
n
;

548 
	}
}

551 
	$tccÚf_g‘v®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, *
fmt
, ...)

553 
va_li¡
 
¬gs
;

554 
tcc_’Œy
 *
‹
;

555 
n
;

557 
	`tüef
(
£c
);

558 if(!(
‹
 = 
	`g‘v®ue
(
£c
->£c, 
Çme
, &sec))){

559 
	`tcä“
(
£c
);

563 
	`va_¡¬t
(
¬gs
, 
fmt
);

564 
n
 = 
	`g‘’Œy
(
£c
, 
‹
, 
fmt
, 
¬gs
, 
NULL
);

565 
	`va_’d
(
¬gs
);

567 
	`tcä“
(
£c
);

568  
n
 < 0? -n:‚;

569 
	}
}

572 
tşi¡_™em_t
 *
li
, *
ml
;

573 *
n
;

574 
tccÚf_£ùiÚ_t
 *
£c
, *
ts
;

575 *
v¤
;

576 } 
	tv_¡©e
;

578 
tccÚf_£ùiÚ_t
 *

579 
	$Ãxt_m”ge
(
tccÚf_£ùiÚ_t
 *
£c
, 
v_¡©e
 *
vs
)

581 
tccÚf_£ùiÚ_t
 *
s
 = 
NULL
;

582 *
m
;

584 (
m
 = 
	`tşi¡_Ãxt
(
£c
->£c->
m”ge
, &
vs
->
ml
))){

585 
tccÚf_£ùiÚ_t
 *
ms
 = 
	`tccÚf_g‘£ùiÚ
(
£c
->
·»Á
, 
m
);

586 if(
ms
){

587 
s
 = 
ms
;

592  
s
;

593 
	}
}

595 
v_¡©e
 *

596 
	$v¡©e
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, **
¡©e
)

598 
v_¡©e
 *
vs
 = *
¡©e
;

600 if(!
vs
){

601 *
tmp
 = 
	`¡rdup
(
Çme
);

602 *
v
 = 
	`¡¼chr
(
tmp
, '/');

603 
tccÚf_£ùiÚ_t
 *
ms
;

605 if(
v
){

606 *
v
++ = 0;

607 if(!(
£c
 = 
	`tccÚf_g‘£ùiÚ
(£c, 
tmp
))){

608 
	`ä“
(
tmp
);

609  
NULL
;

612 
v
 = 
tmp
;

613 
	`tüef
(
£c
);

616 
vs
 = *
¡©e
 = 
	`ÿÎoc
(1, (
v_¡©e
));

617 
vs
->
n
 = 
	`¡rdup
(
v
);

618 
vs
->
ts
 = 
£c
;

619 
ms
 = 
	`Ãxt_m”ge
(
£c
, 
vs
);

620 if(
ms
)

621 
£c
 = 
ms
;

622 
vs
->
£c
 = sec;

623 
	`ä“
(
tmp
);

626  
vs
;

627 
	}
}

630 
	$vsä“
(
v_¡©e
 *
vs
)

632 
	`ä“
(
vs
->
n
);

633 
	`tcä“
(
vs
->
ts
);

634 
	`ä“
(
vs
);

635 
	}
}

638 
	$tccÚf_Ãxtv®ue_vc
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
, **
¡©e
,

639 **
ºame
, *
fmt
, 
va_li¡
 
¬gs
, 
tccom·»_â
 
cmp
)

641 
v_¡©e
 *
vs
;

642 
tcc_’Œy
 *
‹
;

643 
n
 = 0;

645 if(!(
vs
 = 
	`v¡©e
(
ts
, 
Çme
, 
¡©e
)))

648 
vs
->
ml
){

649 
n
 = 
	`tccÚf_Ãxtv®ue_vc
(
vs
->
£c
, vs->n, &vs->
v¤
, 
ºame
,

650 
fmt
, 
¬gs
, 
cmp
);

651 if(!
vs
->
v¤
){

652 
tccÚf_£ùiÚ_t
 *
ms
 = 
	`Ãxt_m”ge
(
vs
->
ts
, vs);

653 
	`tcä“
(
vs
->
£c
);

654 if(
ms
){

655 
vs
->
£c
 = 
ms
;

657 
vs
->
£c
 = vs->
ts
;

660 if(
n
 > 0){

661  
n
;

665 
‹
 = 
	`tşi¡_´ev_m©ched
(
vs
->
£c
->£c->
’Œ›s
, &vs->
li
, vs->
n
, 
cmp
);

666 if(
‹
){

667 
n
 = 
	`g‘’Œy
(
vs
->
£c
, 
‹
, 
fmt
, 
¬gs
, 
NULL
);

668 if(
ºame
)

669 *
ºame
 = 
‹
->
v®ue
.
key
;

671 *
¡©e
 = 
NULL
;

672 
	`vsä“
(
vs
);

675  
n
 < 0? -n:‚;

676 
	}
}

679 
	$tccÚf_Ãxtv®ue_v
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
, **
¡©e
,

680 *
fmt
, 
va_li¡
 
¬gs
)

682  
	`tccÚf_Ãxtv®ue_vc
(
ts
, 
Çme
, 
¡©e
, 
NULL
, 
fmt
, 
¬gs
, 
cmp_¡r_v®
);

683 
	}
}

686 
	$tccÚf_Ãxtv®ue
(
tccÚf_£ùiÚ_t
 *
£c
, *
Çme
, **
¡©e
,

687 *
fmt
, ...)

689 
va_li¡
 
¬gs
;

690 
n
;

692 
	`va_¡¬t
(
¬gs
, 
fmt
);

693 
n
 = 
	`tccÚf_Ãxtv®ue_vc
(
£c
, 
Çme
, 
¡©e
, 
NULL
, 
fmt
, 
¬gs
, 
cmp_¡r_v®
);

694 
	`va_’d
(
¬gs
);

695  
n
;

696 
	}
}

699 
	$tccÚf_Ãxtv®ue_g
(
tccÚf_£ùiÚ_t
 *
£c
, *
glob
, **
¡©e
,

700 **
Çme
, *
fmt
, ...)

702 
va_li¡
 
¬gs
;

703 
n
;

705 
	`va_¡¬t
(
¬gs
, 
fmt
);

706 
n
 = 
	`tccÚf_Ãxtv®ue_vc
(
£c
, 
glob
, 
¡©e
, 
Çme
, 
fmt
, 
¬gs
, 
cmp_glob_v®
);

707 
	`va_’d
(
¬gs
);

708  
n
;

709 
	}
}

711 
tccÚf_£ùiÚ_t
 *

712 
	$tccÚf_Ãxt£ùiÚ
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
, **
¡©e
)

714 
tccÚf_£ùiÚ_t
 *
ns
;

715 
v_¡©e
 *
vs
;

716 
cÚf_£ùiÚ
 *
£c
 = 
NULL
;

718 if(!(
vs
 = 
	`v¡©e
(
ts
, 
Çme
, 
¡©e
)))

719  
NULL
;

721 
vs
->
ml
){

722 
tccÚf_£ùiÚ_t
 *
s
 = 
	`tccÚf_Ãxt£ùiÚ
(
vs
->
£c
, vs->
n
, &vs->
v¤
);

723 if(!
vs
->
v¤
){

724 
tccÚf_£ùiÚ_t
 *
ms
 = 
	`Ãxt_m”ge
(
vs
->
ts
, vs);

725 
	`tcä“
(
vs
->
£c
);

726 if(
ms
){

727 
vs
->
£c
 = 
ms
;

729 
vs
->
£c
 = vs->
ts
;

732 if(
s
){

733 
£c
 = 
s
->sec;

734 
	`tcä“
(
s
);

739 if(!
£c
){

740 
tcc_’Œy
 *
‹
 = 
	`tşi¡_´ev_m©ched
(
vs
->
£c
->£c->
’Œ›s
, &vs->
li
,

741 
vs
->
n
, 
cmp_¡r_£c
);

742 if(!
‹
){

743 *
¡©e
 = 
NULL
;

744 
	`vsä“
(
vs
);

745  
NULL
;

747 
£c
 = 
‹
->
£ùiÚ
;

750 
ns
 = 
	`tÿÎocd
((*ns), 
NULL
, 
tccÚf_ä“
);

751 
ns
->
£c
 = 
	`tüef
(sec);

752 
ns
->
·»Á
 = 
	`tüef
(
ts
);

753  
ns
;

754 
	}
}

756 
tccÚf_£ùiÚ_t
 *

757 
	$tccÚf_m”ge
(
tccÚf_£ùiÚ_t
 *
£c
,ccÚf_£ùiÚ_ˆ*
s2
)

759 
tşi¡_™em_t
 *
li
 = 
NULL
;

760 
tcc_’Œy
 *
‹
;

761 *
m
;

763 if(!
£c
){

764 
£c
 = 
	`tccÚf_Ãw
(
NULL
);

765 if(
s2
->
·»Á
)

766 
£c
->
·»Á
 = 
	`tüef
(
s2
->parent);

769 
£c
->£c->
·»Á
 = 
s2
->sec->parent;

772 (
‹
 = 
	`tşi¡_Ãxt
(
s2
->
£c
->
’Œ›s
, &
li
)))

773 
	`tşi¡_push
(
£c
->£c->
’Œ›s
, 
	`tüef
(
‹
));

775 (
m
 = 
	`tşi¡_Ãxt
(
s2
->
£c
->
m”ge
, &
li
)))

776 
	`tşi¡_push
(
£c
->£c->
m”ge
, 
	`¡rdup
(
m
));

778  
£c
;

779 
	}
}

782 
	$ä“_v®ue
(*
p
)

784 
tcc_v®ue
 *
tv
 = 
p
;

785 
tv
->
ty³
 & 
TCC_TYPEMASK
){

786 
TCC_STRING
:

787 
TCC_REF
:

788 
	`ä“
(
tv
->
v®ue
.
¡ršg
);

790 
	`ä“
(
tv
);

791 
	}
}

794 
	$ä“_’Œy
(*
p
)

796 
tcc_’Œy
 *
‹
 = 
p
;

798 
‹
->
ty³
){

799 
TCC_VALUE
:

800 
	`tşi¡_de¡roy
(
‹
->
v®ue
.
v®ues
, 
ä“_v®ue
);

801 
	`ä“
(
‹
->
v®ue
.
key
);

804 
TCC_SECTION
:

805 
TCC_MSECTION
:

806 
	`tcä“
(
‹
->
£ùiÚ
);

809 
	}
}

812 
	$cÚf_ä“
(*
p
)

814 
cÚf_£ùiÚ
 *
£c
 = 
p
;

815 
	`tşi¡_de¡roy
(
£c
->
’Œ›s
, 
tcä“
);

816 
	`tşi¡_de¡roy
(
£c
->
m”ge
, 
ä“
);

817 if(
£c
->
Çme
)

818 
	`ä“
(
£c
->
Çme
);

819 
	}
}

821 
cÚf_£ùiÚ
 *

822 
	$cÚf_Ãw
(*
Çme
)

824 
cÚf_£ùiÚ
 *
£c
;

825 
£c
 = 
	`tÿÎocdz
((*£c), 
NULL
, 
cÚf_ä“
);

826 
£c
->
Çme
 =‚ame? 
	`¡rdup
Òame): 
NULL
;

827 
£c
->
’Œ›s
 = 
	`tşi¡_Ãw
(
TC_LOCK_SLOPPY
);

828 
£c
->
m”ge
 = 
	`tşi¡_Ãw
(
TC_LOCK_SLOPPY
);

829  
£c
;

830 
	}
}

832 
tccÚf_£ùiÚ_t
 *

833 
	$tccÚf_Ãw
(*
Çme
)

835 
tccÚf_£ùiÚ_t
 *
ts
 = 
	`tÿÎocdz
((*ts), 
NULL
, 
tccÚf_ä“
);

836 
ts
->
£c
 = 
	`cÚf_Ãw
(
Çme
);

837  
ts
;

838 
	}
}

840 
tcc_’Œy
 *

841 
	$®loc_’Œy
(
cÚf_£ùiÚ
 *
£c
, *
Çme
, 
ty³
)

843 
tcc_’Œy
 *
‹
 = 
NULL
;

844 
‹
 = 
	`tÿÎocd
((*‹), 
NULL
, 
ä“_’Œy
);

845 (
‹
->
ty³
 =ype)){

846 
TCC_SECTION
:

847 
TCC_MSECTION
:

848 
‹
->
£ùiÚ
 = 
	`cÚf_Ãw
(
Çme
);

849 
‹
->
£ùiÚ
->
·»Á
 = 
£c
;

851 
TCC_VALUE
:

852 
‹
->
v®ue
.
key
 = 
	`¡rdup
(
Çme
);

853 
‹
->
v®ue
.
v®ues
 = 
	`tşi¡_Ãw
(
TC_LOCK_SLOPPY
);

856  
‹
;

857 
	}
}

859 
tcc_’Œy
 *

860 
	$ü—‹_’Œy
(
cÚf_£ùiÚ
 *
£c
, *
Çme
, 
ty³
)

862 *
tmp
 = 
	`¡rdup
(
Çme
);

863 *
tmpf
 = 
tmp
;

864 *
s
, *
v
;

865 
tcc_’Œy
 *
‹
;

866 
üt
;

867 
tccom·»_â
 
cmp
 = 
NULL
;

869 if((
v
 = 
	`¡¼chr
(
tmp
, '/'))){

870 *
v
++ = 0;

872 
v
 = 
Çme
;

873 *
tmp
 = 0;

876 (
s
 = 
	`¡r£p
(&
tmp
, "/")è!ğ
NULL
){

877 if(*
s
 == 0)

880 if(
	`tşi¡_fšd
(
£c
->
’Œ›s
, 
s
, &
‹
, 
cmp_¡r_£c
) != 0){

881 
‹
 = 
	`®loc_’Œy
(
£c
, 
s
, 
TCC_SECTION
);

882 
	`tşi¡_unshiá
(
£c
->
’Œ›s
, 
‹
);

884 
£c
 = 
‹
->
£ùiÚ
;

887 
ty³
){

888 
TCC_VALUE
:

889 
üt
 = 1;

890 
cmp
 = 
cmp_¡r_v®
;

893 
TCC_SECTION
:

894 
üt
 = 0;

895 
cmp
 = 
cmp_¡r_£c
;

898 
TCC_MSECTION
:

899 
üt
 = 1;

900 
cmp
 = 
cmp_¡r_£c
;

904 if(
üt
 || 
	`tşi¡_fšd
(
£c
->
’Œ›s
, 
v
, &
‹
, 
cmp
) != 0){

905 
‹
 = 
	`®loc_’Œy
(
£c
, 
v
, 
ty³
);

906 
	`tşi¡_unshiá
(
£c
->
’Œ›s
, 
‹
);

909 
	`ä“
(
tmpf
);

910  
‹
;

911 
	}
}

914 
	$tccÚf_£tv®ue
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
, *
fmt
, ...)

916 
cÚf_£ùiÚ
 *
£c
 = 
ts
->sec;

917 
tcc_’Œy
 *
‹
;

918 
va_li¡
 
¬gs
;

919 *
f
 = 
fmt
;

921 
‹
 = 
	`ü—‹_’Œy
(
£c
, 
Çme
, 
TCC_VALUE
);

923 
	`va_¡¬t
(
¬gs
, 
fmt
);

924 (
f
 = 
	`¡rchr
(f, '%')è!ğ
NULL
){

925 
Êg
 = 0;

927 if(*++
f
 == 'l'){

928 
Êg
 = 1;

929 
f
++;

932 *
f
){

935 
	`tcc_addšt
(
‹
, 
Êg
? 
	`va_¬g
(
¬gs
, ): va_arg(args, ));

939 
	`tcc_addæßt
(
‹
, 
	`va_¬g
(
¬gs
, ));

943 
	`tcc_add¡ršg
(
‹
, 
	`¡rdup
(
	`va_¬g
(
¬gs
, *)), 0);

949 
	}
}

952 
	$tccÚf_ş—rv®ue
(
tccÚf_£ùiÚ_t
 *
ts
, *
Çme
)

954 
cÚf_£ùiÚ
 *
£c
 = 
NULL
;

955 *
n
 = 
	`¡rdup
(
Çme
);

956 *
p
 = 
	`¡¼chr
(
n
, '/');

957 
tccÚf_£ùiÚ_t
 *
s
 = 
NULL
;

958 
c
 = 0;

960 if(
p
){

961 *
p
++ = 0;

962 if((
s
 = 
	`tccÚf_g‘£ùiÚ
(
ts
, 
n
)))

963 
£c
 = 
s
->sec;

965 
p
 = 
n
;

966 
£c
 = 
ts
->sec;

969 if(
£c
)

970 
c
 = 
	`tşi¡_d–‘e_m©ched
(
£c
->
’Œ›s
, 
p
, 
cmp_¡r_£c
, 
tcä“
);

971 if(
s
)

972 
	`tcä“
(
s
);

974 
	`ä“
(
n
);

975  
c
;

976 
	}
}

982 
	$tcc_addšt
(
tcc_’Œy
 *
‹
, 
n
)

984 if(
‹
->
ty³
 =ğ
TCC_VALUE
){

985 
tcc_v®ue
 *
tv
 = 
	`m®loc
((tcc_value));

986 
tv
->
ty³
 = 
TCC_INTEGER
;

987 
tv
->
v®ue
.
š‹g”
 = 
n
;

988 
	`tşi¡_push
(
‹
->
v®ue
.
v®ues
, 
tv
);

991 
	}
}

994 
	$tcc_addæßt
(
tcc_’Œy
 *
‹
, 
f
)

996 if(
‹
->
ty³
 =ğ
TCC_VALUE
){

997 
tcc_v®ue
 *
tv
 = 
	`m®loc
((tcc_value));

998 
tv
->
ty³
 = 
TCC_FLOAT
;

999 
tv
->
v®ue
.
æßtšg
 = 
f
;

1000 
	`tşi¡_push
(
‹
->
v®ue
.
v®ues
, 
tv
);

1003 
	}
}

1006 
	$tcc_add¡ršg
(
tcc_’Œy
 *
‹
, *
s
, 
exp
)

1008 if(
‹
->
ty³
 =ğ
TCC_VALUE
){

1009 
tcc_v®ue
 *
tv
 = 
	`m®loc
((tcc_value));

1010 
tv
->
ty³
 = 
TCC_STRING
;

1011 if(
exp
)

1012 
tv
->
ty³
 |ğ
TCC_EXPAND
;

1013 
tv
->
v®ue
.
¡ršg
 = 
s
;

1014 
	`tşi¡_push
(
‹
->
v®ue
.
v®ues
, 
tv
);

1017 
	}
}

1020 
	$tcc_addboŞ
(
tcc_’Œy
 *
‹
, 
n
)

1022 if(
‹
->
ty³
 =ğ
TCC_VALUE
){

1023 
tcc_v®ue
 *
tv
 = 
	`m®loc
((tcc_value));

1024 
tv
->
ty³
 = 
TCC_BOOLEAN
;

1025 
tv
->
v®ue
.
boŞ—n
 = 
n
;

1026 
	`tşi¡_push
(
‹
->
v®ue
.
v®ues
, 
tv
);

1029 
	}
}

1032 
	$tcc_add»f
(
tcc_’Œy
 *
‹
, *
»f
)

1034 if(
‹
->
ty³
 =ğ
TCC_VALUE
){

1035 
tcc_v®ue
 *
tv
 = 
	`m®loc
((*tv));

1036 
tv
->
ty³
 = 
TCC_REF
;

1037 
tv
->
v®ue
.
¡ršg
 = 
»f
;

1038 
	`tşi¡_push
(
‹
->
v®ue
.
v®ues
, 
tv
);

1041 
	}
}

1044 
	$tcc_wr™–i¡
(
tşi¡_t
 *
l
, *
fe
, 
lv
, 
tcio_â
 
oâ
)

1046 
tşi¡_™em_t
 *
li
 = 
NULL
;

1047 
tcc_’Œy
 *
‹
;

1048 (
‹
 = 
	`tşi¡_´ev
(
l
, &
li
)è!ğ
NULL
){

1049 
	`tcc_wr™“Áry
(
‹
, 
fe
, 
lv
, 
oâ
);

1052 
	}
}

1055 
	$do_´štf
(*
fe
, 
tcio_â
 
oâ
, *
fmt
, ...)

1057 
buf
[512];

1058 
va_li¡
 
¬gs
;

1059 
l
, 
r
;

1061 
	`va_¡¬t
(
¬gs
, 
fmt
);

1062 
l
 = 
	`v¢´štf
(
buf
, (buf), 
fmt
, 
¬gs
);

1063 if(
l
 =ğ(
buf
))

1064 
	`årštf
(
¡d”r
, "tcconf:runcated output\n");

1065 
r
 = 
	`oâ
(
buf
, 1, 
l
, 
fe
);

1066 
	`va_’d
(
¬gs
);

1068  
r
;

1069 
	}
}

1072 
	$tcc_wr™e£ùiÚ
(
cÚf_£ùiÚ
 *
ts
, *
fe
, 
lv
, *
d
, 
tcio_â
 
oâ
)

1074 
l
 = 
lv
 * 8;

1075 
tşi¡_™em_t
 *
li
 = 
NULL
;

1076 *
m
;

1078 
	`do_´štf
(
fe
, 
oâ
, "%*s%s", 
l
, "", 
ts
->
Çme
);

1080 (
m
 = 
	`tşi¡_Ãxt
(
ts
->
m”ge
, &
li
)))

1081 
	`årštf
(
fe
, " : %s", 
m
);

1082 
	`do_´štf
(
fe
, 
oâ
, " %c\n", 
d
[0]);

1083 
	`tcc_wr™–i¡
(
ts
->
’Œ›s
, 
fe
, 
lv
 + 1, 
oâ
);

1084 
	`do_´štf
(
fe
, 
oâ
, "%*s%c\n", 
l
, "", 
d
[1]);

1086 
	}
}

1089 
	$tcc_wr™“Áry
(
tcc_’Œy
 *
‹
, *
fe
, 
lv
, 
tcio_â
 
oâ
)

1091 
tşi¡_™em_t
 *
li
 = 
NULL
;

1092 
tcc_v®ue
 *
tv
;

1093 
l
 = 
lv
 * 8;

1095 
‹
->
ty³
){

1096 
TCC_VALUE
:

1097 
	`do_´štf
(
fe
, 
oâ
, "%*s%s", 
l
, "", 
‹
->
v®ue
.
key
);

1098 (
tv
 = 
	`tşi¡_Ãxt
(
‹
->
v®ue
.
v®ues
, &
li
)è!ğ
NULL
){

1099 
sd
;

1100 
tv
->
ty³
 & 
TCC_TYPEMASK
){

1101 
TCC_INTEGER
:

1102 
	`do_´štf
(
fe
, 
oâ
, " %ld", 
tv
->
v®ue
.
š‹g”
);

1104 
TCC_FLOAT
:

1105 
	`do_´štf
(
fe
, 
oâ
, " %.16g", 
tv
->
v®ue
.
æßtšg
);

1107 
TCC_BOOLEAN
:

1108 
	`do_´štf
(
fe
, 
oâ
, " %s",

1109 
tv
->
v®ue
.
boŞ—n
? "true": "false");

1111 
TCC_STRING
:

1112 
sd
 = 
tv
->
ty³
 & 
TCC_EXPAND
? '"': '\'';

1113 
	`do_´štf
(
fe
, 
oâ
, " %c%s%c", 
sd
, 
tv
->
v®ue
.
¡ršg
, sd);

1115 
TCC_REF
:

1116 
	`do_´štf
(
fe
, 
oâ
, " %s", 
tv
->
v®ue
.
¡ršg
);

1120 
	`do_´štf
(
fe
, 
oâ
, "\n");

1123 
TCC_SECTION
:

1124 
	`tcc_wr™e£ùiÚ
(
‹
->
£ùiÚ
, 
fe
, 
lv
, "{}", 
oâ
);

1127 
TCC_MSECTION
:

1128 
	`tcc_wr™e£ùiÚ
(
‹
->
£ùiÚ
, 
fe
, 
lv
, "[]", 
oâ
);

1132 
	`årštf
(
¡d”r
, "Internalƒrror.\n");

1137 
	}
}

	@get_interface3/libtc/src/confdump.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<tùy³s.h
>

28 
	~<tc¡ršg.h
>

29 
	~<tÿÎoc.h
>

30 
	~<tccÚf.h
>

31 
	~<uni¡d.h
>

34 
	$maš
(
¬gc
, **
¬gv
)

36 
tccÚf_£ùiÚ_t
 *
s
 = 
NULL
;

37 
FILE
 *
out
 = 
¡dout
;

38 *
outfe
 = "-";

39 
İt
;

40 
i
;

42 (
İt
 = 
	`g‘İt
(
¬gc
, 
¬gv
, "o:h")) != -1){

43 
İt
){

45 
outfe
 = 
İrg
;

48 
	`årštf
(
¡d”r
, "Usage:cconfdump [-o file] [file ...]\n");

52 if(
	`¡rcmp
(
outfe
, "-")){

53 if(!(
out
 = 
	`fİ’
(
outfe
, "w"))){

54 
	`³¼Ü
(
outfe
);

55 
	`ex™
(1);

59 
¬gc
 -ğ
İtšd
;

60 
¬gv
 +ğ
İtšd
;

62 
i
 = 0; i < 
¬gc
; i++){

63 
tccÚf_£ùiÚ_t
 *
n
;

64 if(
	`¡rcmp
(
¬gv
[
i
], "-")){

65 
n
 = 
	`tccÚf_lßd_fe
(
s
, 
¬gv
[
i
]);

67 
n
 = 
	`tccÚf_lßd
(
s
, 
¡dš
, (
tcio_â
è
ä—d
);

69 if(
n
)

70 
s
 = 
n
;

72 
	`årštf
(
¡d”r
, "tccÚfdump:ƒ¼Ü†ßdšg %s\n", 
¬gv
[
i
]);

75 if(!
¬gc
)

76 
s
 = 
	`tccÚf_lßd
(s, 
¡dš
, (
tcio_â
è
ä—d
);

78 if(
s
){

79 
	`tccÚf_wr™e
(
s
, 
out
, (
tcio_â
è
fwr™e
);

80 
	`tcä“
(
s
);

83 
	`fşo£
(
out
);

86 
	}
}

	@get_interface3/libtc/src/gethostaddr.c

25 
	~<¡dlib.h
>

26 
	~<sys/ty³s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<Ãtdb.h
>

29 
	~"tú‘.h
"

31 
	$g‘ho¡addr
(){

32 *
ho¡Çme
;

33 
ho¡’t
 *
ho¡šfo
;

34 
ho¡Çme
 = 
	`g‘ho¡Çme_a
();

35 
ho¡šfo
 = 
	`g‘ho¡byÇme
 (
ho¡Çme
);

36  *(*è
ho¡šfo
->
h_addr
;

37 
	}
}

	@get_interface3/libtc/src/gethostname.c

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<”ºo.h
>

28 
	~<uni¡d.h
>

30 *
	$g‘ho¡Çme_a
(){

31 *
Çme
;

32 
r
, 
Ën
 = 128;

34 
Çme
 = 
	`m®loc
(
Ën
);

35 (
r
 = 
	`g‘ho¡Çme
(
Çme
, 
Ën
)) < 0){

36 if(
”ºo
 =ğ
ENAMETOOLONG
){

37 
Ën
 *= 2;

38 
Çme
 = 
	`»®loc
Òame, 
Ën
);

45 if(
r
 < 0)

46  
NULL
;

48  
Çme
;

49 
	}
}

	@get_interface3/libtc/src/hash.c

25 
	~<¡dlib.h
>

26 
	~<¡ršg.h
>

27 
	~<tùy³s.h
>

28 
	~<±h»ad.h
>

29 
	~<tchash.h
>

30 
	~<tcmempoŞ.h
>

31 
	~<tÿÎoc.h
>

32 
	~<tc.h
>

35 
	shash_’Œy
 {

36 *
	mkey
;

37 
size_t
 
	mkey_size
;

38 *
	md©a
;

39 
hash_’Œy
 *
	mÃxt
;

40 } 
	thash_’Œy
;

42 
	stchash_bË
 {

43 
tchash_funùiÚ_t
 
	mhash_func
;

44 
size_t
 
	msize
;

45 
size_t
 
	m’Œ›s
;

46 
hash_’Œy
 **
	mbuck‘s
;

47 
ušt32_t
 
	mæags
;

48 
	mlockšg
;

49 
±h»ad_mu‹x_t
 
	mlock
;

50 
	mhigh_m¬k
, 
	mlow_m¬k
;

51 
tcmempoŞ_t
 *
	mmp
;

54 
u_št


55 
	$hash_size
(
u_št
 
s
)

57 
u_št
 
i
 = 1;

58 
i
 < 
s
)

59 
i
 <<= 1;

60  
i
;

61 
	}
}

91 
	#mix
(
a
,
b
,
c
) \

93 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= (c>>13); \

94 
b
 -ğ
c
; b -ğ
a
; b ^= (a<<8); \

95 
c
 -ğ
a
; c -ğ
b
; c ^= (b>>13); \

96 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= (c>>12); \

97 
b
 -ğ
c
; b -ğ
a
; b ^= (a<<16); \

98 
c
 -ğ
a
; c -ğ
b
; c ^= (b>>5); \

99 
a
 -ğ
b
;‡ -ğ
c
;‡ ^= (c>>3); \

100 
b
 -ğ
c
; b -ğ
a
; b ^= (a<<10); \

101 
c
 -ğ
a
; c -ğ
b
; c ^= (b>>15); \

102 }

	)

132 
ušt32_t
 
	tub4
;

134 
u_št


135 
	$hash_func
(*
key
, 
size_t
 
Ëngth
)

137 
ub4
 
a
,
b
,
c
,
Ën
;

138 *
k
 = 
key
;

141 
Ën
 = 
Ëngth
;

142 
a
 = 
b
 = 0x9e3779b9;

143 
c
 = 0;

146 
Ën
 >= 12){

147 
a
 +ğ(
k
[0] +((
ub4
)k[1]<<8) +((ub4)k[2]<<16) +((ub4)k[3]<<24));

148 
b
 +ğ(
k
[4] +((
ub4
)k[5]<<8) +((ub4)k[6]<<16) +((ub4)k[7]<<24));

149 
c
 +ğ(
k
[8] +((
ub4
)k[9]<<8) +((ub4)k[10]<<16)+((ub4)k[11]<<24));

150 
	`mix
(
a
,
b
,
c
);

151 
k
 +ğ12; 
Ën
 -= 12;

155 
c
 +ğ
Ëngth
;

156 
Ën
){

157 11: 
c
+=((
ub4
)
k
[10]<<24);

158 10: 
c
+=((
ub4
)
k
[9]<<16);

159 9 : 
c
+=((
ub4
)
k
[8]<<8);

161 8 : 
b
+=((
ub4
)
k
[7]<<24);

162 7 : 
b
+=((
ub4
)
k
[6]<<16);

163 6 : 
b
+=((
ub4
)
k
[5]<<8);

164 5 : 
b
+=
k
[4];

165 4 : 
a
+=((
ub4
)
k
[3]<<24);

166 3 : 
a
+=((
ub4
)
k
[2]<<16);

167 2 : 
a
+=((
ub4
)
k
[1]<<8);

168 1 : 
a
+=
k
[0];

171 
	`mix
(
a
,
b
,
c
);

173  
c
;

174 
	}
}

178 
šlše
 
u_št


179 
	$hash_v®ue
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, size_ˆ
size
)

181 
u_št
 
hv
 = 
ht
->
	`hash_func
(
key
, 
ks
);

182  
hv
 & (
size
 - 1);

183 
	}
}

186 
tchash_bË_t
 *

187 
	$tchash_Ãw
(
size
, 
lock
, 
ušt32_t
 
æags
)

189 
tchash_bË_t
 *
ht
;

191 
size
 = 
	`hash_size
(size);

192 
ht
 = 
	`m®loc
((*ht));

193 
ht
->
size
 = size;

194 
ht
->
’Œ›s
 = 0;

195 
ht
->
æags
 = flags;

196 
ht
->
buck‘s
 = 
	`ÿÎoc
(
size
, (*ht->buckets));

197 
ht
->
lockšg
 = 
lock
;

198 
	`±h»ad_mu‹x_š™
(&
ht
->
lock
, 
NULL
);

199 
ht
->
high_m¬k
 = 0.7;

200 
ht
->
low_m¬k
 = 0.3;

201 
ht
->
hash_func
 = hash_func;

202 
ht
->
mp
 = 
	`tcmempoŞ_Ãw
((
hash_’Œy
), 0);

204  
ht
;

205 
	}
}

208 
	$tchash_£thashfunùiÚ
(
tchash_bË_t
 *
ht
, 
tchash_funùiÚ_t
 
hf
)

210 if(
ht
->
’Œ›s
)

212 
ht
->
hash_func
 = 
hf
? hf: hash_func;

214 
	}
}

216 
šlše
 

217 
	$lock_hash
(
tchash_bË_t
 *
ht
)

219 if(
ht
->
lockšg
)

220 
	`±h»ad_mu‹x_lock
(&
ht
->
lock
);

221 
	}
}

223 
šlše
 

224 
	$uÆock_hash
(
tchash_bË_t
 *
ht
)

226 if(
ht
->
lockšg
)

227 
	`±h»ad_mu‹x_uÆock
(&
ht
->
lock
);

228 
	}
}

230 
šlše
 

231 
	$hash_cmp
(*
key
, 
size_t
 
ks
, 
hash_’Œy
 *
he
)

233 if(
ks
 !ğ
he
->
key_size
)

235 if(
key
 =ğ
he
->key)

237  
	`memcmp
(
key
, 
he
->key, 
ks
);

238 
	}
}

240 
šlše
 *

241 
	$hash_kdup
(*
key
, 
size_t
 
ks
)

243 *
nk
 = 
	`m®loc
(
ks
);

244 
	`memıy
(
nk
, 
key
, 
ks
);

245  
nk
;

246 
	}
}

248 
šlše
 
hash_’Œy
 *

249 
	$hash_add’Œy
(
tchash_bË_t
 *
ht
, 
u_št
 
hv
, *
key
, 
size_t
 
ks
, *
d©a
)

251 
hash_’Œy
 *
he
 = 
	`tcmempoŞ_g‘
(
ht
->
mp
);

252 if(
ht
->
æags
 & 
TCHASH_NOCOPY
)

253 
he
->
key
 = key;

255 
he
->
key
 = 
	`hash_kdup
(key, 
ks
);

256 
he
->
key_size
 = 
ks
;

257 
he
->
d©a
 = data;

258 
he
->
Ãxt
 = 
ht
->
buck‘s
[
hv
];

259 
ht
->
buck‘s
[
hv
] = 
he
;

260 
ht
->
’Œ›s
++;

262  
he
;

263 
	}
}

267 
	$tchash_£¬ch
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
d©a
, *
r
)

269 
u_št
 
hv
;

270 
hash_’Œy
 *
hr
;

271 **
»t
 = 
r
;

272 
hf
 = 0;

274 if(
ks
 =ğ(
size_t
) -1)

275 
ks
 = 
	`¡¾’
(
key
) + 1;

277 
	`lock_hash
(
ht
);

280 
hv
 = 
	`hash_v®ue
(
ht
, 
key
, 
ks
, ht->
size
);

282 
hr
 = 
ht
->
buck‘s
[
hv
]; hr; h¸ğhr->
Ãxt
)

283 if(!
	`hash_cmp
(
key
, 
ks
, 
hr
))

286 if(!
hr
){

287 
hr
 = 
	`hash_add’Œy
(
ht
, 
hv
, 
key
, 
ks
, 
d©a
);

288 
hf
 = 1;

291 if(
»t
 !ğ
NULL
)

292 *
»t
 = 
hr
->
d©a
;

294 
	`uÆock_hash
(
ht
);

295 if(
hf
 && !(
ht
->
æags
 & 
TCHASH_FROZEN
)){

296 if((è
ht
->
’Œ›s
 / ht->
size
 > ht->
high_m¬k
)

297 
	`tchash_»hash
(
ht
);

299  
hf
;

300 
	}
}

305 
	$tchash_fšd
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
r
)

307 
u_št
 
hv
;

308 
hash_’Œy
 *
hr
 = 
NULL
;

309 **
»t
 = 
r
;

311 if(
ks
 =ğ(
size_t
) -1)

312 
ks
 = 
	`¡¾’
(
key
) + 1;

314 
	`lock_hash
(
ht
);

315 
hv
 = 
	`hash_v®ue
(
ht
, 
key
, 
ks
, ht->
size
);

317 
hr
 = 
ht
->
buck‘s
[
hv
]; hr; h¸ğhr->
Ãxt
)

318 if(!
	`hash_cmp
(
key
, 
ks
, 
hr
))

321 if(
hr
 && 
»t
)

322 *
»t
 = 
hr
->
d©a
;

324 
	`uÆock_hash
(
ht
);

325  !
hr
;

326 
	}
}

330 
	$tchash_»¶aû
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
d©a
, *
r
)

332 
u_št
 
hv
;

333 
hash_’Œy
 *
hr
;

334 
»t
 = 0;

335 **
¹
 = 
r
;

337 if(
ks
 =ğ(
size_t
) -1)

338 
ks
 = 
	`¡¾’
(
key
) + 1;

340 
	`lock_hash
(
ht
);

341 
hv
 = 
	`hash_v®ue
(
ht
, 
key
, 
ks
, ht->
size
);

343 
hr
 = 
ht
->
buck‘s
[
hv
]; hr; h¸ğhr->
Ãxt
)

344 if(!
	`hash_cmp
(
key
, 
ks
, 
hr
))

347 if(
hr
){

348 if(
¹
)

349 *
¹
 = 
hr
->
d©a
;

350 
hr
->
d©a
 = data;

352 
	`hash_add’Œy
(
ht
, 
hv
, 
key
, 
ks
, 
d©a
);

353 
»t
 = 1;

356 
	`uÆock_hash
(
ht
);

357 if(
»t
 && !(
ht
->
æags
 & 
TCHASH_FROZEN
)){

358 if((è
ht
->
’Œ›s
 / ht->
size
 > ht->
high_m¬k
)

359 
	`tchash_»hash
(
ht
);

361  
»t
;

362 
	}
}

366 
	$tchash_d–‘e
(
tchash_bË_t
 *
ht
, *
key
, 
size_t
 
ks
, *
r
)

368 
hv
;

369 
hash_’Œy
 *
hr
 = 
NULL
, *
hp
 = NULL;

370 **
»t
 = 
r
;

372 if(
ks
 =ğ(
size_t
) -1)

373 
ks
 = 
	`¡¾’
(
key
) + 1;

375 
	`lock_hash
(
ht
);

376 
hv
 = 
	`hash_v®ue
(
ht
, 
key
, 
ks
, ht->
size
);

378 
hr
 = 
ht
->
buck‘s
[
hv
]; hr; h¸ğhr->
Ãxt
){

379 if(!
	`hash_cmp
(
key
, 
ks
, 
hr
))

381 
hp
 = 
hr
;

384 if(
hr
){

385 if(
»t
)

386 *
»t
 = 
hr
->
d©a
;

387 if(
hp
)

388 
hp
->
Ãxt
 = 
hr
->next;

390 
ht
->
buck‘s
[
hv
] = 
hr
->
Ãxt
;

391 
ht
->
’Œ›s
--;

392 if(!(
ht
->
æags
 & 
TCHASH_NOCOPY
))

393 
	`ä“
(
hr
->
key
);

394 
	`tcmempoŞ_ä“
(
hr
);

397 
	`uÆock_hash
(
ht
);

398 if(!
hr
 && !(
ht
->
æags
 & 
TCHASH_FROZEN
)){

399 if((è
ht
->
’Œ›s
 / ht->
size
 < ht->
low_m¬k
)

400 
	`tchash_»hash
(
ht
);

402  !
hr
;

403 
	}
}

406 
	$tchash_de¡roy
(
tchash_bË_t
 *
ht
, 
tcä“_â
 
hf
)

408 
size_t
 
i
;

409 
i
 = 0; i < 
ht
->
size
; i++){

410 if(
ht
->
buck‘s
[
i
] !ğ
NULL
){

411 
hash_’Œy
 *
he
 = 
ht
->
buck‘s
[
i
];

412 
he
){

413 
hash_’Œy
 *
hn
 = 
he
->
Ãxt
;

414 if(
hf
)

415 
	`hf
(
he
->
d©a
);

416 if(!(
ht
->
æags
 & 
TCHASH_NOCOPY
))

417 
	`ä“
(
he
->
key
);

418 
	`tcmempoŞ_ä“
(
he
);

419 
he
 = 
hn
;

424 
	`ä“
(
ht
->
buck‘s
);

425 
	`±h»ad_mu‹x_de¡roy
(&
ht
->
lock
);

426 
	`tcä“
(
ht
->
mp
);

427 
	`ä“
(
ht
);

430 
	}
}

433 
	$tchash_»hash
(
tchash_bË_t
 *
ht
)

435 
hash_’Œy
 **
nb
 = 
NULL
;

436 
size_t
 
ns
, 
i
;

438 
	`lock_hash
(
ht
);

440 
ns
 = 
	`hash_size
(
ht
->
’Œ›s
 * 2 / (ht->
high_m¬k
 + ht->
low_m¬k
));

441 if(
ns
 =ğ
ht
->
size
)

442 
’d
;

443 
nb
 = 
	`ÿÎoc
(
ns
, (*nb));

445 
i
 = 0; i < 
ht
->
size
; i++){

446 
hash_’Œy
 *
he
 = 
ht
->
buck‘s
[
i
];

447 
he
){

448 
hash_’Œy
 *
hn
 = 
he
->
Ãxt
;

449 
hv
 = 
	`hash_v®ue
(
ht
, 
he
->
key
, he->
key_size
, 
ns
);

450 
he
->
Ãxt
 = 
nb
[
hv
];

451 
nb
[
hv
] = 
he
;

452 
he
 = 
hn
;

456 
ht
->
size
 = 
ns
;

457 
	`ä“
(
ht
->
buck‘s
);

458 
ht
->
buck‘s
 = 
nb
;

460 
’d
:

461 
	`uÆock_hash
(
ht
);

463 
	}
}

466 
	$tchash_keys
(
tchash_bË_t
 *
ht
, *
n
, 
ç¡
)

468 **
keys
;

469 
size_t
 
i
, 
j
;

471 if(
ht
->
’Œ›s
 == 0){

472 *
n
 = 0;

473  
NULL
;

476 
	`lock_hash
(
ht
);

478 
keys
 = 
	`m®loc
(
ht
->
’Œ›s
 * (*keys));

480 
i
 = 0, 
j
 = 0; i < 
ht
->
size
; i++){

481 
hash_’Œy
 *
he
;

482 
he
 = 
ht
->
buck‘s
[
i
]; he; hğhe->
Ãxt
)

483 
keys
[
j
++] = 
ç¡
? 
he
->
key
: 
	`hash_kdup
(he->key, he->
key_size
);

486 *
n
 = 
ht
->
’Œ›s
;

488 
	`uÆock_hash
(
ht
);

490  
keys
;

491 
	}
}

494 
	$tchash_£‰h»shŞds
(
tchash_bË_t
 *
ht
, 
low
, 
high
)

496 
h
 = 
high
 < 0? 
ht
->
high_m¬k
: high;

497 
l
 = 
low
 < 0? 
ht
->
low_m¬k
:†ow;

499 if(
h
 < 
l
)

502 
ht
->
high_m¬k
 = 
h
;

503 
ht
->
low_m¬k
 = 
l
;

506 
	}
}

509 
	$tchash_g‘æags
(
tchash_bË_t
 *
ht
)

511  
ht
->
æags
;

512 
	}
}

515 
	$tchash_£tæags
(
tchash_bË_t
 *
ht
, 
æags
)

517 
	`lock_hash
(
ht
);

518 
ht
->
æags
 = flags;

519 
	`uÆock_hash
(
ht
);

520  
ht
->
æags
;

521 
	}
}

524 
	$tchash_£tæag
(
tchash_bË_t
 *
ht
, 
æag
)

526 
	`lock_hash
(
ht
);

527 
ht
->
æags
 |ğ
æag
;

528 
	`uÆock_hash
(
ht
);

529  
ht
->
æags
;

530 
	}
}

533 
	$tchash_ş—ræag
(
tchash_bË_t
 *
ht
, 
æag
)

535 
	`lock_hash
(
ht
);

536 
ht
->
æags
 &ğ~
æag
;

537 
	`uÆock_hash
(
ht
);

538  
ht
->
æags
;

539 
	}
}

	@get_interface3/libtc/src/list.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<±h»ad.h
>

28 
	~"tşi¡.h
"

30 
	stşi¡_™em
 {

31 *
	md©a
;

32 
tşi¡_™em_t
 *
	mÃxt
;

33 
tşi¡_™em_t
 *
	m´ev
;

34 
	mrc
, 
	mic
;

35 
tcä“_â
 
	mä“
;

36 
	md–‘ed
;

39 
	stşi¡
 {

40 
tşi¡_™em_t
 *
	m¡¬t
;

41 
tşi¡_™em_t
 *
	m’d
;

42 
	m™ems
, 
	md–‘ed
;

43 
	mlockšg
;

44 
±h»ad_mu‹x_t
 
	mlock
;

47 
tşi¡_t
 *

48 
	$tşi¡_Ãw
(
lockšg
)

50 
tşi¡_t
 *
l
 = 
	`ÿÎoc
(1, (*l));

51 
l
->
lockšg
 =†ocking;

52 if(
lockšg
 > 
TC_LOCK_NONE
)

53 
	`±h»ad_mu‹x_š™
(&
l
->
lock
, 
NULL
);

54  
l
;

55 
	}
}

58 
	$tşi¡_ä“
(
tşi¡_t
 *
l¡
)

60 if(
l¡
->
¡¬t
 !ğ
NULL
)

63 if(
l¡
->
lockšg
 > 
TC_LOCK_NONE
)

64 
	`±h»ad_mu‹x_de¡roy
(&
l¡
->
lock
);

66 
	`ä“
(
l¡
);

68 
	}
}

71 
	$li¡_uÆšk
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
)

73 if(
l
->
´ev
)

74 
l
->
´ev
->
Ãxt
 =†->next;

75 if(
l
->
Ãxt
)

76 
l
->
Ãxt
->
´ev
 =†->prev;

77 if(
l
 =ğ
l¡
->
¡¬t
)

78 
l¡
->
¡¬t
 = 
l
->
Ãxt
;

79 if(
l
 =ğ
l¡
->
’d
)

80 
l¡
->
’d
 = 
l
->
´ev
;

82 if(
l
->
ä“
)

83 
l
->
	`ä“
Ö->
d©a
);

85 
l¡
->
™ems
--;

86 if(
l
->
d–‘ed
)

87 
l¡
->
d–‘ed
--;

88 
	`ä“
(
l
);

89 
	}
}

91 
šlše
 

92 
	$li¡_»f
(
tşi¡_™em_t
 *
l
)

94 
l
->
rc
++;

95 
	}
}

97 
šlše
 

98 
	$li¡_d”ef
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
)

100 if(--
l
->
rc
 <ğ0 &&†->
ic
 <= 0)

101 
	`li¡_uÆšk
(
l¡
, 
l
);

102 
	}
}

104 
šlše
 

105 
	$lock_li¡
(
tşi¡_t
 *
l¡
)

107 if(
l¡
->
lockšg
 > 
TC_LOCK_NONE
)

108 
	`±h»ad_mu‹x_lock
(&
l¡
->
lock
);

110 
	}
}

113 
šlše
 

114 
	$uÆock_li¡
(
tşi¡_t
 *
l¡
)

116 if(
l¡
->
lockšg
 > 
TC_LOCK_NONE
)

117 
	`±h»ad_mu‹x_uÆock
(&
l¡
->
lock
);

119 
	}
}

122 
	$tşi¡_uÆock
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
)

124 
	`lock_li¡
(
l¡
);

125 
l
->
ic
--;

126 
	`li¡_d”ef
(
l¡
, 
l
);

127 
	`uÆock_li¡
(
l¡
);

129 
	}
}

132 
	$tşi¡_»move
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
l
, 
tcä“_â
 
ä
)

134 
	`lock_li¡
(
l¡
);

135 
l
->
d–‘ed
 = 1;

136 
l
->
ä“
 = 
ä
;

137 
l¡
->
d–‘ed
++;

138 
	`li¡_d”ef
(
l¡
, 
l
);

139 
	`uÆock_li¡
(
l¡
);

140 
	}
}

143 
	$tşi¡_de¡roy
(
tşi¡_t
 *
l¡
, 
tcä“_â
 
lä“
)

145 
	`lock_li¡
(
l¡
);

146 
l¡
->
¡¬t
){

147 
l¡
->
¡¬t
->
ä“
 = 
lä“
;

148 
	`li¡_uÆšk
(
l¡
,†¡->
¡¬t
);

150 
	`uÆock_li¡
(
l¡
);

151 
	`tşi¡_ä“
(
l¡
);

153 
	}
}

155 
tşi¡_™em_t
 *

156 
	$Ãw_™em
(*
p
)

158 
tşi¡_™em_t
 *
l
 = 
	`m®loc
((tclist_item_t));

159 
l
->
d©a
 = 
p
;

160 
l
->
rc
 = 1;

161 
l
->
ic
 = 0;

162 
l
->
ä“
 = 
NULL
;

163 
l
->
d–‘ed
 = 0;

164  
l
;

165 
	}
}

168 
	$tşi¡_push
(
tşi¡_t
 *
l¡
, *
p
)

170 
tşi¡_™em_t
 *
l
 = 
	`Ãw_™em
(
p
);

172 
	`lock_li¡
(
l¡
);

173 if(
l¡
->
¡¬t
 =ğ
NULL
){

174 
l¡
->
¡¬t
 = 
l
;

175 
l¡
->
¡¬t
->
Ãxt
 = 
NULL
;

176 
l¡
->
¡¬t
->
´ev
 = 
NULL
;

177 
l¡
->
’d
 =†¡->
¡¬t
;

179 
l¡
->
’d
->
Ãxt
 = 
l
;

180 
l
->
´ev
 = 
l¡
->
’d
;

181 
l
->
Ãxt
 = 
NULL
;

182 
l¡
->
’d
 = 
l
;

184 
l¡
->
™ems
++;

185 
	`uÆock_li¡
(
l¡
);

187 
	}
}

190 
	$tşi¡_unshiá
(
tşi¡_t
 *
l¡
, *
p
)

192 
tşi¡_™em_t
 *
l
 = 
	`Ãw_™em
(
p
);

194 
	`lock_li¡
(
l¡
);

195 if(
l¡
->
¡¬t
 =ğ
NULL
){

196 
l¡
->
¡¬t
 = 
l
;

197 
l¡
->
¡¬t
->
Ãxt
 = 
NULL
;

198 
l¡
->
¡¬t
->
´ev
 = 
NULL
;

199 
l¡
->
’d
 =†¡->
¡¬t
;

201 
l¡
->
¡¬t
->
´ev
 = 
l
;

202 
l
->
Ãxt
 = 
l¡
->
¡¬t
;

203 
l
->
´ev
 = 
NULL
;

204 
l¡
->
¡¬t
 = 
l
;

206 
l¡
->
™ems
++;

207 
	`uÆock_li¡
(
l¡
);

209 
	}
}

212 
	$tşi¡_shiá
(
tşi¡_t
 *
l¡
)

214 
tşi¡_™em_t
 *
li
 = 
NULL
;

215 *
d©a
 = 
NULL
;

217 
	`tşi¡_Ãxt
(
l¡
, &
li
);

218 if(
li
){

219 
d©a
 = 
li
->data;

220 
	`tşi¡_»move
(
l¡
, 
li
, 
NULL
);

221 
	`tşi¡_uÆock
(
l¡
, 
li
);

224  
d©a
;

225 
	}
}

228 
	$tşi¡_pİ
(
tşi¡_t
 *
l¡
)

230 
tşi¡_™em_t
 *
li
 = 
NULL
;

231 *
d©a
 = 
NULL
;

233 
	`tşi¡_´ev
(
l¡
, &
li
);

234 if(
li
){

235 
d©a
 = 
li
->data;

236 
	`tşi¡_»move
(
l¡
, 
li
, 
NULL
);

237 
	`tşi¡_uÆock
(
l¡
, 
li
);

240  
d©a
;

241 
	}
}

243 
tşi¡_™em_t
 *

244 
	$li¡_fšd_™em
(
tşi¡_t
 *
l¡
, *
p
, 
tccom·»_â
 
cmp
)

246 
tşi¡_™em_t
 *
li
 = 
NULL
;

248 
	`tşi¡_Ãxt
(
l¡
, &
li
);†˜!ğ
NULL
;clist_next(lst, &li)){

249 if(
cmp
? 
	`cmp
(
p
, 
li
->
d©a
) == 0:… ==†i->data){

253  
li
;

254 
	}
}

257 
	$tşi¡_fšd
(
tşi¡_t
 *
l¡
, *
p
, *
»t
, 
tccom·»_â
 
cmp
)

259 
tşi¡_™em_t
 *
l
;

260 **
r
 = 
»t
;

262 if((
l
 = 
	`li¡_fšd_™em
(
l¡
, 
p
, 
cmp
)è!ğ
NULL
){

263 if(
r
 !ğ
NULL
)

264 *
r
 = 
l
->
d©a
;

265 
	`tşi¡_uÆock
(
l¡
, 
l
);

270 
	}
}

273 
	$tşi¡_£¬ch
(
tşi¡_t
 *
l¡
, *
p
, *
»t
, 
tccom·»_â
 
cmp
)

275 **
r
 = 
»t
;

276 
tşi¡_™em_t
 *
l
;

278 
l
 = 
	`li¡_fšd_™em
(
l¡
, 
p
, 
cmp
);

279 if(
l
 !ğ
NULL
){

280 if(
r
 !ğ
NULL
)

281 *
r
 = 
l
->
d©a
;

282 
	`tşi¡_uÆock
(
l¡
, 
l
);

285 
	`tşi¡_push
(
l¡
, 
p
);

286 if(
r
 !ğ
NULL
)

287 *
r
 = 
p
;

291 
	}
}

294 
	$tşi¡_d–‘e
(
tşi¡_t
 *
l¡
, *
p
, 
tccom·»_â
 
cmp
, 
tcä“_â
 
ä
)

296 
tşi¡_™em_t
 *
li
 = 
NULL
;

298 if((
li
 = 
	`li¡_fšd_™em
(
l¡
, 
p
, 
cmp
)è!ğ
NULL
){

299 
	`tşi¡_»move
(
l¡
, 
li
, 
ä
);

300 
	`tşi¡_uÆock
(
l¡
, 
li
);

305 
	}
}

308 
	$tşi¡_d–‘e_m©ched
(
tşi¡_t
 *
l¡
, *
p
, 
tccom·»_â
 
cmp
, 
tcä“_â
 
ä
)

310 
n
 = 0;

311 
tşi¡_™em_t
 *
li
 = 
NULL
;

313 
	`tşi¡_Ãxt
(
l¡
, &
li
);†˜!ğ
NULL
;clist_next(lst, &li)){

314 if(
	`cmp
(
p
, 
li
->
d©a
) == 0){

315 
	`tşi¡_»move
(
l¡
, 
li
, 
ä
);

316 
n
++;

319  
n
;

320 
	}
}

323 
	$tşi¡_Ãxt
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
)

325 *
r
 = 
NULL
;

327 if(
l¡
->
lockšg
 < 
TC_LOCK_STRICT
 || *
l
 =ğ
NULL
)

328 
	`lock_li¡
(
l¡
);

331 if(*
l
 =ğ
NULL
){

332 if(
l¡
->
¡¬t
 !ğ
NULL
)

333 
	`li¡_»f
(
l¡
->
¡¬t
);

334 *
l
 = 
l¡
->
¡¬t
;

336 
tşi¡_™em_t
 *
Ê
;

337 if((*
l
)->
Ãxt
 !ğ
NULL
){

338 
	`li¡_»f
((*
l
)->
Ãxt
);

340 
Ê
 = (*
l
)->
Ãxt
;

341 (*
l
)->
ic
--;

342 
	`li¡_d”ef
(
l¡
, *
l
);

343 *
l
 = 
Ê
;

346 if(*
l
 !ğ
NULL
){

347 
r
 = (*
l
)->
d©a
;

348 (*
l
)->
ic
++;

350 } *
l
 && (*l)->
d–‘ed
);

352 if(
l¡
->
lockšg
 < 
TC_LOCK_STRICT
 || *
l
 =ğ
NULL
)

353 
	`uÆock_li¡
(
l¡
);

354  *
l
? 
r
: 
NULL
;

355 
	}
}

358 
	$tşi¡_Ãxt_m©ched
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
, *
key
,

359 
tccom·»_â
 
cmp
)

361 *
r
;

363 
r
 = 
	`tşi¡_Ãxt
(
l¡
, 
l
);

364 } *
l
 && 
	`cmp
(
key
, 
r
));

365  
r
;

366 
	}
}

369 
	$tşi¡_´ev
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
)

371 *
r
 = 
NULL
;

373 if(
l¡
->
lockšg
 < 
TC_LOCK_STRICT
 || *
l
 =ğ
NULL
)

374 
	`lock_li¡
(
l¡
);

377 if(*
l
 =ğ
NULL
){

378 if(
l¡
->
’d
 !ğ
NULL
)

379 
	`li¡_»f
(
l¡
->
’d
);

380 *
l
 = 
l¡
->
’d
;

382 
tşi¡_™em_t
 *
Ê
;

383 if((*
l
)->
´ev
 !ğ
NULL
){

384 
	`li¡_»f
((*
l
)->
´ev
);

386 
Ê
 = (*
l
)->
´ev
;

387 (*
l
)->
ic
--;

388 
	`li¡_d”ef
(
l¡
, *
l
);

389 *
l
 = 
Ê
;

392 if(*
l
 !ğ
NULL
){

393 
r
 = (*
l
)->
d©a
;

394 (*
l
)->
ic
++;

396 } *
l
 && (*l)->
d–‘ed
);

398 if(
l¡
->
lockšg
 < 
TC_LOCK_STRICT
 || *
l
 =ğ
NULL
)

399 
	`uÆock_li¡
(
l¡
);

400  *
l
? 
r
: 
NULL
;

401 
	}
}

404 
	$tşi¡_´ev_m©ched
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 **
l
, *
key
,

405 
tccom·»_â
 
cmp
)

407 *
r
;

409 
r
 = 
	`tşi¡_´ev
(
l¡
, 
l
);

410 } *
l
 && 
	`cmp
(
key
, 
r
));

411  
r
;

412 
	}
}

415 
	$tşi¡_™ems
(
tşi¡_t
 *
l¡
)

417  
l¡
->
™ems
 -†¡->
d–‘ed
;

418 
	}
}

421 
	$tşi¡_isfœ¡
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
li
)

423  
li
 =ğ
l¡
->
¡¬t
;

424 
	}
}

428 
	$tşi¡_i¦a¡
(
tşi¡_t
 *
l¡
, 
tşi¡_™em_t
 *
li
)

430  
li
 =ğ
l¡
->
’d
;

431 
	}
}

434 
	$tşi¡_h—d
(
tşi¡_t
 *
l¡
)

436 *
h
;

437 
	`lock_li¡
(
l¡
);

438 
h
 = 
l¡
->
¡¬t
->
d©a
;

439 
	`uÆock_li¡
(
l¡
);

440  
h
;

441 
	}
}

444 
	$tşi¡_
(
tşi¡_t
 *
l¡
)

446 *
t
;

447 
	`lock_li¡
(
l¡
);

448 
t
 = 
l¡
->
’d
->
d©a
;

449 
	`uÆock_li¡
(
l¡
);

450  
t
;

451 
	}
}

	@get_interface3/libtc/src/math.c

25 
	~<tcm©h.h
>

28 
	$tüeduû
(
tcäaùiÚ_t
 *
f
)

30 
n
 = 
f
->
num
;

31 
d
 = 
f
->
d’
;

33 
n
){

34 
t
 = 
n
;

35 
n
 = 
d
 %‚;

36 
d
 = 
t
;

39 
f
->
num
 /ğ
d
;

40 
f
->
d’
 /ğ
d
;

41 
	}
}

	@get_interface3/libtc/src/mkpath.c

25 
	~<¡dlib.h
>

26 
	~<¡ršg.h
>

27 
	~<”ºo.h
>

28 
	~<sys/¡©.h
>

31 
	$tcmk·th
(*
·th
, 
mode
)

33 *
p
 = 
	`¡rdup
(
·th
);

34 *
e
 = 
	`¡¼chr
(
p
, '/');

35 
¡©
 
¡
;

36 
»t
 = -1;

38 if(
e
 > 
p
){

39 *
e
 = 0;

40 if(
	`tcmk·th
(
p
, 
mode
))

41 
’d
;

44 if(
	`¡©
(
·th
, &
¡
)){

45 if(
”ºo
 !ğ
ENOENT
)

46 
’d
;

47 if(
	`mkdœ
(
·th
, 
mode
))

48 
’d
;

49 } if(!
	`S_ISDIR
(
¡
.
¡_mode
)){

50 
’d
;

53 
»t
 = 0;

54 
’d
:

55 
	`ä“
(
p
);

56  
»t
;

57 
	}
}

	@get_interface3/libtc/src/mpool.c

25 
	~<¡dlib.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

28 
	~<tùy³s.h
>

29 
	~<±h»ad.h
>

30 
	~<sys/mmª.h
>

31 
	~<¡ddef.h
>

32 
	~<tÿÎoc.h
>

33 
	~<tcmempoŞ.h
>

34 
	~<tc.h
>

36 #iâdeà
MAP_ANONYMOUS


37 
	#MAP_ANONYMOUS
 
MAP_ANON


	)

40 
	stcmempoŞ_·ge
 {

41 
tcmempoŞ_t
 *
	mpoŞ
;

42 
size_t
 
	mu£d
, 
	mšu£
;

43 *
	mä“
;

44 
tcmempoŞ_·ge
 *
	mÃxt
, *
	m´ev
;

46 
	ml
;

47 
	md
;

48 *
	mp
;

49 } 
	md©a
[1];

50 } 
	ttcmempoŞ_·ge_t
;

52 
	stcmempoŞ
 {

53 
size_t
 
	msize
;

54 
size_t
 
	mıp
;

55 
tcmempoŞ_·ge_t
 *
	m·ges
;

56 
	mlockšg
;

57 
±h»ad_mu‹x_t
 
	mlock
;

60 
	g·gesize
;

62 
	#®ign
(
s
,
a
è(((s)+×)-1è& ~(×)-1))

	)

64 
šlše
 

65 
	$mp_lock
(
tcmempoŞ_t
 *
mp
)

67 if(
mp
->
lockšg
)

68 
	`±h»ad_mu‹x_lock
(&
mp
->
lock
);

69 
	}
}

71 
šlše
 

72 
	$mp_uÆock
(
tcmempoŞ_t
 *
mp
)

74 if(
mp
->
lockšg
)

75 
	`±h»ad_mu‹x_uÆock
(&
mp
->
lock
);

76 
	}
}

79 
	$mp_ä“
(*
p
)

81 
tcmempoŞ_t
 *
mp
 = 
p
;

82 
	`±h»ad_mu‹x_de¡roy
(&
mp
->
lock
);

83 
	}
}

85 
tcmempoŞ_t
 *

86 
	$tcmempoŞ_Ãw
(
size_t
 
size
, 
lock
)

88 
tcmempoŞ_t
 *
mp
;

90 if(!
·gesize
)

91 
·gesize
 = 
	`syscÚf
(
_SC_PAGESIZE
);

93 
size
 = 
	`®ign
(size, (*));

94 if(
size
 > 
·gesize
 - 
	`off£tof
(
tcmempoŞ_·ge_t
, 
d©a
))

95  
NULL
;

97 
mp
 = 
	`tÿÎocdz
((*mp), 
NULL
, 
mp_ä“
);

98 
mp
->
size
 = size;

99 
mp
->
ıp
 = (
·gesize
 - 
	`off£tof
(
tcmempoŞ_·ge_t
, 
d©a
)è/ 
size
;

100 
mp
->
lockšg
 = 
lock
;

101 
	`±h»ad_mu‹x_š™
(&
mp
->
lock
, 
NULL
);

103  
mp
;

104 
	}
}

107 
	$tcmempoŞ_g‘
(
tcmempoŞ_t
 *
mp
)

109 
tcmempoŞ_·ge_t
 *
mµ
;

110 *
chunk
;

112 
	`mp_lock
(
mp
);

114 
mµ
 = 
mp
->
·ges
;

116 if(!
mµ
){

117 
mµ
 = 
	`mm­
(
NULL
, 
·gesize
, 
PROT_READ
 | 
PROT_WRITE
,

118 
MAP_ANONYMOUS
 | 
MAP_PRIVATE
, -1, 0);

119 
mµ
->
poŞ
 = 
mp
;

120 
mp
->
·ges
 = 
mµ
;

123 if(
mµ
->
ä“
){

124 
chunk
 = 
mµ
->
ä“
;

125 
mµ
->
ä“
 = *(**è
chunk
;

127 
chunk
 = (*è
mµ
->
d©a
 + mµ->
u£d
 * 
mp
->
size
;

128 
mµ
->
u£d
++;

131 if(++
mµ
->
šu£
 =ğ
mp
->
ıp
){

132 
mp
->
·ges
 = 
mµ
->
Ãxt
;

133 
mµ
->
Ãxt
 = 
NULL
;

134 
mµ
->
´ev
 = 
NULL
;

137 
	`mp_uÆock
(
mp
);

139  
chunk
;

140 
	}
}

143 
	$tcmempoŞ_ä“
(*
p
)

145 
tcmempoŞ_·ge_t
 *
mµ
 = (*è((
±rdiff_t
è
p
 & ~(
·gesize
 - 1));

146 
tcmempoŞ_t
 *
mp
 = 
mµ
->
poŞ
;

148 
	`mp_lock
(
mp
);

150 if(!--
mµ
->
šu£
){

151 if(
mp
->
·ges
 =ğ
mµ
)

152 
mp
->
·ges
 = 
mµ
->
Ãxt
;

153 if(
mµ
->
Ãxt
)

154 
mµ
->
Ãxt
->
´ev
 = mpp->prev;

155 if(
mµ
->
´ev
)

156 
mµ
->
´ev
->
Ãxt
 = mpp->next;

157 
	`munm­
(
mµ
, 
·gesize
);

159 *(**è
p
 = 
mµ
->
ä“
;

160 
mµ
->
ä“
 = 
p
;

161 if(!
mµ
->
Ãxt
 && !mµ->
´ev
 && 
mp
->
·ges
 != mpp){

162 if(
mp
->
·ges
)

163 
mp
->
·ges
->
´ev
 = 
mµ
;

164 
mµ
->
Ãxt
 = 
mp
->
·ges
;

165 
mp
->
·ges
 = 
mµ
;

169 
	`mp_uÆock
(
mp
);

170 
	}
}

	@get_interface3/libtc/src/pathfind.c

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<tc¡ršg.h
>

28 
	~<uni¡d.h
>

31 
	$tı©h_fšd
(*
Çme
, *
·th
, 
how
)

33 *
dp
, *
p
, *
pc
, *
â
;

35 if(
Çme
[0] == '/')

36  
	`¡rdup
(
Çme
);

38 
p
 = 
dp
 = 
	`¡rdup
(
·th
);

39 
â
 = 
	`m®loc
(
	`¡¾’
(
·th
è+ sŒËn(
Çme
) + 2);

40 (
pc
 = 
	`¡r£p
(&
p
, ":"))){

41 
	`¥rštf
(
â
, "%s/%s", 
pc
, 
Çme
);

42 if(!
	`acûss
(
â
, 
how
))

46 if(!
pc
){

47 
	`ä“
(
â
);

48 
â
 = 
NULL
;

51 
	`ä“
(
dp
);

52  
â
;

53 
	}
}

	@get_interface3/libtc/src/prioq.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<¡ršg.h
>

28 
	~<tùy³s.h
>

29 
	~<±h»ad.h
>

30 
	~<tırioq.h
>

32 
	stırioq
 {

33 **
	mqt
;

34 
	msize
;

35 
	mcouÁ
;

36 
tccom·»_â
 
	mcmp
;

37 
	mlockšg
;

38 
±h»ad_mu‹x_t
 
	mlock
;

41 
šlše
 

42 
	$tı_lock
(
tırioq_t
 *
pq
){

43 if(
pq
->
lockšg
){

44 
	`±h»ad_mu‹x_lock
(&
pq
->
lock
);

46 
	}
}

48 
šlše
 

49 
	$tı_uÆock
(
tırioq_t
 *
pq
){

50 if(
pq
->
lockšg
){

51 
	`±h»ad_mu‹x_uÆock
(&
pq
->
lock
);

53 
	}
}

55 
tırioq_t
 *

56 
	$tırioq_Ãw
(
size
, 
lock
, 
tccom·»_â
 
cmp
)

58 
tırioq_t
 *
pq
 = 
	`m®loc
((*pq));

60 
pq
->
qt
 = 
	`m®loc
(
size
 * (*pq->qt));

61 
pq
->
size
 = size;

62 
pq
->
couÁ
 = 1;

63 
pq
->
cmp
 = cmp;

64 
pq
->
lockšg
 = 
lock
;

65 if(
lock
)

66 
	`±h»ad_mu‹x_š™
(&
pq
->
lock
, 
NULL
);

68  
pq
;

69 
	}
}

72 
	$tırioq_add
(
tırioq_t
 *
pq
, *
d©a
)

74 
i
;

76 
	`tı_lock
(
pq
);

78 if(
pq
->
couÁ
 =ğpq->
size
){

79 
pq
->
qt
 = 
	`»®loc
Õq->qt, (pq->
size
 *= 2) * (*pq->qt));

82 
i
 = 
pq
->
couÁ
;

83 
pq
->
qt
[
i
] = 
d©a
;

85 
i
 > 1 && 
pq
->
	`cmp
Õq->
qt
[i/2],…q->qt[i]) > 0){

86 *
tmp
 = 
pq
->
qt
[
i
];

87 
pq
->
qt
[
i
] =…q->qt[i/2];

88 
pq
->
qt
[
i
/2] = 
tmp
;

89 
i
 /= 2;

92 
pq
->
couÁ
++;

94 
	`tı_uÆock
(
pq
);

96 
	}
}

99 
	$tırioq_g‘
(
tırioq_t
 *
pq
, **
»t
)

101 
¹
 = -1;

103 
	`tı_lock
(
pq
);

105 if(
pq
->
couÁ
 > 1){

106 
i
;

107 *
r
;

109 
r
 = 
pq
->
qt
[1];

110 
pq
->
qt
[1] =…q->qt[pq->
couÁ
-1];

111 
pq
->
couÁ
--;

113 
i
 = 1;

114 (2*
i
 < 
pq
->
couÁ
 &&…q->
	`cmp
Õq->
qt
[i],…q->qt[2*i]) > 0) ||

115 (2*
i
 < 
pq
->
couÁ
-1 &&…q->
	`cmp
Õq->
qt
[i],…q->qt[2*i+1]) > 0)){

116 *
tmp
 = 
pq
->
qt
[
i
];

117 
i
 = (2*˜< 
pq
->
couÁ
-1 &&…q->
	`cmp
Õq->
qt
[2*i],…q->qt[2*i+1]) > 0)?

118 2*
i
+1: 2*i;

119 
pq
->
qt
[
i
/2] =…q->qt[i];

120 
pq
->
qt
[
i
] = 
tmp
;

123 *
»t
 = 
r
;

124 
¹
 = 0;

127 
	`tı_uÆock
(
pq
);

128  
¹
;

129 
	}
}

132 
	$tırioq_™ems
(
tırioq_t
 *
pq
)

134  
pq
->
couÁ
 - 1;

135 
	}
}

138 
	$rioq_ä“
(
tırioq_t
 *
pq
)

140 
	`ä“
(
pq
->
qt
);

141 
	`±h»ad_mu‹x_de¡roy
(&
pq
->
lock
);

142 
	`ä“
(
pq
);

143 
	}
}

	@get_interface3/libtc/src/regex.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<tc¡ršg.h
>

28 
	~<tùy³s.h
>

29 
	~<»gex.h
>

31 
	s»gsub
 {

32 
»gex_t
 
	mrx
;

33 
»gm©ch_t
 *
	mm
;

34 cÚ¡ *
	ms
;

35 } 
	t»gsub_t
;

38 
	$rs_lookup
(*
n
, *
d
)

40 
»gsub_t
 *
rs
 = 
d
;

41 *
t
;

42 
ml
;

43 
u_št
 
m
 = 
	`¡¹Ş
(
n
, &
t
, 0);

45 if(*
t
)

46  
NULL
;

47 if(
m
 > 
rs
->
rx
.
»_nsub
)

48  
NULL
;

49 if(
rs
->
m
[m].
rm_so
 < 0)

50  
	`¡rdup
("");

52 
ml
 = 
rs
->
m
[m].
rm_eo
 -„s->m[m].
rm_so
;

53 
t
 = 
	`m®loc
(
ml
 + 1);

54 
	`¡ºıy
(
t
, 
rs
->
s
 +„s->
m
[m].
rm_so
, 
ml
);

55 
t
[
ml
] = 0;

57  
t
;

58 
	}
}

61 
	$tüegsub
(cÚ¡ *
¡r
, cÚ¡ *
·t
, cÚ¡ *
sub
, 
æags
)

63 
»gsub_t
 
rs
;

64 cÚ¡ *
s
;

65 *
ss
, *
p
;

66 
r
, 
l
;

68 (è
æags
;

70 if((
r
 = 
	`»gcomp
(&
rs
.
rx
, 
·t
, 
REG_EXTENDED
))){

71 
buf
[256];

72 
	`»g”rÜ
(
r
, &
rs
.
rx
, 
buf
, (buf));

73 
	`årštf
(
¡d”r
, "tüegsub: %s\n", 
buf
);

74  
NULL
;

77 
rs
.
m
 = 
	`ÿÎoc
Ôs.
rx
.
»_nsub
 + 1, (*rs.m));

78 
l
 = 
	`¡¾’
(
¡r
);

79 
ss
 = 
	`m®loc
(
l
 + 1);

80 
p
 = 
ss
;

81 
s
 = 
¡r
;

83 *
s
){

84 
ml
;

85 if(
	`»gexec
(&
rs
.
rx
, 
s
,„s.rx.
»_nsub
 + 1,„s.
m
, 0))

88 
	`¡ºıy
(
p
, 
s
, 
rs
.
m
[0].
rm_so
);

89 
p
 +ğ
rs
.
m
[0].
rm_so
;

90 
ml
 = 
rs
.
m
[0].
rm_eo
 -„s.m[0].
rm_so
;

91 if(
ml
 > 0){

92 *
ms
 = 
	`m®loc
(
ml
 + 1);

93 *
½
;

94 
¦
, 
o
;

96 
rs
.
s
 = s;

97 
½
 = 
	`tc¡»xp
(
sub
, "{", "}", 0, 
rs_lookup
, &
rs
,

98 
TCSTREXP_KEEPUNDEF
 | 
TCSTREXP_FREE
);

99 
¦
 = 
	`¡¾’
(
½
);

100 
o
 = 
p
 - 
ss
;

101 
ss
 = 
	`»®loc
(ss, 
l
 +ğ
¦
);

102 
p
 = 
ss
 + 
o
;

104 
	`¡rıy
(
p
, 
½
);

105 
p
 +ğ
¦
;

106 
	`ä“
(
½
);

107 
	`ä“
(
ms
);

109 
s
 +ğ
rs
.
m
[0].
rm_eo
;

112 
	`¡rıy
(
p
, 
s
);

113 
	`ä“
(
rs
.
m
);

114 
	`»gä“
(&
rs
.
rx
);

115  
ss
;

116 
	}
}

	@get_interface3/libtc/src/snprintf.c

1 
	~"cÚfig.h
"

3 #iâdeà
HAVE_SNPRINTF


4 
	~<¡dlib.h
>

5 
	~<uni¡d.h
>

6 
	~<¡d¬g.h
>

7 
	~<”ºo.h
>

8 
	~<¡ršg.h
>

9 
	~<ùy³.h
>

21 
	#VA_LOCAL_DECL
 
va_li¡
 
­


	)

22 
	#VA_START
(
f
è
	`va_¡¬t
(
­
, f)

	)

23 
	#VA_SHIFT
(
v
,
t
è;

	)

24 
	#VA_END
 
	`va_’d
(
­
)

	)

30 
dİr
(*
bufãr
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
);

31 
fmt¡r
(*
v®ue
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

32 
fmŠum
(
v®ue
, 
ba£
, 
dosign
,

33 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

34 
fmtdoubË
(
fmt
, 
v®ue
,

35 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

36 
do¡r
(*);

37 *
	gouut
;

38 
dİr_outch
(
c
);

39 *
	g’d
;

40 
	gvisibË_cÚŒŞ
 = 1;

43 
	$my_v¢´štf
(*
¡r
, 
size_t
 
couÁ
, cÚ¡ *
fmt
, 
va_li¡
 
¬gs
)

45 
¡r
[0] = 0;

46 
’d
 = 
¡r
 + 
couÁ
 - 1;

47 
	`dİr
(
¡r
, 
fmt
, 
¬gs
);

48 ià(
couÁ
 > 0)

50 
’d
[0] = 0;

52  (
	`¡¾’
(
¡r
));

53 
	}
}

55 #ifdeà
HAVE_STDARG_H


57 
	$¢´štf
(*
¡r
, 
size_t
 
couÁ
, cÚ¡ *
fmt
,...)

60 
	$¢´štf
(
va_®i¡
)

61 
va_dş


65 #iâdeà
HAVE_STDARG_H


66 *
¡r
;

67 
size_t
 
couÁ
;

68 *
fmt
;

71 
VA_LOCAL_DECL
;

73 
	`VA_START
(
fmt
);

74 
	`VA_SHIFT
(
¡r
, *);

76 
	`VA_SHIFT
(
couÁ
, 
size_t
);

77 
	`VA_SHIFT
(
fmt
, *);

79 ()
	`my_v¢´štf
(
¡r
, 
couÁ
, 
fmt
, 
­
);

80 
VA_END
;

81  (
	`¡¾’
(
¡r
));

82 
	}
}

85 
	$dİr
(*
bufãr
, cÚ¡ *
fÜm©
, 
va_li¡
 
¬gs
)

87 
ch
;

88 
v®ue
;

89 
lÚgæag
 = 0;

90 *
¡rv®ue
;

91 
lju¡
;

92 
Ën
;

93 
z·d
;

94 
´ecisiÚ
;

95 
£t_´ecisiÚ
;

96 
dv®
;

98 
ouut
 = 
bufãr
;

99 (
ch
 = *
fÜm©
++))

101 
ch
)

104 
lju¡
 = 
Ën
 = 
z·d
 = 0;

105 
´ecisiÚ
 = -1;

106 
£t_´ecisiÚ
 = 0;

107 
Ãxtch
:

108 
ch
 = *
fÜm©
++;

109 
ch
)

112 
	`do¡r
("**end of format**");

115 
lju¡
 = 1;

116 
Ãxtch
;

118 
£t_´ecisiÚ
 = 1;

119 
´ecisiÚ
 = 0;

120 
Ãxtch
;

122 
Ën
 = 
	`va_¬g
(
¬gs
, );

124 
Ãxtch
;

126 ià(
Ën
 =ğ0 && 
£t_´ecisiÚ
 == 0)

127 
z·d
 = '0';

137 ià(
£t_´ecisiÚ
)

139 
´ecisiÚ
 =…»cisiÚ * 10 + 
ch
 - '0';

143 
Ën
 =†’ * 10 + 
ch
 - '0';

145 
Ãxtch
;

147 
lÚgæag
 = 1;

148 
Ãxtch
;

152 ià(
lÚgæag
)

154 
v®ue
 = 
	`va_¬g
(
¬gs
, );

158 
v®ue
 = 
	`va_¬g
(
¬gs
, );

160 
	`fmŠum
(
v®ue
, 10, 0, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

165 ià(
lÚgæag
)

167 
v®ue
 = 
	`va_¬g
(
¬gs
, );

171 
v®ue
 = 
	`va_¬g
(
¬gs
, );

173 
	`fmŠum
(
v®ue
, 8, 0, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

178 ià(
lÚgæag
)

180 
v®ue
 = 
	`va_¬g
(
¬gs
, );

184 
v®ue
 = 
	`va_¬g
(
¬gs
, );

186 
	`fmŠum
(
v®ue
, 10, 1, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

189 ià(
lÚgæag
)

191 
v®ue
 = 
	`va_¬g
(
¬gs
, );

195 
v®ue
 = 
	`va_¬g
(
¬gs
, );

197 
	`fmŠum
(
v®ue
, 16, 0, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

200 ià(
lÚgæag
)

202 
v®ue
 = 
	`va_¬g
(
¬gs
, );

206 
v®ue
 = 
	`va_¬g
(
¬gs
, );

208 
	`fmŠum
(
v®ue
, -16, 0, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

211 
¡rv®ue
 = 
	`va_¬g
(
¬gs
, *);

213 
	`fmt¡r
(
¡rv®ue
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

216 
ch
 = 
	`va_¬g
(
¬gs
, );

219 
b
[2];

220 
vsb
 = 
visibË_cÚŒŞ
;

222 
b
[0] = 
ch
;

223 
b
[1] = 0;

224 
visibË_cÚŒŞ
 = 0;

225 
	`fmt¡r
(
b
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

226 
visibË_cÚŒŞ
 = 
vsb
;

231 
dv®
 = 
	`va_¬g
(
¬gs
, );

233 
	`fmtdoubË
(
ch
, 
dv®
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
);

236 
	`dİr_outch
(
ch
);

239 
	`do¡r
("???????");

241 
lÚgæag
 = 0;

244 
	`dİr_outch
(
ch
);

248 *
ouut
 = 0;

249 
	}
}

258 
	$fmt¡r
(*
v®ue
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
)

260 
·dËn
, 
¡¾’
, 
i
, 
c
;

262 
z·d
 = 0;

263 ià(
v®ue
 == 0)

265 
v®ue
 = "<NULL>";

267 ià(
´ecisiÚ
 > 0)

269 
¡¾’
 = 
´ecisiÚ
;

274 
¡¾’
 = 0; (
c
 = 
v®ue
[strlen]); ++strlen)

276 ià(
visibË_cÚŒŞ
 && 
	`isúŒl
(
c
è&& !
	`is¥aû
(c))

278 ++
¡¾’
;

282 
·dËn
 = 
Ën
 - 
¡¾’
;

283 ià(
·dËn
 < 0)

284 
·dËn
 = 0;

285 ià(
lju¡
)

286 
·dËn
 = -padlen;

287 
·dËn
 > 0)

289 
	`dİr_outch
(' ');

290 --
·dËn
;

293 
i
 = 0; (
c
 = 
v®ue
[i]); ++i)

295 ià(
visibË_cÚŒŞ
 && 
	`isúŒl
(
c
è&& !
	`is¥aû
(c))

297 
	`dİr_outch
('^');

298 
c
 = ('@' | (c & 0x1F));

300 
	`dİr_outch
(
c
);

302 
·dËn
 < 0)

304 
	`dİr_outch
(' ');

305 ++
·dËn
;

307 
	}
}

310 
	$fmŠum
(
v®ue
, 
ba£
, 
dosign
, 
lju¡
,

311 
Ën
, 
z·d
, 
´ecisiÚ
)

313 
signv®ue
 = 0;

314 
uv®ue
;

315 
cÚv”t
[20];

316 
¶aû
 = 0;

317 
·dËn
 = 0;

318 
ÿps
 = 0;

320 
´ecisiÚ
 = 0;

323 
uv®ue
 = 
v®ue
;

324 ià(
dosign
)

326 ià(
v®ue
 < 0)

328 
signv®ue
 = '-';

329 
uv®ue
 = -
v®ue
;

332 ià(
ba£
 < 0)

334 
ÿps
 = 1;

335 
ba£
 = -base;

339 
cÚv”t
[
¶aû
++] =

340 (
ÿps
 ? "0123456789ABCDEF" : "0123456789abcdef")

341 [
uv®ue
 % ()
ba£
];

342 
uv®ue
 = (uv®u/ ()
ba£
);

344 
uv®ue
);

345 
cÚv”t
[
¶aû
] = 0;

346 
·dËn
 = 
Ën
 - 
¶aû
;

347 ià(
·dËn
 < 0)

348 
·dËn
 = 0;

349 ià(
lju¡
)

350 
·dËn
 = -padlen;

353 ià(
z·d
 && 
·dËn
 > 0)

355 ià(
signv®ue
)

357 
	`dİr_outch
(
signv®ue
);

358 --
·dËn
;

359 
signv®ue
 = 0;

361 
·dËn
 > 0)

363 
	`dİr_outch
(
z·d
);

364 --
·dËn
;

367 
·dËn
 > 0)

369 
	`dİr_outch
(' ');

370 --
·dËn
;

372 ià(
signv®ue
)

373 
	`dİr_outch
(
signv®ue
);

374 
¶aû
 > 0)

375 
	`dİr_outch
(
cÚv”t
[--
¶aû
]);

376 
·dËn
 < 0)

378 
	`dİr_outch
(' ');

379 ++
·dËn
;

381 
	}
}

384 
	$fmtdoubË
(
fmt
, 
v®ue
, 
lju¡
, 
Ën
, 
z·d
, 
´ecisiÚ
)

386 
cÚv”t
[128];

387 
fmt¡r
[128];

388 
l
;

390 
z·d
 = 0;

391 ià(
Ën
 == 0)

392 
Ën
 = 10;

393 ià(
Ën
 > ()(
cÚv”t
) - 10)

395 
Ën
 = ()(
cÚv”t
) - 10;

397 ià(
´ecisiÚ
 > ()(
cÚv”t
) - 10)

399 
´ecisiÚ
 = ()(
cÚv”t
) - 10;

401 ià(
´ecisiÚ
 > 
Ën
)

402 
´ecisiÚ
 = 
Ën
;

403 
	`¡rıy
(
fmt¡r
, "%");

404 ià(
lju¡
)

405 
	`¡rÿt
(
fmt¡r
, "-");

406 ià(
Ën
)

408 
	`¥rštf
(
fmt¡r
 + 
	`¡¾’
(fmt¡r), "%d", 
Ën
);

410 ià(
´ecisiÚ
 > 0)

412 
	`¥rštf
(
fmt¡r
 + 
	`¡¾’
(fmt¡r), ".%d", 
´ecisiÚ
);

414 
l
 = 
	`¡¾’
(
fmt¡r
);

415 
fmt¡r
[
l
] = 
fmt
;

416 
fmt¡r
[
l
 + 1] = 0;

417 
	`¥rštf
(
cÚv”t
, 
fmt¡r
, 
v®ue
);

418 
	`do¡r
(
cÚv”t
);

419 
	}
}

422 
	$do¡r
(*
¡r
)

424 *
¡r
)

425 
	`dİr_outch
(*
¡r
++);

426 
	}
}

429 
	$dİr_outch
(
c
)

431 ià(
’d
 =ğ0 || 
ouut
 <ƒnd)

433 *
ouut
++ = 
c
;

435 
	}
}

	@get_interface3/libtc/src/string.c

25 
	~<¡dio.h
>

26 
	~<¡dlib.h
>

27 
	~<tc¡ršg.h
>

28 
	~<tùy³s.h
>

29 
	~<ùy³.h
>

30 
	~<lim™s.h
>

32 
	#hex
(
x
è(((x)<0x3a)? ((x)-'0'): (((x)<0x60)? ((x)-0x37): ((x)-0x57)))

	)

35 
	$esÿ³
(*
d
, cÚ¡ *
s
)

37 
i
;

39 
	#bsub
(
c
,
e
èc: *
d
 =ƒ; 
s
++; 

	)

41 *
s
){

42 
	`bsub
('t', '\t');

43 
	`bsub
('n', '\n');

44 
	`bsub
('r', '\r');

45 
	`bsub
('f', '\f');

46 
	`bsub
('b', '\b');

47 
	`bsub
('a', '\a');

48 
	`bsub
('e', 0x1b);

53 *
d
 = 0;

54 
i
 = 0; i < 3 && 
	`isdig™
(*
s
); i++){

55 *
d
 *= 8;

56 *
d
 +ğ*
s
++ - '0';

60 if(
s
[1] && s[2] && 
	`isxdig™
(s[1]) && isxdigit(s[2])){

61 *
d
++ = 
	`hex
(
s
[1]) * 16 + hex(s[2]);

62 
s
 += 3;

64 *
d
 = *
s
++;

68 if(
s
[1]){

69 *
d
 = (
	`touµ”
(
s
[1]) - 0x40) & 0x7f;

70 
s
 += 2;

72 *
d
 = *
s
++;

76 *
d
 = *
s
++;

80  
s
;

81 
	}
}

84 
tc¡»xp
(cÚ¡ *
s
, cÚ¡ *
sd
, cÚ¡ *
ed
, 
fs
,

85 *(*
lookup
)(*, *), *
ld
, 
æags
)

87 
l
 = 
¡¾’
(
s
) + 1;

88 *
exp
 = 
m®loc
(
l
);

89 *
p
 = 
exp
;

90 *
d
, *
f
;

92 
	#ext
(
n
) do { \

93 
o
 = 
p
 - 
exp
; \

94 
exp
 = 
	`»®loc
Óxp, 
l
 +ğ
n
); \

95 
p
 = 
exp
 + 
o
; \

96 } 0)

	)

98 *
s
){

99 *
s
){

101 if(
æags
 & 
TCSTREXP_ESCAPE
){

102 
s
 = 
esÿ³
(
p
++, ++s);

104 *
p
++ = *
s
++;

109 
d
 = 
¡rchr
(
sd
, *++
s
);

110 if(
d
){

111 cÚ¡ *
e
 = ++
s
;

112 
ec
 = 
ed
[
d
 - 
sd
];

113 
n
 = 0;

116 *
e
){

117 if(*
e
 =ğ*
d
 && *(e - 1) == '$'){

118 
n
++;

119 } if(*
e
 =ğ
ec
){

120 if(!
n
)

122 
n
--;

124 
e
++;

127 if(*
e
){

128 
vl
 = 
e
 - 
s
;

129 *
vn
 = 
m®loc
(
vl
 + 1);

130 *
v
;

131 *
def
 = 
NULL
, *
®t
 = NULL;

132 
upÿ£
 = 0, 
downÿ£
 = 0;

133 
sss
 = 0, 
s¦
 = 
INT_MAX
;

134 *
rx
 = 
NULL
, *
rsub
 = NULL, 
rd
;

136 
¡ºıy
(
vn
, 
s
, 
vl
);

137 
vn
[
vl
] = 0;

138 if(
fs
 && (
f
 = 
¡rchr
(
vn
, fs))){

139 
æ
 = 1;

140 *
f
++ = 0;

141 
æ
 && *
f
){

142 *
f
++){

144 
def
 = 
f
;

145 
æ
 = 0;

148 
®t
 = 
f
;

149 
æ
 = 0;

152 
upÿ£
 = 1;

155 
downÿ£
 = 1;

158 
f
++;

169 
sss
 = 
¡¹Ş
(
f
-1, &f, 0);

170 if(*
f
 == ':'){

171 
f
++;

172 
s¦
 = 
¡¹Ş
(
f
, &f, 0);

176 
f
--;

178 
rd
 = *
f
;

179 
rx
 = ++
f
;

180 if((
rsub
 = 
¡rchr
(
rx
, 
rd
))){

181 *
»
;

182 *
rsub
++ = 0;

183 if((
»
 = 
¡rchr
(
rsub
, 
rd
))){

184 *
»
 = 0;

185 
f
 = 
»
 + 1;

187 
æ
 = 0;

190 
rx
 = 
NULL
;

196 if((
v
 = 
lookup
(
vn
, 
ld
))){

197 *
ov
 = 
v
;

198 if(
®t
)

199 
v
 = 
tc¡»xp
(
®t
, 
sd
, 
ed
, 
fs
, 
lookup
, 
ld
, 
æags
);

201 
v
 = 
¡rdup
(v);

202 if(
æags
 & 
TCSTREXP_FREE
)

203 
ä“
(
ov
);

204 } if(
def
){

205 
v
 = 
tc¡»xp
(
def
, 
sd
, 
ed
, 
fs
, 
lookup
, 
ld
, 
æags
);

207 if(
v
){

208 
¦
 = 
¡¾’
(
v
);

209 *
vo
 = 
v
;

211 if(
sss
 < 0){

212 if(-
sss
 < 
¦
){

213 
v
 +ğ
¦
 + 
sss
;

214 
¦
 = -
sss
;

216 } if(
sss
 <ğ
¦
){

217 
v
 +ğ
sss
;

218 
¦
 -ğ
sss
;

220 
v
 +ğ
¦
;

221 
¦
 = 0;

224 if(
s¦
 < 0){

225 if(-
s¦
 < 
¦
){

226 
v
[
¦
 + 
s¦
] = 0;

227 
¦
 +ğ
s¦
;

229 
¦
 = 0;

231 } if(
s¦
 < 
¦
){

232 
v
[
s¦
] = 0;

233 
¦
 = 
s¦
;

236 if(
rx
){

237 *
rs
 = 
tüegsub
(
v
, 
rx
, 
rsub
, 0);

238 if(
rs
){

239 
ä“
(
vo
);

240 
vo
 = 
v
 = 
rs
;

241 
¦
 = 
¡¾’
(
rs
);

245 if(
¦
){

246 
ext
(
¦
 + 1);

248 if(
upÿ£
){

249 *
c
 = 
v
;

250 *
c
)

251 *
p
++ = 
touµ”
(*
c
++);

252 } if(
downÿ£
){

253 *
c
 = 
v
;

254 *
c
)

255 *
p
++ = 
tŞow”
(*
c
++);

257 
¡rıy
(
p
, 
v
);

258 
p
 +ğ
¦
;

261 
ä“
(
vo
);

262 } if(
æags
 & 
TCSTREXP_KEEPUNDEF
){

263 
n
 = 
e
 - 
s
 + 3;

264 
ext
(
n
);

265 
memıy
(
p
, 
s
 - 2, 
n
);

266 
p
 +ğ
n
;

268 
s
 = 
e
 + 1;

269 
ä“
(
vn
);

272 *
p
++ = '$';

276 *
p
++ = *
s
++;

281 *
p
 = 0;

283 #undeà
ext


284  
exp
;

288 
	$tc¡»sc
(*
d¡
, cÚ¡ *
¤c
)

290 *
d
 = 
d¡
;

292 *
¤c
){

293 if(*
¤c
 == '\\')

294 
¤c
 = 
	`esÿ³
(
d
++, ++src);

296 *
d
++ = *
¤c
++;

299 *
d
 = 0;

301  
d
 - 
d¡
;

302 
	}
}

	@get_interface3/libtc/src/strsep.c

30 
	~<tc¡ršg.h
>

44 
	$¡r£p
(**
¡ršgp
, cÚ¡ *
d–im
)

46 *
s
;

47 cÚ¡ *
¥ªp
;

48 
c
, 
sc
;

49 *
tok
;

51 ià((
s
 = *
¡ršgp
è=ğ
NULL
)

52  (
NULL
);

53 
tok
 = 
s
;;) {

54 
c
 = *
s
++;

55 
¥ªp
 = 
d–im
;

57 ià((
sc
 = *
¥ªp
++è=ğ
c
) {

58 ià(
c
 == 0)

59 
s
 = 
NULL
;

61 
s
[-1] = 0;

62 *
¡ršgp
 = 
s
;

63  (
tok
);

65 } 
sc
 != 0);

68 
	}
}

	@get_interface3/libtc/src/strtotime.c

25 
	#_XOPEN_SOURCE
 1

	)

26 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

28 
	~<¡dio.h
>

29 
	~<¡dlib.h
>

30 
	~<¡ršg.h
>

31 
	~<tùy³s.h
>

32 
	~<tùime.h
>

35 *
	gtimefmts
[13] = {

48 
NULL


53 
	$¡¹Ùime
(*
ts
, 
tm
 *tm, **
fmts
)

55 *
t
;

56 
time_t
 
É
;

57 
i
;

59 if(
fmts
 =ğ
NULL
)

60 
fmts
 = 
timefmts
;

62 
i
 = 0;

63 
fmts
[
i
] !ğ
NULL
 &&

64 ((
t
 = 
	`¡½time
(
ts
, 
fmts
[
i
], 
tm
)è=ğ
NULL
 || *t != 0);

65 
i
++);

67 if(
fmts
[
i
] !ğ
NULL
){

68 
É
 = 
	`time
(
NULL
);

69 
	`loÿÉime_r
(&
É
, 
tm
);

70 
	`¡½time
(
ts
, 
fmts
[
i
], 
tm
);

73  
fmts
[
i
];

74 
	}
}

	@get_interface3/libtc/src/tcc-internal.h

25 #iâdeà
_TCC_INTERNAL_H


26 
	#_TCC_INTERNAL_H


	)

28 
	~<tùy³s.h
>

29 
	~<tşi¡.h
>

31 
	#TCC_INTEGER
 1

	)

32 
	#TCC_FLOAT
 2

	)

33 
	#TCC_BOOLEAN
 3

	)

34 
	#TCC_STRING
 4

	)

35 
	#TCC_REF
 5

	)

36 
	#TCC_IGNORE
 (1<<28)

	)

37 
	#TCC_EXPAND
 (1<<29)

	)

38 
	#TCC_LONG
 (1<<30)

	)

39 
	#TCC_UNSIGNED
 (1U<<31)

	)

40 
	#TCC_TYPEMASK
 (
TCC_IGNORE
-1)

	)

43 
	mty³
;

45 
ušt64_t
 
	mš‹g”
;

46 
	mæßtšg
;

47 
	mboŞ—n
;

48 *
	m¡ršg
;

49 } 
	mv®ue
;

50 } 
	ttcc_v®ue
;

52 
_cÚf_£ùiÚ
 
	tcÚf_£ùiÚ
;

53 
	s_cÚf_£ùiÚ
 {

54 *
	mÇme
;

55 
tşi¡_t
 *
	m’Œ›s
;

56 
tşi¡_t
 *
	mm”ge
;

57 
cÚf_£ùiÚ
 *
	m·»Á
;

60 
	stccÚf_£ùiÚ
 {

61 
cÚf_£ùiÚ
 *
	m£c
;

62 
tccÚf_£ùiÚ_t
 *
	m·»Á
;

65 
	#TCC_VALUE
 1

	)

66 
	#TCC_SECTION
 2

	)

67 
	#TCC_MSECTION
 3

	)

70 
	mty³
;

72 *
	mkey
;

73 
tşi¡_t
 *
	mv®ues
;

74 } 
	mv®ue
;

75 
cÚf_£ùiÚ
 *
	m£ùiÚ
;

76 } 
	ttcc_’Œy
;

79 
cÚf_£ùiÚ
 *
cÚf_Ãw
(*
Çme
);

80 
tcc_addšt
(
tcc_’Œy
 *, );

81 
tcc_addæßt
(
tcc_’Œy
 *, );

82 
tcc_add¡ršg
(
tcc_’Œy
 *, *, );

83 
tcc_addboŞ
(
tcc_’Œy
 *, );

84 
tcc_add»f
(
tcc_’Œy
 *
‹
, *
»f
);

85 
cÚf_£ùiÚ
 *
tcc_Ëx
(*, 
tcio_â
, conf_section *);

86 
tcc_’Œy
 *
ü—‹_’Œy
(
cÚf_£ùiÚ
 *
£c
, *
Çme
, 
ty³
);

	@get_interface3/libtc/src/tree.c

23 
	#NDEBUG
 1

	)

25 
	~<¡dlib.h
>

26 
	~<¡ddef.h
>

27 
	~<±h»ad.h
>

28 
	~<tù»e.h
>

29 
	~<as£¹.h
>

31 ’um { 
	mdnode_»d
, 
	mdnode_bÏck
 } 
	tdnode_cŞÜ_t
;

33 
	sdnode_t
 {

34 
dnode_t
 *
	mËá
;

35 
dnode_t
 *
	mright
;

36 
dnode_t
 *
	m·»Á
;

37 
dnode_cŞÜ_t
 
	mcŞÜ
;

38 *
	mkey
;

39 } 
	tdnode_t
;

41 
	stù»e
 {

42 
dnode_t
 
	mnnode
;

43 
	mnodecouÁ
;

44 
tccom·»_â
 
	mcom·»
;

45 
	mlockšg
;

46 
±h»ad_mu‹x_t
 
	mlock
;

47 
ušt32_t
 
	mæags
;

50 
	#diù_roÙ
(
D
è((D)->
nnode
.
Ëá
)

	)

51 
	#diù_n
(
D
è(&(D)->
nnode
)

	)

52 
	#DICT_DEPTH_MAX
 64

	)

61 
	$rÙ©e_Ëá
(
dnode_t
 *
uµ”
)

63 
dnode_t
 *
low”
, *
lowËá
, *
uµ¬’t
;

65 
low”
 = 
uµ”
->
right
;

66 
uµ”
->
right
 = 
lowËá
 = 
low”
->
Ëá
;

67 
lowËá
->
·»Á
 = 
uµ”
;

69 
low”
->
·»Á
 = 
uµ¬’t
 = 
uµ”
->parent;

74 ià(
uµ”
 =ğ
uµ¬’t
->
Ëá
) {

75 
uµ¬’t
->
Ëá
 = 
low”
;

77 
	`as£¹
 (
uµ”
 =ğ
uµ¬’t
->
right
);

78 
uµ¬’t
->
right
 = 
low”
;

81 
low”
->
Ëá
 = 
uµ”
;

82 
uµ”
->
·»Á
 = 
low”
;

83 
	}
}

90 
	$rÙ©e_right
(
dnode_t
 *
uµ”
)

92 
dnode_t
 *
low”
, *
lowright
, *
uµ¬’t
;

94 
low”
 = 
uµ”
->
Ëá
;

95 
uµ”
->
Ëá
 = 
lowright
 = 
low”
->
right
;

96 
lowright
->
·»Á
 = 
uµ”
;

98 
low”
->
·»Á
 = 
uµ¬’t
 = 
uµ”
->parent;

100 ià(
uµ”
 =ğ
uµ¬’t
->
right
) {

101 
uµ¬’t
->
right
 = 
low”
;

103 
	`as£¹
 (
uµ”
 =ğ
uµ¬’t
->
Ëá
);

104 
uµ¬’t
->
Ëá
 = 
low”
;

107 
low”
->
right
 = 
uµ”
;

108 
uµ”
->
·»Á
 = 
low”
;

109 
	}
}

111 
šlše
 

112 
	$Œ“_lock
(
tù»e_t
 *
t
)

114 if(
t
->
lockšg
)

115 
	`±h»ad_mu‹x_lock
(&
t
->
lock
);

116 
	}
}

118 
šlše
 

119 
	$Œ“_uÆock
(
tù»e_t
 *
t
)

121 if(
t
->
lockšg
)

122 
	`±h»ad_mu‹x_uÆock
(&
t
->
lock
);

123 
	}
}

125 
tù»e_t
 *

126 
	$tù»e_Ãw
(
lock
, 
tccom·»_â
 
cmp
, 
ušt32_t
 
æags
)

128 
tù»e_t
 *
t
 = 
	`ÿÎoc
(1, (*t));

130 
t
->
nnode
.
Ëá
 = &t->nilnode;

131 
t
->
nnode
.
right
 = &t->nilnode;

132 
t
->
nnode
.
·»Á
 = &t->nilnode;

133 
t
->
nnode
.
cŞÜ
 = 
dnode_bÏck
;

134 
t
->
com·»
 = 
cmp
;

135 
t
->
lockšg
 = 
lock
;

136 
	`±h»ad_mu‹x_š™
(&
t
->
lock
, 
NULL
);

137 
t
->
æags
 = flags;

139  
t
;

140 
	}
}

148 
	$ä“_nodes
(
dnode_t
 *
node
, dnode_ˆ*
n
, 
tcä“_â
 
ä
)

150 ià(
node
 =ğ
n
)

152 
	`ä“_nodes
(
node
->
Ëá
, 
n
, 
ä
);

153 
	`ä“_nodes
(
node
->
right
, 
n
, 
ä
);

154 if(
ä
)

155 
	`ä
(
node
->
key
);

156 
	`ä“
(
node
);

157 
	}
}

160 
	$tù»e_de¡roy
(
tù»e_t
 *
t
, 
tcä“_â
 
f
)

162 
dnode_t
 *
n
 = 
	`diù_n
(
t
), *
roÙ
 = 
	`diù_roÙ
(t);

163 
	`ä“_nodes
(
roÙ
, 
n
, 
f
);

164 
	`±h»ad_mu‹x_de¡roy
(&
t
->
lock
);

166 
	}
}

175 
dnode_t
 *

176 
	$do_fšd
(
tù»e_t
 *
diù
, *
key
)

178 
dnode_t
 *
roÙ
 = 
	`diù_roÙ
(
diù
);

179 
dnode_t
 *
n
 = 
	`diù_n
(
diù
);

180 
»suÉ
;

182 
roÙ
 !ğ
n
) {

183 
»suÉ
 = 
diù
->
	`com·»
(
key
, 
roÙ
->key);

184 ià(
»suÉ
 < 0)

185 
roÙ
 =„oÙ->
Ëá
;

186 ià(
»suÉ
 > 0)

187 
roÙ
 =„oÙ->
right
;

189  
roÙ
;

193  
NULL
;

194 
	}
}

197 
	$tù»e_fšd
(
tù»e_t
 *
diù
, *
key
, *
r
)

199 
dnode_t
 *
node
;

200 **
»t
 = 
r
;

202 
	`Œ“_lock
(
diù
);

204 
node
 = 
	`do_fšd
(
diù
, 
key
);

205 if(
node
 && 
»t
)

206 *
»t
 = 
node
->
key
;

208 
	`Œ“_uÆock
(
diù
);

209  !
node
;

210 
	}
}

221 
	$do_£¬ch
(
tù»e_t
 *
diù
, *
key
, *
r
, 
»¶aû
)

223 
dnode_t
 *
wh”e
 = 
	`diù_roÙ
(
diù
), *
n
 = 
	`diù_n
(dict);

224 
dnode_t
 *
·»Á
 = 
n
, *
unşe
, *
g¿nd·
;

225 
dnode_t
 *
node
;

226 **
»t
 = 
r
;

227 
»suÉ
 = -1;

229 
	`Œ“_lock
(
diù
);

231 
wh”e
 !ğ
n
) {

232 
·»Á
 = 
wh”e
;

233 
»suÉ
 = 
diù
->
	`com·»
(
key
, 
wh”e
->key);

234 if(
»suÉ
 < 0){

235 
wh”e
 = wh”e->
Ëá
;

236 } if(
»suÉ
 > 0){

237 
wh”e
 = wh”e->
right
;

239 *
»t
 = 
wh”e
->
key
;

240 if(
»¶aû
)

241 
wh”e
->
key
 = key;

242 
	`Œ“_uÆock
(
diù
);

247 if(
»t
)

248 *
»t
 = 
key
;

250 
node
 = 
	`m®loc
((*node));

251 
node
->
key
 = key;

253 ià(
»suÉ
 < 0)

254 
·»Á
->
Ëá
 = 
node
;

256 
·»Á
->
right
 = 
node
;

258 
node
->
·»Á
 =…arent;

259 
node
->
Ëá
 = 
n
;

260 
node
->
right
 = 
n
;

262 
diù
->
nodecouÁ
++;

266 
node
->
cŞÜ
 = 
dnode_»d
;

268 
·»Á
->
cŞÜ
 =ğ
dnode_»d
) {

269 
g¿nd·
 = 
·»Á
->parent;

270 ià(
·»Á
 =ğ
g¿nd·
->
Ëá
) {

271 
unşe
 = 
g¿nd·
->
right
;

272 ià(
unşe
->
cŞÜ
 =ğ
dnode_»d
) {

273 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

274 
unşe
->
cŞÜ
 = 
dnode_bÏck
;

275 
g¿nd·
->
cŞÜ
 = 
dnode_»d
;

276 
node
 = 
g¿nd·
;

277 
·»Á
 = 
g¿nd·
->parent;

279 ià(
node
 =ğ
·»Á
->
right
) {

280 
	`rÙ©e_Ëá
(
·»Á
);

281 
·»Á
 = 
node
;

282 
	`as£¹
 (
g¿nd·
 =ğ
·»Á
->parent);

285 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

286 
g¿nd·
->
cŞÜ
 = 
dnode_»d
;

287 
	`rÙ©e_right
(
g¿nd·
);

291 
unşe
 = 
g¿nd·
->
Ëá
;

292 ià(
unşe
->
cŞÜ
 =ğ
dnode_»d
) {

293 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

294 
unşe
->
cŞÜ
 = 
dnode_bÏck
;

295 
g¿nd·
->
cŞÜ
 = 
dnode_»d
;

296 
node
 = 
g¿nd·
;

297 
·»Á
 = 
g¿nd·
->parent;

299 ià(
node
 =ğ
·»Á
->
Ëá
) {

300 
	`rÙ©e_right
(
·»Á
);

301 
·»Á
 = 
node
;

302 
	`as£¹
 (
g¿nd·
 =ğ
·»Á
->parent);

304 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

305 
g¿nd·
->
cŞÜ
 = 
dnode_»d
;

306 
	`rÙ©e_Ëá
(
g¿nd·
);

312 
	`diù_roÙ
(
diù
)->
cŞÜ
 = 
dnode_bÏck
;

314 
	`Œ“_uÆock
(
diù
);

316 
	}
}

319 
	$tù»e_£¬ch
(
tù»e_t
 *
t
, *
key
, *
»t
)

321  
	`do_£¬ch
(
t
, 
key
, 
»t
, 0);

322 
	}
}

325 
	$tù»e_»¶aû
(
tù»e_t
 *
t
, *
key
, *
»t
)

327  
	`do_£¬ch
(
t
, 
key
, 
»t
, 1);

328 
	}
}

337 
dnode_t
 *
	$diù_Ãxt
(
tù»e_t
 *
diù
, 
dnode_t
 *
cu¼
)

339 
dnode_t
 *
n
 = 
	`diù_n
(
diù
), *
·»Á
, *
Ëá
;

341 ià(
cu¼
->
right
 !ğ
n
) {

342 
cu¼
 = cu¼->
right
;

343 (
Ëá
 = 
cu¼
->Ëáè!ğ
n
)

344 
cu¼
 = 
Ëá
;

345  
cu¼
;

348 
·»Á
 = 
cu¼
->parent;

350 
·»Á
 !ğ
n
 && 
cu¼
 =ğ·»Á->
right
) {

351 
cu¼
 = 
·»Á
;

352 
·»Á
 = 
cu¼
->parent;

355  (
·»Á
 =ğ
n
è? 
NULL
 :…arent;

356 
	}
}

365 
	$tù»e_d–‘e
(
tù»e_t
 *
diù
, *
key
, *
r
)

367 
dnode_t
 *
n
 = 
	`diù_n
(
diù
), *
chd
, *
d–·»Á
, *
d–‘e
;

368 **
»t
 = 
r
;

370 
	`Œ“_lock
(
diù
);

372 
d–‘e
 = 
	`do_fšd
(
diù
, 
key
);

373 if(!
d–‘e
){

374 
	`Œ“_uÆock
(
diù
);

378 
d–·»Á
 = 
d–‘e
->
·»Á
;

380 if(
»t
)

381 *
»t
 = 
d–‘e
->
key
;

395 ià(
d–‘e
->
Ëá
 !ğ
n
 && d–‘e->
right
 !=‚il) {

396 
dnode_t
 *
Ãxt
 = 
	`diù_Ãxt
(
diù
, 
d–‘e
);

397 
dnode_t
 *
Ãx¬’t
 = 
Ãxt
->
·»Á
;

398 
dnode_cŞÜ_t
 
ÃxtcŞÜ
 = 
Ãxt
->
cŞÜ
;

400 
	`as£¹
 (
Ãxt
 !ğ
n
);

401 
	`as£¹
 (
Ãxt
->
·»Á
 !ğ
n
);

402 
	`as£¹
 (
Ãxt
->
Ëá
 =ğ
n
);

409 
chd
 = 
Ãxt
->
right
;

410 
chd
->
·»Á
 = 
Ãx¬’t
;

412 ià(
Ãx¬’t
->
Ëá
 =ğ
Ãxt
) {

413 
Ãx¬’t
->
Ëá
 = 
chd
;

415 
	`as£¹
 (
Ãx¬’t
->
right
 =ğ
Ãxt
);

416 
Ãx¬’t
->
right
 = 
chd
;

424 
Ãxt
->
·»Á
 = 
d–·»Á
;

425 
Ãxt
->
Ëá
 = 
d–‘e
->left;

426 
Ãxt
->
right
 = 
d–‘e
->right;

427 
Ãxt
->
Ëá
->
·»Á
 =‚ext;

428 
Ãxt
->
right
->
·»Á
 =‚ext;

429 
Ãxt
->
cŞÜ
 = 
d–‘e
->color;

430 
d–‘e
->
cŞÜ
 = 
ÃxtcŞÜ
;

432 ià(
d–·»Á
->
Ëá
 =ğ
d–‘e
) {

433 
d–·»Á
->
Ëá
 = 
Ãxt
;

435 
	`as£¹
 (
d–·»Á
->
right
 =ğ
d–‘e
);

436 
d–·»Á
->
right
 = 
Ãxt
;

440 
	`as£¹
 (
d–‘e
 !ğ
n
);

441 
	`as£¹
 (
d–‘e
->
Ëá
 =ğ
n
 || d–‘e->
right
 ==‚il);

443 
chd
 = (
d–‘e
->
Ëá
 !ğ
n
è? d–‘e->Ëá : d–‘e->
right
;

445 
chd
->
·»Á
 = 
d–·»Á
 = 
d–‘e
->parent;

447 ià(
d–‘e
 =ğ
d–·»Á
->
Ëá
) {

448 
d–·»Á
->
Ëá
 = 
chd
;

450 
	`as£¹
 (
d–‘e
 =ğ
d–·»Á
->
right
);

451 
d–·»Á
->
right
 = 
chd
;

455 
d–‘e
->
·»Á
 = 
NULL
;

456 
d–‘e
->
right
 = 
NULL
;

457 
d–‘e
->
Ëá
 = 
NULL
;

459 
diù
->
nodecouÁ
--;

463 ià(
d–‘e
->
cŞÜ
 =ğ
dnode_bÏck
) {

464 
dnode_t
 *
·»Á
, *
si¡”
;

466 
	`diù_roÙ
(
diù
)->
cŞÜ
 = 
dnode_»d
;

468 
chd
->
cŞÜ
 =ğ
dnode_bÏck
) {

469 
·»Á
 = 
chd
->parent;

470 ià(
chd
 =ğ
·»Á
->
Ëá
) {

471 
si¡”
 = 
·»Á
->
right
;

472 
	`as£¹
 (
si¡”
 !ğ
n
);

473 ià(
si¡”
->
cŞÜ
 =ğ
dnode_»d
) {

474 
si¡”
->
cŞÜ
 = 
dnode_bÏck
;

475 
·»Á
->
cŞÜ
 = 
dnode_»d
;

476 
	`rÙ©e_Ëá
(
·»Á
);

477 
si¡”
 = 
·»Á
->
right
;

478 
	`as£¹
 (
si¡”
 !ğ
n
);

480 ià(
si¡”
->
Ëá
->
cŞÜ
 =ğ
dnode_bÏck


481 && 
si¡”
->
right
->
cŞÜ
 =ğ
dnode_bÏck
) {

482 
si¡”
->
cŞÜ
 = 
dnode_»d
;

483 
chd
 = 
·»Á
;

485 ià(
si¡”
->
right
->
cŞÜ
 =ğ
dnode_bÏck
) {

486 
	`as£¹
 (
si¡”
->
Ëá
->
cŞÜ
 =ğ
dnode_»d
);

487 
si¡”
->
Ëá
->
cŞÜ
 = 
dnode_bÏck
;

488 
si¡”
->
cŞÜ
 = 
dnode_»d
;

489 
	`rÙ©e_right
(
si¡”
);

490 
si¡”
 = 
·»Á
->
right
;

491 
	`as£¹
 (
si¡”
 !ğ
n
);

493 
si¡”
->
cŞÜ
 = 
·»Á
->color;

494 
si¡”
->
right
->
cŞÜ
 = 
dnode_bÏck
;

495 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

496 
	`rÙ©e_Ëá
(
·»Á
);

500 
	`as£¹
 (
chd
 =ğ
·»Á
->
right
);

501 
si¡”
 = 
·»Á
->
Ëá
;

502 
	`as£¹
 (
si¡”
 !ğ
n
);

503 ià(
si¡”
->
cŞÜ
 =ğ
dnode_»d
) {

504 
si¡”
->
cŞÜ
 = 
dnode_bÏck
;

505 
·»Á
->
cŞÜ
 = 
dnode_»d
;

506 
	`rÙ©e_right
(
·»Á
);

507 
si¡”
 = 
·»Á
->
Ëá
;

508 
	`as£¹
 (
si¡”
 !ğ
n
);

510 ià(
si¡”
->
right
->
cŞÜ
 =ğ
dnode_bÏck


511 && 
si¡”
->
Ëá
->
cŞÜ
 =ğ
dnode_bÏck
) {

512 
si¡”
->
cŞÜ
 = 
dnode_»d
;

513 
chd
 = 
·»Á
;

515 ià(
si¡”
->
Ëá
->
cŞÜ
 =ğ
dnode_bÏck
) {

516 
	`as£¹
 (
si¡”
->
right
->
cŞÜ
 =ğ
dnode_»d
);

517 
si¡”
->
right
->
cŞÜ
 = 
dnode_bÏck
;

518 
si¡”
->
cŞÜ
 = 
dnode_»d
;

519 
	`rÙ©e_Ëá
(
si¡”
);

520 
si¡”
 = 
·»Á
->
Ëá
;

521 
	`as£¹
 (
si¡”
 !ğ
n
);

523 
si¡”
->
cŞÜ
 = 
·»Á
->color;

524 
si¡”
->
Ëá
->
cŞÜ
 = 
dnode_bÏck
;

525 
·»Á
->
cŞÜ
 = 
dnode_bÏck
;

526 
	`rÙ©e_right
(
·»Á
);

532 
chd
->
cŞÜ
 = 
dnode_bÏck
;

533 
	`diù_roÙ
(
diù
)->
cŞÜ
 = 
dnode_bÏck
;

536 
	`Œ“_uÆock
(
diù
);

538 
	}
}

	@get_link/main.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<”ºo.h
>

12 
	~<sys/sock‘.h
>

13 
	~<asm/ty³s.h
>

14 
	~<lšux/Ãšk.h
>

15 
	~<lšux/¹Ãšk.h
>

16 
	~<sys/sock‘.h
>

17 
	~"Æ.h
"

20 
	$maš
()

22 
Æ_hªdËr
 
Æh
;

23 
Æmsg
 *Æmsg = 
NULL
, *
ªsw”
 = NULL;

24 
ifšfomsg
 *
ifi
;

25 
¹g’msg
 *
msg
;

26 
šdex
, 
Ën
, 
”r
;

28 
”r
 = 
	`Ãšk_İ’
(&
Æh
, 
NETLINK_ROUTE
);

29 ià(
”r
)

30  
”r
;

32 
”r
 = -
EINVAL
;

34 
Ën
 = 
	`¡¾’
(
Çme
);

35 ià(
Ën
 =ğ1 ||†’ >ğ
IFNAMSIZ
)

36 
out
;

38 
”r
 = -
ENOMEM
;

39 
Æmsg
 = 
	`Æmsg_®loc
(
NLMSG_GOOD_SIZE
);

40 ià(!
Æmsg
)

41 
out
;

44 
ªsw”
 = 
	`Æmsg_®loc_»£rve
(4096);

45 ià(!
ªsw”
)

46 
out
;

48 
”r
 = -
EINVAL
;

49 
šdex
 = 
	`if_Çm‘ošdex
(
Çme
);

50 ià(!
šdex
)

51 
out
;

54 
Æmsg
->
Æmsghdr
->
Æmsg_pid
 = 0;

55 
Æmsg
->
Æmsghdr
->
Æmsg_æags
 = 
NLM_F_REQUEST
 | 
NLM_F_MATCH
 | 
NLM_F_ROOT
;

56 
Æmsg
->
Æmsghdr
->
Æmsg_ty³
 = 
RTM_GETLINK
;

57 
Æmsg
->
Æmsghdr
->
Æmsg_£q
 = 
Æh
.
£q
;

59 
msg
 = (
¹g’msg
 *)
	`Æmsg_»£rve
(
Æmsg
, (rtgenmsg));

60 
msg
->
¹g’_çmy
 = 
AF_INET
;

63 
”r
 = 
	`Ãšk_Œª§ùiÚ_g‘šfo
(&
Æh
, 
Æmsg
, 
ªsw”
);

64 
out
:

65 
	`Ãšk_şo£
(&
Æh
);

66 
	`Æmsg_ä“
(
Æmsg
);

67 
	`Æmsg_ä“
(
ªsw”
);

68  
”r
;

69 
	}
}

	@get_link/nl.c

8 
	~<sys/sock‘.h
>

9 
	~<¡ršg.h
>

10 
	~<¡dio.h
>

11 
	~<time.h
>

12 
	~<uni¡d.h
>

13 
	~<”ºo.h
>

14 
	~<¡dlib.h
>

15 
	~<lšux/Ãšk.h
>

16 
	~<lšux/¹Ãšk.h
>

17 
	~<sys/ioùl.h
>

18 
	~<Ãt/if.h
>

19 
	~<fú.h
>

20 
	~"Æ.h
"

22 
	#NLMSG_TAIL
(
nmsg
) \

23 ((
¹©Œ
 *è(((*è(
nmsg
)è+ 
	`NLMSG_ALIGN
(Òmsg)->
Æmsg_Ën
)))

	)

25 
size_t
 
	$Æmsg_Ën
(cÚ¡ 
Æmsg
 *nlmsg)

27  
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 - 
NLMSG_HDRLEN
;

28 
	}
}

30 *
	$Æmsg_d©a
(
Æmsg
 *nlmsg)

32 *
d©a
 = ((*)
Æmsg
è+ 
NLMSG_HDRLEN
;

33 ià(!
	`Æmsg_Ën
(
Æmsg
))

34  
NULL
;

35  
d©a
;

36 
	}
}

38 
	$Æa_put
(
Æmsg
 *Æmsg, 
©Œ
,

39 cÚ¡ *
d©a
, 
size_t
 
Ën
)

41 
¹©Œ
 *
¹a
;

42 
size_t
 
¹®’
 = 
	`RTA_LENGTH
(
Ën
);

43 
size_t
 
’
 = 
	`NLMSG_ALIGN
(
Æmsg
->
Æmsghdr
->
Æmsg_Ën
è+ 
	`RTA_ALIGN
(
¹®’
);

45 ià(
’
 > 
Æmsg
->
ÿp
)

46  -
ENOMEM
;

48 
¹a
 = 
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
);

49 
¹a
->
¹a_ty³
 = 
©Œ
;

50 
¹a
->
¹a_Ën
 = 
¹®’
;

51 
	`memıy
(
	`RTA_DATA
(
¹a
), 
d©a
, 
Ën
);

52 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 = 
’
;

54 
	}
}

56 
	$Æa_put_bufãr
(
Æmsg
 *Æmsg, 
©Œ
,

57 cÚ¡ *
d©a
, 
size_t
 
size
)

59  
	`Æa_put
(
Æmsg
, 
©Œ
, 
d©a
, 
size
);

60 
	}
}

62 
	$Æa_put_¡ršg
(
Æmsg
 *Æmsg, 
©Œ
, cÚ¡ *
¡ršg
)

64  
	`Æa_put
(
Æmsg
, 
©Œ
, 
¡ršg
, 
	`¡¾’
(string) + 1);

65 
	}
}

67 
	$Æa_put_u32
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
)

69  
	`Æa_put
(
Æmsg
, 
©Œ
, &
v®ue
, (value));

70 
	}
}

72 
	$Æa_put_u16
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
)

74  
	`Æa_put
(
Æmsg
, 
©Œ
, &
v®ue
, 2);

75 
	}
}

77 
	$Æa_put_©Œ
(
Æmsg
 *Æmsg, 
©Œ
)

79  
	`Æa_put
(
Æmsg
, 
©Œ
, 
NULL
, 0);

80 
	}
}

82 
¹©Œ
 *
	$Æa_begš_Ã¡ed
(
Æmsg
 *Æmsg, 
©Œ
)

84 
¹©Œ
 *¹©Œ = 
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
);

86 ià(
	`Æa_put_©Œ
(
Æmsg
, 
©Œ
))

87  
NULL
;

89  
¹©Œ
;

90 
	}
}

92 
	$Æa_’d_Ã¡ed
(
Æmsg
 *Æmsg, 
¹©Œ
 *
©Œ
)

94 
©Œ
->
¹a_Ën
 = (*)
	`NLMSG_TAIL
(
Æmsg
->
Æmsghdr
) - (*)attr;

95 
	}
}

111 
Æmsg
 *
	$Æmsg_®loc
(
size_t
 
size
)

113 
Æmsg
 *nlmsg;

116 
size_t
 
Ën
 = 
NLMSG_HDRLEN
 + 
	`NLMSG_ALIGN
(
size
);

118 
Æmsg
 = (Æmsg *)
	`m®loc
((nlmsg));

119 ià(!
Æmsg
)

120  
NULL
;

122 
Æmsg
->
Æmsghdr
 = (Æmsghd¸*)
	`m®loc
(
Ën
);

123 ià(!
Æmsg
->
Æmsghdr
)

124 
”rout
;

126 
	`mem£t
(
Æmsg
->
Æmsghdr
, 0, 
Ën
);

127 
Æmsg
->
ÿp
 = 
Ën
;

128 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 = 
NLMSG_HDRLEN
;

130  
Æmsg
;

131 
”rout
:

132 
	`ä“
(
Æmsg
);

133  
NULL
;

134 
	}
}

146 *
	$Æmsg_»£rve
(
Æmsg
 *Æmsg, 
size_t
 
Ën
)

148 *
buf
;

149 
size_t
 
Æmsg_Ën
 = 
Æmsg
->
Æmsghdr
->nlmsg_len;

150 
size_t
 
’
 = 
	`NLMSG_ALIGN
(
Ën
);

153 ià(
Æmsg_Ën
 + 
’
 > 
Æmsg
->
ÿp
)

154  
NULL
;

156 
buf
 = ((*)(
Æmsg
->
Æmsghdr
)è+ 
Æmsg_Ën
;

158 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 +ğ
’
;

161 ià(
’
 > 
Ën
)

162 
	`mem£t
(
buf
 + 
Ën
, 0, 
’
 -†en);

164  
buf
;

165 
	}
}

167 
Æmsg
 *
	$Æmsg_®loc_»£rve
(
size_t
 
size
)

169 
Æmsg
 *nlmsg;

171 
Æmsg
 = 
	`Æmsg_®loc
(
size
);

172 ià(!
Æmsg
)

173  
NULL
;

176 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
 =‚lmsg->
ÿp
;

177  
Æmsg
;

178 
	}
}

180 
	$Æmsg_ä“
(
Æmsg
 *nlmsg)

182 ià(!
Æmsg
)

185 
	`ä“
(
Æmsg
->
Æmsghdr
);

186 
	`ä“
(
Æmsg
);

187 
	}
}

189 
	$Ãšk_rcv
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *
ªsw”
, 
Ën
)

192 
»t
;

193 
sockaddr_Æ
 
Æaddr
;

196 
iovec
 
iov
 = {

197 .
iov_ba£
 = 
ªsw”
->
Æmsghdr
,

201 .
iov_Ën
 = 
Ën
,

204 
msghdr
 
msg
 = {

205 .
msg_Çme
 = &
Æaddr
,

206 .
msg_Çm–’
 = (
Æaddr
),

207 .
msg_iov
 = &
iov
,

208 .
msg_iovËn
 = 1,

210 
	`mem£t
(&
Æaddr
, 0, (nladdr));

212 
Æaddr
.
Æ_çmy
 = 
AF_NETLINK
;

213 
Æaddr
.
Æ_pid
 = 0;

214 
Æaddr
.
Æ_groups
 = 0;

216 
	`´štf
("add:0x%x,†’ i %d\r\n", ()
iov
.
iov_ba£
, iov.
iov_Ën
);

217 
agaš
:

218 
»t
 = 
	`»cvmsg
(
hªdËr
->
fd
, &
msg
, 0);

219 
	`´štf
("»ˆi %d\r\n", 
»t
);

220 ià(
»t
 < 0) {

221 ià(
”ºo
 =ğ
EINTR
)

222 
agaš
;

223  -
”ºo
;

227 ià(!
»t
)

229 ià(
msg
.
msg_æags
 & 
MSG_TRUNC
 &&

230 
»t
 =ğ
ªsw”
->
Æmsghdr
->
Æmsg_Ën
)

231  -
EMSGSIZE
;

233  
»t
;

234 
	}
}

237 
	$Æ_»que¡
(
çmy
, 
ty³
, 
Æsock
 *
Æ
)

239 
»t
;

240 
sockaddr_Æ
 
¢l
;

243 
Æmsghdr
 
Æh
;

244 
¹g’msg
 
g
;

245 } 
»q
;

247 if(
Æ
->
sock
 < 0 ) {

248 
	`EINFO
("socket isn't‡ctive." );

252 
	`mem£t
(&
¢l
, 0, (snl));

253 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

255 
»q
.
Æh
.
Æmsg_Ën
 = (req);

256 
»q
.
Æh
.
Æmsg_ty³
 = 
ty³
;

257 
»q
.
Æh
.
Æmsg_æags
 = 
NLM_F_ROOT
 | 
NLM_F_MATCH
 | 
NLM_F_REQUEST
;

258 
»q
.
Æh
.
Æmsg_pid
 = 0;

259 
»q
.
Æh
.
Æmsg_£q
 = ++
Æ
->
£q
;

260 
»q
.
g
.
¹g’_çmy
 = 
çmy
;

262 
»t
 = 
	`£ndto
(
Æ
->
sock
, (*)&
»q
, „eq, 0, (
sockaddr
*)&
¢l
, (snl));

263 ià(
»t
 < 0){

264 
	`EINFO
("£ndtØçed: %s",
	`¡»¼Ü
 ( 
”ºo
 ) );

268 
	}
}

271 
	$Ãšk_£nd
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *nlmsg)

273 
sockaddr_Æ
 
Æaddr
;

274 
iovec
 
iov
 = {

275 .
iov_ba£
 = 
Æmsg
->
Æmsghdr
,

276 .
iov_Ën
 = 
Æmsg
->
Æmsghdr
->
Æmsg_Ën
,

278 
msghdr
 
msg
 = {

279 .
msg_Çme
 = &
Æaddr
,

280 .
msg_Çm–’
 = (
Æaddr
),

281 .
msg_iov
 = &
iov
,

282 .
msg_iovËn
 = 1,

284 
»t
;

286 
	`mem£t
(&
Æaddr
, 0, (nladdr));

287 
Æaddr
.
Æ_çmy
 = 
AF_NETLINK
;

288 
Æaddr
.
Æ_pid
 = 0;

289 
Æaddr
.
Æ_groups
 = 0;

291 
»t
 = 
	`£ndmsg
(
hªdËr
->
fd
, &
msg
, 0);

292 ià(
»t
 < 0)

293  -
”ºo
;

295  
»t
;

296 
	}
}

298 #iâdeà
NLMSG_ERROR


299 
	#NLMSG_ERROR
 0x2

	)

314 
	$Ãšk_Œª§ùiÚ
(
Æ_hªdËr
 *
hªdËr
,

315 
Æmsg
 *
»que¡
, Æmsg *
ªsw”
)

317 
»t
;

319 
»t
 = 
	`Ãšk_£nd
(
hªdËr
, 
»que¡
);

320 ià(
»t
 < 0)

321  
»t
;

323 
»t
 = 
	`Ãšk_rcv
(
hªdËr
, 
ªsw”
);

324 ià(
»t
 < 0)

325  
»t
;

327 ià(
ªsw”
->
Æmsghdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

328 
Æmsg”r
 *
”r
 = (Æmsg”r*)
	`NLMSG_DATA
(
ªsw”
->
Æmsghdr
);

329  
”r
->
”rÜ
;

333 
	}
}

335 
	$Æ_g‘_lšk
(
Æmsghdr
 *
h
, ** 
¬gv
)

337 
Ën
;

338 
ifšfomsg
 *
iç
;

339 
¹©Œ
 *
tb
[
IFA_MAX
 + 1];

340 
iç_Ïb–
[
IFNAMSIZ
 + 1] = {0};

342 
loÿl_addr
 **
¶addr
 = (loÿl_add¸**)
¬gv
;;

343 
loÿl_addr
 *
addr_tmp
, *
addr_Ãxt
;

346 
iç
 = (
ifšfomsg
 *)
	`NLMSG_DATA
(
h
);

347 if(
	`if_šdextÚame
(
iç
->
ifi_šdex
, 
iç_Ïb–
è=ğ
NULL
){

348 
	`´štf
("index isƒrror\r\n");

352 
	`´štf
("Çmi %s\r\n", 
iç_Ïb–
);

354 
	`mem£t
(
tb
, 0, (tb));

355 
	`Æ_·r£_¹©Œ
(
tb
, 
IFA_MAX
, 
	`IFA_RTA
(
iç
), 
Ën
 );

358 if(
tb
[
IFLA_IFNAME
])

359 
	`¡ºıy
(
iç_Ïb–
, 
	`RTA_DATA
(
tb
[
IFLA_IFNAME
]), 
IFNAMSIZ
);

364 
	}
}

366 
	$Æ_»que¡
 ( 
çmy
, 
ty³
, 
sock
 )

368 
»t
;

369 
sockaddr_Æ
 
¢l
;

372 
Æmsghdr
 
Æh
;

373 
¹g’msg
 
g
;

374 } 
»q
;

378 iàĞ
sock
 < 0 ) {

379 
	`årštf
 ( 
¡d”r
, "socket isn't‡ctive.");

383 
	`mem£t
 ( &
¢l
, 0,  snl );

384 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

386 
»q
.
Æh
.
Æmsg_Ën
 = „eq;

387 
»q
.
Æh
.
Æmsg_ty³
 = 
ty³
;

388 
»q
.
Æh
.
Æmsg_æags
 = 
NLM_F_ROOT
 | 
NLM_F_MATCH
 | 
NLM_F_REQUEST
;

389 
»q
.
Æh
.
Æmsg_pid
 = 0;

390 
»q
.
Æh
.
Æmsg_£q
 = 1000;

391 
»q
.
g
.
¹g’_çmy
 = 
çmy
;

393 
»t
 = 
	`£ndto
 ( 
sock
, ( * ) &
»q
, „eq, 0,

394 Ğ
sockaddr
* ) &
¢l
,  snl );

395 iàĞ
»t
 < 0 ) {

396 
	`årštf
 ( 
¡d”r
, " s’dtØçed: %s", 
	`¡»¼Ü
 ( 
”ºo
 ) );

400 
	}
}

404 
	$Æ_·r£_šfo
 (
sock
)

406 
¡©us
;

407 
»t
 = 0;

408 
”rÜ
;

411 
buf
[4096];

412 
iovec
 
iov
 = { 
buf
,  buf };

413 
sockaddr_Æ
 
¢l
;

414 
msghdr
 
msg
 = { ( * ) &
¢l
,  sÆ, &
iov
, 1, 
NULL
, 0, 0};

415 
Æmsghdr
 *
h
;

417 
¡©us
 = 
	`»cvmsg
 (
sock
, &
msg
, 0 );

418 
	`´štf
("»cv†’ i %d\r\n", 
¡©us
);

419 iàĞ
¡©us
 < 0 ) {

420 iàĞ
”ºo
 =ğ
EINTR
 )

422 iàĞ
”ºo
 =ğ
EWOULDBLOCK
 ||ƒ¼nØ=ğ
EAGAIN
 )

424 
	`årštf
 ( 
¡d”r
, "recvmsg overrun");

428 iàĞ
¢l
.
Æ_pid
 != 0 ) {

429 
	`årštf
 ( 
¡d”r
, "Ignoring‚on kernel message from…id %u",

430 
¢l
.
Æ_pid
 );

434 iàĞ
¡©us
 == 0 ) {

435 
	`årštf
 ( 
¡d”r
, "EOF" );

439 iàĞ
msg
.
msg_Çm–’
 !ğ 
¢l
 ) {

440 
	`årštf
 ( 
¡d”r
, " s’d”‡dd»s Ëngthƒ¼Ü:†’gth %d", 
msg
.
msg_Çm–’
 );

444  
h
 = ( 
Æmsghdr
 * ) 
buf
; 
	`NLMSG_OK
 ( h, 
¡©us
 );

445 
h
 = 
	`NLMSG_NEXT
 ( h, 
¡©us
 ) ) {

447 iàĞ
h
->
Æmsg_ty³
 =ğ
NLMSG_DONE
 )

448  
»t
;

451 iàĞ
h
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
 ) {

452 
Æmsg”r
 *
”r
 = ( Æmsg”¸* ) 
	`NLMSG_DATA
 ( 
h
 );

455 iàĞ
”r
->
”rÜ
 == 0 ) {

457 iàĞ! ( 
h
->
Æmsg_æags
 & 
NLM_F_MULTI
 ) ) {

463 iàĞ
h
->
Æmsg_Ën
 < 
	`NLMSG_LENGTH
 (  ( 
Æmsg”r
 ) ) ) {

464 
	`årštf
 ( 
¡d”r
, "%sƒrror: messageruncated");

467 
	`årštf
 ( 
¡d”r
, "ƒ¼Ü: %s,y³=%u, seq=%u,…id=%d", 
	`¡»¼Ü
 ( -
”r
->
”rÜ
 ),

468 
”r
->
msg
.
Æmsg_ty³
,ƒ¼->msg.
Æmsg_£q
,

469 
”r
->
msg
.
Æmsg_pid
 );

480 iàĞ
Æ
 !ğ&
Æ_cmd
 && 
h
->
Æmsg_pid
 =ğÆ_cmd.
¢l
.
Æ_pid
 ) {

484 
”rÜ
 = ( *
f‹r
 ) ( &
¢l
, 
h
, 
¬g
 );

485 iàĞ
”rÜ
 < 0 ) {

486 
	`årštf
 ( 
¡d”r
, "% f‹¸funùiÚƒ¼Ü/n", 
Æ
->
Çme
 );

487 
»t
 = 
”rÜ
;

492 iàĞ
msg
.
msg_æags
 & 
MSG_TRUNC
 ) {

493 
	`årštf
 ( 
¡d”r
, "% ”rÜ: mes§gŒunÿ‹d", 
Æ
->
Çme
 );

496 iàĞ
¡©us
 ) {

497 
	`årštf
 ( 
¡d”r
, "% ”rÜ: d©¨»mÇÁ siz%d", 
Æ
->
Çme
,

498 
¡©us
 );

502 
	}
}

503  
»t
;

506 (* 
	tÆmsg_İ”iÚ
)(
	tÆmsghdr
 *
	th
, *
	t¬g
 );

508 
	$Ãšk_Œª§ùiÚ_g‘šfo
(
Æ_hªdËr
 *
hªdËr
,
Æmsg
 *
»que¡
,

509 
Æmsg
 *
ªsw”
, 
Æmsg_İ”©iÚ
 
İ”©iÚ
, *
¬g
)

511 
»t
;

512 
Æmsghdr
 *
h
;

513 
”rÜ
;

514 
¡©us
;

515 
»t
 = 
	`Ãšk_£nd
(
hªdËr
, 
»que¡
);

516 ià(
»t
 < 0)

517  
»t
;

519 
¡©us
 = 
	`Ãšk_rcv
(
hªdËr
, 
ªsw”
,‡nsw”->
Æmsghdr
->
Æmsg_Ën
);

520 ià(
¡©us
 < 0) {

521 
	`´štf
("reveice messageƒrror\r\n");

522  
»t
;

524 ià(
ªsw”
->
Æmsghdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

525 
Æmsg”r
 *
”r
 = (Æmsg”r*)
	`NLMSG_DATA
(
ªsw”
->
Æmsghdr
);

526  
”r
->
”rÜ
;

529 
h
 = (
Æmsghdr
 * )
ªsw”
->Æmsghdr; 
	`NLMSG_OK
(h, 
¡©us
); h = 
	`NLMSG_NEXT
(h, status)) {

531 ià(
h
->
Æmsg_ty³
 =ğ
NLMSG_DONE
) {

532 
	`´štf
("netlink msg done\r\n");

536 ià(
h
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

537 
Æmsg”r
 *
”r
 = (Æmsg”¸* )
	`NLMSG_DATA
(
h
);

538 
	`´štf
("message isƒrror\r\n");

540 iàĞ
”r
->
”rÜ
 == 0 ) {

542 ià(!(
h
->
Æmsg_æags
 & 
NLM_F_MULTI
)) {

548 iàĞ
h
->
Æmsg_Ën
 < 
	`NLMSG_LENGTH
((
Æmsg”r
))) {

549 
	`´štf
( "error: messageruncated");

552 
	`´štf
Ğ"”rÜ: %s,y³=%u, seq=%u,…id=%d", 
	`¡»¼Ü
(-
”r
->
”rÜ
),

553 
”r
 ->
msg
.
Æmsg_ty³
,ƒ¼->msg.
Æmsg_£q
,

554 
”r
->
msg
.
Æmsg_pid
 );

557 
”rÜ
 = 
	`İ”©iÚ
(
h
, 
¬g
);

558 ià(
”rÜ
 != 0) {

559 
	`´štf
( "filter f unctionƒrror\r\n");

560 
»t
 = 
”rÜ
 ;

565 
	}
}

566 
	$Ãšk_İ’
(
Æ_hªdËr
 *
hªdËr
, 
´ÙocŞ
)

568 
sockËn_t
 
sockËn
;

569 
»t
;

570 
¢dbuf
 = 32768;

571 
rcvbuf
 = 32768;

573 
	`mem£t
(
hªdËr
, 0, (*handler));

575 
hªdËr
->
fd
 = 
	`sock‘
(
AF_NETLINK
, 
SOCK_RAW
, 
´ÙocŞ
);

576 ià(
hªdËr
->
fd
 < 0)

577  -
”ºo
;

579 ià(
	`£tsockİt
(
hªdËr
->
fd
, 
SOL_SOCKET
, 
SO_SNDBUF
,

580 &
¢dbuf
, (sndbuf)) < 0)

581  -
”ºo
;

583 ià(
	`£tsockİt
(
hªdËr
->
fd
, 
SOL_SOCKET
, 
SO_RCVBUF
,

584 &
rcvbuf
,(rcvbuf)) < 0)

585  -
”ºo
;

587 
»t
 = 
	`fú
(
hªdËr
->
fd
, 
F_SETFL
, 
O_NONBLOCK
);

588 ià(
»t
 < 0) {

589 
	`´štf
("Cª'ˆ£ˆsock‘ fÏgs: %s", 
	`¡»¼Ü
(
”ºo
));

590 
	`şo£
 (
hªdËr
->
fd
);

593 
	`mem£t
(&
hªdËr
->
loÿl
, 0, (handler->local));

594 
hªdËr
->
loÿl
.
Æ_çmy
 = 
AF_NETLINK
;

595 
hªdËr
->
loÿl
.
Æ_groups
 = 0;

597 ià(
	`bšd
(
hªdËr
->
fd
, (
sockaddr
*)&hªdËr->
loÿl
,

598 (
hªdËr
->
loÿl
)) < 0)

599  -
”ºo
;

601 
sockËn
 = (
hªdËr
->
loÿl
);

602 ià(
	`g‘sockÇme
(
hªdËr
->
fd
, (
sockaddr
*)&hªdËr->
loÿl
,

603 &
sockËn
) < 0)

604  -
”ºo
;

606 ià(
sockËn
 !ğ(
hªdËr
->
loÿl
))

607  -
EINVAL
;

609 ià(
hªdËr
->
loÿl
.
Æ_çmy
 !ğ
AF_NETLINK
)

610  -
EINVAL
;

612 
hªdËr
->
£q
 = 
	`time
(
NULL
);

615 
	}
}

617 
	$Ãšk_şo£
(
Æ_hªdËr
 *
hªdËr
)

619 
	`şo£
(
hªdËr
->
fd
);

620 
hªdËr
->
fd
 = -1;

622 
	}
}

	@get_link/nl.h

7 #iâdeà
MATRIX_NL_H


8 
	#MATRIX_NL_H


	)

10 
	~<¡ddef.h
>

11 
	~<lšux/Ãšk.h
>

12 
	~<lšux/¹Ãšk.h
>

16 #iâdeà
PAGE_SIZE


17 
	#PAGE_SIZE
 4096

	)

19 
	#NLMSG_GOOD_SIZE
 (2*
PAGE_SIZE
)

	)

20 
	#NLMSG_TAIL
(
nmsg
) \

21 ((
¹©Œ
 *è(((*è(
nmsg
)è+ 
	`NLMSG_ALIGN
(Òmsg)->
Æmsg_Ën
)))

	)

22 
	#NLA_DATA
(
Ç
è((*)((*)Òaè+ 
NLA_HDRLEN
))

	)

23 
	#NLA_NEXT_ATTR
(
©Œ
è((*)((*ï‰rè+ 
	`NLA_ALIGN
×‰r->
Æa_Ën
))

	)

35 
	sÆ_hªdËr
 {

36 
	mfd
;

37 
	m£q
;

38 
sockaddr_Æ
 
	mloÿl
;

39 
sockaddr_Æ
 
	m³”
;

50 
	sÆmsg
 {

51 
Æmsghdr
 *
	mÆmsghdr
;

52 
ssize_t
 
	mÿp
;

66 
Ãšk_İ’
(
Æ_hªdËr
 *
hªdËr
, 
´ÙocŞ
);

76 
Ãšk_şo£
(
Æ_hªdËr
 *
hªdËr
);

89 
Ãšk_rcv
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *Æmsg, 
Ën
);

100 
Ãšk_£nd
(
Æ_hªdËr
 *
hªdËr
, 
Æmsg
 *nlmsg);

113 
Ãšk_Œª§ùiÚ
(
Æ_hªdËr
 *
hªdËr
,

114 
Æmsg
 *
»que¡
, Æmsg *
ªw£r
);

126 
Æa_put_¡ršg
(
Æmsg
 *Æmsg, 
©Œ
, cÚ¡ *
¡ršg
);

139 
Æa_put_bufãr
(
Æmsg
 *Æmsg, 
©Œ
,

140 cÚ¡ *
d©a
, 
size_t
 
size
);

151 
Æa_put_u32
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
);

162 
Æa_put_u16
(
Æmsg
 *Æmsg, 
©Œ
, 
v®ue
);

172 
Æa_put_©Œ
(
Æmsg
 *Æmsg, 
©Œ
);

183 
¹©Œ
 *
Æa_begš_Ã¡ed
(
Æmsg
 *Æmsg, 
©Œ
);

193 
Æa_’d_Ã¡ed
(
Æmsg
 *Æmsg, 
¹©Œ
 *
©Œ
);

210 
Æmsg
 *
Æmsg_®loc
(
size_t
 
size
);

219 
Æmsg
 *
Æmsg_®loc_»£rve
(
size_t
 
size
);

229 *
Æmsg_»£rve
(
Æmsg
 *Æmsg, 
size_t
 
Ën
);

236 
Æmsg_ä“
(
Æmsg
 *nlmsg);

245 *
Æmsg_d©a
(
Æmsg
 *nlmsg);

247 
Ãšk_Œª§ùiÚ_g‘šfo
(
Æ_hªdËr
 *
hªdËr
,
Æmsg
 *
»que¡
, Æmsg *
ªsw”
);

	@getaddr/getaddr.c

8 
	~<lšux/ty³s.h
>

9 
	~<asm/ty³s.h
>

10 
	~<š‰y³s.h
>

11 
	~<sys/fe.h
>

12 
	~<sys/u£r.h
>

13 
	~<sys/sock‘.h
>

14 
	~<lšux/Ãšk.h
>

15 
	~<lšux/¹Ãšk.h
>

16 
	~<lšux/if.h
>

17 
	~<uni¡d.h
>

18 
	~<¡dlib.h
>

19 
	~<¡ršg.h
>

20 
	~<¡dio.h
>

21 
	~<¡dboŞ.h
>

22 
	~<”ºo.h
>

23 
	~<sys/sock‘.h
>

24 
	~<asm/ty³s.h
>

25 
	~<lšux/Ãšk.h
>

27 
	~<Ãt/if.h
>

28 
ušt32_t
 
	tu32
;

29 
ušt16_t
 
	tu16
;

31 
	sÆsock
 {

32 
	msock
;

33 
	m£q
;

34 
sockaddr_Æ
 
	m¢l
;

35 *
	mÇme
;

36 } 
	gÆ_cmd
 = { -1, 0, {0}, "netlink-cmd" };

38 
	gšdex_oif
 = 0;

39 
	sÆ_if_šfo
 {

40 
u32
 
	maddr
;

41 *
	mÇme
;

46 
	$Æ_sock‘
(
Æsock
 *
Æ
, 
groups
)

48 
»t
 = 0;

49 
sockaddr_Æ
 
¢l
;

50 
sock
;

51 
Çm–’
;

54 
sock
 = 
	`sock‘
(
AF_NETLINK
, 
SOCK_RAW
, 
NETLINK_ROUTE
);

55 ià(
sock
 < 0)

57 
	`årštf
(
¡d”r
, "Cª'ˆİ’ % sock‘: %s", 
Æ
->
Çme
,
	`¡»¼Ü
(
”ºo
));

61 
»t
 = 
	`fú
(
sock
, 
F_SETFL
, 
O_NONBLOCK
 );

62 ià(
»t
 < 0)

64 
	`årštf
Ğ
¡d”r
, "Cª'ˆ£ˆ% sock‘ fÏgs: %s", 
Æ
->
Çme
, 
	`¡»¼Ü
(
”ºo
));

65 
	`şo£
 (
sock
);

69 
	`mem£t
 (&
¢l
, 0, (snl));

70 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

71 
¢l
.
Æ_groups
 = 
groups
;

74 
»t
 = 
	`bšd
(
sock
, (
sockaddr
 *)&
¢l
, (snl));

75 iàĞ
»t
 < 0 )

77 
	`årštf
 (
¡d”r
, "Cª'ˆbšd % sock‘Øgrou°0x%x: %s", 
Æ
->
Çme
, 
¢l
.
Æ_groups
, 
	`¡»¼Ü
 ( 
”ºo
 ) );

78 
	`şo£
 ( 
sock
 );

83 
Çm–’
 = (
¢l
);

84 
»t
 = 
	`g‘sockÇme
(
sock
, (
sockaddr
 * )&
¢l
, &
Çm–’
);

85 ià(
»t
 < 0 || 
Çm–’
 !ğ(
¢l
))

87 
	`årštf
(
¡d”r
, "Cª'ˆg‘ % sock‘‚ame: %s", 
Æ
->
Çme
, 
	`¡»¼Ü
(
”ºo
));

88 
	`şo£
(
sock
);

92 
Æ
->
¢l
 = snl;

93 
Æ
->
sock
 = sock;

94  
»t
;

95 
	}
}

97 
	$Æ_»que¡
(
çmy
, 
ty³
, 
Æsock
 *
Æ
)

99 
»t
;

100 
sockaddr_Æ
 
¢l
;

103 
Æmsghdr
 
Æh
;

104 
¹g’msg
 
g
;

105 } 
»q
;

109 ià(
Æ
->
sock
 < 0 )

111 
	`årštf
 ( 
¡d”r
, "% sock‘ i¢'ˆaùive.", 
Æ
->
Çme
 );

115 
	`mem£t
 ( &
¢l
, 0, (snl));

116 
¢l
.
Æ_çmy
 = 
AF_NETLINK
;

118 
»q
.
Æh
.
Æmsg_Ën
 = (req);

119 
»q
.
Æh
.
Æmsg_ty³
 = 
ty³
;

120 
»q
.
Æh
.
Æmsg_æags
 = 
NLM_F_ROOT
 | 
NLM_F_MATCH
 | 
NLM_F_REQUEST
;

121 
»q
.
Æh
.
Æmsg_pid
 = 0;

122 
»q
.
Æh
.
Æmsg_£q
 = ++
Æ
->
£q
;

123 
»q
.
g
.
¹g’_çmy
 = 
çmy
;

125 
»t
 = 
	`£ndto
(
Æ
->
sock
, (*)&
»q
, „eq, 0, (
sockaddr
*)&
¢l
, (snl));

126 ià(
»t
 < 0)

128 
	`årštf
(
¡d”r
, "% £ndtØçed: %s", 
Æ
->
Çme
, 
	`¡»¼Ü
 ( 
”ºo
 ) );

132 
	}
}

136 
Æ_·r£_šfo
 ( Ğ*
f‹r
 ) ( 
sockaddr_Æ
 *, 
Æmsghdr
 *, * ),

137 
Æsock
 *
Æ
, *
¬g
 )

139 
¡©us
;

140 
»t
 = 0;

141 
”rÜ
;

145 
buf
[4096];

146 
iovec
 
iov
 = { 
buf
,  buf };

147 
sockaddr_Æ
 
¢l
;

148 
msghdr
 
msg
 = {(*)&
¢l
, (¢l), &
iov
, 1, 
NULL
, 0, 0};

149 
Æmsghdr
 *
h
;

151 
¡©us
 = 
	`»cvmsg
(
Æ
->
sock
, &
msg
, 0 );

153 ià(
¡©us
 < 0)

155 
	`´štf
("get messageƒrror\r\n");

156 ià(
”ºo
 =ğ
EINTR
 )

158 iàĞ
”ºo
 =ğ
EWOULDBLOCK
 ||ƒ¼nØ=ğ
EAGAIN
 )

160 
	`´štf
("no message\r\n");

163 
	`årštf
 ( 
¡d”r
, "% »cvmsg ov”run", 
Æ
->
Çme
 );

167 ià(
¢l
.
Æ_pid
 != 0)

169 
	`årštf
 ( 
¡d”r
, "IgnÜšg‚Ú k”ÃÈmes§gäom…id %u",
¢l
.
Æ_pid
 );

173 ià(
¡©us
 == 0)

175 
	`årštf
 ( 
¡d”r
, "% EOF", 
Æ
->
Çme
 );

179 iàĞ
msg
.
msg_Çm–’
 !ğ(
¢l
))

181 
	`årštf
 ( 
¡d”r
, "% £nd”‡dd»s Ëngthƒ¼Ü:†’gth %d",
Æ
->
Çme
, 
msg
.
msg_Çm–’
 );

185 
h
 = (
Æmsghdr
 * )
buf
; 
	`NLMSG_OK
(h, 
¡©us
); h = 
	`NLMSG_NEXT
(h, status))

188 ià(
h
->
Æmsg_ty³
 =ğ
NLMSG_DONE
)

189  
»t
;

192 iàĞ
h
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
 )

194 
Æmsg”r
 *
”r
 = (Æmsg”¸* )
	`NLMSG_DATA
(
h
);

197 iàĞ
”r
->
”rÜ
 == 0 )

200 ià(!(
h
->
Æmsg_æags
 & 
NLM_F_MULTI
))

207 iàĞ
h
->
Æmsg_Ën
 < 
	`NLMSG_LENGTH
((
Æmsg”r
)))

209 
	`årštf
(
¡d”r
, "% ”rÜ: mes§gŒunÿ‹d", 
Æ
->
Çme
 );

212 
	`årštf
(
¡d”r
, "%sƒrror: %s,ype=%u, seq=%u,…id=%d",

213 
Æ
->
Çme
, 
	`¡»¼Ü
 ( -
”r
->
”rÜ
 ),

214 
”r
->
msg
.
Æmsg_ty³
,ƒ¼->msg.
Æmsg_£q
,

215 
”r
-> 
msg
.
Æmsg_pid
 );

223 iàĞ
Æ
 !ğ&
Æ_cmd
 && 
h
->
Æmsg_pid
 =ğÆ_cmd.
¢l
.
Æ_pid
 ) {

227 
”rÜ
 = (*
f‹r
)(&
¢l
, 
h
, 
¬g
);

228 ià(
”rÜ
 < 0)

230 
	`årštf
(
¡d”r
, "% f‹¸àunùiÚƒ¼Ü/n", 
Æ
->
Çme
 );

231 
»t
 = 
”rÜ
;

236 iàĞ
msg
.
msg_æags
 & 
MSG_TRUNC
 )

238 
	`årštf
 ( 
¡d”r
, "% ”rÜ: mes§gŒunÿ‹d", 
Æ
->
Çme
 );

241 ià(
¡©us
)

243 
	`årštf
(
¡d”r
, "% ”rÜ: d©¨»mÇÁ siz%d", 
Æ
->
Çme
,
¡©us
 );

247  
»t
;

248 
	}
}

250 
	$Æ_·r£_¹©Œ
 ( 
¹©Œ
 **
tb
, 
max
, ¹©Œ *
¹a
, 
Ën
 )

252 
	`RTA_OK
(
¹a
, 
Ën
 ))

254 ià(
¹a
->
¹a_ty³
 <ğ
max
 )

255 
tb
[
¹a
->
¹a_ty³
] =„ta;

256 
¹a
 = 
	`RTA_NEXT
Ô, 
Ën
);

258 
	}
}

260 
	$Æ_g‘_oif
 ( 
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

262 
Ën
;

263 
¹msg
 *
¹m
;

264 
¹©Œ
 *
tb
 [
RTA_MAX
 + 1];

265 
u_ch¬
 
æags
 = 0;

267 
ªyaddr
[16] = {0};

269 
šdex
;

270 
bË
;

271 *
de¡
;

272 *
g©e
;

274 
¹m
 =(
¹msg
 *)
	`NLMSG_DATA
(
h
);

276 iàĞ
h
->
Æmsg_ty³
 !ğ
RTM_NEWROUTE
 )

278 iàĞ
¹m
->
¹m_ty³
 !ğ
RTN_UNICAST
 )

281 
bË
 = 
¹m
->
¹m_bË
;

283 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
 (  ( 
¹msg
 ) );

284 iàĞ
Ën
 < 0 )

287 
	`mem£t
 (
tb
, 0, b );

288 
	`Æ_·r£_¹©Œ
(
tb
, 
RTA_MAX
, 
	`RTM_RTA
(
¹m
), 
Ën
);

290 iàĞ
¹m
->
¹m_æags
 & 
RTM_F_CLONED
 )

292 iàĞ
¹m
->
¹m_´ÙocŞ
 =ğ
RTPROT_REDIRECT
 )

294 iàĞ
¹m
->
¹m_´ÙocŞ
 =ğ
RTPROT_KERNEL
 )

297 iàĞ
¹m
->
¹m_¤c_Ën
 != 0 )

304 iàĞ
tb
[
RTA_OIF
] ) {

305 
šdex
 = *Ğ*)
	`RTA_DATA
(
tb
[
RTA_OIF
]);

308 ià(
tb
[
RTA_DST
] )

309 
de¡
 = 
	`RTA_DATA
(
tb
[
RTA_DST
]);

311 
de¡
 = 
ªyaddr
;

314 iàĞ
tb
[
RTA_GATEWAY
] )

315 
g©e
 = 
	`RTA_DATA
 ( 
tb
[
RTA_GATEWAY
] );

321 iàĞ
de¡
 =ğ
ªyaddr
 && 
g©e
 ) {

322 iàĞ
¬g
 !ğ
NULL
 ) {

323 * ( * ) 
¬g
 = 
šdex
;

327 
	`´štf
("rou‹r: %d % %s\r\n", 
šdex
, 
de¡
, 
g©e
);

329 
	}
}

332 cÚ¡ *
	$¹_addr_n2a
(
af
, 
Ën
, cÚ¡ *
addr
, *
buf
, 
buæ’
)

334 
af
) {

335 
AF_INET
:

336 
AF_INET6
:

337  
	`š‘_Áİ
(
af
, 
addr
, 
buf
, 
buæ’
);

341 
	}
}

342 
	$Æ_g‘_if_addr
(
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

344 
Ën
;

345 
içddrmsg
 *
iç
;

346 
¹©Œ
 *
tb
[
IFA_MAX
 + 1];

347 *
addr
 = 
NULL
;

348 *
brßd
 = 
NULL
;

349 
u_ch¬
 
æags
 = 0;

350 *
Ïb–
 = 
NULL
;

351 
u32
 
iç_addr
, 
iç_loÿl
;

352 
iç_Ïb–
[
IFNAMSIZ
 + 1];

355 
š‹r_addr
[128] = {0};

356 
loÿl_addr
[128] = {0};

359 
iç
 = (
içddrmsg
 *)
	`NLMSG_DATA
(
h
);

360 ià(
iç
->
iç_çmy
 !ğ
AF_INET
 )

365 ià(
h
->
Æmsg_ty³
 !ğ
RTM_NEWADDR
 && h->Æmsg_ty³ !ğ
RTM_DELADDR
 )

369 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
((
içddrmsg
));

370 iàĞ
Ën
 < 0 )

373 
	`mem£t
(
tb
, 0, (tb));

375 
	`Æ_·r£_¹©Œ
(
tb
, 
IFA_MAX
, 
	`IFA_RTA
(
iç
), 
Ën
 );

377 if(
tb
[
IFA_ADDRESS
] =ğ
NULL
)

379 
tb
[
IFA_ADDRESS
] =b[
IFA_LOCAL
];

380 
	`´štf
("ifa_addres is‚ull\r\n");

383 if(
tb
[
IFA_ADDRESS
])

384 
iç_addr
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]);

387 if(
tb
[
IFA_LOCAL
])

388 
iç_loÿl
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_LOCAL
]);

391 if(
tb
[
IFA_LABEL
])

392 
	`¡ºıy
(
iç_Ïb–
, 
	`RTA_DATA
(
tb
[
IFA_LABEL
]), 
IFNAMSIZ
);

393 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

394 
	`RTA_PAYLOAD
(
tb
[
IFA_ADDRESS
]),

395 
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]),

396 
š‹r_addr
, (inter_addr));

398 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

399 
	`RTA_PAYLOAD
(
tb
[
IFA_LOCAL
]),

400 
	`RTA_DATA
(
tb
[
IFA_LOCAL
]),

401 
loÿl_addr
, (local_addr));

403 
	`´štf
("addr=%08x†ßl=%08x‚ame=% \r\n", 
iç_addr
, 
iç_loÿl
, 
iç_Ïb–
);

404 
	`´štf
("addr=%s/%d†ßl=% Çme=% \r\n", 
š‹r_addr
, ()
iç
->
iç_´efixËn
, 
loÿl_addr
, 
iç_Ïb–
);

405 
	`´štf
("end\r\n");

407 
	}
}

409 
	$Æ_g‘_lšk
(
sockaddr_Æ
 *
¢l
, 
Æmsghdr
 *
h
, *
¬g
 )

411 
Ën
;

412 
ifšfomsg
 *
iç
;

413 
¹©Œ
 *
tb
[
IFA_MAX
 + 1];

414 *
addr
 = 
NULL
;

415 *
brßd
 = 
NULL
;

416 
u_ch¬
 
æags
 = 0;

417 *
Ïb–
 = 
NULL
;

418 
u32
 
iç_addr
, 
iç_loÿl
;

419 
iç_Ïb–
[
IFNAMSIZ
 + 1];

421 
š‹r_addr
[128] = {0};

422 
loÿl_addr
[128] = {0};

424 
iç
 = (
içddrmsg
 *)
	`NLMSG_DATA
(
h
);

425 ià(
iç
->
ifi_çmy
 !ğ
AF_INET
 ) {

426 
	`´štf
("faimilyƒrror\r\n");

429 
	`if_šdextÚame
(
iç
->
ifi_šdex
, 
iç_ÏbË
);

430 
	`´štf
("Çmi %s\r\n", 
iç_ÏbË
);

432 ià(
h
->
Æmsg_ty³
 !ğ
RTM_NEWADDR
 && h->Æmsg_ty³ !ğ
RTM_DELADDR
 )

435 
Ën
 = 
h
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
((
ifšfomsg
));

436 iàĞ
Ën
 < 0 )

439 
	`mem£t
(
tb
, 0, (tb));

441 
	`Æ_·r£_¹©Œ
(
tb
, 
IFA_MAX
, 
	`IFA_RTA
(
iç
), 
Ën
 );

443 if(
tb
[
IFA_ADDRESS
] =ğ
NULL
)

445 
tb
[
IFA_ADDRESS
] =b[
IFA_LOCAL
];

446 
	`´štf
("ifa_addres is‚ull\r\n");

449 if(
tb
[
IFA_ADDRESS
])

450 
iç_addr
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]);

453 if(
tb
[
IFA_LOCAL
])

454 
iç_loÿl
 = *(
u32
 *)
	`RTA_DATA
(
tb
[
IFA_LOCAL
]);

457 if(
tb
[
IFA_LABEL
])

458 
	`¡ºıy
(
iç_Ïb–
, 
	`RTA_DATA
(
tb
[
IFA_LABEL
]), 
IFNAMSIZ
);

459 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

460 
	`RTA_PAYLOAD
(
tb
[
IFA_ADDRESS
]),

461 
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]),

462 
š‹r_addr
, (inter_addr));

464 
	`¹_addr_n2a
(
iç
->
iç_çmy
,

465 
	`RTA_PAYLOAD
(
tb
[
IFA_LOCAL
]),

466 
	`RTA_DATA
(
tb
[
IFA_LOCAL
]),

467 
loÿl_addr
, (local_addr));

469 
	`´štf
("addr=%08x†ßl=%08x‚ame=% \r\n", 
iç_addr
, 
iç_loÿl
, 
iç_Ïb–
);

470 
	`´štf
("addr=%s/%d†ßl=% Çme=% \r\n", 
š‹r_addr
, ()
iç
->
iç_´efixËn
, 
loÿl_addr
, 
iç_Ïb–
);

471 
	`´štf
("end\r\n");

474 
	}
}

476 
	$maš
()

478 
»t
;

479 
if_Çme
[
PAGE_SIZE
];

480 *
p
;

481 
Æ_if_šfo
 
if_šfo
 = { -1, "eth0" };

483 
»t
 = 
	`Æ_sock‘
(&
Æ_cmd
, 0);

484 ià(
»t
 < 0)

486 
	`´štf
("crate sockerƒrror\r\n");

487  
»t
;

491 
»t
 = 
	`Æ_»que¡
(
AF_INET
, 
RTM_GETROUTE
, &
Æ_cmd
);

492 iàĞ
»t
 < 0 ) {

493  
»t
;

495 
»t
 = 
	`Æ_·r£_šfo
(
Æ_g‘_oif
, &
Æ_cmd
, &
šdex_oif
);

496 iàĞ
»t
 < 0 )

497  
»t
;

499 
	`´štf
 ( "oif=%08x /n", 
šdex_oif
 );

500 iàĞ
šdex_oif
 > 0 ) {

501 
p
 = 
	`if_šdextÚame
 ( 
šdex_oif
, 
if_Çme
 );

502 iàĞ
p
 ) {

503 
	`´štf
 ( "š‹rçû=%s/n", 
p
 );

508 
»t
 = 
	`Æ_»que¡
(
AF_INET
, 
RTM_GETADDR
, &
Æ_cmd
);

509 iàĞ
»t
 < 0 )

510  
»t
;

512 
»t
 = 
	`Æ_·r£_šfo
(
Æ_g‘_if_addr
, &
Æ_cmd
, &
if_šfo
 );

513 ià(
»t
 < 0)

514  
»t
;

516 
»t
 = 
	`Æ_»que¡
(
AF_INET
, 
RTM_GETLINK
, &
Æ_cmd
);

517 iàĞ
»t
 < 0 )

518  
»t
;

520 
»t
 = 
	`Æ_·r£_šfo
(
Æ_g‘_lšk
, &
Æ_cmd
, &
if_šfo
 );

521 ià(
»t
 < 0)

522  
»t
;

526 
	}
}

	@interface/net-tools/arp.c

55 
	~<sys/ty³s.h
>

56 
	~<sys/sock‘.h
>

57 
	~<sys/ioùl.h
>

58 
	~<Ãt/if.h
>

61 
	~<Ãt/if_¬p.h
>

62 
	~<¡dlib.h
>

63 
	~<¡dio.h
>

64 
	~<”ºo.h
>

65 
	~<ùy³.h
>

66 
	~<fú.h
>

67 
	~<¡ršg.h
>

68 
	~<g‘İt.h
>

69 
	~<uni¡d.h
>

70 
	~"Ãt-suµÜt.h
"

71 
	~"·thÇmes.h
"

72 
	~"v”siÚ.h
"

73 
	~"cÚfig.h
"

74 
	~"š.h
"

75 
	~"ut.h
"

77 
	#DFLT_AF
 "š‘"

	)

78 
	#DFLT_HW
 "‘h”"

	)

80 
	#FEATURE_ARP


	)

81 
	~"lib/Ãt-ã©u»s.h
"

83 *
	gR–—£
 = 
RELEASE
, *
	gV”siÚ
 = "arp 1.88 (2001-04-04)";

85 
	gİt_n
 = 0;

86 
	gİt_N
 = 0;

87 
	gİt_v
 = 0;

88 
	gİt_D
 = 0;

89 
	gİt_e
 = 0;

90 
	gİt_a
 = 0;

91 
aáy³
 *
	g­
;

92 
hwty³
 *
	ghw
;

93 
	gsockfd
 = 0;

94 
	ghw_£t
 = 0;

95 
	gdeviû
[16] = "";

96 
u§ge
();

99 
	$¬p_d–
(**
¬gs
)

101 
ho¡
[128];

102 
¬´eq
 
»q
;

103 
sockaddr_¡Üage
 
ss
;

104 
sockaddr
 *
§
;

105 
æags
 = 0;

106 
d–‘ed
 = 0;

108 
	`mem£t
((*è&
»q
, 0, (req));

111 ià(*
¬gs
 =ğ
NULL
) {

112 
	`årštf
(
¡d”r
, 
	`_
("arp:‚eed host‚ame\n"));

115 
	`§ã_¡ºıy
(
ho¡
, *
¬gs
, ( host));

116 
§
 = (
sockaddr
 *)&
ss
;

117 ià(
­
->
	`šput
(0, 
ho¡
, 
§
) < 0) {

118 
­
->
	`h”rÜ
(
ho¡
);

122 
	`memıy
((*è&
»q
.
¬p_·
, (*è
§
, (
sockaddr
));

124 ià(
hw_£t
)

125 
»q
.
¬p_ha
.
§_çmy
 = 
hw
->
ty³
;

127 
»q
.
¬p_æags
 = 
ATF_PERM
;

128 
¬gs
++;

129 *
¬gs
 !ğ
NULL
) {

130 ià(
İt_v
)

131 
	`årštf
(
¡d”r
, "¬gs=%s\n", *
¬gs
);

132 ià(!
	`¡rcmp
(*
¬gs
, "pub")) {

133 
æags
 |= 1;

134 
¬gs
++;

137 ià(!
	`¡rcmp
(*
¬gs
, "priv")) {

138 
æags
 |= 2;

139 
¬gs
++;

142 ià(!
	`¡rcmp
(*
¬gs
, "temp")) {

143 
»q
.
¬p_æags
 &ğ~
ATF_PERM
;

144 
¬gs
++;

147 ià(!
	`¡rcmp
(*
¬gs
, "trail")) {

148 
»q
.
¬p_æags
 |ğ
ATF_USETRAILERS
;

149 
¬gs
++;

152 ià(!
	`¡rcmp
(*
¬gs
, "dontpub")) {

153 #ifdeà
ATF_DONTPUB


154 
»q
.
¬p_æags
 |ğ
ATF_DONTPUB
;

156 
	`ENOSUPP
("arp", "ATF_DONTPUB");

158 
¬gs
++;

161 ià(!
	`¡rcmp
(*
¬gs
, "auto")) {

162 #ifdeà
ATF_MAGIC


163 
»q
.
¬p_æags
 |ğ
ATF_MAGIC
;

165 
	`ENOSUPP
("arp", "ATF_MAGIC");

167 
¬gs
++;

170 ià(!
	`¡rcmp
(*
¬gs
, "dev")) {

171 ià(*++
¬gs
 =ğ
NULL
)

172 
	`u§ge
();

173 
	`§ã_¡ºıy
(
deviû
, *
¬gs
, (device));

174 
¬gs
++;

177 ià(!
	`¡rcmp
(*
¬gs
, "netmask")) {

178 ià(*++
¬gs
 =ğ
NULL
)

179 
	`u§ge
();

180 ià(
	`¡rcmp
(*
¬gs
, "255.255.255.255") != 0) {

181 
	`¡rıy
(
ho¡
, *
¬gs
);

182 ià(
­
->
	`šput
(0, 
ho¡
, 
§
) < 0) {

183 
­
->
	`h”rÜ
(
ho¡
);

186 
	`memıy
((*è&
»q
.
¬p_Ãtmask
, (*è
§
,

187 (
sockaddr
));

188 
»q
.
¬p_æags
 |ğ
ATF_NETMASK
;

190 
¬gs
++;

193 
	`u§ge
();

197 ià(
æags
 == 0)

198 
æags
 = 3;

200 
	`¡rıy
(
»q
.
¬p_dev
, 
deviû
);

205 
d–‘ed
 = 0;

208 ià(
æags
 & 2) {

209 ià(
İt_v
)

210 
	`årštf
(
¡d”r
, "arp: SIOCDARP(dontpub)\n");

211 ià(
	`ioùl
(
sockfd
, 
SIOCDARP
, &
»q
) < 0) {

212 ià((
”ºo
 =ğ
ENXIO
è|| (”ºØ=ğ
ENOENT
)) {

213 ià(
æags
 & 1)

214 
dÚub
;

215 
	`´štf
(
	`_
("NØARPƒÁry fÜ %s\n"), 
ho¡
);

218 
	`³¼Ü
("SIOCDARP(dontpub)");

221 
d–‘ed
 = 1;

223 ià(!
d–‘ed
 && (
æags
 & 1)) {

224 
dÚub
:

225 
»q
.
¬p_æags
 |ğ
ATF_PUBL
;

226 ià(
İt_v
)

227 
	`årštf
(
¡d”r
, "arp: SIOCDARP(pub)\n");

228 ià(
	`ioùl
(
sockfd
, 
SIOCDARP
, &
»q
) < 0) {

229 ià((
”ºo
 =ğ
ENXIO
è|| (”ºØ=ğ
ENOENT
)) {

230 
	`´štf
(
	`_
("NØARPƒÁry fÜ %s\n"), 
ho¡
);

233 
	`³¼Ü
("SIOCDARP(pub)");

238 
	}
}

241 
	$¬p_g‘devhw
(*
iâame
, 
sockaddr
 *
§
, 
hwty³
 *
hw
)

243 
iäeq
 
iä
;

244 
hwty³
 *
xhw
;

246 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

247 ià(
	`ioùl
(
sockfd
, 
SIOCGIFHWADDR
, &
iä
) < 0) {

248 
	`årštf
(
¡d”r
, 
	`_
("¬p: cªˆg‘ HW-Add»s fÜ `%s': %s.\n"), 
iâame
, 
	`¡»¼Ü
(
”ºo
));

251 ià(
hw
 && (
iä
.
iä_hwaddr
.
§_çmy
 !ğhw->
ty³
)) {

252 
	`årštf
(
¡d”r
, 
	`_
("arp:…rotocolype mismatch.\n"));

255 
	`memıy
((*è
§
, (*è&(
iä
.
iä_hwaddr
), (
sockaddr
));

257 ià(
İt_v
) {

258 ià(!(
xhw
 = 
	`g‘_hwÁy³
(
iä
.
iä_hwaddr
.
§_çmy
)è|| (xhw->
´št
 == 0)) {

259 
xhw
 = 
	`g‘_hwÁy³
(-1);

261 
	`årštf
(
¡d”r
, 
	`_
("¬p: deviû `%s' ha HW‡dd»s % `%s'.\n"), 
iâame
, 
xhw
->
Çme
, xhw->
	`´št
((*)&
iä
.
iä_hwaddr
.
§_d©a
));

264 
	}
}

267 
	$¬p_£t
(**
¬gs
)

269 
ho¡
[128];

270 
¬´eq
 
»q
;

271 
sockaddr_¡Üage
 
ss
;

272 
sockaddr
 *
§
;

273 
æags
;

275 
	`mem£t
((*è&
»q
, 0, (req));

278 ià(*
¬gs
 =ğ
NULL
) {

279 
	`årštf
(
¡d”r
, 
	`_
("arp:‚eed host‚ame\n"));

282 
	`§ã_¡ºıy
(
ho¡
, *
¬gs
++, ( host));

283 
§
 = (
sockaddr
 *)&
ss
;

284 ià(
­
->
	`šput
(0, 
ho¡
, 
§
) < 0) {

285 
­
->
	`h”rÜ
(
ho¡
);

289 
	`memıy
((*è&
»q
.
¬p_·
, (*è
§
, (
sockaddr
));

292 ià(*
¬gs
 =ğ
NULL
) {

293 
	`årštf
(
¡d”r
, 
	`_
("arp:‚eed hardware‡ddress\n"));

296 ià(
İt_D
) {

297 ià(
	`¬p_g‘devhw
(*
¬gs
++, &
»q
.
¬p_ha
, 
hw_£t
 ? 
hw
 : 
NULL
) < 0)

300 ià(
hw
->
	`šput
(*
¬gs
++, &
»q
.
¬p_ha
) < 0) {

301 
	`årštf
(
¡d”r
, 
	`_
("arp: invalid hardware‡ddress\n"));

307 
æags
 = 
ATF_PERM
 | 
ATF_COM
;

308 *
¬gs
 !ğ
NULL
) {

309 ià(!
	`¡rcmp
(*
¬gs
, "temp")) {

310 
æags
 &ğ~
ATF_PERM
;

311 
¬gs
++;

314 ià(!
	`¡rcmp
(*
¬gs
, "pub")) {

315 
æags
 |ğ
ATF_PUBL
;

316 
¬gs
++;

319 ià(!
	`¡rcmp
(*
¬gs
, "priv")) {

320 
æags
 &ğ~
ATF_PUBL
;

321 
¬gs
++;

324 ià(!
	`¡rcmp
(*
¬gs
, "trail")) {

325 
æags
 |ğ
ATF_USETRAILERS
;

326 
¬gs
++;

329 ià(!
	`¡rcmp
(*
¬gs
, "dontpub")) {

330 #ifdeà
ATF_DONTPUB


331 
æags
 |ğ
ATF_DONTPUB
;

333 
	`ENOSUPP
("arp", "ATF_DONTPUB");

335 
¬gs
++;

338 ià(!
	`¡rcmp
(*
¬gs
, "auto")) {

339 #ifdeà
ATF_MAGIC


340 
æags
 |ğ
ATF_MAGIC
;

342 
	`ENOSUPP
("arp", "ATF_MAGIC");

344 
¬gs
++;

347 ià(!
	`¡rcmp
(*
¬gs
, "dev")) {

348 ià(*++
¬gs
 =ğ
NULL
)

349 
	`u§ge
();

350 
	`§ã_¡ºıy
(
deviû
, *
¬gs
, (device));

351 
¬gs
++;

354 ià(!
	`¡rcmp
(*
¬gs
, "netmask")) {

355 ià(*++
¬gs
 =ğ
NULL
)

356 
	`u§ge
();

357 ià(
	`¡rcmp
(*
¬gs
, "255.255.255.255") != 0) {

358 
	`¡rıy
(
ho¡
, *
¬gs
);

359 ià(
­
->
	`šput
(0, 
ho¡
, 
§
) < 0) {

360 
­
->
	`h”rÜ
(
ho¡
);

363 
	`memıy
((*è&
»q
.
¬p_Ãtmask
, (*è
§
,

364 (
sockaddr
));

365 
æags
 |ğ
ATF_NETMASK
;

367 
¬gs
++;

370 
	`u§ge
();

374 
»q
.
¬p_æags
 = 
æags
;

376 
	`¡rıy
(
»q
.
¬p_dev
, 
deviû
);

379 ià(
İt_v
)

380 
	`årštf
(
¡d”r
, "arp: SIOCSARP()\n");

381 ià(
	`ioùl
(
sockfd
, 
SIOCSARP
, &
»q
) < 0) {

382 
	`³¼Ü
("SIOCSARP");

386 
	}
}

390 
	$¬p_fe
(*
Çme
)

392 
buff
[1024];

393 *
¥
, *
¬gs
[32];

394 
lš’r
, 
¬gc
;

395 
FILE
 *
å
;

397 ià((
å
 = 
	`fİ’
(
Çme
, "r")è=ğ
NULL
) {

398 
	`årštf
(
¡d”r
, 
	`_
("¬p: cªnÙ o³À‘h”f% !\n"), 
Çme
);

402 
lš’r
 = 0;

403 
	`fg‘s
(
buff
, (buff), 
å
è!ğ(*è
NULL
) {

404 
lš’r
++;

405 ià(
İt_v
 == 1)

406 
	`årštf
(
¡d”r
, ">> %s", 
buff
);

407 ià((
¥
 = 
	`¡rchr
(
buff
, '\n')è!ğ(*è
NULL
)

408 *
¥
 = '\0';

409 ià(
buff
[0] == '#' || buff[0] == '\0')

412 
¬gc
 = 
	`g‘¬gs
(
buff
, 
¬gs
);

413 ià(
¬gc
 < 2) {

414 
	`årštf
(
¡d”r
, 
	`_
("arp: formatƒrror on†ine %u ofƒtherfile %s !\n"),

415 
lš’r
, 
Çme
);

418 ià(
	`¡rchr
 (
¬gs
[0], ':'è!ğ
NULL
) {

421 *
ı
;

422 
ı
 = 
¬gs
[1];

423 
¬gs
[1] =‡rgs[0];

424 
¬gs
[0] = 
ı
;

426 ià(
	`¬p_£t
(
¬gs
) != 0)

427 
	`årštf
(
¡d”r
, 
	`_
("arp: cannot setƒntry on†ine %u ofƒtherfile %s !\n"),

428 
lš’r
, 
Çme
);

431 (è
	`fşo£
(
å
);

433 
	}
}

437 
	$¬p_di¥_2
(*
Çme
, 
ty³
, 
¬p_æags
, *
hwa
, *
mask
, *
dev
)

439 
t™Ë
 = 0;

440 
hwty³
 *
xhw
;

441 
æags
[10];

443 
xhw
 = 
	`g‘_hwÁy³
(
ty³
);

444 ià(
xhw
 =ğ
NULL
)

445 
xhw
 = 
	`g‘_hwty³
(
DFLT_HW
);

447 ià(
t™Ë
++ == 0) {

448 
	`´štf
(
	`_
("Address HWtype HWaddress Flags Mask Iface\n"));

451 
æags
[0] = '\0';

452 ià(
¬p_æags
 & 
ATF_COM
)

453 
	`¡rÿt
(
æags
, "C");

454 ià(
¬p_æags
 & 
ATF_PERM
)

455 
	`¡rÿt
(
æags
, "M");

456 ià(
¬p_æags
 & 
ATF_PUBL
)

457 
	`¡rÿt
(
æags
, "P");

458 #ifdeà
ATF_MAGIC


459 ià(
¬p_æags
 & 
ATF_MAGIC
)

460 
	`¡rÿt
(
æags
, "A");

462 #ifdeà
ATF_DONTPUB


463 ià(
¬p_æags
 & 
ATF_DONTPUB
)

464 
	`¡rÿt
(
æags
, "!");

466 ià(
¬p_æags
 & 
ATF_USETRAILERS
)

467 
	`¡rÿt
(
æags
, "T");

469 ià(!(
¬p_æags
 & 
ATF_NETMASK
))

470 
mask
 = "";

472 
	`´štf
("%-23.23  ", 
Çme
);

474 ià(!(
¬p_æags
 & 
ATF_COM
)) {

475 ià(
¬p_æags
 & 
ATF_PUBL
)

476 
	`´štf
("%-8.8s%-20.20s", "*", 
	`_
("<from_interface>"));

478 
	`´štf
("%-8.8s%-20.20s", "", 
	`_
("(incomplete)"));

480 
	`´štf
("%-8.8s%-20.20s", 
xhw
->
Çme
, 
hwa
);

483 
	`´štf
("%-6.6s%-15.15 %s\n", 
æags
, 
mask
, 
dev
);

484 
	}
}

487 
	$¬p_di¥
(*
Çme
, *

, 
ty³
, 
¬p_æags
, *
hwa
, *
mask
, *
dev
)

489 
hwty³
 *
xhw
;

491 
xhw
 = 
	`g‘_hwÁy³
(
ty³
);

492 ià(
xhw
 =ğ
NULL
)

493 
xhw
 = 
	`g‘_hwty³
(
DFLT_HW
);

495 
	`´štf
(
	`_
("% (%sè© "), 
Çme
, 

);

497 ià(!(
¬p_æags
 & 
ATF_COM
)) {

498 ià(
¬p_æags
 & 
ATF_PUBL
)

499 
	`´štf
("<from_interface> ");

501 
	`´štf
(
	`_
("<incomplete> "));

503 
	`´štf
("% [%s] ", 
hwa
, 
xhw
->
Çme
);

506 ià(
¬p_æags
 & 
ATF_NETMASK
)

507 
	`´štf
(
	`_
("Ãtmask % "), 
mask
);

509 ià(
¬p_æags
 & 
ATF_PERM
)

510 
	`´štf
("PERM ");

511 ià(
¬p_æags
 & 
ATF_PUBL
)

512 
	`´štf
("PUB ");

513 #ifdeà
ATF_MAGIC


514 ià(
¬p_æags
 & 
ATF_MAGIC
)

515 
	`´štf
("AUTO ");

517 #ifdeà
ATF_DONTPUB


518 ià(
¬p_æags
 & 
ATF_DONTPUB
)

519 
	`´štf
("DONTPUB ");

521 ià(
¬p_æags
 & 
ATF_USETRAILERS
)

522 
	`´štf
("TRAIL ");

524 
	`´štf
(
	`_
("Ú %s\n"), 
dev
);

525 
	}
}

529 
	$¬p_show
(*
Çme
)

531 
ho¡
[100];

532 
sockaddr_¡Üage
 
ss
;

533 
sockaddr
 *
§
;

534 

[100];

535 
hwa
[100];

536 
mask
[100];

537 
lše
[200];

538 
dev
[100];

539 
ty³
, 
æags
;

540 
FILE
 *
å
;

541 *
ho¡Çme
;

542 
num
, 
’Œ›s
 = 0, 
showed
 = 0;

544 
ho¡
[0] = '\0';

546 
§
 = (
sockaddr
 *)&
ss
;

547 ià(
Çme
 !ğ
NULL
) {

549 
	`§ã_¡ºıy
(
ho¡
, 
Çme
, ( host));

550 ià(
­
->
	`šput
(0, 
ho¡
, 
§
) < 0) {

551 
­
->
	`h”rÜ
(
ho¡
);

554 
	`§ã_¡ºıy
(
ho¡
, 
­
->
	`¥ršt
(
§
, 1), (host));

557 ià((
å
 = 
	`fİ’
(
_PATH_PROCNET_ARP
, "r")è=ğ
NULL
) {

558 
	`³¼Ü
(
_PATH_PROCNET_ARP
);

562 ià(
	`fg‘s
(
lše
, Öše), 
å
è!ğ(*è
NULL
) {

563 
	`¡rıy
(
mask
, "-");

564 
	`¡rıy
(
dev
, "-");

566 ; 
	`fg‘s
(
lše
, Öše), 
å
);) {

567 
num
 = 
	`ssÿnf
(
lše
, "%s 0x%x 0x%x %99s %99s %99s\n",

568 

, &
ty³
, &
æags
, 
hwa
, 
mask
, 
dev
);

569 ià(
num
 < 4)

572 
’Œ›s
++;

574 ià(
hw_£t
 && (
ty³
 !ğ
hw
->type))

578 ià(
ho¡
[0] && 
	`¡rcmp
(

, host))

582 ià(
deviû
[0] && 
	`¡rcmp
(
dev
, device))

585 
showed
++;

587 ià(
İt_n
)

588 
ho¡Çme
 = "?";

590 ià(
­
->
	`šput
(0, 

, 
§
) < 0)

591 
ho¡Çme
 = 

;

593 
ho¡Çme
 = 
­
->
	`¥ršt
(
§
, 
İt_n
 | 0x8000);

594 ià(
	`¡rcmp
(
ho¡Çme
, 

) == 0)

595 
ho¡Çme
 = "?";

598 ià(
İt_e
)

599 
	`¬p_di¥_2
(
ho¡Çme
[0] =ğ'?' ? 

 : ho¡Çme, 
ty³
, 
æags
, 
hwa
, 
mask
, 
dev
);

601 
	`¬p_di¥
(
ho¡Çme
, 

, 
ty³
, 
æags
, 
hwa
, 
mask
, 
dev
);

604 ià(
İt_v
)

605 
	`´štf
(
	`_
("EÁr›s: %d\tSk³d: %d\tFound: %d\n"), 
’Œ›s
,ƒÁr› - 
showed
, showed);

607 ià(!
showed
) {

608 ià(
ho¡
[0] && !
İt_a
)

609 
	`´štf
(
	`_
("% (%sè--‚Ø’Œy\n"), 
Çme
, 
ho¡
);

610 ià(
hw_£t
 || 
ho¡
[0] || 
deviû
[0]) {

611 
	`´štf
(
	`_
("¬p: iÀ%dƒÁr› nØm©ch found.\n"), 
’Œ›s
);

614 (è
	`fşo£
(
å
);

616 
	}
}

618 
	$v”siÚ
()

620 
	`årštf
(
¡d”r
, "%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
F—tu»s
);

621 
	`ex™
(
E_VERSION
);

622 
	}
}

624 
	$u§ge
()

626 
	`årštf
(
¡d”r
, 
	`_
("Usage:\n‡rp [-vn] [<HW>] [-i <if>] [-a] [<hostname>] <-Display ARP cache\n"));

627 
	`årštf
(
¡d”r
, 
	`_
("‡rp [-v] [-i <if>] -d <host> [pub] <-Delete ARPƒntry\n"));

628 
	`årštf
(
¡d”r
, 
	`_
("‡rp [-vnD] [<HW>] [-i <if>] -f [<filename>] <-Addƒntry from file\n"));

629 
	`årštf
(
¡d”r
, 
	`_
("‡rp [-v] [<HW>] [-i <if>] -s <host> <hwaddr> [temp] <-Addƒntry\n"));

630 
	`årštf
(
¡d”r
, 
	`_
("‡rp [-v] [<HW>] [-i <if>] -Ds <host> <if> [netmask <nm>]…ub <-''-\n\n"));

632 
	`årštf
(
¡d”r
, 
	`_
(" -a display (all) hosts in‡lternative (BSD) style\n"));

633 
	`årštf
(
¡d”r
, 
	`_
(" -e display (all) hosts in default (Linux) style\n"));

634 
	`årštf
(
¡d”r
, 
	`_
(" -s, --set set‡‚ew ARPƒntry\n"));

635 
	`årštf
(
¡d”r
, 
	`_
(" -d, --delete delete‡ specifiedƒntry\n"));

636 
	`årštf
(
¡d”r
, 
	`_
(" -v, --verbose be verbose\n"));

637 
	`årštf
(
¡d”r
, 
	`_
(" -n, --numeric don't„esolve‚ames\n"));

638 
	`årštf
(
¡d”r
, 
	`_
(" -i, --device specify‚etwork interface (e.g.ƒth0)\n"));

639 
	`årštf
(
¡d”r
, 
	`_
(" -D, --use-device„ead <hwaddr> from given device\n"));

640 
	`årštf
(
¡d”r
, 
	`_
(" -A, -p, --protocol specify…rotocol family\n"));

641 
	`årštf
(
¡d”r
, 
	`_
(" -f, --file„ead‚ewƒntries from file or from /etc/ethers\n\n"));

643 
	`årštf
(
¡d”r
, 
	`_
(" <HW>=U£ '-H <hw>'Ø¥ecify h¬dw¬add»s ty³. DeçuÉ: %s\n"), 
DFLT_HW
);

644 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible hardwareypes (which support ARP):\n"));

645 
	`´št_hwli¡
(1);

646 
	`ex™
(
E_USAGE
);

647 
	}
}

649 
	$maš
(
¬gc
, **
¬gv
)

651 
i
, 
lİ
, 
wh©
;

652 
İtiÚ
 
lÚgİts
[] =

667 {
NULL
, 0, 0, 0}

670 #ià
I18N


671 
	`£oÿË
 (
LC_ALL
, "");

672 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

673 
	`‹xtdomaš
("net-tools");

677 ià((
hw
 = 
	`g‘_hwty³
(
DFLT_HW
)è=ğ
NULL
) {

678 
	`årštf
(
¡d”r
, 
	`_
("%s: h¬dw¬ty³‚Ù suµÜ‹d!\n"), 
DFLT_HW
);

681 ià((
­
 = 
	`g‘_aáy³
(
DFLT_AF
)è=ğ
NULL
) {

682 
	`årštf
(
¡d”r
, 
	`_
("%s:‡dd»s çmy‚Ù suµÜ‹d!\n"), 
DFLT_AF
);

685 
wh©
 = 0;

689 (
i
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "A:H:adå:n£i:t:vh?DNV", 
lÚgİts
, &
lİ
)è!ğ
EOF
)

690 
i
) {

692 
wh©
 = 1;

693 
İt_a
 = 1;

696 
wh©
 = 2;

699 
wh©
 = 3;

702 
wh©
 = 4;

707 
İt_e
 = 1;

710 
İt_n
 = 
FLAG_NUM
;

713 
İt_D
 = 1;

716 
İt_N
 = 
FLAG_SYM
;

717 
	`årštf
(
¡d”r
, 
	`_
("arp: -N‚ot yet supported.\n"));

720 
İt_v
 = 1;

725 
­
 = 
	`g‘_aáy³
(
İrg
);

726 ià(
­
 =ğ
NULL
) {

727 
	`årštf
(
¡d”r
, 
	`_
("arp: %s: unknown‡ddress family.\n"),

728 
İrg
);

729 
	`ex™
(-1);

734 
hw
 = 
	`g‘_hwty³
(
İrg
);

735 ià(
hw
 =ğ
NULL
) {

736 
	`årštf
(
¡d”r
, 
	`_
("arp: %s: unknown hardwareype.\n"),

737 
İrg
);

738 
	`ex™
(-1);

740 
hw_£t
 = 1;

743 
	`§ã_¡ºıy
(
deviû
, 
İrg
, (device));

747 
	`v”siÚ
();

751 
	`u§ge
();

754 ià(
­
->
af
 !ğ
AF_INET
) {

755 
	`årštf
(
¡d”r
, 
	`_
("arp: %s: kernel only supports 'inet'.\n"),

756 
­
->
Çme
);

757 
	`ex™
(-1);

761 if(
hw_£t
==0)

762 ià((
hw
 = 
	`g‘_hwty³
(
DFLT_HW
)è=ğ
NULL
) {

763 
	`årštf
(
¡d”r
, 
	`_
("%s: h¬dw¬ty³‚Ù suµÜ‹d!\n"), 
DFLT_HW
);

767 ià(
hw
->
®’
 <= 0) {

768 
	`årštf
(
¡d”r
, 
	`_
("arp: %s: hardwareype without ARP support.\n"),

769 
hw
->
Çme
);

770 
	`ex™
(-1);

772 ià((
sockfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

773 
	`³¼Ü
("socket");

774 
	`ex™
(-1);

777 
wh©
) {

779 
İt_e
 = 1;

780 
wh©
 = 
	`¬p_show
(
¬gv
[
İtšd
]);

784 
wh©
 = 
	`¬p_show
(
¬gv
[
İtšd
]);

788 
wh©
 = 
	`¬p_fe
(
¬gv
[
İtšd
] ?‡rgv[optind] : "/etc/ethers");

792 
wh©
 = 
	`¬p_d–
(&
¬gv
[
İtšd
]);

796 
wh©
 = 
	`¬p_£t
(&
¬gv
[
İtšd
]);

800 
	`u§ge
();

803 
	`ex™
(
wh©
);

804 
	}
}

	@interface/net-tools/config.h

22 
	#I18N
 1

	)

29 
	#HAVE_AFUNIX
 1

	)

30 
	#HAVE_AFINET
 1

	)

31 
	#HAVE_AFINET6
 1

	)

32 
	#HAVE_AFIPX
 1

	)

33 
	#HAVE_AFATALK
 1

	)

34 
	#HAVE_AFAX25
 1

	)

35 
	#HAVE_AFNETROM
 1

	)

36 
	#HAVE_AFROSE
 1

	)

37 
	#HAVE_AFX25
 1

	)

38 
	#HAVE_AFECONET
 1

	)

39 
	#HAVE_AFDECÃt
 0

	)

40 
	#HAVE_AFASH
 1

	)

47 
	#HAVE_HWETHER
 1

	)

48 
	#HAVE_HWARC
 1

	)

49 
	#HAVE_HWSLIP
 1

	)

50 
	#HAVE_HWPPP
 1

	)

51 
	#HAVE_HWTUNNEL
 1

	)

52 
	#HAVE_HWSTRIP
 1

	)

53 
	#HAVE_HWTR
 1

	)

54 
	#HAVE_HWAX25
 1

	)

55 
	#HAVE_HWROSE
 1

	)

56 
	#HAVE_HWNETROM
 1

	)

57 
	#HAVE_HWX25
 1

	)

58 
	#HAVE_HWFR
 1

	)

59 
	#HAVE_HWSIT
 1

	)

60 
	#HAVE_HWFDDI
 1

	)

61 
	#HAVE_HWHIPPI
 1

	)

62 
	#HAVE_HWASH
 1

	)

63 
	#HAVE_HWHDLCLAPB
 1

	)

64 
	#HAVE_HWIRDA
 1

	)

65 
	#HAVE_HWEC
 1

	)

66 
	#HAVE_HWEUI64
 1

	)

67 
	#HAVE_HWIB
 1

	)

74 
	#HAVE_FW_MASQUERADE
 1

	)

75 
	#HAVE_IP_TOOLS
 1

	)

76 
	#HAVE_MII
 1

	)

	@interface/net-tools/hostname.c

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<uni¡d.h
>

35 
	~<¡dlib.h
>

36 
	~<g‘İt.h
>

37 
	~<¡ršg.h
>

38 
	~<Ãtdb.h
>

39 
	~<”ºo.h
>

40 
	~<sys/·¿m.h
>

41 
	~<Ãtš‘/š.h
>

42 
	~<¬·/š‘.h
>

43 
	~"cÚfig.h
"

44 
	~"v”siÚ.h
"

45 
	~"../š.h
"

47 #ià
HAVE_AFDECÃt


48 
	~<ÃtdÃt/dn.h
>

51 *
	gR–—£
 = 
RELEASE
, *
	gV”siÚ
 = "hostname 1.100 (2001-04-14)";

53 *
	g´og¿m_Çme
;

54 
	gİt_v
;

56 
£thÇme
(*);

57 
£tdÇme
(*);

58 
showhÇme
(*, );

59 
u§ge
();

60 
v”siÚ
();

61 
£tf’ame
(*, );

63 
	#SETHOST
 1

	)

64 
	#SETDOMAIN
 2

	)

65 
	#SETNODE
 3

	)

67 #ià
HAVE_AFDECÃt


68 
	$£ŠÇme
(*
Âame
)

70 ià(
İt_v
)

71 
	`årštf
(
¡d”r
, 
	`_
("Setting‚odenameo `%s'\n"),

72 
Âame
);

73 ià(
	`£Šod’ame
(
Âame
, 
	`¡¾’
(nname))) {

74 
”ºo
) {

75 
EPERM
:

76 
	`årštf
(
¡d”r
, 
	`_
("%s: you mu¡ broÙØchªgthnodÇme\n"), 
´og¿m_Çme
);

78 
EINVAL
:

79 
	`årštf
(
¡d”r
, 
	`_
("%s:‚amtoØlÚg\n"), 
´og¿m_Çme
);

84 
	`ex™
(1);

86 
	}
}

89 
	$£thÇme
(*
hÇme
)

91 ià(
İt_v
)

92 
	`årštf
(
¡d”r
, 
	`_
("Setting hostnameo `%s'\n"),

93 
hÇme
);

94 ià(
	`£tho¡Çme
(
hÇme
, 
	`¡¾’
(hname))) {

95 
”ºo
) {

96 
EPERM
:

97 
	`årštf
(
¡d”r
, 
	`_
("%s: you mu¡ broÙØchªgthho¡‚ame\n"), 
´og¿m_Çme
);

99 
EINVAL
:

100 
	`årštf
(
¡d”r
, 
	`_
("%s:‚amtoØlÚg\n"), 
´og¿m_Çme
);

103 
	`ex™
(1);

105 
	}
}

107 
	$£tdÇme
(*
dÇme
)

109 ià(
İt_v
)

110 
	`årštf
(
¡d”r
, 
	`_
("Setting domainnameo `%s'\n"),

111 
dÇme
);

112 ià(
	`£tdomašÇme
(
dÇme
, 
	`¡¾’
(dname))) {

113 
”ºo
) {

114 
EPERM
:

115 
	`årštf
(
¡d”r
, 
	`_
("%s: you mu¡ broÙØchªgthdomaš‚ame\n"), 
´og¿m_Çme
);

117 
EINVAL
:

118 
	`årštf
(
¡d”r
, 
	`_
("%s:‚amtoØlÚg\n"), 
´og¿m_Çme
);

121 
	`ex™
(1);

123 
	}
}

125 
	$showhÇme
(*
hÇme
, 
c
)

127 
ho¡’t
 *
hp
;

128 *
p
, **
®Ÿs
;

129 
š_addr
 **

;

131 ià(
İt_v
)

132 
	`årštf
(
¡d”r
, 
	`_
("ResŞvšg `%s' ...\n"), 
hÇme
);

133 ià(!(
hp
 = 
	`g‘ho¡byÇme
(
hÇme
))) {

134 
	`h”rÜ
(
´og¿m_Çme
);

135 
	`ex™
(1);

137 ià(
İt_v
) {

138 
	`årštf
(
¡d”r
, 
	`_
("Result: h_name=`%s'\n"),

139 
hp
->
h_Çme
);

141 
®Ÿs
 = 
hp
->
h_®Ÿ£s
;

142 
®Ÿs
[0])

143 
	`årštf
(
¡d”r
, 
	`_
("Result: h_aliases=`%s'\n"),

144 *
®Ÿs
++);

146 

 = (
š_addr
 **è
hp
->
h_addr_li¡
;

147 

[0])

148 
	`årštf
(
¡d”r
, 
	`_
("Result: h_addr_list=`%s'\n"),

149 
	`š‘_Áß
(**

++));

151 ià(!(
p
 = 
	`¡rchr
(
hp
->
h_Çme
, '.')è&& (
c
 == 'd'))

154 
c
) {

156 
hp
->
h_®Ÿ£s
[0])

157 
	`´štf
("% ", *
hp
->
h_®Ÿ£s
++);

158 
	`´štf
("\n");

161 
hp
->
h_addr_li¡
[0])

162 
	`´štf
("% ", 
	`š‘_Áß
(*(
š_addr
 *è*
hp
->
h_addr_li¡
++));

163 
	`´štf
("\n");

166 
	`´štf
("%s\n", ++
p
);

169 
	`´štf
("%s\n", 
hp
->
h_Çme
);

172 ià(
p
 !ğ
NULL
)

173 *
p
 = '\0';

174 
	`´štf
("%s\n", 
hp
->
h_Çme
);

177 
	}
}

179 
	$£tf’ame
(*
Çme
, 
wh©
)

181 
FILE
 *
fd
;

182 *
p
;

183 
æše
[
MAXHOSTNAMELEN
];

185 ià((
fd
 = 
	`fİ’
(
Çme
, "r")è!ğ
NULL
) {

186 
	`fg‘s
(
æše
, (æše), 
fd
è!ğ
NULL
) {

187 ià((
p
 = 
	`šdex
(
æše
, '\n')è!ğ
NULL
)

188 *
p
 = '\0';

189 ià(
İt_v
)

190 
	`årštf
(
¡d”r
, ">> %s\n", 
æše
);

191 ià(
æše
[0] == '#')

193 
wh©
) {

194 
SETHOST
:

195 
	`£thÇme
(
æše
);

197 
SETDOMAIN
:

198 
	`£tdÇme
(
æše
);

200 #ià
HAVE_AFDECÃt


201 
SETNODE
:

202 
	`£ŠÇme
(
æše
);

207 (è
	`fşo£
(
fd
);

209 
	`årštf
(
¡d”r
, 
	`_
("%s: can't open `%s'\n"),

210 
´og¿m_Çme
, 
Çme
);

211 
	`ex™
(1);

213 
	}
}

215 
	$v”siÚ
()

217 
	`årštf
(
¡d”r
, "%s\n%s\n", 
R–—£
, 
V”siÚ
);

218 
	`ex™
(5);

219 
	}
}

221 
	$u§ge
()

223 
	`årštf
(
¡d”r
, 
	`_
("Usage: hostname [-v] {hostname|-F file} set hostname (from file)\n"));

224 
	`årštf
(
¡d”r
, 
	`_
(" domainname [-v] {nisdomain|-F file} set NIS domainname (from file)\n"));

225 #ià
HAVE_AFDECÃt


226 
	`årštf
(
¡d”r
, 
	`_
("‚odename [-v] {nodename|-F file} set DECnet‚ode‚ame (from file)\n"));

228 
	`årštf
(
¡d”r
, 
	`_
(" hostname [-v] [-d|-f|-s|-a|-i|-y|-n] display formatted‚ame\n"));

229 
	`årštf
(
¡d”r
, 
	`_
(" hostname [-v] display hostname\n\n"));

230 
	`årštf
(
¡d”r
, 
	`_
(" hostname -V|--version|-h|--help…rint info‡ndƒxit\n\n"));

231 
	`årštf
(
¡d”r
, 
	`_
(" dnsdomainname=hostname -d, {yp,nis,}domainname=hostname -y\n\n"));

232 
	`årštf
(
¡d”r
, 
	`_
(" -s, --short short host‚ame\n"));

233 
	`årštf
(
¡d”r
, 
	`_
(" -a, --alias‡lias‚ames\n"));

234 
	`årštf
(
¡d”r
, 
	`_
(" -i, --ip-address‡ddresses forhe hostname\n"));

235 
	`årštf
(
¡d”r
, 
	`_
(" -f, --fqdn, --long†ong host‚ame (FQDN)\n"));

236 
	`årštf
(
¡d”r
, 
	`_
(" -d, --domain DNS domain‚ame\n"));

237 
	`årštf
(
¡d”r
, 
	`_
(" -y, --yp, --nis NIS/YP domainname\n"));

238 #ià
HAVE_AFDECÃt


239 
	`årštf
(
¡d”r
, 
	`_
(" -n, --node DECnet‚ode‚ame\n"));

241 
	`årštf
(
¡d”r
, 
	`_
(" -F, --file„ead hostname or NIS domainname from given file\n\n"));

242 
	`årštf
(
¡d”r
, 
	`_
(

249 
	`ex™
(4);

250 
	}
}

253 
	$maš
(
¬gc
, **
¬gv
)

255 
c
;

256 
ty³
 = '\0';

257 
İtiÚ_šdex
 = 0;

258 
wh©
 = 0;

259 
myÇme
[
MAXHOSTNAMELEN
 + 1] =

261 *
fe
 = 
NULL
;

263 cÚ¡ 
İtiÚ
 
lÚg_İtiÚs
[] =

265 {"domaš", 
no_¬gum’t
, 0, 'd'},

266 {"fe", 
»quœed_¬gum’t
, 0, 'F'},

267 {"fqdn", 
no_¬gum’t
, 0, 'f'},

268 {"h–p", 
no_¬gum’t
, 0, 'h'},

269 {"lÚg", 
no_¬gum’t
, 0, 'f'},

270 {"shÜt", 
no_¬gum’t
, 0, 's'},

271 {"v”siÚ", 
no_¬gum’t
, 0, 'V'},

272 {"v”bo£", 
no_¬gum’t
, 0, 'v'},

273 {"®Ÿs", 
no_¬gum’t
, 0, 'a'},

274 {"-add»ss", 
no_¬gum’t
, 0, 'i'},

275 {"nis", 
no_¬gum’t
, 0, 'y'},

276 {"yp", 
no_¬gum’t
, 0, 'y'},

277 #ià
HAVE_AFDECÃt


278 {"node", 
no_¬gum’t
, 0, 'n'},

282 #ià
I18N


283 
	`£oÿË
 (
LC_ALL
, "");

284 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

285 
	`‹xtdomaš
("net-tools");

287 
´og¿m_Çme
 = (
	`ršdex
(
¬gv
[0], '/')) ?„index(argv[0], '/') + 1 :‡rgv[0];

289 ià(!
	`¡rcmp
(
´og¿m_Çme
, "ypdomainname") ||

290 !
	`¡rcmp
(
´og¿m_Çme
, "domainname") ||

291 !
	`¡rcmp
(
´og¿m_Çme
, "nisdomainname"))

292 
wh©
 = 3;

293 ià(!
	`¡rcmp
(
´og¿m_Çme
, "dnsdomainname"))

294 
wh©
 = 2;

295 #ià
HAVE_AFDECÃt


296 ià(!
	`¡rcmp
(
´og¿m_Çme
, "nodename"))

297 
wh©
 = 4;

300 (
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "adfF:h?isVvyn", 
lÚg_İtiÚs
, &
İtiÚ_šdex
)è!ğ
EOF
)

301 
c
) {

303 
wh©
 = 2;

309 
wh©
 = 1;

310 
ty³
 = 
c
;

313 
wh©
 = 3;

315 #ià
HAVE_AFDECÃt


317 
wh©
 = 4;

321 
fe
 = 
İrg
;

324 
İt_v
++;

327 
	`v”siÚ
();

332 
	`u§ge
();

337 
wh©
) {

339 ià(
fe
 || (
İtšd
 < 
¬gc
)) {

340 
	`årštf
(
¡d”r
, 
	`_
("%s: You cª'ˆchªgthDNS domaš‚amw™hhi commªd\n"), 
´og¿m_Çme
);

341 
	`årštf
(
¡d”r
, 
	`_
("\nUnless you‡re using bind or NIS for host†ookups you can changehe DNS\n"));

342 
	`årštf
(
¡d”r
, 
	`_
("domain‚ame (which is…art ofhe FQDN) inhe /etc/hosts file.\n"));

343 
	`ex™
(1);

345 
ty³
 = 'd';

348 ià(
fe
) {

349 
	`£tf’ame
(
fe
, 
SETHOST
);

352 ià(
İtšd
 < 
¬gc
) {

353 
	`£thÇme
(
¬gv
[
İtšd
]);

357 
	`g‘ho¡Çme
(
myÇme
, (myname));

358 ià(
İt_v
)

359 
	`årštf
(
¡d”r
, 
	`_
("g‘ho¡Çme()=`%s'\n"), 
myÇme
);

360 ià(!
ty³
)

361 
	`´štf
("%s\n", 
myÇme
);

363 
	`showhÇme
(
myÇme
, 
ty³
);

366 ià(
fe
) {

367 
	`£tf’ame
(
fe
, 
SETDOMAIN
);

370 ià(
İtšd
 < 
¬gc
) {

371 
	`£tdÇme
(
¬gv
[
İtšd
]);

374 
	`g‘domašÇme
(
myÇme
, (myname));

375 ià(
İt_v
)

376 
	`årštf
(
¡d”r
, 
	`_
("g‘domašÇme()=`%s'\n"), 
myÇme
);

377 
	`´štf
("%s\n", 
myÇme
);

379 #ià
HAVE_AFDECÃt


381 ià(
fe
) {

382 
	`£tf’ame
(
fe
, 
SETNODE
);

385 ià(
İtšd
 < 
¬gc
) {

386 
	`£ŠÇme
(
¬gv
[
İtšd
]);

389 
	`g‘nod’ame
(
myÇme
, (myname));

390 ià(
İt_v
)

391 
	`årštf
(
¡d”r
, 
	`_
("g‘nod’ame()=`%s'\n"), 
myÇme
);

392 
	`´štf
("%s\n", 
myÇme
);

396 
	`ex™
(0);

397 
	}
}

	@interface/net-tools/ifconfig.c

28 
	#DFLT_AF
 "š‘"

	)

30 
	~"cÚfig.h
"

32 
	~<ã©u»s.h
>

33 
	~<sys/ty³s.h
>

34 
	~<sys/sock‘.h
>

35 
	~<sys/ioùl.h
>

36 
	~<Ãtš‘/š.h
>

37 
	~<Ãt/if.h
>

38 
	~<Ãt/if_¬p.h
>

39 
	~<¡dio.h
>

40 
	~<”ºo.h
>

41 
	~<fú.h
>

42 
	~<ùy³.h
>

43 
	~<¡dlib.h
>

44 
	~<¡ršg.h
>

45 
	~<uni¡d.h
>

46 
	~<Ãtdb.h
>

49 
	~<asm/ty³s.h
>

52 #ifdeà
HAVE_HWSLIP


53 
	~<lšux/if_¦.h
>

56 #ià
HAVE_AFINET6


58 #iâdeà
_LINUX_IN6_H


63 
	sš6_iäeq
 {

64 
š6_addr
 
	miä6_addr
;

65 
__u32
 
	miä6_´efixËn
;

66 
	miä6_ifšdex
;

73 #ià
HAVE_AFIPX


74 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

75 
	~<Ãtx/x.h
>

77 
	~"x.h
"

80 
	~"Ãt-suµÜt.h
"

81 
	~"·thÇmes.h
"

82 
	~"v”siÚ.h
"

83 
	~"../š.h
"

84 
	~"š‹rçû.h
"

85 
	~"sock‘s.h
"

86 
	~"ut.h
"

88 *
	gR–—£
 = 
RELEASE
, *
	gV”siÚ
 = "ifconfig 1.42 (2001-04-13)";

90 
	gİt_a
 = 0;

91 
	gİt_v
 = 0;

93 
	gaddr_çmy
 = 0;

96 
g‘_nmbc_·»Á
(*
·»Á
, *
nm
,

97 *
bc
);

98 
£t_if¡©e
(*
·»Á
, 

,

99 
nm
, 
bc
,

100 
æag
);

102 
	$if_´št
(*
iâame
)

104 
»s
;

106 ià(
iã_shÜt
)

107 
	`´štf
(
	`_
("Iface MTU Met RX-OK RX-ERR RX-DRP RX-OVR TX-OK TX-ERR TX-DRP TX-OVR Flg\n"));

109 ià(!
iâame
) {

110 
»s
 = 
	`fÜ_®l_š‹rçûs
(
do_if_´št
, &
İt_a
);

112 
š‹rçû
 *
iã
;

114 
iã
 = 
	`lookup_š‹rçû
(
iâame
);

115 ià(!
iã
) {

118 
»s
 = 
	`do_if_ãtch
(
iã
);

119 ià(
»s
 >= 0)

120 
	`iã_´št
(
iã
);

122  
»s
;

123 
	}
}

126 
	$£t_æag
(*
iâame
, 
æag
)

128 
iäeq
 
iä
;

130 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

131 ià(
	`ioùl
(
skfd
, 
SIOCGIFFLAGS
, &
iä
) < 0) {

132 
	`årštf
(
¡d”r
, 
	`_
("%s: ERROR while getting interface flags: %s\n"),

133 
iâame
, 
	`¡»¼Ü
(
”ºo
));

136 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

137 
iä
.
iä_æags
 |ğ
æag
;

138 ià(
	`ioùl
(
skfd
, 
SIOCSIFFLAGS
, &
iä
) < 0) {

139 
	`³¼Ü
("SIOCSIFFLAGS");

143 
	}
}

146 
	$şr_æag
(*
iâame
, 
æag
)

148 
iäeq
 
iä
;

149 
fd
;

151 ià(
	`¡rchr
(
iâame
, ':')) {

154 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

155 ià(
fd
 < 0) {

156 
	`årštf
(
¡d”r
, 
	`_
("No support for INET onhis system.\n"));

160 
fd
 = 
skfd
;

162 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

163 ià(
	`ioùl
(
fd
, 
SIOCGIFFLAGS
, &
iä
) < 0) {

164 
	`årštf
(
¡d”r
, 
	`_
("%s: ERROR while getting interface flags: %s\n"),

165 
iâame
, 
	`¡»¼Ü
(
”ºo
));

168 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

169 
iä
.
iä_æags
 &ğ~
æag
;

170 ià(
	`ioùl
(
fd
, 
SIOCSIFFLAGS
, &
iä
) < 0) {

171 
	`³¼Ü
("SIOCSIFFLAGS");

175 
	}
}

178 
	$‹¡_æag
(*
iâame
, 
æags
)

180 
iäeq
 
iä
;

181 
fd
;

183 ià(
	`¡rchr
(
iâame
, ':')) {

186 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

187 ià(
fd
 < 0) {

188 
	`årštf
(
¡d”r
, 
	`_
("No support for INET onhis system.\n"));

192 
fd
 = 
skfd
;

194 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

195 ià(
	`ioùl
(
fd
, 
SIOCGIFFLAGS
, &
iä
) < 0) {

196 
	`årštf
(
¡d”r
, 
	`_
("%s: ERROR whileesting interface flags: %s\n"),

197 
iâame
, 
	`¡»¼Ü
(
”ºo
));

200  (
iä
.
iä_æags
 & 
æags
);

201 
	}
}

203 
	$u§ge
()

205 
	`årštf
(
¡d”r
, 
	`_
("Usage:\n ifconfig [-a] [-v] [-s] <interface> [[<AF>] <address>]\n"));

206 #ià
HAVE_AFINET


207 
	`årštf
(
¡d”r
, 
	`_
(" [add <address>[/<prefixlen>]]\n"));

208 
	`årštf
(
¡d”r
, 
	`_
(" [del <address>[/<prefixlen>]]\n"));

209 
	`årštf
(
¡d”r
, 
	`_
(" [[-]broadcast [<address>]] [[-]pointopoint [<address>]]\n"));

210 
	`årštf
(
¡d”r
, 
	`_
(" [netmask <address>] [dstaddr <address>] [tunnel <address>]\n"));

212 #ifdeà
SIOCSKEEPALIVE


213 
	`årštf
(
¡d”r
, 
	`_
(" [outfill <NN>] [keepalive <NN>]\n"));

215 
	`årštf
(
¡d”r
, 
	`_
(" [hw <HW> <address>] [metric <NN>] [mtu <NN>]\n"));

216 
	`årštf
(
¡d”r
, 
	`_
(" [[-]trailers] [[-]arp] [[-]allmulti]\n"));

217 
	`årštf
(
¡d”r
, 
	`_
(" [multicast] [[-]promisc]\n"));

218 
	`årštf
(
¡d”r
, 
	`_
(" [mem_start <NN>] [io_addr <NN>] [irq <NN>] [media <type>]\n"));

219 #ifdeà
HAVE_TXQUEUELEN


220 
	`årštf
(
¡d”r
, 
	`_
(" [txqueuelen <NN>]\n"));

222 #ifdeà
HAVE_DYNAMIC


223 
	`årštf
(
¡d”r
, 
	`_
(" [[-]dynamic]\n"));

225 
	`årštf
(
¡d”r
, 
	`_
(" [up|down] ...\n\n"));

227 
	`årštf
(
¡d”r
, 
	`_
(" <HW>=Hardware Type.\n"));

228 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible hardwareypes:\n"));

229 
	`´št_hwli¡
(0);

230 
	`årštf
(
¡d”r
, 
	`_
(" <AF>=Add»s çmy. DeçuÉ: %s\n"), 
DFLT_AF
);

231 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible‡ddress families:\n"));

232 
	`´št_aæi¡
(0);

233 
	`ex™
(
E_USAGE
);

234 
	}
}

236 
	$v”siÚ
()

238 
	`årštf
(
¡d”r
, "%s\n%s\n", 
R–—£
, 
V”siÚ
);

239 
	`ex™
(
E_USAGE
);

240 
	}
}

242 
	$£t_Ãtmask
(
skfd
, 
iäeq
 *
iä
, 
sockaddr
 *
§
)

244 
”r
 = 0;

246 
	`memıy
((*è&
iä
->
iä_Ãtmask
, (*è
§
,

247 (
sockaddr
));

248 ià(
	`ioùl
(
skfd
, 
SIOCSIFNETMASK
, 
iä
) < 0) {

249 
	`årštf
(
¡d”r
, "SIOCSIFNETMASK: %s\n",

250 
	`¡»¼Ü
(
”ºo
));

251 
”r
 = 1;

253  
”r
;

254 
	}
}

256 
	$maš
(
¬gc
, **
¬gv
)

258 
sockaddr
 
§
;

259 
sockaddr
 
§mask
;

260 
sockaddr_š
 
sš
;

261 
ho¡
[128];

262 
aáy³
 *
­
;

263 
hwty³
 *
hw
;

264 
iäeq
 
iä
;

265 
gÙ”r
 = 0, 
didÃtmask
 = 0, 
ÃedÃtmask
=0;

266 **
¥p
;

267 
fd
;

268 #ià
HAVE_AFINET6


269 
aáy³
 
š‘6_aáy³
;

270 
sockaddr_š6
 
§6
;

271 
š6_iäeq
 
iä6
;

272 
´efix_Ën
;

273 *
ı
;

275 #ià
HAVE_AFINET


276 
aáy³
 
š‘_aáy³
;

279 #ià
I18N


280 
	`£oÿË
 (
LC_ALL
, "");

281 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

282 
	`‹xtdomaš
("net-tools");

286 
¬gc
--;

287 
¬gv
++;

288 
¬gc
 && *
¬gv
[0] == '-') {

289 ià(!
	`¡rcmp
(*
¬gv
, "-a"))

290 
İt_a
 = 1;

292 ià(!
	`¡rcmp
(*
¬gv
, "-s"))

293 
iã_shÜt
 = 1;

295 ià(!
	`¡rcmp
(*
¬gv
, "-v"))

296 
İt_v
 = 1;

298 ià(!
	`¡rcmp
(*
¬gv
, "-V") || !strcmp(*argv, "-version") ||

299 !
	`¡rcmp
(*
¬gv
, "--version"))

300 
	`v”siÚ
();

302 ià(!
	`¡rcmp
(*
¬gv
, "-?") || !strcmp(*argv, "-h") ||

303 !
	`¡rcmp
(*
¬gv
, "-help") || !strcmp(*argv, "--help"))

304 
	`u§ge
();

307 
	`årštf
(
¡d”r
, 
	`_
("ifconfig: option `%s'‚ot„ecognised.\n"),

308 
¬gv
[0]);

309 
	`årštf
(
¡d”r
, 
	`_
("ifconfig: `--help' gives usage information.\n"));

310 
	`ex™
(1);

313 
¬gv
++;

314 
¬gc
--;

318 ià((
skfd
 = 
	`sock‘s_İ’
(0)) < 0) {

319 
	`³¼Ü
("socket");

320 
	`ex™
(1);

324 ià(
¬gc
 == 0) {

325 
”r
 = 
	`if_´št
((*è
NULL
);

326 (è
	`şo£
(
skfd
);

327 
	`ex™
(
”r
 < 0);

330 
¥p
 = 
¬gv
;

331 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, *
¥p
++, 
IFNAMSIZ
);

332 ià(*
¥p
 =ğ(*è
NULL
) {

333 
”r
 = 
	`if_´št
(
iä
.
iä_Çme
);

334 (è
	`şo£
(
skfd
);

335 
	`ex™
(
”r
 < 0);

339 ià((
­
 = 
	`g‘_aáy³
(*
¥p
)è!ğ
NULL
)

340 
¥p
++;

342 
­
 = 
	`g‘_aáy³
(
DFLT_AF
);

344 ià(
­
) {

345 
addr_çmy
 = 
­
->
af
;

346 
skfd
 = 
­
->
fd
;

350 *
¥p
 !ğ(*è
NULL
) {

351 ià(!
	`¡rcmp
(*
¥p
, "arp")) {

352 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_NOARP
);

353 
¥p
++;

356 ià(!
	`¡rcmp
(*
¥p
, "-arp")) {

357 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_NOARP
);

358 
¥p
++;

361 #ifdeà
IFF_PORTSEL


362 ià(!
	`¡rcmp
(*
¥p
, "media") || !strcmp(*spp, "port")) {

363 ià(*++
¥p
 =ğ
NULL
)

364 
	`u§ge
();

365 ià(!
	`¡rÿ£cmp
(*
¥p
, "auto")) {

366 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_AUTOMEDIA
);

368 
i
, 
j
, 
ÃwpÜt
;

369 *
’dp
;

370 
ÃwpÜt
 = 
	`¡¹Ş
(*
¥p
, &
’dp
, 10);

371 ià(*
’dp
 != 0) {

372 
ÃwpÜt
 = -1;

373 
i
 = 0; 
if_pÜt_‹xt
[i][0] && 
ÃwpÜt
 == -1; i++) {

374 
j
 = 0; 
if_pÜt_‹xt
[
i
][j]; j++) {

375 ià(!
	`¡rÿ£cmp
(*
¥p
, 
if_pÜt_‹xt
[
i
][
j
])) {

376 
ÃwpÜt
 = 
i
;

382 
¥p
++;

383 ià(
ÃwpÜt
 == -1) {

384 
	`årštf
(
¡d”r
, 
	`_
("Unknown mediaype.\n"));

385 
gÙ”r
 = 1;

387 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0) {

388 
	`³¼Ü
("port: SIOCGIFMAP");

389 
gÙ”r
 = 1;

392 
iä
.
iä_m­
.
pÜt
 = 
ÃwpÜt
;

393 ià(
	`ioùl
(
skfd
, 
SIOCSIFMAP
, &
iä
) < 0) {

394 
	`³¼Ü
("port: SIOCSIFMAP");

395 
gÙ”r
 = 1;

403 ià(!
	`¡rcmp
(*
¥p
, "trailers")) {

404 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_NOTRAILERS
);

405 
¥p
++;

408 ià(!
	`¡rcmp
(*
¥p
, "-trailers")) {

409 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_NOTRAILERS
);

410 
¥p
++;

413 ià(!
	`¡rcmp
(*
¥p
, "promisc")) {

414 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_PROMISC
);

415 
¥p
++;

418 ià(!
	`¡rcmp
(*
¥p
, "-promisc")) {

419 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_PROMISC
);

420 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_PROMISC
) > 0)

421 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš…romisømode... maybÙh”‡µliÿtiÚ i ruÂšg?\n"), 
iä
.
iä_Çme
);

422 
¥p
++;

425 ià(!
	`¡rcmp
(*
¥p
, "multicast")) {

426 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
);

427 
¥p
++;

430 ià(!
	`¡rcmp
(*
¥p
, "-multicast")) {

431 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
);

432 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
) > 0)

433 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš MULTICAST mode.\n"), 
iä
.
iä_Çme
);

434 
¥p
++;

437 ià(!
	`¡rcmp
(*
¥p
, "allmulti")) {

438 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_ALLMULTI
);

439 
¥p
++;

442 ià(!
	`¡rcmp
(*
¥p
, "-allmulti")) {

443 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_ALLMULTI
);

444 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
) > 0)

445 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš ALLMULTI mode.\n"), 
iä
.
iä_Çme
);

446 
¥p
++;

449 ià(!
	`¡rcmp
(*
¥p
, "up")) {

450 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, (
IFF_UP
 | 
IFF_RUNNING
));

451 
¥p
++;

454 ià(!
	`¡rcmp
(*
¥p
, "down")) {

455 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_UP
);

456 
¥p
++;

459 #ifdeà
HAVE_DYNAMIC


460 ià(!
	`¡rcmp
(*
¥p
, "dynamic")) {

461 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_DYNAMIC
);

462 
¥p
++;

465 ià(!
	`¡rcmp
(*
¥p
, "-dynamic")) {

466 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_DYNAMIC
);

467 
¥p
++;

468 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
) > 0)

469 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš DYNAMIC mode.\n"), 
iä
.
iä_Çme
);

474 ià(!
	`¡rcmp
(*
¥p
, "metric")) {

475 ià(*++
¥p
 =ğ
NULL
)

476 
	`u§ge
();

477 
iä
.
iä_m‘ric
 = 
	`©oi
(*
¥p
);

478 ià(
	`ioùl
(
skfd
, 
SIOCSIFMETRIC
, &
iä
) < 0) {

479 
	`årštf
(
¡d”r
, "SIOCSIFMETRIC: %s\n", 
	`¡»¼Ü
(
”ºo
));

480 
gÙ”r
 = 1;

482 
¥p
++;

485 ià(!
	`¡rcmp
(*
¥p
, "mtu")) {

486 ià(*++
¥p
 =ğ
NULL
)

487 
	`u§ge
();

488 
iä
.
iä_mtu
 = 
	`©oi
(*
¥p
);

489 ià(
	`ioùl
(
skfd
, 
SIOCSIFMTU
, &
iä
) < 0) {

490 
	`årštf
(
¡d”r
, "SIOCSIFMTU: %s\n", 
	`¡»¼Ü
(
”ºo
));

491 
gÙ”r
 = 1;

493 
¥p
++;

496 #ifdeà
SIOCSKEEPALIVE


497 ià(!
	`¡rcmp
(*
¥p
, "keepalive")) {

498 ià(*++
¥p
 =ğ
NULL
)

499 
	`u§ge
();

500 
iä
.
iä_d©a
 = (
ÿddr_t
è
	`©oi
(*
¥p
);

501 ià(
	`ioùl
(
skfd
, 
SIOCSKEEPALIVE
, &
iä
) < 0) {

502 
	`årštf
(
¡d”r
, "SIOCSKEEPALIVE: %s\n", 
	`¡»¼Ü
(
”ºo
));

503 
gÙ”r
 = 1;

505 
¥p
++;

510 #ifdeà
SIOCSOUTFILL


511 ià(!
	`¡rcmp
(*
¥p
, "outfill")) {

512 ià(*++
¥p
 =ğ
NULL
)

513 
	`u§ge
();

514 
iä
.
iä_d©a
 = (
ÿddr_t
è
	`©oi
(*
¥p
);

515 ià(
	`ioùl
(
skfd
, 
SIOCSOUTFILL
, &
iä
) < 0) {

516 
	`årštf
(
¡d”r
, "SIOCSOUTFILL: %s\n", 
	`¡»¼Ü
(
”ºo
));

517 
gÙ”r
 = 1;

519 
¥p
++;

524 ià(!
	`¡rcmp
(*
¥p
, "-broadcast")) {

525 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_BROADCAST
);

526 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
) > 0)

527 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš BROADCAST mode.\n"), 
iä
.
iä_Çme
);

528 
¥p
++;

531 ià(!
	`¡rcmp
(*
¥p
, "broadcast")) {

532 ià(*++
¥p
 !ğ
NULL
) {

533 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

534 ià(
­
->
	`šput
(0, 
ho¡
, &
§
) < 0) {

535 ià(
­
->
h”rÜ
)

536 
­
->
	`h”rÜ
(
ho¡
);

538 
	`årštf
(
¡d”r
, 
	`_
("ifcÚfig: E¼Ü„esŞvšg '%s' fÜ brßdÿ¡\n"), 
ho¡
);

539 
gÙ”r
 = 1;

540 
¥p
++;

543 
	`memıy
((*è&
iä
.
iä_brßdaddr
, (*è&
§
,

544 (
sockaddr
));

545 ià(
	`ioùl
(
­
->
fd
, 
SIOCSIFBRDADDR
, &
iä
) < 0) {

546 
	`årštf
(
¡d”r
, "SIOCSIFBRDADDR: %s\n",

547 
	`¡»¼Ü
(
”ºo
));

548 
gÙ”r
 = 1;

550 
¥p
++;

552 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_BROADCAST
);

555 ià(!
	`¡rcmp
(*
¥p
, "dstaddr")) {

556 ià(*++
¥p
 =ğ
NULL
)

557 
	`u§ge
();

558 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

559 ià(
­
->
	`šput
(0, 
ho¡
, &
§
) < 0) {

560 ià(
­
->
h”rÜ
)

561 
­
->
	`h”rÜ
(
ho¡
);

563 
	`årštf
(
¡d”r
, 
	`_
("ifcÚfig: E¼Ü„esŞvšg '%s' fÜ d¡addr\n"), 
ho¡
);

564 
gÙ”r
 = 1;

565 
¥p
++;

568 
	`memıy
((*è&
iä
.
iä_d¡addr
, (*è&
§
,

569 (
sockaddr
));

570 ià(
	`ioùl
(
­
->
fd
, 
SIOCSIFDSTADDR
, &
iä
) < 0) {

571 
	`årštf
(
¡d”r
, "SIOCSIFDSTADDR: %s\n",

572 
	`¡»¼Ü
(
”ºo
));

573 
gÙ”r
 = 1;

575 
¥p
++;

578 ià(!
	`¡rcmp
(*
¥p
, "netmask")) {

579 ià(*++
¥p
 =ğ
NULL
 || 
didÃtmask
)

580 
	`u§ge
();

581 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

582 ià(
­
->
	`šput
(0, 
ho¡
, &
§
) < 0) {

583 ià(
­
->
h”rÜ
)

584 
­
->
	`h”rÜ
(
ho¡
);

586 
	`årštf
(
¡d”r
, 
	`_
("ifcÚfig: E¼Ü„esŞvšg '%s' fÜ‚‘mask\n"), 
ho¡
);

587 
gÙ”r
 = 1;

588 
¥p
++;

591 
didÃtmask
++;

592 
gÙ”r
 |ğ
	`£t_Ãtmask
(
­
->
fd
, &
iä
, &
§
);

593 
¥p
++;

596 #ifdeà
HAVE_TXQUEUELEN


597 ià(!
	`¡rcmp
(*
¥p
, "txqueuelen")) {

598 ià(*++
¥p
 =ğ
NULL
)

599 
	`u§ge
();

600 
iä
.
iä_qËn
 = 
	`¡¹oul
(*
¥p
, 
NULL
, 0);

601 ià(
	`ioùl
(
skfd
, 
SIOCSIFTXQLEN
, &
iä
) < 0) {

602 
	`årštf
(
¡d”r
, "SIOCSIFTXQLEN: %s\n", 
	`¡»¼Ü
(
”ºo
));

603 
gÙ”r
 = 1;

605 
¥p
++;

610 ià(!
	`¡rcmp
(*
¥p
, "mem_start")) {

611 ià(*++
¥p
 =ğ
NULL
)

612 
	`u§ge
();

613 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0) {

614 
	`årštf
(
¡d”r
, "mem_¡¬t: SIOCGIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

615 
¥p
++;

616 
gÙ”r
 = 1;

619 
iä
.
iä_m­
.
mem_¡¬t
 = 
	`¡¹oul
(*
¥p
, 
NULL
, 0);

620 ià(
	`ioùl
(
skfd
, 
SIOCSIFMAP
, &
iä
) < 0) {

621 
	`årštf
(
¡d”r
, "mem_¡¬t: SIOCSIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

622 
gÙ”r
 = 1;

624 
¥p
++;

627 ià(!
	`¡rcmp
(*
¥p
, "io_addr")) {

628 ià(*++
¥p
 =ğ
NULL
)

629 
	`u§ge
();

630 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0) {

631 
	`årštf
(
¡d”r
, "io_addr: SIOCGIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

632 
¥p
++;

633 
gÙ”r
 = 1;

636 
iä
.
iä_m­
.
ba£_addr
 = 
	`¡¹Ş
(*
¥p
, 
NULL
, 0);

637 ià(
	`ioùl
(
skfd
, 
SIOCSIFMAP
, &
iä
) < 0) {

638 
	`årštf
(
¡d”r
, "io_addr: SIOCSIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

639 
gÙ”r
 = 1;

641 
¥p
++;

644 ià(!
	`¡rcmp
(*
¥p
, "irq")) {

645 ià(*++
¥p
 =ğ
NULL
)

646 
	`u§ge
();

647 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0) {

648 
	`årštf
(
¡d”r
, "œq: SIOCGIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

649 
gÙ”r
 = 1;

650 
¥p
++;

653 
iä
.
iä_m­
.
œq
 = 
	`©oi
(*
¥p
);

654 ià(
	`ioùl
(
skfd
, 
SIOCSIFMAP
, &
iä
) < 0) {

655 
	`årštf
(
¡d”r
, "œq: SIOCSIFMAP: %s\n", 
	`¡»¼Ü
(
”ºo
));

656 
gÙ”r
 = 1;

658 
¥p
++;

661 ià(!
	`¡rcmp
(*
¥p
, "-pointopoint")) {

662 
gÙ”r
 |ğ
	`şr_æag
(
iä
.
iä_Çme
, 
IFF_POINTOPOINT
);

663 
¥p
++;

664 ià(
	`‹¡_æag
(
iä
.
iä_Çme
, 
IFF_MULTICAST
) > 0)

665 
	`årštf
(
¡d”r
, 
	`_
("W¬nšg: IÁ”çû % ¡Èš POINTOPOINT mode.\n"), 
iä
.
iä_Çme
);

668 ià(!
	`¡rcmp
(*
¥p
, "pointopoint")) {

669 ià(*(
¥p
 + 1è!ğ
NULL
) {

670 
¥p
++;

671 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

672 ià(
­
->
	`šput
(0, 
ho¡
, &
§
)) {

673 ià(
­
->
h”rÜ
)

674 
­
->
	`h”rÜ
(
ho¡
);

676 
	`årštf
(
¡d”r
, 
	`_
("ifcÚfig: E¼Ü„esŞvšg '%s' fÜ…oštİošt\n"), 
ho¡
);

677 
gÙ”r
 = 1;

678 
¥p
++;

681 
	`memıy
((*è&
iä
.
iä_d¡addr
, (*è&
§
,

682 (
sockaddr
));

683 ià(
	`ioùl
(
­
->
fd
, 
SIOCSIFDSTADDR
, &
iä
) < 0) {

684 
	`årštf
(
¡d”r
, "SIOCSIFDSTADDR: %s\n",

685 
	`¡»¼Ü
(
”ºo
));

686 
gÙ”r
 = 1;

689 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, 
IFF_POINTOPOINT
);

690 
¥p
++;

694 ià(!
	`¡rcmp
(*
¥p
, "hw")) {

695 ià(*++
¥p
 =ğ
NULL
)

696 
	`u§ge
();

697 ià((
hw
 = 
	`g‘_hwty³
(*
¥p
)è=ğ
NULL
)

698 
	`u§ge
();

699 ià(
hw
->
šput
 =ğ
NULL
) {

700 
	`årštf
(
¡d”r
, 
	`_
("hw‡dd»s ty³ `%s' ha nØhªdË¸tØ£ˆadd»ss. faed.\n"), *
¥p
);

701 
¥p
+=2;

702 
gÙ”r
 = 1;

705 ià(*++
¥p
 =ğ
NULL
)

706 
	`u§ge
();

707 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

708 ià(
hw
->
	`šput
(
ho¡
, &
§
) < 0) {

709 
	`årštf
(
¡d”r
, 
	`_
("%s: inv®id % add»ss.\n"), 
ho¡
, 
hw
->
Çme
);

710 
gÙ”r
 = 1;

711 
¥p
++;

714 
	`memıy
((*è&
iä
.
iä_hwaddr
, (*è&
§
,

715 (
sockaddr
));

716 ià(
	`ioùl
(
skfd
, 
SIOCSIFHWADDR
, &
iä
) < 0) {

717 ià(
”ºo
 =ğ
EBUSY
)

718 
	`årštf
(
¡d”r
, "SIOCSIFHWADDR: %s - you may‚eedo downhe interface\n",

719 
	`¡»¼Ü
(
”ºo
));

721 
	`årštf
(
¡d”r
, "SIOCSIFHWADDR: %s\n",

722 
	`¡»¼Ü
(
”ºo
));

723 
gÙ”r
 = 1;

725 
¥p
++;

728 #ià
HAVE_AFINET
 || 
HAVE_AFINET6


729 ià(!
	`¡rcmp
(*
¥p
, "add")) {

730 ià(*++
¥p
 =ğ
NULL
)

731 
	`u§ge
();

732 #ià
HAVE_AFINET6


733 ià(
	`¡rchr
(*
¥p
, ':')) {

735 ià((
ı
 = 
	`¡rchr
(*
¥p
, '/'))) {

736 
´efix_Ën
 = 
	`©Ş
(
ı
 + 1);

737 ià((
´efix_Ën
 < 0) || (prefix_len > 128))

738 
	`u§ge
();

739 *
ı
 = 0;

741 
´efix_Ën
 = 128;

743 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

744 ià(
š‘6_aáy³
.
	`šput
(1, 
ho¡
,

745 (
sockaddr
 *è&
§6
) < 0) {

746 ià(
š‘6_aáy³
.
h”rÜ
)

747 
š‘6_aáy³
.
	`h”rÜ
(
ho¡
);

749 
	`årštf
(
¡d”r
, 
	`_
("ifcÚfig: E¼Ü„esŞvšg '%s' fÜ‡dd\n"), 
ho¡
);

750 
gÙ”r
 = 1;

751 
¥p
++;

754 
	`memıy
((*è&
iä6
.
iä6_addr
, (*è&
§6
.
sš6_addr
,

755 (
š6_addr
));

757 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET6
);

758 ià(
fd
 < 0) {

759 
	`årštf
(
¡d”r
,

760 
	`_
("No support for INET6 onhis system.\n"));

761 
gÙ”r
 = 1;

762 
¥p
++;

765 ià(
	`ioùl
(
fd
, 
SIOGIFINDEX
, &
iä
) < 0) {

766 
	`³¼Ü
("SIOGIFINDEX");

767 
gÙ”r
 = 1;

768 
¥p
++;

771 
iä6
.
iä6_ifšdex
 = 
iä
.
iä_ifšdex
;

772 
iä6
.
iä6_´efixËn
 = 
´efix_Ën
;

773 ià(
	`ioùl
(
fd
, 
SIOCSIFADDR
, &
iä6
) < 0) {

774 
	`³¼Ü
("SIOCSIFADDR");

775 
gÙ”r
 = 1;

777 
¥p
++;

781 #ifdeà
HAVE_AFINET


783 

, 
nm
, 
bc
;

784 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

785 ià(
š‘_aáy³
.
	`šput
(0, 
ho¡
, (
sockaddr
 *)&
sš
) < 0) {

786 
­
->
	`h”rÜ
(
ho¡
);

787 
gÙ”r
 = 1;

788 
¥p
++;

791 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

792 ià(
fd
 < 0) {

793 
	`årštf
(
¡d”r
,

794 
	`_
("No support for INET onhis system.\n"));

795 
gÙ”r
 = 1;

796 
¥p
++;

800 
	`memıy
(&

, &
sš
.
sš_addr
.
s_addr
, ());

802 ià(
	`g‘_nmbc_·»Á
(
iä
.
iä_Çme
, &
nm
, &
bc
) < 0) {

803 
	`årštf
(
¡d”r
, 
	`_
("Interface %s‚ot initialized\n"),

804 
iä
.
iä_Çme
);

805 
gÙ”r
 = 1;

806 
¥p
++;

809 
	`£t_if¡©e
(
iä
.
iä_Çme
, 

, 
nm
, 
bc
, 1);

812 
¥p
++;

815 
	`årštf
(
¡d”r
, 
	`_
("Bad‡ddress.\n"));

820 #ià
HAVE_AFINET
 || 
HAVE_AFINET6


821 ià(!
	`¡rcmp
(*
¥p
, "del")) {

822 ià(*++
¥p
 =ğ
NULL
)

823 
	`u§ge
();

825 #ifdeà
SIOCDIFADDR


826 #ià
HAVE_AFINET6


827 ià(
	`¡rchr
(*
¥p
, ':')) {

828 ià((
ı
 = 
	`¡rchr
(*
¥p
, '/'))) {

829 
´efix_Ën
 = 
	`©Ş
(
ı
 + 1);

830 ià((
´efix_Ën
 < 0) || (prefix_len > 128))

831 
	`u§ge
();

832 *
ı
 = 0;

834 
´efix_Ën
 = 128;

836 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

837 ià(
š‘6_aáy³
.
	`šput
(1, 
ho¡
,

838 (
sockaddr
 *è&
§6
) < 0) {

839 
š‘6_aáy³
.
	`h”rÜ
(
ho¡
);

840 
gÙ”r
 = 1;

841 
¥p
++;

844 
	`memıy
((*è&
iä6
.
iä6_addr
, (*è&
§6
.
sš6_addr
,

845 (
š6_addr
));

847 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET6
);

848 ià(
fd
 < 0) {

849 
	`årštf
(
¡d”r
,

850 
	`_
("No support for INET6 onhis system.\n"));

851 
gÙ”r
 = 1;

852 
¥p
++;

855 ià(
	`ioùl
(
fd
, 
SIOGIFINDEX
, &
iä
) < 0) {

856 
	`³¼Ü
("SIOGIFINDEX");

857 
gÙ”r
 = 1;

858 
¥p
++;

861 
iä6
.
iä6_ifšdex
 = 
iä
.
iä_ifšdex
;

862 
iä6
.
iä6_´efixËn
 = 
´efix_Ën
;

863 ià(
İt_v
)

864 
	`årštf
(
¡d”r
, "now d–‘šg: ioùl(SIOCDIFADDR,{ifšdex=%d,´efixËn=%ld})\n",
iä
.
iä_ifšdex
,
´efix_Ën
);

865 ià(
	`ioùl
(
fd
, 
SIOCDIFADDR
, &
iä6
) < 0) {

866 
	`årštf
(
¡d”r
, "SIOCDIFADDR: %s\n",

867 
	`¡»¼Ü
(
”ºo
));

868 
gÙ”r
 = 1;

870 
¥p
++;

874 #ifdeà
HAVE_AFINET


877 

, 
nm
, 
bc
;

878 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

879 ià(
š‘_aáy³
.
	`šput
(0, 
ho¡
, (
sockaddr
 *)&
sš
) < 0) {

880 
­
->
	`h”rÜ
(
ho¡
);

881 
gÙ”r
 = 1;

882 
¥p
++;

885 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

886 ià(
fd
 < 0) {

887 
	`årštf
(
¡d”r
, 
	`_
("No support for INET onhis system.\n"));

888 
gÙ”r
 = 1;

889 
¥p
++;

893 
	`memıy
(&

, &
sš
.
sš_addr
.
s_addr
, ());

895 ià(
	`g‘_nmbc_·»Á
(
iä
.
iä_Çme
, &
nm
, &
bc
) < 0) {

896 
	`årštf
(
¡d”r
, 
	`_
("Interface %s‚ot initialized\n"),

897 
iä
.
iä_Çme
);

898 
gÙ”r
 = 1;

899 
¥p
++;

902 
	`£t_if¡©e
(
iä
.
iä_Çme
, 

, 
nm
, 
bc
, 0);

904 
¥p
++;

907 
	`årštf
(
¡d”r
, 
	`_
("Bad‡ddress.\n"));

910 
	`årštf
(
¡d”r
, 
	`_
("Address deletion‚ot supported onhis system.\n"));

914 #ià
HAVE_AFINET6


915 ià(!
	`¡rcmp
(*
¥p
, "tunnel")) {

916 ià(*++
¥p
 =ğ
NULL
)

917 
	`u§ge
();

918 ià((
ı
 = 
	`¡rchr
(*
¥p
, '/'))) {

919 
´efix_Ën
 = 
	`©Ş
(
ı
 + 1);

920 ià((
´efix_Ën
 < 0) || (prefix_len > 128))

921 
	`u§ge
();

922 *
ı
 = 0;

924 
´efix_Ën
 = 128;

926 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

927 ià(
š‘6_aáy³
.
	`šput
(1, 
ho¡
, (
sockaddr
 *è&
§6
) < 0) {

928 
š‘6_aáy³
.
	`h”rÜ
(
ho¡
);

929 
gÙ”r
 = 1;

930 
¥p
++;

933 
	`memıy
((*è&
iä6
.
iä6_addr
, (*è&
§6
.
sš6_addr
,

934 (
š6_addr
));

936 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET6
);

937 ià(
fd
 < 0) {

938 
	`årštf
(
¡d”r
, 
	`_
("No support for INET6 onhis system.\n"));

939 
gÙ”r
 = 1;

940 
¥p
++;

943 ià(
	`ioùl
(
fd
, 
SIOGIFINDEX
, &
iä
) < 0) {

944 
	`³¼Ü
("SIOGIFINDEX");

945 
gÙ”r
 = 1;

946 
¥p
++;

949 
iä6
.
iä6_ifšdex
 = 
iä
.
iä_ifšdex
;

950 
iä6
.
iä6_´efixËn
 = 
´efix_Ën
;

952 ià(
	`ioùl
(
fd
, 
SIOCSIFDSTADDR
, &
iä6
) < 0) {

953 
	`årštf
(
¡d”r
, "SIOCSIFDSTADDR: %s\n",

954 
	`¡»¼Ü
(
”ºo
));

955 
gÙ”r
 = 1;

957 
¥p
++;

963 
	`§ã_¡ºıy
(
ho¡
, *
¥p
, ( host));

967 ià(
­
->
g‘mask
) {

968 
­
->
	`g‘mask
(
ho¡
, &
§mask
, 
NULL
)) {

970 
	`u§ge
();

973 ià(
didÃtmask
)

974 
	`u§ge
();

977 
ÃedÃtmask
 = 1;

981 ià(
­
->
šput
 =ğ
NULL
) {

982 
	`årštf
(
¡d”r
, 
	`_
("ifconfig: Cannot set‡ddress forhis…rotocol family.\n"));

983 
	`ex™
(1);

985 ià(
­
->
	`šput
(0, 
ho¡
, &
§
) < 0) {

986 ià(
­
->
h”rÜ
)

987 
­
->
	`h”rÜ
(
ho¡
);

989 
	`årštf
(
¡d”r
,
	`_
("ifcÚfig:ƒ¼Ü„esŞvšg '%s'Ø£ˆadd»s fÜ‡f=%s\n"), 
ho¡
, 
­
->
Çme
); fprintf(stderr,

990 
	`_
("ifcÚfig: `--h–p' give u§gšfÜm©iÚ.\n")); 
	`ex™
(1);

992 
	`memıy
((*è&
iä
.
iä_addr
, (*è&
§
, (
sockaddr
));

994 
r
 = 0;

995 
­
->
af
) {

996 #ià
HAVE_AFINET


997 
AF_INET
:

998 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

999 ià(
fd
 < 0) {

1000 
	`årštf
(
¡d”r
, 
	`_
("No support for INET onhis system.\n"));

1001 
	`ex™
(1);

1003 
r
 = 
	`ioùl
(
fd
, 
SIOCSIFADDR
, &
iä
);

1006 #ià
HAVE_AFECONET


1007 
AF_ECONET
:

1008 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_ECONET
);

1009 ià(
fd
 < 0) {

1010 
	`årštf
(
¡d”r
, 
	`_
("No support for ECONET onhis system.\n"));

1011 
	`ex™
(1);

1013 
r
 = 
	`ioùl
(
fd
, 
SIOCSIFADDR
, &
iä
);

1017 
	`årštf
(
¡d”r
,

1018 
	`_
("DÚ'ˆknow howØ£ˆadd»s£ fÜ famy %d.\n"), 
­
->
af
);

1019 
	`ex™
(1);

1021 ià(
r
 < 0) {

1022 
	`³¼Ü
("SIOCSIFADDR");

1023 
gÙ”r
 = 1;

1035 *
±r
;

1036 
found_cŞÚ
 = 0;

1037 
±r
 = 
iä
.
iä_Çme
; *ptr;…tr++ )

1038 ià(*
±r
 =ğ':'è
found_cŞÚ
++;

1040 ià(!(
found_cŞÚ
 && *(
±r
 - 1) == '-'))

1041 
gÙ”r
 |ğ
	`£t_æag
(
iä
.
iä_Çme
, (
IFF_UP
 | 
IFF_RUNNING
));

1044 
¥p
++;

1047 ià(
ÃedÃtmask
) {

1048 
gÙ”r
 |ğ
	`£t_Ãtmask
(
skfd
, &
iä
, &
§mask
);

1049 
didÃtmask
++;

1052 ià(
İt_v
 && 
gÙ”r
)

1053 
	`årštf
(
¡d”r
, 
	`_
("WARNING:‡ˆËa¡ oÃƒ¼Ü occu»d. (%d)\n"), 
gÙ”r
);

1055  (
gÙ”r
);

1056 
	}
}

1058 
	sifcmd
 {

1059 
	mæag
;

1060 
	maddr
;

1061 *
	mba£
;

1062 
	mba£Ën
;

1065 
	g£¬ch”
[256];

1067 
	$£t__usšg
(cÚ¡ *
Çme
, 
c
, 

)

1069 
iäeq
 
iä
;

1070 
sockaddr_š
 
sš
;

1072 
	`§ã_¡ºıy
(
iä
.
iä_Çme
, 
Çme
, 
IFNAMSIZ
);

1073 
	`mem£t
(&
sš
, 0, (
sockaddr
));

1074 
sš
.
sš_çmy
 = 
AF_INET
;

1075 
sš
.
sš_addr
.
s_addr
 = 

;

1076 
	`memıy
(&
iä
.
iä_addr
, &
sš
, (
sockaddr
));

1077 ià(
	`ioùl
(
skfd
, 
c
, &
iä
) < 0)

1080 
	}
}

1082 
	$do_ifcmd
(
š‹rçû
 *
x
, 
ifcmd
 *
±r
)

1084 *
z
, *
e
;

1085 
sockaddr_š
 *
sš
;

1086 
i
;

1088 ià(
	`do_if_ãtch
(
x
) < 0)

1090 ià(
	`¡ºcmp
(
x
->
Çme
, 
±r
->
ba£
,…Œ->
ba£Ën
) != 0)

1092 
z
 = 
	`¡rchr
(
x
->
Çme
, ':');

1093 ià(!
z
 || !*z)

1095 
z
++;

1096 
e
 = 
z
; *e;ƒ++)

1097 ià(*
e
 == '-')

1099 
i
 = 
	`©oi
(
z
);

1100 ià(
i
 < 0 || i > 255)

1101 
	`abÜt
();

1102 
£¬ch”
[
i
] = 1;

1105 
sš
 = (
sockaddr_š
 *)&
x
->
d¡addr
;

1106 ià(
sš
->
sš_addr
.
s_addr
 !ğ
±r
->
addr
) {

1110 ià(
±r
->
æag
) {

1112 ià(
	`£t_æag
(
x
->
Çme
, 
IFF_UP
 | 
IFF_RUNNING
) == -1)

1116 ià(
	`şr_æag
(
x
->
Çme
, 
IFF_UP
) == -1)

1121 
	}
}

1124 
	$g‘_nmbc_·»Á
(*
·»Á
,

1125 *
nm
, *
bc
)

1127 
š‹rçû
 *
i
;

1128 
sockaddr_š
 *
sš
;

1130 
i
 = 
	`lookup_š‹rçû
(
·»Á
);

1131 ià(!
i
)

1133 ià(
	`do_if_ãtch
(
i
) < 0)

1135 
sš
 = (
sockaddr_š
 *)&
i
->
Ãtmask
;

1136 
	`memıy
(
nm
, &
sš
->
sš_addr
.
s_addr
, ());

1137 
sš
 = (
sockaddr_š
 *)&
i
->
brßdaddr
;

1138 
	`memıy
(
bc
, &
sš
->
sš_addr
.
s_addr
, ());

1140 
	}
}

1142 
	$£t_if¡©e
(*
·»Á
, 

,

1143 
nm
, 
bc
,

1144 
æag
)

1146 
buf
[
IFNAMSIZ
];

1147 
ifcmd
 
±
;

1148 
i
;

1150 
±
.
ba£
 = 
·»Á
;

1151 
±
.
ba£Ën
 = 
	`¡¾’
(
·»Á
);

1152 
±
.
addr
 = 

;

1153 
±
.
æag
 = flag;

1154 
	`mem£t
(
£¬ch”
, 0, (searcher));

1155 
i
 = 
	`fÜ_®l_š‹rçûs
(((*)(
š‹rçû
 *,*))
do_ifcmd
,

1156 &
±
);

1157 ià(
i
 == -1)

1159 ià(
i
 == 1)

1163 
i
 = 0; i < 256; i++)

1164 ià(
£¬ch”
[
i
] == 0)

1167 ià(
i
 == 256)

1170 ià(
	`¢´štf
(
buf
, 
IFNAMSIZ
, "%s:%d", 
·»Á
, 
i
) > IFNAMSIZ)

1172 ià(
	`£t__usšg
(
buf
, 
SIOCSIFADDR
, 

) == -1)

1174 ià(
	`£t__usšg
(
buf
, 
SIOCSIFNETMASK
, 
nm
) == -1)

1176 ià(
	`£t__usšg
(
buf
, 
SIOCSIFBRDADDR
, 
bc
) == -1)

1178 ià(
	`£t_æag
(
buf
, 
IFF_BROADCAST
) == -1)

1181 
	}
}

	@interface/net-tools/include/interface.h

1 
	su£r_Ãt_deviû_¡©s
 {

2 
	mrx_·ck‘s
;

3 
	mtx_·ck‘s
;

4 
	mrx_by‹s
;

5 
	mtx_by‹s
;

6 
	mrx_”rÜs
;

7 
	mtx_”rÜs
;

8 
	mrx_drİ³d
;

9 
	mtx_drİ³d
;

10 
	mrx_muÉiÿ¡
;

11 
	mrx_com´es£d
;

12 
	mtx_com´es£d
;

13 
	mcŞlisiÚs
;

16 
	mrx_Ëngth_”rÜs
;

17 
	mrx_ov”_”rÜs
;

18 
	mrx_üc_”rÜs
;

19 
	mrx_äame_”rÜs
;

20 
	mrx_fifo_”rÜs
;

21 
	mrx_mis£d_”rÜs
;

23 
	mtx_abÜ‹d_”rÜs
;

24 
	mtx_ÿ¼›r_”rÜs
;

25 
	mtx_fifo_”rÜs
;

26 
	mtx_h—¹b—t_”rÜs
;

27 
	mtx_wšdow_”rÜs
;

30 
	sš‹rçû
 {

31 
š‹rçû
 *
	mÃxt
, *
	m´ev
;

32 
	mÇme
[
IFNAMSIZ
];

33 
	mty³
;

34 
	mæags
;

35 
	mm‘ric
;

36 
	mmtu
;

37 
	mtx_queue_Ën
;

38 
ifm­
 
	mm­
;

39 
sockaddr
 
	maddr
;

40 
sockaddr
 
	md¡addr
;

41 
sockaddr
 
	mbrßdaddr
;

42 
sockaddr
 
	mÃtmask
;

43 
sockaddr
 
	mxaddr_bb
;

44 
sockaddr
 
	mxaddr_¢
;

45 
sockaddr
 
	mxaddr_e3
;

46 
sockaddr
 
	mxaddr_e2
;

47 
sockaddr
 
	mdd·ddr
;

48 
sockaddr
 
	meÿddr
;

49 
	mhas_
;

50 
	mhas_x_bb
;

51 
	mhas_x_¢
;

52 
	mhas_x_e3
;

53 
	mhas_x_e2
;

54 
	mhas_ax25
;

55 
	mhas_ddp
;

56 
	mhas_ecÚ‘
;

57 
	mhwaddr
[32];

58 
	m¡©i¡ics_v®id
;

59 
u£r_Ãt_deviû_¡©s
 
	m¡©s
;

60 
	mk“·live
;

61 
	moutfl
;

64 
if_ãtch
(
š‹rçû
 *
iã
);

66 
fÜ_®l_š‹rçûs
((*)(
š‹rçû
 *, *), *);

67 
	`if_ÿche_ä“
();

68 
š‹rçû
 *
	`lookup_š‹rçû
(*
Çme
);

69 
	`if_»adli¡
();

71 
	`do_if_ãtch
(
š‹rçû
 *
iã
);

72 
	`do_if_´št
(
š‹rçû
 *
iã
, *
cook›
);

74 
	`´oú‘dev_v”siÚ
(*
buf
);

75 
	`g‘_dev_f›lds
(*
bp
, 
š‹rçû
 *
iã
);

76 * 
	`g‘_Çme
(*
Çme
, *
p
);

78 
	`iã_´št
(
š‹rçû
 *
±r
);

80 
iã_shÜt
;

82 cÚ¡ *
if_pÜt_‹xt
[][4];

85 #ià!
	`defšed
(
SIOCSIFTXQLEN
)

86 
	#SIOCSIFTXQLEN
 0x8943

	)

87 
	#SIOCGIFTXQLEN
 0x8942

	)

90 #ià!
	`defšed
(
iä_qËn
)

92 
	#iä_qËn
 
iä_iäu
.
iäu_mtu


	)

95 
	#HAVE_TXQUEUELEN


	)

97 
	#HAVE_DYNAMIC


	)

98 #iâdeà
IFF_DYNAMIC


99 
	#IFF_DYNAMIC
 0x8000

	)

	@interface/net-tools/include/ipx.h

4 #iâdeà
_IPX_H_


5 
	#_IPX_H_


	)

7 
	#IPX_NODE_LEN
 6

	)

8 
	#IPX_MTU
 576

	)

10 
	ssockaddr_x
 {

11 #ià
LINUX_VERSION_CODE
 > 131328

12 
§_çmy_t
 
	msx_çmy
;

14 
	msx_çmy
;

16 
	msx_pÜt
;

17 
	msx_ÃtwÜk
;

18 
	msx_node
[
IPX_NODE_LEN
];

19 
	msx_ty³
;

20 
	msx_z”o
;

23 
	#IPX_FRAME_NONE
 0

	)

24 
	#IPX_FRAME_SNAP
 1

	)

25 
	#IPX_FRAME_8022
 2

	)

26 
	#IPX_FRAME_ETHERII
 3

	)

27 
	#IPX_FRAME_8023
 4

	)

28 
	#IPX_FRAME_TR_8022
 5

	)

	@interface/net-tools/include/mii.h

9 #iâdeà
_NETTOOL_MII_H


10 
	#_NETTOOLS_MII_H


	)

12 
	~<lšux/sockios.h
>

15 #iâdeà
SIOCGMIIPHY


17 
	#SIOCGMIIPHY
 (
SIOCDEVPRIVATE
è

	)

18 
	#SIOCGMIIREG
 (
SIOCDEVPRIVATE
+1è

	)

19 
	#SIOCSMIIREG
 (
SIOCDEVPRIVATE
+2è

	)

20 
	#SIOCGPARAMS
 (
SIOCDEVPRIVATE
+3è

	)

21 
	#SIOCSPARAMS
 (
SIOCDEVPRIVATE
+4è

	)

24 
	~<lšux/ty³s.h
>

27 
	smii_d©a
 {

28 
__u16
 
	mphy_id
;

29 
__u16
 
	m»g_num
;

30 
__u16
 
	mv®_š
;

31 
__u16
 
	mv®_out
;

35 
	#MII_BMCR
 0x00

	)

36 
	#MII_BMCR_RESET
 0x8000

	)

37 
	#MII_BMCR_LOOPBACK
 0x4000

	)

38 
	#MII_BMCR_100MBIT
 0x2000

	)

39 
	#MII_BMCR_AN_ENA
 0x1000

	)

40 
	#MII_BMCR_ISOLATE
 0x0400

	)

41 
	#MII_BMCR_RESTART
 0x0200

	)

42 
	#MII_BMCR_DUPLEX
 0x0100

	)

43 
	#MII_BMCR_COLTEST
 0x0080

	)

44 
	#MII_BMCR_SPEED1000
 0x0040

	)

47 
	#MII_BMSR
 0x01

	)

48 
	#MII_BMSR_CAP_MASK
 0xf800

	)

49 
	#MII_BMSR_100BASET4
 0x8000

	)

50 
	#MII_BMSR_100BASETX_FD
 0x4000

	)

51 
	#MII_BMSR_100BASETX_HD
 0x2000

	)

52 
	#MII_BMSR_10BASET_FD
 0x1000

	)

53 
	#MII_BMSR_10BASET_HD
 0x0800

	)

54 
	#MII_BMSR_NO_PREAMBLE
 0x0040

	)

55 
	#MII_BMSR_AN_COMPLETE
 0x0020

	)

56 
	#MII_BMSR_REMOTE_FAULT
 0x0010

	)

57 
	#MII_BMSR_AN_ABLE
 0x0008

	)

58 
	#MII_BMSR_LINK_VALID
 0x0004

	)

59 
	#MII_BMSR_JABBER
 0x0002

	)

60 
	#MII_BMSR_EXT_CAP
 0x0001

	)

62 
	#MII_PHY_ID1
 0x02

	)

63 
	#MII_PHY_ID2
 0x03

	)

66 
	#MII_ANAR
 0x04

	)

68 
	#MII_ANLPAR
 0x05

	)

69 
	#MII_AN_NEXT_PAGE
 0x8000

	)

70 
	#MII_AN_ACK
 0x4000

	)

71 
	#MII_AN_REMOTE_FAULT
 0x2000

	)

72 
	#MII_AN_ABILITY_MASK
 0x07e0

	)

73 
	#MII_AN_FLOW_CONTROL
 0x0400

	)

74 
	#MII_AN_100BASET4
 0x0200

	)

75 
	#MII_AN_100BASETX_FD
 0x0100

	)

76 
	#MII_AN_100BASETX_HD
 0x0080

	)

77 
	#MII_AN_10BASET_FD
 0x0040

	)

78 
	#MII_AN_10BASET_HD
 0x0020

	)

79 
	#MII_AN_PROT_MASK
 0x001f

	)

80 
	#MII_AN_PROT_802_3
 0x0001

	)

83 
	#MII_ANER
 0x06

	)

84 
	#MII_ANER_MULT_FAULT
 0x0010

	)

85 
	#MII_ANER_LP_NP_ABLE
 0x0008

	)

86 
	#MII_ANER_NP_ABLE
 0x0004

	)

87 
	#MII_ANER_PAGE_RX
 0x0002

	)

88 
	#MII_ANER_LP_AN_ABLE
 0x0001

	)

90 
	#MII_CTRL1000
 0x09

	)

91 
	#MII_BMCR2_1000FULL
 0x0200

	)

92 
	#MII_BMCR2_1000HALF
 0x0100

	)

94 
	#MII_STAT1000
 0x0a

	)

95 
	#MII_LPA2_1000LOCALOK
 0x2000

	)

96 
	#MII_LPA2_1000REMRXOK
 0x1000

	)

97 
	#MII_LPA2_1000FULL
 0x0800

	)

98 
	#MII_LPA2_1000HALF
 0x0400

	)

101 
	#MII_BASIC_MAX
 (
MII_STAT1000
+1)

	)

	@interface/net-tools/include/sockets.h

1 
skfd
, 
x_sock
, 
ax25_sock
, 
ro£_sock
, 
x25_sock
, 
š‘_sock
, 
š‘6_sock
,

2 
ddp_sock
, 
ec_sock
;

4 
sock‘s_İ’
(
çmy
);

	@interface/net-tools/include/util-ank.h

1 #iâdeà
__UTILS_H__


2 
	#__UTILS_H__
 1

	)

4 
	~<asm/ty³s.h
>

6 
´eã¼ed_çmy
;

7 
show_¡©s
;

8 
show_d‘as
;

9 
show_¿w
;

10 
»sŞve_ho¡s
;

12 #iâdeà
IPPROTO_ESP


13 
	#IPPROTO_ESP
 50

	)

15 #iâdeà
IPPROTO_AH


16 
	#IPPROTO_AH
 51

	)

19 
	#SPRINT_BSIZE
 64

	)

20 
	#SPRINT_BUF
(
x
èx[
SPRINT_BSIZE
]

	)

23 
	#NEXT_ARG
() \

24 
¬gv
++; \

25 ià(--
¬gc
 <= 0) \

26 
	`u§ge
();

	)

30 
__u8
 
	mçmy
;

31 
__u8
 
	mby‹Ën
;

32 
__s16
 
	mb™Ën
;

33 
__u32
 
	md©a
[4];

34 } 
	tš‘_´efix
;

36 
__u32
 
g‘_addr32
(*
Çme
);

37 
g‘_addr_1
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
);

38 
g‘_´efix_1
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
);

39 
g‘_addr
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
);

40 
g‘_´efix
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
);

42 
sÿn_numb”
(*
¬g
, *
v®
);

44 
g‘_š‹g”
(*
v®
, *
¬g
, 
ba£
);

45 
g‘_unsigÃd
(*
v®
, *
¬g
, 
ba£
);

46 
	#g‘_by‹
 
g‘_u8


	)

47 
	#g‘_ushÜt
 
g‘_u16


	)

48 
	#g‘_shÜt
 
g‘_s16


	)

49 
g‘_u32
(
__u32
 *
v®
, *
¬g
, 
ba£
);

50 
g‘_u16
(
__u16
 *
v®
, *
¬g
, 
ba£
);

51 
g‘_s16
(
__s16
 *
v®
, *
¬g
, 
ba£
);

52 
g‘_u8
(
__u8
 *
v®
, *
¬g
, 
ba£
);

53 
g‘_s8
(
__s8
 *
v®
, *
¬g
, 
ba£
);

55 
g‘_tc_şassid
(
__u32
 *
h
, *
¡r
);

56 
´št_tc_şassid
(*
buf
, 
Ën
, 
__u32
 
h
);

57 * 
¥ršt_tc_şassid
(
__u32
 
h
, *
buf
);

60 
	$šv¬g
(*è
	`__©Œibu‹__
((
nÜ‘uº
));

61 
	`m©ches
(*
¬g
, *
·‰”n
);

62 
	`š‘_addr_m©ch
(
š‘_´efix
 *
a
, iÃt_´efix *
b
, 
b™s
);

64 
	`addr_li¡
(
¬gc
, **
¬gv
);

65 
	`rou‹_mÚ™Ü
(
¬gc
, **
¬gv
);

66 
	`do_addr
(
¬gc
, **
¬gv
);

67 
	`do_rou‹
(
¬gc
, **
¬gv
);

68 
	`do_ruË
(
¬gc
, **
¬gv
);

69 
	`do_Ãigh
(
¬gc
, **
¬gv
);

70 
	`do_tuÂ–
(
¬gc
, **
¬gv
);

71 
	`do_lšk
(
¬gc
, **
¬gv
);

72 
	`do_mÚ™Ü
(
¬gc
, **
¬gv
);

73 
	`do_muÉŸddr
(
¬gc
, **
¬gv
);

74 
	`do_qdisc
(
¬gc
, **
¬gv
);

75 
	`do_şass
(
¬gc
, **
¬gv
);

76 
	`do_f‹r
(
¬gc
, **
¬gv
);

78 cÚ¡ *
	`fÜm©_ho¡
(
af
, *
addr
, *
abuf
, 
®’
);

	@interface/net-tools/intl.h

3 #ià
I18N


4 
	~<loÿË.h
>

5 #undeà
__OPTIMIZE__


6 
	~<libš.h
>

7 
	#_
(
SŒšg
è
	`g‘‹xt
((SŒšg))

	)

8 
	#N_
(
SŒšg
è(SŒšg)

	)

10 
	#_
(
SŒšg
è(SŒšg)

	)

11 
	#N_
(
SŒšg
è(SŒšg)

	)

	@interface/net-tools/ipmaddr.c

16 
	~<¡dio.h
>

17 
	~<¡dlib.h
>

18 
	~<uni¡d.h
>

19 
	~<sy¦og.h
>

20 
	~<fú.h
>

21 
	~<sys/ioùl.h
>

22 
	~<sys/sock‘.h
>

23 
	~<Ãtš‘/š.h
>

24 
	~<¬·/š‘.h
>

25 
	~<¡ršg.h
>

27 #ià
defšed
(
__GLIBC__
è&& (__GLIBC__ > 2 || (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1))

28 
	~<Ãt/if.h
>

30 
	~<lšux/if.h
>

33 
	~"cÚfig.h
"

34 
	~"š.h
"

35 
	~"ut-ªk.h
"

36 
	~"Ãt-suµÜt.h
"

37 
	~"v”siÚ.h
"

38 
	~"·thÇmes.h
"

40 
	gf‹r_dev
[16];

41 
	gf‹r_çmy
;

44 
	#NEWADDR
 1

	)

45 
	#DELADDR
 2

	)

47 *
	gR–—£
 = 
RELEASE
,

48 *
	gV”siÚ
 = "ipmaddr 1.1",

49 *
	gSigÇtu»
 = "Alexey Kuznetsov, <kuznet@ms2.inr.ac.ru>";

51 
	$v”siÚ
()

53 
	`´štf
("%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
SigÇtu»
);

54 
	`ex™
(
E_VERSION
);

55 
	}
}

57 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

59 
	$u§ge
()

61 
	`årštf
(
¡d”r
, 
	`_
("Usage: ipmaddr [‡dd | del ] MULTIADDR dev STRING\n"));

62 
	`årštf
(
¡d”r
, 
	`_
(" ipmaddr show [ dev STRING ] [ ipv4 | ipv6 |†ink |‡ll ]\n"));

63 
	`årštf
(
¡d”r
, 
	`_
(" ipmaddr -V | -version\n"));

64 
	`ex™
(-1);

65 
	}
}

67 
	$´št_Îa
(
FILE
 *
å
, 
Ën
, *
addr
)

69 
i
;

70 
i
=0; i<
Ën
; i++) {

71 ià(
i
==0)

72 
	`årštf
(
å
, "%02x", 
addr
[
i
]);

74 
	`årštf
(
å
, ":%02x", 
addr
[
i
]);

76 
	}
}

78 
	$·r£_Îa
(*
¡r
, *
addr
)

80 
Ën
=0;

82 *
¡r
) {

83 
tmp
;

84 ià(
¡r
[0] == ':' || str[0] == '.') {

85 
¡r
++;

88 ià(
¡r
[1] == 0)

90 ià(
	`ssÿnf
(
¡r
, "%02x", &
tmp
) != 1)

92 
addr
[
Ën
] = 
tmp
;

93 
Ën
++;

94 
¡r
 += 2;

96  
Ën
;

97 
	}
}

99 
	$·r£_hex
(*
¡r
, *
addr
)

101 
Ën
=0;

103 *
¡r
) {

104 
tmp
;

105 ià(
¡r
[1] == 0)

107 ià(
	`ssÿnf
(
¡r
, "%02x", &
tmp
) != 1)

109 
addr
[
Ën
] = 
tmp
;

110 
Ën
++;

111 
¡r
 += 2;

113  
Ën
;

114 
	}
}

116 
	sma_šfo


118 
ma_šfo
 *
	mÃxt
;

119 
	mšdex
;

120 
	mu£rs
;

121 *
	mã©u»s
;

122 
	mÇme
[
IFNAMSIZ
];

123 
š‘_´efix
 
	maddr
;

126 
	$maddr_šs
(
ma_šfo
 **
l¡
, ma_šfØ*
m
)

128 
ma_šfo
 *
mp
;

130 ; (
mp
=*
l¡
è!ğ
NULL
;†¡ = &mp->
Ãxt
) {

131 ià(
mp
->
šdex
 > 
m
->index)

134 
m
->
Ãxt
 = *
l¡
;

135 *
l¡
 = 
m
;

136 
	}
}

138 
	$»ad_dev_mÿ¡
(
ma_šfo
 **
»suÉ_p
)

140 
buf
[256];

141 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_DEV_MCAST
, "r");

143 ià(!
å
)

146 
	`fg‘s
(
buf
, (buf), 
å
)) {

147 
hexa
[256];

148 
ma_šfo
 
m
;

149 
Ën
;

150 
¡
;

152 
	`mem£t
(&
m
, 0, (m));

153 
	`ssÿnf
(
buf
, "%d%s%d%d%s", &
m
.
šdex
, m.
Çme
, &m.
u£rs
, &
¡
,

154 
hexa
);

155 ià(
f‹r_dev
[0] && 
	`¡rcmp
(f‹r_dev, 
m
.
Çme
))

158 
m
.
addr
.
çmy
 = 
AF_PACKET
;

160 
Ën
 = 
	`·r£_hex
(
hexa
, (*)&
m
.
addr
.
d©a
);

161 ià(
Ën
 >= 0) {

162 
ma_šfo
 *
ma
 = 
	`m®loc
((
m
));

164 
	`memıy
(
ma
, &
m
, (m));

165 
ma
->
addr
.
by‹Ën
 = 
Ën
;

166 
ma
->
addr
.
b™Ën
 = 
Ën
<<3;

167 ià(
¡
)

168 
ma
->
ã©u»s
 = "static";

169 
	`maddr_šs
(
»suÉ_p
, 
ma
);

172 
	`fşo£
(
å
);

173 
	}
}

175 
	$»ad_igmp
(
ma_šfo
 **
»suÉ_p
)

177 
ma_šfo
 
m
;

178 
buf
[256];

179 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_IGMP
, "r");

181 ià(!
å
)

183 
	`mem£t
(&
m
, 0, (m));

184 
	`fg‘s
(
buf
, (buf), 
å
);

186 
m
.
addr
.
çmy
 = 
AF_INET
;

187 
m
.
addr
.
b™Ën
 = 32;

188 
m
.
addr
.
by‹Ën
 = 4;

190 
	`fg‘s
(
buf
, (buf), 
å
)) {

191 
ma_šfo
 *
ma
 = 
	`m®loc
((
m
));

193 ià(
buf
[0] != '\t') {

194 
	`ssÿnf
(
buf
, "%d%s", &
m
.
šdex
, m.
Çme
);

198 ià(
f‹r_dev
[0] && 
	`¡rcmp
(f‹r_dev, 
m
.
Çme
))

201 
	`ssÿnf
(
buf
, "%08x%d", (
__u32
*)&
m
.
addr
.
d©a
, &m.
u£rs
);

203 
ma
 = 
	`m®loc
((
m
));

204 
	`memıy
(
ma
, &
m
, (m));

205 
	`maddr_šs
(
»suÉ_p
, 
ma
);

207 
	`fşo£
(
å
);

208 
	}
}

211 
	$»ad_igmp6
(
ma_šfo
 **
»suÉ_p
)

213 
buf
[256];

214 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_IGMP6
, "r");

216 ià(!
å
)

219 
	`fg‘s
(
buf
, (buf), 
å
)) {

220 
hexa
[256];

221 
ma_šfo
 
m
;

222 
Ën
;

224 
	`mem£t
(&
m
, 0, (m));

225 
	`ssÿnf
(
buf
, "%d%s%s%d", &
m
.
šdex
, m.
Çme
, 
hexa
, &m.
u£rs
);

227 ià(
f‹r_dev
[0] && 
	`¡rcmp
(f‹r_dev, 
m
.
Çme
))

230 
m
.
addr
.
çmy
 = 
AF_INET6
;

232 
Ën
 = 
	`·r£_hex
(
hexa
, (*)&
m
.
addr
.
d©a
);

233 ià(
Ën
 >= 0) {

234 
ma_šfo
 *
ma
 = 
	`m®loc
((
m
));

236 
	`memıy
(
ma
, &
m
, (m));

238 
ma
->
addr
.
by‹Ën
 = 
Ën
;

239 
ma
->
addr
.
b™Ën
 = 
Ën
<<3;

240 
	`maddr_šs
(
»suÉ_p
, 
ma
);

243 
	`fşo£
(
å
);

244 
	}
}

246 
	$´št_maddr
(
FILE
 *
å
, 
ma_šfo
 *
li¡
)

248 
	`årštf
(
å
, "\t");

250 ià(
li¡
->
addr
.
çmy
 =ğ
AF_PACKET
) {

251 
	`årštf
(
å
, "link ");

252 
	`´št_Îa
(
å
, 
li¡
->
addr
.
by‹Ën
, (*îi¡->addr.
d©a
);

254 
abuf
[256];

255 
li¡
->
addr
.
çmy
) {

256 
AF_INET
:

257 
	`årštf
(
å
, "inet ");

259 
AF_INET6
:

260 
	`årštf
(
å
, "inet6 ");

263 
	`årštf
(
å
, 
	`_
("çmy %d "), 
li¡
->
addr
.
çmy
);

266 ià(
	`fÜm©_ho¡
(
li¡
->
addr
.
çmy
,†i¡->addr.
d©a
, 
abuf
, (abuf)))

267 
	`årštf
(
å
, "%s", 
abuf
);

269 
	`årštf
(
å
, "?");

271 ià(
li¡
->
u£rs
 != 1)

272 
	`årštf
(
å
, 
	`_
(" u£r %d"), 
li¡
->
u£rs
);

273 ià(
li¡
->
ã©u»s
)

274 
	`årštf
(
å
, " %s", 
li¡
->
ã©u»s
);

275 
	`årštf
(
å
, "\n");

276 
	}
}

278 
	$´št_mli¡
(
FILE
 *
å
, 
ma_šfo
 *
li¡
)

280 
cur_šdex
 = 0;

282 ; 
li¡
;†i¡ =†i¡->
Ãxt
) {

283 ià(
cur_šdex
 !ğ
li¡
->
šdex
) {

284 
cur_šdex
 = 
li¡
->
šdex
;

285 
	`årštf
(
å
, "%d:\t%s\n", 
cur_šdex
, 
li¡
->
Çme
);

287 
	`´št_maddr
(
å
, 
li¡
);

289 
	}
}

291 
	$muÉŸddr_li¡
(
¬gc
, **
¬gv
)

293 
ma_šfo
 *
li¡
 = 
NULL
;

294 
size_t
 
l
;

296 
¬gc
 > 0) {

297 ià(
	`¡rcmp
(*
¬gv
, "dev") == 0) {

298 
	`NEXT_ARG
();

299 
l
 = 
	`¡¾’
(*
¬gv
);

300 ià(
l
 <ğ0 ||† >ğ(
f‹r_dev
))

301 
	`u§ge
();

302 
	`¡ºıy
(
f‹r_dev
, *
¬gv
,  (filter_dev));

303 } ià(
	`¡rcmp
(*
¬gv
, "all") == 0) {

304 
f‹r_çmy
 = 
AF_UNSPEC
;

305 } ià(
	`¡rcmp
(*
¬gv
, "ipv4") == 0) {

306 
f‹r_çmy
 = 
AF_INET
;

307 } ià(
	`¡rcmp
(*
¬gv
, "ipv6") == 0) {

308 
f‹r_çmy
 = 
AF_INET6
;

309 } ià(
	`¡rcmp
(*
¬gv
, "link") == 0) {

310 
f‹r_çmy
 = 
AF_PACKET
;

312 
l
 = 
	`¡¾’
(*
¬gv
);

313 ià(
l
 <ğ0 ||† >ğ(
f‹r_dev
))

314 
	`u§ge
();

315 
	`¡ºıy
(
f‹r_dev
, *
¬gv
,  (filter_dev));

317 
¬gv
++; 
¬gc
--;

320 ià(!
f‹r_çmy
 || f‹r_çmy =ğ
AF_PACKET
)

321 
	`»ad_dev_mÿ¡
(&
li¡
);

322 ià(!
f‹r_çmy
 || f‹r_çmy =ğ
AF_INET
)

323 
	`»ad_igmp
(&
li¡
);

324 ià(!
f‹r_çmy
 || f‹r_çmy =ğ
AF_INET6
)

325 
	`»ad_igmp6
(&
li¡
);

326 
	`´št_mli¡
(
¡dout
, 
li¡
);

328 
	}
}

330 
	$muÉŸddr_modify
(
cmd
, 
¬gc
, **
¬gv
)

332 
iäeq
 
iä
;

333 
fd
;

335 
	`mem£t
(&
iä
, 0, (ifr));

337 ià(
cmd
 =ğ
NEWADDR
)

338 
cmd
 = 
SIOCADDMULTI
;

340 
cmd
 = 
SIOCDELMULTI
;

342 
¬gc
 > 0) {

343 ià(
	`¡rcmp
(*
¬gv
, "dev") == 0) {

344 
	`NEXT_ARG
();

345 ià(
iä
.
iä_Çme
[0])

346 
	`u§ge
();

347 
	`¡ºıy
(
iä
.
iä_Çme
, *
¬gv
, 
IFNAMSIZ
);

349 ià(
iä
.
iä_hwaddr
.
§_d©a
[0])

350 
	`u§ge
();

351 ià(
	`·r£_Îa
(*
¬gv
, 
iä
.
iä_hwaddr
.
§_d©a
) < 0)

352 
	`u§ge
();

354 
¬gc
--; 
¬gv
++;

356 ià(
iä
.
iä_Çme
[0] == 0)

357 
	`u§ge
();

359 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

360 ià(
fd
 < 0) {

361 
	`³¼Ü
(
	`_
("Cannot create socket"));

362 
	`ex™
(1);

364 ià(
	`ioùl
(
fd
, 
cmd
, (*)&
iä
) != 0) {

365 
	`³¼Ü
("ioctl");

366 
	`ex™
(1);

368 
	`şo£
(
fd
);

370 
	`ex™
(0);

371 
	}
}

374 
	$do_muÉŸddr
(
¬gc
, **
¬gv
)

376 ià(
¬gc
 < 1)

377  
	`muÉŸddr_li¡
(0, 
NULL
);

378 ià(
	`m©ches
(*
¬gv
, "add") == 0)

379  
	`muÉŸddr_modify
(
NEWADDR
, 
¬gc
-1, 
¬gv
+1);

380 ià(
	`m©ches
(*
¬gv
, "delete") == 0)

381  
	`muÉŸddr_modify
(
DELADDR
, 
¬gc
-1, 
¬gv
+1);

382 ià(
	`m©ches
(*
¬gv
, "list") == 0 || matches(*argv, "show") == 0

383 || 
	`m©ches
(*
¬gv
, "lst") == 0)

384  
	`muÉŸddr_li¡
(
¬gc
-1, 
¬gv
+1);

385 
	`u§ge
();

386 
	}
}

388 
	g´eã¼ed_çmy
 = 
AF_UNSPEC
;

389 
	gshow_¡©s
 = 0;

390 
	g»sŞve_ho¡s
 = 0;

392 
	$maš
(
¬gc
, **
¬gv
)

394 *
ba£Çme
;

396 #ià
I18N


397 
	`£oÿË
 (
LC_ALL
, "");

398 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

399 
	`‹xtdomaš
("net-tools");

402 
ba£Çme
 = 
	`¡¼chr
(
¬gv
[0], '/');

403 ià(
ba£Çme
 =ğ
NULL
)

404 
ba£Çme
 = 
¬gv
[0];

406 
ba£Çme
++;

408 
¬gc
 > 1) {

409 ià(
¬gv
[1][0] != '-')

411 ià(
	`m©ches
(
¬gv
[1], "-family") == 0) {

412 
¬gc
--;

413 
¬gv
++;

414 ià(
¬gc
 <= 1)

415 
	`u§ge
();

416 ià(
	`¡rcmp
(
¬gv
[1], "inet") == 0)

417 
´eã¼ed_çmy
 = 
AF_INET
;

418 ià(
	`¡rcmp
(
¬gv
[1], "inet6") == 0)

419 
´eã¼ed_çmy
 = 
AF_INET6
;

421 
	`u§ge
();

422 } ià(
	`m©ches
(
¬gv
[1], "-stats") == 0 ||

423 
	`m©ches
(
¬gv
[1], "-statistics") == 0) {

424 ++
show_¡©s
;

425 } ià(
	`m©ches
(
¬gv
[1], "-resolve") == 0) {

426 ++
»sŞve_ho¡s
;

427 } ià((
	`m©ches
(
¬gv
[1], "-V") == 0) || matches(argv[1], "--version") == 0) {

428 
	`v”siÚ
();

430 
	`u§ge
();

431 
¬gc
--; 
¬gv
++;

434  
	`do_muÉŸddr
(
¬gc
-1, 
¬gv
+1);

435 
	}
}

	@interface/net-tools/iptunnel.c

20 
	~<¡dio.h
>

21 
	~<¡dlib.h
>

22 
	~<¡ršg.h
>

23 
	~<uni¡d.h
>

24 
	~<sy¦og.h
>

25 
	~<fú.h
>

26 
	~<sys/sock‘.h
>

27 
	~<sys/ioùl.h
>

28 
	~<Ãtš‘/š.h
>

29 
	~<Ãtš‘/.h
>

30 
	~<¬·/š‘.h
>

31 #ià
defšed
(
__GLIBC__
è&& (__GLIBC__ > 2 || (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1))

32 
	~<Ãt/if.h
>

33 
	~<Ãt/if_¬p.h
>

35 
	~<lšux/if.h
>

36 
	~<lšux/if_¬p.h
>

38 
	~<lšux/ty³s.h
>

39 
	~<lšux/if_tuÂ–.h
>

41 
	~"cÚfig.h
"

42 
	~"š.h
"

43 
	~"Ãt-suµÜt.h
"

44 
	~"v”siÚ.h
"

45 
	~"ut.h
"

47 #undeà
GRE_CSUM


48 
	#GRE_CSUM
 
	`htÚs
(0x8000)

	)

49 #undeà
GRE_ROUTING


50 
	#GRE_ROUTING
 
	`htÚs
(0x4000)

	)

51 #undeà
GRE_KEY


52 
	#GRE_KEY
 
	`htÚs
(0x2000)

	)

53 #undeà
GRE_SEQ


54 
	#GRE_SEQ
 
	`htÚs
(0x1000)

	)

55 #undeà
GRE_STRICT


56 
	#GRE_STRICT
 
	`htÚs
(0x0800)

	)

57 #undeà
GRE_REC


58 
	#GRE_REC
 
	`htÚs
(0x0700)

	)

59 #undeà
GRE_FLAGS


60 
	#GRE_FLAGS
 
	`htÚs
(0x00F8)

	)

61 #undeà
GRE_VERSION


62 
	#GRE_VERSION
 
	`htÚs
(0x0007)

	)

65 #ià
__GLIBC__
 =ğ2 && 
__GLIBC_MINOR__
 == 0

66 
	#IPPROTO_GRE
 47

	)

69 
	~"ut-ªk.h
"

71 *
	gR–—£
 = 
RELEASE
,

72 *
	gV”siÚ
 = "iptunnel 1.01",

73 *
	gSigÇtu»
 = "Alexey Kuznetsov, <kuznet@ms2.inr.ac.ru>";

75 
	$v”siÚ
()

77 
	`´štf
("%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
SigÇtu»
);

78 
	`ex™
(
E_VERSION
);

79 
	}
}

81 
	$u§ge
(è
	`__©Œibu‹__
((
nÜ‘uº
));

83 
	$u§ge
()

85 
	`årštf
(
¡d”r
, 
	`_
("Usage: iptunnel {‡dd | change | del | show } [ NAME ]\n"));

86 
	`årštf
(
¡d”r
, 
	`_
(" [ mode { ipip | gre | sit } ] [„emote ADDR ] [†ocal ADDR ]\n"));

87 
	`årštf
(
¡d”r
, 
	`_
(" [ [i|o]seq ] [ [i|o]key KEY ] [ [i|o]csum ]\n"));

88 
	`årštf
(
¡d”r
, 
	`_
(" [tl TTL ] [os TOS ] [‚opmtudisc ] [ dev PHYS_DEV ]\n"));

89 
	`årštf
(
¡d”r
, 
	`_
(" iptunnel -V | --version\n\n"));

90 
	`årštf
(
¡d”r
, 
	`_
("Where: NAME := STRING\n"));

91 
	`årštf
(
¡d”r
, 
	`_
(" ADDR := { IP_ADDRESS |‡ny }\n"));

92 
	`årštf
(
¡d”r
, 
	`_
(" TOS := { NUMBER | inherit }\n"));

93 
	`årštf
(
¡d”r
, 
	`_
(" TTL := { 1..255 | inherit }\n"));

94 
	`årštf
(
¡d”r
, 
	`_
(" KEY := { DOTTED_QUAD | NUMBER }\n"));

95 
	`ex™
(-1);

96 
	}
}

98 
	$do_ioùl_g‘_ifšdex
(*
dev
)

100 
iäeq
 
iä
;

101 
fd
;

102 
”r
;

104 
	`¡rıy
(
iä
.
iä_Çme
, 
dev
);

105 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

106 
”r
 = 
	`ioùl
(
fd
, 
SIOCGIFINDEX
, &
iä
);

107 ià(
”r
) {

108 
	`³¼Ü
("ioctl");

111 
	`şo£
(
fd
);

112  
iä
.
iä_ifšdex
;

113 
	}
}

115 
	$do_ioùl_g‘_iáy³
(*
dev
)

117 
iäeq
 
iä
;

118 
fd
;

119 
”r
;

121 
	`¡rıy
(
iä
.
iä_Çme
, 
dev
);

122 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

123 
”r
 = 
	`ioùl
(
fd
, 
SIOCGIFHWADDR
, &
iä
);

124 ià(
”r
) {

125 
	`³¼Ü
("ioctl");

128 
	`şo£
(
fd
);

129  
iä
.
iä_addr
.
§_çmy
;

130 
	}
}

133 * 
	$do_ioùl_g‘_iâame
(
idx
)

135 
iäeq
 
iä
;

136 
fd
;

137 
”r
;

139 
iä
.
iä_ifšdex
 = 
idx
;

140 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

141 
”r
 = 
	`ioùl
(
fd
, 
SIOCGIFNAME
, &
iä
);

142 ià(
”r
) {

143 
	`³¼Ü
("ioctl");

144  
NULL
;

146 
	`şo£
(
fd
);

147  
iä
.
iä_Çme
;

148 
	}
}

152 
	$do_g‘_ioùl
(*
ba£dev
, 
_tuÂ–_·rm
 *
p
)

154 
iäeq
 
iä
;

155 
fd
;

156 
”r
;

158 
	`¡rıy
(
iä
.
iä_Çme
, 
ba£dev
);

159 
iä
.
iä_iäu
.
iäu_d©a
 = (*)
p
;

160 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

161 
”r
 = 
	`ioùl
(
fd
, 
SIOCGETTUNNEL
, &
iä
);

162 ià(
”r
)

163 
	`³¼Ü
("ioctl");

164 
	`şo£
(
fd
);

165  
”r
;

166 
	}
}

168 
	$do_add_ioùl
(
cmd
, *
ba£dev
, 
_tuÂ–_·rm
 *
p
)

170 
iäeq
 
iä
;

171 
fd
;

172 
”r
;

174 
	`¡rıy
(
iä
.
iä_Çme
, 
ba£dev
);

175 
iä
.
iä_iäu
.
iäu_d©a
 = (*)
p
;

176 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

177 
”r
 = 
	`ioùl
(
fd
, 
cmd
, &
iä
);

178 ià(
”r
)

179 
	`³¼Ü
("ioctl");

180 
	`şo£
(
fd
);

181  
”r
;

182 
	}
}

184 
	$do_d–_ioùl
(*
ba£dev
, 
_tuÂ–_·rm
 *
p
)

186 
iäeq
 
iä
;

187 
fd
;

188 
”r
;

190 
	`¡rıy
(
iä
.
iä_Çme
, 
ba£dev
);

191 
iä
.
iä_iäu
.
iäu_d©a
 = (*)
p
;

192 
fd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

193 
”r
 = 
	`ioùl
(
fd
, 
SIOCDELTUNNEL
, &
iä
);

194 ià(
”r
)

195 
	`³¼Ü
("ioctl");

196 
	`şo£
(
fd
);

197  
”r
;

198 
	}
}

200 
	$·r£_¬gs
(
¬gc
, **
¬gv
, 
_tuÂ–_·rm
 *
p
)

202 
medium
[
IFNAMSIZ
];

204 
	`mem£t
(
p
, 0, (*p));

205 
	`mem£t
(&
medium
, 0, (medium));

207 
p
->
h
.
v”siÚ
 = 4;

208 
p
->
h
.
ihl
 = 5;

209 #iâdeà
IP_DF


210 
	#IP_DF
 0x4000

	)

212 
p
->
h
.
äag_off
 = 
	`htÚs
(
IP_DF
);

214 
¬gc
 > 0) {

215 ià(
	`¡rcmp
(*
¬gv
, "mode") == 0) {

216 
	`NEXT_ARG
();

217 ià(
	`¡rcmp
(*
¬gv
, "ipip") == 0) {

218 ià(
p
->
h
.
´ÙocŞ
)

219 
	`u§ge
();

220 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_IPIP
;

221 } ià(
	`¡rcmp
(*
¬gv
, "gre") == 0) {

222 ià(
p
->
h
.
´ÙocŞ
)

223 
	`u§ge
();

224 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_GRE
;

225 } ià(
	`¡rcmp
(*
¬gv
, "sit") == 0) {

226 ià(
p
->
h
.
´ÙocŞ
)

227 
	`u§ge
();

228 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_IPV6
;

230 
	`u§ge
();

231 } ià(
	`¡rcmp
(*
¬gv
, "key") == 0) {

232 
uv®
;

233 
	`NEXT_ARG
();

234 
p
->
i_æags
 |ğ
GRE_KEY
;

235 
p
->
o_æags
 |ğ
GRE_KEY
;

236 ià(
	`¡rchr
(*
¬gv
, '.'))

237 
p
->
i_key
 =…->
o_key
 = 
	`g‘_addr32
(*
¬gv
);

239 ià(
	`sÿn_numb”
(*
¬gv
, &
uv®
)<0)

240 
	`u§ge
();

241 
p
->
i_key
 =…->
o_key
 = 
	`htÚl
(
uv®
);

243 } ià(
	`¡rcmp
(*
¬gv
, "ikey") == 0) {

244 
uv®
;

245 
	`NEXT_ARG
();

246 
p
->
i_æags
 |ğ
GRE_KEY
;

247 ià(
	`¡rchr
(*
¬gv
, '.'))

248 
p
->
o_key
 = 
	`g‘_addr32
(*
¬gv
);

250 ià(
	`sÿn_numb”
(*
¬gv
, &
uv®
)<0)

251 
	`u§ge
();

252 
p
->
i_key
 = 
	`htÚl
(
uv®
);

254 } ià(
	`¡rcmp
(*
¬gv
, "okey") == 0) {

255 
uv®
;

256 
	`NEXT_ARG
();

257 
p
->
o_æags
 |ğ
GRE_KEY
;

258 ià(
	`¡rchr
(*
¬gv
, '.'))

259 
p
->
o_key
 = 
	`g‘_addr32
(*
¬gv
);

261 ià(
	`sÿn_numb”
(*
¬gv
, &
uv®
)<0)

262 
	`u§ge
();

263 
p
->
o_key
 = 
	`htÚl
(
uv®
);

265 } ià(
	`¡rcmp
(*
¬gv
, "seq") == 0) {

266 
p
->
i_æags
 |ğ
GRE_SEQ
;

267 
p
->
o_æags
 |ğ
GRE_SEQ
;

268 } ià(
	`¡rcmp
(*
¬gv
, "iseq") == 0) {

269 
p
->
i_æags
 |ğ
GRE_SEQ
;

270 } ià(
	`¡rcmp
(*
¬gv
, "oseq") == 0) {

271 
p
->
o_æags
 |ğ
GRE_SEQ
;

272 } ià(
	`¡rcmp
(*
¬gv
, "csum") == 0) {

273 
p
->
i_æags
 |ğ
GRE_CSUM
;

274 
p
->
o_æags
 |ğ
GRE_CSUM
;

275 } ià(
	`¡rcmp
(*
¬gv
, "icsum") == 0) {

276 
p
->
i_æags
 |ğ
GRE_CSUM
;

277 } ià(
	`¡rcmp
(*
¬gv
, "ocsum") == 0) {

278 
p
->
o_æags
 |ğ
GRE_CSUM
;

279 } ià(
	`¡rcmp
(*
¬gv
, "nopmtudisc") == 0) {

280 
p
->
h
.
äag_off
 = 0;

281 } ià(
	`¡rcmp
(*
¬gv
, "remote") == 0) {

282 
	`NEXT_ARG
();

283 ià(
	`¡rcmp
(*
¬gv
, "any"))

284 
p
->
h
.
daddr
 = 
	`g‘_addr32
(*
¬gv
);

285 } ià(
	`¡rcmp
(*
¬gv
, "local") == 0) {

286 
	`NEXT_ARG
();

287 ià(
	`¡rcmp
(*
¬gv
, "any"))

288 
p
->
h
.
§ddr
 = 
	`g‘_addr32
(*
¬gv
);

289 } ià(
	`¡rcmp
(*
¬gv
, "dev") == 0) {

290 
	`NEXT_ARG
();

291 
	`§ã_¡ºıy
(
medium
, *
¬gv
, 
IFNAMSIZ
-1);

292 } ià(
	`¡rcmp
(*
¬gv
, "ttl") == 0) {

293 
uv®
;

294 
	`NEXT_ARG
();

295 ià(
	`¡rcmp
(*
¬gv
, "inherit") != 0) {

296 ià(
	`sÿn_numb”
(*
¬gv
, &
uv®
)<0)

297 
	`u§ge
();

298 ià(
uv®
 > 255)

299 
	`u§ge
();

300 
p
->
h
.
‰l
 = 
uv®
;

302 } ià(
	`¡rcmp
(*
¬gv
, "tos") == 0) {

303 
uv®
;

304 
	`NEXT_ARG
();

305 ià(
	`¡rcmp
(*
¬gv
, "inherit") != 0) {

306 ià(
	`sÿn_numb”
(*
¬gv
, &
uv®
)<0)

307 
	`u§ge
();

308 ià(
uv®
 > 255)

309 
	`u§ge
();

310 
p
->
h
.
tos
 = 
uv®
;

312 
p
->
h
.
tos
 = 1;

314 ià(
p
->
Çme
[0])

315 
	`u§ge
();

316 
	`§ã_¡ºıy
(
p
->
Çme
, *
¬gv
, 
IFNAMSIZ
);

318 
¬gc
--; 
¬gv
++;

321 ià(
p
->
h
.
´ÙocŞ
 == 0) {

322 ià(
	`memcmp
(
p
->
Çme
, "gre", 3) == 0)

323 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_GRE
;

324 ià(
	`memcmp
(
p
->
Çme
, "ipip", 4) == 0)

325 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_IPIP
;

326 ià(
	`memcmp
(
p
->
Çme
, "sit", 3) == 0)

327 
p
->
h
.
´ÙocŞ
 = 
IPPROTO_IPV6
;

330 ià(
p
->
h
.
´ÙocŞ
 =ğ
IPPROTO_IPIP
 ||…->h.´ÙocŞ =ğ
IPPROTO_IPV6
) {

331 ià((
p
->
i_æags
 & 
GRE_KEY
è|| (p->
o_æags
 & GRE_KEY)) {

332 
	`årštf
(
¡d”r
, 
	`_
("Keys‡re‚ot‡llowed with ipip‡nd sit.\n"));

337 ià(
medium
[0]) {

338 
p
->
lšk
 = 
	`do_ioùl_g‘_ifšdex
(
medium
);

339 ià(
p
->
lšk
 == 0)

343 ià(
p
->
i_key
 =ğ0 && 
	`IN_MULTICAST
(
	`Áohl
Õ->
h
.
daddr
))) {

344 
p
->
i_key
 =…->
h
.
daddr
;

345 
p
->
i_æags
 |ğ
GRE_KEY
;

347 ià(
p
->
o_key
 =ğ0 && 
	`IN_MULTICAST
(
	`Áohl
Õ->
h
.
daddr
))) {

348 
p
->
o_key
 =…->
h
.
daddr
;

349 
p
->
o_æags
 |ğ
GRE_KEY
;

351 ià(
	`IN_MULTICAST
(
	`Áohl
(
p
->
h
.
daddr
)è&& !p->h.
§ddr
) {

352 
	`årštf
(
¡d”r
, 
	`_
("Broadcastunnel„equires‡ source‡ddress.\n"));

356 
	}
}

359 
	$do_add
(
cmd
, 
¬gc
, **
¬gv
)

361 
_tuÂ–_·rm
 
p
;

363 ià(
	`·r£_¬gs
(
¬gc
, 
¬gv
, &
p
) < 0)

366 ià(
p
.
h
.
‰l
 &&….h.
äag_off
 == 0) {

367 
	`årštf
(
¡d”r
, 
	`_
("ttl != 0‡nd‚optmudisc‡re incompatible\n"));

371 
p
.
h
.
´ÙocŞ
) {

372 
IPPROTO_IPIP
:

373  
	`do_add_ioùl
(
cmd
, "tuÆ0", &
p
);

374 
IPPROTO_GRE
:

375  
	`do_add_ioùl
(
cmd
, "g»0", &
p
);

376 
IPPROTO_IPV6
:

377  
	`do_add_ioùl
(
cmd
, "s™0", &
p
);

379 
	`årštf
(
¡d”r
, 
	`_
("cannot determineunnel mode (ipip, gre or sit)\n"));

383 
	}
}

385 
	$do_d–
(
¬gc
, **
¬gv
)

387 
_tuÂ–_·rm
 
p
;

389 ià(
	`·r£_¬gs
(
¬gc
, 
¬gv
, &
p
) < 0)

392 
p
.
h
.
´ÙocŞ
) {

393 
IPPROTO_IPIP
:

394  
	`do_d–_ioùl
(
p
.
Çme
[0] ?….name : "tunl0", &p);

395 
IPPROTO_GRE
:

396  
	`do_d–_ioùl
(
p
.
Çme
[0] ?….name : "gre0", &p);

397 
IPPROTO_IPV6
:

398  
	`do_d–_ioùl
(
p
.
Çme
[0] ?….name : "sit0", &p);

400  
	`do_d–_ioùl
(
p
.
Çme
, &p);

403 
	}
}

405 
	$´št_tuÂ–
(
_tuÂ–_·rm
 *
p
)

407 
s1
[256];

408 
s2
[256];

409 
s3
[64];

410 
s4
[64];

412 
	`fÜm©_ho¡
(
AF_INET
, &
p
->
h
.
daddr
, 
s1
, (s1));

413 
	`fÜm©_ho¡
(
AF_INET
, &
p
->
h
.
§ddr
, 
s2
, (s2));

414 
	`š‘_Áİ
(
AF_INET
, &
p
->
i_key
, 
s3
, (s3));

415 
	`š‘_Áİ
(
AF_INET
, &
p
->
o_key
, 
s4
, (s4));

417 
	`´štf
(
	`_
("%s: %s/ip„emote %s†ocal %s "),

418 
p
->
Çme
,

419 
p
->
h
.
´ÙocŞ
 =ğ
IPPROTO_IPIP
 ? "ip" :

420 (
p
->
h
.
´ÙocŞ
 =ğ
IPPROTO_GRE
 ? "gre" :

421 (
p
->
h
.
´ÙocŞ
 =ğ
IPPROTO_IPV6
 ? "v6" : 
	`_
("unknown"))),

422 
p
->
h
.
daddr
 ? 
s1
 : "ªy",…->h.
§ddr
 ? 
s2
 : "any");

423 ià(
p
->
lšk
) {

424 *
n
 = 
	`do_ioùl_g‘_iâame
(
p
->
lšk
);

425 ià(
n
)

426 
	`´štf
(" dev % ", 
n
);

428 ià(
p
->
h
.
‰l
)

429 
	`´štf
(" %d ", 
p
->
h
.
‰l
);

431 
	`´štf
("tl inherit ");

432 ià(
p
->
h
.
tos
) {

433 
	`´štf
("os");

434 ià(
p
->
h
.
tos
&1)

435 
	`´štf
(" inherit");

436 ià(
p
->
h
.
tos
&~1)

437 
	`´štf
("%c%02x ", 
p
->
h
.
tos
&1 ? '/' : ' ',…->iph.tos&~1);

439 ià(!(
p
->
h
.
äag_off
&
	`htÚs
(
IP_DF
)))

440 
	`´štf
("‚opmtudisc");

442 ià((
p
->
i_æags
&
GRE_KEY
è&& (p->
o_æags
&GRE_KEYè&&…->
o_key
 =ğp->
i_key
)

443 
	`´štf
(" key %s", 
s3
);

444 ià((
p
->
i_æags
|p->
o_æags
)&
GRE_KEY
) {

445 ià(
p
->
i_æags
&
GRE_KEY
)

446 
	`´štf
(" ikey % ", 
s3
);

447 ià(
p
->
o_æags
&
GRE_KEY
)

448 
	`´štf
(" okey % ", 
s4
);

450 
	`´štf
("\n");

452 ià(
p
->
i_æags
&
GRE_SEQ
)

453 
	`´štf
(
	`_
(" Drop…ackets out of sequence.\n"));

454 ià(
p
->
i_æags
&
GRE_CSUM
)

455 
	`´štf
(
	`_
(" Checksum in„eceived…acket is„equired.\n"));

456 ià(
p
->
o_æags
&
GRE_SEQ
)

457 
	`´štf
(
	`_
(" Sequence…ackets on output.\n"));

458 ià(
p
->
o_æags
&
GRE_CSUM
)

459 
	`´štf
(
	`_
(" Checksum output…ackets.\n"));

460 
	}
}

462 
	$do_tuÂ–s_li¡
(
_tuÂ–_·rm
 *
p
)

464 
Çme
[
IFNAMSIZ
];

465 
rx_by‹s
, 
rx_·ck‘s
, 
rx_”rs
, 
rx_drİs
,

466 
rx_fifo
, 
rx_äame
,

467 
tx_by‹s
, 
tx_·ck‘s
, 
tx_”rs
, 
tx_drİs
,

468 
tx_fifo
, 
tx_cŞls
, 
tx_ÿ¼›r
, 
rx_muÉi
;

469 
ty³
;

470 
_tuÂ–_·rm
 
p1
;

472 
buf
[512];

473 
FILE
 *
å
 = 
	`fİ’
("/proc/net/dev", "r");

474 ià(
å
 =ğ
NULL
) {

475 
	`³¼Ü
("fopen");

479 
	`fg‘s
(
buf
, (buf), 
å
);

480 
	`fg‘s
(
buf
, (buf), 
å
);

482 
	`fg‘s
(
buf
, (buf), 
å
è!ğ
NULL
) {

483 *
±r
;

484 
buf
[(buf) - 1] = 0;

485 ià((
±r
 = 
	`¡rchr
(
buf
, ':')è=ğ
NULL
 ||

486 (*
±r
++ = 0, 
	`ssÿnf
(
buf
, "%s", 
Çme
) != 1)) {

487 
	`årštf
(
¡d”r
, 
	`_
("Wrong format of /proc/net/dev. Sorry.\n"));

490 ià(
	`ssÿnf
(
±r
, "%ld%ld%ld%ld%ld%ld%ld%*d%ld%ld%ld%ld%ld%ld%ld",

491 &
rx_by‹s
, &
rx_·ck‘s
, &
rx_”rs
, &
rx_drİs
,

492 &
rx_fifo
, &
rx_äame
, &
rx_muÉi
,

493 &
tx_by‹s
, &
tx_·ck‘s
, &
tx_”rs
, &
tx_drİs
,

494 &
tx_fifo
, &
tx_cŞls
, &
tx_ÿ¼›r
) != 14)

496 ià(
p
->
Çme
[0] && 
	`¡rcmp
(p->name,‚ame))

498 
ty³
 = 
	`do_ioùl_g‘_iáy³
(
Çme
);

499 ià(
ty³
 == -1) {

500 
	`årštf
(
¡d”r
, 
	`_
("FaedØg‘y³ oà[%s]\n"), 
Çme
);

503 ià(
ty³
 !ğ
ARPHRD_TUNNEL
 &&y³ !ğ
ARPHRD_IPGRE
 &&y³ !ğ
ARPHRD_SIT
)

505 
	`mem£t
(&
p1
, 0, (p1));

506 ià(
	`do_g‘_ioùl
(
Çme
, &
p1
))

508 ià((
p
->
lšk
 && 
p1
.link !=…->link) ||

509 (
p
->
Çme
[0] && 
	`¡rcmp
(
p1
.name,…->name)) ||

510 (
p
->
h
.
daddr
 && 
p1
.iph.daddr !=…->iph.daddr) ||

511 (
p
->
h
.
§ddr
 && 
p1
.iph.saddr !=…->iph.saddr) ||

512 (
p
->
i_key
 && 
p1
.i_key !=…->i_key))

514 
	`´št_tuÂ–
(&
p1
);

515 ià(
show_¡©s
) {

516 
	`´štf
(
	`_
("RX: Packets Bytes Errors CsumErrs OutOfSeq Mcasts\n"));

517 
	`´štf
(" %-10ld %-12ld %-6ld %-8ld %-8ld %-8ld\n",

518 
rx_·ck‘s
, 
rx_by‹s
, 
rx_”rs
, 
rx_äame
, 
rx_fifo
, 
rx_muÉi
);

519 
	`´štf
(
	`_
("TX: Packets Bytes Errors DeadLoop NoRoute NoBufs\n"));

520 
	`´štf
(" %-10ld %-12ld %-6ld %-8ld %-8ld %-6ld\n\n",

521 
tx_·ck‘s
, 
tx_by‹s
, 
tx_”rs
, 
tx_cŞls
, 
tx_ÿ¼›r
, 
tx_drİs
);

525 
	}
}

527 
	$do_show
(
¬gc
, **
¬gv
)

529 
”r
;

530 
_tuÂ–_·rm
 
p
;

532 ià(
	`·r£_¬gs
(
¬gc
, 
¬gv
, &
p
) < 0)

535 
p
.
h
.
´ÙocŞ
) {

536 
IPPROTO_IPIP
:

537 
”r
 = 
	`do_g‘_ioùl
(
p
.
Çme
[0] ?….name : "tunl0", &p);

539 
IPPROTO_GRE
:

540 
”r
 = 
	`do_g‘_ioùl
(
p
.
Çme
[0] ?….name : "gre0", &p);

542 
IPPROTO_IPV6
:

543 
”r
 = 
	`do_g‘_ioùl
(
p
.
Çme
[0] ?….name : "sit0", &p);

546 
	`do_tuÂ–s_li¡
(&
p
);

549 ià(
”r
)

552 
	`´št_tuÂ–
(&
p
);

554 
	}
}

556 
	$do_tuÂ–
(
¬gc
, **
¬gv
)

558 ià(
¬gc
 > 0) {

559 ià(
	`m©ches
(*
¬gv
, "add") == 0)

560  
	`do_add
(
SIOCADDTUNNEL
, 
¬gc
-1, 
¬gv
+1);

561 ià(
	`m©ches
(*
¬gv
, "change") == 0)

562  
	`do_add
(
SIOCCHGTUNNEL
, 
¬gc
-1, 
¬gv
+1);

563 ià(
	`m©ches
(*
¬gv
, "del") == 0)

564  
	`do_d–
(
¬gc
-1, 
¬gv
+1);

565 ià(
	`m©ches
(*
¬gv
, "show") == 0 ||

566 
	`m©ches
(*
¬gv
, "lst") == 0 ||

567 
	`m©ches
(*
¬gv
, "list") == 0)

568  
	`do_show
(
¬gc
-1, 
¬gv
+1);

570  
	`do_show
(0, 
NULL
);

572 
	`u§ge
();

573 
	}
}

576 
	g´eã¼ed_çmy
 = 
AF_UNSPEC
;

577 
	gshow_¡©s
 = 0;

578 
	g»sŞve_ho¡s
 = 0;

580 
	$maš
(
¬gc
, **
¬gv
)

582 *
ba£Çme
;

584 #ià
I18N


585 
	`£oÿË
 (
LC_ALL
, "");

586 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

587 
	`‹xtdomaš
("net-tools");

590 
ba£Çme
 = 
	`¡¼chr
(
¬gv
[0], '/');

591 ià(
ba£Çme
 =ğ
NULL
)

592 
ba£Çme
 = 
¬gv
[0];

594 
ba£Çme
++;

596 
¬gc
 > 1) {

597 ià(
¬gv
[1][0] != '-')

599 ià(
	`m©ches
(
¬gv
[1], "-family") == 0) {

600 
¬gc
--;

601 
¬gv
++;

602 ià(
¬gc
 <= 1)

603 
	`u§ge
();

604 ià(
	`¡rcmp
(
¬gv
[1], "inet") == 0)

605 
´eã¼ed_çmy
 = 
AF_INET
;

606 ià(
	`¡rcmp
(
¬gv
[1], "inet6") == 0)

607 
´eã¼ed_çmy
 = 
AF_INET6
;

609 
	`u§ge
();

610 } ià(
	`m©ches
(
¬gv
[1], "-stats") == 0 ||

611 
	`m©ches
(
¬gv
[1], "-statistics") == 0) {

612 ++
show_¡©s
;

613 } ià(
	`m©ches
(
¬gv
[1], "-resolve") == 0) {

614 ++
»sŞve_ho¡s
;

615 } ià((
	`m©ches
(
¬gv
[1], "-V") == 0) || (matches(argv[1], "--version") == 0)) {

616 
	`v”siÚ
();

618 
	`u§ge
();

619 
¬gc
--; 
¬gv
++;

622  
	`do_tuÂ–
(
¬gc
-1, 
¬gv
+1);

623 
	}
}

	@interface/net-tools/lib/activate.c

26 
	~<¡dio.h
>

27 
	~<¡ršg.h
>

28 
	~"Ãt-suµÜt.h
"

29 
	~"·thÇmes.h
"

30 
	~"v”siÚ.h
"

31 
	~"cÚfig.h
"

32 
	~"š.h
"

34 
hwty³
 
¦_hwty³
;

35 
hwty³
 
c¦_hwty³
;

36 
hwty³
 
¦6_hwty³
;

37 
hwty³
 
c¦6_hwty³
;

38 
hwty³
 
ad­tive_hwty³
;

39 
hwty³
 
µp_hwty³
;

41 
SLIP_aùiv©e
(
fd
);

42 
CSLIP_aùiv©e
(
fd
);

43 
SLIP6_aùiv©e
(
fd
);

44 
CSLIP6_aùiv©e
(
fd
);

45 
ADAPTIVE_aùiv©e
(
fd
);

46 
PPP_aùiv©e
(
fd
);

48 
	$aùiv©e_š™
()

50 #ià
HAVE_HWSLIP


51 
¦_hwty³
.
aùiv©e
 = 
SLIP_aùiv©e
;

52 
c¦_hwty³
.
aùiv©e
 = 
CSLIP_aùiv©e
;

53 
¦6_hwty³
.
aùiv©e
 = 
SLIP6_aùiv©e
;

54 
c¦6_hwty³
.
aùiv©e
 = 
CSLIP6_aùiv©e
;

55 
ad­tive_hwty³
.
aùiv©e
 = 
ADAPTIVE_aùiv©e
;

57 #ià
HAVE_HWPPP


58 
µp_hwty³
.
aùiv©e
 = 
PPP_aùiv©e
;

60 
	}
}

62 
	$aùiv©e_ld
(cÚ¡ *
hwÇme
, 
fd
)

64 
hwty³
 *
hw
;

66 
hw
 = 
	`g‘_hwty³
(
hwÇme
);

68 ià(!
hw
) {

69 
	`årštf
(
¡d”r
, 
	`_
("H¬dw¬ty³ `%s'‚Ù suµÜ‹d.\n"), 
hwÇme
);

70  (
E_NOSUPP
);

72 ià(!
hw
->
aùiv©e
) {

73 
	`årštf
(
¡d”r
, 
	`_
("CªnÙ chªglšdisclštØ`%s'.\n"), 
hw
->
Çme
);

74  (
E_OPTERR
);

76  (
hw
->
	`aùiv©e
(
fd
));

77 
	}
}

	@interface/net-tools/lib/af.c

16 
	~<sys/ty³s.h
>

17 
	~<sys/sock‘.h
>

18 
	~<¡dlib.h
>

19 
	~<¡dio.h
>

20 
	~<”ºo.h
>

21 
	~<ùy³.h
>

22 
	~<¡ršg.h
>

23 
	~<uni¡d.h
>

24 
	~"cÚfig.h
"

25 
	~"Ãt-suµÜt.h
"

26 
	~"·thÇmes.h
"

27 
	~"š.h
"

28 
	~"ut.h
"

30 
	gæag_unx
;

31 
	gæag_x
;

32 
	gæag_ax25
;

33 
	gæag_ddp
;

34 
	gæag_ÃŒom
;

35 
	gæag_š‘
;

36 
	gæag_š‘6
;

37 
	gæag_ecÚ‘
;

38 
	gæag_ro£
;

39 
	gæag_x25
 = 0;

40 
	gæag_ash
;

43 
	saá¿ns_t
 {

44 *
	m®Ÿs
;

45 *
	mÇme
;

46 *
	mæag
;

47 } 
	gaá¿ns
[] = {

50 "ax25", "ax25", &
æag_ax25


53 "", "š‘", &
æag_š‘


56 "6", "š‘6", &
æag_š‘6


59 "x", "x", &
æag_x


62 "ro£", "ro£", &
æag_ro£


65 "­¶‘®k", "ddp", &
æag_ddp


68 "ÃŒom", "ÃŒom", &
æag_ÃŒom


71 "š‘", "š‘", &
æag_š‘


74 "š‘6", "š‘6", &
æag_š‘6


77 "ddp", "ddp", &
æag_ddp


80 "unix", "unix", &
æag_unx


83 "tı", "š‘", &
æag_š‘


86 "ecÚ‘", "ec", &
æag_ecÚ‘


89 "x25", "x25", &
æag_x25


92 "ash", "ash", &
æag_ash


99 
	gaâame
[256] = "";

101 
aáy³
 
un¥ec_aáy³
;

102 
aáy³
 
unix_aáy³
;

103 
aáy³
 
š‘_aáy³
;

104 
aáy³
 
š‘6_aáy³
;

105 
aáy³
 
ax25_aáy³
;

106 
aáy³
 
ÃŒom_aáy³
;

107 
aáy³
 
x_aáy³
;

108 
aáy³
 
ddp_aáy³
;

109 
aáy³
 
ec_aáy³
;

110 
aáy³
 
x25_aáy³
;

111 
aáy³
 
ro£_aáy³
;

112 
aáy³
 
ash_aáy³
;

114 
	gsVafš™
 = 0;

116 
aáy³
 *
	gaáy³s
[] =

118 #ià
HAVE_AFUNIX


119 &
unix_aáy³
,

121 #ià
HAVE_AFINET


122 &
š‘_aáy³
,

124 #ià
HAVE_AFINET6


125 &
š‘6_aáy³
,

127 #ià
HAVE_AFAX25


128 &
ax25_aáy³
,

130 #ià
HAVE_AFNETROM


131 &
ÃŒom_aáy³
,

133 #ià
HAVE_AFROSE


134 &
ro£_aáy³
,

136 #ià
HAVE_AFIPX


137 &
x_aáy³
,

139 #ià
HAVE_AFATALK


140 &
ddp_aáy³
,

142 #ià
HAVE_AFECONET


143 &
ec_aáy³
,

145 #ià
HAVE_AFASH


146 &
ash_aáy³
,

148 #ià
HAVE_AFX25


149 &
x25_aáy³
,

151 &
un¥ec_aáy³
,

152 
NULL


155 
	$afš™
()

157 
un¥ec_aáy³
.
t™Ë
 = 
	`_
("UNSPEC");

158 #ià
HAVE_AFUNIX


159 
unix_aáy³
.
t™Ë
 = 
	`_
("UNIX Domain");

161 #ià
HAVE_AFINET


162 
š‘_aáy³
.
t™Ë
 = 
	`_
("DARPA Internet");

164 #ià
HAVE_AFINET6


165 
š‘6_aáy³
.
t™Ë
 = 
	`_
("IPv6");

167 #ià
HAVE_AFAX25


168 
ax25_aáy³
.
t™Ë
 = 
	`_
("AMPR AX.25");

170 #ià
HAVE_AFNETROM


171 
ÃŒom_aáy³
.
t™Ë
 = 
	`_
("AMPR NET/ROM");

173 #ià
HAVE_AFIPX


174 
x_aáy³
.
t™Ë
 = 
	`_
("Novell IPX");

176 #ià
HAVE_AFATALK


177 
ddp_aáy³
.
t™Ë
 = 
	`_
("Appletalk DDP");

179 #ià
HAVE_AFECONET


180 
ec_aáy³
.
t™Ë
 = 
	`_
("Econet");

182 #ià
HAVE_AFX25


183 
x25_aáy³
.
t™Ë
 = 
	`_
("CCITT X.25");

185 #ià
HAVE_AFROSE


186 
ro£_aáy³
.
t™Ë
 = 
	`_
("AMPR ROSE");

188 #ià
HAVE_AFASH


189 
ash_aáy³
.
t™Ë
 = 
	`_
("Ash");

191 
sVafš™
 = 1;

192 
	}
}

195 
	$aá¿ns_def
(*
toŞ
, *
¬gv0
, *
dæt
)

197 *
tmp
;

198 *
buf
;

200 
	`¡rıy
(
aâame
, 
dæt
);

202 ià(!(
tmp
 = 
	`¡¼chr
(
¬gv0
, '/')))

203 
tmp
 = 
¬gv0
;

205 
tmp
++;

207 ià(!(
buf
 = 
	`¡rdup
(
tmp
)))

210 ià(
	`¡¾’
(
toŞ
è>ğ¡¾’(
tmp
)) {

211 
	`ä“
(
buf
);

214 
tmp
 = 
buf
 + (
	`¡¾’
Ñmpè- sŒËn(
toŞ
));

216 ià(
	`¡rcmp
(
tmp
, 
toŞ
) != 0) {

217 
	`ä“
(
buf
);

220 *
tmp
 = '\0';

221 ià((
tmp
 = 
	`¡rchr
(
buf
, '_')))

222 *
tmp
 = '\0';

224 
aâame
[0] = '\0';

225 ià(
	`aá¿ns_İt
(
buf
))

226 
	`¡rıy
(
aâame
, 
buf
);

228 
	`ä“
(
buf
);

229 
	}
}

233 
aáy³
 *
	$g‘_aáy³
(cÚ¡ *
Çme
)

235 
aáy³
 **
aå
;

237 ià(!
sVafš™
)

238 
	`afš™
();

240 
aå
 = 
aáy³s
;

241 *
aå
 !ğ
NULL
) {

242 ià(!
	`¡rcmp
((*
aå
)->
Çme
,‚ame))

243  (*
aå
);

244 
aå
++;

246 ià(
	`šdex
(
Çme
, ','))

247 
	`årštf
(
¡d”r
, 
	`_
("Please don't supply morehan one‡ddress family.\n"));

248  (
NULL
);

249 
	}
}

253 
aáy³
 *
	$g‘_aâty³
(
af
)

255 
aáy³
 **
aå
;

257 ià(!
sVafš™
)

258 
	`afš™
();

260 
aå
 = 
aáy³s
;

261 *
aå
 !ğ
NULL
) {

262 ià((*
aå
)->
af
 ==‡f)

263  (*
aå
);

264 
aå
++;

266  (
NULL
);

267 
	}
}

270 
	$g‘_sock‘_fÜ_af
(
af
)

272 
aáy³
 **
aå
;

274 ià(!
sVafš™
)

275 
	`afš™
();

277 
aå
 = 
aáy³s
;

278 *
aå
 !ğ
NULL
) {

279 ià((*
aå
)->
af
 ==‡f)

280  (*
aå
)->
fd
;

281 
aå
++;

284 
	}
}

286 
	$aá¿ns_İt
(cÚ¡ *
¬g
)

288 
aá¿ns_t
 *
·á
;

289 *
tmp1
, *
tmp2
;

290 
buf
[256];

292 
	`§ã_¡ºıy
(
buf
, 
¬g
, (buf));

294 
tmp1
 = 
buf
;

296 
tmp1
) {

298 
tmp2
 = 
	`šdex
(
tmp1
, ',');

300 ià(
tmp2
)

301 *(
tmp2
++) = '\0';

303 
·á
 = 
aá¿ns
;

304 
·á
 = 
aá¿ns
;…aá->
®Ÿs
;…aft++) {

305 ià(
	`¡rcmp
(
tmp1
, 
·á
->
®Ÿs
))

307 ià(
	`¡¾’
(
·á
->
Çme
è+ sŒËn(
aâame
) + 1 >= (afname)) {

308 
	`årštf
(
¡d”r
, 
	`_
("Too much‡ddress family‡rguments.\n"));

311 ià(
·á
->
æag
)

312 (*
·á
->
æag
)++;

313 ià(
aâame
[0])

314 
	`¡rÿt
(
aâame
, ",");

315 
	`¡rÿt
(
aâame
, 
·á
->
Çme
);

318 ià(!
·á
->
®Ÿs
) {

319 
	`årštf
(
¡d”r
, 
	`_
("UnknowÀadd»s çmy `%s'.\n"), 
tmp1
);

322 
tmp1
 = 
tmp2
;

326 
	}
}

329 
	$´št_aæi¡
(
ty³
) {

330 
couÁ
 = 0;

331 * 
txt
;

332 
aáy³
 **
aå
;

334 ià(!
sVafš™
)

335 
	`afš™
();

337 
aå
 = 
aáy³s
;

338 *
aå
 !ğ
NULL
) {

339 ià((
ty³
 =ğ1 && ((*
aå
)->
½ršt
 =ğ
NULL
)è|| ((*aå)->
af
 == 0)) {

340 
aå
++; ;

342 ià((
couÁ
 % 3è=ğ0è
	`årštf
(
¡d”r
,count?"\n ":" ");

343 
txt
 = (*
aå
)->
Çme
; if (!txt)xt = "..";

344 
	`årštf
(
¡d”r
,"% (%sè",
txt
,(*
aå
)->
t™Ë
);

345 
couÁ
++;

346 
aå
++;

348 
	`årštf
(
¡d”r
,"\n");

349 
	}
}

	@interface/net-tools/lib/arcnet.c

16 
	~"cÚfig.h
"

18 #ià
HAVE_HWARC


19 
	~<sys/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<Ãt/if_¬p.h
>

22 
	~<lšux/if_‘h”.h
>

23 
	~<¡dlib.h
>

24 
	~<¡dio.h
>

25 
	~<”ºo.h
>

26 
	~<ùy³.h
>

27 
	~<¡ršg.h
>

28 
	~<uni¡d.h
>

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

32 
	~"ut.h
"

34 
hwty³
 
¬ú‘_hwty³
;

38 *
	$´_¬ú‘
(*
±r
)

40 
buff
[64];

42 
	`¢´štf
(
buff
, (buff), "%02X", (
±r
[0] & 0377));

43  (
buff
);

44 
	}
}

48 
	$š_¬ú‘
(*
buå
, 
sockaddr
 *
§p
)

50 *
±r
;

51 
c
, *
Üig
;

52 
i
, 
v®
;

54 
§p
->
§_çmy
 = 
¬ú‘_hwty³
.
ty³
;

55 
±r
 = 
§p
->
§_d©a
;

57 
i
 = 0;

58 
Üig
 = 
buå
;

59 (*
buå
 !ğ'\0'è&& (
i
 < 1)) {

60 
v®
 = 0;

61 
c
 = *
buå
++;

62 ià(
	`isdig™
(
c
))

63 
v®
 = 
c
 - '0';

64 ià(
c
 >= 'a' && c <= 'f')

65 
v®
 = 
c
 - 'a' + 10;

66 ià(
c
 >= 'A' && c <= 'F')

67 
v®
 = 
c
 - 'A' + 10;

69 #ifdeà
DEBUG


70 
	`årštf
(
¡d”r
, 
	`_
("š_¬ú‘(%s): inv®id‡rú‘‡dd»ss!\n"), 
Üig
);

72 
”ºo
 = 
EINVAL
;

75 
v®
 <<= 4;

76 
c
 = *
buå
++;

77 ià(
	`isdig™
(
c
))

78 
v®
 |ğ
c
 - '0';

79 ià(
c
 >= 'a' && c <= 'f')

80 
v®
 |ğ
c
 - 'a' + 10;

81 ià(
c
 >= 'A' && c <= 'F')

82 
v®
 |ğ
c
 - 'A' + 10;

84 #ifdeà
DEBUG


85 
	`årštf
(
¡d”r
, 
	`_
("š_¬ú‘(%s): inv®id‡rú‘‡dd»ss!\n"), 
Üig
);

87 
”ºo
 = 
EINVAL
;

90 *
±r
++ = (è(
v®
 & 0377);

91 
i
++;

94 ià(*
buå
 == ':') {

95 ià(
i
 =ğ
ETH_ALEN
) {

96 #ifdeà
DEBUG


97 
	`årštf
(
¡d”r
, 
	`_
("in_arcnet(%s):railing : ignored!\n"),

98 
Üig
)

102 
buå
++;

107 ià((
i
 =ğ
ETH_ALEN
è&& (*
buå
 != '\0')) {

108 #ifdeà
DEBUG


109 
	`årštf
(
¡d”r
, 
	`_
("š_¬ú‘(%s):¿šg junk!\n"), 
Üig
);

110 
”ºo
 = 
EINVAL
;

114 #ifdeà
DEBUG


115 
	`årštf
(
¡d”r
, "š_¬ú‘(%s): %s\n", 
Üig
, 
	`´_¬ú‘
(
§p
->
§_d©a
));

119 
	}
}

122 
hwty³
 
	g¬ú‘_hwty³
 =

124 "¬ú‘", 
NULL
, 
ARPHRD_ARCNET
, 1,

125 
´_¬ú‘
, 
š_¬ú‘
, 
NULL


	@interface/net-tools/lib/ash.c

7 
	~"cÚfig.h
"

9 #ià
HAVE_HWASH
 || 
HAVE_AFASH


11 
	~<sys/ty³s.h
>

12 
	~<sys/sock‘.h
>

13 
	~<Ãt/if_¬p.h
>

14 
	~<¡dlib.h
>

15 
	~<¡dio.h
>

16 
	~<”ºo.h
>

17 
	~<ùy³.h
>

18 
	~<¡ršg.h
>

19 
	~<uni¡d.h
>

20 
	~"Ãt-suµÜt.h
"

21 
	~"·thÇmes.h
"

22 
	~"š.h
"

23 
	~"ut.h
"

25 
	#ASH_ALEN
 64

	)

27 
	ghammšg
[16] =

35 
	$´_ash
(*
±r
)

37 
buff
[128];

38 *
p
 = 
buff
;

39 
i
 = 0;

41 
p
[0] = '[';

42 
p
++;

43 
±r
[
i
] !ğ0xc9 &&…Œ[i] !ğ0xfà&& (˜< 
ASH_ALEN
))

44 
	`¥rštf
(
p
++, "%1x", 
±r
[
i
++]);

45 *(
p
++) = ']';

46 *
p
 = 0;

48  
buff
;

49 
	}
}

51 #ià
HAVE_HWASH


53 #iâdeà
ARPHRD_ASH


55 
	#ARPHRD_ASH
 517

	)

58 
hwty³
 
	gash_hwty³
;

61 
	$š_ash
(*
buå
, 
sockaddr
 *
§p
)

63 *
±r
;

64 
i
 = 0;

66 
§p
->
§_çmy
 = 
ash_hwty³
.
ty³
;

67 
±r
 = 
§p
->
§_d©a
;

69 
buå
 && 
i
 < 
ASH_ALEN
) {

70 *
Ãxt
;

71 
hİ
 = 
	`¡¹Ş
(
buå
, &
Ãxt
, 16);

72 
±r
[
i
++] = 
hammšg
[
hİ
];

73 *
Ãxt
) {

75 
buå
 = 
Ãxt
 + 1;

78 
buå
 = 
NULL
;

81 
	`årštf
(
¡d”r
, 
	`_
("Malformed Ash‡ddress"));

82 
	`mem£t
(
±r
, 0xc9, 
ASH_ALEN
);

87 
i
 < 
ASH_ALEN
)

88 
±r
[
i
++] = 0xc9;

91 
	}
}

93 
hwty³
 
	gash_hwty³
 =

95 "ash", 
NULL
, 
ARPHRD_ASH
, 
ASH_ALEN
,

96 
´_ash
, 
š_ash
, 
NULL
,

102 #ià
HAVE_AFASH


106 
	$´_§sh
(
sockaddr
 *
§p
, 
num”ic
)

108 
buf
[64];

110 ià(
§p
->
§_çmy
 !ğ
AF_ASH
)

111  
	`§ã_¡ºıy
(
buf
, "[NONE SET]", 64);

112  
	`´_ash
(
§p
->
§_d©a
);

113 
	}
}

115 
aáy³
 
	gash_aáy³
 =

117 "ash", 
NULL
, 
AF_ASH
, 0,

118 
´_ash
, 
´_§sh
, 
NULL
, NULL,

119 
NULL
, NULL, NULL,

	@interface/net-tools/lib/ax25.c

21 
	~"cÚfig.h
"

23 #ià
HAVE_AFAX25
 || 
HAVE_HWAX25


24 
	~<sys/ty³s.h
>

25 
	~<sys/ioùl.h
>

26 
	~<sys/sock‘.h
>

27 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

28 
	~<Ãx25/ax25.h
>

30 
	~<lšux/ax25.h
>

32 
	~<Ãt/if_¬p.h
>

33 
	~<¡dlib.h
>

34 
	~<¡dio.h
>

35 
	~<ùy³.h
>

36 
	~<”ºo.h
>

37 
	~<fú.h
>

38 
	~<¡ršg.h
>

39 
	~<‹rmios.h
>

40 
	~<uni¡d.h
>

41 
	~"Ãt-suµÜt.h
"

42 
	~"·thÇmes.h
"

43 
	~"š.h
"

44 
	~"ut.h
"

46 
	gAX25_”rmsg
[128];

48 
aáy³
 
ax25_aáy³
;

50 *
	$AX25_´št
(*
±r
)

52 
buff
[8];

53 
i
;

55 
i
 = 0; i < 6; i++) {

56 
buff
[
i
] = ((
±r
[i] & 0377) >> 1);

57 ià(
buff
[
i
] == ' ')

58 
buff
[
i
] = '\0';

60 
buff
[6] = '\0';

61 
i
 = ((
±r
[6] & 0x1E) >> 1);

62 ià(
i
 != 0)

63 
	`¥rštf
(&
buff
[
	`¡¾’
(buff)], "-%d", 
i
);

64  (
buff
);

65 
	}
}

70 
	$AX25_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

72 
buf
[64];

74 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

75  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

76  (
	`AX25_´št
(((
sockaddr_ax25
 *è
§p
)->
§x25_ÿÎ
.
ax25_ÿÎ
));

77 
	}
}

80 
	$AX25_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

82 *
±r
;

83 *
Üig
, 
c
;

84 
i
;

86 
§p
->
§_çmy
 = 
ax25_aáy³
.
af
;

87 
±r
 = ((
sockaddr_ax25
 *è
§p
)->
§x25_ÿÎ
.
ax25_ÿÎ
;

90 
Üig
 = 
buå
;

91 
i
 = 0;

92 (*
buå
 !ğ'\0'è&& (*buå !ğ'-'è&& (
i
 < 6)) {

93 
c
 = *
buå
++;

94 ià(
	`i¦ow”
(
c
))

95 
c
 = 
	`touµ”
(c);

96 ià(!(
	`isuµ”
(
c
è|| 
	`isdig™
(c))) {

97 
	`§ã_¡ºıy
(
AX25_”rmsg
, 
	`_
("Invalid callsign"), (AX25_errmsg));

98 #ifdeà
DEBUG


99 
	`årštf
(
¡d”r
, "ax25_šput(%s): % !\n", 
AX25_”rmsg
, 
Üig
);

101 
”ºo
 = 
EINVAL
;

104 *
±r
++ = (è((
c
 << 1) & 0xFE);

105 
i
++;

109 ià((
i
 =ğ6è&& (*
buå
 != '-') && (*bufp != '\0')) {

110 
	`¡rıy
(
AX25_”rmsg
, 
	`_
("Callsignoo†ong"));

111 #ifdeà
DEBUG


112 
	`årštf
(
¡d”r
, "ax25_šput(%s): % !\n", 
AX25_”rmsg
, 
Üig
);

114 
”ºo
 = 
E2BIG
;

118 
i
++ < (
ax25_add»ss
) - 1) {

119 *
±r
++ = () ((' ' << 1) & 0xFE);

123 ià(*
buå
 == '-') {

124 
i
 = 
	`©oi
(++
buå
);

125 *
±r
 = (è((
i
 << 1) & 0xFE);

127 *
±r
 = () '\0';

131 #ifdeà
DEBUG


132 
	`årštf
(
¡d”r
, "ax25_šput(%s): ", 
Üig
);

133 
i
 = 0; i < (
ax25_add»ss
); i++)

134 
	`årštf
(
¡d”r
, "%02X ", 
§p
->
§_d©a
[
i
] & 0377);

135 
	`årštf
(
¡d”r
, "\n");

139 
	}
}

143 
	$AX25_h”rÜ
(*
‹xt
)

145 ià(
‹xt
 =ğ
NULL
)

146 
	`årštf
(
¡d”r
, "%s\n", 
AX25_”rmsg
);

148 
	`årštf
(
¡d”r
, "%s: %s\n", 
‹xt
, 
AX25_”rmsg
);

149 
	}
}

152 
	$AX25_hšput
(*
buå
, 
sockaddr
 *
§p
)

154 ià(
	`AX25_šput
(0, 
buå
, 
§p
) < 0)

156 
§p
->
§_çmy
 = 
ARPHRD_AX25
;

158 
	}
}

162 
	$KISS_£t_disc
(
fd
, 
disc
)

164 ià(
	`ioùl
(
fd
, 
TIOCSETD
, &
disc
) < 0) {

165 
	`årštf
(
¡d”r
, "KISS_£t_disc(%d): %s\n", 
disc
, 
	`¡»¼Ü
(
”ºo
));

166  (-
”ºo
);

169 
	}
}

173 
	$KISS_š™
(
fd
)

175 ià(
	`KISS_£t_disc
(
fd
, 
N_SLIP
) < 0)

177 ià(
	`ioùl
(
fd
, 
SIOCSIFENCAP
, 4) < 0)

180 
	}
}

183 
hwty³
 
	gax25_hwty³
 =

185 "ax25", 
NULL
, 
ARPHRD_AX25
, 7,

186 
AX25_´št
, 
AX25_hšput
, 
NULL


189 
aáy³
 
	gax25_aáy³
 =

191 "ax25", 
NULL
, 
AF_AX25
, 7,

192 
AX25_´št
, 
AX25_¥ršt
, 
AX25_šput
, 
AX25_h”rÜ
,

193 
NULL
, NULL, NULL,

	@interface/net-tools/lib/ax25_gr.c

17 
	~"cÚfig.h
"

19 #ià
HAVE_AFAX25


21 
	~<sys/ty³s.h
>

22 
	~<sys/ioùl.h
>

23 
	~<sys/sock‘.h
>

24 
	~<lšux/ax25.h
>

25 
	~<lšux/if_¬p.h
>

26 
	~<ùy³.h
>

27 
	~<”ºo.h
>

28 
	~<fú.h
>

29 
	~<¡ršg.h
>

30 
	~<‹rmios.h
>

32 
	~<¡dlib.h
>

33 
	~<¡dio.h
>

34 
	~<uni¡d.h
>

35 
	~"Ãt-suµÜt.h
"

36 
	~"·thÇmes.h
"

37 
	~"š.h
"

39 
	$AX25_½ršt
(
İtiÚs
)

41 
FILE
 *
f
 = 
	`fİ’
(
_PATH_PROCNET_AX25_ROUTE
, "r");

42 
bufãr
[256];

43 
u£
;

45 ià(
f
 =ğ
NULL
) {

46 
	`³¼Ü
(
_PATH_PROCNET_AX25_ROUTE
);

47 
	`´štf
(
	`_
("AX.25‚ot configured inhis system.\n"));

50 
	`´štf
(
	`_
("Kernel AX.25„outingable\n"));

51 
	`´štf
(
	`_
("Destination Iface Use\n"));

52 
	`fg‘s
(
bufãr
, 256, 
f
);

53 
	`fg‘s
(
bufãr
, 256, 
f
)) {

54 
bufãr
[9] = 0;

55 
bufãr
[14] = 0;

56 
u£
 = 
	`©oi
(
bufãr
 + 15);

57 
	`´štf
("%-9s %-5s %5d\n",

58 
bufãr
, bufã¸+ 10, 
u£
);

60 
	`fşo£
(
f
);

62 
	}
}

	@interface/net-tools/lib/ddp.c

15 
	~"cÚfig.h
"

17 #ià
HAVE_AFATALK


18 
	~<asm/ty³s.h
>

19 
	~<sys/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<lšux/©®k.h
>

22 
	~<¡dlib.h
>

23 
	~<¡dio.h
>

24 
	~<”ºo.h
>

25 
	~<ùy³.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

28 
	~<Ãtš‘/š.h
>

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

32 
	~"ut.h
"

35 *
	$ddp_´št
(*
±r
)

37 
buff
[64];

38 
sockaddr_©
 *
§t
 = (sockaddr_© *è(
±r
 - 2);

39 
	`¥rštf
(
buff
, "%d/%d", (è
	`Áohs
(
§t
->
§t_addr
.
s_Ãt
), (è§t->§t_addr.
s_node
);

40  (
buff
);

41 
	}
}

45 *
	$ddp_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

47 
buf
[64];

49 ià(
§p
->
§_çmy
 !ğ
AF_APPLETALK
)

50  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

51  (
	`ddp_´št
(
§p
->
§_d©a
));

52 
	}
}

55 
aáy³
 
	gddp_aáy³
 =

57 "ddp", 
NULL
, 
AF_APPLETALK
, 0,

58 
ddp_´št
, 
ddp_¥ršt
, 
NULL
, NULL,

59 
NULL
 , NULL, NULL,

	@interface/net-tools/lib/ddp_gr.c

18 
	~"cÚfig.h
"

20 #ià
HAVE_AFATALK


21 
	~<asm/ty³s.h
>

22 
	~<sys/ty³s.h
>

23 
	~<sys/sock‘.h
>

24 
	~<lšux/©®k.h
>

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<”ºo.h
>

28 
	~<ùy³.h
>

29 
	~<¡ršg.h
>

30 
	~<uni¡d.h
>

31 
	~<Ãtš‘/š.h
>

32 
	~"Ãt-suµÜt.h
"

33 
	~"·thÇmes.h
"

34 
	~"š.h
"

37 
	#æags_decode
(
i
,
o
) do { \

38 
o
[0] = '\0'; \

39 ià(
i
 & 
RTF_UP
è
	`¡rÿt
(
o
, "U"); \

40 ià(
i
 & 
RTF_GATEWAY
è
	`¡rÿt
(
o
, "G"); \

41 ià(
i
 & 
RTF_REJECT
è
	`¡rÿt
(
o
, "!"); \

42 ià(
i
 & 
RTF_HOST
è
	`¡rÿt
(
o
, "H"); \

43 ià(
i
 & 
RTF_REINSTATE
è
	`¡rÿt
(
o
, "R"); \

44 ià(
i
 & 
RTF_DYNAMIC
è
	`¡rÿt
(
o
, "D"); \

45 ià(
i
 & 
RTF_MODIFIED
è
	`¡rÿt
(
o
, "M"); \

46 ià(
i
 & 
RTF_DEFAULT
è
	`¡rÿt
(
o
, "d"); \

47 ià(
i
 & 
RTF_ALLONLINK
è
	`¡rÿt
(
o
, "a"); \

48 ià(
i
 & 
RTF_ADDRCONF
è
	`¡rÿt
(
o
, "c"); \

49 ià(
i
 & 
RTF_NONEXTHOP
è
	`¡rÿt
(
o
, "o"); \

50 ià(
i
 & 
RTF_EXPIRES
è
	`¡rÿt
(
o
, "e"); \

51 ià(
i
 & 
RTF_CACHE
è
	`¡rÿt
(
o
, "c"); \

52 ià(
i
 & 
RTF_FLOW
è
	`¡rÿt
(
o
, "f"); \

53 ià(
i
 & 
RTF_POLICY
è
	`¡rÿt
(
o
, "p"); \

54 ià(
i
 & 
RTF_LOCAL
è
	`¡rÿt
(
o
, "l"); \

55 ià(
i
 & 
RTF_MTU
è
	`¡rÿt
(
o
, "u"); \

56 ià(
i
 & 
RTF_WINDOW
è
	`¡rÿt
(
o
, "w"); \

57 ià(
i
 & 
RTF_IRTT
è
	`¡rÿt
(
o
, "i"); \

58 ià(
i
 & 
RTF_NOTCACHED
è
	`¡rÿt
(
o
, "n"); \

59 } 0)

	)

61 
	$DDP_½ršt
(
İtiÚs
)

63 
FILE
 *
å
;

64 *
de¡
, *
gw
, *
dev
, *
æags
;

65 
oæags
[32];

66 *
hdr
 = "Destination Gateway Device Flags";

68 
å
 = 
	`fİ’
(
_PATH_PROCNET_ATALK_ROUTE
, "r");

70 ià(!
å
) {

71 
	`³¼Ü
("E¼Ü o³nšg " 
_PATH_PROCNET_ATALK_ROUTE
);

72 
	`årštf
(
¡d”r
, "DDP (AppleTalk)‚ot configured onhis system.\n");

76 
	`fsÿnf
(
å
, "%a %a %a %as\n", &
de¡
, &
gw
, &
æags
, &
dev
);

77 
	`ä“
(
de¡
); f»e(
gw
); f»e(
dev
); f»e(
æags
);

79 
	`´štf
("%s\n", 
hdr
);

81 
	`fsÿnf
(
å
, "%a %a %a %as\n", &
de¡
, &
gw
, &
æags
, &
dev
) == 4) {

82 
iæags
 = 
	`©oi
(
æags
);

83 
	`æags_decode
(
iæags
, 
oæags
);

84 
	`´štf
("%-16s%-16s%-16s%-s\n", 
de¡
, 
gw
, 
dev
, 
oæags
);

85 
	`ä“
(
de¡
); f»e(
gw
); f»e(
dev
); f»e(
æags
);

88 
	`fşo£
(
å
);

92 
	}
}

	@interface/net-tools/lib/ec_hw.c

15 
	~"cÚfig.h
"

17 #ià
HAVE_HWEC


19 
	~<¡dlib.h
>

20 
	~<Ãt/if_¬p.h
>

21 
	~"Ãt-suµÜt.h
"

23 
hwty³
 
	gec_hwty³
 =

25 "ec", 
NULL
 , 
ARPHRD_ECONET
, 0,

26 
NULL
, NULL, NULL

	@interface/net-tools/lib/econet.c

19 
	~"cÚfig.h
"

21 #ià
HAVE_AFECONET


23 
	~<sys/ty³s.h
>

24 
	~<sys/sock‘.h
>

25 
	~<¡dio.h
>

26 
	~<Ã‹cÚ‘/ec.h
>

28 
	~"v”siÚ.h
"

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

36 
	$ec_´št
(*
±r
)

38 
buff
[64];

39 
ec_addr
 *
ec
 = (ec_add¸*è
±r
;

40 
	`¥rštf
(
buff
, "%d.%d", 
ec
->
Ãt
,ƒc->
¡©iÚ
);

41  
buff
;

42 
	}
}

47 
	$ec_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

49 
sockaddr_ec
 *
£c
 = (sockaddr_eø*è
§p
;

51 ià(
§p
->
§_çmy
 !ğ
AF_ECONET
)

52  
	`_
("[NONE SET]");

54  
	`ec_´št
((*è&
£c
->
addr
);

55 
	}
}

58 
	$ec_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

60 
sockaddr_ec
 *
£c
 = (sockaddr_eø*è
§p
;

61 
Ãt
, 
¡n
;

62 
	`ssÿnf
(
buå
, "%d.%d", &
Ãt
, &
¡n
)) {

64 
£c
->
addr
.
¡©iÚ
 = 
¡n
;

65 
£c
->
addr
.
Ãt
 =‚et;

68 ià(
	`ssÿnf
(
buå
, "%d", &
¡n
) == 1) {

69 
£c
->
addr
.
Ãt
 = 0;

70 
£c
->
addr
.
¡©iÚ
 = 
¡n
;

75 
	}
}

77 
aáy³
 
	gec_aáy³
 =

79 "ec", 
NULL
, 
AF_ECONET
, 0,

80 
ec_´št
, 
ec_¥ršt
, 
ec_šput
, 
NULL
,

81 
NULL
, NULL, NULL,

	@interface/net-tools/lib/ether.c

16 
	~"cÚfig.h
"

18 #ià
HAVE_HWETHER


19 
	~<sys/ty³s.h
>

20 
	~<sys/sock‘.h
>

21 
	~<Ãt/if_¬p.h
>

22 
	~<lšux/if_‘h”.h
>

23 
	~<¡dlib.h
>

24 
	~<¡dio.h
>

25 
	~<”ºo.h
>

26 
	~<ùy³.h
>

27 
	~<¡ršg.h
>

28 
	~<uni¡d.h
>

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

32 
	~"ut.h
"

34 
hwty³
 
‘h”_hwty³
;

38 *
	$´_‘h”
(*
±r
)

40 
buff
[64];

42 
	`¢´štf
(
buff
, (buff), "%02x:%02x:%02x:%02x:%02x:%02x",

43 (
±r
[0] & 0377), (ptr[1] & 0377), (ptr[2] & 0377),

44 (
±r
[3] & 0377), (ptr[4] & 0377), (ptr[5] & 0377)

46  (
buff
);

47 
	}
}

51 
	$š_‘h”
(*
buå
, 
sockaddr
 *
§p
)

53 *
±r
;

54 
c
, *
Üig
;

55 
i
;

56 
v®
;

58 
§p
->
§_çmy
 = 
‘h”_hwty³
.
ty³
;

59 
±r
 = 
§p
->
§_d©a
;

61 
i
 = 0;

62 
Üig
 = 
buå
;

63 (*
buå
 !ğ'\0'è&& (
i
 < 
ETH_ALEN
)) {

64 
v®
 = 0;

65 
c
 = *
buå
++;

66 ià(
	`isdig™
(
c
))

67 
v®
 = 
c
 - '0';

68 ià(
c
 >= 'a' && c <= 'f')

69 
v®
 = 
c
 - 'a' + 10;

70 ià(
c
 >= 'A' && c <= 'F')

71 
v®
 = 
c
 - 'A' + 10;

73 #ifdeà
DEBUG


74 
	`årštf
(
¡d”r
, 
	`_
("š_‘h”(%s): inv®idƒth”‡dd»ss!\n"), 
Üig
);

76 
”ºo
 = 
EINVAL
;

79 
v®
 <<= 4;

80 
c
 = *
buå
;

81 ià(
	`isdig™
(
c
))

82 
v®
 |ğ
c
 - '0';

83 ià(
c
 >= 'a' && c <= 'f')

84 
v®
 |ğ
c
 - 'a' + 10;

85 ià(
c
 >= 'A' && c <= 'F')

86 
v®
 |ğ
c
 - 'A' + 10;

87 ià(
c
 == ':' || c == 0)

88 
v®
 >>= 4;

90 #ifdeà
DEBUG


91 
	`årštf
(
¡d”r
, 
	`_
("š_‘h”(%s): inv®idƒth”‡dd»ss!\n"), 
Üig
);

93 
”ºo
 = 
EINVAL
;

96 ià(
c
 != 0)

97 
buå
++;

98 *
±r
++ = (è(
v®
 & 0377);

99 
i
++;

102 ià(*
buå
 == ':') {

103 ià(
i
 =ğ
ETH_ALEN
) {

104 #ifdeà
DEBUG


105 
	`årštf
(
¡d”r
, 
	`_
("in_ether(%s):railing : ignored!\n"),

106 
Üig
)

110 
buå
++;

115 ià((
i
 =ğ
ETH_ALEN
è&& (*
buå
 != '\0')) {

116 #ifdeà
DEBUG


117 
	`årštf
(
¡d”r
, 
	`_
("š_‘h”(%s):¿šg junk!\n"), 
Üig
);

118 
”ºo
 = 
EINVAL
;

122 #ifdeà
DEBUG


123 
	`årštf
(
¡d”r
, "š_‘h”(%s): %s\n", 
Üig
, 
	`´_‘h”
(
§p
->
§_d©a
));

127 
	}
}

130 
hwty³
 
	g‘h”_hwty³
 =

132 "‘h”", 
NULL
, 
ARPHRD_ETHER
, 
ETH_ALEN
,

133 
´_‘h”
, 
š_‘h”
, 
NULL


	@interface/net-tools/lib/eui64.c

18 
	~"cÚfig.h
"

20 #ià
HAVE_HWEUI64


22 
	~<sys/ty³s.h
>

23 
	~<sys/ioùl.h
>

24 
	~<sys/sock‘.h
>

25 
	~<Ãt/if_¬p.h
>

26 
	~<¡dlib.h
>

27 
	~<¡dio.h
>

28 
	~<ùy³.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡ršg.h
>

32 
	~<‹rmios.h
>

33 
	~<uni¡d.h
>

34 
	~"Ãt-suµÜt.h
"

35 
	~"·thÇmes.h
"

36 
	~"š.h
"

42 
	#EUI64_ALEN
 8

	)

44 #iâdeà
ARPHRD_EUI64


45 
	#ARPHRD_EUI64
 27

	)

49 
hwty³
 
	geui64_hwty³
;

52 *
	$´_eui64
Ğ*
±r
 )

54 
buff
[64];

56 
	`¢´štf
(
buff
, (buff), "%02X:%02X:%02X:%02X:%02X:%02X:%02X:%02X",

57 (
±r
[0] & 0377), (ptr[1] & 0377), (ptr[2] & 0377), (ptr[3] & 0377),

58 (
±r
[4] & 0377), (ptr[5] & 0377), (ptr[6] & 0377), (ptr[7] & 0377)

60  (
buff
);

61 
	}
}

64 
	$š_eui64
Ğ*
buå
, 
sockaddr
 *
§p
 )

66 *
±r
;

67 
c
, *
Üig
;

68 
i
;

69 
v®
;

71 
§p
->
§_çmy
 = 
eui64_hwty³
.
ty³
;

72 
±r
 = 
§p
->
§_d©a
;

74 
i
 = 0;

75 
Üig
 = 
buå
;

77 (*
buå
 !ğ'\0'è&& (
i
 < 
EUI64_ALEN
)) {

78 
v®
 = 0;

79 
c
 = *
buå
++;

80 ià(
	`isdig™
(
c
))

81 
v®
 = 
c
 - '0';

82 ià(
c
 >= 'a' && c <= 'f')

83 
v®
 = 
c
 - 'a' + 10;

84 ià(
c
 >= 'A' && c <= 'F')

85 
v®
 = 
c
 - 'A' + 10;

87 #ifdeà
DEBUG


88 
	`årštf
Ğ
¡d”r
, 
	`_
("in_eui64(%s): invalidƒui64‡ddress!\n"),

89 
Üig
 );

91 
”ºo
 = 
EINVAL
;

95 
v®
 <<= 4;

96 
c
 = *
buå
;

97 ià(
	`isdig™
(
c
))

98 
v®
 |ğ
c
 - '0';

99 ià(
c
 >= 'a' && c <= 'f')

100 
v®
 |ğ
c
 - 'a' + 10;

101 ià(
c
 >= 'A' && c <= 'F')

102 
v®
 |ğ
c
 - 'A' + 10;

103 ià(
c
 == ':' || c == 0)

104 
v®
 >>= 4;

106 #ifdeà
DEBUG


107 
	`årštf
Ğ
¡d”r
, 
	`_
("in_eui64(%s): invalidƒui64‡ddress!\n"),

108 
Üig
 );

110 
”ºo
 = 
EINVAL
;

114 ià(
c
 != 0)

115 
buå
++;

117 *
±r
++ = (è(
v®
 & 0377);

118 
i
++;

121 ià(*
buå
 == ':') {

122 ià(
i
 =ğ
EUI64_ALEN
) {

123 #ifdeà
DEBUG


124 
	`årštf
(
¡d”r
, 
	`_
("in_eui64(%s):railing : ignored!\n"),

125 
Üig
)

129 
buå
++;

134 ià((
i
 =ğ
EUI64_ALEN
è&& (*
buå
 != '\0')) {

135 #ifdeà
DEBUG


136 
	`årštf
(
¡d”r
, 
	`_
("š_eui64(%s):¿šg junk!\n"), 
Üig
);

137 
”ºo
 = 
EINVAL
;

141 #ifdeà
DEBUG


142 
	`årštf
(
¡d”r
, "š_eui64(%s): %s\n", 
Üig
, 
	`´_eui64
(
§p
->
§_d©a
));

146 
	}
}

148 
hwty³
 
	geui64_hwty³
 =

150 "eui64", 
NULL
, 
ARPHRD_EUI64
, 
EUI64_ALEN
,

151 
´_eui64
, 
š_eui64
, 
NULL
, 0

	@interface/net-tools/lib/fddi.c

17 
	~"cÚfig.h
"

19 
	~<ã©u»s.h
>

21 #ià
HAVE_HWFDDI


22 
	~<sys/ty³s.h
>

23 
	~<sys/sock‘.h
>

24 
	~<Ãt/if_¬p.h
>

25 #iâdeà
ARPHRD_FDDI


29 #ià
__GLIBC__
 >= 2

30 
	~<Ãtš‘/if_fddi.h
>

32 
	~<lšux/if_fddi.h
>

34 
	~<¡dlib.h
>

35 
	~<¡dio.h
>

36 
	~<”ºo.h
>

37 
	~<ùy³.h
>

38 
	~<¡ršg.h
>

39 
	~<uni¡d.h
>

40 
	~"Ãt-suµÜt.h
"

41 
	~"·thÇmes.h
"

42 
	~"š.h
"

43 
	~"ut.h
"

45 
hwty³
 
fddi_hwty³
;

49 *
	$´_fddi
(*
±r
)

51 
buff
[64];

53 
	`¢´štf
(
buff
, (buff), "%02X-%02X-%02X-%02X-%02X-%02X",

54 (
±r
[0] & 0377), (ptr[1] & 0377), (ptr[2] & 0377),

55 (
±r
[3] & 0377), (ptr[4] & 0377), (ptr[5] & 0377)

57  (
buff
);

58 
	}
}

62 
	$š_fddi
(*
buå
, 
sockaddr
 *
§p
)

64 *
±r
;

65 
c
, *
Üig
;

66 
i
, 
v®
;

68 
§p
->
§_çmy
 = 
fddi_hwty³
.
ty³
;

69 
±r
 = 
§p
->
§_d©a
;

71 
i
 = 0;

72 
Üig
 = 
buå
;

73 (*
buå
 !ğ'\0'è&& (
i
 < 
FDDI_K_ALEN
)) {

74 
v®
 = 0;

75 
c
 = *
buå
++;

76 ià(
	`isdig™
(
c
))

77 
v®
 = 
c
 - '0';

78 ià(
c
 >= 'a' && c <= 'f')

79 
v®
 = 
c
 - 'a' + 10;

80 ià(
c
 >= 'A' && c <= 'F')

81 
v®
 = 
c
 - 'A' + 10;

83 #ifdeà
DEBUG


84 
	`årštf
(
¡d”r
, 
	`_
("š_fddi(%s): inv®id fdd˜add»ss!\n"), 
Üig
);

86 
”ºo
 = 
EINVAL
;

89 
v®
 <<= 4;

90 
c
 = *
buå
++;

91 ià(
	`isdig™
(
c
))

92 
v®
 |ğ
c
 - '0';

93 ià(
c
 >= 'a' && c <= 'f')

94 
v®
 |ğ
c
 - 'a' + 10;

95 ià(
c
 >= 'A' && c <= 'F')

96 
v®
 |ğ
c
 - 'A' + 10;

98 #ifdeà
DEBUG


99 
	`årštf
(
¡d”r
, 
	`_
("š_fddi(%s): inv®id fdd˜add»ss!\n"), 
Üig
);

101 
”ºo
 = 
EINVAL
;

104 *
±r
++ = (è(
v®
 & 0377);

105 
i
++;

108 ià(*
buå
 == ':') {

109 ià(
i
 =ğ
FDDI_K_ALEN
) {

110 #ifdeà
DEBUG


111 
	`årštf
(
¡d”r
, 
	`_
("in_fddi(%s):railing : ignored!\n"),

112 
Üig
)

116 
buå
++;

121 ià((
i
 =ğ
FDDI_K_ALEN
è&& (*
buå
 != '\0')) {

122 #ifdeà
DEBUG


123 
	`årštf
(
¡d”r
, 
	`_
("š_fddi(%s):¿šg junk!\n"), 
Üig
);

124 
”ºo
 = 
EINVAL
;

128 #ifdeà
DEBUG


129 
	`årštf
(
¡d”r
, "š_fddi(%s): %s\n", 
Üig
, 
	`´_fddi
(
§p
->
§_d©a
));

133 
	}
}

136 
hwty³
 
	gfddi_hwty³
 =

138 "fddi", 
NULL
, 
ARPHRD_FDDI
, 
FDDI_K_ALEN
,

139 
´_fddi
, 
š_fddi
, 
NULL


	@interface/net-tools/lib/frame.c

21 
	~"cÚfig.h
"

23 #ià
HAVE_HWFR


25 
	~<sys/ty³s.h
>

26 
	~<sys/ioùl.h
>

27 
	~<sys/sock‘.h
>

28 
	~<Ãt/if_¬p.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<fú.h
>

34 
	~<¡ršg.h
>

35 
	~<‹rmios.h
>

36 
	~<uni¡d.h
>

37 
	~"Ãt-suµÜt.h
"

38 
	~"·thÇmes.h
"

40 *
	$´_dlci
(*
±r
)

42 
buf
[12];

44 
	`¢´štf
(
buf
, (buf), "%i", *(*è
±r
);

45  (
buf
);

46 
	}
}

48 
hwty³
 
	gdlci_hwty³
 =

50 "dlci", 
NULL
, 
ARPHRD_DLCI
, 3,

51 
´_dlci
, 
NULL
, NULL, 0

54 
hwty³
 
	gäad_hwty³
 =

56 "äad", 
NULL
, 
ARPHRD_FRAD
, 0,

57 
NULL
, NULL, NULL, 0

	@interface/net-tools/lib/getargs.c

15 
	~"cÚfig.h
"

16 
	~<sys/ty³s.h
>

17 
	~<sys/sock‘.h
>

18 
	~<Ãt/if.h
>

19 
	~<”ºo.h
>

20 
	~<sigÇl.h
>

21 
	~<¡dio.h
>

22 
	~<¡dlib.h
>

23 
	~<¡ršg.h
>

24 
	~<uni¡d.h
>

25 
	~"Ãt-suµÜt.h
"

26 
	~"·thÇmes.h
"

30 
	$g‘¬gs
(*
¡ršg
, *
¬gum’ts
[])

32 
Ën
 = 
	`¡¾’
(
¡ršg
);

33 
‹mp
[
Ën
+1];

34 *
¥
, *
±r
;

35 
i
, 
¬gc
;

36 
wªt
;

42 
¥
 = 
¡ršg
;

43 
i
 = 0;

44 
	`¡rıy
(
‹mp
, 
¡ršg
);

45 
±r
 = 
‹mp
;

51 *
±r
 !ğ'\0' && 
i
 < 31) {

53 *
±r
 == ' ' || *ptr == '\t')

54 
±r
++;

57 
¬gum’ts
[
i
++] = 
¥
;

60 ià(*
±r
 == '"' || *ptr == '\'') {

66 
wªt
 = *
±r
++;

67 *
±r
 != '\0') {

68 ià(*
±r
 =ğ
wªt
 && *(ptr - 1) != '\\') {

69 
±r
++;

72 *
¥
++ = *
±r
++;

76 *
±r
 != '\0' && *ptr != ' ' && *ptr != '\t')

77 *
¥
++ = *
±r
++;

79 *
¥
++ = '\0';

82 ià(*
±r
 != '\0') {

83 *
±r
 == ' ' || *ptr == '\t')

84 
±r
++;

87 
¬gc
 = 
i
;

88 
i
 < 32)

89 
¬gum’ts
[
i
++] = (*è
NULL
;

90  (
¬gc
);

91 
	}
}

	@interface/net-tools/lib/getroute.c

32 
	~<¡dio.h
>

33 
	~<¡ršg.h
>

34 
	~"Ãt-suµÜt.h
"

35 
	~"·thÇmes.h
"

36 
	~"v”siÚ.h
"

37 
	~"cÚfig.h
"

38 
	~"š.h
"

39 
	~"ut.h
"

41 
aáy³
 
un¥ec_aáy³
;

42 
aáy³
 
unix_aáy³
;

43 
aáy³
 
š‘_aáy³
;

44 
aáy³
 
š‘6_aáy³
;

45 
aáy³
 
ax25_aáy³
;

46 
aáy³
 
ÃŒom_aáy³
;

47 
aáy³
 
x_aáy³
;

48 
aáy³
 
ddp_aáy³
;

49 
aáy³
 
x25_aáy³
;

51 
	$g‘rou‹_š™
()

53 #ià
HAVE_AFINET


54 
š‘_aáy³
.
½ršt
 = 
INET_½ršt
;

56 #ià
HAVE_AFINET6


57 
š‘6_aáy³
.
½ršt
 = 
INET6_½ršt
;

59 #ià
HAVE_AFNETROM


60 
ÃŒom_aáy³
.
½ršt
 = 
NETROM_½ršt
;

62 #ià
HAVE_AFAX25


63 
ax25_aáy³
.
½ršt
 = 
AX25_½ršt
;

65 #ià
HAVE_AFIPX


66 
x_aáy³
.
½ršt
 = 
IPX_½ršt
;

68 #ià
HAVE_AFATALK


69 
ddp_aáy³
.
½ršt
 = 
DDP_½ršt
;

71 #ià
HAVE_AFX25


72 
x25_aáy³
.
½ršt
 = 
X25_½ršt
;

74 
	}
}

76 
	$rou‹_šfo
(cÚ¡ *
aâame
, 
İtiÚs
)

78 
aáy³
 *
­
;

79 *
tmp1
, *
tmp2
;

80 
found
 = 
E_NOTFOUND
, 
rc
;

81 
buf
[256];

83 
	`§ã_¡ºıy
(
buf
, 
aâame
, (buf));

85 
tmp1
 = 
buf
;

87 
tmp1
) {

89 
­
 = 
NULL
;

91 ià((
tmp2
 = 
	`šdex
(
tmp1
, ',')))

92 *
tmp2
++ = '\0';

94 ià(!
tmp1
[0]) {

95 
tmp1
 = 
tmp2
;

98 
­
 = 
	`g‘_aáy³
(
tmp1
);

100 ià(!
­
) {

101 
	`årštf
(
¡d”r
, 
	`_
("Add»s çmy `%s'‚Ù suµÜ‹d.\n"), 
tmp1
);

102  (
E_OPTERR
);

104 
tmp1
 = 
tmp2
;

106 ià(!
­
->
½ršt
) {

107 
	`årštf
(
¡d”r
, 
	`_
("NØroutšg fÜ‡dd»s çmy `%s'.\n"), 
­
->
Çme
);

108  (
E_OPTERR
);

110 
found
 = 0;

112 ià((
rc
 = 
­
->
	`½ršt
(
İtiÚs
)))

113  (
rc
);

116  (
found
);

117 
	}
}

	@interface/net-tools/lib/hdlclapb.c

20 
	~"cÚfig.h
"

22 #ià
HAVE_HWHDLCLAPB


24 
	~<sys/ty³s.h
>

25 
	~<sys/ioùl.h
>

26 
	~<sys/sock‘.h
>

27 
	~<Ãt/if_¬p.h
>

28 
	~<¡dlib.h
>

29 
	~<¡dio.h
>

30 
	~<ùy³.h
>

31 
	~<”ºo.h
>

32 
	~<fú.h
>

33 
	~<¡ršg.h
>

34 
	~<‹rmios.h
>

35 
	~<uni¡d.h
>

36 
	~"Ãt-suµÜt.h
"

37 
	~"·thÇmes.h
"

39 #iâdeà
ARPHRD_HDLC


41 
	#ARPHRD_HDLC
 513

	)

44 #iâdeà
ARPHRD_LAPB


46 
	#ARPHRD_LAPB
 516

	)

49 
hwty³
 
	ghdlc_hwty³
 =

51 "hdlc", 
NULL
, 
ARPHRD_HDLC
, 0,

52 
NULL
, NULL, NULL, 0

54 
hwty³
 
	gÏpb_hwty³
 =

56 "Ïpb", 
NULL
, 
ARPHRD_LAPB
, 0,

57 
NULL
, NULL, NULL, 0

	@interface/net-tools/lib/hippi.c

18 
	~"cÚfig.h
"

20 #ià
HAVE_HWHIPPI


21 
	~<sys/ty³s.h
>

22 
	~<sys/sock‘.h
>

23 
	~<Ãt/if_¬p.h
>

24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<”ºo.h
>

27 
	~<ùy³.h
>

28 
	~<¡ršg.h
>

29 
	~<uni¡d.h
>

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

33 
	~"ut.h
"

39 
	#HIPPI_ALEN
 6

	)

40 #iâdeà
ARPHRD_HIPPI


41 
	#ARPHRD_HIPPI
 780

	)

45 
hwty³
 
hpi_hwty³
;

49 *
	$´_hpi
(*
±r
)

51 
buff
[64];

53 
	`¥rštf
(
buff
, "%02X:%02X:%02X:%02X:%02X:%02X",

54 (
±r
[0] & 0377), (ptr[1] & 0377), (ptr[2] & 0377),

55 (
±r
[3] & 0377), (ptr[4] & 0377), (ptr[5] & 0377)

57  (
buff
);

58 
	}
}

62 
	$š_hpi
(*
buå
, 
sockaddr
 *
§p
)

64 *
±r
;

65 
c
, *
Üig
;

66 
i
, 
v®
;

68 
§p
->
§_çmy
 = 
hpi_hwty³
.
ty³
;

69 
±r
 = 
§p
->
§_d©a
;

71 
i
 = 0;

72 
Üig
 = 
buå
;

73 (*
buå
 !ğ'\0'è&& (
i
 < 
HIPPI_ALEN
)) {

74 
v®
 = 0;

75 
c
 = *
buå
++;

76 ià(
	`isdig™
(
c
))

77 
v®
 = 
c
 - '0';

78 ià(
c
 >= 'a' && c <= 'f')

79 
v®
 = 
c
 - 'a' + 10;

80 ià(
c
 >= 'A' && c <= 'F')

81 
v®
 = 
c
 - 'A' + 10;

83 #ifdeà
DEBUG


84 
	`årštf
(
¡d”r
, 
	`_
("š_hpi(%s): inv®id hp˜add»ss!\n"), 
Üig
);

86 
”ºo
 = 
EINVAL
;

89 
v®
 <<= 4;

90 
c
 = *
buå
++;

91 ià(
	`isdig™
(
c
))

92 
v®
 |ğ
c
 - '0';

93 ià(
c
 >= 'a' && c <= 'f')

94 
v®
 |ğ
c
 - 'a' + 10;

95 ià(
c
 >= 'A' && c <= 'F')

96 
v®
 |ğ
c
 - 'A' + 10;

98 #ifdeà
DEBUG


99 
	`årštf
(
¡d”r
, 
	`_
("š_hpi(%s): inv®id hp˜add»ss!\n"), 
Üig
);

101 
”ºo
 = 
EINVAL
;

104 *
±r
++ = (è(
v®
 & 0377);

105 
i
++;

108 ià(*
buå
 == ':') {

109 ià(
i
 =ğ
HIPPI_ALEN
) {

110 #ifdeà
DEBUG


111 
	`årštf
(
¡d”r
, 
	`_
("š_hpi(%s):¿šg : ignÜed!\n"), 
Üig
)

115 
buå
++;

120 ià((
i
 =ğ
HIPPI_ALEN
è&& (*
buå
 != '\0')) {

121 #ifdeà
DEBUG


122 
	`årštf
(
¡d”r
, 
	`_
("š_hpi(%s):¿šg junk!\n"), 
Üig
);

123 
”ºo
 = 
EINVAL
;

127 #ifdeà
DEBUG


128 
	`årštf
(
¡d”r
, "š_hpi(%s): %s\n", 
Üig
, 
	`´_hpi
(
§p
->
§_d©a
));

132 
	}
}

135 
hwty³
 
	ghpi_hwty³
 =

137 "hpi", 
NULL
, 
ARPHRD_HIPPI
, 
HIPPI_ALEN
,

138 
´_hpi
, 
š_hpi
, 
NULL
, 0

	@interface/net-tools/lib/hw.c

20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<¡dlib.h
>

24 
	~<¡dio.h
>

25 
	~<”ºo.h
>

26 
	~<ùy³.h
>

27 
	~<¡ršg.h
>

28 
	~<uni¡d.h
>

29 
	~"cÚfig.h
"

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

34 
hwty³
 
un¥ec_hwty³
;

35 
hwty³
 
loİ_hwty³
;

37 
hwty³
 
¦_hwty³
;

38 
hwty³
 
c¦_hwty³
;

39 
hwty³
 
¦6_hwty³
;

40 
hwty³
 
c¦6_hwty³
;

41 
hwty³
 
ad­tive_hwty³
;

42 
hwty³
 
¡r_hwty³
;

44 
hwty³
 
‘h”_hwty³
;

45 
hwty³
 
fddi_hwty³
;

46 
hwty³
 
hpi_hwty³
;

47 
hwty³
 
Œ_hwty³
;

48 #ifdeà
ARPHRD_IEEE802_TR


49 
hwty³
 
Œ_hwty³1
;

52 
hwty³
 
ax25_hwty³
;

53 
hwty³
 
ro£_hwty³
;

54 
hwty³
 
ÃŒom_hwty³
;

55 
hwty³
 
x25_hwty³
;

56 
hwty³
 
tuÂ–_hwty³
;

58 
hwty³
 
ash_hwty³
;

60 
hwty³
 
µp_hwty³
;

62 
hwty³
 
¬ú‘_hwty³
;

64 
hwty³
 
dlci_hwty³
;

65 
hwty³
 
äad_hwty³
;

67 
hwty³
 
hdlc_hwty³
;

68 
hwty³
 
Ïpb_hwty³
;

70 
hwty³
 
s™_hwty³
;

72 
hwty³
 
œda_hwty³
;

74 
hwty³
 
ec_hwty³
;

76 
hwty³
 
ib_hwty³
;

78 
hwty³
 
eui64_hwty³
;

80 
hwty³
 *
	ghwty³s
[] =

83 &
loİ_hwty³
,

85 #ià
HAVE_HWSLIP


86 &
¦_hwty³
,

87 &
c¦_hwty³
,

88 &
¦6_hwty³
,

89 &
c¦6_hwty³
,

90 &
ad­tive_hwty³
,

92 #ià
HAVE_HWSTRIP


93 &
¡r_hwty³
,

95 #ià
HAVE_HWASH


96 &
ash_hwty³
,

98 #ià
HAVE_HWETHER


99 &
‘h”_hwty³
,

101 #ià
HAVE_HWTR


102 &
Œ_hwty³
,

103 #ifdeà
ARPHRD_IEEE802_TR


104 &
Œ_hwty³1
,

107 #ià
HAVE_HWAX25


108 &
ax25_hwty³
,

110 #ià
HAVE_HWNETROM


111 &
ÃŒom_hwty³
,

113 #ià
HAVE_HWROSE


114 &
ro£_hwty³
,

116 #ià
HAVE_HWTUNNEL


117 &
tuÂ–_hwty³
,

119 #ià
HAVE_HWPPP


120 &
µp_hwty³
,

122 #ià
HAVE_HWHDLCLAPB


123 &
hdlc_hwty³
,

124 &
Ïpb_hwty³
,

126 #ià
HAVE_HWARC


127 &
¬ú‘_hwty³
,

129 #ià
HAVE_HWFR


130 &
dlci_hwty³
,

131 &
äad_hwty³
,

133 #ià
HAVE_HWSIT


134 &
s™_hwty³
,

136 #ià
HAVE_HWFDDI


137 &
fddi_hwty³
,

139 #ià
HAVE_HWHIPPI


140 &
hpi_hwty³
,

142 #ià
HAVE_HWIRDA


143 &
œda_hwty³
,

145 #ià
HAVE_HWEC


146 &
ec_hwty³
,

148 #ià
HAVE_HWX25


149 &
x25_hwty³
,

151 #ià
HAVE_HWIB


152 &
ib_hwty³
,

154 #ià
HAVE_HWEUI64


155 &
eui64_hwty³
,

157 &
un¥ec_hwty³
,

158 
NULL


161 
	gsVhwš™
 = 0;

163 
	$hwš™
()

165 
loİ_hwty³
.
t™Ë
 = 
	`_
("Local Loopback");

166 
un¥ec_hwty³
.
t™Ë
 = 
	`_
("UNSPEC");

167 #ià
HAVE_HWSLIP


168 
¦_hwty³
.
t™Ë
 = 
	`_
("Serial Line IP");

169 
c¦_hwty³
.
t™Ë
 = 
	`_
("VJ Serial Line IP");

170 
¦6_hwty³
.
t™Ë
 = 
	`_
("6-bit Serial Line IP");

171 
c¦6_hwty³
.
t™Ë
 = 
	`_
("VJ 6-bit Serial Line IP");

172 
ad­tive_hwty³
.
t™Ë
 = 
	`_
("Adaptive Serial Line IP");

174 #ià
HAVE_HWETHER


175 
‘h”_hwty³
.
t™Ë
 = 
	`_
("Ethernet");

177 #ià
HAVE_HWASH


178 
ash_hwty³
.
t™Ë
 = 
	`_
("Ash");

180 #ià
HAVE_HWFDDI


181 
fddi_hwty³
.
t™Ë
 = 
	`_
("Fiber Distributed Data Interface");

183 #ià
HAVE_HWHIPPI


184 
hpi_hwty³
.
t™Ë
 = 
	`_
("HIPPI");

186 #ià
HAVE_HWAX25


187 
ax25_hwty³
.
t™Ë
 = 
	`_
("AMPR AX.25");

189 #ià
HAVE_HWROSE


190 
ro£_hwty³
.
t™Ë
 = 
	`_
("AMPR ROSE");

192 #ià
HAVE_HWNETROM


193 
ÃŒom_hwty³
.
t™Ë
 = 
	`_
("AMPR NET/ROM");

195 #ià
HAVE_HWX25


196 
x25_hwty³
.
t™Ë
 = 
	`_
("generic X.25");

198 #ià
HAVE_HWTUNNEL


199 
tuÂ–_hwty³
.
t™Ë
 = 
	`_
("IPIP Tunnel");

201 #ià
HAVE_HWPPP


202 
µp_hwty³
.
t™Ë
 = 
	`_
("Point-to-Point Protocol");

204 #ià
HAVE_HWHDLCLAPB


205 
hdlc_hwty³
.
t™Ë
 = 
	`_
("(Cisco)-HDLC");

206 
Ïpb_hwty³
.
t™Ë
 = 
	`_
("LAPB");

208 #ià
HAVE_HWARC


209 
¬ú‘_hwty³
.
t™Ë
 = 
	`_
("ARCnet");

211 #ià
HAVE_HWFR


212 
dlci_hwty³
.
t™Ë
 = 
	`_
("Frame Relay DLCI");

213 
äad_hwty³
.
t™Ë
 = 
	`_
("Frame Relay Access Device");

215 #ià
HAVE_HWSIT


216 
s™_hwty³
.
t™Ë
 = 
	`_
("IPv6-in-IPv4");

218 #ià
HAVE_HWIRDA


219 
œda_hwty³
.
t™Ë
 = 
	`_
("IrLAP");

221 #ià
HAVE_HWTR


222 
Œ_hwty³
.
t™Ë
 = 
	`_
("16/4 Mbps Token Ring");

223 #ifdeà
ARPHRD_IEEE802_TR


224 
Œ_hwty³1
.
t™Ë
 = 
	`_
("16/4 Mbps Token Ring (New)") ;

227 #ià
HAVE_HWEC


228 
ec_hwty³
.
t™Ë
 = 
	`_
("Econet");

230 #ià
HAVE_HWIB


231 
ib_hwty³
.
t™Ë
 = 
	`_
("InfiniBand");

233 #ià
HAVE_HWEUI64


234 
eui64_hwty³
.
t™Ë
 = 
	`_
("Generic EUI-64");

236 
sVhwš™
 = 1;

237 
	}
}

240 
hwty³
 *
	$g‘_hwty³
(cÚ¡ *
Çme
)

242 
hwty³
 **
hwp
;

244 ià(!
sVhwš™
)

245 
	`hwš™
();

247 
hwp
 = 
hwty³s
;

248 *
hwp
 !ğ
NULL
) {

249 ià(!
	`¡rcmp
((*
hwp
)->
Çme
,‚ame))

250  (*
hwp
);

251 
hwp
++;

253  (
NULL
);

254 
	}
}

258 
hwty³
 *
	$g‘_hwÁy³
(
ty³
)

260 
hwty³
 **
hwp
;

262 ià(!
sVhwš™
)

263 
	`hwš™
();

265 
hwp
 = 
hwty³s
;

266 *
hwp
 !ğ
NULL
) {

267 ià((*
hwp
)->
ty³
 ==ype)

268  (*
hwp
);

269 
hwp
++;

271  (
NULL
);

272 
	}
}

275 
	$´št_hwli¡
(
ty³
) {

276 
couÁ
 = 0;

277 * 
txt
;

278 
hwty³
 **
hwp
;

280 ià(!
sVhwš™
)

281 
	`hwš™
();

283 
hwp
 = 
hwty³s
;

284 *
hwp
 !ğ
NULL
) {

285 ià(((
ty³
 =ğ1è&& ((*
hwp
)->
®’
 == 0)) || ((*hwp)->type == -1)) {

286 
hwp
++; ;

288 ià((
couÁ
 % 3è=ğ0è
	`årštf
(
¡d”r
,count?"\n ":" ");

289 
txt
 = (*
hwp
)->
Çme
; if (!txt)xt = "..";

290 
	`årštf
(
¡d”r
,"% (%sè",
txt
,(*
hwp
)->
t™Ë
);

291 
couÁ
++;

292 
hwp
++;

294 
	`årštf
(
¡d”r
,"\n");

295 
	}
}

298 
	$hw_nuÎ_add»ss
(
hwty³
 *
hw
, *
­
)

300 
i
;

301 *
add»ss
 = (*)
­
;

302 
i
 = 0; i < 
hw
->
®’
; i++)

303 ià(
add»ss
[
i
])

306 
	}
}

	@interface/net-tools/lib/ib.c

17 
	~"cÚfig.h
"

19 #ià
HAVE_HWIB


20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<lšux/if_šfšibªd.h
>

24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<”ºo.h
>

27 
	~<ùy³.h
>

28 
	~<¡ršg.h
>

29 
	~<uni¡d.h
>

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

33 
	~"ut.h
"

35 
hwty³
 
ib_hwty³
;

39 *
	$´_ib
(*
±r
)

41 
buff
[128];

42 *
pos
;

43 
i
;

45 
pos
 = 
buff
;

46 
i
 = 0; i < 
INFINIBAND_ALEN
; i++) {

47 
pos
 +ğ
	`¥rštf
Õos, "%02X:", (*
±r
++ & 0377));

49 
buff
[
	`¡¾’
(buff) - 1] = '\0';

56  (
buff
);

57 
	}
}

61 
	$š_ib
(*
buå
, 
sockaddr
 *
§p
)

63 *
±r
;

64 
c
, *
Üig
;

65 
i
;

66 
v®
;

68 
§p
->
§_çmy
 = 
ib_hwty³
.
ty³
;

69 
±r
 = 
§p
->
§_d©a
;

71 
i
 = 0;

72 
Üig
 = 
buå
;

73 (*
buå
 !ğ'\0'è&& (
i
 < 
INFINIBAND_ALEN
)) {

74 
v®
 = 0;

75 
c
 = *
buå
++;

76 ià(
	`isdig™
(
c
))

77 
v®
 = 
c
 - '0';

78 ià(
c
 >= 'a' && c <= 'f')

79 
v®
 = 
c
 - 'a' + 10;

80 ià(
c
 >= 'A' && c <= 'F')

81 
v®
 = 
c
 - 'A' + 10;

83 #ifdeà
DEBUG


84 
	`årštf
(
¡d”r
, 
	`_
("š_ib(%s): inv®id infšibªd‡dd»ss!\n"), 
Üig
);

86 
”ºo
 = 
EINVAL
;

89 
v®
 <<= 4;

90 
c
 = *
buå
;

91 ià(
	`isdig™
(
c
))

92 
v®
 |ğ
c
 - '0';

93 ià(
c
 >= 'a' && c <= 'f')

94 
v®
 |ğ
c
 - 'a' + 10;

95 ià(
c
 >= 'A' && c <= 'F')

96 
v®
 |ğ
c
 - 'A' + 10;

97 ià(
c
 == ':' || c == 0)

98 
v®
 >>= 4;

100 #ifdeà
DEBUG


101 
	`årštf
(
¡d”r
, 
	`_
("š_ib(%s): inv®id infšibªd‡dd»ss!\n"), 
Üig
);

103 
”ºo
 = 
EINVAL
;

106 ià(
c
 != 0)

107 
buå
++;

108 *
±r
++ = (è(
v®
 & 0377);

109 
i
++;

112 ià(*
buå
 == ':') {

113 ià(
i
 =ğ
INFINIBAND_ALEN
) {

114 #ifdeà
DEBUG


115 
	`årštf
(
¡d”r
, 
	`_
("in_ib(%s):railing : ignored!\n"),

116 
Üig
)

120 
buå
++;

125 ià((
i
 =ğ
INFINIBAND_ALEN
è&& (*
buå
 != '\0')) {

126 #ifdeà
DEBUG


127 
	`årštf
(
¡d”r
, 
	`_
("š_ib(%s):¿šg junk!\n"), 
Üig
);

128 
”ºo
 = 
EINVAL
;

132 #ifdeà
DEBUG


133 
	`årštf
(
¡d”r
, "š_ib(%s): %s\n", 
Üig
, 
	`´_ib
(
§p
->
§_d©a
));

137 
	}
}

140 
hwty³
 
	gib_hwty³
 =

142 "šfšibªd", 
NULL
, 
ARPHRD_INFINIBAND
, 
INFINIBAND_ALEN
,

143 
´_ib
, 
š_ib
, 
NULL


	@interface/net-tools/lib/inet.c

29 
	~"cÚfig.h
"

34 #ià
HAVE_AFINET
 || 
HAVE_AFINET6


35 
	~<Ãtš‘/š.h
>

36 
	~<sys/ty³s.h
>

37 
	~<sys/sock‘.h
>

38 
	~<¬·/š‘.h
>

39 
	~<¬·/Çme£r.h
>

40 
	~<ùy³.h
>

41 
	~<”ºo.h
>

42 
	~<Ãtdb.h
>

43 
	~<»sŞv.h
>

44 
	~<¡dlib.h
>

45 
	~<¡ršg.h
>

46 
	~<¡dio.h
>

47 
	~<uni¡d.h
>

48 
	~"v”siÚ.h
"

49 
	~"Ãt-suµÜt.h
"

50 
	~"·thÇmes.h
"

51 
	~"š.h
"

52 
	~"ut.h
"

54 
h_”ºo
;

57 
	saddr
 {

58 
sockaddr_š
 
	maddr
;

59 *
	mÇme
;

60 
	mho¡
;

61 
addr
 *
	mÃxt
;

64 
	s£rviû
 {

65 
	mnumb”
;

66 *
	mÇme
;

67 
£rviû
 *
	mÃxt
;

70 
£rviû
 *
	gtı_Çme
 = 
NULL
, *
	gudp_Çme
 = NULL, *
	g¿w_Çme
 = NULL;

72 #ià
HAVE_AFINET


74 
addr
 *
	gINET_Â
 = 
NULL
;

77 
	$INET_»sŞve
(*
Çme
, 
sockaddr_š
 *
sš
, 
ho¡fœ¡
)

79 
ho¡’t
 *
hp
;

80 
Ã‹Á
 *
Å
;

83 
sš
->
sš_çmy
 = 
AF_INET
;

84 
sš
->
sš_pÜt
 = 0;

87 ià(!
	`¡rcmp
(
Çme
, "default")) {

88 
sš
->
sš_addr
.
s_addr
 = 
INADDR_ANY
;

92 ià(
	`š‘_©Ú
(
Çme
, &
sš
->
sš_addr
)) {

96 #ifdeà
DEBUG


97 ià(
ho¡fœ¡
è
	`årštf
 (
¡d”r
, "g‘ho¡byÇm(%s)\n", 
Çme
);

99 ià(
ho¡fœ¡
 &&

100 (
hp
 = 
	`g‘ho¡byÇme
(
Çme
)è!ğ(
ho¡’t
 *è
NULL
) {

101 
	`memıy
((*è&
sš
->
sš_addr
, (*è
hp
->
h_addr_li¡
[0],

102 (
š_addr
));

106 #ifdeà
DEBUG


107 
	`årštf
 (
¡d”r
, "g‘ÃtbyÇm(%s)\n", 
Çme
);

109 ià((
Å
 = 
	`g‘ÃtbyÇme
(
Çme
)è!ğ(
Ã‹Á
 *è
NULL
) {

110 
sš
->
sš_addr
.
s_addr
 = 
	`htÚl
(
Å
->
n_Ãt
);

113 ià(
ho¡fœ¡
) {

115 
”ºo
 = 
h_”ºo
;

118 #ifdeà
DEBUG


119 
	`»s_š™
();

120 
_»s
.
İtiÚs
 |ğ
RES_DEBUG
;

123 #ifdeà
DEBUG


124 
	`årštf
 (
¡d”r
, "g‘ho¡byÇm(%s)\n", 
Çme
);

126 ià((
hp
 = 
	`g‘ho¡byÇme
(
Çme
)è=ğ(
ho¡’t
 *è
NULL
) {

127 
”ºo
 = 
h_”ºo
;

130 
	`memıy
((*è&
sš
->
sš_addr
, (*è
hp
->
h_addr_li¡
[0],

131 (
š_addr
));

134 
	}
}

141 
	$INET_¼esŞve
(*
Çme
, 
size_t
 
Ën
, 
sockaddr_š
 *
sš
,

142 
num”ic
, 
Ãtmask
)

144 
ho¡’t
 *
’t
;

145 
Ã‹Á
 *
Å
;

146 
addr
 *
²
;

147 
u_št32_t
 
ad
, 
ho¡_ad
;

148 
ho¡
 = 0;

151 ià(
sš
->
sš_çmy
 !ğ
AF_INET
) {

152 #ifdeà
DEBUG


153 
	`årštf
(
¡d”r
, 
	`_
("¼esŞve: unsuµÜˆadd»s çmy %d !\n"), 
sš
->
sš_çmy
);

155 
”ºo
 = 
EAFNOSUPPORT
;

158 
ad
 = 
sš
->
sš_addr
.
s_addr
;

159 #ifdeà
DEBUG


160 
	`årštf
 (
¡d”r
, "¼esŞve: %08lx, mask %08x,‚um %08x \n", 
ad
, 
Ãtmask
, 
num”ic
);

162 ià(
ad
 =ğ
INADDR_ANY
) {

163 ià((
num”ic
 & 0x0FFF) == 0) {

164 ià(
num”ic
 & 0x8000)

165 
	`§ã_¡ºıy
(
Çme
, "deçuÉ", 
Ën
);

167 
	`§ã_¡ºıy
(
Çme
, "*", 
Ën
);

171 ià(
num”ic
 & 0x0FFF) {

172 
	`§ã_¡ºıy
(
Çme
, 
	`š‘_Áß
(
sš
->
sš_addr
), 
Ën
);

176 ià((
ad
 & (~
Ãtmask
)è!ğ0 || (
num”ic
 & 0x4000))

177 
ho¡
 = 1;

179 
INET_Â
 = 
NULL
;

181 
²
 = 
INET_Â
;

182 
²
 !ğ
NULL
) {

183 ià(
²
->
addr
.
sš_addr
.
s_addr
 =ğ
ad
 &&…n->
ho¡
 == host) {

184 
	`§ã_¡ºıy
(
Çme
, 
²
->Çme, 
Ën
);

185 #ifdeà
DEBUG


186 
	`årštf
 (
¡d”r
, "¼esŞve: found % %08lx iÀÿche\n", (
ho¡
? "ho¡": "Ãt"), 
ad
);

190 
²
 =…n->
Ãxt
;

193 
ho¡_ad
 = 
	`Áohl
(
ad
);

194 
Å
 = 
NULL
;

195 
’t
 = 
NULL
;

196 ià(
ho¡
) {

197 #ifdeà
DEBUG


198 
	`årštf
 (
¡d”r
, "g‘ho¡byadd¸(%08lx)\n", 
ad
);

200 
’t
 = 
	`g‘ho¡byaddr
((*è&
ad
, 4, 
AF_INET
);

201 ià(
’t
 !ğ
NULL
)

202 
	`§ã_¡ºıy
(
Çme
, 
’t
->
h_Çme
, 
Ën
);

204 #ifdeà
DEBUG


205 
	`årštf
 (
¡d”r
, "g‘Ãtbyadd¸(%08lx)\n", 
ho¡_ad
);

207 
Å
 = 
	`g‘Ãtbyaddr
(
ho¡_ad
, 
AF_INET
);

208 ià(
Å
 !ğ
NULL
)

209 
	`§ã_¡ºıy
(
Çme
, 
Å
->
n_Çme
, 
Ën
);

211 ià((
’t
 =ğ
NULL
è&& (
Å
 == NULL))

212 
	`§ã_¡ºıy
(
Çme
, 
	`š‘_Áß
(
sš
->
sš_addr
), 
Ën
);

213 
²
 = (
addr
 *è
	`m®loc
((addr));

214 
²
->
addr
 = *
sš
;

215 
²
->
Ãxt
 = 
INET_Â
;

216 
²
->
ho¡
 = host;

217 
²
->
Çme
 = (*è
	`m®loc
(
	`¡¾’
(name) + 1);

218 
	`¡rıy
(
²
->
Çme
,‚ame);

219 
INET_Â
 = 
²
;

222 
	}
}

225 
	$INET_»£¼Ü
(*
‹xt
)

227 
	`h”rÜ
(
‹xt
);

228 
	}
}

232 *
	$INET_´št
(*
±r
)

234  (
	`š‘_Áß
((*(
š_addr
 *è
±r
)));

235 
	}
}

239 *
	$INET_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

241 
buff
[128];

243 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

244  
	`§ã_¡ºıy
(
buff
, 
	`_
("[NONE SET]"), (buff));

246 ià(
	`INET_¼esŞve
(
buff
, (buff), (
sockaddr_š
 *è
§p
,

247 
num”ic
, 0xffffff00) != 0)

248  (
NULL
);

250  (
buff
);

251 
	}
}

253 *
	$INET_¥rštmask
(
sockaddr
 *
§p
, 
num”ic
,

254 
Ãtmask
)

256 
buff
[128];

258 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

259  
	`§ã_¡ºıy
(
buff
, 
	`_
("[NONE SET]"), (buff));

260 ià(
	`INET_¼esŞve
(
buff
, (buff), (
sockaddr_š
 *è
§p
,

261 
num”ic
, 
Ãtmask
) != 0)

262  (
NULL
);

263  (
buff
);

264 
	}
}

267 
	$INET_g‘sock
(*
buå
, 
sockaddr
 *
§p
)

269 *
¥
 = 
buå
, *
bp
;

270 
i
;

271 
v®
;

272 
sockaddr_š
 *
sš
;

274 
sš
 = (
sockaddr_š
 *è
§p
;

275 
sš
->
sš_çmy
 = 
AF_INET
;

276 
sš
->
sš_pÜt
 = 0;

278 
v®
 = 0;

279 
bp
 = (*è&
v®
;

280 
i
 = 0; i < (
sš
->
sš_addr
.
s_addr
); i++) {

281 *
¥
 = 
	`touµ”
(*sp);

283 ià((*
¥
 >= 'A') && (*sp <= 'F'))

284 
bp
[
i
] |ğ(è(*
¥
 - 'A') + 10;

285 ià((*
¥
 >= '0') && (*sp <= '9'))

286 
bp
[
i
] |ğ(è(*
¥
 - '0');

290 
bp
[
i
] <<= 4;

291 
¥
++;

292 *
¥
 = 
	`touµ”
(*sp);

294 ià((*
¥
 >= 'A') && (*sp <= 'F'))

295 
bp
[
i
] |ğ(è(*
¥
 - 'A') + 10;

296 ià((*
¥
 >= '0') && (*sp <= '9'))

297 
bp
[
i
] |ğ(è(*
¥
 - '0');

301 
¥
++;

303 
sš
->
sš_addr
.
s_addr
 = 
	`htÚl
(
v®
);

305  (
¥
 - 
buå
);

306 
	}
}

308 
	$INET_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

310 
ty³
) {

312  (
	`INET_g‘sock
(
buå
, 
§p
));

314  (
	`INET_»sŞve
(
buå
, (
sockaddr_š
 *è
§p
, 1));

316  (
	`INET_»sŞve
(
buå
, (
sockaddr_š
 *è
§p
, 0));

318 
	}
}

320 
	$INET_g‘Ãtmask
(*
adr
, 
sockaddr
 *
m
, *
Çme
)

322 
sockaddr_š
 *
mask
 = (sockaddr_š *è
m
;

323 *
¦ash
, *
’d
;

324 
´efix
;

326 ià((
¦ash
 = 
	`¡rchr
(
adr
, '/')è=ğ
NULL
)

329 *
¦ash
++ = '\0';

330 
´efix
 = 
	`¡¹oul
(
¦ash
, &
’d
, 0);

331 ià(*
’d
 != '\0')

334 ià(
Çme
) {

335 
	`¥rštf
(
Çme
, "/%d", 
´efix
);

337 
mask
->
sš_çmy
 = 
AF_INET
;

338 
mask
->
sš_addr
.
s_addr
 = 
	`htÚl
(~(0xffffffffU >> 
´efix
));

340 
	}
}

343 
aáy³
 
	gš‘_aáy³
 =

345 "š‘", 
NULL
, 
AF_INET
, (),

346 
INET_´št
, 
INET_¥ršt
, 
INET_šput
, 
INET_»£¼Ü
,

347 
NULL
 , NULL ,

348 
INET_g‘Ãtmask
,

350 
NULL


355 
	$add2li¡
(
£rviû
 **
Çmeba£
, £rviû *
™em
)

357 ià(*
Çmeba£
 =ğ
NULL
) {

358 *
Çmeba£
 = 
™em
;

359 
™em
->
Ãxt
 = 
NULL
;

361 
™em
->
Ãxt
 = *
Çmeba£
;

362 *
Çmeba£
 = 
™em
;

364 
	}
}

367 
£rviû
 *
	$£¬chli¡
(
£rviû
 *
£rviûba£
, 
numb”
)

369 
£rviû
 *
™em
;

371 
™em
 = 
£rviûba£
; i‹m !ğ
NULL
; i‹m = i‹m->
Ãxt
) {

372 ià(
™em
->
numb”
 ==‚umber)

373  (
™em
);

375  (
NULL
);

376 
	}
}

379 
	$»ad_£rviûs
()

381 
£rv’t
 *
£
;

382 
´ÙÛÁ
 *
³
;

383 
£rviû
 *
™em
;

385 
	`£t£rv’t
(1);

386 (
£
 = 
	`g‘£rv’t
())) {

388 
™em
 = (
£rviû
 *è
	`m®loc
((service));

389 ià(
™em
 =ğ
NULL
)

390 
	`³¼Ü
("netstat");

391 
™em
->
Çme
 = 
	`¡rdup
(
£
->
s_Çme
);

392 
™em
->
numb”
 = 
£
->
s_pÜt
;

395 ià(!
	`¡rcmp
(
£
->
s_´Ùo
, "tcp")) {

396 
	`add2li¡
(&
tı_Çme
, 
™em
);

397 } ià(!
	`¡rcmp
(
£
->
s_´Ùo
, "udp")) {

398 
	`add2li¡
(&
udp_Çme
, 
™em
);

399 } ià(!
	`¡rcmp
(
£
->
s_´Ùo
, "raw")) {

400 
	`add2li¡
(&
¿w_Çme
, 
™em
);

403 
	`’d£rv’t
();

404 
	`£rÙÛÁ
(1);

405 (
³
 = 
	`g‘´ÙÛÁ
())) {

407 
™em
 = (
£rviû
 *è
	`m®loc
((service));

408 ià(
™em
 =ğ
NULL
)

409 
	`³¼Ü
("netstat");

410 
™em
->
Çme
 = 
	`¡rdup
(
³
->
p_Çme
);

411 
™em
->
numb”
 = 
	`htÚs
(
³
->
p_´Ùo
);

412 
	`add2li¡
(&
¿w_Çme
, 
™em
);

414 
	`’d´ÙÛÁ
();

416 
	}
}

419 *
	$g‘_¢ame
(
socknumb”
, *
´Ùo
, 
num”ic
)

421 
bufãr
[64], 
š™
 = 0;

422 
£rviû
 *
™em
;

424 ià(
socknumb”
 == 0)

426 ià(
num”ic
) {

427 
	`¥rštf
(
bufãr
, "%d", 
	`Áohs
(
socknumb”
));

428  (
bufãr
);

430 ià(!
š™
) {

431 (è
	`»ad_£rviûs
();

432 
š™
 = 1;

434 
bufãr
[0] = '\0';

435 ià(!
	`¡rcmp
(
´Ùo
, "tcp")) {

436 ià((
™em
 = 
	`£¬chli¡
(
tı_Çme
, 
socknumb”
)è!ğ
NULL
)

437 
	`¥rštf
(
bufãr
, "%s", 
™em
->
Çme
);

438 } ià(!
	`¡rcmp
(
´Ùo
, "udp")) {

439 ià((
™em
 = 
	`£¬chli¡
(
udp_Çme
, 
socknumb”
)è!ğ
NULL
)

440 
	`¥rštf
(
bufãr
, "%s", 
™em
->
Çme
);

441 } ià(!
	`¡rcmp
(
´Ùo
, "raw")) {

442 ià((
™em
 = 
	`£¬chli¡
(
¿w_Çme
, 
socknumb”
)è!ğ
NULL
)

443 
	`¥rštf
(
bufãr
, "%s", 
™em
->
Çme
);

446 ià(!
bufãr
[0])

447 
	`¥rštf
(
bufãr
, "%d", 
	`Áohs
(
socknumb”
));

448  (
bufãr
);

449 
	}
}

	@interface/net-tools/lib/inet6.c

22 
	~"cÚfig.h
"

24 #ià
HAVE_AFINET6


25 
	~<asm/ty³s.h
>

26 
	~<sys/ty³s.h
>

27 
	~<sys/sock‘.h
>

28 
	~<Ãtš‘/š.h
>

29 
	~<¬·/š‘.h
>

30 
	~<¬·/Çme£r.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<Ãtdb.h
>

34 
	~<»sŞv.h
>

35 
	~<¡dlib.h
>

36 
	~<¡ršg.h
>

37 
	~<¡dio.h
>

38 
	~<uni¡d.h
>

39 
	~"v”siÚ.h
"

40 
	~"Ãt-suµÜt.h
"

41 
	~"·thÇmes.h
"

42 
	~"š.h
"

43 
	~"ut.h
"

45 
h_”ºo
;

47 * 
	$fix_v4_add»ss
(*
buf
, 
š6_addr
 *
š6
)

49 ià(
	`IN6_IS_ADDR_V4MAPPED
(
š6
->
s6_addr
)) {

50 *
s
 =
	`¡rchr
(
buf
, '.');

51 ià(
s
) {

52 
s
 > 
buf
 && *s != ':')

53 --
s
;

54 ià(*
s
 == ':') ++s;

55 
s
 = 
NULL
;

57 ià(
s
)  s;

59  
buf
;

60 
	}
}

62 
	$INET6_»sŞve
(*
Çme
, 
sockaddr_š6
 *
sš6
)

64 
addršfo
 
»q
, *
ai
;

65 
s
;

67 
	`mem£t
 (&
»q
, '\0', „eq);

68 
»q
.
ai_çmy
 = 
AF_INET6
;

69 ià((
s
 = 
	`g‘addršfo
(
Çme
, 
NULL
, &
»q
, &
ai
))) {

70 
	`årštf
(
¡d”r
, "g‘addršfo: %s: %d\n", 
Çme
, 
s
);

73 
	`memıy
(
sš6
, 
ai
->
ai_addr
, (
sockaddr_š6
));

75 
	`ä“addršfo
(
ai
);

78 
	}
}

80 #iâdeà
IN6_IS_ADDR_UNSPECIFIED


81 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

82 (((
__u32
 *è(
a
))[0] == 0 && ((__u32 *) (a))[1] == 0 && \

83 ((
__u32
 *è(
a
))[2] =ğ0 && ((__u32 *è×))[3] =ğ0)

	)

87 
	$INET6_¼esŞve
(*
Çme
, 
sockaddr_š6
 *
sš6
, 
num”ic
)

89 
s
;

92 ià(
sš6
->
sš6_çmy
 !ğ
AF_INET6
) {

93 #ifdeà
DEBUG


94 
	`årštf
(
¡d”r
, 
	`_
("rresolve: unsupport‡ddress family %d !\n"),

95 
sš6
->
sš6_çmy
);

97 
”ºo
 = 
EAFNOSUPPORT
;

100 ià(
num”ic
 & 0x7FFF) {

101 
	`š‘_Áİ
Ğ
AF_INET6
, &
sš6
->
sš6_addr
, 
Çme
, 80);

104 ià(
	`IN6_IS_ADDR_UNSPECIFIED
(&
sš6
->
sš6_addr
)) {

105 ià(
num”ic
 & 0x8000)

106 
	`¡rıy
(
Çme
, "default");

108 
	`¡rıy
(
Çme
, "[::]");

112 ià((
s
 = 
	`g‘Çmešfo
((
sockaddr
 *è
sš6
, (
sockaddr_š6
),

113 
Çme
, 255 , 
NULL
, 0, 0))) {

114 
	`åuts
("g‘ÇmešfØçed\n", 
¡d”r
);

118 
	}
}

121 
	$INET6_»£¼Ü
(*
‹xt
)

123 
	`h”rÜ
(
‹xt
);

124 
	}
}

129 *
	$INET6_´št
(*
±r
)

131 
Çme
[80];

133 
	`š‘_Áİ
(
AF_INET6
, (
š6_addr
 *è
±r
, 
Çme
, 80);

134  
	`fix_v4_add»ss
(
Çme
, (
š6_addr
 *)
±r
);

135 
	}
}

140 *
	$INET6_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

142 
buff
[128];

144 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

145  
	`§ã_¡ºıy
(
buff
, 
	`_
("[NONE SET]"), (buff));

146 ià(
	`INET6_¼esŞve
(
buff
, (
sockaddr_š6
 *è
§p
, 
num”ic
) != 0)

147  
	`§ã_¡ºıy
(
buff
, 
	`_
("[UNKNOWN]"), (buff));

148  (
	`fix_v4_add»ss
(
buff
, &((
sockaddr_š6
 *)
§p
)->
sš6_addr
));

149 
	}
}

152 
	$INET6_g‘sock
(*
buå
, 
sockaddr
 *
§p
)

154 
sockaddr_š6
 *
sš6
;

155 *
p
;

157 
sš6
 = (
sockaddr_š6
 *è
§p
;

158 
sš6
->
sš6_çmy
 = 
AF_INET6
;

159 
sš6
->
sš6_pÜt
 = 0;

160 
sš6
->
sš6_scİe_id
 = 0;

161 
sš6
->
sš6_æowšfo
 = 0;

163 ià(
	`š‘_±Ú
(
AF_INET6
, 
buå
, 
sš6
->
sš6_addr
.
s6_addr
) <= 0)

165 
p
 = 
	`fix_v4_add»ss
(
buå
, &
sš6
->
sš6_addr
);

166 ià(
p
 !ğ
buå
)

167 
	`memıy
(
buå
, 
p
, 
	`¡¾’
(p)+1);

169 
	}
}

171 
	$INET6_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

173 
ty³
) {

175  (
	`INET6_g‘sock
(
buå
, 
§p
));

177  (
	`INET6_»sŞve
(
buå
, (
sockaddr_š6
 *è
§p
));

179 
	}
}

182 
aáy³
 
	gš‘6_aáy³
 =

184 "š‘6", 
NULL
, 
AF_INET6
, (
š6_addr
),

185 
INET6_´št
, 
INET6_¥ršt
, 
INET6_šput
, 
INET6_»£¼Ü
,

186 
INET6_½ršt
, 
INET6_ršput
, 
NULL
,

	@interface/net-tools/lib/inet6_gr.c

7 
	~"cÚfig.h
"

9 #ià
HAVE_AFINET6


10 
	~<asm/ty³s.h
>

11 
	~<asm/·¿m.h
>

12 
	~<sys/ty³s.h
>

13 
	~<sys/sock‘.h
>

14 
	~<Ãtš‘/š.h
>

15 
	~<¬·/š‘.h
>

16 
	~<¬·/Çme£r.h
>

18 
	~<ùy³.h
>

19 
	~<”ºo.h
>

20 
	~<Ãtdb.h
>

21 
	~<»sŞv.h
>

22 
	~<¡dlib.h
>

23 
	~<¡ršg.h
>

24 
	~<¡dio.h
>

25 
	~<uni¡d.h
>

26 #iâdeà
__GLIBC__


27 
	~<Ãtš‘6/v6_rou‹.h
>

29 
	~"v”siÚ.h
"

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

33 
	~"Ãt-ã©u»s.h
"

37 
	#NUD_INCOMPLETE
 0x01

	)

38 
	#NUD_REACHABLE
 0x02

	)

39 
	#NUD_STALE
 0x04

	)

40 
	#NUD_DELAY
 0x08

	)

41 
	#NUD_PROBE
 0x10

	)

42 
	#NUD_FAILED
 0x20

	)

44 
	#NUD_NOARP
 0x40

	)

45 
	#NUD_PERMANENT
 0x80

	)

46 
	#NUD_NONE
 0x00

	)

48 
	#NTF_PROXY
 0x08

	)

49 
	#NTF_ROUTER
 0x80

	)

50 
	#NTF_02
 0x02

	)

51 
	#NTF_04
 0x04

	)

56 
aáy³
 
š‘6_aáy³
;

59 
	$½ršt_fib6
(
ext
, 
num”ic
)

61 
buff
[4096], 
içû
[16], 
æags
[16];

62 
addr6
[128], 
Çddr6
[128];

63 
sockaddr_š6
 
§ddr6
, 
¢addr6
;

64 
num
, 
iæags
, 
m‘ric
, 
»fút
, 
u£
, 
´efix_Ën
, 
¦’
;

65 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_ROUTE6
, "r");

67 
addr6p
[8][5], 
§ddr6p
[8][5], 
Çddr6p
[8][5];

69 ià(!
å
) {

70 
	`³¼Ü
(
_PATH_PROCNET_ROUTE6
);

71 
	`´štf
(
	`_
("INET6 (IPv6)‚ot configured inhis system.\n"));

75 ià(
num”ic
 & 
RTF_CACHE
)

76 
	`´štf
(
	`_
("Kernel IPv6„outing cache\n"));

78 
	`´štf
(
	`_
("Kernel IPv6„outingable\n"));

80 
	`´štf
(
	`_
("Destination "

84 
	`fg‘s
(
buff
, 1023, 
å
)) {

85 
num
 = 
	`ssÿnf
(
buff
, "%4s%4s%4s%4s%4s%4s%4s%4s %02x %4s%4s%4s%4s%4s%4s%4s%4s %02x %4s%4s%4s%4s%4s%4s%4s%4s %08x %08x %08x %08x %s\n",

86 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

87 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7],

88 &
´efix_Ën
,

89 
§ddr6p
[0], saddr6p[1], saddr6p[2], saddr6p[3],

90 
§ddr6p
[4], saddr6p[5], saddr6p[6], saddr6p[7],

91 &
¦’
,

92 
Çddr6p
[0],‚addr6p[1],‚addr6p[2],‚addr6p[3],

93 
Çddr6p
[4],‚addr6p[5],‚addr6p[6],‚addr6p[7],

94 &
m‘ric
, &
»fút
, &
u£
, &
iæags
, 
içû
);

96 ià(
num
 < 23)

99 ià(
iæags
 & 
RTF_CACHE
) {

100 ià(!(
num”ic
 & 
RTF_CACHE
))

103 ià(
num”ic
 & 
RTF_CACHE
)

108 
	`¢´štf
(
addr6
, (addr6), "%s:%s:%s:%s:%s:%s:%s:%s",

109 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

110 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7]);

111 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
§ddr6
);

112 
	`¢´štf
(
addr6
, (addr6), "%s/%d",

113 
š‘6_aáy³
.
	`¥ršt
((
sockaddr
 *è&
§ddr6
, 1),

114 
´efix_Ën
);

117 
	`¢´štf
(
Çddr6
, (naddr6), "%s:%s:%s:%s:%s:%s:%s:%s",

118 
Çddr6p
[0],‚addr6p[1],‚addr6p[2],‚addr6p[3],

119 
Çddr6p
[4],‚addr6p[5],‚addr6p[6],‚addr6p[7]);

120 
š‘6_aáy³
.
	`šput
(1, 
Çddr6
, (
sockaddr
 *è&
¢addr6
);

121 
	`¢´štf
(
Çddr6
, (naddr6), "%s",

122 
š‘6_aáy³
.
	`¥ršt
((
sockaddr
 *è&
¢addr6
, 1));

126 
æags
[0]=0;

127 ià(
iæags
 & 
RTF_UP
)

128 
	`¡rÿt
(
æags
, "U");

129 ià(
iæags
 & 
RTF_REJECT
)

130 
	`¡rÿt
(
æags
, "!");

131 ià(
iæags
 & 
RTF_GATEWAY
)

132 
	`¡rÿt
(
æags
, "G");

133 ià(
iæags
 & 
RTF_HOST
)

134 
	`¡rÿt
(
æags
, "H");

135 ià(
iæags
 & 
RTF_DEFAULT
)

136 
	`¡rÿt
(
æags
, "D");

137 ià(
iæags
 & 
RTF_ADDRCONF
)

138 
	`¡rÿt
(
æags
, "A");

139 ià(
iæags
 & 
RTF_CACHE
)

140 
	`¡rÿt
(
æags
, "C");

141 ià(
iæags
 & 
RTF_ALLONLINK
)

142 
	`¡rÿt
(
æags
, "a");

143 ià(
iæags
 & 
RTF_EXPIRES
)

144 
	`¡rÿt
(
æags
, "e");

145 ià(
iæags
 & 
RTF_MODIFIED
)

146 
	`¡rÿt
(
æags
, "m");

147 ià(
iæags
 & 
RTF_NONEXTHOP
)

148 
	`¡rÿt
(
æags
, "n");

149 ià(
iæags
 & 
RTF_FLOW
)

150 
	`¡rÿt
(
æags
, "f");

153 
	`´štf
("%-30s %-26s %-4s %-3d %-1d%6d %s\n",

154 
addr6
, 
Çddr6
, 
æags
, 
m‘ric
, 
»fút
, 
u£
, 
içû
);

157 (è
	`fşo£
(
å
);

159 
	}
}

161 
	$½ršt_ÿche6
(
ext
, 
num”ic
)

163 
buff
[4096], 
içû
[16], 
æags
[16];

164 
addr6
[128], 
haddr
[20], 
¡©e¡r
[20];

165 
sockaddr_š6
 
§ddr6
;

166 
ty³
, 
num
, 
»fút
, 
´efix_Ën
, 
loÿtiÚ
, 
¡©e
, 
gc
;

167 
t¡amp
, 
expœe
, 
ndæags
, 
»achabË
, 
¡®e
, 
d–‘e
;

168 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_NDISC
, "r");

169 
addr6p
[8][5], 
hadd½
[6][3];

171 ià(!
å
) {

172  
	`½ršt_fib6
(
ext
, 
num”ic
 | 
RTF_CACHE
);

174 
	`´štf
(
	`_
("Kernel IPv6 Neighbour Cache\n"));

176 ià(
ext
 == 2)

177 
	`´štf
(
	`_
("Neighbour "

181 
	`´štf
(
	`_
("Neighbour "

186 
	`fg‘s
(
buff
, 1023, 
å
)) {

187 
num
 = 
	`ssÿnf
(
buff
, "%4s%4s%4s%4s%4s%4s%4s%4s %02x %02x %02x %02x %08lx %08lx %08lx %04x %04x %04lx %8s %2s%2s%2s%2s%2s%2s\n",

188 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

189 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7],

190 &
loÿtiÚ
, &
´efix_Ën
, &
ty³
, &
¡©e
, &
expœe
, &
t¡amp
, &
»achabË
, &
gc
, &
»fút
,

191 &
ndæags
, 
içû
,

192 
hadd½
[0], haddrp[1], haddrp[2], haddrp[3], haddrp[4], haddrp[5]);

195 
	`¢´štf
(
addr6
, (addr6), "%s:%s:%s:%s:%s:%s:%s:%s",

196 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

197 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7]);

198 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
§ddr6
);

199 
	`¢´štf
(
addr6
, (addr6), "%s/%d",

200 
š‘6_aáy³
.
	`¥ršt
((
sockaddr
 *è&
§ddr6
, 
num”ic
),

201 
´efix_Ën
);

204 
	`¢´štf
(
haddr
, (haddr), "%s:%s:%s:%s:%s:%s",

205 
hadd½
[0], haddrp[1], haddrp[2], haddrp[3], haddrp[4], haddrp[5]);

208 
æags
[0] = '\0';

209 ià(
ndæags
 & 
NTF_ROUTER
)

210 
	`¡rÿt
(
æags
, "R");

211 ià(
ndæags
 & 
NTF_04
)

212 
	`¡rÿt
(
æags
, "x");

213 ià(
ndæags
 & 
NTF_02
)

214 
	`¡rÿt
(
æags
, "h");

215 ià(
ndæags
 & 
NTF_PROXY
)

216 
	`¡rÿt
(
æags
, "P");

219 
¡©e
) {

220 
NUD_NONE
:

221 
	`¡rıy
(
¡©e¡r
, "NONE");

223 
NUD_INCOMPLETE
:

224 
	`¡rıy
(
¡©e¡r
, "INCOMPLETE");

226 
NUD_REACHABLE
:

227 
	`¡rıy
(
¡©e¡r
, "REACHABLE");

229 
NUD_STALE
:

230 
	`¡rıy
(
¡©e¡r
, "STALE");

232 
NUD_DELAY
:

233 
	`¡rıy
(
¡©e¡r
, "DELAY");

235 
NUD_PROBE
:

236 
	`¡rıy
(
¡©e¡r
, "PROBE");

238 
NUD_FAILED
:

239 
	`¡rıy
(
¡©e¡r
, "FAILED");

241 
NUD_NOARP
:

242 
	`¡rıy
(
¡©e¡r
, "NOARP");

244 
NUD_PERMANENT
:

245 
	`¡rıy
(
¡©e¡r
, "PERM");

248 
	`¢´štf
(
¡©e¡r
, (¡©e¡r), "UNKNOWN(%02x)", 
¡©e
);

253 
	`´štf
("%-43s %-17s %-8s %-5s %-3d %-16s",

254 
addr6
, 
haddr
, 
içû
, 
æags
, 
»fút
, 
¡©e¡r
);

256 
¡®e
 = 0;

257 ià(
¡©e
 =ğ
NUD_REACHABLE
)

258 
¡®e
 = 
»achabË
 > 
t¡amp
 ?„eachable -stamp : 0;

259 
d–‘e
 = 
gc
 > 
t¡amp
 ? gc -stamp : 0;

260 ià(
ext
 != 2) {

261 
	`´štf
(" %-9ld ", 
¡®e
 / 
HZ
);

262 ià(
»fút
)

263 
	`´štf
(" * ");

265 
	`´štf
(" %-7ld ", 
d–‘e
 / 
HZ
);

267 
	`´štf
("\n");

270 (è
	`fşo£
(
å
);

272 
	}
}

274 
	$INET6_½ršt
(
İtiÚs
)

276 
ext
 = 
İtiÚs
 & 
FLAG_EXT
;

277 
num”ic
 = 
İtiÚs
 & (
FLAG_NUM_HOST
 | 
FLAG_SYM
);

278 
rc
 = 
E_INTERN
;

280 ià(
İtiÚs
 & 
FLAG_FIB
)

281 ià((
rc
 = 
	`½ršt_fib6
(
ext
, 
num”ic
)))

282  (
rc
);

284 ià(
İtiÚs
 & 
FLAG_CACHE
)

285 ià((
rc
 = 
	`½ršt_ÿche6
(
ext
, 
num”ic
)))

286  (
rc
);

287  (
rc
);

288 
	}
}

	@interface/net-tools/lib/inet6_sr.c

6 
	~"cÚfig.h
"

8 #ià
HAVE_AFINET6


9 
	~<asm/ty³s.h
>

10 
	~<sys/·¿m.h
>

11 
	~<sys/ty³s.h
>

12 
	~<sys/sock‘.h
>

13 
	~<Ãtš‘/š.h
>

14 
	~<¬·/š‘.h
>

15 
	~<¬·/Çme£r.h
>

16 
	~<Ãt/if.h
>

17 
	~<sys/ioùl.h
>

18 
	~<ùy³.h
>

19 
	~<”ºo.h
>

20 
	~<Ãtdb.h
>

21 
	~<»sŞv.h
>

22 
	~<¡dlib.h
>

23 
	~<¡ršg.h
>

24 
	~<¡dio.h
>

25 
	~<uni¡d.h
>

26 #ifdeà
__GLIBC__


27 
	~<Ãt/rou‹.h
>

29 
	~<Ãtš‘6/v6_rou‹.h
>

31 
	~"v”siÚ.h
"

32 
	~"Ãt-suµÜt.h
"

33 
	~"·thÇmes.h
"

34 
	~"š.h
"

35 
	~"Ãt-ã©u»s.h
"

39 
aáy³
 
š‘6_aáy³
;

41 
	gskfd
 = -1;

44 
	$u§ge
()

46 
	`årštf
(
¡d”r
, 
	`_
("Usage: inet6_route [-vF] del Target\n"));

47 
	`årštf
(
¡d”r
, 
	`_
(" inet6_route [-vF]‡dd Target [gw Gw] [metric M] [[dev] If]\n"));

48 
	`årštf
(
¡d”r
, 
	`_
(" inet6_route [-FC] flush NOT supported\n"));

49  (
E_USAGE
);

50 
	}
}

53 
	$INET6_£Œou‹
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

55 
š6_¹msg
 
¹
;

56 
iäeq
 
iä
;

57 
sockaddr_š6
 
§6
;

58 
rg‘
[128], 
g©eway
[128] = "NONE";

59 
m‘ric
, 
´efix_Ën
;

60 *
devÇme
 = 
NULL
;

61 *
ı
;

63 ià(*
¬gs
 =ğ
NULL
)

64  (
	`u§ge
());

66 
	`¡rıy
(
rg‘
, *
¬gs
++);

67 ià(!
	`¡rcmp
(
rg‘
, "default")) {

68 
´efix_Ën
 = 0;

69 
	`mem£t
(&
§6
, 0, (sa6));

71 ià((
ı
 = 
	`¡rchr
(
rg‘
, '/'))) {

72 
´efix_Ën
 = 
	`©Ş
(
ı
 + 1);

73 ià((
´efix_Ën
 < 0) || (prefix_len > 128))

74 
	`u§ge
();

75 *
ı
 = 0;

77 
´efix_Ën
 = 128;

79 ià(
š‘6_aáy³
.
	`šput
(1, 
rg‘
, (
sockaddr
 *è&
§6
) < 0

80 && 
š‘6_aáy³
.
	`šput
(0, 
rg‘
, (
sockaddr
 *è&
§6
) < 0) {

81 
š‘6_aáy³
.
	`h”rÜ
(
rg‘
);

87 
	`mem£t
((*è&
¹
, 0, (
š6_¹msg
));

89 
	`memıy
(&
¹
.
¹msg_d¡
, 
§6
.
sš6_addr
.
s6_addr
, (
š6_addr
));

92 
¹
.
¹msg_æags
 = 
RTF_UP
;

93 ià(
´efix_Ën
 == 128)

94 
¹
.
¹msg_æags
 |ğ
RTF_HOST
;

95 
¹
.
¹msg_m‘ric
 = 1;

96 
¹
.
¹msg_d¡_Ën
 = 
´efix_Ën
;

98 *
¬gs
) {

99 ià(!
	`¡rcmp
(*
¬gs
, "metric")) {

101 
¬gs
++;

102 ià(!*
¬gs
 || !
	`isdig™
(**args))

103  (
	`u§ge
());

104 
m‘ric
 = 
	`©oi
(*
¬gs
);

105 
¹
.
¹msg_m‘ric
 = 
m‘ric
;

106 
¬gs
++;

109 ià(!
	`¡rcmp
(*
¬gs
, "gw") || !strcmp(*args, "gateway")) {

110 
¬gs
++;

111 ià(!*
¬gs
)

112  (
	`u§ge
());

113 ià(
¹
.
¹msg_æags
 & 
RTF_GATEWAY
)

114  (
	`u§ge
());

115 
	`¡rıy
(
g©eway
, *
¬gs
);

116 ià(
š‘6_aáy³
.
	`šput
(1, 
g©eway
,

117 (
sockaddr
 *è&
§6
) < 0) {

118 
š‘6_aáy³
.
	`h”rÜ
(
g©eway
);

119  (
E_LOOKUP
);

121 
	`memıy
(&
¹
.
¹msg_g©eway
, 
§6
.
sš6_addr
.
s6_addr
,

122 (
š6_addr
));

123 
¹
.
¹msg_æags
 |ğ
RTF_GATEWAY
;

124 
¬gs
++;

127 ià(!
	`¡rcmp
(*
¬gs
, "mod")) {

128 
¬gs
++;

129 
¹
.
¹msg_æags
 |ğ
RTF_MODIFIED
;

132 ià(!
	`¡rcmp
(*
¬gs
, "dyn")) {

133 
¬gs
++;

134 
¹
.
¹msg_æags
 |ğ
RTF_DYNAMIC
;

137 ià(!
	`¡rcmp
(*
¬gs
, "device") || !strcmp(*args, "dev")) {

138 
¬gs
++;

139 ià(!*
¬gs
)

140  (
	`u§ge
());

141 } ià(
¬gs
[1])

142  (
	`u§ge
());

144 
devÇme
 = *
¬gs
;

145 
¬gs
++;

149 ià((
skfd
 = 
	`sock‘
(
AF_INET6
, 
SOCK_DGRAM
, 0)) < 0) {

150 
	`³¼Ü
("socket");

151  (
E_SOCK
);

153 ià(
devÇme
) {

154 
	`mem£t
(&
iä
, 0, (ifr));

155 
	`¡rıy
(
iä
.
iä_Çme
, 
devÇme
);

157 ià(
	`ioùl
(
skfd
, 
SIOGIFINDEX
, &
iä
) < 0) {

158 
	`³¼Ü
("SIOGIFINDEX");

159  (
E_SOCK
);

161 
¹
.
¹msg_ifšdex
 = 
iä
.
iä_ifšdex
;

163 
¹
.
¹msg_ifšdex
 = 0;

166 ià(
aùiÚ
 =ğ
RTACTION_DEL
) {

167 ià(
	`ioùl
(
skfd
, 
SIOCDELRT
, &
¹
) < 0) {

168 
	`³¼Ü
("SIOCDELRT");

169 
	`şo£
(
skfd
);

170  (
E_SOCK
);

173 ià(
	`ioùl
(
skfd
, 
SIOCADDRT
, &
¹
) < 0) {

174 
	`³¼Ü
("SIOCADDRT");

175 
	`şo£
(
skfd
);

176  (
E_SOCK
);

181 (è
	`şo£
(
skfd
);

183 
	}
}

185 
	$INET6_ršput
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

187 ià(
aùiÚ
 =ğ
RTACTION_FLUSH
) {

188 
	`årštf
(
¡d”r
, 
	`_
("Flushing `inet6'„outingable‚ot supported\n"));

189  (
	`u§ge
());

191 ià((*
¬gs
 =ğ
NULL
è|| (
aùiÚ
 =ğ
RTACTION_HELP
))

192  (
	`u§ge
());

194  (
	`INET6_£Œou‹
(
aùiÚ
, 
İtiÚs
, 
¬gs
));

195 
	}
}

	@interface/net-tools/lib/inet_gr.c

11 
	~"cÚfig.h
"

13 #ià
HAVE_AFINET


14 
	~<sys/ty³s.h
>

15 
	~<sys/sock‘.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<¬·/š‘.h
>

18 
	~<¬·/Çme£r.h
>

20 
	~<ùy³.h
>

21 
	~<”ºo.h
>

22 
	~<Ãtdb.h
>

23 
	~<»sŞv.h
>

24 
	~<¡dlib.h
>

25 
	~<¡ršg.h
>

26 
	~<¡dio.h
>

27 
	~<uni¡d.h
>

28 
	~"v”siÚ.h
"

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

32 
	~"Ãt-ã©u»s.h
"

33 
	~"´oc.h
"

34 
aáy³
 
š‘_aáy³
;

36 *
INET_¥rštmask
(
sockaddr
 *
§p
, 
num”ic
,

37 
Ãtmask
);

39 
	$½ršt_fib
(
ext
, 
num”ic
)

41 
buff
[1024], 
içû
[17], 
æags
[64];

42 
g©e_addr
[128], 
Ãt_addr
[128];

43 
mask_addr
[128];

44 
num
, 
iæags
, 
m‘ric
, 
»fút
, 
u£
, 
mss
, 
wšdow
, 
œ‰
;

45 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_ROUTE
, "r");

46 *
fmt
;

48 ià(!
å
) {

49 
	`³¼Ü
(
_PATH_PROCNET_ROUTE
);

50 
	`´štf
(
	`_
("INET (IPv4)‚ot configured inhis system.\n"));

53 
	`´štf
(
	`_
("Kernel IP„outingable\n"));

55 ià(
ext
 == 1)

56 
	`´štf
(
	`_
("Destination Gateway Genmask "

58 ià(
ext
 == 2)

59 
	`´štf
(
	`_
("Destination Gateway Genmask "

61 ià(
ext
 >= 3)

62 
	`´štf
(
	`_
("Destination Gateway Genmask "

66 
œ‰
 = 0;

67 
wšdow
 = 0;

68 
mss
 = 0;

70 
fmt
 = 
	`´oc_g’_fmt
(
_PATH_PROCNET_ROUTE
, 0, 
å
,

82 
NULL
);

85 ià(!
fmt
)

88 
	`fg‘s
(
buff
, 1023, 
å
)) {

89 
sockaddr
 
¢‘_rg‘
, 
¢‘_g©eway
, 
¢‘_mask
;

90 
sockaddr_š
 *
sš_Ãtmask
;

92 
num
 = 
	`ssÿnf
(
buff
, 
fmt
,

93 
içû
, 
Ãt_addr
, 
g©e_addr
,

94 &
iæags
, &
»fút
, &
u£
, &
m‘ric
, 
mask_addr
,

95 &
mss
, &
wšdow
, &
œ‰
);

96 ià(
num
 < 10 || !(
iæags
 & 
RTF_UP
))

100 (è
š‘_aáy³
.
	`šput
(1, 
Ãt_addr
, &
¢‘_rg‘
);

103 (è
š‘_aáy³
.
	`šput
(1, 
g©e_addr
, &
¢‘_g©eway
);

106 (è
š‘_aáy³
.
	`šput
(1, 
mask_addr
, &
¢‘_mask
);

108 
sš_Ãtmask
 = (
sockaddr_š
 *)&
¢‘_mask
;

109 
	`¡rıy
(
Ãt_addr
, 
	`INET_¥rštmask
(&
¢‘_rg‘
,

110 (
num”ic
 | 0x8000 | (
iæags
 & 
RTF_HOST
? 0x4000: 0)),

111 
sš_Ãtmask
->
sš_addr
.
s_addr
));

112 
Ãt_addr
[15] = '\0';

114 
	`¡rıy
(
g©e_addr
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘_g©eway
, 
num”ic
 | 0x4000));

115 
g©e_addr
[15] = '\0';

117 
	`¡rıy
(
mask_addr
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘_mask
, 1));

118 
mask_addr
[15] = '\0';

121 
æags
[0] = '\0';

122 ià(
iæags
 & 
RTF_UP
)

123 
	`¡rÿt
(
æags
, "U");

124 ià(
iæags
 & 
RTF_GATEWAY
)

125 
	`¡rÿt
(
æags
, "G");

126 #ià
HAVE_RTF_REJECT


127 ià(
iæags
 & 
RTF_REJECT
)

128 
	`¡rıy
(
æags
, "!");

130 ià(
iæags
 & 
RTF_HOST
)

131 
	`¡rÿt
(
æags
, "H");

132 ià(
iæags
 & 
RTF_REINSTATE
)

133 
	`¡rÿt
(
æags
, "R");

134 ià(
iæags
 & 
RTF_DYNAMIC
)

135 
	`¡rÿt
(
æags
, "D");

136 ià(
iæags
 & 
RTF_MODIFIED
)

137 
	`¡rÿt
(
æags
, "M");

138 ià(
iæags
 & 
RTF_DEFAULT
)

139 
	`¡rÿt
(
æags
, "d");

140 ià(
iæags
 & 
RTF_ALLONLINK
)

141 
	`¡rÿt
(
æags
, "a");

142 ià(
iæags
 & 
RTF_ADDRCONF
)

143 
	`¡rÿt
(
æags
, "c");

144 ià(
iæags
 & 
RTF_NONEXTHOP
)

145 
	`¡rÿt
(
æags
, "o");

146 ià(
iæags
 & 
RTF_EXPIRES
)

147 
	`¡rÿt
(
æags
, "e");

148 ià(
iæags
 & 
RTF_CACHE
)

149 
	`¡rÿt
(
æags
, "c");

150 ià(
iæags
 & 
RTF_FLOW
)

151 
	`¡rÿt
(
æags
, "f");

152 ià(
iæags
 & 
RTF_POLICY
)

153 
	`¡rÿt
(
æags
, "p");

154 ià(
iæags
 & 
RTF_LOCAL
)

155 
	`¡rÿt
(
æags
, "l");

156 ià(
iæags
 & 
RTF_MTU
)

157 
	`¡rÿt
(
æags
, "u");

158 ià(
iæags
 & 
RTF_WINDOW
)

159 
	`¡rÿt
(
æags
, "w");

160 ià(
iæags
 & 
RTF_IRTT
)

161 
	`¡rÿt
(
æags
, "i");

162 ià(
iæags
 & 
RTF_NOTCACHED
)

163 
	`¡rÿt
(
æags
, "n");

166 ià(
ext
 == 1) {

167 #ià
HAVE_RTF_REJECT


168 ià(
iæags
 & 
RTF_REJECT
)

169 
	`´štf
("%-15s - %-15s %-5s %-6d - %7d -\n",

170 
Ãt_addr
, 
mask_addr
, 
æags
, 
m‘ric
, 
u£
);

173 
	`´štf
("%-15s %-15s %-15s %-5s %-6d %-2d %7d %s\n",

174 
Ãt_addr
, 
g©e_addr
, 
mask_addr
, 
æags
,

175 
m‘ric
, 
»fút
, 
u£
, 
içû
);

177 ià(
ext
 == 2) {

178 #ià
HAVE_RTF_REJECT


179 ià(
iæags
 & 
RTF_REJECT
)

180 
	`´štf
("%-15s - %-15s %-5s - - - -\n",

181 
Ãt_addr
, 
mask_addr
, 
æags
);

184 
	`´štf
("%-15s %-15s %-15s %-5s %5d %-5d %6d %s\n",

185 
Ãt_addr
, 
g©e_addr
, 
mask_addr
, 
æags
,

186 
mss
, 
wšdow
, 
œ‰
, 
içû
);

188 ià(
ext
 >= 3) {

189 #ià
HAVE_RTF_REJECT


190 ià(
iæags
 & 
RTF_REJECT
)

191 
	`´štf
("%-15s - %-15s %-5s %-6d - %7d - - - -\n",

192 
Ãt_addr
, 
mask_addr
, 
æags
, 
m‘ric
, 
u£
);

195 
	`´štf
("%-15s %-15s %-15s %-5s %-6d %-3d %6d %-6.6s %-5d %-6d %d\n",

196 
Ãt_addr
, 
g©e_addr
, 
mask_addr
, 
æags
,

197 
m‘ric
, 
»fút
, 
u£
, 
içû
, 
mss
, 
wšdow
, 
œ‰
);

201 
	`ä“
(
fmt
);

202 (è
	`fşo£
(
å
);

204 
	}
}

206 
	$½ršt_ÿche
(
ext
, 
num”ic
)

208 
buff
[1024], 
içû
[17], 
æags
[64];

209 
g©e_addr
[128], 
de¡_addr
[128], 
¥ecd¡
[128];

210 
¤c_addr
[128];

211 
sockaddr
 
¢‘
;

212 
iæags
;

213 
num
, 
fÜm©
, 
m‘ric
, 
»fút
, 
u£
, 
mss
, 
wšdow
, 
œ‰
, 
hh
, 
hh»f
, 
hhu±od
, 
¬p
, 
tos
;

214 *
fmt
 = 
NULL
;

216 
FILE
 *
å
 = 
	`fİ’
(
_PATH_PROCNET_RTCACHE
, "r");

218 ià(!
å
) {

219 
	`³¼Ü
(
_PATH_PROCNET_RTCACHE
);

220 
	`´štf
(
	`_
("INET (IPv4)‚ot configured inhis system.\n"));

235 
fÜm©
 = 
	`´oc_guess_fmt
(
_PATH_PROCNET_RTCACHE
, 
å
, "IRTT",1,"TOS",2,"HHRef",4,"HHU±od",8,"S³cD¡",16,"HH",32,"ARP",64,
NULL
);

237 
	`´štf
(
	`_
("Kernel IP„outing cache\n"));

239 
fÜm©
) {

241 
	`³¼Ü
(
_PATH_PROCNET_RTCACHE
);

242 
	`ex™
(-1);

245 
fÜm©
 = 2;

248 
fÜm©
 = 1;

251 
	`´štf
("ERROR:…roc_guess_fmt(%s,...„‘uºed: %d\n",
_PATH_PROCNET_RTCACHE
, 
fÜm©
);

255 
	`»wšd
(
å
);

257 ià(
ext
 == 1)

258 
	`´štf
(
	`_
("Source Destination Gateway "

260 ià(
ext
 == 2)

261 
	`´štf
(
	`_
("Source Destination Gateway "

264 ià(
fÜm©
 == 1) {

265 ià(
ext
 >= 3)

266 
	`´štf
(
	`_
("Source Destination Gateway "

270 
fmt
 = 
	`´oc_g’_fmt
(
_PATH_PROCNET_RTCACHE
, 0, 
å
,

284 
NULL
);

288 ià(
fÜm©
 == 2) {

289 ià(
ext
 >= 3)

290 
	`´štf
(
	`_
("Source Destination Gateway "

293 
fmt
 = 
	`´oc_g’_fmt
(
_PATH_PROCNET_RTCACHE
, 0, 
å
,

309 
NULL
);

314 
œ‰
 = 0;

315 
wšdow
 = 0;

316 
mss
 = 0;

317 
hh
 = 0; 
hh»f
 = 0; 
hhu±od
 = 0;

318 
¬p
 = 0; 
tos
 = 0;

319 
	`fg‘s
(
buff
, 1023, 
å
)) {

320 ià(
fÜm©
 == 1) {

321 
num
 = 
	`ssÿnf
(
buff
, 
fmt
,

322 
içû
, 
de¡_addr
, 
g©e_addr
,

323 &
iæags
, &
»fút
, &
u£
, &
m‘ric
, 
¤c_addr
,

324 &
mss
, &
wšdow
, &
œ‰
, &
hh
, &
¬p
);

325 ià(
num
 < 12)

328 ià(
fÜm©
 == 2) {

329 
num
 = 
	`ssÿnf
(
buff
, 
fmt
,

330 
içû
, 
de¡_addr
, 
g©e_addr
,

331 &
iæags
, &
»fút
, &
u£
, &
m‘ric
, 
¤c_addr
,

332 &
mss
, &
wšdow
, &
œ‰
, &
tos
, &
hh»f
, &
hhu±od
, &
¥ecd¡
);

333 ià(
num
 < 12)

339 (è
š‘_aáy³
.
	`šput
(1, 
de¡_addr
, &
¢‘
);

340 
	`¡rıy
(
de¡_addr
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘
, 
num”ic
));

341 
de¡_addr
[15] = '\0';

344 (è
š‘_aáy³
.
	`šput
(1, 
g©e_addr
, &
¢‘
);

345 
	`¡rıy
(
g©e_addr
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘
, 
num”ic
));

346 
g©e_addr
[15] = '\0';

349 (è
š‘_aáy³
.
	`šput
(1, 
¤c_addr
, &
¢‘
);

350 
	`¡rıy
(
¤c_addr
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘
, 
num”ic
));

351 
¤c_addr
[15] = '\0';

354 (è
š‘_aáy³
.
	`šput
(1, 
¥ecd¡
, &
¢‘
);

355 
	`¡rıy
(
¥ecd¡
, 
š‘_aáy³
.
	`¥ršt
(&
¢‘
, 
num”ic
));

356 
¥ecd¡
[15] = '\0';

359 
æags
[0] = '\0';

360 ià(
fÜm©
 == 1) {

361 ià(
iæags
 & 
RTF_UP
)

362 
	`¡rÿt
(
æags
, "U");

363 ià(
iæags
 & 
RTF_HOST
)

364 
	`¡rÿt
(
æags
, "H");

366 ià(
iæags
 & 
RTF_GATEWAY
)

367 
	`¡rÿt
(
æags
, "G");

368 #ià
HAVE_RTF_REJECT


369 ià(
iæags
 & 
RTF_REJECT
)

370 
	`¡rıy
(
æags
, "!");

372 ià(
iæags
 & 
RTF_REINSTATE
)

373 
	`¡rÿt
(
æags
, "R");

374 ià(
iæags
 & 
RTF_DYNAMIC
)

375 
	`¡rÿt
(
æags
, "D");

376 ià(
iæags
 & 
RTF_MODIFIED
)

377 
	`¡rÿt
(
æags
, "M");

380 ià(
fÜm©
 == 2) {

381 ià(
iæags
 & 
RTCF_DEAD
)

382 
	`¡rÿt
(
æags
, "-");

383 ià(
iæags
 & 
RTCF_ONLINK
)

384 
	`¡rÿt
(
æags
, "o");

386 ià(
iæags
 & 
RTCF_NOTIFY
)

387 
	`¡rÿt
(
æags
, "n");

388 ià(
iæags
 & 
RTCF_DIRECTDST
)

389 
	`¡rÿt
(
æags
, "d");

390 ià(
iæags
 & 
RTCF_TPROXY
)

391 
	`¡rÿt
(
æags
, "t");

392 ià(
iæags
 & 
RTCF_FAST
)

393 
	`¡rÿt
(
æags
, "f");

394 ià(
iæags
 & 
RTCF_MASQ
)

395 
	`¡rÿt
(
æags
, "q");

396 ià(
iæags
 & 
RTCF_SNAT
)

397 
	`¡rÿt
(
æags
, "Ns");

398 ià(
iæags
 & 
RTCF_DOREDIRECT
)

399 
	`¡rÿt
(
æags
, "r");

400 ià(
iæags
 & 
RTCF_DIRECTSRC
)

401 
	`¡rÿt
(
æags
, "i");

402 ià(
iæags
 & 
RTCF_DNAT
)

403 
	`¡rÿt
(
æags
, "Nd");

404 ià(
iæags
 & 
RTCF_BROADCAST
)

405 
	`¡rÿt
(
æags
, "b");

406 ià(
iæags
 & 
RTCF_MULTICAST
)

407 
	`¡rÿt
(
æags
, "m");

408 ià(
iæags
 & 
RTCF_REJECT
)

409 
	`¡rÿt
(
æags
, "#");

410 ià(
iæags
 & 
RTCF_LOCAL
)

411 
	`¡rÿt
(
æags
, "l");

413 ià(
ext
 == 1) {

414 
	`´štf
("%-15s %-15s %-15s %-5s %-6d %-2d %7d %s\n",

415 
¤c_addr
, 
de¡_addr
, 
g©e_addr
, 
æags
,

416 
m‘ric
, 
»fút
, 
u£
, 
içû
);

418 ià(
ext
 == 2) {

419 
	`´štf
("%-15s %-15s %-15s %-5s %5d %-5d %6d %s\n",

420 
¤c_addr
, 
de¡_addr
, 
g©e_addr
, 
æags
,

421 
mss
, 
wšdow
, 
œ‰
, 
içû
);

423 ià(
fÜm©
 == 1) {

424 ià(
ext
 >= 3) {

425 
	`´štf
("%-15s %-15s %-15s %-5s %-6d %-3d %6d %-6.6s %-5d %-6d %-5d %-3d %d\n",

426 
¤c_addr
, 
de¡_addr
, 
g©e_addr
, 
æags
,

427 
m‘ric
, 
»fút
, 
u£
, 
içû
, 
mss
, 
wšdow
, 
œ‰
, 
hh
, 
¬p
);

430 ià(
fÜm©
 == 2) {

431 ià(
ext
 >= 3) {

432 
	`´štf
("%-15s %-15s %-15s %-5s %-6d %-3d %6d %-6.6s %-5d %-6d %-5d %-3d %-3d %-3d %15s\n",

433 
¤c_addr
, 
de¡_addr
, 
g©e_addr
, 
æags
,

434 
m‘ric
, 
»fút
, 
u£
, 
içû
, 
mss
, 
wšdow
, 
œ‰
, 
tos
, 
hh»f
, 
hhu±od
, 
¥ecd¡
);

439 
	`ä“
(
fmt
);

440 (è
	`fşo£
(
å
);

442 
	}
}

444 
	$INET_½ršt
(
İtiÚs
)

446 
ext
 = 
İtiÚs
 & 
FLAG_EXT
;

447 
num”ic
 = 
İtiÚs
 & (
FLAG_NUM_HOST
 | 
FLAG_SYM
);

448 
rc
 = 
E_INTERN
;

450 ià(
İtiÚs
 & 
FLAG_FIB
)

451 ià((
rc
 = 
	`½ršt_fib
(
ext
, 
num”ic
)))

452  (
rc
);

453 ià(
İtiÚs
 & 
FLAG_CACHE
)

454 
rc
 = 
	`½ršt_ÿche
(
ext
, 
num”ic
);

456  (
rc
);

457 
	}
}

	@interface/net-tools/lib/inet_sr.c

9 
	~"cÚfig.h
"

11 #ià
HAVE_AFINET


12 
	~<asm/ty³s.h
>

13 
	~<sys/·¿m.h
>

14 
	~<sys/ty³s.h
>

15 
	~<sys/sock‘.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<¬·/š‘.h
>

18 
	~<¬·/Çme£r.h
>

19 
	~<Ãt/rou‹.h
>

20 
	~<sys/ioùl.h
>

21 
	~<ùy³.h
>

22 
	~<”ºo.h
>

23 
	~<Ãtdb.h
>

24 
	~<»sŞv.h
>

25 
	~<¡dlib.h
>

26 
	~<¡ršg.h
>

27 
	~<¡dio.h
>

28 
	~<uni¡d.h
>

29 
	~"v”siÚ.h
"

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

33 
	~"Ãt-ã©u»s.h
"

34 
	~"ut.h
"

36 #ià
HAVE_NEW_ADDRT


37 
	#mask_š_addr
(
x
è(((
sockaddr_š
 *)&((x).
¹_g’mask
))->
sš_addr
.
s_addr
)

	)

38 
	#fuÎ_mask
(
x
è(x)

	)

40 
	#mask_š_addr
(
x
è((x).
¹_g’mask
)

	)

41 
	#fuÎ_mask
(
x
è(((
sockaddr_š
 *)&(x))->
sš_addr
.
s_addr
)

	)

44 
aáy³
 
š‘_aáy³
;

46 
	gskfd
 = -1;

49 
	$u§ge
()

51 
	`årštf
(
¡d”r
, 
	`_
("Usage: inet_route [-vF] del {-host|-net} Target[/prefix] [gw Gw] [metric M] [[dev] If]\n"));

52 
	`årštf
(
¡d”r
, 
	`_
(" inet_route [-vF]‡dd {-host|-net} Target[/prefix] [gw Gw] [metric M]\n"));

53 
	`årštf
(
¡d”r
, 
	`_
(" [netmask N] [mss Mss] [window W] [irtt I]\n"));

54 
	`årštf
(
¡d”r
, 
	`_
(" [mod] [dyn] [reinstate] [[dev] If]\n"));

55 
	`årštf
(
¡d”r
, 
	`_
(" inet_route [-vF]‡dd {-host|-net} Target[/prefix] [metric M]„eject\n"));

56 
	`årštf
(
¡d”r
, 
	`_
(" inet_route [-FC] flush NOT supported\n"));

57  (
E_USAGE
);

58 
	}
}

60 
	$INET_£Œou‹
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

62 
¹’Œy
 
¹
;

63 
rg‘
[128], 
g©eway
[128] = "NONE", 
Ãtmask
[128] = "default";

64 
xæag
, 
i¢‘
;

66 
xæag
 = 0;

68 ià(!
	`¡rcmp
(*
¬gs
, "#net")) {

69 
xæag
 = 1;

70 
¬gs
++;

71 } ià(!
	`¡rcmp
(*
¬gs
, "#host")) {

72 
xæag
 = 2;

73 
¬gs
++;

75 ià(*
¬gs
 =ğ
NULL
)

76  (
	`u§ge
());

78 
	`§ã_¡ºıy
(
rg‘
, *
¬gs
++, (arget));

81 
	`mem£t
((*è&
¹
, 0, (
¹’Œy
));

86 
sockaddr_š
 
m
;

87 
sockaddr
 
d
;

88 } 
mask
;

89 
n
;

91 
n
 = 
š‘_aáy³
.
	`g‘mask
(
rg‘
, &
mask
.
d
, 
Ãtmask
);

92 ià(
n
 < 0)

93  
	`u§ge
();

94 ià(
n
)

95 
¹
.
¹_g’mask
 = 
	`fuÎ_mask
(
mask
.
d
);

99 ià((
i¢‘
 = 
š‘_aáy³
.
	`šput
((
xæag
!=2? 0: 256), 
rg‘
, &
¹
.
¹_d¡
)) < 0) {

100 
š‘_aáy³
.
	`h”rÜ
(
rg‘
);

103 
xæag
) {

105 
i¢‘
 = 1; ;

107 
i¢‘
 = 0; ;

111 
¹
.
¹_æags
 = (
RTF_UP
 | 
RTF_HOST
);

112 ià(
i¢‘
)

113 
¹
.
¹_æags
 &ğ~
RTF_HOST
;

115 *
¬gs
) {

116 ià(!
	`¡rcmp
(*
¬gs
, "metric")) {

117 
m‘ric
;

119 
¬gs
++;

120 ià(!*
¬gs
 || !
	`isdig™
(**args))

121  (
	`u§ge
());

122 
m‘ric
 = 
	`©oi
(*
¬gs
);

123 #ià
HAVE_NEW_ADDRT


124 
¹
.
¹_m‘ric
 = 
m‘ric
 + 1;

126 
	`ENOSUPP
("inet_setroute", "NEW_ADDRT (metric)");

128 
¬gs
++;

131 ià(!
	`¡rcmp
(*
¬gs
, "netmask")) {

132 
sockaddr
 
mask
;

134 
¬gs
++;

135 ià(!*
¬gs
 || 
	`mask_š_addr
(
¹
))

136  (
	`u§ge
());

137 
	`§ã_¡ºıy
(
Ãtmask
, *
¬gs
, (‚etmask));

138 ià((
i¢‘
 = 
š‘_aáy³
.
	`šput
(0, 
Ãtmask
, &
mask
)) < 0) {

139 
š‘_aáy³
.
	`h”rÜ
(
Ãtmask
);

140  (
E_LOOKUP
);

142 
¹
.
¹_g’mask
 = 
	`fuÎ_mask
(
mask
);

143 
¬gs
++;

146 ià(!
	`¡rcmp
(*
¬gs
, "gw") || !strcmp(*args, "gateway")) {

147 
¬gs
++;

148 ià(!*
¬gs
)

149  (
	`u§ge
());

150 ià(
¹
.
¹_æags
 & 
RTF_GATEWAY
)

151  (
	`u§ge
());

152 
	`§ã_¡ºıy
(
g©eway
, *
¬gs
, ( gateway));

153 ià((
i¢‘
 = 
š‘_aáy³
.
	`šput
(256, 
g©eway
, &
¹
.
¹_g©eway
)) < 0) {

154 
š‘_aáy³
.
	`h”rÜ
(
g©eway
);

155  (
E_LOOKUP
);

157 ià(
i¢‘
) {

158 
	`årštf
(
¡d”r
, 
	`_
("route: %s: cannot use‡ NETWORK‡s gateway!\n"),

159 
g©eway
);

160  (
E_OPTERR
);

162 
¹
.
¹_æags
 |ğ
RTF_GATEWAY
;

163 
¬gs
++;

166 ià(!
	`¡rcmp
(*
¬gs
, "mss") || !strcmp(*args,"mtu")) {

167 
¬gs
++;

168 
¹
.
¹_æags
 |ğ
RTF_MSS
;

169 ià(!*
¬gs
)

170  (
	`u§ge
());

171 
¹
.
¹_mss
 = 
	`©oi
(*
¬gs
);

172 
¬gs
++;

173 ià(
¹
.
¹_mss
 < 64 ||„t.rt_mss > 65536) {

174 
	`årštf
(
¡d”r
, 
	`_
("route: Invalid MSS/MTU.\n"));

175  (
E_OPTERR
);

179 ià(!
	`¡rcmp
(*
¬gs
, "window")) {

180 
¬gs
++;

181 ià(!*
¬gs
)

182  (
	`u§ge
());

183 
¹
.
¹_æags
 |ğ
RTF_WINDOW
;

184 
¹
.
¹_wšdow
 = 
	`©oi
(*
¬gs
);

185 
¬gs
++;

186 ià(
¹
.
¹_wšdow
 < 128) {

187 
	`årštf
(
¡d”r
, 
	`_
("route: Invalid window.\n"));

188  (
E_OPTERR
);

192 ià(!
	`¡rcmp
(*
¬gs
, "irtt")) {

193 
¬gs
++;

194 ià(!*
¬gs
)

195  (
	`u§ge
());

196 
¬gs
++;

197 #ià
HAVE_RTF_IRTT


198 
¹
.
¹_æags
 |ğ
RTF_IRTT
;

199 
¹
.
¹_œ‰
 = 
	`©oi
(*(
¬gs
 - 1));

200 
¹
.
¹_œ‰
 *ğ(
HZ
 / 100);

202 ià(
¹
.
¹_œ‰
 < 1 ||„t.¹_œ‰ > (120 * 
HZ
)) {

203 
	`årštf
(
¡d”r
, 
	`_
("route: Invalid initial„tt.\n"));

204  (
E_OPTERR
);

208 
	`ENOSUPP
("inet_setroute", "RTF_IRTT");

212 ià(!
	`¡rcmp
(*
¬gs
, "reject")) {

213 
¬gs
++;

214 #ià
HAVE_RTF_REJECT


215 
¹
.
¹_æags
 |ğ
RTF_REJECT
;

217 
	`ENOSUPP
("inet_setroute", "RTF_REJECT");

221 ià(!
	`¡rcmp
(*
¬gs
, "mod")) {

222 
¬gs
++;

223 
¹
.
¹_æags
 |ğ
RTF_MODIFIED
;

226 ià(!
	`¡rcmp
(*
¬gs
, "dyn")) {

227 
¬gs
++;

228 
¹
.
¹_æags
 |ğ
RTF_DYNAMIC
;

231 ià(!
	`¡rcmp
(*
¬gs
, "reinstate")) {

232 
¬gs
++;

233 
¹
.
¹_æags
 |ğ
RTF_REINSTATE
;

236 ià(!
	`¡rcmp
(*
¬gs
, "device") || !strcmp(*args, "dev")) {

237 
¬gs
++;

238 ià(
¹
.
¹_dev
 || *
¬gs
 =ğ
NULL
)

239  
	`u§ge
();

240 
¹
.
¹_dev
 = *
¬gs
++;

244 ià(!
¹
.
¹_dev
) {

245 
¹
.
¹_dev
 = *
¬gs
++;

246 ià(*
¬gs
)

247  
	`u§ge
();

249  
	`u§ge
();

252 #ià
HAVE_RTF_REJECT


253 ià((
¹
.
¹_æags
 & 
RTF_REJECT
è&& !¹.
¹_dev
)

254 
¹
.
¹_dev
 = "lo";

258 ià(
	`mask_š_addr
(
¹
)) {

259 
__u32
 
mask
 = ~
	`Áohl
(
	`mask_š_addr
(
¹
));

260 ià((
¹
.
¹_æags
 & 
RTF_HOST
è&& 
mask
 != 0xffffffff) {

261 
	`årštf
(
¡d”r
, 
	`_
("rou‹:‚‘mask %.8x dÛ¢'ˆmak£n£ w™h ho¡„ou‹\n"), 
mask
);

262  (
E_OPTERR
);

264 ià(
mask
 & (mask + 1)) {

265 
	`årštf
(
¡d”r
, 
	`_
("rou‹: bogu Ãtmask %s\n"), 
Ãtmask
);

266  (
E_OPTERR
);

268 
mask
 = ((
sockaddr_š
 *è&
¹
.
¹_d¡
)->
sš_addr
.
s_addr
;

269 ià(
mask
 & ~
	`mask_š_addr
(
¹
)) {

270 
	`årštf
(
¡d”r
, 
	`_
("route:‚etmask doesn't match„oute‡ddress\n"));

271  (
E_OPTERR
);

275 ià((
aùiÚ
 =ğ
RTACTION_ADD
è&& 
¹
.
¹_æags
 & 
RTF_HOST
)

276 
	`mask_š_addr
(
¹
) = 0xffffffff;

279 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

280 
	`³¼Ü
("socket");

281  (
E_SOCK
);

284 ià(
aùiÚ
 =ğ
RTACTION_DEL
) {

285 ià(
	`ioùl
(
skfd
, 
SIOCDELRT
, &
¹
) < 0) {

286 
	`³¼Ü
("SIOCDELRT");

287 
	`şo£
(
skfd
);

288  (
E_SOCK
);

291 ià(
	`ioùl
(
skfd
, 
SIOCADDRT
, &
¹
) < 0) {

292 
	`³¼Ü
("SIOCADDRT");

293 
	`şo£
(
skfd
);

294  (
E_SOCK
);

299 (è
	`şo£
(
skfd
);

301 
	}
}

303 
	$INET_ršput
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

305 ià(
aùiÚ
 =ğ
RTACTION_FLUSH
) {

306 
	`årštf
(
¡d”r
, 
	`_
("Flushing `inet'„outingable‚ot supported\n"));

307  (
	`u§ge
());

309 ià(
İtiÚs
 & 
FLAG_CACHE
) {

310 
	`årštf
(
¡d”r
, 
	`_
("Modifying `inet'„outing cache‚ot supported\n"));

311  (
	`u§ge
());

313 ià((*
¬gs
 =ğ
NULL
è|| (
aùiÚ
 =ğ
RTACTION_HELP
))

314  (
	`u§ge
());

316  (
	`INET_£Œou‹
(
aùiÚ
, 
İtiÚs
, 
¬gs
));

317 
	}
}

	@interface/net-tools/lib/interface.c

13 
	~"cÚfig.h
"

15 
	~<sys/ty³s.h
>

16 
	~<sys/sock‘.h
>

17 
	~<sys/ioùl.h
>

18 
	~<Ãtš‘/š.h
>

19 
	~<Ãt/if.h
>

20 
	~<¡dio.h
>

21 
	~<”ºo.h
>

22 
	~<¡dlib.h
>

23 
	~<¡ršg.h
>

24 
	~<uni¡d.h
>

25 
	~<ùy³.h
>

26 
	~<¡ršg.h
>

28 #ià
HAVE_AFIPX


29 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

30 
	~<Ãtx/x.h
>

32 
	~"x.h
"

36 #ià
HAVE_AFECONET


37 
	~<Ã‹cÚ‘/ec.h
>

40 #ifdeà
HAVE_HWSLIP


41 
	~<lšux/if_¦.h
>

42 
	~<Ãt/if_¬p.h
>

45 
	~"Ãt-suµÜt.h
"

46 
	~"·thÇmes.h
"

47 
	~"v”siÚ.h
"

48 
	~"´oc.h
"

50 
	~"š‹rçû.h
"

51 
	~"sock‘s.h
"

52 
	~"ut.h
"

53 
	~"š.h
"

55 #ifdeà
IFF_PORTSEL


56 cÚ¡ *
	gif_pÜt_‹xt
[][4] =

59 {"unknown", 
NULL
, NULL, NULL},

60 {"10ba£2", "bnc", "cßx", 
NULL
},

61 {"10ba£T", "u", "e", 
NULL
},

62 {"AUI", "thick", "db15", 
NULL
},

63 {"100ba£T", 
NULL
, NULL, NULL},

64 {"100ba£TX", 
NULL
, NULL, NULL},

65 {"100ba£FX", 
NULL
, NULL, NULL},

66 {
NULL
, NULL, NULL, NULL},

70 
	#IPV6_ADDR_ANY
 0x0000U

	)

72 
	#IPV6_ADDR_UNICAST
 0x0001U

	)

73 
	#IPV6_ADDR_MULTICAST
 0x0002U

	)

74 
	#IPV6_ADDR_ANYCAST
 0x0004U

	)

76 
	#IPV6_ADDR_LOOPBACK
 0x0010U

	)

77 
	#IPV6_ADDR_LINKLOCAL
 0x0020U

	)

78 
	#IPV6_ADDR_SITELOCAL
 0x0040U

	)

80 
	#IPV6_ADDR_COMPATv4
 0x0080U

	)

82 
	#IPV6_ADDR_SCOPE_MASK
 0x00f0U

	)

84 
	#IPV6_ADDR_MAPPED
 0x1000U

	)

85 
	#IPV6_ADDR_RESERVED
 0x2000U

	)

87 
	g´oú‘dev_v¢
 = 1;

89 
	giã_shÜt
;

91 
	gif_li¡_®l
 = 0;

93 
š‹rçû
 *
	gšt_li¡
, *
	gšt_Ï¡
;

95 
if_»adli¡_´oc
(*);

97 
š‹rçû
 *
	$if_ÿche_add
(*
Çme
)

99 
š‹rçû
 *
iã
, **
Ãx
, *
Ãw
;

101 ià(!
št_li¡
)

102 
št_Ï¡
 = 
NULL
;

105 
iã
 = 
št_Ï¡
; iã; iã = iã->
´ev
) {

106 
n
 = 
	`n¡rcmp
(
iã
->
Çme
,‚ame);

107 ià(
n
 == 0)

108  
iã
;

109 ià(
n
 < 0)

112 
	`Ãw
(
Ãw
);

113 
	`§ã_¡ºıy
(
Ãw
->
Çme
,‚ame, 
IFNAMSIZ
);

114 
Ãx
 = 
iã
 ? &iã->
Ãxt
 : &
št_li¡
;

115 
Ãw
->
´ev
 = 
iã
;

116 
Ãw
->
Ãxt
 = *
Ãx
;

117 ià(
Ãw
->
Ãxt
)

118 
Ãw
->
Ãxt
->
´ev
 =‚ew;

120 
št_Ï¡
 = 
Ãw
;

121 *
Ãx
 = 
Ãw
;

122  
Ãw
;

123 
	}
}

125 
š‹rçû
 *
	$lookup_š‹rçû
(*
Çme
)

128 ià(
if_li¡_®l
)

129  
	`if_ÿche_add
(
Çme
);

132 ià(
	`if_»adli¡_´oc
(
Çme
) < 0)

133  
NULL
;

135  
	`if_ÿche_add
(
Çme
);

136 
	}
}

138 
fÜ_®l_š‹rçûs
((*
do™
è(
š‹rçû
 *, *), *
cook›
)

140 
š‹rçû
 *
iã
;

142 ià(!
if_li¡_®l
 && (
	`if_»adli¡
() < 0))

144 
iã
 = 
št_li¡
; iã; iã = iã->
Ãxt
) {

145 
”r
 = 
	`do™
(
iã
, 
cook›
);

146 ià(
”r
)

147  
”r
;

150 
	}
}

152 
	$if_ÿche_ä“
()

154 
š‹rçû
 *
iã
;

155 (
iã
 = 
št_li¡
è!ğ
NULL
) {

156 
št_li¡
 = 
iã
->
Ãxt
;

157 
	`ä“
(
iã
);

159 
št_Ï¡
 = 
NULL
;

160 
if_li¡_®l
 = 0;

162 
	}
}

164 
	$if_»adcÚf
()

166 
num»qs
 = 30;

167 
ifcÚf
 
ifc
;

168 
iäeq
 *
iä
;

169 
n
, 
”r
 = -1;

170 
skfd
;

174 
skfd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

175 ià(
skfd
 < 0) {

176 
	`årštf
(
¡d”r
, 
	`_
("warning:‚o inet socket‡vailable: %s\n"),

177 
	`¡»¼Ü
(
”ºo
));

179 
skfd
 = 
	`sock‘s_İ’
(0);

180 ià(
skfd
 < 0)

184 
ifc
.
ifc_buf
 = 
NULL
;

186 
ifc
.
ifc_Ën
 = (
iäeq
è* 
num»qs
;

187 
ifc
.
ifc_buf
 = 
	`x»®loc
(ifc.ifc_buf, ifc.
ifc_Ën
);

189 ià(
	`ioùl
(
skfd
, 
SIOCGIFCONF
, &
ifc
) < 0) {

190 
	`³¼Ü
("SIOCGIFCONF");

191 
out
;

193 ià(
ifc
.
ifc_Ën
 =ğ(
iäeq
è* 
num»qs
) {

195 
num»qs
 *= 2;

201 
iä
 = 
ifc
.
ifc_»q
;

202 
n
 = 0;‚ < 
ifc
.
ifc_Ën
;‚ +ğ(
iäeq
)) {

203 
	`if_ÿche_add
(
iä
->
iä_Çme
);

204 
iä
++;

206 
”r
 = 0;

208 
out
:

209 
	`ä“
(
ifc
.
ifc_buf
);

210  
”r
;

211 
	}
}

213 *
	$g‘_Çme
(*
Çme
, *
p
)

215 
	`is¥aû
(*
p
))

216 
p
++;

217 *
p
) {

218 ià(
	`is¥aû
(*
p
))

220 ià(*
p
 == ':') {

221 *
dÙ
 = 
p
++;

222 *
p
 && 
	`isdig™
(*p))…++;

223 ià(*
p
 == ':') {

225 
p
 = 
dÙ
;

226 *
Çme
++ = *
p
++;

227 *
p
 && 
	`isdig™
(*p)) {

228 *
Çme
++ = *
p
++;

232 
p
 = 
dÙ
;

234 
p
++;

237 *
Çme
++ = *
p
++;

239 *
Çme
++ = '\0';

240  
p
;

241 
	}
}

243 
	$´oú‘dev_v”siÚ
(*
buf
)

245 ià(
	`¡r¡r
(
buf
, "compressed"))

247 ià(
	`¡r¡r
(
buf
, "bytes"))

250 
	}
}

252 
	$g‘_dev_f›lds
(*
bp
, 
š‹rçû
 *
iã
)

254 
´oú‘dev_v¢
) {

256 
	`ssÿnf
(
bp
,

258 &
iã
->
¡©s
.
rx_by‹s
,

259 &
iã
->
¡©s
.
rx_·ck‘s
,

260 &
iã
->
¡©s
.
rx_”rÜs
,

261 &
iã
->
¡©s
.
rx_drİ³d
,

262 &
iã
->
¡©s
.
rx_fifo_”rÜs
,

263 &
iã
->
¡©s
.
rx_äame_”rÜs
,

264 &
iã
->
¡©s
.
rx_com´es£d
,

265 &
iã
->
¡©s
.
rx_muÉiÿ¡
,

267 &
iã
->
¡©s
.
tx_by‹s
,

268 &
iã
->
¡©s
.
tx_·ck‘s
,

269 &
iã
->
¡©s
.
tx_”rÜs
,

270 &
iã
->
¡©s
.
tx_drİ³d
,

271 &
iã
->
¡©s
.
tx_fifo_”rÜs
,

272 &
iã
->
¡©s
.
cŞlisiÚs
,

273 &
iã
->
¡©s
.
tx_ÿ¼›r_”rÜs
,

274 &
iã
->
¡©s
.
tx_com´es£d
);

277 
	`ssÿnf
(
bp
, "%Lu %Lu %lu %lu %lu %lu %Lu %Lu %lu %lu %lu %lu %lu",

278 &
iã
->
¡©s
.
rx_by‹s
,

279 &
iã
->
¡©s
.
rx_·ck‘s
,

280 &
iã
->
¡©s
.
rx_”rÜs
,

281 &
iã
->
¡©s
.
rx_drİ³d
,

282 &
iã
->
¡©s
.
rx_fifo_”rÜs
,

283 &
iã
->
¡©s
.
rx_äame_”rÜs
,

285 &
iã
->
¡©s
.
tx_by‹s
,

286 &
iã
->
¡©s
.
tx_·ck‘s
,

287 &
iã
->
¡©s
.
tx_”rÜs
,

288 &
iã
->
¡©s
.
tx_drİ³d
,

289 &
iã
->
¡©s
.
tx_fifo_”rÜs
,

290 &
iã
->
¡©s
.
cŞlisiÚs
,

291 &
iã
->
¡©s
.
tx_ÿ¼›r_”rÜs
);

292 
iã
->
¡©s
.
rx_muÉiÿ¡
 = 0;

295 
	`ssÿnf
(
bp
, "%Lu %lu %lu %lu %lu %Lu %lu %lu %lu %lu %lu",

296 &
iã
->
¡©s
.
rx_·ck‘s
,

297 &
iã
->
¡©s
.
rx_”rÜs
,

298 &
iã
->
¡©s
.
rx_drİ³d
,

299 &
iã
->
¡©s
.
rx_fifo_”rÜs
,

300 &
iã
->
¡©s
.
rx_äame_”rÜs
,

302 &
iã
->
¡©s
.
tx_·ck‘s
,

303 &
iã
->
¡©s
.
tx_”rÜs
,

304 &
iã
->
¡©s
.
tx_drİ³d
,

305 &
iã
->
¡©s
.
tx_fifo_”rÜs
,

306 &
iã
->
¡©s
.
cŞlisiÚs
,

307 &
iã
->
¡©s
.
tx_ÿ¼›r_”rÜs
);

308 
iã
->
¡©s
.
rx_by‹s
 = 0;

309 
iã
->
¡©s
.
tx_by‹s
 = 0;

310 
iã
->
¡©s
.
rx_muÉiÿ¡
 = 0;

314 
	}
}

316 
	$if_»adli¡_´oc
(*
rg‘
)

318 
FILE
 *
fh
;

319 
buf
[512];

320 
š‹rçû
 *
iã
;

321 
”r
;

323 
fh
 = 
	`fİ’
(
_PATH_PROCNET_DEV
, "r");

324 ià(!
fh
) {

325 
	`årštf
(
¡d”r
, 
	`_
("Warning: cannot open %s (%s). Limited output.\n"),

326 
_PATH_PROCNET_DEV
, 
	`¡»¼Ü
(
”ºo
));

329 
	`fg‘s
(
buf
,  buf, 
fh
);

330 
	`fg‘s
(
buf
,  buf, 
fh
);

333 
fmt
 = 
	`´oc_g’_fmt
(
_PATH_PROCNET_DEV
, 1, 
fh
,

351 
NULL
);

352 ià(!
fmt
)

355 
´oú‘dev_v¢
 = 
	`´oú‘dev_v”siÚ
(
buf
);

358 
”r
 = 0;

359 
	`fg‘s
(
buf
,  buf, 
fh
)) {

360 *
s
, 
Çme
[
IFNAMSIZ
];

361 
s
 = 
	`g‘_Çme
(
Çme
, 
buf
);

362 
iã
 = 
	`if_ÿche_add
(
Çme
);

363 
	`g‘_dev_f›lds
(
s
, 
iã
);

364 
iã
->
¡©i¡ics_v®id
 = 1;

365 ià(
rg‘
 && !
	`¡rcmp
Ñ¬g‘,
Çme
))

368 ià(
	`ã¼Ü
(
fh
)) {

369 
	`³¼Ü
(
_PATH_PROCNET_DEV
);

370 
”r
 = -1;

374 
	`ä“
(
fmt
);

376 
	`fşo£
(
fh
);

377  
”r
;

378 
	}
}

380 
	$if_»adli¡
()

385 
´oc_”r
, 
cÚf_”r
;

387 
´oc_”r
 = 
	`if_»adli¡_´oc
(
NULL
);

388 
cÚf_”r
 = 
	`if_»adcÚf
();

390 
if_li¡_®l
 = 1;

392 ià(
´oc_”r
 < 0 && 
cÚf_”r
 < 0)

396 
	}
}

400 #ià
HAVE_AFIPX


401 
	$x_g‘addr
(
sock
, 
á
, 
iäeq
 *
iä
)

403 ((
sockaddr_x
 *è&
iä
->
iä_addr
)->
sx_ty³
 = 
á
;

404  
	`ioùl
(
sock
, 
SIOCGIFADDR
, 
iä
);

405 
	}
}

409 
	$if_ãtch
(
š‹rçû
 *
iã
)

411 
iäeq
 
iä
;

412 
fd
;

413 *
iâame
 = 
iã
->
Çme
;

415 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

416 ià(
	`ioùl
(
skfd
, 
SIOCGIFFLAGS
, &
iä
) < 0)

418 
iã
->
æags
 = 
iä
.
iä_æags
;

420 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

421 ià(
	`ioùl
(
skfd
, 
SIOCGIFHWADDR
, &
iä
) < 0)

422 
	`mem£t
(
iã
->
hwaddr
, 0, 32);

424 
	`memıy
(
iã
->
hwaddr
, 
iä
.
iä_hwaddr
.
§_d©a
, 8);

426 
iã
->
ty³
 = 
iä
.
iä_hwaddr
.
§_çmy
;

428 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

429 ià(
	`ioùl
(
skfd
, 
SIOCGIFMETRIC
, &
iä
) < 0)

430 
iã
->
m‘ric
 = 0;

432 
iã
->
m‘ric
 = 
iä
.
iä_m‘ric
;

434 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

435 ià(
	`ioùl
(
skfd
, 
SIOCGIFMTU
, &
iä
) < 0)

436 
iã
->
mtu
 = 0;

438 
iã
->
mtu
 = 
iä
.
iä_mtu
;

440 #ifdeà
HAVE_HWSLIP


441 ià(
iã
->
ty³
 =ğ
ARPHRD_SLIP
 || iã->ty³ =ğ
ARPHRD_CSLIP
 ||

442 
iã
->
ty³
 =ğ
ARPHRD_SLIP6
 || iã->ty³ =ğ
ARPHRD_CSLIP6
 ||

443 
iã
->
ty³
 =ğ
ARPHRD_ADAPT
) {

444 #ifdeà
SIOCGOUTFILL


445 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

446 ià(
	`ioùl
(
skfd
, 
SIOCGOUTFILL
, &
iä
) < 0)

447 
iã
->
outfl
 = 0;

449 
iã
->
outfl
 = (è
iä
.
iä_d©a
;

451 #ifdeà
SIOCGKEEPALIVE


452 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

453 ià(
	`ioùl
(
skfd
, 
SIOCGKEEPALIVE
, &
iä
) < 0)

454 
iã
->
k“·live
 = 0;

456 
iã
->
k“·live
 = (è
iä
.
iä_d©a
;

461 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

462 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0)

463 
	`mem£t
(&
iã
->
m­
, 0, (
ifm­
));

465 
	`memıy
(&
iã
->
m­
, &
iä
.
iä_m­
, (
ifm­
));

467 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

468 ià(
	`ioùl
(
skfd
, 
SIOCGIFMAP
, &
iä
) < 0)

469 
	`mem£t
(&
iã
->
m­
, 0, (
ifm­
));

471 
iã
->
m­
 = 
iä
.
iä_m­
;

473 #ifdeà
HAVE_TXQUEUELEN


474 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

475 ià(
	`ioùl
(
skfd
, 
SIOCGIFTXQLEN
, &
iä
) < 0)

476 
iã
->
tx_queue_Ën
 = -1;

478 
iã
->
tx_queue_Ën
 = 
iä
.
iä_qËn
;

480 
iã
->
tx_queue_Ën
 = -1;

483 #ià
HAVE_AFINET


485 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_INET
);

486 ià(
fd
 >= 0) {

487 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

488 
iä
.
iä_addr
.
§_çmy
 = 
AF_INET
;

489 ià(
	`ioùl
(
fd
, 
SIOCGIFADDR
, &
iä
) == 0) {

490 
iã
->
has_
 = 1;

491 
iã
->
addr
 = 
iä
.
iä_addr
;

492 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

493 ià(
	`ioùl
(
fd
, 
SIOCGIFDSTADDR
, &
iä
) < 0)

494 
	`mem£t
(&
iã
->
d¡addr
, 0, (
sockaddr
));

496 
iã
->
d¡addr
 = 
iä
.
iä_d¡addr
;

498 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

499 ià(
	`ioùl
(
fd
, 
SIOCGIFBRDADDR
, &
iä
) < 0)

500 
	`mem£t
(&
iã
->
brßdaddr
, 0, (
sockaddr
));

502 
iã
->
brßdaddr
 = 
iä
.
iä_brßdaddr
;

504 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

505 ià(
	`ioùl
(
fd
, 
SIOCGIFNETMASK
, &
iä
) < 0)

506 
	`mem£t
(&
iã
->
Ãtmask
, 0, (
sockaddr
));

508 
iã
->
Ãtmask
 = 
iä
.
iä_Ãtmask
;

510 
	`mem£t
(&
iã
->
addr
, 0, (
sockaddr
));

514 #ià
HAVE_AFATALK


516 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_APPLETALK
);

517 ià(
fd
 >= 0) {

518 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

519 ià(
	`ioùl
(
fd
, 
SIOCGIFADDR
, &
iä
) == 0) {

520 
iã
->
dd·ddr
 = 
iä
.
iä_addr
;

521 
iã
->
has_ddp
 = 1;

526 #ià
HAVE_AFIPX


528 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_IPX
);

529 ià(
fd
 >= 0) {

530 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

531 ià(!
	`x_g‘addr
(
fd
, 
IPX_FRAME_ETHERII
, &
iä
)) {

532 
iã
->
has_x_bb
 = 1;

533 
iã
->
xaddr_bb
 = 
iä
.
iä_addr
;

535 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

536 ià(!
	`x_g‘addr
(
fd
, 
IPX_FRAME_SNAP
, &
iä
)) {

537 
iã
->
has_x_¢
 = 1;

538 
iã
->
xaddr_¢
 = 
iä
.
iä_addr
;

540 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

541 ià(!
	`x_g‘addr
(
fd
, 
IPX_FRAME_8023
, &
iä
)) {

542 
iã
->
has_x_e3
 = 1;

543 
iã
->
xaddr_e3
 = 
iä
.
iä_addr
;

545 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

546 ià(!
	`x_g‘addr
(
fd
, 
IPX_FRAME_8022
, &
iä
)) {

547 
iã
->
has_x_e2
 = 1;

548 
iã
->
xaddr_e2
 = 
iä
.
iä_addr
;

553 #ià
HAVE_AFECONET


555 
fd
 = 
	`g‘_sock‘_fÜ_af
(
AF_ECONET
);

556 ià(
fd
 >= 0) {

557 
	`¡rıy
(
iä
.
iä_Çme
, 
iâame
);

558 ià(
	`ioùl
(
fd
, 
SIOCGIFADDR
, &
iä
) == 0) {

559 
iã
->
eÿddr
 = 
iä
.
iä_addr
;

560 
iã
->
has_ecÚ‘
 = 1;

566 
	}
}

568 
	$do_if_ãtch
(
š‹rçû
 *
iã
)

570 ià(
	`if_ãtch
(
iã
) < 0) {

571 *
”rmsg
;

572 ià(
”ºo
 =ğ
ENODEV
) {

574 
”rmsg
 = 
	`_
("Device‚ot found");

576 
”rmsg
 = 
	`¡»¼Ü
(
”ºo
);

578 
	`årštf
(
¡d”r
, 
	`_
("%s:ƒrror fetching interface information: %s\n"),

579 
iã
->
Çme
, 
”rmsg
);

583 
	}
}

585 
	$do_if_´št
(
š‹rçû
 *
iã
, *
cook›
)

587 *
İt_a
 = (*è
cook›
;

588 
»s
;

590 
»s
 = 
	`do_if_ãtch
(
iã
);

591 ià(
»s
 >= 0) {

592 ià((
iã
->
æags
 & 
IFF_UP
è|| *
İt_a
)

593 
	`iã_´št
(
iã
);

595  
»s
;

596 
	}
}

598 
	$iã_´št_shÜt
(
š‹rçû
 *
±r
)

600 
	`´štf
("%-5.5 ", 
±r
->
Çme
);

601 
	`´štf
("%5d %-2d ", 
±r
->
mtu
,…Œ->
m‘ric
);

603 ià(
±r
->
¡©i¡ics_v®id
) {

604 
	`´štf
("%8llu %6lu %6lu %-6lu ",

605 
±r
->
¡©s
.
rx_·ck‘s
,…Œ->¡©s.
rx_”rÜs
,

606 
±r
->
¡©s
.
rx_drİ³d
,…Œ->¡©s.
rx_fifo_”rÜs
);

607 
	`´štf
("%8llu %6lu %6lu %6lu ",

608 
±r
->
¡©s
.
tx_·ck‘s
,…Œ->¡©s.
tx_”rÜs
,

609 
±r
->
¡©s
.
tx_drİ³d
,…Œ->¡©s.
tx_fifo_”rÜs
);

611 
	`´štf
("%-56s", 
	`_
(" -‚o statistics‡vailable -"));

614 ià(
±r
->
æags
 == 0)

615 
	`´štf
(
	`_
("[NO FLAGS]"));

616 ià(
±r
->
æags
 & 
IFF_ALLMULTI
)

617 
	`´štf
("A");

618 ià(
±r
->
æags
 & 
IFF_BROADCAST
)

619 
	`´štf
("B");

620 ià(
±r
->
æags
 & 
IFF_DEBUG
)

621 
	`´štf
("D");

622 ià(
±r
->
æags
 & 
IFF_LOOPBACK
)

623 
	`´štf
("L");

624 ià(
±r
->
æags
 & 
IFF_MULTICAST
)

625 
	`´štf
("M");

626 #ifdeà
HAVE_DYNAMIC


627 ià(
±r
->
æags
 & 
IFF_DYNAMIC
)

628 
	`´štf
("d");

630 ià(
±r
->
æags
 & 
IFF_PROMISC
)

631 
	`´štf
("P");

632 ià(
±r
->
æags
 & 
IFF_NOTRAILERS
)

633 
	`´štf
("N");

634 ià(
±r
->
æags
 & 
IFF_NOARP
)

635 
	`´štf
("O");

636 ià(
±r
->
æags
 & 
IFF_POINTOPOINT
)

637 
	`´štf
("P");

638 ià(
±r
->
æags
 & 
IFF_SLAVE
)

639 
	`´štf
("s");

640 ià(
±r
->
æags
 & 
IFF_MASTER
)

641 
	`´štf
("m");

642 ià(
±r
->
æags
 & 
IFF_RUNNING
)

643 
	`´štf
("R");

644 ià(
±r
->
æags
 & 
IFF_UP
)

645 
	`´štf
("U");

647 
	`´štf
("\n");

648 
	}
}

650 
	$iã_´št_lÚg
(
š‹rçû
 *
±r
)

652 
aáy³
 *
­
;

653 
hwty³
 *
hw
;

654 
hf
;

655 
ÿn_com´ess
 = 0;

656 
rx
, 
tx
, 
shÜt_rx
, 
shÜt_tx
;

657 cÚ¡ *
Rext
 = "B";

658 cÚ¡ *
Text
 = "B";

659 
æags
[200];

661 #ià
HAVE_AFIPX


662 
aáy³
 *
xty³
 = 
NULL
;

664 #ià
HAVE_AFECONET


665 
aáy³
 *
eùy³
 = 
NULL
;

667 #ià
HAVE_AFATALK


668 
aáy³
 *
dd±y³
 = 
NULL
;

670 #ià
HAVE_AFINET6


671 
FILE
 *
f
;

672 
addr6
[40], 
devÇme
[21];

673 
sockaddr_š6
 
§p
;

674 
¶’
, 
scİe
, 
dad_¡©us
, 
if_idx
;

675 
aáy³
 
š‘6_aáy³
;

676 
addr6p
[8][5];

679 
­
 = 
	`g‘_aâty³
(
±r
->
addr
.
§_çmy
);

680 ià(
­
 =ğ
NULL
)

681 
­
 = 
	`g‘_aâty³
(0);

683 
hf
 = 
±r
->
ty³
;

685 ià(
hf
 =ğ
ARPHRD_CSLIP
 || hà=ğ
ARPHRD_CSLIP6
)

686 
ÿn_com´ess
 = 1;

688 
hw
 = 
	`g‘_hwÁy³
(
hf
);

689 ià(
hw
 =ğ
NULL
)

690 
hw
 = 
	`g‘_hwÁy³
(-1);

692 
	`¥rštf
(
æags
, "æags=%d<", 
±r
->flags);

694 ià(
±r
->
æags
 == 0)

695 
	`¡rÿt
(
æags
,">");

696 ià(
±r
->
æags
 & 
IFF_UP
)

697 
	`¡rÿt
(
æags
,
	`_
("UP,"));

698 ià(
±r
->
æags
 & 
IFF_BROADCAST
)

699 
	`¡rÿt
(
æags
,
	`_
("BROADCAST,"));

700 ià(
±r
->
æags
 & 
IFF_DEBUG
)

701 
	`¡rÿt
(
æags
,
	`_
("DEBUG,"));

702 ià(
±r
->
æags
 & 
IFF_LOOPBACK
)

703 
	`¡rÿt
(
æags
,
	`_
("LOOPBACK,"));

704 ià(
±r
->
æags
 & 
IFF_POINTOPOINT
)

705 
	`¡rÿt
(
æags
,
	`_
("POINTOPOINT,"));

706 ià(
±r
->
æags
 & 
IFF_NOTRAILERS
)

707 
	`¡rÿt
(
æags
,
	`_
("NOTRAILERS,"));

708 ià(
±r
->
æags
 & 
IFF_RUNNING
)

709 
	`¡rÿt
(
æags
,
	`_
("RUNNING,"));

710 ià(
±r
->
æags
 & 
IFF_NOARP
)

711 
	`¡rÿt
(
æags
,
	`_
("NOARP,"));

712 ià(
±r
->
æags
 & 
IFF_PROMISC
)

713 
	`¡rÿt
(
æags
,
	`_
("PROMISC,"));

714 ià(
±r
->
æags
 & 
IFF_ALLMULTI
)

715 
	`¡rÿt
(
æags
,
	`_
("ALLMULTI,"));

716 ià(
±r
->
æags
 & 
IFF_SLAVE
)

717 
	`¡rÿt
(
æags
,
	`_
("SLAVE,"));

718 ià(
±r
->
æags
 & 
IFF_MASTER
)

719 
	`¡rÿt
(
æags
,
	`_
("MASTER,"));

720 ià(
±r
->
æags
 & 
IFF_MULTICAST
)

721 
	`¡rÿt
(
æags
,
	`_
("MULTICAST,"));

722 #ifdeà
HAVE_DYNAMIC


723 ià(
±r
->
æags
 & 
IFF_DYNAMIC
)

724 
	`¡rÿt
(
æags
,
	`_
("DYNAMIC,"));

727 ià(
æags
[
	`¡¾’
(flags)-1] == ',')

728 
æags
[
	`¡¾’
(flags)-1] = '>';

730 
æags
[
	`¡¾’
(flags)-1] = 0;

733 
	`´štf
(
	`_
("%s: %s mtu %d metric %d"),

734 
±r
->
Çme
, 
æags
,…Œ->
mtu
,…Œ->
m‘ric
 ?…tr->metric : 1);

735 #ifdeà
SIOCSKEEPALIVE


736 ià(
±r
->
outfl
 ||…Œ->
k“·live
)

737 
	`´štf
(
	`_
(" outfill %d keepalive %d"),

738 
±r
->
outfl
,…Œ->
k“·live
);

740 
	`´štf
("\n");

744 #ià
HAVE_AFINET


745 ià(
±r
->
has_
) {

746 
	`´štf
(
	`_
(" % %s"), 
­
->
Çme
,

747 
­
->
	`¥ršt
(&
±r
->
addr
, 1));

748 
	`´štf
(
	`_
("‚‘mask %s"), 
­
->
	`¥ršt
(&
±r
->
Ãtmask
, 1));

749 ià(
±r
->
æags
 & 
IFF_BROADCAST
) {

750 
	`´štf
(
	`_
(" brßdÿ¡ %s"), 
­
->
	`¥ršt
(&
±r
->
brßdaddr
, 1));

752 ià(
±r
->
æags
 & 
IFF_POINTOPOINT
) {

753 
	`´štf
(
	`_
(" de¡š©iÚ %s"), 
­
->
	`¥ršt
(&
±r
->
d¡addr
, 1));

755 
	`´štf
("\n");

759 #ià
HAVE_AFINET6


762 ià((
f
 = 
	`fİ’
(
_PATH_PROCNET_IFINET6
, "r")è!ğ
NULL
) {

763 
	`fsÿnf
(
f
, "%4s%4s%4s%4s%4s%4s%4s%4s %08x %02x %02x %02x %20s\n",

764 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

765 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7],

766 &
if_idx
, &
¶’
, &
scİe
, &
dad_¡©us
, 
devÇme
è!ğ
EOF
) {

767 ià(!
	`¡rcmp
(
devÇme
, 
±r
->
Çme
)) {

768 
	`¥rštf
(
addr6
, "%s:%s:%s:%s:%s:%s:%s:%s",

769 
addr6p
[0],‡ddr6p[1],‡ddr6p[2],‡ddr6p[3],

770 
addr6p
[4],‡ddr6p[5],‡ddr6p[6],‡ddr6p[7]);

771 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
§p
);

772 
	`´štf
(
	`_
(" %s %s…refixlen %d"),

773 
š‘6_aáy³
.
Çme
,

774 
š‘6_aáy³
.
	`¥ršt
((
sockaddr
 *è&
§p
, 1),

775 
¶’
);

776 
	`´štf
(
	`_
(" scİeid 0x%x"), 
scİe
);

778 
æags
[0] = '<'; flags[1] = 0;

779 ià(
scİe
 & 
IPV6_ADDR_COMPATv4
) {

780 
	`¡rÿt
(
æags
, 
	`_
("compat,"));

781 
scİe
 -ğ
IPV6_ADDR_COMPATv4
;

783 ià(
scİe
 == 0)

784 
	`¡rÿt
(
æags
, 
	`_
("global,"));

785 ià(
scİe
 & 
IPV6_ADDR_LINKLOCAL
)

786 
	`¡rÿt
(
æags
, 
	`_
("link,"));

787 ià(
scİe
 & 
IPV6_ADDR_SITELOCAL
)

788 
	`¡rÿt
(
æags
, 
	`_
("site,"));

789 ià(
scİe
 & 
IPV6_ADDR_LOOPBACK
)

790 
	`¡rÿt
(
æags
, 
	`_
("host,"));

791 ià(
æags
[
	`¡¾’
(flags)-1] == ',')

792 
æags
[
	`¡¾’
(flags)-1] = '>';

794 
æags
[
	`¡¾’
(flags)-1] = 0;

795 
	`´štf
("%s\n", 
æags
);

798 
	`fşo£
(
f
);

802 #ià
HAVE_AFIPX


803 ià(
xty³
 =ğ
NULL
)

804 
xty³
 = 
	`g‘_aâty³
(
AF_IPX
);

806 ià(
xty³
 !ğ
NULL
) {

807 ià(
±r
->
has_x_bb
)

808 
	`´štf
(
	`_
(" %s Ethernet-II %s\n"),

809 
xty³
->
Çme
, ipxty³->
	`¥ršt
(&
±r
->
xaddr_bb
, 1));

810 ià(
±r
->
has_x_¢
)

811 
	`´štf
(
	`_
(" %s Ethernet-SNAP %s\n"),

812 
xty³
->
Çme
, ipxty³->
	`¥ršt
(&
±r
->
xaddr_¢
, 1));

813 ià(
±r
->
has_x_e2
)

814 
	`´štf
(
	`_
(" %s Ethernet802.2 %s\n"),

815 
xty³
->
Çme
, ipxty³->
	`¥ršt
(&
±r
->
xaddr_e2
, 1));

816 ià(
±r
->
has_x_e3
)

817 
	`´štf
(
	`_
(" %s Ethernet802.3 %s\n"),

818 
xty³
->
Çme
, ipxty³->
	`¥ršt
(&
±r
->
xaddr_e3
, 1));

822 #ià
HAVE_AFATALK


823 ià(
dd±y³
 =ğ
NULL
)

824 
dd±y³
 = 
	`g‘_aâty³
(
AF_APPLETALK
);

825 ià(
dd±y³
 !ğ
NULL
) {

826 ià(
±r
->
has_ddp
)

827 
	`´štf
(
	`_
(" % %s\n"), 
dd±y³
->
Çme
, dd±y³->
	`¥ršt
(&
±r
->
dd·ddr
, 1));

831 #ià
HAVE_AFECONET


832 ià(
eùy³
 =ğ
NULL
)

833 
eùy³
 = 
	`g‘_aâty³
(
AF_ECONET
);

834 ià(
eùy³
 !ğ
NULL
) {

835 ià(
±r
->
has_ecÚ‘
)

836 
	`´štf
(
	`_
(" % %s\n"), 
eùy³
->
Çme
,ƒùy³->
	`¥ršt
(&
±r
->
eÿddr
, 1));

842 ià(
hw
->
´št
 !ğ
NULL
 && (! (
	`hw_nuÎ_add»ss
(hw, 
±r
->
hwaddr
) &&

843 
hw
->
suµ»ss_nuÎ_addr
)))

844 
	`´štf
(
	`_
(" % %s"), 
hw
->
Çme
, hw->
	`´št
(
±r
->
hwaddr
));

846 
	`´štf
(
	`_
(" %s"), 
hw
->
Çme
);

847 ià(
±r
->
tx_queue_Ën
 != -1)

848 
	`´štf
(
	`_
("xqueu–’ %d"), 
±r
->
tx_queue_Ën
);

849 
	`´štf
(" (%s)\n", 
hw
->
t™Ë
);

851 #ifdeà
IFF_PORTSEL


852 ià(
±r
->
æags
 & 
IFF_PORTSEL
) {

853 
	`´štf
(
	`_
(" medŸ %s"), 
if_pÜt_‹xt
[
±r
->
m­
.
pÜt
][0]);

854 ià(
±r
->
æags
 & 
IFF_AUTOMEDIA
)

855 
	`´štf
(
	`_
("autoselect"));

856 
	`´štf
("\n");

863 ià(
±r
->
¡©i¡ics_v®id
) {

868 
rx
 = 
±r
->
¡©s
.
rx_by‹s
;

869 
shÜt_rx
 = 
rx
 * 10;

870 ià(
rx
 > 1125899906842624ull) {

871 
shÜt_rx
 /= 1125899906842624ull;

872 
Rext
 = "PiB";

873 } ià(
rx
 > 1099511627776ull) {

874 
shÜt_rx
 /= 1099511627776ull;

875 
Rext
 = "TiB";

876 } ià(
rx
 > 1073741824ull) {

877 
shÜt_rx
 /= 1073741824ull;

878 
Rext
 = "GiB";

879 } ià(
rx
 > 1048576) {

880 
shÜt_rx
 /= 1048576;

881 
Rext
 = "MiB";

882 } ià(
rx
 > 1024) {

883 
shÜt_rx
 /= 1024;

884 
Rext
 = "KiB";

886 
tx
 = 
±r
->
¡©s
.
tx_by‹s
;

887 
shÜt_tx
 = 
tx
 * 10;

888 ià(
tx
 > 1125899906842624ull) {

889 
shÜt_tx
 /= 1125899906842624ull;

890 
Text
 = "PiB";

891 } ià(
tx
 > 1099511627776ull) {

892 
shÜt_tx
 /= 1099511627776ull;

893 
Text
 = "TiB";

894 } ià(
tx
 > 1073741824ull) {

895 
shÜt_tx
 /= 1073741824ull;

896 
Text
 = "GiB";

897 } ià(
tx
 > 1048576) {

898 
shÜt_tx
 /= 1048576;

899 
Text
 = "MiB";

900 } ià(
tx
 > 1024) {

901 
shÜt_tx
 /= 1024;

902 
Text
 = "KiB";

905 
	`´štf
(" ");

906 
	`´štf
(
	`_
("RX…ackets %llu bytes %llu (%lu.%lu %s)\n"),

907 
±r
->
¡©s
.
rx_·ck‘s
,

908 
rx
, ()(
shÜt_rx
 / 10),

909 ()(
shÜt_rx
 % 10), 
Rext
);

910 ià(
ÿn_com´ess
) {

911 
	`´štf
(" ");

912 
	`´štf
(
	`_
("RX com´es£d:%lu\n"), 
±r
->
¡©s
.
rx_com´es£d
);

914 
	`´štf
(" ");

915 
	`´štf
(
	`_
("RXƒrrors %lu dropped %lu overruns %lu frame %lu\n"),

916 
±r
->
¡©s
.
rx_”rÜs
,…Œ->¡©s.
rx_drİ³d
,

917 
±r
->
¡©s
.
rx_fifo_”rÜs
,…Œ->¡©s.
rx_äame_”rÜs
);

920 
	`´štf
(" ");

921 
	`´štf
(
	`_
("TX…ackets %llu bytes %llu (%lu.%lu %s)\n"),

922 
±r
->
¡©s
.
tx_·ck‘s
,

923 
tx
, ()(
shÜt_tx
 / 10),

924 ()(
shÜt_tx
 % 10), 
Text
);

925 ià(
ÿn_com´ess
) {

926 
	`´štf
(" ");

927 
	`´štf
(
	`_
("TX com´es£d %lu\n"), 
±r
->
¡©s
.
tx_com´es£d
);

929 
	`´štf
(" ");

930 
	`´štf
(
	`_
("TXƒrrors %lu dropped %lu overruns %lu carrier %lu collisions %lu\n"),

931 
±r
->
¡©s
.
tx_”rÜs
,

932 
±r
->
¡©s
.
tx_drİ³d
,…Œ->¡©s.
tx_fifo_”rÜs
,

933 
±r
->
¡©s
.
tx_ÿ¼›r_”rÜs
,…Œ->¡©s.
cŞlisiÚs
);

936 ià((
±r
->
m­
.
œq
 ||…Œ->m­.
mem_¡¬t
 ||…Œ->m­.
dma
 ||

937 
±r
->
m­
.
ba£_addr
 >= 0x100)) {

938 
	`´štf
(" device ");

939 ià(
±r
->
m­
.
œq
)

940 
	`´štf
(
	`_
("š‹¼u± %d "), 
±r
->
m­
.
œq
);

941 ià(
±r
->
m­
.
ba£_addr
 >= 0x100)

943 
	`´štf
(
	`_
("ba£ 0x%x "), 
±r
->
m­
.
ba£_addr
);

944 ià(
±r
->
m­
.
mem_¡¬t
) {

945 
	`´štf
(
	`_
("memÜy 0x%lx-%lx "), 
±r
->
m­
.
mem_¡¬t
,…Œ->m­.
mem_’d
);

947 ià(
±r
->
m­
.
dma
)

948 
	`´štf
(
	`_
(" dm¨0x%x"), 
±r
->
m­
.
dma
);

949 
	`´štf
("\n");

951 
	`´štf
("\n");

952 
	}
}

954 
	$iã_´št
(
š‹rçû
 *
i
)

956 ià(
iã_shÜt
)

957 
	`iã_´št_shÜt
(
i
);

959 
	`iã_´št_lÚg
(
i
);

960 
	}
}

	@interface/net-tools/lib/ipx.c

16 
	~"cÚfig.h
"

18 #ià
HAVE_AFIPX


19 
	~<asm/ty³s.h
>

20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

23 
	~<Ãtx/x.h
>

25 
	~"x.h
"

27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<”ºo.h
>

30 
	~<ùy³.h
>

31 
	~<¡ršg.h
>

32 
	~<uni¡d.h
>

33 
	~<Ãtš‘/š.h
>

34 
	~"v”siÚ.h
"

35 
	~"Ãt-suµÜt.h
"

36 
	~"·thÇmes.h
"

37 
	~"š.h
"

38 
	~"ut.h
"

40 #ià(
IPX_NODE_LEN
 != 6)

45 *
	$IPX_´št
(*
±r
)

47 
buff
[64];

48 
sockaddr_x
 *
sx
 = (sockaddr_x *è(
±r
 - 2);

49 
t
;

52 
t
 = 
IPX_NODE_LEN
;;--)

53 ià(
sx
->
sx_node
[
t
 - 1])

56 ià(
t
 && 
	`Áohl
(
sx
->
sx_ÃtwÜk
))

57 
	`¢´štf
(
buff
, (buff), "%08lX:%02X%02X%02X%02X%02X%02X",

58 (è
	`Áohl
(
sx
->
sx_ÃtwÜk
),

59 (è
sx
->
sx_node
[0], () sipx->sipx_node[1],

60 (è
sx
->
sx_node
[2], () sipx->sipx_node[3],

61 (è
sx
->
sx_node
[4], () sipx->sipx_node[5]);

62 ià(!
t
 && 
	`Áohl
(
sx
->
sx_ÃtwÜk
))

63 
	`¢´štf
(
buff
, (buff), "%08lX", (è
	`Áohl
(
sx
->
sx_ÃtwÜk
));

64 ià(
t
 && !
	`Áohl
(
sx
->
sx_ÃtwÜk
))

65 
	`¢´štf
(
buff
, (buff), "%02X%02X%02X%02X%02X%02X",

66 (è
sx
->
sx_node
[0], () sipx->sipx_node[1],

67 (è
sx
->
sx_node
[2], () sipx->sipx_node[3],

68 (è
sx
->
sx_node
[4], () sipx->sipx_node[5]);

70 
buff
[0] = '\0';

71  (
buff
);

72 
	}
}

76 *
	$IPX_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

78 
buf
[64];

80 ià(
§p
->
§_çmy
 !ğ
AF_IPX
)

81  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

82  (
	`IPX_´št
(
§p
->
§_d©a
));

83 
	}
}

86 
	$IPX_g‘sock
(*
buå
, 
sockaddr
 *
§p
)

88 *
¥
 = 
buå
, *
bp
;

89 
i
;

90 
v®
;

91 
sockaddr_x
 *
sx
 = (sockaddr_x *è
§p
;

93 
sx
->
sx_pÜt
 = 0;

95 
v®
 = 0;

96 
bp
 = (*è
sx
->
sx_node
;

97 
i
 = 0; i < (
sx
->
sx_node
); i++) {

98 *
¥
 = 
	`touµ”
(*sp);

100 ià((*
¥
 >= 'A') && (*sp <= 'F'))

101 
bp
[
i
] |ğ(è(*
¥
 - 'A') + 10;

102 ià((*
¥
 >= '0') && (*sp <= '9'))

103 
bp
[
i
] |ğ(è(*
¥
 - '0');

107 
bp
[
i
] <<= 4;

108 
¥
++;

109 *
¥
 = 
	`touµ”
(*sp);

111 ià((*
¥
 >= 'A') && (*sp <= 'F'))

112 
bp
[
i
] |ğ(è(*
¥
 - 'A') + 10;

113 ià((*
¥
 >= '0') && (*sp <= '9'))

114 
bp
[
i
] |ğ(è(*
¥
 - '0');

118 
¥
++;

120 ià((
	`memcmp
(
sx
->
sx_node
, "\0\0\0\0\0\0\0\0", 
IPX_NODE_LEN
) == 0) ||

121 (
	`memcmp
(
sx
->
sx_node
, "\377\377\377\377\377\377", 
IPX_NODE_LEN
) == 0))

125 
	}
}

129 
	$IPX_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

131 
sockaddr_x
 *
§i
 = (sockaddr_x *è
§p
;

132 
ÃŠum
;

133 *
•
;

134 
nbo
;

136 ià(!
§i
)

139 
§i
->
sx_çmy
 = 
AF_IPX
;

140 
§i
->
sx_ÃtwÜk
 = 
	`htÚl
(0);

141 
§i
->
sx_node
[0] = sai->sipx_node[1] = sai->sipx_node[2] =

142 
§i
->
sx_node
[3] = sai->sipx_node[4] = sai->sipx_node[5] = '\0';

143 
§i
->
sx_pÜt
 = 0;

145 ià(
ty³
 & 4)

146 
nbo
 = 1;

148 
nbo
 = 0;

150 
ty³
 &= 3;

151 ià(
ty³
 <= 1) {

152 
ÃŠum
 = 
	`¡¹oul
(
buå
, &
•
, 16);

153 ià((
ÃŠum
 == 0xffffffffL) || (netnum == 0L))

155 ià(
nbo
)

156 
§i
->
sx_ÃtwÜk
 = 
ÃŠum
;

158 
§i
->
sx_ÃtwÜk
 = 
	`htÚl
(
ÃŠum
);

160 ià(
ty³
 == 1) {

161 ià(*
•
 != '\0')

165 ià(
ty³
 == 0) {

166 ià(*
•
 != ':')

168 
buå
 = 
•
 + 1;

170  (
	`IPX_g‘sock
(
buå
, 
§p
));

171 
	}
}

174 
aáy³
 
	gx_aáy³
 =

176 "x", 
NULL
, 
AF_IPX
, 0,

177 
IPX_´št
, 
IPX_¥ršt
, 
IPX_šput
, 
NULL
,

178 
NULL
 , NULL, NULL,

	@interface/net-tools/lib/ipx_gr.c

8 
	~"cÚfig.h
"

10 #ià
HAVE_AFIPX


11 
	~<asm/ty³s.h
>

12 
	~<sys/ty³s.h
>

13 
	~<sys/sock‘.h
>

14 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

15 
	~<Ãtx/x.h
>

17 
	~"x.h
"

19 
	~<¡dlib.h
>

20 
	~<¡dio.h
>

21 
	~<”ºo.h
>

22 
	~<ùy³.h
>

23 
	~<¡ršg.h
>

24 
	~<uni¡d.h
>

25 
	~<Ãtš‘/š.h
>

26 
	~"v”siÚ.h
"

27 
	~"Ãt-suµÜt.h
"

28 
	~"·thÇmes.h
"

29 
	~"š.h
"

33 
	$IPX_½ršt
(
İtiÚs
)

36 
num”ic
 = 
İtiÚs
 & 
FLAG_NUM_HOST
;

37 
buff
[1024];

38 
Ãt
[128], 
rou‹r_Ãt
[128];

39 
rou‹r_node
[128];

40 
num
;

41 
FILE
 *
å
;

42 
aáy³
 *
­
;

43 
sockaddr
 
§
;

45 
å
 = 
	`fİ’
(
_PATH_PROCNET_IPX_ROUTE1
, "r");

47 ià(!
å
) {

48 
å
 = 
	`fİ’
(
_PATH_PROCNET_IPX_ROUTE2
, "r");

51 ià(!
å
) {

52 
	`³¼Ü
(
NULL
);

53 
	`´štf
(
	`_
("IPX„outšg‚Ù iÀf% Ü % found.\n"), 
_PATH_PROCNET_IPX_ROUTE1
, 
_PATH_PROCNET_IPX_ROUTE2
);

57 ià((
­
 = 
	`g‘_aâty³
(
AF_IPX
)è=ğ
NULL
) {

58 
	`EINTERN
("lib/ipx_rt.c", "AF_IPX missing");

62 
	`´štf
(
	`_
("Kernel IPX„outingable\n"));

63 
	`´štf
(
	`_
("Destination Router Net Router Node\n"));

65 
	`fg‘s
(
buff
, 1023, 
å
);

67 
	`fg‘s
(
buff
, 1023, 
å
)) {

68 
num
 = 
	`ssÿnf
(
buff
, "% % %s", 
Ãt
, 
rou‹r_Ãt
, 
rou‹r_node
);

69 ià(
num
 < 3)

73 (è
­
->
	`šput
(5, 
Ãt
, &
§
);

74 
	`¡rıy
(
Ãt
, 
­
->
	`¥ršt
(&
§
, 
num”ic
));

77 (è
­
->
	`šput
(5, 
rou‹r_Ãt
, &
§
);

78 
	`¡rıy
(
rou‹r_Ãt
, 
­
->
	`¥ršt
(&
§
, 
num”ic
));

81 (è
­
->
	`šput
(2, 
rou‹r_node
, &
§
);

82 
	`¡rıy
(
rou‹r_node
, 
­
->
	`¥ršt
(&
§
, 
num”ic
));

84 
	`´štf
("%-25 %-25 %-25s\n", 
Ãt
, 
rou‹r_Ãt
, 
rou‹r_node
);

87 (è
	`fşo£
(
å
);

89 
	}
}

	@interface/net-tools/lib/ipx_sr.c

1 
	~"cÚfig.h
"

3 #ià
HAVE_AFIPX


4 
	~<sys/·¿m.h
>

5 
	~<sys/ty³s.h
>

6 
	~<sys/sock‘.h
>

7 
	~<Ãtš‘/š.h
>

8 
	~<¬·/š‘.h
>

9 
	~<¬·/Çme£r.h
>

10 
	~<sys/ioùl.h
>

11 
	~<ùy³.h
>

12 
	~<”ºo.h
>

13 
	~<Ãtdb.h
>

14 
	~<»sŞv.h
>

15 
	~<¡dlib.h
>

16 
	~<¡ršg.h
>

17 
	~<¡dio.h
>

18 
	~<uni¡d.h
>

19 
	~"v”siÚ.h
"

20 
	~"Ãt-suµÜt.h
"

21 
	~"·thÇmes.h
"

22 
	~"š.h
"

24 
	~"Ãt-ã©u»s.h
"

26 
aáy³
 
x_aáy³
;

30 
	$IPX_ršput
(
aùiÚ
, 
ext
, **
¬gs
)

33 
	`årštf
(
¡d”r
, 
	`_
("IPX:his‚eedso be written\n"));

35 
	}
}

	@interface/net-tools/lib/irda.c

31 
	~"cÚfig.h
"

33 #ià
HAVE_AFIRDA
 || 
HAVE_HWIRDA


34 
	~<sys/ty³s.h
>

35 
	~<sys/ioùl.h
>

36 
	~<sys/sock‘.h
>

37 
	~<Ãt/if_¬p.h
>

38 
	~<¡dlib.h
>

39 
	~<¡dio.h
>

40 
	~<ùy³.h
>

41 
	~<”ºo.h
>

42 
	~<fú.h
>

43 
	~<¡ršg.h
>

44 
	~<‹rmios.h
>

45 
	~<uni¡d.h
>

46 
	~"Ãt-suµÜt.h
"

47 
	~"·thÇmes.h
"

48 
	~"š.h
"

49 
	~"ut.h
"

52 #iâdeà
ARPHRD_IRDA


53 
	#ARPHRD_IRDA
 783

	)

62 *
	$œda_´št
(*
±r
)

64 
buff
[12];

66 
	`¢´štf
(
buff
, 12, "%02x:%02x:%02x:%02x", 
±r
[3],…tr[2],

67 
±r
[1],…tr[0]);

69  (
buff
);

70 
	}
}

72 
hwty³
 
	gœda_hwty³
 =

74 "œda", 
NULL
, 
ARPHRD_IRDA
, 2,

75 
œda_´št
, 
NULL
, NULL, 0

	@interface/net-tools/lib/loopback.c

18 
	~"cÚfig.h
"

20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<¡dlib.h
>

24 
	~<¡dio.h
>

25 
	~<”ºo.h
>

26 
	~<ùy³.h
>

27 
	~<¡ršg.h
>

28 
	~<uni¡d.h
>

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"š.h
"

32 
	~"ut.h
"

35 *
	$´_un¥ec
(*
±r
)

37 
buff
[64];

38 *
pos
;

39 
i
;

41 
pos
 = 
buff
;

42 
i
 = 0; i < (
sockaddr
); i++) {

43 
pos
 +ğ
	`¥rštf
Õos, "%02X-", (*
±r
++ & 0377));

45 
buff
[
	`¡¾’
(buff) - 1] = '\0';

46  (
buff
);

47 
	}
}

49 
hwty³
 
	gun¥ec_hwty³
 =

51 "un¥ec", 
NULL
, -1, 0,

52 
´_un¥ec
, 
NULL
, NULL

55 
hwty³
 
	gloİ_hwty³
 =

57 "loİ", 
NULL
, 
ARPHRD_LOOPBACK
, 0,

58 
NULL
, NULL, NULL

	@interface/net-tools/lib/masq_info.c

28 
	~<sys/ty³s.h
>

29 
	~<sys/sock‘.h
>

30 
	~<Ãtš‘/š.h
>

31 
	~<¬·/š‘.h
>

32 
	~<”ºo.h
>

33 
	~<¡dio.h
>

34 
	~<m®loc.h
>

35 
	~<¡ršg.h
>

36 
	~<uni¡d.h
>

37 
	~"Ãt-suµÜt.h
"

38 
	~"·thÇmes.h
"

39 
	~"v”siÚ.h
"

40 
	~"cÚfig.h
"

41 
	~"š.h
"

42 
	~"Ãt-ã©u»s.h
"

44 #ià
HAVE_FW_MASQUERADE


46 
	smasq
 {

47 
	mexpœes
;

48 *
	m´Ùo
;

49 
sockaddr_š
 
	m¤c
, 
	md¡
;

50 
	m¥Üt
, 
	mdpÜt
;

51 
	mmpÜt
;

52 
	mš™£q
;

53 
	md–
;

54 
	mpd–
;

57 
aáy³
 *
	g­
;

58 
	ghas_pd–
;

60 
	$´št_masq
(
masq
 *
ms
, 
num”ic_ho¡
, 
num”ic_pÜt
,

61 
ext
)

63 
mšu‹s
, 
£cÚds
, 
£c100s
;

65 
	`´štf
("%-4s", 
ms
->
´Ùo
);

67 
£c100s
 = 
ms
->
expœes
 % 100L;

68 
£cÚds
 = (
ms
->
expœes
 / 100L) % 60;

69 
mšu‹s
 = 
ms
->
expœes
 / 6000L;

71 
	`´štf
("%3ld:%02ld.%02ld ", 
mšu‹s
, 
£cÚds
, 
£c100s
);

73 ià(
ext
 > 1) {

74 ià(
has_pd–
)

75 
	`´štf
("%10lu %5hd %5hd ", 
ms
->
š™£q
,

76 
ms
->
d–
, ms->
pd–
);

78 
	`´štf
("%10lu %5hd - ", 
ms
->
š™£q
,

79 
ms
->
d–
);

81 
	`´štf
("%-20 ", 
­
->
	`¥ršt
((
sockaddr
 *è&(
ms
->
¤c
), 
num”ic_ho¡
));

82 
	`´štf
("%-20 ", 
­
->
	`¥ršt
((
sockaddr
 *è&(
ms
->
d¡
), 
num”ic_ho¡
));

84 
	`´štf
("% -> ", 
	`g‘_¢ame
(
ms
->
¥Üt
, ms->
´Ùo
, 
num”ic_pÜt
));

85 
	`´štf
("%s", 
	`g‘_¢ame
(
ms
->
dpÜt
, ms->
´Ùo
, 
num”ic_pÜt
));

86 
	`´štf
(" (%s)\n", 
	`g‘_¢ame
(
ms
->
mpÜt
, ms->
´Ùo
, 
num”ic_pÜt
));

87 
	}
}

90 
	$»ad_masqšfo
(
FILE
 * 
f
, 
masq
 *
m¦i¡
, 
nm¦i¡
)

92 
n
, 
Ä—d
 = 0;

93 
masq
 *
ms
;

94 
buf
[256];

96 
Ä—d
 = 0;‚»ad < 
nm¦i¡
;‚read++) {

97 
ms
 = &
m¦i¡
[
Ä—d
];

98 ià(
has_pd–
) {

99 ià((
n
 = 
	`fsÿnf
(
f
, " %s %lX:%hX %lX:%hX %hX %lX %hd %hd %lu",

100 
buf
,

101 (*è&
ms
->
¤c
.
sš_addr
.
s_addr
, &ms->
¥Üt
,

102 (*è&
ms
->
d¡
.
sš_addr
.
s_addr
, &ms->
dpÜt
,

103 &
ms
->
mpÜt
, &ms->
š™£q
, &ms->
d–
,

104 &
ms
->
pd–
, &ms->
expœes
)) == -1)

105  
Ä—d
;

107 ià((
n
 = 
	`fsÿnf
(
f
, " %s %lX:%hX %lX:%hX %hX %lX %hd %lu",

108 
buf
,

109 (*è&
ms
->
¤c
.
sš_addr
.
s_addr
, &ms->
¥Üt
,

110 (*è&
ms
->
d¡
.
sš_addr
.
s_addr
, &ms->
dpÜt
,

111 &
ms
->
mpÜt
, &ms->
š™£q
, &ms->
d–
,

112 &
ms
->
expœes
)) == -1)

113  
Ä—d
;

115 ià((
has_pd–
 && (
n
 != 10)) || (!has_pdelta && (n != 9))) {

116 
	`EINTERN
("masq_info.c", "ip_masquerade formatƒrror");

119 
ms
->
¤c
.
sš_çmy
 = 
AF_INET
;

120 
ms
->
d¡
.
sš_çmy
 = 
AF_INET
;

122 ià(
	`¡rcmp
("IP", 
buf
) == 0)

123 
ms
->
´Ùo
 = "ip";

124 ià(
	`¡rcmp
("TCP", 
buf
) == 0)

125 
ms
->
´Ùo
 = "tcp";

126 ià(
	`¡rcmp
("UDP", 
buf
) == 0)

127 
ms
->
´Ùo
 = "udp";

128 ià(
	`¡rcmp
("ICMP", 
buf
) == 0)

129 
ms
->
´Ùo
 = "icmp";

130 ià(
	`¡rcmp
("GRE", 
buf
) == 0)

131 
ms
->
´Ùo
 = "gre";

132 ià(
	`¡rcmp
("ESP", 
buf
) == 0)

133 
ms
->
´Ùo
 = "esp";

135 
	`EINTERN
("masq_info.c", "ip_masquerade unknownype");

140 
ms
->
¤c
.
sš_addr
.
s_addr
 = 
	`htÚl
(ms->src.sin_addr.s_addr);

141 
ms
->
d¡
.
sš_addr
.
s_addr
 = 
	`htÚl
(ms->dst.sin_addr.s_addr);

142 
ms
->
¥Üt
 = 
	`htÚs
(ms->sport);

143 
ms
->
dpÜt
 = 
	`htÚs
(ms->dport);

144 
ms
->
mpÜt
 = 
	`htÚs
(ms->mport);

146  
Ä—d
;

147 
	}
}

150 
	$_masq_šfo
(
num”ic_ho¡
, 
num”ic_pÜt
, 
ext
)

152 
FILE
 *
f
;

153 
i
;

154 
buf
[256];

155 
masq
 *
m¦i¡
;

156 
ÁÙ®
 = 0, 
Ä—d
;

158 ià(!(
f
 = 
	`fİ’
(
_PATH_PROCNET_IP_MASQ
, "r"))) {

159 ià(
”ºo
 !ğ
ENOENT
) {

160 
	`³¼Ü
(
_PATH_PROCNET_IP_MASQ
);

163 
	`ESYSNOT
("netstat", "ip_masquerade");

166 ià((
­
 = 
	`g‘_aáy³
("š‘")è=ğ
NULL
) {

167 
	`ENOSUPP
("masq_info", "AF INET");

168 
	`fşo£
(
f
);

171 
	`fg‘s
(
buf
, (buf), 
f
);

172 
has_pd–
 = 
	`¡r¡r
(
buf
, "PDelta") ? 1 : 0;

174 
m¦i¡
 = (
masq
 *è
	`m®loc
(16 * (masq));

175 ià(!
m¦i¡
) {

176 
	`EINTERN
("masq_info", "malloc() failed");

177 
	`fşo£
(
f
);

180 (
Ä—d
 = 
	`»ad_masqšfo
(
f
, &(
m¦i¡
[
ÁÙ®
]), 16)) == 16) {

181 
ÁÙ®
 +ğ
Ä—d
;

182 
m¦i¡
 = (
masq
 *è
	`»®loc
(mslist,

183 (
ÁÙ®
 + 16è* (
masq
));

184 ià(!
m¦i¡
) {

185 
	`EINTERN
("masq_info", "realloc() failed");

186 
	`fşo£
(
f
);

190 
	`fşo£
(
f
);

192 ià(
Ä—d
 < 0) {

193 ià(
m¦i¡
)

194 
	`ä“
(
m¦i¡
);

197 
ÁÙ®
 +ğ
Ä—d
;

199 ià(
ÁÙ®
 > 0) {

200 
	`´štf
(
	`_
("IP masqueradingƒntries\n"));

201 
ext
) {

203 
	`´štf
(
	`_
("protƒxpire source destination…orts\n"));

206 
	`´štf
(
	`_
("protƒxpire initseq delta…revd source destination…orts\n"));

209 
i
 = 0; i < 
ÁÙ®
; i++)

210 
	`´št_masq
(&(
m¦i¡
[
i
]), 
num”ic_ho¡
, 
num”ic_pÜt
, 
ext
);

211 ià(
m¦i¡
)

212 
	`ä“
(
m¦i¡
);

216 
	}
}

	@interface/net-tools/lib/net-features.h

29 #iâdeà
_NET_FEATURES_H


30 
	#_NET_FEATURES_H


	)

34 #ià
defšed
 (
SIOCADDRTOLD
è|| defšed (
RTF_IRTT
)

35 
	#HAVE_NEW_ADDRT
 1

	)

38 #ifdeà
RTF_IRTT


39 
	#HAVE_RTF_IRTT
 1

	)

42 #ifdeà
RTF_REJECT


43 
	#HAVE_RTF_REJECT
 1

	)

48 #ià
defšed
 (
FEATURE_ARP
è|| defšed (
FEATURE_ROUTE
è|| defšed (
FEATURE_NETSTAT
)

49 *
	gF—tu»s
 =

52 #ifdeà
FEATURE_ROUTE


54 #ià
HAVE_NEW_ADDRT


61 #ià
HAVE_RTF_IRTT


68 #ià
HAVE_RTF_REJECT


80 #ifdeà
FEATURE_NETSTAT


82 #ià
HAVE_NEW_ADDRT


89 #ià
HAVE_RTF_IRTT


96 #ià
HAVE_RTF_REJECT


103 #ià
HAVE_FW_MASQUERADE


114 #ià
I18N


122 #ifdeà
DFLT_AF


123 "(" 
DFLT_AF
 ")"

126 #ià
HAVE_AFUNIX


132 #ià
HAVE_AFINET


138 #ià
HAVE_AFINET6


144 #ià
HAVE_AFIPX


150 #ià
HAVE_AFAX25


156 #ià
HAVE_AFNETROM


162 #ià
HAVE_AFX25


168 #ià
HAVE_AFATALK


174 #ià
HAVE_AFECONET


180 #ià
HAVE_AFROSE


189 #ifdeà
DFLT_HW


190 "(" 
DFLT_HW
 ")"

193 #ià
HAVE_HWETHER


199 #ià
HAVE_HWARC


205 #ià
HAVE_HWSLIP


211 #ià
HAVE_HWPPP


217 #ià
HAVE_HWTUNNEL


223 #ià
HAVE_HWTR


229 #ià
HAVE_HWAX25


236 #ià
HAVE_HWNETROM


243 #ià
HAVE_HWX25


250 #ià
HAVE_HWFR


257 #ià
HAVE_HWROSE


264 #ià
HAVE_HWASH


271 #ià
HAVE_HWSIT


278 #ià
HAVE_HWFDDI


285 #ià
HAVE_HWHIPPI


292 #ià
HAVE_HWHDLCLAPB


299 #ià
HAVE_HWEUI64


	@interface/net-tools/lib/net-support.h

33 
	~<sys/sock‘.h
>

36 
	saáy³
 {

37 *
	mÇme
;

38 *
	mt™Ë
;

39 
	maf
;

40 
	m®’
;

41 *(*
	m´št
) (*);

42 *(*
	m¥ršt
è(
	msockaddr
 *, 
	mnum”ic
);

43 (*
	mšput
è(
	mty³
, *
	mbuå
, 
	msockaddr
 *);

44 (*
	mh”rÜ
è(*
	m‹xt
);

45 (*
	m½ršt
è(
	mİtiÚs
);

46 (*
	mršput
è(
	mtyp
, 
	mext
, **
	m¬gv
);

49 (*
	mg‘mask
è(*
	m¤c
, 
sockaddr
 * 
	mmask
, *
	mÇme
);

51 
	mfd
;

52 *
	mæag_fe
;

55 
aáy³
 *
aáy³s
[];

58 
	shwty³
 {

59 *
	mÇme
;

60 *
	mt™Ë
;

61 
	mty³
;

62 
	m®’
;

63 *(*
	m´št
) (*);

64 (*
	mšput
è(*, 
	msockaddr
 *);

65 (*
	maùiv©e
è(
	mfd
);

66 
	msuµ»ss_nuÎ_addr
;

70 
hwty³
 *
g‘_hwty³
(cÚ¡ *
Çme
);

71 
hwty³
 *
g‘_hwÁy³
(
ty³
);

72 
´št_hwli¡
(
ty³
);

73 
aáy³
 *
g‘_aáy³
(cÚ¡ *
Çme
);

74 
aáy³
 *
g‘_aâty³
(
ty³
);

75 
´št_aæi¡
(
ty³
);

76 
hw_nuÎ_add»ss
(
hwty³
 *
hw
, *
addr
);

78 
g‘¬gs
(*
¡ršg
, *
¬gum’ts
[]);

80 
g‘_sock‘_fÜ_af
(
af
);

82 
g‘rou‹_š™
();

83 
£Œou‹_š™
();

84 
aùiv©e_š™
();

85 
rou‹_šfo
(cÚ¡ *
aâame
, 
æags
);

86 
rou‹_ed™
(
aùiÚ
, cÚ¡ *
aâame
, 
æags
, **
¬gv
);

87 
aùiv©e_ld
(cÚ¡ *
hwÇme
, 
fd
);

89 
	#RTACTION_ADD
 1

	)

90 
	#RTACTION_DEL
 2

	)

91 
	#RTACTION_HELP
 3

	)

92 
	#RTACTION_FLUSH
 4

	)

93 
	#RTACTION_SHOW
 5

	)

95 
	#FLAG_EXT
 3

	)

96 
	#FLAG_NUM_HOST
 4

	)

97 
	#FLAG_NUM_PORT
 8

	)

98 
	#FLAG_NUM_USER
 16

	)

99 
	#FLAG_NUM
 (
FLAG_NUM_HOST
|
FLAG_NUM_PORT
|
FLAG_NUM_USER
)

	)

100 
	#FLAG_SYM
 32

	)

101 
	#FLAG_CACHE
 64

	)

102 
	#FLAG_FIB
 128

	)

103 
	#FLAG_VERBOSE
 256

	)

105 
_masq_šfo
(
num”ic_ho¡
, 
num”ic_pÜt
, 
ext
);

107 
INET_½ršt
(
İtiÚs
);

108 
INET6_½ršt
(
İtiÚs
);

109 
DDP_½ršt
(
İtiÚs
);

110 
IPX_½ršt
(
İtiÚs
);

111 
NETROM_½ršt
(
İtiÚs
);

112 
AX25_½ršt
(
İtiÚs
);

113 
X25_½ršt
(
İtiÚs
);

115 
INET_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

116 
INET6_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

117 
DDP_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

118 
IPX_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

119 
NETROM_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

120 
AX25_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

121 
X25_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

122 
ROSE_ršput
(
aùiÚ
, 
æags
, **
¬gv
);

124 
aá¿ns_İt
(cÚ¡ *
¬g
);

125 
aá¿ns_def
(*
toŞ
, *
¬gv0
, *
dæt
);

127 *
g‘_¢ame
(
socknumb”
, *
´Ùo
, 
num”ic
);

129 
æag_unx
;

130 
æag_x
;

131 
æag_ax25
;

132 
æag_ddp
;

133 
æag_ÃŒom
;

134 
æag_x25
;

135 
æag_ro£
;

136 
æag_š‘
;

137 
æag_š‘6
;

139 
aâame
[];

141 
	#AFTRANS_OPTS
 \

153 {"tı", 0, 0, 1}

	)

154 
	#AFTRANS_CNT
 12

	)

156 
	#EINTERN
(
fe
, 
‹xt
è
	`årštf
(
¡d”r
, \

157 
	`_
("%s: IÁ”ÇÈE¼Ü `%s'.\n"),
fe
,
‹xt
);

	)

159 
	#ENOSUPP
(
A
,
B
è
	`årštf
(
¡d”r
,\

160 
	`_
("%s: feature `%s'‚ot supported.\n" \

162 "Ãw” k”ÃÈsourû o¸fuÎ cÚfigu¿tiÚ.\n"),
A
,
B
)

	)

164 
	#ESYSNOT
(
A
,
B
è
	`årštf
(
¡d”r
, 
	`_
("%s:‚ØsuµÜˆfÜ `%s' oÀthi sy¡em.\n"),A,B)

	)

166 
	#E_NOTFOUND
 8

	)

167 
	#E_SOCK
 7

	)

168 
	#E_LOOKUP
 6

	)

169 
	#E_VERSION
 5

	)

170 
	#E_USAGE
 4

	)

171 
	#E_OPTERR
 3

	)

172 
	#E_INTERN
 2

	)

173 
	#E_NOSUPP
 1

	)

184 
	#RTNH_F_DEAD
 1

	)

185 
	#RTNH_F_PERVASIVE
 2

	)

186 
	#RTNH_F_ONLINK
 4

	)

189 
	#RTCF_DEAD
 
RTNH_F_DEAD


	)

190 
	#RTCF_ONLINK
 
RTNH_F_ONLINK


	)

192 
	#RTCF_NOTIFY
 0x00010000

	)

193 
	#RTCF_DIRECTDST
 0x00020000

	)

194 
	#RTCF_REDIRECTED
 0x00040000

	)

195 
	#RTCF_TPROXY
 0x00080000

	)

196 
	#RTCF_FAST
 0x00200000

	)

197 
	#RTCF_MASQ
 0x00400000

	)

198 
	#RTCF_SNAT
 0x00800000

	)

199 
	#RTCF_DOREDIRECT
 0x01000000

	)

200 
	#RTCF_DIRECTSRC
 0x04000000

	)

201 
	#RTCF_DNAT
 0x08000000

	)

202 
	#RTCF_BROADCAST
 0x10000000

	)

203 
	#RTCF_MULTICAST
 0x20000000

	)

204 
	#RTCF_REJECT
 0x40000000

	)

205 
	#RTCF_LOCAL
 0x80000000

	)

208 #iâdeà
RTF_DEFAULT


209 
	#RTF_DEFAULT
 0x00010000

	)

211 
	#RTF_ALLONLINK
 0x00020000

	)

212 #iâdeà
RTF_ADDRCONF


213 
	#RTF_ADDRCONF
 0x00040000

	)

215 
	#RTF_NONEXTHOP
 0x00200000

	)

216 
	#RTF_EXPIRES
 0x00400000

	)

217 
	#RTF_CACHE
 0x01000000

	)

218 
	#RTF_FLOW
 0x02000000

	)

219 
	#RTF_POLICY
 0x04000000

	)

220 
	#RTF_LOCAL
 0x80000000

	)

223 
	#RTF_UP
 0x0001

	)

224 
	#RTF_GATEWAY
 0x0002

	)

225 
	#RTF_HOST
 0x0004

	)

226 
	#RTF_REINSTATE
 0x0008

	)

227 
	#RTF_DYNAMIC
 0x0010

	)

228 
	#RTF_MODIFIED
 0x0020

	)

229 
	#RTF_MTU
 0x0040

	)

230 #iâdeà
RTF_MSS


231 
	#RTF_MSS
 
RTF_MTU


	)

233 
	#RTF_WINDOW
 0x0080

	)

234 
	#RTF_IRTT
 0x0100

	)

235 
	#RTF_REJECT
 0x0200

	)

238 
	#RTF_NOTCACHED
 0x0400

	)

240 #ifdeà
HAVE_AFECONET


241 #iâdeà
AF_ECONET


242 
	#AF_ECONET
 19

	)

	@interface/net-tools/lib/netrom.c

26 
	~"cÚfig.h
"

28 #ià
HAVE_AFNETROM
 || 
HAVE_HWNETROM


29 
	~<sys/ty³s.h
>

30 
	~<sys/ioùl.h
>

31 
	~<sys/sock‘.h
>

32 
	~<Ãt/if_¬p.h
>

33 #ià(
__GLIBC__
 > 2è|| (__GLIBC__ =ğ2 && 
__GLIBC_MINOR__
 >= 1)

34 
	~<Ãx25/ax25.h
>

36 
	~<lšux/ax25.h
>

38 
	~<¡dlib.h
>

39 
	~<¡dio.h
>

40 
	~<ùy³.h
>

41 
	~<”ºo.h
>

42 
	~<fú.h
>

43 
	~<¡ršg.h
>

44 
	~<‹rmios.h
>

45 
	~<uni¡d.h
>

46 
	~"Ãt-suµÜt.h
"

47 
	~"·thÇmes.h
"

48 
	~"š.h
"

49 
	~"ut.h
"

51 
	gÃŒom_”rmsg
[128];

53 
aáy³
 
ÃŒom_aáy³
;

55 *
	$NETROM_´št
(*
±r
)

57 
buff
[8];

58 
i
;

60 
i
 = 0; i < 6; i++) {

61 
buff
[
i
] = ((
±r
[i] & 0377) >> 1);

62 ià(
buff
[
i
] == ' ')

63 
buff
[
i
] = '\0';

65 
buff
[6] = '\0';

66 
i
 = ((
±r
[6] & 0x1E) >> 1);

67 ià(
i
 != 0)

68 
	`¥rštf
(&
buff
[
	`¡¾’
(buff)], "-%d", 
i
);

69  (
buff
);

70 
	}
}

74 *
	$NETROM_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

76 
buf
[64];

77 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

78  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

79  (
	`NETROM_´št
(((
sockaddr_ax25
 *è
§p
)->
§x25_ÿÎ
.
ax25_ÿÎ
));

80 
	}
}

83 
	$NETROM_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

85 *
±r
;

86 *
Üig
, 
c
;

87 
i
;

89 
§p
->
§_çmy
 = 
ÃŒom_aáy³
.
af
;

90 
±r
 = ((
sockaddr_ax25
 *è
§p
)->
§x25_ÿÎ
.
ax25_ÿÎ
;

93 
Üig
 = 
buå
;

94 
i
 = 0;

95 (*
buå
 !ğ'\0'è&& (*buå !ğ'-'è&& (
i
 < 6)) {

96 
c
 = *
buå
++;

97 ià(
	`i¦ow”
(
c
))

98 
c
 = 
	`touµ”
(c);

99 ià(!(
	`isuµ”
(
c
è|| 
	`isdig™
(c))) {

100 
	`§ã_¡ºıy
(
ÃŒom_”rmsg
, 
	`_
("Invalid callsign"), (netrom_errmsg));

101 #ifdeà
DEBUG


102 
	`årštf
(
¡d”r
, "ÃŒom_šput(%s): % !\n", 
ÃŒom_”rmsg
, 
Üig
);

104 
”ºo
 = 
EINVAL
;

107 *
±r
++ = (è((
c
 << 1) & 0xFE);

108 
i
++;

112 ià((
i
 =ğ6è&& (*
buå
 != '-') && (*bufp != '\0')) {

113 
	`§ã_¡ºıy
(
ÃŒom_”rmsg
, 
	`_
("Callsignoo†ong"), (netrom_errmsg));

114 #ifdeà
DEBUG


115 
	`årštf
(
¡d”r
, "ÃŒom_šput(%s): % !\n", 
ÃŒom_”rmsg
, 
Üig
);

117 
”ºo
 = 
E2BIG
;

121 
i
++ < (
ax25_add»ss
) - 1) {

122 *
±r
++ = () ((' ' << 1) & 0xFE);

126 ià(*
buå
 == '-') {

127 
i
 = 
	`©oi
(++
buå
);

128 *
±r
 = (è((
i
 << 1) & 0xFE);

130 *
±r
 = () '\0';

134 #ifdeà
DEBUG


135 
	`årštf
(
¡d”r
, "ÃŒom_šput(%s): ", 
Üig
);

136 
i
 = 0; i < (
ax25_add»ss
); i++)

137 
	`årštf
(
¡d”r
, "%02X ", 
§p
->
§_d©a
[
i
] & 0377);

138 
	`årštf
(
¡d”r
, "\n");

142 
	}
}

146 
	$NETROM_h”rÜ
(*
‹xt
)

148 ià(
‹xt
 =ğ
NULL
)

149 
	`årštf
(
¡d”r
, "%s\n", 
ÃŒom_”rmsg
);

151 
	`årštf
(
¡d”r
, "%s: %s\n", 
‹xt
, 
ÃŒom_”rmsg
);

152 
	}
}

155 
	$NETROM_hšput
(*
buå
, 
sockaddr
 *
§p
)

157 ià(
	`NETROM_šput
(0, 
buå
, 
§p
) < 0)

159 
§p
->
§_çmy
 = 
ARPHRD_NETROM
;

161 
	}
}

165 
	$KISS_£t_disc
(
fd
, 
disc
)

167 ià(
	`ioùl
(
fd
, 
TIOCSETD
, &
disc
) < 0) {

168 
	`årštf
(
¡d”r
, "KISS_£t_disc(%d): %s\n", 
disc
, 
	`¡»¼Ü
(
”ºo
));

169  (-
”ºo
);

172 
	}
}

176 
	$KISS_š™
(
fd
)

178 ià(
	`KISS_£t_disc
(
fd
, 
N_SLIP
) < 0)

180 ià(
	`ioùl
(
fd
, 
SIOCSIFENCAP
, 4) < 0)

183 
	}
}

186 
hwty³
 
	gÃŒom_hwty³
 =

188 "ÃŒom", 
NULL
, 
ARPHRD_NETROM
, 7,

189 
NETROM_´št
, 
NETROM_hšput
, 
NULL
, 0

192 
aáy³
 
	gÃŒom_aáy³
 =

194 "ÃŒom", 
NULL
, 
AF_NETROM
, 7,

195 
NETROM_´št
, 
NETROM_¥ršt
, 
NETROM_šput
, 
NETROM_h”rÜ
,

196 
NULL
, NULL, NULL,

	@interface/net-tools/lib/netrom_gr.c

21 
	~"cÚfig.h
"

23 #ià
HAVE_AFNETROM


24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<uni¡d.h
>

27 
	~"Ãt-suµÜt.h
"

28 
	~"·thÇmes.h
"

29 
	~"š.h
"

33 
	$NETROM_½ršt
(
İtiÚs
)

35 
FILE
 *
f1
 = 
	`fİ’
(
_PATH_PROCNET_NR_NODES
, "r");

36 
FILE
 *
f2
 = 
	`fİ’
(
_PATH_PROCNET_NR_NEIGH
, "r");

37 
bufãr
[256];

38 
qu®
, 
n
, 
w
;

42 
f1
 = 
	`fİ’
(
_PATH_PROCNET_NR_NODES
, "r");

43 ià(!
f1
è
	`³¼Ü
(
_PATH_PROCNET_NR_NODES
);

44 
f2
 = 
	`fİ’
(
_PATH_PROCNET_NR_NEIGH
, "r");

45 ià(!
f2
è
	`³¼Ü
(
_PATH_PROCNET_NR_NEIGH
);

47 ià(
f1
 =ğ
NULL
 || 
f2
 == NULL) {

48 
	`´štf
(
	`_
("NET/ROM‚ot configured inhis system.\n"));

51 
	`´štf
(
	`_
("Kernel NET/ROM„outingable\n"));

52 
	`´štf
(
	`_
("Destination Mnemonic Quality Neighbour Iface\n"));

53 
	`fg‘s
(
bufãr
, 256, 
f1
);

54 
	`fg‘s
(
bufãr
, 256, 
f1
)) {

55 
bufãr
[9] = 0;

56 
bufãr
[17] = 0;

57 
w
 = 
	`©oi
(
bufãr
 + 19) - 1;

58 
	`´štf
("%-9s %-7s ",

59 
bufãr
, buffer + 10);

60 
qu®
 = 
	`©oi
(
bufãr
 + 24 + 15 * 
w
);

61 
n
 = 
	`©oi
(
bufãr
 + 32 + 15 * 
w
);

62 
	`»wšd
(
f2
);

63 
	`fg‘s
(
bufãr
, 256, 
f2
);

64 
	`fg‘s
(
bufãr
, 256, 
f2
)) {

65 ià(
	`©oi
(
bufãr
è=ğ
n
) {

66 
bufãr
[15] = 0;

67 
bufãr
[20] = 0;

68 
	`´štf
("%3d %-9s %s\n",

69 
qu®
, 
bufãr
 + 6, buffer + 16);

74 
	`fşo£
(
f1
);

75 
	`fşo£
(
f2
);

77 
	}
}

	@interface/net-tools/lib/netrom_sr.c

1 
	~"cÚfig.h
"

3 #ià
HAVE_AFNETROM


4 
	~<sys/·¿m.h
>

5 
	~<sys/ty³s.h
>

6 
	~<sys/sock‘.h
>

7 
	~<Ãtš‘/š.h
>

8 
	~<¬·/š‘.h
>

9 
	~<¬·/Çme£r.h
>

11 
	~<sys/ioùl.h
>

12 
	~<ùy³.h
>

13 
	~<”ºo.h
>

14 
	~<Ãtdb.h
>

15 
	~<»sŞv.h
>

16 
	~<¡dlib.h
>

17 
	~<¡ršg.h
>

18 
	~<¡dio.h
>

19 
	~<uni¡d.h
>

20 
	~"v”siÚ.h
"

21 
	~"Ãt-suµÜt.h
"

22 
	~"·thÇmes.h
"

23 
	~"š.h
"

24 
	~"Ãt-ã©u»s.h
"

26 
aáy³
 
ÃŒom_aáy³
;

32 
	$u§ge
()

34 
	`årštf
(
¡d”r
, 
	`_
("netrom usage\n"));

36  (
E_USAGE
);

37 
	}
}

41 
	$NETROM_ršput
(
aùiÚ
, 
ext
, **
¬gs
)

44 
	`årštf
(
¡d”r
, 
	`_
("NET/ROM:his‚eedso be written\n"));

46 
	}
}

	@interface/net-tools/lib/nstrcmp.c

4 
	~<ùy³.h
>

5 
	~<¡dlib.h
>

6 
	~<¡ršg.h
>

7 
	~"ut.h
"

11 * 
	$culŸs
(* 
Çme
)

13 
dig™
 = 0;

14 
pos
;

16 
pos
=
	`¡¾’
(
Çme
);…os>0;…os--)

18 ià(
Çme
[
pos
-1]==':' && 
dig™
)

20 
Çme
[
pos
-1]='\0';

21  
Çme
+
pos
;

23 ià(!
	`isdig™
(
Çme
[
pos
-1]))

25 
dig™
 = 1;

27  
NULL
;

28 
	}
}

32 
	$ršdex_nÚdig™
(*
Çme
)

34 
pos
 = 
	`¡¾’
(
Çme
);

36 
pos
=
	`¡¾’
(
Çme
);…os>0;…os--)

38 ià(!
	`isdig™
(
Çme
[
pos
-1]))

39  
pos
;

42 
	}
}

46 
	$n¡rcmp
(cÚ¡ *
­
, cÚ¡ *
bp
)

48 *
a
 = (*)
	`¡rdup
(
­
);

49 *
b
 = (*)
	`¡rdup
(
bp
);

50 *
ª
, *
bn
;

51 
av
 = 0, 
bv
 = 0;

52 *
¯lŸs
=
	`culŸs
(
a
);

53 *
b®Ÿs
=
	`culŸs
(
b
);

54 
ašdex
=
	`ršdex_nÚdig™
(
a
);

55 
bšdex
=
	`ršdex_nÚdig™
(
b
);

56 
com¶’
=(
ašdex
<
bšdex
)?aindex:bindex;

57 
»s
 = 
	`¡ºcmp
(
a
, 
b
, 
com¶’
);

59 ià(
»s
 != 0)

60 { 
	`ä“
(
a
); f»e(
b
);  
»s
; }

62 ià(
ašdex
 > 
bšdex
)

63 { 
	`ä“
(
a
); f»e(
b
);  1; }

65 ià(
ašdex
 < 
bšdex
)

66 { 
	`ä“
(
a
); f»e(
b
);  -1; }

68 
ª
 = 
a
+
ašdex
;

69 
bn
 = 
b
+
bšdex
;

71 
av
 = 
	`©oi
(
ª
);

72 
bv
 = 
	`©oi
(
bn
);

74 ià(
av
 < 
bv
)

75 { 
	`ä“
(
a
); f»e(
b
);  -1; }

77 ià(
av
 > 
bv
)

78 { 
	`ä“
(
a
); f»e(
b
);  1; }

80 
av
 = -1;

81 ià(
¯lŸs
 !ğ
NULL
)

82 
av
 = 
	`©oi
(
¯lŸs
);

84 
bv
 = -1;

85 ià(
b®Ÿs
 !ğ
NULL
)

86 
bv
 = 
	`©oi
(
b®Ÿs
);

88 
	`ä“
(
a
); f»e(
b
);

90 ià(
av
 < 
bv
)

93 ià(
av
 > 
bv
)

97 
	}
}

100 #ifdeà
NSTRCMP_TEST


102 
	$cs
(
s
)

104 ià(
s
 < 0)  -1;

105 ià(
s
 > 0)  1;

107 
	}
}

110 
	$dÙe¡
(* 
a
, * 
b
, 
exp
)

112 
»s
 = 
	`n¡rcmp
(
a
, 
b
);

113 
”r
 = (
	`cs
(
»s
è!ğcs(
exp
));

114 
	`´štf
("n¡rcmp(\"%s\", \"%s\")=%d %d %s\n", 
a
, 
b
, 
»s
, 
exp
, 
”r
?"WRONG":"OK");

115  
”r
;

116 
	}
}

118 
	$maš
()

120 
”r
 = 0;

122 
”r
 |ğ
	`dÙe¡
("eth1", "eth1", 0);

123 
”r
 |ğ
	`dÙe¡
("eth0:1", "eth0:1", 0);

124 
”r
 |ğ
	`dÙe¡
("lan", "lan", 0);

125 
”r
 |ğ
	`dÙe¡
("100", "100", 0);

126 
”r
 |ğ
	`dÙe¡
("", "", 0);

127 
”r
 |ğ
	`dÙe¡
(":", ":", 0);

128 
”r
 |ğ
	`dÙe¡
("a:b:c", "a:b:c", 0);

129 
”r
 |ğ
	`dÙe¡
("a:", "a:", 0);

130 
”r
 |ğ
	`dÙe¡
(":a", ":a", 0);

132 
”r
 |ğ
	`dÙe¡
("a", "aa", -1);

133 
”r
 |ğ
	`dÙe¡
("eth0", "eth1", -1);

134 
”r
 |ğ
	`dÙe¡
("eth1", "eth20", -1);

135 
”r
 |ğ
	`dÙe¡
("eth20", "eth100", -1);

136 
”r
 |ğ
	`dÙe¡
("eth1", "eth13", -1);

137 
”r
 |ğ
	`dÙe¡
("eth", "eth2", -1);

138 
”r
 |ğ
	`dÙe¡
("eth0:1", "eth0:2", -1);

139 
”r
 |ğ
	`dÙe¡
("eth1:10", "eth13:10", -1);

140 
”r
 |ğ
	`dÙe¡
("eth1:1", "eth1:13", -1);

141 
”r
 |ğ
	`dÙe¡
("a", "a:", -1);

143 
”r
 |ğ
	`dÙe¡
("aa", "a", 1);

144 
”r
 |ğ
	`dÙe¡
("eth2", "eth1", 1);

145 
”r
 |ğ
	`dÙe¡
("eth13", "eth1", 1);

146 
”r
 |ğ
	`dÙe¡
("eth2", "eth", 1);

147 
”r
 |ğ
	`dÙe¡
("eth2:10", "eth2:1", 1);

148 
”r
 |ğ
	`dÙe¡
("eth2:5", "eth2:4", 1);

149 
”r
 |ğ
	`dÙe¡
("eth3:2", "eth2:3", 1);

150 
”r
 |ğ
	`dÙe¡
("eth13:1", "eth1:0", 1);

151 
”r
 |ğ
	`dÙe¡
("a:", "a", 1);

152 
”r
 |ğ
	`dÙe¡
("a1b12", "a1b2", 1);

154  
”r
;

155 
	}
}

	@interface/net-tools/lib/pathnames.h

13 
	#_PATH_PROCNET_IGMP
 "/´oc/Ãt/igmp"

	)

14 
	#_PATH_PROCNET_IGMP6
 "/´oc/Ãt/igmp6"

	)

15 
	#_PATH_PROCNET_TCP
 "/´oc/Ãt/tı"

	)

16 
	#_PATH_PROCNET_TCP6
 "/´oc/Ãt/tı6"

	)

17 
	#_PATH_PROCNET_UDP
 "/´oc/Ãt/udp"

	)

18 
	#_PATH_PROCNET_UDP6
 "/´oc/Ãt/udp6"

	)

19 
	#_PATH_PROCNET_UDPLITE
 "/´oc/Ãt/ud¶™e"

	)

20 
	#_PATH_PROCNET_UDPLITE6
 "/´oc/Ãt/ud¶™e6"

	)

21 
	#_PATH_PROCNET_SCTPEPTS
 "/´oc/Ãt/sùp/•s"

	)

22 
	#_PATH_PROCNET_SCTP6EPTS
 "/´oc/Ãt/sùp6/•s"

	)

23 
	#_PATH_PROCNET_SCTPASSOCS
 "/´oc/Ãt/sùp/assocs"

	)

24 
	#_PATH_PROCNET_SCTP6ASSOCS
 "/´oc/Ãt/sùp6/assocs"

	)

25 
	#_PATH_PROCNET_RAW
 "/´oc/Ãt/¿w"

	)

26 
	#_PATH_PROCNET_RAW6
 "/´oc/Ãt/¿w6"

	)

27 
	#_PATH_PROCNET_UNIX
 "/´oc/Ãt/unix"

	)

28 
	#_PATH_PROCNET_ROUTE
 "/´oc/Ãt/rou‹"

	)

29 
	#_PATH_PROCNET_ROUTE6
 "/´oc/Ãt/v6_rou‹"

	)

30 
	#_PATH_PROCNET_RTCACHE
 "/´oc/Ãt/¹_ÿche"

	)

31 
	#_PATH_PROCNET_AX25_ROUTE
 "/´oc/Ãt/ax25_rou‹"

	)

32 
	#_PATH_PROCNET_NR
 "/´oc/Ãt/Ä"

	)

33 
	#_PATH_PROCNET_NR_NEIGH
 "/´oc/Ãt/Ä_Ãigh"

	)

34 
	#_PATH_PROCNET_NR_NODES
 "/´oc/Ãt/Ä_nodes"

	)

35 
	#_PATH_PROCNET_ARP
 "/´oc/Ãt/¬p"

	)

36 
	#_PATH_PROCNET_AX25
 "/´oc/Ãt/ax25"

	)

37 
	#_PATH_PROCNET_IPX_SOCKET1
 "/´oc/Ãt/x/sock‘"

	)

38 
	#_PATH_PROCNET_IPX_SOCKET2
 "/´oc/Ãt/x"

	)

39 
	#_PATH_PROCNET_IPX_ROUTE1
 "/´oc/Ãt/x/rou‹"

	)

40 
	#_PATH_PROCNET_IPX_ROUTE2
 "/´oc/Ãt/x_rou‹"

	)

41 
	#_PATH_PROCNET_ATALK
 "/´oc/Ãt/­¶‘®k"

	)

42 
	#_PATH_PROCNET_IP_BLK
 "/´oc/Ãt/_block"

	)

43 
	#_PATH_PROCNET_IP_FWD
 "/´oc/Ãt/_fÜw¬d"

	)

44 
	#_PATH_PROCNET_IP_ACC
 "/´oc/Ãt/_acù"

	)

45 
	#_PATH_PROCNET_IP_MASQ
 "/´oc/Ãt/_masqu”ade"

	)

46 
	#_PATH_PROCNET_NDISC
 "/´oc/Ãt/ndisc"

	)

47 
	#_PATH_PROCNET_IFINET6
 "/´oc/Ãt/if_š‘6"

	)

48 
	#_PATH_PROCNET_DEV
 "/´oc/Ãt/dev"

	)

49 
	#_PATH_PROCNET_RARP
 "/´oc/Ãt/¿½"

	)

50 
	#_PATH_ETHERS
 "/‘c/‘h”s"

	)

51 
	#_PATH_PROCNET_ROSE_ROUTE
 "/´oc/Ãt/ro£_rou‹s"

	)

52 
	#_PATH_PROCNET_X25
 "/´oc/Ãt/x25"

	)

53 
	#_PATH_PROCNET_X25_ROUTE
 "/´oc/Ãt/x25_rou‹s"

	)

54 
	#_PATH_PROCNET_DEV_MCAST
 "/´oc/Ãt/dev_mÿ¡"

	)

55 
	#_PATH_PROCNET_ATALK_ROUTE
 "/´oc/Ãt/©®k_rou‹"

	)

58 
	#_PATH_DEV_ROUTE
 "/dev/rou‹"

	)

	@interface/net-tools/lib/ppp.c

21 
	~"cÚfig.h
"

23 #ià
HAVE_HWPPP


25 
	~<sys/ty³s.h
>

26 
	~<sys/ioùl.h
>

27 
	~<sys/sock‘.h
>

28 
	~<Ãt/if_¬p.h
>

29 
	~<¡dlib.h
>

30 
	~<¡dio.h
>

31 
	~<ùy³.h
>

32 
	~<”ºo.h
>

33 
	~<fú.h
>

34 
	~<¡ršg.h
>

35 
	~<‹rmios.h
>

36 
	~<uni¡d.h
>

37 
	~"Ãt-suµÜt.h
"

38 
	~"·thÇmes.h
"

39 
	~"š.h
"

42 
	$do_µp
(
fd
)

44 
	`årštf
(
¡d”r
, 
	`_
("You cannot start PPP withhis…rogram.\n"));

46 
	}
}

49 
hwty³
 
	gµp_hwty³
 =

51 "µp", 
NULL
, 
ARPHRD_PPP
, 0,

52 
NULL
, NULL, 
do_µp
, 0

	@interface/net-tools/lib/ppp_ac.c

15 
	~"cÚfig.h
"

17 #ià
HAVE_HWPPP


19 
	~<sys/ty³s.h
>

20 
	~<sys/ioùl.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<¡dlib.h
>

24 
	~<¡dio.h
>

25 
	~<ùy³.h
>

26 
	~<”ºo.h
>

27 
	~<fú.h
>

28 
	~<¡ršg.h
>

29 
	~<‹rmios.h
>

30 
	~<uni¡d.h
>

31 
	~"Ãt-suµÜt.h
"

32 
	~"·thÇmes.h
"

33 
	~"š.h
"

36 
	$PPP_aùiv©e
(
fd
)

38 
	`årštf
(
¡d”r
, 
	`_
("Sorry, use…ppd!\n"));

40 
	}
}

	@interface/net-tools/lib/proc.c

5 
	~<¡ršg.h
>

6 
	~<¡d¬g.h
>

7 
	~<¡dio.h
>

8 
	~<ùy³.h
>

9 
	~<uni¡d.h
>

13 *
	$´oc_g’_fmt
(*
Çme
, 
mÜe
, 
FILE
 * 
fh
,...)

15 
buf
[512], 
fÜm©
[512] = "";

16 *
t™Ë
, *
h—d
, *
hdr
;

17 
va_li¡
 
­
;

19 ià(!
	`fg‘s
(
buf
, ( bufè- 1, 
fh
))

20  
NULL
;

21 
	`¡rÿt
(
buf
, " ");

23 
	`va_¡¬t
(
­
, 
fh
);

24 
t™Ë
 = 
	`va_¬g
(
­
, *);

25 
hdr
 = 
buf
; hdr;) {

26 
	`is¥aû
(*
hdr
) || *hdr == '|')

27 
hdr
++;

28 
h—d
 = 
hdr
;

29 
hdr
 = 
	`¡½brk
(hdr, "| \t\n");

30 ià(
hdr
)

31 *
hdr
++ = 0;

33 ià(!
	`¡rcmp
(
t™Ë
, 
h—d
)) {

34 
	`¡rÿt
(
fÜm©
, 
	`va_¬g
(
­
, *));

35 
t™Ë
 = 
	`va_¬g
(
­
, *);

36 ià(!
t™Ë
 || !
h—d
)

39 
	`¡rÿt
(
fÜm©
, "%*s");

41 
	`¡rÿt
(
fÜm©
, " ");

43 
	`va_’d
(
­
);

45 ià(!
mÜe
 && 
t™Ë
) {

46 
	`årštf
(
¡d”r
, "warning: %s does‚ot contain„equired field %s\n",

47 
Çme
, 
t™Ë
);

48  
NULL
;

50  
	`¡rdup
(
fÜm©
);

51 
	}
}

57 
	$´oc_guess_fmt
(*
Çme
, 
FILE
 *
fh
, ...)

59 
buf
[512];

60 *
tmp
;

61 
æag
 = 0;

62 
va_li¡
 
­
;

64 ià(!
	`fg‘s
(
buf
, ( bufè- 1, 
fh
))

66 
	`¡rÿt
(
buf
, "\0");

67 
	`va_¡¬t
(
­
, 
fh
);

68 (
tmp
 = 
	`va_¬g
(
­
, *))) {

69 
f
 = 
	`va_¬g
(
­
, );

70 ià(
	`¡r¡r
(
buf
,
tmp
) != 0)

71 
æag
 |ğ
f
;

73 
	`va_’d
(
­
);

74  
æag
;

75 
	}
}

78 
FILE
 *
	$´oc_fİ’
(cÚ¡ *
Çme
)

80 *
bufãr
;

81 
size_t
 
·gesz
;

82 
FILE
 *
fd
 = 
	`fİ’
(
Çme
, "r");

84 ià(
fd
 =ğ
NULL
)

85  
NULL
;

87 ià(!
bufãr
) {

88 
·gesz
 = 
	`g‘·gesize
();

89 
bufãr
 = 
	`m®loc
(
·gesz
);

92 
	`£tvbuf
(
fd
, 
bufãr
, 
_IOFBF
, 
·gesz
);

93  
fd
;

94 
	}
}

	@interface/net-tools/lib/proc.h

4 *
´oc_g’_fmt
(*
Çme
, 
mÜe
, 
FILE
 * 
fh
,...);

5 
´oc_guess_fmt
(*
Çme
, 
FILE
* 
fh
,...);

6 
FILE
 *
´oc_fİ’
(cÚ¡ *
Çme
);

	@interface/net-tools/lib/rose.c

18 
	~"cÚfig.h
"

20 #ià
HAVE_AFROSE
 || 
HAVE_HWROSE


21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

23 
	~<sys/ioùl.h
>

24 
	~<sys/sock‘.h
>

25 
	~<Ãt/if_¬p.h
>

26 
	~<¡dlib.h
>

27 
	~<¡dio.h
>

28 
	~<ùy³.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡ršg.h
>

32 
	~<‹rmios.h
>

33 
	~<uni¡d.h
>

34 
	~"Ãt-suµÜt.h
"

35 
	~"·thÇmes.h
"

36 
	~"š.h
"

38 #iâdeà
_NETROSE_ROSE_H


39 
	~<lšux/ax25.h
>

40 
	~<lšux/ro£.h
>

42 #undeà
AF_ROSE


43 #ià
PF_ROSE
 =ğ
AF_ROSE


45 #undeà
PF_ROSE


46 
	#PF_ROSE
 11

	)

49 
	#AF_ROSE
 
PF_ROSE


	)

52 
	gROSE_”rmsg
[128];

54 
aáy³
 
ro£_aáy³
;

57 
	$ROSE_´št
(*
±r
)

59 
buff
[12];

61 
	`¢´štf
(
buff
, (buff), "%02x%02x%02x%02x%02x", 
±r
[0],…tr[1],…tr[2],…tr[3],…tr[4]);

62 
buff
[10] = '\0';

63  (
buff
);

64 
	}
}

68 
	$ROSE_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

70 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

71  
	`_
("[NONE SET]");

73  (
	`ROSE_´št
(((
sockaddr_ro£
 *è
§p
)->
¤o£_addr
.
ro£_addr
));

74 
	}
}

77 
	$ROSE_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

79 *
±r
;

80 
i
, 
o
;

82 
§p
->
§_çmy
 = 
ro£_aáy³
.
af
;

83 
±r
 = ((
sockaddr_ro£
 *è
§p
)->
¤o£_addr
.
ro£_addr
;

86 ià(
	`¡¾’
(
buå
) != 10) {

87 
	`¡rıy
(
ROSE_”rmsg
, 
	`_
("Node‡ddress must been digits"));

88 #ifdeà
DEBUG


89 
	`årštf
(
¡d”r
, "ro£_šput(%s): % !\n", 
ROSE_”rmsg
, 
Üig
);

91 
”ºo
 = 
EINVAL
;

95 
i
 = 0, 
o
 = 0; i < 5; i++) {

96 
o
 = 
i
 * 2;

97 
±r
[
i
] = (((
buå
[
o
] - '0') << 4) | (bufp[o + 1] - '0'));

101 #ifdeà
DEBUG


102 
	`årštf
(
¡d”r
, "ro£_šput(%s): ", 
Üig
);

103 
i
 = 0; i < (
ro£_add»ss
); i++)

104 
	`årštf
(
¡d”r
, "%02X ", 
§p
->
§_d©a
[
i
] & 0377);

105 
	`årštf
(
¡d”r
, "\n");

109 
	}
}

113 
	$ROSE_h”rÜ
(*
‹xt
)

115 ià(
‹xt
 =ğ
NULL
)

116 
	`årštf
(
¡d”r
, "%s\n", 
ROSE_”rmsg
);

118 
	`årštf
(
¡d”r
, "%s: %s\n", 
‹xt
, 
ROSE_”rmsg
);

119 
	}
}

122 
	$ROSE_hšput
(*
buå
, 
sockaddr
 *
§p
)

124 ià(
	`ROSE_šput
(0, 
buå
, 
§p
) < 0)

126 
§p
->
§_çmy
 = 
ARPHRD_ROSE
;

128 
	}
}

130 
hwty³
 
	gro£_hwty³
 =

132 "ro£", 
NULL
, 
ARPHRD_ROSE
, 10,

133 
ROSE_´št
, 
ROSE_hšput
, 
NULL


136 
aáy³
 
	gro£_aáy³
 =

138 "ro£", 
NULL
, 
AF_ROSE
, 10,

139 
ROSE_´št
, 
ROSE_¥ršt
, 
ROSE_šput
, 
ROSE_h”rÜ
,

140 
NULL
, NULL, NULL,

	@interface/net-tools/lib/rose_gr.c

20 
	~"cÚfig.h
"

22 #ià
HAVE_AFROSE


24 
	~<sys/ty³s.h
>

25 
	~<sys/ioùl.h
>

26 
	~<lšux/ro£.h
>

27 
	~<sys/sock‘.h
>

28 
	~<Ãt/if_¬p.h
>

29 
	~<ùy³.h
>

30 
	~<”ºo.h
>

31 
	~<fú.h
>

32 
	~<¡ršg.h
>

33 
	~<‹rmios.h
>

35 
	~<¡dlib.h
>

36 
	~<¡dio.h
>

37 
	~<uni¡d.h
>

38 
	~"Ãt-suµÜt.h
"

39 
	~"·thÇmes.h
"

40 
	~"š.h
"

42 
	$ROSE_½ršt
(
İtiÚs
)

44 
FILE
 *
f
 = 
NULL
;

45 
bufãr
[256];

46 
u£
;

48 
f
=
	`fİ’
(
_PATH_PROCNET_ROSE_ROUTE
, "r");

49 ià(
f
 =ğ
NULL
) {

50 
	`³¼Ü
(
_PATH_PROCNET_ROSE_ROUTE
);

51 
	`´štf
(
	`_
("ROSE‚ot configured inhis system.\n"));

54 
	`´štf
(
	`_
("Kernel ROSE„outingable\n"));

55 
	`´štf
(
	`_
("Destination Iface Use\n"));

56 
	`fg‘s
(
bufãr
, 256, 
f
);

57 
	`fg‘s
(
bufãr
, 256, 
f
)) {

58 
bufãr
[9] = 0;

59 
bufãr
[14] = 0;

60 
u£
 = 
	`©oi
(
bufãr
 + 15);

61 
	`´štf
("%-9s %-5s %5d\n",

62 
bufãr
, bufã¸+ 10, 
u£
);

64 
	`fşo£
(
f
);

66 
	}
}

	@interface/net-tools/lib/setroute.c

27 
	~<¡dio.h
>

28 
	~<¡ršg.h
>

29 
	~"Ãt-suµÜt.h
"

30 
	~"·thÇmes.h
"

31 
	~"v”siÚ.h
"

32 
	~"cÚfig.h
"

33 
	~"š.h
"

35 
aáy³
 
un¥ec_aáy³
;

36 
aáy³
 
unix_aáy³
;

37 
aáy³
 
š‘_aáy³
;

38 
aáy³
 
š‘6_aáy³
;

39 
aáy³
 
ax25_aáy³
;

40 
aáy³
 
ÃŒom_aáy³
;

41 
aáy³
 
x_aáy³
;

42 
aáy³
 
ddp_aáy³
;

43 
aáy³
 
x25_aáy³
;

45 
	$£Œou‹_š™
()

47 #ià
HAVE_AFINET


48 
š‘_aáy³
.
ršput
 = 
INET_ršput
;

50 #ià
HAVE_AFINET6


51 
š‘6_aáy³
.
ršput
 = 
INET6_ršput
;

53 #ià
HAVE_AFNETROM


54 
ÃŒom_aáy³
.
ršput
 = 
NETROM_ršput
;

56 #ià
HAVE_AFIPX


57 
x_aáy³
.
ršput
 = 
IPX_ršput
;

59 #ià
HAVE_AFX25


60 
x25_aáy³
.
ršput
 = 
X25_ršput
;

63 #ià
HAVE_AFAX25


64 
ax25_aáy³
.
ršput
 = 
AX25_ršput
;

66 #ià
HAVE_AFATALK


67 
ddp_aáy³
.
ršput
 = 
DDP_ršput
;

70 
	}
}

73 
	$rou‹_ed™
(
aùiÚ
, cÚ¡ *
aâame
, 
İtiÚs
, **
¬gv
)

75 
aáy³
 *
­
;

77 
­
 = 
	`g‘_aáy³
(
aâame
);

79 ià(!
­
) {

80 
	`årštf
(
¡d”r
, 
	`_
("Add»s çmy `%s'‚Ù suµÜ‹d.\n"), 
aâame
);

81  (
E_OPTERR
);

83 ià(!
­
->
ršput
) {

84 
	`årštf
(
¡d”r
, 
	`_
("NØroutšg fÜ‡dd»s çmy `%s'.\n"), 
­
->
Çme
);

85  (
E_OPTERR
);

87  (
­
->
	`ršput
(
aùiÚ
, 
İtiÚs
, 
¬gv
));

88 
	}
}

	@interface/net-tools/lib/sit.c

17 
	~"cÚfig.h
"

19 #ià
HAVE_HWSIT


21 
	~<sys/ty³s.h
>

22 
	~<sys/ioùl.h
>

23 
	~<sys/sock‘.h
>

24 
	~<Ãt/if_¬p.h
>

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<ùy³.h
>

28 
	~<”ºo.h
>

29 
	~<fú.h
>

30 
	~<¡ršg.h
>

31 
	~<‹rmios.h
>

32 
	~<uni¡d.h
>

33 
	~"Ãt-suµÜt.h
"

34 
	~"·thÇmes.h
"

36 #iâdeà
ARPHRD_SIT


38 
	#ARPHRD_SIT
 776

	)

41 
hwty³
 
	gs™_hwty³
 =

43 "s™", 
NULL
, 
ARPHRD_SIT
, 0,

44 
NULL
, NULL, NULL, 0

	@interface/net-tools/lib/slip.c

17 
	~"cÚfig.h
"

19 #ià
HAVE_HWSLIP


21 
	~<sys/ty³s.h
>

22 
	~<sys/ioùl.h
>

23 
	~<sys/sock‘.h
>

24 
	~<Ãt/if_¬p.h
>

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<ùy³.h
>

28 
	~<”ºo.h
>

29 
	~<fú.h
>

30 
	~<¡ršg.h
>

31 
	~<‹rmios.h
>

32 
	~<uni¡d.h
>

33 
	~"Ãt-suµÜt.h
"

34 
	~"·thÇmes.h
"

37 
hwty³
 
	g¦_hwty³
 =

39 "¦", 
NULL
, 
ARPHRD_SLIP
, 0,

40 
NULL
, NULL, NULL

42 
hwty³
 
	gc¦_hwty³
 =

44 "c¦", 
NULL
, 
ARPHRD_CSLIP
, 0,

45 
NULL
, NULL, NULL

47 
hwty³
 
	g¦6_hwty³
 =

49 "¦6", 
NULL
, 
ARPHRD_SLIP6
, 0,

50 
NULL
, NULL, NULL

52 
hwty³
 
	gc¦6_hwty³
 =

54 "c¦6", 
NULL
, 
ARPHRD_CSLIP6
, 0,

55 
NULL
, NULL, NULL

57 
hwty³
 
	gad­tive_hwty³
 =

59 "ad­tive", 
NULL
, 
ARPHRD_ADAPT
, 0,

60 
NULL
, NULL, NULL

	@interface/net-tools/lib/slip_ac.c

19 
	~"cÚfig.h
"

21 #ià
HAVE_HWSLIP


23 
	~<sys/ty³s.h
>

24 
	~<sys/ioùl.h
>

25 
	~<sys/sock‘.h
>

26 
	~<Ãt/if_¬p.h
>

27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<ùy³.h
>

30 
	~<”ºo.h
>

31 
	~<fú.h
>

32 
	~<¡ršg.h
>

33 
	~<‹rmios.h
>

34 
	~<uni¡d.h
>

35 
	~"Ãt-suµÜt.h
"

36 
	~"·thÇmes.h
"

40 
	$SLIP_£t_disc
(
fd
, 
disc
)

42 ià(
	`ioùl
(
fd
, 
TIOCSETD
, &
disc
) < 0) {

43 
	`årštf
(
¡d”r
, "SLIP_£t_disc(%d): %s\n", 
disc
, 
	`¡»¼Ü
(
”ºo
));

44  (-
”ºo
);

47 
	}
}

51 
	$SLIP_£t_’ÿp
(
fd
, 
’ÿp
)

53 ià(
	`ioùl
(
fd
, 
SIOCSIFENCAP
, &
’ÿp
) < 0) {

54 
	`årštf
(
¡d”r
, "SLIP_£t_’ÿp(%d): %s\n", 
’ÿp
, 
	`¡»¼Ü
(
”ºo
));

55  (-
”ºo
);

58 
	}
}

62 
	$SLIP_aùiv©e
(
fd
)

64 ià(
	`SLIP_£t_disc
(
fd
, 
N_SLIP
) < 0)

66 ià(
	`SLIP_£t_’ÿp
(
fd
, 0) < 0)

69 
	}
}

73 
	$CSLIP_aùiv©e
(
fd
)

75 ià(
	`SLIP_£t_disc
(
fd
, 
N_SLIP
) < 0)

77 ià(
	`SLIP_£t_’ÿp
(
fd
, 1) < 0)

80 
	}
}

84 
	$SLIP6_aùiv©e
(
fd
)

86 ià(
	`SLIP_£t_disc
(
fd
, 
N_SLIP
) < 0)

88 ià(
	`SLIP_£t_’ÿp
(
fd
, 2) < 0)

91 
	}
}

95 
	$CSLIP6_aùiv©e
(
fd
)

97 ià(
	`SLIP_£t_disc
(
fd
, 
N_SLIP
) < 0)

99 ià(
	`SLIP_£t_’ÿp
(
fd
, 3) < 0)

102 
	}
}

106 
	$ADAPTIVE_aùiv©e
(
fd
)

108 ià(
	`SLIP_£t_disc
(
fd
, 
N_SLIP
) < 0)

110 ià(
	`SLIP_£t_’ÿp
(
fd
, 8) < 0)

113 
	}
}

	@interface/net-tools/lib/sockets.c

9 
	~<sys/sock‘.h
>

10 
	~<¡dio.h
>

11 
	~<uni¡d.h
>

13 
	~"cÚfig.h
"

14 
	~"sock‘s.h
"

15 
	~"š.h
"

16 
	~"ut.h
"

17 
	~"Ãt-suµÜt.h
"

19 
	gskfd
 = -1;

21 
	$sock‘s_İ’
(
çmy
)

23 
aáy³
 **
aá
;

24 
sfd
 = -1;

25 
fÜû
 = -1;

27 ià(
fÜû
 < 0) {

28 
fÜû
 = 0;

29 ià(
	`k”Ãl_v”siÚ
(è< 
	`KRELEASE
(2, 1, 0))

30 
fÜû
 = 1;

31 ià(
	`acûss
("/´oc/Ãt", 
R_OK
))

32 
fÜû
 = 1;

34 
aá
 = 
aáy³s
; *aft;‡ft++) {

35 
aáy³
 *
af
 = *
aá
;

36 
ty³
 = 
SOCK_DGRAM
;

37 ià(
af
->aà=ğ
AF_UNSPEC
)

39 ià(
çmy
 && famy !ğ
af
->af)

41 ià(
af
->
fd
 != -1) {

42 
sfd
 = 
af
->
fd
;

46 ià(!
çmy
 && !
fÜû
 && 
af
->
æag_fe
) {

47 ià(
	`acûss
(
af
->
æag_fe
, 
R_OK
))

50 #ià
HAVE_AFNETROM


51 ià(
af
->aà=ğ
AF_NETROM
)

52 
ty³
 = 
SOCK_SEQPACKET
;

54 #ià
HAVE_AFX25


55 ià(
af
->aà=ğ
AF_X25
)

56 
ty³
 = 
SOCK_SEQPACKET
;

58 
af
->
fd
 = 
	`sock‘
×f->af, 
ty³
, 0);

59 ià(
af
->
fd
 >= 0)

60 
sfd
 = 
af
->
fd
;

62 ià(
sfd
 < 0)

63 
	`årštf
(
¡d”r
, 
	`_
("No usable‡ddress families found.\n"));

64  
sfd
;

65 
	}
}

	@interface/net-tools/lib/strip.c

15 
	~"cÚfig.h
"

17 #ià
HAVE_HWSTRIP


19 
	~<sys/ty³s.h
>

20 
	~<sys/ioùl.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<lšux/ty³s.h
>

24 
	~<lšux/if_¡r.h
>

25 
	~<¡dlib.h
>

26 
	~<¡dio.h
>

27 
	~<ùy³.h
>

28 
	~<”ºo.h
>

29 
	~<fú.h
>

30 
	~<¡ršg.h
>

31 
	~<‹rmios.h
>

32 
	~<uni¡d.h
>

33 
	~"Ãt-suµÜt.h
"

34 
	~"·thÇmes.h
"

35 
	~"ut.h
"

36 
	~"š.h
"

39 
hwty³
 
¡r_hwty³
;

42 
	$´_¡r
(*
±r
)

44 
buff
[64];

45 if(
±r
[1])

46 
	`¥rštf
(
buff
, "%02x-%02x%02x-%02x%02x", *(
±r
+1), *(ptr+2), *(ptr+3),

47 *(
±r
+4), *(ptr+5));

49 
	`¥rštf
(
buff
, "%02x%02x-%02x%02x", *(
±r
+2), *(ptr+3), *(ptr+4),

50 *(
±r
+5));

51  
buff
;

52 
	}
}

55 
	$š_¡r
(*
buå
, 
sockaddr
 *
§p
)

57 
i
,
i0
;

58 
M‘ricomAdd»ss
 *
haddr
 = (M‘ricomAdd»s *è(
§p
->
§_d©a
);

61 
§p
->
§_çmy
 = 
¡r_hwty³
.
ty³
;

64 
i0
 = 
i
 = (
buå
[0] == '*') ? 1 : 0;

66 
buå
[
i
] && (bufp[i] != '-'))

67 
i
++;

69 ià(
buå
[
i
] != '-')

72 if(
i
-
i0
 == 2)

74 
haddr
->
c
[1] = 
	`¡¹Ş
(&
buå
[
i0
], 0, 16);

75 
i
++;

76 if(
buå
[
i
] == 0)  -1;

78 
haddr
->
c
[1] = 0;

79 
i
=
i0
;

81 
haddr
->
c
[2] = 
	`¡¹Ş
(&
buå
[
i
], 0, 16) >> 8;

82 
haddr
->
c
[3] = 
	`¡¹Ş
(&
buå
[
i
], 0, 16) & 0xFF;

84 
buå
[
i
] && (bufp[i] != '-'))

85 
i
++;

87 ià(
buå
[
i
] != '-')

90 
haddr
->
c
[4] = 
	`¡¹Ş
(&
buå
[
i
+1], 0, 16) >> 8;

91 
haddr
->
c
[5] = 
	`¡¹Ş
(&
buå
[
i
+1], 0, 16) & 0xFF;

92 
haddr
->
c
[0] = 0;

95 
	}
}

100 
	$do_¡r
(
fd
)

102 
disc
 = 
N_STRIP
;

103 ià(
	`ioùl
(
fd
, 
TIOCSETD
, &
disc
) < 0)

105 
	`årštf
(
¡d”r
, "STRIP_£t_disc(%d): %s\n", 
disc
, 
	`¡»¼Ü
(
”ºo
));

106 (-
”ºo
);

109 
	}
}

111 
hwty³
 
	g¡r_hwty³
 = {

112 "¡r", "M‘ricom SrmodIP", 
ARPHRD_METRICOM
, (
M‘ricomAdd»ss
),

113 
´_¡r
, 
š_¡r
, 
do_¡r
, 0

	@interface/net-tools/lib/tr.c

16 
	~"cÚfig.h
"

18 #ià
HAVE_HWTR


19 
	~<asm/ty³s.h
>

20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 
	~<Ãt/if_¬p.h
>

23 
	~<lšux/if_Œ.h
>

24 
	~<¡dlib.h
>

25 
	~<¡dio.h
>

26 
	~<”ºo.h
>

27 
	~<ùy³.h
>

28 
	~<¡ršg.h
>

29 
	~<uni¡d.h
>

30 
	~"Ãt-suµÜt.h
"

31 
	~"·thÇmes.h
"

32 
	~"š.h
"

33 
	~"ut.h
"

37 
hwty³
 
Œ_hwty³
;

38 #ifdeà
ARPHRD_IEEE802_TR


39 
hwty³
 
Œ_hwty³1
;

42 *
	$´_Œ
(*
±r
)

44 
buff
[64];

46 
	`¢´štf
(
buff
, (buff), "%02X:%02X:%02X:%02X:%02X:%02X",

47 (
±r
[0] & 0377), (ptr[1] & 0377), (ptr[2] & 0377),

48 (
±r
[3] & 0377), (ptr[4] & 0377), (ptr[5] & 0377)

50  (
buff
);

51 
	}
}

54 
	$š_Œ
(*
buå
, 
sockaddr
 *
§p
)

56 *
±r
;

57 
c
, *
Üig
;

58 
i
, 
v®
;

60 #ifdeà
ARPHRD_IEEE802_TR


61 ià(
	`k”Ãl_v”siÚ
(è< 
	`KRELEASE
(2,3,30)) {

62 
§p
->
§_çmy
 = 
Œ_hwty³
.
ty³
;

64 
§p
->
§_çmy
 = 
Œ_hwty³1
.
ty³
;

67 
§p
->
§_çmy
 = 
Œ_hwty³
.
ty³
;

71 
±r
 = 
§p
->
§_d©a
;

73 
i
 = 0;

74 
Üig
 = 
buå
;

75 (*
buå
 !ğ'\0'è&& (
i
 < 
TR_ALEN
)) {

76 
v®
 = 0;

77 
c
 = *
buå
++;

78 ià(
	`isdig™
(
c
))

79 
v®
 = 
c
 - '0';

80 ià(
c
 >= 'a' && c <= 'f')

81 
v®
 = 
c
 - 'a' + 10;

82 ià(
c
 >= 'A' && c <= 'F')

83 
v®
 = 
c
 - 'A' + 10;

85 #ifdeà
DEBUG


86 
	`årštf
(
¡d”r
, 
	`_
("š_Œ(%s): inv®idok’„šg‡dd»ss!\n"), 
Üig
);

88 
”ºo
 = 
EINVAL
;

91 
v®
 <<= 4;

92 
c
 = *
buå
++;

93 ià(
	`isdig™
(
c
))

94 
v®
 |ğ
c
 - '0';

95 ià(
c
 >= 'a' && c <= 'f')

96 
v®
 |ğ
c
 - 'a' + 10;

97 ià(
c
 >= 'A' && c <= 'F')

98 
v®
 |ğ
c
 - 'A' + 10;

100 #ifdeà
DEBUG


101 
	`årštf
(
¡d”r
, 
	`_
("š_Œ(%s): inv®idok’„šg‡dd»ss!\n"), 
Üig
);

103 
”ºo
 = 
EINVAL
;

106 *
±r
++ = (è(
v®
 & 0377);

107 
i
++;

110 ià(*
buå
 == ':') {

111 ià(
i
 =ğ
TR_ALEN
) {

112 #ifdeà
DEBUG


113 
	`årštf
(
¡d”r
, 
	`_
("in_tr(%s):railing : ignored!\n"),

114 
Üig
)

118 
buå
++;

123 ià((
i
 =ğ
TR_ALEN
è&& (*
buå
 != '\0')) {

124 #ifdeà
DEBUG


125 
	`årštf
(
¡d”r
, 
	`_
("š_Œ(%s):¿šg junk!\n"), 
Üig
);

126 
”ºo
 = 
EINVAL
;

130 #ifdeà
DEBUG


131 
	`årštf
(
¡d”r
, "š_Œ(%s): %s\n", 
Üig
, 
	`´_Œ
(
§p
->
§_d©a
));

135 
	}
}

138 
hwty³
 
	gŒ_hwty³
 =

140 "Œ", 
NULL
 , 
ARPHRD_IEEE802
, 
TR_ALEN
,

141 
´_Œ
, 
š_Œ
, 
NULL


143 #ifdeà
ARPHRD_IEEE802_TR


144 
hwty³
 
	gŒ_hwty³1
 =

146 "Œ", 
NULL
 , 
ARPHRD_IEEE802_TR
, 
TR_ALEN
,

147 
´_Œ
, 
š_Œ
, 
NULL


	@interface/net-tools/lib/tunnel.c

6 
	~"cÚfig.h
"

8 #ià
HAVE_HWTUNNEL


9 
	~<sys/ty³s.h
>

10 
	~<sys/sock‘.h
>

11 
	~<Ãt/if_¬p.h
>

12 
	~<lšux/if_‘h”.h
>

13 
	~<¡dlib.h
>

14 
	~<¡dio.h
>

15 
	~<”ºo.h
>

16 
	~<ùy³.h
>

17 
	~<¡ršg.h
>

18 
	~<uni¡d.h
>

19 
	~"Ãt-suµÜt.h
"

20 
	~"·thÇmes.h
"

22 
hwty³
 
‘h”_hwty³
;

24 *
	$´_tuÂ–
(*
±r
)

27 
	}
}

30 
	$š_tuÂ–
(*
buå
, 
sockaddr
 *
§p
)

33 
	}
}

36 
hwty³
 
	gtuÂ–_hwty³
 =

38 "tuÂ–", 
NULL
, 
ARPHRD_TUNNEL
, 0,

39 
´_tuÂ–
, 
š_tuÂ–
, 
NULL
, 0

	@interface/net-tools/lib/unix.c

15 
	~"cÚfig.h
"

17 
	~<sys/ty³s.h
>

18 
	~<sys/sock‘.h
>

19 #ià
HAVE_AFUNIX


20 
	~<sys/un.h
>

22 
	~<¡dlib.h
>

23 
	~<¡dio.h
>

24 
	~<”ºo.h
>

25 
	~<ùy³.h
>

26 
	~<¡ršg.h
>

27 
	~<uni¡d.h
>

28 
	~"Ãt-suµÜt.h
"

29 
	~"·thÇmes.h
"

30 
	~"š.h
"

31 
	~"ut.h
"

35 *
	$UNSPEC_´št
(*
±r
)

37 
buff
[64];

38 *
pos
;

39 
i
;

41 
pos
 = 
buff
;

42 
i
 = 0; i < (
sockaddr
); i++) {

43 
pos
 +ğ
	`¥rštf
Õos, "%02X-", (*
±r
++ & 0377));

45 
buff
[
	`¡¾’
(buff) - 1] = '\0';

46  (
buff
);

47 
	}
}

51 *
	$UNSPEC_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

53 
buf
[64];

55 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

56  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

57  (
	`UNSPEC_´št
(
§p
->
§_d©a
));

58 
	}
}

61 #ià
HAVE_AFUNIX


64 *
	$UNIX_´št
(*
±r
)

66  (
±r
);

67 
	}
}

71 *
	$UNIX_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

73 
buf
[64];

75 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

76  
	`§ã_¡ºıy
(
buf
, 
	`_
("[NONE SET]"), (buf));

77  (
	`UNIX_´št
(
§p
->
§_d©a
));

78 
	}
}

81 
aáy³
 
	gunix_aáy³
 =

83 "unix", 
NULL
, 
AF_UNIX
, 0,

84 
UNIX_´št
, 
UNIX_¥ršt
, 
NULL
, NULL,

85 
NULL
, NULL, NULL,

92 
aáy³
 
	gun¥ec_aáy³
 =

94 "un¥ec", 
NULL
, 
AF_UNSPEC
, 0,

95 
UNSPEC_´št
, 
UNSPEC_¥ršt
, 
NULL
, NULL,

96 
NULL
,

	@interface/net-tools/lib/util-ank.c

17 
	~<¡dio.h
>

18 
	~<¡dlib.h
>

19 
	~<uni¡d.h
>

20 
	~<sy¦og.h
>

21 
	~<fú.h
>

22 
	~<sys/sock‘.h
>

23 
	~<Ãtš‘/š.h
>

24 
	~<¡ršg.h
>

25 
	~<Ãtdb.h
>

26 
	~<¬·/š‘.h
>

27 
	~<»sŞv.h
>

29 
	~"š.h
"

30 
	~"ut-ªk.h
"

32 #iâdeà
AF_INET6


33 
	#AF_INET6
 10

	)

36 
	$sÿn_numb”
(*
¬g
, *
v®
)

38 
»s
;

39 *
±r
;

41 ià(!
¬g
 || !*arg)

43 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 0);

44 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 
UINT_MAX
)

46 *
v®
 = 
»s
;

48 
	}
}

50 
	$g‘_š‹g”
(*
v®
, *
¬g
, 
ba£
)

52 
»s
;

53 *
±r
;

55 ià(!
¬g
 || !*arg)

57 
»s
 = 
	`¡¹Ş
(
¬g
, &
±r
, 
ba£
);

58 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 
INT_MAX
 ||„e < 
INT_MIN
)

60 *
v®
 = 
»s
;

62 
	}
}

64 
	$g‘_unsigÃd
(*
v®
, *
¬g
, 
ba£
)

66 
»s
;

67 *
±r
;

69 ià(!
¬g
 || !*arg)

71 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

72 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 
UINT_MAX
)

74 *
v®
 = 
»s
;

76 
	}
}

78 
	$g‘_u32
(
__u32
 *
v®
, *
¬g
, 
ba£
)

80 
»s
;

81 *
±r
;

83 ià(!
¬g
 || !*arg)

85 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

86 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0xFFFFFFFFUL)

88 *
v®
 = 
»s
;

90 
	}
}

92 
	$g‘_u16
(
__u16
 *
v®
, *
¬g
, 
ba£
)

94 
»s
;

95 *
±r
;

97 ià(!
¬g
 || !*arg)

99 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

100 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0xFFFF)

102 *
v®
 = 
»s
;

104 
	}
}

106 
	$g‘_u8
(
__u8
 *
v®
, *
¬g
, 
ba£
)

108 
»s
;

109 *
±r
;

111 ià(!
¬g
 || !*arg)

113 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

114 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0xFF)

116 *
v®
 = 
»s
;

118 
	}
}

120 
	$g‘_s16
(
__s16
 *
v®
, *
¬g
, 
ba£
)

122 
»s
;

123 *
±r
;

125 ià(!
¬g
 || !*arg)

127 
»s
 = 
	`¡¹Ş
(
¬g
, &
±r
, 
ba£
);

128 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0x7FFF ||„es < -0x8000)

130 *
v®
 = 
»s
;

132 
	}
}

134 
	$g‘_s8
(
__s8
 *
v®
, *
¬g
, 
ba£
)

136 
»s
;

137 *
±r
;

139 ià(!
¬g
 || !*arg)

141 
»s
 = 
	`¡¹Ş
(
¬g
, &
±r
, 
ba£
);

142 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0x7F ||„es < -0x80)

144 *
v®
 = 
»s
;

146 
	}
}

148 
	$g‘_addr_1
(
š‘_´efix
 *
addr
, *
Çme
, 
çmy
)

150 *
ı
;

151 *
­
 = (*)
addr
->
d©a
;

152 
i
;

154 
	`mem£t
(
addr
, 0, (*addr));

156 ià(
	`¡rcmp
(
Çme
, "default") == 0 || strcmp(name, "any") == 0) {

157 
addr
->
çmy
 = family;

158 
addr
->
by‹Ën
 = (
çmy
 =ğ
AF_INET6
 ? 16 : 4);

159 
addr
->
b™Ën
 = -1;

163 ià(
	`¡rchr
(
Çme
, ':')) {

164 
addr
->
çmy
 = 
AF_INET6
;

165 ià(
çmy
 !ğ
AF_UNSPEC
 && famy !ğ
AF_INET6
)

167 ià(
	`š‘_±Ú
(
AF_INET6
, 
Çme
, 
addr
->
d©a
) <= 0)

169 
addr
->
by‹Ën
 = 16;

170 
addr
->
b™Ën
 = -1;

174 
addr
->
çmy
 = 
AF_INET
;

175 ià(
çmy
 !ğ
AF_UNSPEC
 && famy !ğ
AF_INET
)

177 
addr
->
by‹Ën
 = 4;

178 
addr
->
b™Ën
 = -1;

179 
ı
=
Çme
, 
i
=0; *cp; cp++) {

180 ià(*
ı
 <= '9' && *cp >= '0') {

181 
­
[
i
] = 10*­[i] + (*
ı
-'0');

184 ià(*
ı
 =ğ'.' && ++
i
 <= 3)

189 
	}
}

191 
	$g‘_´efix_1
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
)

193 
”r
;

194 
¶’
;

195 *
¦ash
;

197 
	`mem£t
(
d¡
, 0, (*dst));

199 ià(
	`¡rcmp
(
¬g
, "default") == 0 || strcmp(arg, "any") == 0) {

200 
d¡
->
çmy
 = family;

201 
d¡
->
by‹Ën
 = 0;

202 
d¡
->
b™Ën
 = 0;

206 
¦ash
 = 
	`¡rchr
(
¬g
, '/');

207 ià(
¦ash
)

208 *
¦ash
 = 0;

209 
”r
 = 
	`g‘_addr_1
(
d¡
, 
¬g
, 
çmy
);

210 ià(
”r
 == 0) {

211 
d¡
->
b™Ën
 = (d¡->
çmy
 =ğ
AF_INET6
 ? 128 : 32);

212 ià(
¦ash
) {

213 ià(
	`sÿn_numb”
(
¦ash
+1, &
¶’
è||…ËÀ> 
d¡
->
b™Ën
) {

214 
”r
 = -1;

215 
dÚe
;

217 
d¡
->
b™Ën
 = 
¶’
;

220 
dÚe
:

221 ià(
¦ash
)

222 *
¦ash
 = '/';

223  
”r
;

224 
	}
}

226 
	$g‘_addr
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
)

228 ià(
	`g‘_addr_1
(
d¡
, 
¬g
, 
çmy
)) {

229 
	`årštf
(
¡d”r
, 
	`_
(": % i šv®id iÃˆadd»ss\n"), 
¬g
);

230 
	`ex™
(1);

233 
	}
}

235 
	$g‘_´efix
(
š‘_´efix
 *
d¡
, *
¬g
, 
çmy
)

237 ià(
	`g‘_´efix_1
(
d¡
, 
¬g
, 
çmy
)) {

238 
	`årštf
(
¡d”r
, 
	`_
(": % i šv®id iÃˆ´efix\n"), 
¬g
);

239 
	`ex™
(1);

242 
	}
}

244 
__u32
 
	$g‘_addr32
(*
Çme
)

246 
š‘_´efix
 
addr
;

247 ià(
	`g‘_addr_1
(&
addr
, 
Çme
, 
AF_INET
)) {

248 
	`årštf
(
¡d”r
, 
	`_
(": % i šv®id IPv4‡dd»ss\n"), 
Çme
);

249 
	`ex™
(1);

251  
addr
.
d©a
[0];

252 
	}
}

254 
	$šv¬g
(*
msg
)

256 
	`årštf
(
¡d”r
, 
	`_
(":‡rgum’ˆi wrÚg: %s\n"), 
msg
);

257 
	`ex™
(1);

258 
	}
}

260 
	$m©ches
(*
cmd
, *
·‰”n
)

262 
Ën
 = 
	`¡¾’
(
cmd
);

263 ià(
Ën
 > 
	`¡¾’
(
·‰”n
))

265  
	`memcmp
(
·‰”n
, 
cmd
, 
Ën
);

266 
	}
}

268 
	$š‘_addr_m©ch
(
š‘_´efix
 *
a
, iÃt_´efix *
b
, 
b™s
)

270 
__u32
 *
a1
 = 
a
->
d©a
;

271 
__u32
 *
a2
 = 
b
->
d©a
;

272 
wÜds
 = 
b™s
 >> 0x05;

274 
b™s
 &= 0x1f;

276 ià(
wÜds
)

277 ià(
	`memcmp
(
a1
, 
a2
, 
wÜds
 << 2))

280 ià(
b™s
) {

281 
__u32
 
w1
, 
w2
;

282 
__u32
 
mask
;

284 
w1
 = 
a1
[
wÜds
];

285 
w2
 = 
a2
[
wÜds
];

287 
mask
 = 
	`htÚl
((0xffffffffè<< (0x20 - 
b™s
));

289 ià((
w1
 ^ 
w2
è& 
mask
)

294 
	}
}

296 cÚ¡ *
	$fÜm©_ho¡
(
af
, *
addr
, *
abuf
, 
®’
)

298 #ifdeà
RESOLVE_HOSTNAMES


299 ià(
»sŞve_ho¡s
) {

300 
add¾’
 = 0;

301 
ho¡’t
 *
h_’t
;

302 
af
) {

303 
AF_INET
:

304 
add¾’
 = 4;

306 
AF_INET6
:

307 
add¾’
 = 16;

310 ià(
add¾’
 &&

311 (
h_’t
 = 
	`g‘ho¡byaddr
(
addr
, 
add¾’
, 
af
)è!ğ
NULL
) {

312 
	`¢´štf
(
abuf
, 
®’
-1, "%s", 
h_’t
->
h_Çme
);

313  
abuf
;

317  
	`š‘_Áİ
(
af
, 
addr
, 
abuf
, 
®’
);

318 
	}
}

	@interface/net-tools/lib/util.c

3 
	~<¡dio.h
>

4 
	~<¡dlib.h
>

5 
	~<¡ršg.h
>

6 
	~<sys/ut¢ame.h
>

8 
	~"ut.h
"

11 
	$oom
()

13 
	`årštf
(
¡d”r
, "out of virtual memory\n");

14 
	`ex™
(2);

15 
	}
}

17 *
	$xm®loc
(
size_t
 
sz
)

19 *
p
 = 
	`ÿÎoc
(
sz
, 1);

20 ià(!
p
)

21 
	`oom
();

22  
p
;

23 
	}
}

25 *
	$x»®loc
(*
Şdp
, 
size_t
 
sz
)

27 *
p
 = 
	`»®loc
(
Şdp
, 
sz
);

28 ià(!
p
)

29 
	`oom
();

30  
p
;

31 
	}
}

33 
	$k”Ãl_v”siÚ
()

35 
ut¢ame
 
uts
;

36 
majÜ
, 
mšÜ
, 
·tch
;

38 ià(
	`uÇme
(&
uts
) < 0)

40 ià(
	`ssÿnf
(
uts
.
»Ëa£
, "%d.%d.%d", &
majÜ
, &
mšÜ
, &
·tch
) != 3)

42  
	`KRELEASE
(
majÜ
, 
mšÜ
, 
·tch
);

43 
	}
}

47 *
	$§ã_¡ºıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
size
)

49 
d¡
[
size
-1] = '\0';

50  
	`¡ºıy
(
d¡
,
¤c
,
size
-1);

51 
	}
}

	@interface/net-tools/lib/util.h

1 
	~<¡ddef.h
>

3 *
xm®loc
(
size_t
 
sz
);

4 *
x»®loc
(*
p
, 
size_t
 
sz
);

6 
	#Ãw
(
p
è(Õèğ
	`xm®loc
((*Õ))))

	)

9 
k”Ãl_v”siÚ
();

10 
	#KRELEASE
(
maj
,
mš
,
·tch
è((majè* 10000 + (mš)*1000 + (·tch))

	)

13 
n¡rcmp
(const *, const *);

15 *
§ã_¡ºıy
(*
d¡
, cÚ¡ *
¤c
, 
size_t
 
size
);

18 
	#Ãtmš
(
a
,
b
è(×)<(bè? (aè: (b))

	)

19 
	#Ãtmax
(
a
,
b
è(×)>(bè? (aè: (b))

	)

	@interface/net-tools/lib/x25.c

18 
	~"cÚfig.h
"

20 #ià
HAVE_AFX25
 || 
HAVE_HWX25


21 
	~<sys/ty³s.h
>

22 
	~<sys/ioùl.h
>

23 
	~<sys/sock‘.h
>

24 
	~<lšux/x25.h
>

25 
	~<Ãt/if_¬p.h
>

26 
	~<¡dlib.h
>

27 
	~<¡dio.h
>

28 
	~<ùy³.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡ršg.h
>

32 
	~<‹rmios.h
>

33 
	~<uni¡d.h
>

34 
	~"Ãt-suµÜt.h
"

35 
	~"·thÇmes.h
"

36 
	#EXTERN


	)

38 
	~"Ãt-loÿË.h
"

40 
	~"š.h
"

42 
	gX25_”rmsg
[128];

45 
aáy³
 
x25_aáy³
;

48 #iâdeà
X25_ADDR_LEN


49 
	#X25_ADDR_LEN
 16

	)

54 
	$X25_´št
(*
±r
)

56 
buff
[
X25_ADDR_LEN
+1];

58 
	`¡ºıy
(
buff
, 
±r
, 
X25_ADDR_LEN
);

59 
buff
[
X25_ADDR_LEN
] = '\0';

60 (
buff
);

62 
	}
}

67 
	$X25_¥ršt
(
sockaddr
 *
§p
, 
num”ic
)

69 ià(
§p
->
§_çmy
 == 0xFFFF || sap->sa_family == 0)

70 Ğ
	`_
("[NONE SET]"));

71 (
	`X25_´št
(((
sockaddr_x25
 *)
§p
)->
sx25_addr
.
x25_addr
));

72 
	}
}

79 
	$X25_šput
(
ty³
, *
buå
, 
sockaddr
 *
§p
)

81 *
±r
;

82 *
p
;

83 
sigdig™s
;

85 
§p
->
§_çmy
 = 
x25_aáy³
.
af
;

86 
±r
 = ((
sockaddr_x25
 *)
§p
)->
sx25_addr
.
x25_addr
;

90 ià(
	`¡¾’
(
buå
)>18) {

91 
	`¡rıy
(
X25_”rmsg
, 
	`_
("Address can'tƒxceedƒighteen digits with sigdigits"));

92 #ifdeà
DEBUG


93 
	`årštf
(
¡d”r
, "x25_šput(%s): % !\n", 
X25_”rmsg
, 
Üig
);

95 
”ºo
 = 
EINVAL
;

100 ià((
p
 = 
	`¡rchr
(
buå
, '/')è!ğ
NULL
) {

101 *
p
 = '\0';

102 
sigdig™s
 = 
	`©oi
(
p
 + 1);

104 
sigdig™s
 = 
	`¡¾’
(
buå
);

107 ià(
	`¡¾’
(
buå
è< 1 || sŒËn(buåè> 15 || 
sigdig™s
 > strlen(bufp)) {

108 *
p
 = '/';

109 
	`¡rıy
(
X25_”rmsg
, 
	`_
("Invalid‡ddress"));

110 #ifdeà
DEBUG


111 
	`årštf
(
¡d”r
, "x25_šput(%s): % !\n", 
X25_”rmsg
, 
Üig
);

113 
”ºo
 = 
EINVAL
;

117 
	`¡ºıy
(
±r
, 
buå
, 
sigdig™s
+1);

120 #ifdeà
DEBUG


121 
	`årštf
(
¡d”r
, "x25_šput(%s): ", 
Üig
);

122 
i
 = 0; i < (
x25_add»ss
); i++)

123 
	`årštf
(
¡d”r
, "%02X ", 
§p
->
§_d©a
[
i
] & 0377);

124 
	`årštf
(
¡d”r
, "\n");

127  
sigdig™s
;

128 
	}
}

133 
	$X25_h”rÜ
(*
‹xt
)

135 ià(
‹xt
 =ğ
NULL
è
	`årštf
(
¡d”r
, "%s\n", 
X25_”rmsg
);

136 
	`årštf
(
¡d”r
, "%s: %s\n", 
‹xt
, 
X25_”rmsg
);

137 
	}
}

141 
	$X25_hšput
(*
buå
, 
sockaddr
 *
§p
)

143 ià(
	`X25_šput
(0, 
buå
, 
§p
) < 0) (-1);

144 
§p
->
§_çmy
 = 
ARPHRD_X25
;

146 
	}
}

149 
hwty³
 
	gx25_hwty³
 = {

150 "x25", 
NULL
, 
ARPHRD_X25
, 
X25_ADDR_LEN
,

151 
X25_´št
, 
X25_hšput
, 
NULL


154 
aáy³
 
	gx25_aáy³
 =

156 "x25", 
NULL
, 
AF_X25
, 
X25_ADDR_LEN
,

157 
X25_´št
, 
X25_¥ršt
, 
X25_šput
, 
X25_h”rÜ
,

158 
X25_½ršt
, 
X25_ršput
, 
NULL
 ,

	@interface/net-tools/lib/x25_gr.c

19 
	~"cÚfig.h
"

21 #ià
HAVE_AFX25


23 
	~<sys/ty³s.h
>

24 
	~<sys/ioùl.h
>

25 
	~<sys/sock‘.h
>

26 
	~<lšux/x25.h
>

27 
	~<lšux/if_¬p.h
>

28 
	~<ùy³.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<¡ršg.h
>

32 
	~<‹rmios.h
>

34 
	~<¡dlib.h
>

35 
	~<¡dio.h
>

36 
	~<uni¡d.h
>

37 
	~<¡ršg.h
>

38 
	~"Ãt-suµÜt.h
"

39 
	~"·thÇmes.h
"

40 
	#EXTERN


	)

42 
	~"Ãt-loÿË.h
"

44 
	~"š.h
"

47 #iâdeà
X25_ADDR_LEN


48 
	#X25_ADDR_LEN
 16

	)

51 
	$X25_½ršt
(
İtiÚs
)

53 
FILE
 *
f
=
	`fİ’
(
_PATH_PROCNET_X25_ROUTE
, "r");

54 
bufãr
[256];

55 *
p
;

56 
dig™s
;

58 if(
f
==
NULL
)

60 
	`´štf
Ğ
	`_
("X.25‚ot configured inhis system.\n"));

63 
	`´štf
Ğ
	`_
("Kernel X.25„outingable\n"));

64 
	`´štf
Ğ
	`_
("Destination Iface\n"));

65 
	`fg‘s
(
bufãr
,256,
f
);

66 
	`fg‘s
(
bufãr
,256,
f
))

68 
p
 = 
	`¡rchr
(
bufãr
,'\n');

69 ià(
p
)

70 *
p
=0;

72 
bufãr
[24]=0;

73 
bufãr
[35]=0;

74 
dig™s
=
	`©oi
(
bufãr
+17);

75 ià(
dig™s
 < 0 || digits > 15)

76 
dig™s
=15;

77 
bufãr
[
dig™s
]=0;

78 ià(
dig™s
 == 0)

79 
	`´štf
("* %-5s\n", 
bufãr
+25);

81 
	`´štf
("%s/%*d %-5s\n",

82 
bufãr
,
dig™s
-17,digits,buffer+25);

84 
	`fşo£
(
f
);

86 
	}
}

	@interface/net-tools/lib/x25_sr.c

16 
	~"cÚfig.h
"

18 #ià
HAVE_AFX25


19 
	~<asm/ty³s.h
>

20 
	~<sys/·¿m.h
>

21 
	~<sys/ty³s.h
>

22 
	~<sys/sock‘.h
>

23 
	~<sys/ioùl.h
>

24 
	~<lšux/x25.h
>

25 
	~<ùy³.h
>

26 
	~<”ºo.h
>

27 
	~<Ãtdb.h
>

28 
	~<»sŞv.h
>

29 
	~<¡dlib.h
>

30 
	~<¡ršg.h
>

31 
	~<¡dio.h
>

32 
	~<uni¡d.h
>

33 
	~"v”siÚ.h
"

34 
	~"Ãt-suµÜt.h
"

35 
	~"·thÇmes.h
"

36 
	#EXTERN


	)

38 
	~"Ãt-loÿË.h
"

40 
	~"š.h
"

42 
	~"Ãt-ã©u»s.h
"

44 
aáy³
 
x25_aáy³
;

46 
	gskfd
 = -1;

49 
	$u§ge
()

51 
	`årštf
(
¡d”r
,"Usage: x25_route [-v] del Target[/mask] [dev] If\n");

52 
	`årštf
(
¡d”r
," x25_route [-v]‡dd Target[/mask] [dev] If\n");

53 (
E_USAGE
);

54 
	}
}

57 
	$X25_£Œou‹
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

59 
x25_rou‹_¡ruù
 
¹
;

60 
sockaddr_x25
 
sx25
;

61 
rg‘
[128];

62 sigÃd 
sigdig™s
;

64 ià(*
¬gs
 =ğ
NULL
)

65 (
	`u§ge
());

67 
	`¡rıy
(
rg‘
, *
¬gs
++);

70 
	`mem£t
((*è&
¹
, 0, (rt));

73 ià((
sigdig™s
 = 
x25_aáy³
.
	`šput
(0, 
rg‘
, (
sockaddr
 *)&
sx25
)) < 0) {

74 
x25_aáy³
.
	`h”rÜ
(
rg‘
);

77 
¹
.
sigdig™s
=sigdigits;

80 
	`memıy
(&
¹
.
add»ss
, &
sx25
.
sx25_addr
, (sx25.sx25_addr));

82 *
¬gs
) {

83 ià(!
	`¡rcmp
(*
¬gs
,"device") || !strcmp(*args,"dev")) {

84 
¬gs
++;

85 ià(!*
¬gs
)

86 (
	`u§ge
());

88 ià(
¬gs
[1])

89 (
	`u§ge
());

90 ià(
¹
.
deviû
[0])

91 (
	`u§ge
());

92 
	`¡rıy
(
¹
.
deviû
, *
¬gs
);

93 
¬gs
++;

95 ià(
¹
.
deviû
[0]=='\0')

96 (
	`u§ge
());

99 ià(
¹
.
sigdig™s
 > 15) {

100 
	`årštf
(
¡d”r
, 
	`_
("rou‹: bogu Ãtmask %d\n"), 
¹
.
sigdig™s
);

101 (
E_OPTERR
);

104 ià(
¹
.
sigdig™s
 > 
	`¡¾’
Ôt.
add»ss
.
x25_addr
)) {

105 
	`årštf
(
¡d”r
, 
	`_
("route:‚etmask doesn't match„oute‡ddress\n"));

106 (
E_OPTERR
);

110 ià((
skfd
 = 
	`sock‘
(
AF_X25
, 
SOCK_SEQPACKET
, 0)) < 0) {

111 
	`³¼Ü
("socket");

112 (
E_SOCK
);

116 ià(
aùiÚ
==
RTACTION_DEL
) {

117 ià(
	`ioùl
(
skfd
, 
SIOCDELRT
, &
¹
) < 0) {

118 
	`³¼Ü
("SIOCDELRT");

119 
	`şo£
(
skfd
);

120 (
E_SOCK
);

123 ià(
	`ioùl
(
skfd
, 
SIOCADDRT
, &
¹
) < 0) {

124 
	`³¼Ü
("SIOCADDRT");

125 
	`şo£
(
skfd
);

126 (
E_SOCK
);

131 (è
	`şo£
(
skfd
);

133 
	}
}

135 
	$X25_ršput
(
aùiÚ
, 
İtiÚs
, **
¬gs
)

137 ià(
aùiÚ
 =ğ
RTACTION_FLUSH
) {

138 
	`årštf
(
¡d”r
,"Flushing `x25'„outingable‚ot supported\n");

139 (
	`u§ge
());

141 ià(
İtiÚs
 & 
FLAG_CACHE
) {

142 
	`årštf
(
¡d”r
,"Modifying `x25'„outing cache‚ot supported\n");

143 (
	`u§ge
());

145 ià((*
¬gs
 =ğ
NULL
è|| (
aùiÚ
 =ğ
RTACTION_HELP
))

146 (
	`u§ge
());

148 (
	`X25_£Œou‹
(
aùiÚ
, 
İtiÚs
, 
¬gs
));

149 
	}
}

	@interface/net-tools/mii-tool.c

32 
	gV”siÚ
[] = "$Id: mii-tool.c,v 1.9 2006-09-27 20:59:18ƒcki Exp $\n(Author: David Hinds based on Donald Becker's mii-diag)";

34 
	~<uni¡d.h
>

35 
	~<¡dlib.h
>

36 
	~<¡dio.h
>

37 
	~<ùy³.h
>

38 
	~<¡ršg.h
>

39 
	~<”ºo.h
>

40 
	~<fú.h
>

41 
	~<g‘İt.h
>

42 
	~<time.h
>

43 
	~<sy¦og.h
>

44 
	~<sys/ty³s.h
>

45 
	~<sys/sock‘.h
>

46 
	~<sys/ioùl.h
>

47 
	~<Ãt/if.h
>

48 
	~<lšux/sockios.h
>

50 #iâdeà
__GLIBC__


51 
	~<lšux/if_¬p.h
>

52 
	~<lšux/if_‘h”.h
>

54 
	~"mii.h
"

55 
	~"v”siÚ.h
"

57 
	#MAX_ETH
 8

	)

61 
u_shÜt
 
	mid1
, 
	mid2
;

62 *
	mÇme
;

63 } 
	gmii_id
[] = {

83 
	#NMII
 ((
mii_id
)/(mii_id[0]))

	)

87 
İtiÚ
 
	glÚgİts
[] = {

103 
	gv”bo£
 = 0,

104 
	gİt_v”siÚ
 = 0,

105 
	gİt_»¡¬t
 = 0,

106 
	gİt_»£t
 = 0,

107 
	gİt_log
 = 0,

108 
	gİt_w©ch
 = 0;

109 
	gnway_adv”ti£
 = 0;

110 
	gfixed_¥“d
 = 0;

111 
	gov”ride_phy
 = -1;

113 
	gskfd
 = -1;

114 
iäeq
 
	giä
;

118 
	$mdio_»ad
(
skfd
, 
loÿtiÚ
)

120 
mii_d©a
 *
mii
 = (mii_d©¨*)&
iä
.
iä_d©a
;

121 
mii
->
»g_num
 = 
loÿtiÚ
;

122 ià(
	`ioùl
(
skfd
, 
SIOCGMIIREG
, &
iä
) < 0) {

123 
	`årštf
(
¡d”r
, "SIOCGMIIREG oÀ% çed: %s\n", 
iä
.
iä_Çme
,

124 
	`¡»¼Ü
(
”ºo
));

127  
mii
->
v®_out
;

128 
	}
}

130 
	$mdio_wr™e
(
skfd
, 
loÿtiÚ
, 
v®ue
)

132 
mii_d©a
 *
mii
 = (mii_d©¨*)&
iä
.
iä_d©a
;

133 
mii
->
»g_num
 = 
loÿtiÚ
;

134 
mii
->
v®_š
 = 
v®ue
;

135 ià(
	`ioùl
(
skfd
, 
SIOCSMIIREG
, &
iä
) < 0) {

136 
	`årštf
(
¡d”r
, "SIOCSMIIREG oÀ% çed: %s\n", 
iä
.
iä_Çme
,

137 
	`¡»¼Ü
(
”ºo
));

139 
	}
}

144 *
	mÇme
;

145 
u_shÜt
 
	mv®ue
[2];

146 } 
	gmedŸ
[] = {

148 { "10ba£T-HD", {
MII_AN_10BASET_HD
} },

149 { "10ba£T-FD", {
MII_AN_10BASET_FD
} },

150 { "100ba£Tx-HD", {
MII_AN_100BASETX_HD
} },

151 { "100ba£Tx-FD", {
MII_AN_100BASETX_FD
} },

152 { "100ba£T4", {
MII_AN_100BASET4
} },

153 { "100ba£Tx", {
MII_AN_100BASETX_FD
 | 
MII_AN_100BASETX_HD
} },

154 { "10ba£T", {
MII_AN_10BASET_FD
 | 
MII_AN_10BASET_HD
} },

156 { "1000ba£T-HD", {0, 
MII_BMCR2_1000HALF
} },

157 { "1000ba£T-FD", {0, 
MII_BMCR2_1000FULL
} },

158 { "1000ba£T", {0, 
MII_BMCR2_1000HALF
|
MII_BMCR2_1000FULL
} },

160 
	#NMEDIA
 ((
medŸ
)/(medŸ[0]))

	)

163 
	$·r£_medŸ
(*
¬g
, *
bmü2
)

165 
mask
, 
i
;

166 *
s
;

167 
mask
 = 
	`¡¹oul
(
¬g
, &
s
, 16);

168 ià((*
¬g
 !ğ'\0'è&& (*
s
 == '\0')) {

169 ià((
mask
 & 
MII_AN_ABILITY_MASK
) &&

170 !(
mask
 & ~
MII_AN_ABILITY_MASK
)) {

171 *
bmü2
 = 0;

172  
mask
;

174 
çed
;

176 
mask
 = 0;

177 *
bmü2
 = 0;

178 
s
 = 
	`¡¹ok
(
¬g
, ", ");

180 
i
 = 0; i < 
NMEDIA
; i++)

181 ià(
s
 && 
	`¡rÿ£cmp
(
medŸ
[
i
].
Çme
, s) == 0) ;

182 ià(
i
 =ğ
NMEDIA
è
çed
;

183 
mask
 |ğ
medŸ
[
i
].
v®ue
[0];

184 *
bmü2
 |ğ
medŸ
[
i
].
v®ue
[1];

185 } (
s
 = 
	`¡¹ok
(
NULL
, ", ")) != NULL);

187  
mask
;

188 
çed
:

189 
	`årštf
(
¡d”r
, "Inv®id medŸ s³cifiÿtiÚ '%s'.\n", 
¬g
);

191 
	}
}

195 cÚ¡ *
	$medŸ_li¡
(
mask
, 
mask2
, 
be¡
)

197 
buf
[100];

198 
i
;

199 *
buf
 = '\0';

201 ià(
mask
 & 
MII_BMCR_SPEED1000
) {

202 ià(
mask2
 & 
MII_BMCR2_1000HALF
) {

203 
	`¡rÿt
(
buf
, " ");

204 
	`¡rÿt
(
buf
, "1000baseT-HD");

205 ià(
be¡
è
out
;

207 ià(
mask2
 & 
MII_BMCR2_1000FULL
) {

208 
	`¡rÿt
(
buf
, " ");

209 
	`¡rÿt
(
buf
, "1000baseT-FD");

210 ià(
be¡
è
out
;

213 
mask
 >>= 5;

214 
i
 = 4; i >= 0; i--) {

215 ià(
mask
 & (1<<
i
)) {

216 
	`¡rÿt
(
buf
, " ");

217 
	`¡rÿt
(
buf
, 
medŸ
[
i
].
Çme
);

218 ià(
be¡
) ;

221 
out
:

222 ià(
mask
 & (1<<5))

223 
	`¡rÿt
(
buf
, " flow-control");

224  
buf
;

225 
	}
}

227 
	$show_basic_mii
(
sock
, 
phy_id
)

229 
buf
[100];

230 
i
, 
mii_v®
[32];

231 
bmü
, 
bm¤
, 
adv”t
, 
lk·r
, 
bmü2
, 
Ía2
;

235 
	`mdio_»ad
(
sock
, 
MII_BMSR
);

236 
i
 = 0; i < ((
v”bo£
 > 1è? 32 : 
MII_BASIC_MAX
); i++)

237 
mii_v®
[
i
] = 
	`mdio_»ad
(
sock
, i);

239 ià(
mii_v®
[
MII_BMCR
] =ğ0xfffà|| mii_v®[
MII_BMSR
] == 0x0000) {

240 
	`årštf
(
¡d”r
, " No MIIransceiver…resent!.\n");

245 
bmü
 = 
mii_v®
[
MII_BMCR
]; 
bm¤
 = mii_v®[
MII_BMSR
];

246 
adv”t
 = 
mii_v®
[
MII_ANAR
]; 
lk·r
 = mii_v®[
MII_ANLPAR
];

247 
bmü2
 = 
mii_v®
[
MII_CTRL1000
]; 
Ía2
 = mii_v®[
MII_STAT1000
];

249 
	`¥rštf
(
buf
, "%s: ", 
iä
.
iä_Çme
);

250 ià(
bmü
 & 
MII_BMCR_AN_ENA
) {

251 ià(
bm¤
 & 
MII_BMSR_AN_COMPLETE
) {

252 ià(
adv”t
 & 
lk·r
) {

253 
	`¡rÿt
(
buf
, (
lk·r
 & 
MII_AN_ACK
) ?

255 
	`¡rÿt
(
buf
, 
	`medŸ_li¡
(
adv”t
 & 
lk·r
, 
bmü2
 & 
Ía2
>>2, 1));

256 
	`¡rÿt
(
buf
, ", ");

258 
	`¡rÿt
(
buf
, "autonegotiation failed, ");

260 } ià(
bmü
 & 
MII_BMCR_RESTART
) {

261 
	`¡rÿt
(
buf
, "autonegotiation„estarted, ");

264 
	`¥rštf
(
buf
+
	`¡¾’
(buf), "%s Mbit, %s duplex, ",

265 ((
bmü2
 & (
MII_BMCR2_1000HALF
 | 
MII_BMCR2_1000FULL
)è& 
Ía2
 >> 2)

267 : (
bmü
 & 
MII_BMCR_100MBIT
) ? "100" : "10",

268 (
bmü
 & 
MII_BMCR_DUPLEX
) ? "full" : "half");

270 
	`¡rÿt
(
buf
, (
bm¤
 & 
MII_BMSR_LINK_VALID
) ? "link ok" : "no†ink");

272 ià(
İt_w©ch
) {

273 ià(
İt_log
) {

274 
	`sy¦og
(
LOG_INFO
, 
buf
);

276 
s
[20];

277 
time_t
 
t
 = 
	`time
(
NULL
);

278 
	`¡ráime
(
s
, (s), "%T", 
	`loÿÉime
(&
t
));

279 
	`´štf
("% %s\n", 
s
, 
buf
);

282 
	`´štf
("%s\n", 
buf
);

285 ià(
v”bo£
 > 1) {

286 
	`´štf
("„egi¡” fÜ MII PHY %d: ", 
phy_id
);

287 
i
 = 0; i < 32; i++)

288 
	`´štf
("% %4.4x", ((
i
 % 8è? "" : "\À "), 
mii_v®
[i]);

289 
	`´štf
("\n");

292 ià(
v”bo£
) {

293 
	`´štf
("…roduct info: ");

294 
i
 = 0; i < 
NMII
; i++)

295 ià((
mii_id
[
i
].
id1
 =ğ
mii_v®
[2]) &&

296 (
mii_id
[
i
].
id2
 =ğ(
mii_v®
[3] & 0xfff0)))

298 ià(
i
 < 
NMII
)

299 
	`´štf
("% »v %d\n", 
mii_id
[
i
].
Çme
, 
mii_v®
[3]&0x0f);

301 
	`´štf
("vendor %02x:%02x:%02x, model %d„ev %d\n",

302 
mii_v®
[2]>>10, (mii_val[2]>>2)&0xff,

303 ((
mii_v®
[2]<<6)|(mii_val[3]>>10))&0xff,

304 (
mii_v®
[3]>>4)&0x3f, mii_val[3]&0x0f);

305 
	`´štf
(" basic mode: ");

306 ià(
bmü
 & 
MII_BMCR_RESET
)

307 
	`´štf
("software„eset, ");

308 ià(
bmü
 & 
MII_BMCR_LOOPBACK
)

309 
	`´štf
("loopback, ");

310 ià(
bmü
 & 
MII_BMCR_ISOLATE
)

311 
	`´štf
("isolate, ");

312 ià(
bmü
 & 
MII_BMCR_COLTEST
)

313 
	`´štf
("collisionest, ");

314 ià(
bmü
 & 
MII_BMCR_AN_ENA
) {

315 
	`´štf
("autonegotiationƒnabled\n");

317 
	`´štf
("%s Mbit, %s duplex\n",

318 (
bmü
 & 
MII_BMCR_100MBIT
) ? "100" : "10",

319 (
bmü
 & 
MII_BMCR_DUPLEX
) ? "full" : "half");

321 
	`´štf
(" basic status: ");

322 ià(
bm¤
 & 
MII_BMSR_AN_COMPLETE
)

323 
	`´štf
("autonegotiation complete, ");

324 ià(
bmü
 & 
MII_BMCR_RESTART
)

325 
	`´štf
("autonegotiation„estarted, ");

326 ià(
bm¤
 & 
MII_BMSR_REMOTE_FAULT
)

327 
	`´štf
("remote fault, ");

328 
	`´štf
((
bm¤
 & 
MII_BMSR_LINK_VALID
) ? "link ok" : "no†ink");

329 
	`´štf
("\À c­ab™›s:%s", 
	`medŸ_li¡
(
bm¤
 >> 6, 
bmü2
, 0));

330 
	`´štf
("\À‡dv”tisšg: %s", 
	`medŸ_li¡
(
adv”t
, 
Ía2
 >> 2, 0));

331 ià(
lk·r
 & 
MII_AN_ABILITY_MASK
)

332 
	`´štf
("\À†šk…¬Š”:%s", 
	`medŸ_li¡
(
lk·r
, 
bmü2
, 0));

333 
	`´štf
("\n");

335 
	`fæush
(
¡dout
);

337 
	}
}

341 
	$do_Úe_xcvr
(
skfd
, *
iâame
, 
maybe
)

343 
mii_d©a
 *
mii
 = (mii_d©¨*)&
iä
.
iä_d©a
;

346 
	`¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

347 ià(
	`ioùl
(
skfd
, 
SIOCGMIIPHY
, &
iä
) < 0) {

348 ià(!
maybe
 || (
”ºo
 !ğ
ENODEV
))

349 
	`årštf
(
¡d”r
, "SIOCGMIIPHY on '%s' failed: %s\n",

350 
iâame
, 
	`¡»¼Ü
(
”ºo
));

354 ià(
ov”ride_phy
 >= 0) {

355 
	`´štf
("usšgh¥ecif›d MII index %d.\n", 
ov”ride_phy
);

356 
mii
->
phy_id
 = 
ov”ride_phy
;

359 ià(
İt_»£t
) {

360 
	`´štf
("resettingheransceiver...\n");

361 
	`mdio_wr™e
(
skfd
, 
MII_BMCR
, 
MII_BMCR_RESET
);

363 ià(
nway_adv”ti£
 > 0) {

364 
	`mdio_wr™e
(
skfd
, 
MII_ANAR
, 
nway_adv”ti£
 | 1);

365 
İt_»¡¬t
 = 1;

367 ià(
İt_»¡¬t
) {

368 
	`´štf
("restarting‡utonegotiation...\n");

369 
	`mdio_wr™e
(
skfd
, 
MII_BMCR
, 0x0000);

370 
	`mdio_wr™e
(
skfd
, 
MII_BMCR
, 
MII_BMCR_AN_ENA
|
MII_BMCR_RESTART
);

372 ià(
fixed_¥“d
) {

373 
bmü
 = 0;

374 ià(
fixed_¥“d
 & (
MII_AN_100BASETX_FD
|
MII_AN_100BASETX_HD
))

375 
bmü
 |ğ
MII_BMCR_100MBIT
;

376 ià(
fixed_¥“d
 & (
MII_AN_100BASETX_FD
|
MII_AN_10BASET_FD
))

377 
bmü
 |ğ
MII_BMCR_DUPLEX
;

378 
	`mdio_wr™e
(
skfd
, 
MII_BMCR
, 
bmü
);

381 ià(!
İt_»¡¬t
 && !
İt_»£t
 && !
fixed_¥“d
 && !
nway_adv”ti£
)

382 
	`show_basic_mii
(
skfd
, 
mii
->
phy_id
);

385 
	}
}

389 
	$w©ch_Úe_xcvr
(
skfd
, *
iâame
, 
šdex
)

391 
mii_d©a
 *
mii
 = (mii_d©¨*)&
iä
.
iä_d©a
;

392 
¡©us
[
MAX_ETH
] = { 0, };

393 
now
;

396 
	`¡ºıy
(
iä
.
iä_Çme
, 
iâame
, 
IFNAMSIZ
);

397 ià(
	`ioùl
(
skfd
, 
SIOCGMIIPHY
, &
iä
) < 0) {

398 ià(
”ºo
 !ğ
ENODEV
)

399 
	`årštf
(
¡d”r
, "SIOCGMIIPHY on '%s' failed: %s\n",

400 
iâame
, 
	`¡»¼Ü
(
”ºo
));

403 
now
 = (
	`mdio_»ad
(
skfd
, 
MII_BMCR
) |

404 (
	`mdio_»ad
(
skfd
, 
MII_BMSR
) << 16));

405 ià(
¡©us
[
šdex
] && (¡©us[šdex] !ğ
now
))

406 
	`show_basic_mii
(
skfd
, 
mii
->
phy_id
);

407 
¡©us
[
šdex
] = 
now
;

408 
	}
}

412 cÚ¡ *
	gu§ge
 =

428 
	$v”siÚ
()

430 
	`årštf
(
¡d”r
, "%s\n%s\n", 
V”siÚ
, 
RELEASE
);

431 
	`ex™
(5);

432 
	}
}

435 
	$maš
(
¬gc
, **
¬gv
)

437 
i
, 
c
, 
»t
, 
”ræag
 = 0;

438 
s
[6];

439 
ù¾1000
 = 0;

441 (
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "A:F:p:ÌRvVw?", 
lÚgİts
, 0)è!ğ
EOF
)

442 
c
) {

443 'A': 
nway_adv”ti£
 = 
	`·r£_medŸ
(
İrg
, &
ù¾1000
); ;

444 'F': 
fixed_¥“d
 = 
	`·r£_medŸ
(
İrg
, &
ù¾1000
); ;

445 'p': 
ov”ride_phy
 = 
	`©oi
(
İrg
); ;

446 'r': 
İt_»¡¬t
++; ;

447 'R': 
İt_»£t
++; ;

448 'v': 
v”bo£
++; ;

449 'V': 
İt_v”siÚ
++; ;

450 'w': 
İt_w©ch
++; ;

451 'l': 
İt_log
++; ;

452 '?': 
”ræag
++;

455 ià(
İt_w©ch
è
v”bo£
 = 0;

457 ià((
nway_adv”ti£
 < 0è|| (
fixed_¥“d
 < 0))

460 ià(
”ræag
 || (
fixed_¥“d
 & (fixed_speed-1)) ||

461 (
fixed_¥“d
 && (
İt_»¡¬t
 || 
nway_adv”ti£
))) {

462 
	`årštf
(
¡d”r
, 
u§ge
, 
¬gv
[0]);

466 ià(
İt_v”siÚ
)

467 
	`v”siÚ
();

470 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
,0)) < 0) {

471 
	`³¼Ü
("socket");

472 
	`ex™
(-1);

475 ià(
v”bo£
 > 1)

476 
	`´štf
("Usšg SIOCGMIIPHY=0x%x\n", 
SIOCGMIIPHY
);

479 ià(
İtšd
 =ğ
¬gc
) {

480 
»t
 = 1;

481 
i
 = 0; i < 
MAX_ETH
; i++) {

482 
	`¥rštf
(
s
, "‘h%d", 
i
);

483 
»t
 &ğ
	`do_Úe_xcvr
(
skfd
, 
s
, 1);

485 ià(
»t
)

486 
	`årštf
(
¡d”r
, "no MII interfaces found\n");

488 
»t
 = 0;

489 
i
 = 
İtšd
; i < 
¬gc
; i++) {

490 
»t
 |ğ
	`do_Úe_xcvr
(
skfd
, 
¬gv
[
i
], 0);

494 ià(
İt_w©ch
 && (
»t
 == 0)) {

496 
	`¦“p
(1);

497 ià(
İtšd
 =ğ
¬gc
) {

498 
i
 = 0; i < 
MAX_ETH
; i++) {

499 
	`¥rštf
(
s
, "‘h%d", 
i
);

500 
	`w©ch_Úe_xcvr
(
skfd
, 
s
, 
i
);

503 
i
 = 
İtšd
; i < 
¬gc
; i++)

504 
	`w©ch_Úe_xcvr
(
skfd
, 
¬gv
[
i
], i-
İtšd
);

509 
	`şo£
(
skfd
);

510  
»t
;

511 
	}
}

	@interface/net-tools/nameif.c

8 #iâdeà
_GNU_SOURCE


9 
	#_GNU_SOURCE


	)

11 
	~<¡dio.h
>

12 
	~<g‘İt.h
>

13 
	~<sys/sy¦og.h
>

14 
	~<”ºo.h
>

15 
	~<¡dlib.h
>

16 
	~<ùy³.h
>

17 
	~<¡ršg.h
>

18 
	~<¡d¬g.h
>

19 
	~<sys/sock‘.h
>

20 
	~<sys/ioùl.h
>

21 
	~<Ãt/if.h
>

22 
	~<lšux/sockios.h
>

23 
	~<”ºo.h
>

24 
	~"š.h
"

26 cÚ¡ 
	gdeçuÉ_cÚf
[] = "/etc/mactab";

27 cÚ¡ *
	gâame
 = 
deçuÉ_cÚf
;

28 
	gu£_sy¦og
;

29 
	gùl_sk
 = -1;

31 
	$”r
(*
msg
)

33 ià(
u£_sy¦og
) {

34 
	`sy¦og
(
LOG_ERR
,"%s: %m", 
msg
);

36 
	`³¼Ü
(
msg
);

38 
	`ex™
(1);

39 
	}
}

41 
	$com¶aš
(*
fmt
, ...)

43 
va_li¡
 
­
;

44 
	`va_¡¬t
(
­
,
fmt
);

45 ià(
u£_sy¦og
) {

46 
	`vsy¦og
(
LOG_ERR
,
fmt
,
­
);

48 
	`vårštf
(
¡d”r
,
fmt
,
­
);

49 
	`åutc
('\n',
¡d”r
);

51 
	`va_’d
(
­
);

52 
	`ex™
(1);

53 
	}
}

55 
	$w¬nšg
(*
fmt
, ...)

57 
va_li¡
 
­
;

58 
	`va_¡¬t
(
­
,
fmt
);

59 ià(
u£_sy¦og
) {

60 
	`vsy¦og
(
LOG_ERR
,
fmt
,
­
);

62 
	`vårštf
(
¡d”r
,
fmt
,
­
);

63 
	`åutc
('\n',
¡d”r
);

65 
	`va_’d
(
­
);

66 
	}
}

68 
	$·r£mac
(*
¡r
, *
mac
)

70 *
s
;

71 (
s
 = 
	`¡r£p
(&
¡r
, ":")è!ğ
NULL
) {

72 
by‹
;

73 ià(
	`ssÿnf
(
s
,"%x", &
by‹
)!=1 || byte > 0xff)

75 *
mac
++ = 
by‹
;

78 
	}
}

80 *
	$xm®loc
(
sz
)

82 *
p
 = 
	`ÿÎoc
(
sz
,1);

83 ià(!
p
è
”ºo
=
ENOMEM
, 
	`”r
("xmalloc");

84  
p
;

85 
	}
}

87 
	$İ’sock
()

89 ià(
ùl_sk
 < 0)

90 
ùl_sk
 = 
	`sock‘
(
PF_INET
,
SOCK_DGRAM
,0);

91 
	}
}

93 #iâdeà
iä_ÃwÇme


94 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_¦ave


	)

97 
	$£Šame
(*
ŞdÇme
, *
ÃwÇme
)

99 
iäeq
 
iä
;

100 
	`İ’sock
();

101 
	`mem£t
(&
iä
,0,(
iäeq
));

102 
	`¡rıy
(
iä
.
iä_Çme
, 
ŞdÇme
);

103 
	`¡rıy
(
iä
.
iä_ÃwÇme
, 
ÃwÇme
);

104  
	`ioùl
(
ùl_sk
, 
SIOCSIFNAME
, &
iä
);

105 
	}
}

107 
	$g‘mac
(*
Çme
, *
mac
)

109 
r
;

110 
iäeq
 
iä
;

111 
	`İ’sock
();

112 
	`mem£t
(&
iä
,0,(
iäeq
));

113 
	`¡rıy
(
iä
.
iä_Çme
, 
Çme
);

114 
r
 = 
	`ioùl
(
ùl_sk
, 
SIOCGIFHWADDR
, &
iä
);

115 
	`memıy
(
mac
, 
iä
.
iä_hwaddr
.
§_d©a
, 6);

116  
r
;

117 
	}
}

119 
	schªge
 {

120 
chªge
 *
	mÃxt
;

121 
	mfound
;

122 
	miâame
[
IFNAMSIZ
+1];

123 
	mmac
[6];

125 
chªge
 *
	gşi¡
;

127 
chªge
 *
	$lookupmac
(*
mac
)

129 
chªge
 *
ch
;

130 
ch
 = 
şi¡
;ch;ch = ch->
Ãxt
)

131 ià(!
	`memcmp
(
ch
->
mac
, mac, 6))

132  
ch
;

133  
NULL
;

134 
	}
}

136 
	$addchªge
(*
p
, 
chªge
 *
ch
, *
pos
)

138 ià(
	`¡rchr
(
ch
->
iâame
, ':'))

139 
	`w¬nšg
(
	`_
("alias device %s‡t %s…robably has‚o mac"),

140 
ch
->
iâame
, 
pos
);

141 ià(
	`·r£mac
(
p
,
ch
->
mac
) < 0)

142 
	`com¶aš
(
	`_
("ÿÂÙ…¬£ MAC `%s'‡ˆ%s"), 
p
, 
pos
);

143 
ch
->
Ãxt
 = 
şi¡
;

144 
şi¡
 = 
ch
;

146 
	}
}

148 
	$»adcÚf
()

150 *
lše
;

151 
size_t
 
lš–
;

152 
lš’um
;

153 
FILE
 *
ifh
;

154 *
p
;

155 
n
;

157 
ifh
 = 
	`fİ’
(
âame
, "r");

158 ià(!
ifh
)

159 
	`com¶aš
(
	`_
("İ’šg cÚfigu¿tiÚ f%s: %s"),
âame
,
	`¡»¼Ü
(
”ºo
));

161 
lše
 = 
NULL
;

162 
lš–
 = 0;

163 
lš’um
 = 1;

164 
	`g‘d–im
(&
lše
, &
lš–
, '\n', 
ifh
) > 0) {

165 
chªge
 *
ch
 = 
	`xm®loc
((change));

166 
pos
[20];

168 
	`¥rštf
(
pos
, 
	`_
("lš%d"), 
lš’um
);

170 ià((
p
 = 
	`¡rchr
(
lše
,'#')è!ğ
NULL
)

171 *
p
 = '\0';

172 
p
 = 
lše
;

173 
	`is¥aû
(*
p
))

174 ++
p
;

175 ià(*
p
 == '\0')

177 
n
 = 
	`¡rc¥n
(
p
, " \t");

178 ià(
n
 > 
IFNAMSIZ
-1)

179 
	`com¶aš
(
	`_
("š‹rçû‚amtoØlÚg‡ˆlš%d"), 
lše
);

180 
	`memıy
(
ch
->
iâame
, 
p
, 
n
);

181 
ch
->
iâame
[
n
] = 0;

182 
p
 +ğ
n
;

183 
p
 +ğ
	`¡r¥n
(p, " \t");

184 
n
 = 
	`¡r¥n
(
p
, "0123456789ABCDEFabcdef:");

185 
p
[
n
] = 0;

186 
	`addchªge
(
p
, 
ch
, 
pos
);

187 
lš’um
++;

189 
	`fşo£
(
ifh
);

190 
	}
}

192 
İtiÚ
 
	glİt
[] = {

193 {"sy¦og", 0, 
NULL
, 's' },

194 {"cÚfig-fe", 1, 
NULL
, 'c' },

195 {"h–p", 0, 
NULL
, '?' },

196 {
NULL
},

199 
	$u§ge
()

201 
	`årštf
(
¡d”r
, 
	`_
("usage:‚ameif [-c configurationfile] [-s] {ifname macaddress}\n"));

202 
	`ex™
(1);

203 
	}
}

205 
	$maš
(
ac
, **
av
)

207 
FILE
 *
ifh
;

208 *
p
;

209 
n
;

210 
lš’um
;

211 *
lše
 = 
NULL
;

212 
size_t
 
lš–
 = 0;

215 
c
 = 
	`g‘İt_lÚg
(
ac
,
av
,"c:s",
lİt
,
NULL
);

216 ià(
c
 == -1) ;

217 
c
) {

220 
	`u§ge
();

222 
âame
 = 
İrg
;

225 
u£_sy¦og
 = 1;

230 ià(
u£_sy¦og
)

231 
	`İ’log
("Çmeif",0,
LOG_LOCAL0
);

233 
İtšd
 < 
ac
) {

234 
chªge
 *
ch
 = 
	`xm®loc
((change));

235 
pos
[30];

237 ià((
ac
-
İtšd
) & 1)

238 
	`u§ge
();

239 ià(
	`¡¾’
(
av
[
İtšd
])+1>
IFNAMSIZ
)

240 
	`com¶aš
(
	`_
("š‹rçû‚am`%s'oØlÚg"), 
av
[
İtšd
]);

241 
	`¡rıy
(
ch
->
iâame
, 
av
[
İtšd
]);

242 
İtšd
++;

243 
	`¥rštf
(
pos
,
	`_
("¬gum’ˆ%d"),
İtšd
);

244 
	`addchªge
(
av
[
İtšd
], 
ch
, 
pos
);

245 
İtšd
++;

248 ià(!
şi¡
 || 
âame
 !ğ
deçuÉ_cÚf
)

249 
	`»adcÚf
();

251 
ifh
 = 
	`fİ’
("/proc/net/dev", "r");

252 ià(!
ifh
è
	`com¶aš
(
	`_
("İ’ oà/´oc/Ãt/dev: %s"), 
	`¡»¼Ü
(
”ºo
));

255 
lš’um
 = 0;

256 
	`g‘d–im
(&
lše
, &
lš–
, '\n', 
ifh
) > 0) {

257 
chªge
 *
ch
;

258 
mac
[6];

260 ià(
lš’um
++ < 2)

263 
p
 = 
lše
;

264 
	`is¥aû
(*
p
))

265 ++
p
;

266 
n
 = 
	`¡rc¥n
(
p
, ": \t");

267 
p
[
n
] = 0;

269 ià(
n
 > 
IFNAMSIZ
-1)

270 
	`com¶aš
(
	`_
("š‹rçû‚am`%s'oØlÚg"), 
p
);

272 ià(
	`g‘mac
(
p
, 
mac
) < 0)

275 
ch
 = 
	`lookupmac
(
mac
);

276 ià(!
ch
)

279 
ch
->
found
 = 1;

280 ià(
	`¡rcmp
(
p
, 
ch
->
iâame
)) {

281 ià(
	`£Šame
(
p
, 
ch
->
iâame
) < 0)

282 
	`com¶aš
(
	`_
("cannot change‚ame of %so %s: %s"),

283 
p
, 
ch
->
iâame
, 
	`¡»¼Ü
(
”ºo
));

286 
	`fşo£
(
ifh
);

288 
şi¡
) {

289 
chªge
 *
ch
 = 
şi¡
;

290 
şi¡
 = cli¡->
Ãxt
;

291 ià(!
ch
->
found
)

292 
	`w¬nšg
(
	`_
("š‹rçû '%s'‚Ù found"), 
ch
->
iâame
);

293 
	`ä“
(
ch
);

296 ià(
u£_sy¦og
)

297 
	`şo£log
();

299 
	}
}

	@interface/net-tools/netstat.c

71 
	~<”ºo.h
>

72 
	~<¡dio.h
>

73 
	~<¡dlib.h
>

74 
	~<¡ršg.h
>

75 
	~<¡ršgs.h
>

76 
	~<uni¡d.h
>

77 
	~<ùy³.h
>

78 
	~<fú.h
>

79 
	~<Ãtdb.h
>

80 
	~<·ths.h
>

81 
	~<pwd.h
>

82 
	~<g‘İt.h
>

83 
	~<sys/·¿m.h
>

84 
	~<sys/sock‘.h
>

85 
	~<¬·/š‘.h
>

86 
	~<Ãtš‘/š.h
>

87 
	~<sys/ioùl.h
>

88 
	~<Ãt/if.h
>

89 
	~<dœ’t.h
>

91 
	~"Ãt-suµÜt.h
"

92 
	~"·thÇmes.h
"

93 
	~"v”siÚ.h
"

94 
	~"cÚfig.h
"

95 
	~"š.h
"

96 
	~"sock‘s.h
"

97 
	~"š‹rçû.h
"

98 
	~"ut.h
"

99 
	~"´oc.h
"

101 
	#PROGNAME_WIDTH
 20

	)

103 #ià!
defšed
(
s6_addr32
è&& defšed(
š6a_wÜds
)

104 
	#s6_addr32
 
š6a_wÜds


	)

108 
·r£¢mp
(, , );

109 
š™b
();

110 
·r£¢mp6
(, , );

111 
š™b6
();

114 
	mSS_FREE
 = 0,

115 
	mSS_UNCONNECTED
,

116 
	mSS_CONNECTING
,

117 
	mSS_CONNECTED
,

118 
	mSS_DISCONNECTING


119 } 
	tsock‘_¡©e
;

121 
	#SO_ACCEPTCON
 (1<<16è

	)

122 
	#SO_WAITDATA
 (1<<17è

	)

123 
	#SO_NOSPACE
 (1<<18è

	)

125 
	#DFLT_AF
 "š‘"

	)

127 
	#FEATURE_NETSTAT


	)

128 
	~"lib/Ãt-ã©u»s.h
"

130 *
	gR–—£
 = 
RELEASE
, *
	gV”siÚ
 = "Ãt¡© 1.42 (2001-04-15)", *
	gSigÇtu»
 = "Fred Baumgarten, Alan Cox, Bernd Eckenfels, Phil Blundell, Tuan Hoang, Brian Micek‡nd others";

133 
	#E_READ
 -1

	)

134 
	#E_IOCTL
 -3

	)

136 
	gæag_št
 = 0;

137 
	gæag_rou
 = 0;

138 
	gæag_mas
 = 0;

139 
	gæag_¡a
 = 0;

141 
	gæag_®l
 = 0;

142 
	gæag_l¡
 = 0;

143 
	gæag_út
 = 0;

144 
	gæag_deb
 = 0;

145 
	gæag_nÙ
 = 0;

146 
	gæag_cf
 = 0;

147 
	gæag_İt
 = 0;

148 
	gæag_¿w
 = 0;

149 
	gæag_tı
 = 0;

150 
	gæag_sùp
= 0;

151 
	gæag_udp
 = 0;

152 
	gæag_ud¶™e
 = 0;

153 
	gæag_igmp
= 0;

154 
	gæag_rom
 = 0;

155 
	gæag_exp
 = 1;

156 
	gæag_wide
= 0;

157 
	gæag_´g
 = 0;

158 
	gæag_¬g
 = 0;

159 
	gæag_v”
 = 0;

161 
FILE
 *
	g´ocšfo
;

163 
	#INFO_GUTS1
(
fe
,
Çme
,
´oc
,
´Ù
) \

164 
´ocšfo
 = 
	`´oc_fİ’
((
fe
)); \

165 ià(
´ocšfo
 =ğ
NULL
) { \

166 ià(
”ºo
 !ğ
ENOENT
) { \

167 
	`³¼Ü
((
fe
)); \

170 ià(
æag_¬g
 || 
æag_v”
) \

171 
	`ESYSNOT
("Ãt¡©", (
Çme
)); \

172 ià(
æag_¬g
) \

173 
rc
 = 1; \

176 ià(
	`fg‘s
(
bufãr
, (bufãr), 
´ocšfo
)) \

177 (
´oc
)(
Êr
++, 
bufãr
,
´Ù
); \

178 } !
	`ãof
(
´ocšfo
)); \

179 
	`fşo£
(
´ocšfo
); \

180 }

	)

182 #ià
HAVE_AFINET6


183 
	#INFO_GUTS2
(
fe
,
´oc
,
´Ù
) \

184 
Êr
 = 0; \

185 
´ocšfo
 = 
	`´oc_fİ’
((
fe
)); \

186 ià(
´ocšfo
 !ğ
NULL
) { \

188 ià(
	`fg‘s
(
bufãr
, (bufãr), 
´ocšfo
)) \

189 (
´oc
)(
Êr
++, 
bufãr
,
´Ù
); \

190 } !
	`ãof
(
´ocšfo
)); \

191 
	`fşo£
(
´ocšfo
); \

192 }

	)

194 
	#INFO_GUTS2
(
fe
,
´oc
,
´Ù
)

	)

197 
	#INFO_GUTS3
 \

198  
rc
;

	)

200 
	#INFO_GUTS6
(
fe
,
fe6
,
Çme
,
´oc
,
´Ù4
,
´Ù6
) \

201 
bufãr
[8192]; \

202 
rc
 = 0; \

203 
Êr
 = 0; \

204 ià(!
æag_¬g
 || 
æag_š‘
) { \

205 
	`INFO_GUTS1
(
fe
,
Çme
,
´oc
,
´Ù4
) \

207 ià(!
æag_¬g
 || 
æag_š‘6
) { \

208 
	`INFO_GUTS2
(
fe6
,
´oc
,
´Ù6
) \

210 
INFO_GUTS3


	)

212 
	#INFO_GUTS
(
fe
,
Çme
,
´oc
,
´Ù
) \

213 
bufãr
[8192]; \

214 
rc
 = 0; \

215 
Êr
 = 0; \

216 
	`INFO_GUTS1
(
fe
,
Çme
,
´oc
,
´Ù
) \

217 
INFO_GUTS3


	)

219 
	#PROGNAME_WIDTHs
 
	`PROGNAME_WIDTH1
(
PROGNAME_WIDTH
)

	)

220 
	#PROGNAME_WIDTH1
(
s
è
	`PROGNAME_WIDTH2
(s)

	)

221 
	#PROGNAME_WIDTH2
(
s
è#s

	)

223 
	#PRG_HASH_SIZE
 211

	)

225 
	s´g_node
 {

226 
´g_node
 *
	mÃxt
;

227 
	mšode
;

228 
	mÇme
[
PROGNAME_WIDTH
];

229 } *
	g´g_hash
[
PRG_HASH_SIZE
];

231 
	g´g_ÿche_lßded
 = 0;

233 
	#PRG_HASHIT
(
x
è((xè% 
PRG_HASH_SIZE
)

	)

235 
	#PROGNAME_BANNER
 "PID/Prog¿m‚ame"

	)

237 
	#´št_´ogÇme_bªÃr
(èdØ{ ià(
æag_´g
è
	`´štf
(" %-" 
PROGNAME_WIDTHs
 "s",
PROGNAME_BANNER
); } 0)

	)

239 
	#PRG_LOCAL_ADDRESS
 "loÿl_add»ss"

	)

240 
	#PRG_INODE
 "šode"

	)

241 
	#PRG_SOCKET_PFX
 "sock‘:["

	)

242 
	#PRG_SOCKET_PFXl
 (
	`¡¾’
(
PRG_SOCKET_PFX
))

	)

243 
	#PRG_SOCKET_PFX2
 "[0000]:"

	)

244 
	#PRG_SOCKET_PFX2l
 (
	`¡¾’
(
PRG_SOCKET_PFX2
))

	)

247 #iâdeà
LINE_MAX


248 
	#LINE_MAX
 4096

	)

251 
	#PATH_PROC
 "/´oc"

	)

252 
	#PATH_FD_SUFF
 "fd"

	)

253 
	#PATH_FD_SUFFl
 
	`¡¾’
(
PATH_FD_SUFF
)

	)

254 
	#PATH_PROC_X_FD
 
PATH_PROC
 "/%s/" 
PATH_FD_SUFF


	)

255 
	#PATH_CMDLINE
 "cmdlše"

	)

256 
	#PATH_CMDLINEl
 
	`¡¾’
(
PATH_CMDLINE
)

	)

258 
	$´g_ÿche_add
(
šode
, *
Çme
)

260 
hi
 = 
	`PRG_HASHIT
(
šode
);

261 
´g_node
 **
²p
,*
²
;

263 
´g_ÿche_lßded
=2;

264 
²p
=
´g_hash
+
hi
;(
²
=*²p);²p=&²->
Ãxt
) {

265 ià(
²
->
šode
==inode) {

271 ià(!(*
²p
=
	`m®loc
((**pnp))))

273 
²
=*
²p
;

274 
²
->
Ãxt
=
NULL
;

275 
²
->
šode
=inode;

276 ià(
	`¡¾’
(
Çme
)>(
²
->name)-1)

277 
Çme
[(
²
->name)-1]='\0';

278 
	`¡rıy
(
²
->
Çme
,name);

279 
	}
}

281 cÚ¡ *
	$´g_ÿche_g‘
(
šode
)

283 
hi
=
	`PRG_HASHIT
(
šode
);

284 
´g_node
 *
²
;

286 
²
=
´g_hash
[
hi
];²;²õn->
Ãxt
)

287 ià(
²
->
šode
==šodeèÕn->
Çme
);

289 
	}
}

291 
	$´g_ÿche_ş—r
()

293 
´g_node
 **
²p
,*
²
;

295 ià(
´g_ÿche_lßded
 == 2)

296 
²p
=
´g_hash
;²p<´g_hash+
PRG_HASH_SIZE
;pnp++)

297 (
²
=*
²p
)) {

298 *
²p
=
²
->
Ãxt
;

299 
	`ä“
(
²
);

301 
´g_ÿche_lßded
=0;

302 
	}
}

304 
	$wa™_cÚtšous
()

306 
	`fæush
(
¡dout
);

307 
	`¦“p
(1);

308 
	}
}

310 
	$exŒaù_ty³_1_sock‘_šode
(cÚ¡ 
Êame
[], * 
šode_p
) {

316 ià(
	`¡¾’
(
Êame
è< 
PRG_SOCKET_PFXl
+3) (-1);

318 ià(
	`memcmp
(
Êame
, 
PRG_SOCKET_PFX
, 
PRG_SOCKET_PFXl
)) (-1);

319 ià(
Êame
[
	`¡¾’
(lname)-1] != ']') (-1);

322 
šode_¡r
[
	`¡¾’
(
Êame
 + 1)];

323 cÚ¡ 
šode_¡r_Ën
 = 
	`¡¾’
(
Êame
è- 
PRG_SOCKET_PFXl
 - 1;

324 *
£¼
;

326 
	`¡ºıy
(
šode_¡r
, 
Êame
+
PRG_SOCKET_PFXl
, 
šode_¡r_Ën
);

327 
šode_¡r
[
šode_¡r_Ën
] = '\0';

328 *
šode_p
 = 
	`¡¹Ş
(
šode_¡r
,&
£¼
,0);

329 ià(!
£¼
 || *£¼ || *
šode_p
 < 0 || *šode_°>ğ
LONG_MAX
)

333 
	}
}

337 
	$exŒaù_ty³_2_sock‘_šode
(cÚ¡ 
Êame
[], * 
šode_p
) {

343 ià(
	`¡¾’
(
Êame
è< 
PRG_SOCKET_PFX2l
+1) (-1);

344 ià(
	`memcmp
(
Êame
, 
PRG_SOCKET_PFX2
, 
PRG_SOCKET_PFX2l
)) (-1);

347 *
£¼
;

349 *
šode_p
=
	`¡¹Ş
(
Êame
 + 
PRG_SOCKET_PFX2l
,&
£¼
,0);

350 ià(!
£¼
 || *£¼ || *
šode_p
 < 0 || *šode_°>ğ
LONG_MAX
)

354 
	}
}

359 
	$´g_ÿche_lßd
()

361 
lše
[
LINE_MAX
],
—cûs
=0;

362 
´ocfdËn
,
fd
,
cmdÎ’
,
Êam–’
;

363 
Êame
[30],
cmdlbuf
[512],
fšbuf
[
PROGNAME_WIDTH
];

364 
šode
;

365 cÚ¡ *
cs
,*
cmdÍ
;

366 
DIR
 *
dœ´oc
=
NULL
,*
dœfd
=NULL;

367 
dœ’t
 *
dœ•roc
,*
dœefd
;

369 ià(
´g_ÿche_lßded
 || !
æag_´g
) ;

370 
´g_ÿche_lßded
=1;

371 
cmdlbuf
[(cmdlbuf)-1]='\0';

372 ià(!(
dœ´oc
=
	`İ’dœ
(
PATH_PROC
))è
ç
;

373 
”ºo
=0,
dœ•roc
=
	`»addœ
(
dœ´oc
)) {

374 
cs
=
dœ•roc
->
d_Çme
;*cs;cs++)

375 ià(!
	`isdig™
(*
cs
))

377 ià(*
cs
)

379 
´ocfdËn
=
	`¢´štf
(
lše
,Öše),
PATH_PROC_X_FD
,
dœ•roc
->
d_Çme
);

380 ià(
´ocfdËn
<=0 ||…rocfdËn>=(
lše
)-5)

382 
”ºo
=0;

383 
dœfd
=
	`İ’dœ
(
lše
);

384 ià(! 
dœfd
) {

385 ià(
”ºo
==
EACCES
)

386 
—cûs
=1;

389 
lše
[
´ocfdËn
] = '/';

390 
cmdÍ
 = 
NULL
;

391 (
dœefd
 = 
	`»addœ
(
dœfd
))) {

393 ià(!
	`isdig™
(
dœefd
->
d_Çme
[0]))

395 ià(
´ocfdËn
+1+
	`¡¾’
(
dœefd
->
d_Çme
)+1>(
lše
))

397 
	`memıy
(
lše
 + 
´ocfdËn
 - 
PATH_FD_SUFFl
, 
PATH_FD_SUFF
 "/",

398 
PATH_FD_SUFFl
+1);

399 
	`¡rıy
(
lše
 + 
´ocfdËn
 + 1, 
dœefd
->
d_Çme
);

400 
Êam–’
=
	`»adlšk
(
lše
,
Êame
,(lname)-1);

401 
Êame
[
Êam–’
] = '\0';

403 ià(
	`exŒaù_ty³_1_sock‘_šode
(
Êame
, &
šode
) < 0)

404 ià(
	`exŒaù_ty³_2_sock‘_šode
(
Êame
, &
šode
) < 0)

407 ià(!
cmdÍ
) {

408 ià(
´ocfdËn
 - 
PATH_FD_SUFFl
 + 
PATH_CMDLINEl
 >=

409 (
lše
) - 5)

411 
	`¡rıy
(
lše
 + 
´ocfdËn
-
PATH_FD_SUFFl
, 
PATH_CMDLINE
);

412 
fd
 = 
	`İ’
(
lše
, 
O_RDONLY
);

413 ià(
fd
 < 0)

415 
cmdÎ’
 = 
	`»ad
(
fd
, 
cmdlbuf
, (cmdlbuf) - 1);

416 ià(
	`şo£
(
fd
))

418 ià(
cmdÎ’
 == -1)

420 ià(
cmdÎ’
 < (
cmdlbuf
) - 1)

421 
cmdlbuf
[
cmdÎ’
]='\0';

422 ià((
cmdÍ
 = 
	`¡¼chr
(
cmdlbuf
, '/')))

423 
cmdÍ
++;

425 
cmdÍ
 = 
cmdlbuf
;

428 
	`¢´štf
(
fšbuf
, (fšbuf), "%s/%s", 
dœ•roc
->
d_Çme
, 
cmdÍ
);

429 
	`´g_ÿche_add
(
šode
, 
fšbuf
);

431 
	`şo£dœ
(
dœfd
);

432 
dœfd
 = 
NULL
;

434 ià(
dœ´oc
)

435 
	`şo£dœ
(
dœ´oc
);

436 ià(
dœfd
)

437 
	`şo£dœ
(
dœfd
);

438 ià(!
—cûs
)

440 ià(
´g_ÿche_lßded
 == 1) {

441 
ç
:

442 
	`årštf
(
¡d”r
,
	`_
("(No info could be„ead for \"-p\": geteuid()=%d but you should be„oot.)\n"),

443 
	`g‘euid
());

446 
	`årštf
(
¡d”r
, 
	`_
("(Not‡ll…rocesses could be identified,‚on-owned…rocess info\n"

448 
	}
}

450 #ià
HAVE_AFNETROM


451 cÚ¡ *
	gÃŒom_¡©e
[] =

453 
N_
("LISTENING"),

454 
N_
("CONN SENT"),

455 
N_
("DISC SENT"),

456 
N_
("ESTABLISHED")

459 
	$ÃŒom_šfo
()

461 
FILE
 *
f
;

462 
bufãr
[256], 
dev
[16];

463 
¡
, 
vs
, 
vr
, 
£ndq
, 
»cvq
, 
»t
;

465 
f
 = 
	`´oc_fİ’
(
_PATH_PROCNET_NR
);

466 ià(
f
 =ğ
NULL
) {

467 ià(
”ºo
 !ğ
ENOENT
) {

468 
	`³¼Ü
(
_PATH_PROCNET_NR
);

471 ià(
æag_¬g
 || 
æag_v”
)

472 
	`ESYSNOT
("netstat", "AF NETROM");

473 ià(
æag_¬g
)

478 
	`´štf
(
	`_
("Active NET/ROM sockets\n"));

479 
	`´štf
(
	`_
("User Dest Source Device State Vr/Vs Send-Q Recv-Q\n"));

480 
	`fg‘s
(
bufãr
, 256, 
f
);

482 
	`fg‘s
(
bufãr
, 256, 
f
)) {

483 
bufãr
[9] = 0;

484 
bufãr
[19] = 0;

485 
bufãr
[29] = 0;

486 
»t
 = 
	`ssÿnf
(
bufãr
 + 30, "%s %*x/%*x %*x/%*x %d %d %d %*d %*d/%*d %*d/%*d %*d/%*d %*d/%*d %*d/%*d %*d %d %d %*d",

487 
dev
, &
¡
, &
vs
, &
vr
, &
£ndq
, &
»cvq
);

488 ià(
»t
 != 6) {

489 
	`´štf
(
	`_
("ProbËm„—dšg d©¨äom %s\n"), 
_PATH_PROCNET_NR
);

492 
	`´štf
("%-9s %-9s %-9s %-6s %-11s %03d/%03d %-6d %-6d\n",

493 
bufãr
, buffer + 10, buffer + 20,

494 
dev
,

495 
	`_
(
ÃŒom_¡©e
[
¡
]),

496 
vr
, 
vs
, 
£ndq
, 
»cvq
);

498 
	`fşo£
(
f
);

500 
	}
}

505 
	mTCP_ESTABLISHED
 = 1,

506 
	mTCP_SYN_SENT
,

507 
	mTCP_SYN_RECV
,

508 
	mTCP_FIN_WAIT1
,

509 
	mTCP_FIN_WAIT2
,

510 
	mTCP_TIME_WAIT
,

511 
	mTCP_CLOSE
,

512 
	mTCP_CLOSE_WAIT
,

513 
	mTCP_LAST_ACK
,

514 
	mTCP_LISTEN
,

515 
	mTCP_CLOSING


518 #ià
HAVE_AFINET
 || 
HAVE_AFINET6


520 cÚ¡ *
	gtı_¡©e
[] =

523 
N_
("ESTABLISHED"),

524 
N_
("SYN_SENT"),

525 
N_
("SYN_RECV"),

526 
N_
("FIN_WAIT1"),

527 
N_
("FIN_WAIT2"),

528 
N_
("TIME_WAIT"),

529 
N_
("CLOSE"),

530 
N_
("CLOSE_WAIT"),

531 
N_
("LAST_ACK"),

532 
N_
("LISTEN"),

533 
N_
("CLOSING")

536 
	$fšish_this_Úe
(
uid
, 
šode
, cÚ¡ *
tim”s
)

538 
·sswd
 *
pw
;

540 ià(
æag_exp
 > 1) {

541 ià(!(
æag_nÙ
 & 
FLAG_NUM_USER
è&& ((
pw
 = 
	`g‘pwuid
(
uid
)è!ğ
NULL
))

542 
	`´štf
(" %-10 ", 
pw
->
pw_Çme
);

544 
	`´štf
(" %-10d ", 
uid
);

545 
	`´štf
("%-10lu",
šode
);

547 ià(
æag_´g
)

548 
	`´štf
(" %-" 
PROGNAME_WIDTHs
 "s",
	`´g_ÿche_g‘
(
šode
));

549 ià(
æag_İt
)

550 
	`´štf
(" %s", 
tim”s
);

551 
	`putch¬
('\n');

552 
	}
}

554 
	$igmp_do_Úe
(
Êr
, cÚ¡ *
lše
,cÚ¡ *
´Ù
)

556 
mÿ¡_addr
[128];

557 #ià
HAVE_AFINET6


558 
sockaddr_š6
 
mÿ¡addr
;

559 
addr6
[
INET6_ADDRSTRLEN
];

560 
š6_addr
 
š6
;

561 
aáy³
 
š‘6_aáy³
;

563 
sockaddr_š
 
mÿ¡addr
;

565 
aáy³
 *
­
;

566 
idx_æag
 = 0;

567 
igmp6_æag
 = 0;

568 
deviû
[16];

569 
num
, 
idx
, 
»fút
;

571 ià(
Êr
 == 0) {

574 iàĞ
	`¡r¡r
Ğ
lše
, "Deviû" ) =ğ
NULL
 ) {

575 
igmp6_æag
 = 1;

580 iàĞ
	`¡ºcmp
Ğ
lše
, "Idx", 
	`¡¾’
("Idx") ) == 0 )

581 
idx_æag
 = 1;

583 
idx_æag
 = 0;

588 ià(
igmp6_æag
) {

589 #ià
HAVE_AFINET6


590 
num
 = 
	`ssÿnf
Ğ
lše
, "%d %15 %64[0-9A-Fa-f] %d", &
idx
, 
deviû
, 
mÿ¡_addr
, &
»fút
 );

591 ià(
num
 == 4) {

593 
	`ssÿnf
(
mÿ¡_addr
, "%08X%08X%08X%08X",

594 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

595 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

596 
š6
.
s6_addr32
[0] = 
	`htÚl
(in6.s6_addr32[0]);

597 
š6
.
s6_addr32
[1] = 
	`htÚl
(in6.s6_addr32[1]);

598 
š6
.
s6_addr32
[2] = 
	`htÚl
(in6.s6_addr32[2]);

599 
š6
.
s6_addr32
[3] = 
	`htÚl
(in6.s6_addr32[3]);

600 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

601 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
mÿ¡addr
);

602 
mÿ¡addr
.
sš6_çmy
 = 
AF_INET6
;

604 
	`årštf
(
¡d”r
, 
	`_
("w¬nšg, gÙ bogu igmp6†š%d.\n"), 
Êr
);

608 ià((
­
 = 
	`g‘_aâty³
(((
sockaddr
 *è&
mÿ¡addr
)->
§_çmy
)è=ğ
NULL
) {

609 
	`årštf
(
¡d”r
, 
	`_
("netstat: unsupported‡ddress family %d !\n"),

610 ((
sockaddr
 *è&
mÿ¡addr
)->
§_çmy
);

613 
	`§ã_¡ºıy
(
mÿ¡_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
mÿ¡addr
,

614 
æag_nÙ
), (
mÿ¡_addr
));

615 
	`´štf
("%-15 %-6d %s\n", 
deviû
, 
»fút
, 
mÿ¡_addr
);

618 #ià
HAVE_AFINET


619 ià(
lše
[0] != '\t') {

620 ià(
idx_æag
) {

621 ià((
num
 = 
	`ssÿnf
Ğ
lše
, "%d\t%10c", &
idx
, 
deviû
)) < 2) {

622 
	`årštf
(
¡d”r
, 
	`_
("w¬nšg, gÙ bogu igm°lš%d.\n"), 
Êr
);

626 iàĞ(
num
 = 
	`ssÿnf
Ğ
lše
, "%10c", 
deviû
 )) < 1 ) {

627 
	`årštf
(
¡d”r
, 
	`_
("w¬nšg, gÙ bogu igm°lš%d.\n"), 
Êr
);

631 
deviû
[10] = '\0';

633 } iàĞ
lše
[0] == '\t' ) {

634 iàĞ(
num
 = 
	`ssÿnf
(
lše
, "\t%8[0-9A-Fa-f] %d", 
mÿ¡_addr
, &
»fút
)) < 2 ) {

635 
	`årštf
(
¡d”r
, 
	`_
("w¬nšg, gÙ bogu igm°lš%d.\n"), 
Êr
);

638 
	`ssÿnf
Ğ
mÿ¡_addr
, "%X",

639 &((
sockaddr_š
 *è&
mÿ¡addr
)->
sš_addr
.
s_addr
 );

640 ((
sockaddr
 *è&
mÿ¡addr
)->
§_çmy
 = 
AF_INET
;

642 
	`årštf
(
¡d”r
, 
	`_
("w¬nšg, gÙ bogu igm°lš%d.\n"), 
Êr
);

646 ià((
­
 = 
	`g‘_aâty³
(((
sockaddr
 *è&
mÿ¡addr
)->
§_çmy
)è=ğ
NULL
) {

647 
	`årštf
(
¡d”r
, 
	`_
("netstat: unsupported‡ddress family %d !\n"),

648 ((
sockaddr
 *è&
mÿ¡addr
)->
§_çmy
);

651 
	`§ã_¡ºıy
(
mÿ¡_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
mÿ¡addr
,

652 
æag_nÙ
), (
mÿ¡_addr
));

653 
	`´štf
("%-15 %-6d %s\n", 
deviû
, 
»fút
, 
mÿ¡_addr
 );

656 
	}
}

658 #ià
HAVE_AFX25


659 
	$x25_šfo
()

661 
FILE
 *
f
=
	`´oc_fİ’
(
_PATH_PROCNET_X25
);

662 
bufãr
[256],
dev
[16];

663 
¡
,
vs
,
vr
,
£ndq
,
»cvq
,
lci
;

664 *
x25_¡©e
[5]=

672 if(!(
f
=
	`´oc_fİ’
(
_PATH_PROCNET_X25
)))

674 ià(
”ºo
 !ğ
ENOENT
) {

675 
	`³¼Ü
(
_PATH_PROCNET_X25
);

678 ià(
æag_¬g
 || 
æag_v”
)

679 
	`ESYSNOT
("netstat","AF X25");

680 ià(
æag_¬g
)

685 
	`´štf
Ğ
	`_
("Active X.25 sockets\n"));

687 
	`´štf
Ğ
	`_
("Dest Source Device LCI State Vr/Vs Send-Q Recv-Q\n"));

688 
	`fg‘s
(
bufãr
,256,
f
);

689 
	`fg‘s
(
bufãr
,256,
f
))

691 
bufãr
[10]=0;

692 
bufãr
[20]=0;

693 
	`ssÿnf
(
bufãr
+22,"%s %d %d %d %d %*d %*d %*d %*d %*d %*d %d %d %*d",

694 
dev
,&
lci
,&
¡
,&
vs
,&
vr
,&
£ndq
,&
»cvq
);

695 ià(!(
æag_®l
 || 
lci
))

697 
	`´štf
("%-15s %-15s %-7s %-3d %-11s %02d/%02d %-6d %-6d\n",

698 
bufãr
,buffer+11,

699 
dev
,

700 
lci
,

701 
x25_¡©e
[
¡
],

702 
vr
,
vs
,
£ndq
,
»cvq
);

704 
	`fşo£
(
f
);

706 
	}
}

709 
	$igmp_šfo
()

711 
	`INFO_GUTS6
(
_PATH_PROCNET_IGMP
, 
_PATH_PROCNET_IGMP6
, "AF INET (igmp)",

712 
igmp_do_Úe
, "igmp", "igmp6");

713 
	}
}

715 
	$_·r£_dÙs
(
ušt32_t
 *
addr
, cÚ¡ *
¤c
) {

716 
a
, 
b
, 
c
, 
d
;

717 
»t
 = 4-
	`ssÿnf
(
¤c
, "%u.%u.%u.%u", &
a
, &
b
, &
c
, &
d
);

718 *
addr
 = 
	`htÚl
((
a
 << 24)|(
b
 << 16)|(
c
 << 8)|
d
);

719  
»t
;

720 
	}
}

722 
	$´št__£rviû
(
sockaddr_š
 *
addr
, cÚ¡ *
´ÙÇme
,

723 *
buf
, 
size
) {

724 
aáy³
 *
­
;

726 if(
size
 == 0) ;

729 if((
­
 = 
	`g‘_aâty³
(
addr
->
sš_çmy
)è=ğ
NULL
) {

730 
	`årštf
(
¡d”r
, 
	`_
("netstat: unsupported‡ddress family %d !\n"),

731 
addr
->
sš_çmy
);

734 
	`§ã_¡ºıy
(
buf
, 
­
->
	`¥ršt
((
sockaddr
*)
addr
, 
æag_nÙ
), 
size
);

737 if(
æag_®l
 || (
æag_l¡
 && !
addr
->
sš_pÜt
) || (!flag_lst &&‡ddr->sin_port)) {

738 
bfs
[32];

740 
	`¢´štf
(
bfs
, (bfs), "%s",

741 
	`g‘_¢ame
(
addr
->
sš_pÜt
, (*)
´ÙÇme
, 
æag_nÙ
 & 
FLAG_NUM_PORT
));

745 cÚ¡ 
buæ
 = 
	`¡¾’
(
buf
);

746 cÚ¡ 
bf¦
 = 
	`¡¾’
(
bfs
);

748 if(
buæ
+
bf¦
+2 > 
size
) {

749 cÚ¡ 
h®f
 = (
size
-2)>>1;

750 if(
buæ
 > 
h®f
) {

751 if(
bf¦
 > 
h®f
) {

752 
buf
[
size
-2-
h®f
] = '\0';

753 
bfs
[
h®f
+1] = '\0';

755 
buf
[
size
-2-
bf¦
] = '\0';

757 
bfs
[
size
-2-
buæ
] = '\0';

760 
	`¡rÿt
(
buf
, ":");

761 
	`¡rÿt
(
buf
, 
bfs
);

763 
	}
}

766 
	$sùp_do_•t
(
Êr
, cÚ¡ *
lše
, cÚ¡ *
´Ù
)

768 
sockaddr_š
 
Ïddr
, 
¿ddr
;

769 
uid
, 
šode
;

771 
l_addr
[23], 
r_addr
[23];

775 
ÍÜt
;

776 
©e
;

778 if(
Êr
 == 0) ;

779 if(
	`ssÿnf
(
lše
, "%*X %*X %*u %*u %*u %u %u %u %n",

780 &
ÍÜt
, &
uid
, &
šode
, &
©e
è< 3è
”r
;

783 if(
	`_·r£_dÙs
(&
Ïddr
.
sš_addr
.
s_addr
, 
lše
+
©e
)è
”r
;

784 
¿ddr
.
sš_addr
.
s_addr
 = 
	`htÚl
(0);

785 
Ïddr
.
sš_çmy
 = 
¿ddr
.sš_çmy = 
AF_INET
;

786 
Ïddr
.
sš_pÜt
 = 
	`htÚs
(
ÍÜt
);

787 
¿ddr
.
sš_pÜt
 = 
	`htÚs
(0);

791 
	`´št__£rviû
(&
Ïddr
, 
´Ù
, 
l_addr
, (l_addr));

792 
	`´št__£rviû
(&
¿ddr
, 
´Ù
, 
r_addr
, (r_addr));

795 
	`´štf
("%-4s %6d %6d %-*s %-*s %-11s",

796 
´Ù
, 0, 0,

797 ()
	`Ãtmax
(23,
	`¡¾’
(
l_addr
)),†_addr,

798 ()
	`Ãtmax
(23,
	`¡¾’
(
r_addr
)),„_addr,

799 
	`_
(
tı_¡©e
[
TCP_LISTEN
]));

800 
	`fšish_this_Úe
(
uid
, 
šode
, "");

802 
”r
:

803 
	`årštf
(
¡d”r
, "SCTPƒ¼Ü iÀlše: %d\n", 
Êr
);

804 
	}
}

807 
	$sùp_do_assoc
(
Êr
, cÚ¡ *
lše
, cÚ¡ *
´Ù
)

809 
sockaddr_š
 
Ïddr
, 
¿ddr
;

810 
rxq
, 
txq
;

811 
uid
, 
šode
;

813 
l_addr
[23], 
r_addr
[23];

817 
ÍÜt
, 
½Üt
;

818 
©e
;

819 cÚ¡ *
addr
;

821 if(
Êr
 == 0) ;

822 if(
	`ssÿnf
(
lše
, "%*X %*X %*u %*u %*u %*u %*u %lu %lu %u %u %u %u %n",

823 &
txq
, &
rxq
, &
uid
, &
šode
, &
ÍÜt
, &
½Üt
, &
©e
è< 6è
”r
;

826 
addr
 = 
	`¡rchr
(
lše
+
©e
, '*');

827 if(
addr
 =ğ0è
”r
;

828 if(
	`_·r£_dÙs
(&
Ïddr
.
sš_addr
.
s_addr
, ++
addr
)è
”r
;

829 
addr
 = 
	`¡rchr
(addr, '*');

830 if(
addr
 =ğ0è
”r
;

831 if(
	`_·r£_dÙs
(&
¿ddr
.
sš_addr
.
s_addr
, ++
addr
)è
”r
;

834 
Ïddr
.
sš_çmy
 = 
¿ddr
.sš_çmy = 
AF_INET
;

835 
Ïddr
.
sš_pÜt
 = 
	`htÚs
(
ÍÜt
);

836 
¿ddr
.
sš_pÜt
 = 
	`htÚs
(
½Üt
);

840 
	`´št__£rviû
(&
Ïddr
, 
´Ù
, 
l_addr
, (l_addr));

841 
	`´št__£rviû
(&
¿ddr
, 
´Ù
, 
r_addr
, (r_addr));

844 
	`´štf
("%-4s %6ld %6ld %-*s %-*s %-11s",

845 
´Ù
, 
rxq
, 
txq
,

846 ()
	`Ãtmax
(23,
	`¡¾’
(
l_addr
)),†_addr,

847 ()
	`Ãtmax
(23,
	`¡¾’
(
r_addr
)),„_addr,

848 
	`_
(
tı_¡©e
[
TCP_ESTABLISHED
]));

849 
	`fšish_this_Úe
(
uid
, 
šode
, "");

851 
”r
:

852 
	`årštf
(
¡d”r
, "SCTPƒ¼Ü iÀlše: %d\n", 
Êr
);

853 
	}
}

855 
	$sùp_šfo_•ts
() {

856 
	`INFO_GUTS6
(
_PATH_PROCNET_SCTPEPTS
, 
_PATH_PROCNET_SCTP6EPTS
, "AF INET (sctp)",

857 
sùp_do_•t
, "sctp", "sctp6");

858 
	}
}

860 
	$sùp_šfo_assocs
() {

861 
	`INFO_GUTS6
(
_PATH_PROCNET_SCTPASSOCS
, 
_PATH_PROCNET_SCTP6ASSOCS
, "AF INET (sctp)",

862 
sùp_do_assoc
, "sctp", "sctp6");

863 
	}
}

865 
	$sùp_šfo
() {

866 
»s
;

867 
»s
 = 
	`sùp_šfo_•ts
();

868 if(
»s
) „es;

869  
	`sùp_šfo_assocs
();

870 
	}
}

872 
	$tı_do_Úe
(
Êr
, cÚ¡ *
lše
, cÚ¡ *
´Ù
)

874 
rxq
, 
txq
, 
time_Ën
, 
»Œ
, 
šode
;

875 
num
, 
loÿl_pÜt
, 
»m_pÜt
, 
d
, 
¡©e
, 
uid
, 
tim”_run
, 
timeout
;

876 
»m_addr
[128], 
loÿl_addr
[128], 
tim”s
[64], 
bufãr
[1024], 
mÜe
[512];

877 
aáy³
 *
­
;

878 #ià
HAVE_AFINET6


879 
sockaddr_š6
 
loÿÏddr
, 
»maddr
;

880 
addr6
[
INET6_ADDRSTRLEN
];

881 
š6_addr
 
š6
;

882 
aáy³
 
š‘6_aáy³
;

884 
sockaddr_š
 
loÿÏddr
, 
»maddr
;

887 ià(
Êr
 == 0)

890 
num
 = 
	`ssÿnf
(
lše
,

892 &
d
, 
loÿl_addr
, &
loÿl_pÜt
, 
»m_addr
, &
»m_pÜt
, &
¡©e
,

893 &
txq
, &
rxq
, &
tim”_run
, &
time_Ën
, &
»Œ
, &
uid
, &
timeout
, &
šode
, 
mÜe
);

895 ià(!
æag_®l
 && ((
æag_l¡
 && 
»m_pÜt
) || (!flag_lst && !rem_port)))

898 ià(
	`¡¾’
(
loÿl_addr
) > 8) {

899 #ià
HAVE_AFINET6


901 
	`ssÿnf
(
loÿl_addr
, "%08X%08X%08X%08X",

902 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

903 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

904 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

905 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
loÿÏddr
);

906 
	`ssÿnf
(
»m_addr
, "%08X%08X%08X%08X",

907 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

908 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

909 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

910 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
»maddr
);

911 
loÿÏddr
.
sš6_çmy
 = 
AF_INET6
;

912 
»maddr
.
sš6_çmy
 = 
AF_INET6
;

915 
	`ssÿnf
(
loÿl_addr
, "%X",

916 &((
sockaddr_š
 *è&
loÿÏddr
)->
sš_addr
.
s_addr
);

917 
	`ssÿnf
(
»m_addr
, "%X",

918 &((
sockaddr_š
 *è&
»maddr
)->
sš_addr
.
s_addr
);

919 ((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
 = 
AF_INET
;

920 ((
sockaddr
 *è&
»maddr
)->
§_çmy
 = 
AF_INET
;

923 ià(
num
 < 11) {

924 
	`årštf
(
¡d”r
, 
	`_
("warning, got boguscp†ine.\n"));

927 ià((
­
 = 
	`g‘_aâty³
(((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
)è=ğ
NULL
) {

928 
	`årštf
(
¡d”r
, 
	`_
("netstat: unsupported‡ddress family %d !\n"),

929 ((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
);

932 
	`§ã_¡ºıy
(
loÿl_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
loÿÏddr
,

933 
æag_nÙ
), (
loÿl_addr
));

934 
	`§ã_¡ºıy
(
»m_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
»maddr
, 
æag_nÙ
),

935 (
»m_addr
));

937 
	`¢´štf
(
bufãr
, (buffer), "%s",

938 
	`g‘_¢ame
(
	`htÚs
(
loÿl_pÜt
), "tcp",

939 
æag_nÙ
 & 
FLAG_NUM_PORT
));

941 ià(!
æag_wide
) {

942 ià((
	`¡¾’
(
loÿl_addr
è+ sŒËn(
bufãr
)) > 22)

943 
loÿl_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

946 
	`¡rÿt
(
loÿl_addr
, ":");

947 
	`¡rÿt
(
loÿl_addr
, 
bufãr
);

948 
	`¢´štf
(
bufãr
, (buffer), "%s",

949 
	`g‘_¢ame
(
	`htÚs
(
»m_pÜt
), "tı", 
æag_nÙ
 & 
FLAG_NUM_PORT
));

951 ià(!
æag_wide
) {

952 ià((
	`¡¾’
(
»m_addr
è+ sŒËn(
bufãr
)) > 22)

953 
»m_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

956 
	`¡rÿt
(
»m_addr
, ":");

957 
	`¡rÿt
(
»m_addr
, 
bufãr
);

958 
tim”s
[0] = '\0';

960 ià(
æag_İt
)

961 
tim”_run
) {

963 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("ofà(0.00/%ld/%d)"), 
»Œ
, 
timeout
);

967 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("on (%2.2f/%ld/%d)"),

968 (è
time_Ën
 / 
HZ
, 
»Œ
, 
timeout
);

972 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("keepalive (%2.2f/%ld/%d)"),

973 (è
time_Ën
 / 
HZ
, 
»Œ
, 
timeout
);

977 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("timewait (%2.2f/%ld/%d)"),

978 (è
time_Ën
 / 
HZ
, 
»Œ
, 
timeout
);

982 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("unkn-%d (%2.2f/%ld/%d)"),

983 
tim”_run
, (è
time_Ën
 / 
HZ
, 
»Œ
, 
timeout
);

986 
	`´štf
("%-4s %6ld %6ld %-*s %-*s %-11s",

987 
´Ù
, 
rxq
, 
txq
, ()
	`Ãtmax
(23,
	`¡¾’
(
loÿl_addr
)),†oÿl_addr, (ê‘max(23,¡¾’(
»m_addr
)),„em_addr, 
	`_
(
tı_¡©e
[
¡©e
]));

989 
	`fšish_this_Úe
(
uid
,
šode
,
tim”s
);

990 
	}
}

992 
	$tı_šfo
()

994 
	`INFO_GUTS6
(
_PATH_PROCNET_TCP
, 
_PATH_PROCNET_TCP6
, "AF INET (tcp)",

995 
tı_do_Úe
, "tcp", "tcp6");

996 
	}
}

998 
	$udp_do_Úe
(
Êr
, cÚ¡ *
lše
,cÚ¡ *
´Ù
)

1000 
bufãr
[8192], 
loÿl_addr
[64], 
»m_addr
[64];

1001 *
udp_¡©e
, 
tim”s
[64], 
mÜe
[512];

1002 
num
, 
loÿl_pÜt
, 
»m_pÜt
, 
d
, 
¡©e
, 
tim”_run
, 
uid
, 
timeout
;

1003 #ià
HAVE_AFINET6


1004 
sockaddr_š6
 
loÿÏddr
, 
»maddr
;

1005 
addr6
[
INET6_ADDRSTRLEN
];

1006 
š6_addr
 
š6
;

1007 
aáy³
 
š‘6_aáy³
;

1009 
sockaddr_š
 
loÿÏddr
, 
»maddr
;

1011 
aáy³
 *
­
;

1012 
rxq
, 
txq
, 
time_Ën
, 
»Œ
, 
šode
;

1014 ià(
Êr
 == 0)

1017 
mÜe
[0] = '\0';

1018 
num
 = 
	`ssÿnf
(
lše
,

1020 &
d
, 
loÿl_addr
, &
loÿl_pÜt
,

1021 
»m_addr
, &
»m_pÜt
, &
¡©e
,

1022 &
txq
, &
rxq
, &
tim”_run
, &
time_Ën
, &
»Œ
, &
uid
, &
timeout
, &
šode
, 
mÜe
);

1024 ià(
	`¡¾’
(
loÿl_addr
) > 8) {

1025 #ià
HAVE_AFINET6


1026 
	`ssÿnf
(
loÿl_addr
, "%08X%08X%08X%08X",

1027 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

1028 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

1029 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

1030 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
loÿÏddr
);

1031 
	`ssÿnf
(
»m_addr
, "%08X%08X%08X%08X",

1032 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

1033 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

1034 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

1035 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
»maddr
);

1036 
loÿÏddr
.
sš6_çmy
 = 
AF_INET6
;

1037 
»maddr
.
sš6_çmy
 = 
AF_INET6
;

1040 
	`ssÿnf
(
loÿl_addr
, "%X",

1041 &((
sockaddr_š
 *è&
loÿÏddr
)->
sš_addr
.
s_addr
);

1042 
	`ssÿnf
(
»m_addr
, "%X",

1043 &((
sockaddr_š
 *è&
»maddr
)->
sš_addr
.
s_addr
);

1044 ((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
 = 
AF_INET
;

1045 ((
sockaddr
 *è&
»maddr
)->
§_çmy
 = 
AF_INET
;

1048 
»Œ
 = 0L;

1049 ià(!
æag_İt
)

1050 
mÜe
[0] = '\0';

1052 ià(
num
 < 10) {

1053 
	`årštf
(
¡d”r
, 
	`_
("warning, got bogus udp†ine.\n"));

1056 ià((
­
 = 
	`g‘_aâty³
(((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
)è=ğ
NULL
) {

1057 
	`årštf
(
¡d”r
, 
	`_
("netstat: unsupported‡ddress family %d !\n"),

1058 ((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
);

1061 
¡©e
) {

1062 
TCP_ESTABLISHED
:

1063 
udp_¡©e
 = 
	`_
("ESTABLISHED");

1066 
TCP_CLOSE
:

1067 
udp_¡©e
 = "";

1071 
udp_¡©e
 = 
	`_
("UNKNOWN");

1075 #ià
HAVE_AFINET6


1076 
	#nÙnuÎ
(
A
è(((A.
sš6_çmy
 =ğ
AF_INET6
) && \

1077 ((
A
.
sš6_addr
.
s6_addr32
[0]) || \

1078 (
A
.
sš6_addr
.
s6_addr32
[1]) || \

1079 (
A
.
sš6_addr
.
s6_addr32
[2]) || \

1080 (
A
.
sš6_addr
.
s6_addr32
[3]))) || \

1081 ((
A
.
sš6_çmy
 =ğ
AF_INET
) && \

1082 ((
sockaddr_š
 *è&
A
)->
sš_addr
.
s_addr
))

	)

1084 
	#nÙnuÎ
(
A
è(A.
sš_addr
.
s_addr
)

	)

1087 ià(
æag_®l
 || (
	`nÙnuÎ
(
»maddr
è&& !
æag_l¡
) || (!notnull(remaddr) && flag_lst))

1089 
	`§ã_¡ºıy
(
loÿl_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
loÿÏddr
,

1090 
æag_nÙ
), (
loÿl_addr
));

1091 
	`¢´štf
(
bufãr
, (buffer), "%s",

1092 
	`g‘_¢ame
(
	`htÚs
(
loÿl_pÜt
), "udp",

1093 
æag_nÙ
 & 
FLAG_NUM_PORT
));

1094 ià((
	`¡¾’
(
loÿl_addr
è+ sŒËn(
bufãr
)) > 22)

1095 
loÿl_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

1096 
	`¡rÿt
(
loÿl_addr
, ":");

1097 
	`¡rÿt
(
loÿl_addr
, 
bufãr
);

1099 
	`¢´štf
(
bufãr
, (buffer), "%s",

1100 
	`g‘_¢ame
(
	`htÚs
(
»m_pÜt
), "udp", 
æag_nÙ
 & 
FLAG_NUM_PORT
));

1101 
	`§ã_¡ºıy
(
»m_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
»maddr
,

1102 
æag_nÙ
), (
»m_addr
));

1103 ià((
	`¡¾’
(
»m_addr
è+ sŒËn(
bufãr
)) > 22)

1104 
»m_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

1105 
	`¡rÿt
(
»m_addr
, ":");

1106 
	`¡rÿt
(
»m_addr
, 
bufãr
);

1108 
tim”s
[0] = '\0';

1109 ià(
æag_İt
)

1110 
tim”_run
) {

1112 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("ofà(0.00/%ld/%d)"), 
»Œ
, 
timeout
);

1117 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("Ú%d (%2.2f/%ld/%d)"), 
tim”_run
, (è
time_Ën
 / 100, 
»Œ
, 
timeout
);

1121 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("unkn-%d (%2.2f/%ld/%d)"), 
tim”_run
, (è
time_Ën
 / 100,

1122 
»Œ
, 
timeout
);

1125 
	`´štf
("%-5s %6ld %6ld %-23s %-23s %-11s",

1126 
´Ù
, 
rxq
, 
txq
, 
loÿl_addr
, 
»m_addr
, 
udp_¡©e
);

1128 
	`fšish_this_Úe
(
uid
,
šode
,
tim”s
);

1130 
	}
}

1132 
	$udp_šfo
()

1134 
	`INFO_GUTS6
(
_PATH_PROCNET_UDP
, 
_PATH_PROCNET_UDP6
, "AF INET (udp)",

1135 
udp_do_Úe
, "udp", "udp6");

1136 
	}
}

1138 
	$ud¶™e_šfo
()

1140 
	`INFO_GUTS6
(
_PATH_PROCNET_UDPLITE
, 
_PATH_PROCNET_UDPLITE6
,

1141 "AF INET (ud¶™e)", 
udp_do_Úe
, "udpl", "udpl6" );

1142 
	}
}

1144 
	$¿w_do_Úe
(
Êr
, cÚ¡ *
lše
,cÚ¡ *
´Ù
)

1146 
bufãr
[8192], 
loÿl_addr
[64], 
»m_addr
[64];

1147 
tim”s
[64], 
mÜe
[512];

1148 
num
, 
loÿl_pÜt
, 
»m_pÜt
, 
d
, 
¡©e
, 
tim”_run
, 
uid
, 
timeout
;

1149 #ià
HAVE_AFINET6


1150 
sockaddr_š6
 
loÿÏddr
, 
»maddr
;

1151 
addr6
[
INET6_ADDRSTRLEN
];

1152 
š6_addr
 
š6
;

1153 
aáy³
 
š‘6_aáy³
;

1155 
sockaddr_š
 
loÿÏddr
, 
»maddr
;

1157 
aáy³
 *
­
;

1158 
rxq
, 
txq
, 
time_Ën
, 
»Œ
, 
šode
;

1160 ià(
Êr
 == 0)

1163 
mÜe
[0] = '\0';

1164 
num
 = 
	`ssÿnf
(
lše
,

1166 &
d
, 
loÿl_addr
, &
loÿl_pÜt
, 
»m_addr
, &
»m_pÜt
, &
¡©e
,

1167 &
txq
, &
rxq
, &
tim”_run
, &
time_Ën
, &
»Œ
, &
uid
, &
timeout
, &
šode
, 
mÜe
);

1169 ià(
	`¡¾’
(
loÿl_addr
) > 8) {

1170 #ià
HAVE_AFINET6


1171 
	`ssÿnf
(
loÿl_addr
, "%08X%08X%08X%08X",

1172 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

1173 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

1174 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

1175 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
loÿÏddr
);

1176 
	`ssÿnf
(
»m_addr
, "%08X%08X%08X%08X",

1177 &
š6
.
s6_addr32
[0], &in6.s6_addr32[1],

1178 &
š6
.
s6_addr32
[2], &in6.s6_addr32[3]);

1179 
	`š‘_Áİ
(
AF_INET6
, &
š6
, 
addr6
, (addr6));

1180 
š‘6_aáy³
.
	`šput
(1, 
addr6
, (
sockaddr
 *è&
»maddr
);

1181 
loÿÏddr
.
sš6_çmy
 = 
AF_INET6
;

1182 
»maddr
.
sš6_çmy
 = 
AF_INET6
;

1185 
	`ssÿnf
(
loÿl_addr
, "%X",

1186 &((
sockaddr_š
 *è&
loÿÏddr
)->
sš_addr
.
s_addr
);

1187 
	`ssÿnf
(
»m_addr
, "%X",

1188 &((
sockaddr_š
 *è&
»maddr
)->
sš_addr
.
s_addr
);

1189 ((
sockaddr
 *è&
loÿÏddr
)->
§_çmy
 = 
AF_INET
;

1190 ((
sockaddr
 *è&
»maddr
)->
§_çmy
 = 
AF_INET
;

1192 #ià
HAVE_AFINET6


1193 ià((
­
 = 
	`g‘_aâty³
(
loÿÏddr
.
sš6_çmy
)è=ğ
NULL
) {

1194 
	`årštf
(
¡d”r
, 
	`_
("Ãt¡©: unsuµÜ‹d‡dd»s çmy %d !\n"), 
loÿÏddr
.
sš6_çmy
);

1198 ià((
­
 = 
	`g‘_aâty³
(
loÿÏddr
.
sš_çmy
)è=ğ
NULL
) {

1199 
	`årštf
(
¡d”r
, 
	`_
("Ãt¡©: unsuµÜ‹d‡dd»s çmy %d !\n"), 
loÿÏddr
.
sš_çmy
);

1204 ià(!
æag_İt
)

1205 
mÜe
[0] = '\0';

1207 ià(
num
 < 10) {

1208 
	`årštf
(
¡d”r
, 
	`_
("warning, got bogus„aw†ine.\n"));

1212 ià(
æag_®l
 || (
	`nÙnuÎ
(
»maddr
è&& !
æag_l¡
) || (!notnull(remaddr) && flag_lst))

1214 
	`¢´štf
(
bufãr
, (buffer), "%s",

1215 
	`g‘_¢ame
(
	`htÚs
(
loÿl_pÜt
), "raw",

1216 
æag_nÙ
 & 
FLAG_NUM_PORT
));

1217 
	`§ã_¡ºıy
(
loÿl_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
loÿÏddr
,

1218 
æag_nÙ
), (
loÿl_addr
));

1219 ià((
	`¡¾’
(
loÿl_addr
è+ sŒËn(
bufãr
)) > 22)

1220 
loÿl_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

1221 
	`¡rÿt
(
loÿl_addr
, ":");

1222 
	`¡rÿt
(
loÿl_addr
, 
bufãr
);

1224 
	`¢´štf
(
bufãr
, (buffer), "%s",

1225 
	`g‘_¢ame
(
	`htÚs
(
»m_pÜt
), "¿w", 
æag_nÙ
 & 
FLAG_NUM_PORT
));

1226 
	`§ã_¡ºıy
(
»m_addr
, 
­
->
	`¥ršt
((
sockaddr
 *è&
»maddr
,

1227 
æag_nÙ
), (
»m_addr
));

1228 ià((
	`¡¾’
(
»m_addr
è+ sŒËn(
bufãr
)) > 22)

1229 
»m_addr
[22 - 
	`¡¾’
(
bufãr
)] = '\0';

1230 
	`¡rÿt
(
»m_addr
, ":");

1231 
	`¡rÿt
(
»m_addr
, 
bufãr
);

1233 
tim”s
[0] = '\0';

1234 ià(
æag_İt
)

1235 
tim”_run
) {

1237 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("ofà(0.00/%ld/%d)"), 
»Œ
, 
timeout
);

1242 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("Ú%d (%2.2f/%ld/%d)"), 
tim”_run
, (è
time_Ën
 / 100,

1243 
»Œ
, 
timeout
);

1247 
	`¢´štf
(
tim”s
, Ñim”s), 
	`_
("unkn-%d (%2.2f/%ld/%d)"),

1248 
tim”_run
, (è
time_Ën
 / 100,

1249 
»Œ
, 
timeout
);

1252 
	`´štf
("%-4s %6ld %6ld %-23s %-23s %-11d",

1253 
´Ù
, 
rxq
, 
txq
, 
loÿl_addr
, 
»m_addr
, 
¡©e
);

1255 
	`fšish_this_Úe
(
uid
,
šode
,
tim”s
);

1257 
	}
}

1259 
	$¿w_šfo
()

1261 
	`INFO_GUTS6
(
_PATH_PROCNET_RAW
, 
_PATH_PROCNET_RAW6
, "AF INET (raw)",

1262 
¿w_do_Úe
, "raw", "raw6");

1263 
	}
}

1268 #ià
HAVE_AFUNIX


1270 
	#HAS_INODE
 1

	)

1272 
	$unix_do_Úe
(
Ä
, cÚ¡ *
lše
, cÚ¡ *
´Ù
)

1274 
has
 = 0;

1275 
·th
[
MAXPATHLEN
], 
ss_æags
[32];

1276 *
ss_´Ùo
, *
ss_¡©e
, *
ss_ty³
;

1277 
num
, 
¡©e
, 
ty³
;

1278 *
d
;

1279 
»fút
, 
´Ùo
, 
æags
, 
šode
;

1281 ià(
Ä
 == 0) {

1282 ià(
	`¡r¡r
(
lše
, "Inode"))

1283 
has
 |ğ
HAS_INODE
;

1286 
·th
[0] = '\0';

1287 
num
 = 
	`ssÿnf
(
lše
, "%p: %lX %lX %lX %X %X %lu %s",

1288 &
d
, &
»fút
, &
´Ùo
, &
æags
, &
ty³
, &
¡©e
, &
šode
, 
·th
);

1289 ià(
num
 < 6) {

1290 
	`årštf
(
¡d”r
, 
	`_
("warning, got bogus unix†ine.\n"));

1293 ià(!(
has
 & 
HAS_INODE
))

1294 
	`¢´štf
(
·th
,Õ©h),"%lu",
šode
);

1296 ià(!
æag_®l
) {

1297 ià((
¡©e
 =ğ
SS_UNCONNECTED
è&& (
æags
 & 
SO_ACCEPTCON
)) {

1298 ià(!
æag_l¡
)

1301 ià(
æag_l¡
)

1306 
´Ùo
) {

1308 
ss_´Ùo
 = "unix";

1312 
ss_´Ùo
 = "??";

1315 
ty³
) {

1316 
SOCK_STREAM
:

1317 
ss_ty³
 = 
	`_
("STREAM");

1320 
SOCK_DGRAM
:

1321 
ss_ty³
 = 
	`_
("DGRAM");

1324 
SOCK_RAW
:

1325 
ss_ty³
 = 
	`_
("RAW");

1328 
SOCK_RDM
:

1329 
ss_ty³
 = 
	`_
("RDM");

1332 
SOCK_SEQPACKET
:

1333 
ss_ty³
 = 
	`_
("SEQPACKET");

1337 
ss_ty³
 = 
	`_
("UNKNOWN");

1340 
¡©e
) {

1341 
SS_FREE
:

1342 
ss_¡©e
 = 
	`_
("FREE");

1345 
SS_UNCONNECTED
:

1350 ià(
æags
 & 
SO_ACCEPTCON
) {

1351 
ss_¡©e
 = 
	`_
("LISTENING");

1353 
ss_¡©e
 = "";

1357 
SS_CONNECTING
:

1358 
ss_¡©e
 = 
	`_
("CONNECTING");

1361 
SS_CONNECTED
:

1362 
ss_¡©e
 = 
	`_
("CONNECTED");

1365 
SS_DISCONNECTING
:

1366 
ss_¡©e
 = 
	`_
("DISCONNECTING");

1370 
ss_¡©e
 = 
	`_
("UNKNOWN");

1373 
	`¡rıy
(
ss_æags
, "[ ");

1374 ià(
æags
 & 
SO_ACCEPTCON
)

1375 
	`¡rÿt
(
ss_æags
, "ACC ");

1376 ià(
æags
 & 
SO_WAITDATA
)

1377 
	`¡rÿt
(
ss_æags
, "W ");

1378 ià(
æags
 & 
SO_NOSPACE
)

1379 
	`¡rÿt
(
ss_æags
, "N ");

1381 
	`¡rÿt
(
ss_æags
, "]");

1383 
	`´štf
("%-5s %-6ld %-11s %-10s %-13s ",

1384 
ss_´Ùo
, 
»fút
, 
ss_æags
, 
ss_ty³
, 
ss_¡©e
);

1385 ià(
has
 & 
HAS_INODE
)

1386 
	`´štf
("%-8lu",
šode
);

1388 
	`´štf
("- ");

1389 ià(
æag_´g
)

1390 
	`´štf
(" %-" 
PROGNAME_WIDTHs
 "s",(
has
 & 
HAS_INODE
?
	`´g_ÿche_g‘
(
šode
):"-"));

1392 
	`´štf
(" %s\n", 
·th
);

1393 
	}
}

1395 
	$unix_šfo
()

1398 
	`´štf
(
	`_
("Active UNIX domain sockets "));

1399 ià(
æag_®l
)

1400 
	`´štf
(
	`_
("(servers‡ndƒstablished)"));

1402 ià(
æag_l¡
)

1403 
	`´štf
(
	`_
("(only servers)"));

1405 
	`´štf
(
	`_
("(w/o servers)"));

1408 
	`´štf
(
	`_
("\nProto RefCnt Flags Type State I-Node "));

1409 
	`´št_´ogÇme_bªÃr
();

1410 
	`´štf
(
	`_
(" Path\n"));

1413 
	`INFO_GUTS
(
_PATH_PROCNET_UNIX
, "AF UNIX", 
unix_do_Úe
, "unix");

1415 
	}
}

1419 #ià
HAVE_AFAX25


1420 
	$ax25_šfo
()

1422 
FILE
 *
f
;

1423 
bufãr
[256], 
buf
[16];

1424 *
¤c
, *
d¡
, *
dev
, *
p
;

1425 
¡
, 
vs
, 
vr
, 
£ndq
, 
»cvq
, 
»t
;

1426 
Ãw
 = -1;

1427 *
ax25_¡©e
[5] =

1429 
	`N_
("LISTENING"),

1430 
	`N_
("SABM SENT"),

1431 
	`N_
("DISC SENT"),

1432 
	`N_
("ESTABLISHED"),

1433 
	`N_
("RECOVERY")

1435 ià(!(
f
 = 
	`´oc_fİ’
(
_PATH_PROCNET_AX25
))) {

1436 ià(
”ºo
 !ğ
ENOENT
) {

1437 
	`³¼Ü
(
_PATH_PROCNET_AX25
);

1440 ià(
æag_¬g
 || 
æag_v”
)

1441 
	`ESYSNOT
("netstat", "AF AX25");

1442 ià(
æag_¬g
)

1447 
	`´štf
(
	`_
("Active AX.25 sockets\n"));

1448 
	`´štf
(
	`_
("Dest Source Device State Vr/Vs Send-Q Recv-Q\n"));

1449 
	`fg‘s
(
bufãr
, 256, 
f
)) {

1450 ià(
Ãw
 == -1) {

1451 ià(!
	`¡ºcmp
(
bufãr
, "dest_addr", 9)) {

1452 
Ãw
 = 0;

1455 
Ãw
 = 1;

1461 
£ndq
 = 0;

1462 
»cvq
 = 0;

1463 ià(
Ãw
 == 0) {

1464 
d¡
 = 
bufãr
;

1465 
¤c
 = 
bufãr
 + 10;

1466 
d¡
[9] = 0;

1467 
¤c
[9] = 0;

1468 
»t
 = 
	`ssÿnf
(
bufãr
 + 20, "%s %d %d %d %*d %*d/%*d %*d/%*d %*d/%*d %*d/%*d %*d/%*d %*d %*d %*d %d %d %*d",

1469 
buf
, &
¡
, &
vs
, &
vr
, &
£ndq
, &
»cvq
);

1470 ià(
»t
 != 4 &&„et != 6) {

1471 
	`´štf
(
	`_
("ProbËm„—dšg d©¨äom %s\n"), 
_PATH_PROCNET_AX25
);

1474 
dev
 = 
buf
;

1476 
p
 = 
bufãr
;

1477 *
p
 != ' ')…++;

1478 
p
++;

1479 
dev
 = 
p
;

1480 *
p
 != ' ')…++;

1481 *
p
++ = 0;

1482 
¤c
 = 
p
;

1483 *
p
 != ' ')…++;

1484 *
p
++ = 0;

1485 
d¡
 = 
p
;

1486 *
p
 != ' ')…++;

1487 *
p
++ = 0;

1488 
»t
 = 
	`ssÿnf
(
p
, "%d %d %d %*d %*d %*d %*d %*d %*d %*d %*d %*d %*d %*d %*d %*d %*d %d %d %*d",

1489 &
¡
, &
vs
, &
vr
, &
£ndq
, &
»cvq
);

1490 ià(
»t
 != 3 &&„et != 5) {

1491 
	`´štf
(
	`_
("´obËm„—dšg d©¨äom %s\n"), 
_PATH_PROCNET_AX25
);

1498 
p
 = 
d¡
;

1499 *
p
 && *p != ',')…++;

1500 *
p
 = 0;

1502 
	`´štf
("%-9s %-9s %-6s %-11s %03d/%03d %-6d %-6d\n",

1503 
d¡
, 
¤c
,

1504 
dev
,

1505 
	`_
(
ax25_¡©e
[
¡
]),

1506 
vr
, 
vs
, 
£ndq
, 
»cvq
);

1508 
	`fşo£
(
f
);

1510 
	}
}

1514 #ià
HAVE_AFIPX


1515 
	$x_šfo
()

1517 
FILE
 *
f
;

1518 
buf
[256];

1519 
txq
, 
rxq
;

1520 
¡©e
;

1521 
uid
;

1522 *
¡
;

1523 
nc
;

1524 
aáy³
 *
­
;

1525 
·sswd
 *
pw
;

1526 
§d
[50], 
dad
[50];

1527 
sockaddr
 
§
;

1528 
¥Üt
 = 0, 
dpÜt
 = 0;

1529 
¡©
 
s
;

1531 
f
 = 
	`´oc_fİ’
(
_PATH_PROCNET_IPX_SOCKET1
);

1532 ià(!
f
) {

1533 ià(
”ºo
 !ğ
ENOENT
) {

1534 
	`³¼Ü
(
_PATH_PROCNET_IPX_SOCKET1
);

1537 
f
 = 
	`´oc_fİ’
(
_PATH_PROCNET_IPX_SOCKET2
);

1540 ià(
f
) {

1541 
	`f¡©
(
	`f’o
(
f
), &
s
);

1542 ià(!
	`S_ISREG
(
s
.
¡_mode
)) {

1543 
	`fşo£
(
f
);

1544 
f
=
NULL
;

1548 ià(!
f
) {

1549 ià(
”ºo
 !ğ
ENOENT
) {

1550 
	`³¼Ü
(
_PATH_PROCNET_IPX_SOCKET2
);

1553 ià(
æag_¬g
 || 
æag_v”
)

1554 
	`ESYSNOT
("netstat", "AF IPX");

1555 ià(
æag_¬g
)

1561 
	`´štf
(
	`_
("Active IPX sockets\nProto Recv-Q Send-Q Local Address Foreign Address State"));

1562 ià(
æag_exp
 > 1)

1563 
	`´štf
(
	`_
(" User"));

1564 
	`´štf
("\n");

1565 ià((
­
 = 
	`g‘_aâty³
(
AF_IPX
)è=ğ
NULL
) {

1566 
	`EINTERN
("netstat.c", "AF_IPX missing");

1569 
	`fg‘s
(
buf
, 255, 
f
);

1571 
	`fg‘s
(
buf
, 255, 
f
è!ğ
NULL
) {

1572 
	`ssÿnf
(
buf
, "%s %s %lX %lX %d %d",

1573 
§d
, 
dad
, &
txq
, &
rxq
, &
¡©e
, &
uid
);

1574 ià((
¡
 = 
	`ršdex
(
§d
, ':'))) {

1575 *
¡
++ = '\0';

1576 
	`ssÿnf
(
¡
, "%X", &
¥Üt
);

1577 
¥Üt
 = 
	`Áohs
(sport);

1579 
	`EINTERN
("netstat.c", "ipx socket formatƒrror in source…ort");

1582 
nc
 = 0;

1583 ià(
	`¡rcmp
(
dad
, "Not_Connected") != 0) {

1584 ià((
¡
 = 
	`ršdex
(
dad
, ':'))) {

1585 *
¡
++ = '\0';

1586 
	`ssÿnf
(
¡
, "%X", &
dpÜt
);

1587 
dpÜt
 = 
	`Áohs
(dport);

1589 
	`EINTERN
("netstat.c", "ipx soket formatƒrror in destination…ort");

1593 
nc
 = 1;

1595 
¡©e
) {

1596 
TCP_ESTABLISHED
:

1597 
¡
 = 
	`_
("ESTAB");

1600 
TCP_CLOSE
:

1601 
¡
 = "";

1605 
¡
 = 
	`_
("UNK.");

1610 (è
­
->
	`šput
(4, 
§d
, &
§
);

1611 
	`§ã_¡ºıy
(
buf
, 
­
->
	`¥ršt
(&
§
, 
æag_nÙ
), (buf));

1612 
	`¢´štf
(
§d
, (§d), "%s:%04X", 
buf
, 
¥Üt
);

1614 ià(!
nc
) {

1616 (è
­
->
	`šput
(4, 
dad
, &
§
);

1617 
	`§ã_¡ºıy
(
buf
, 
­
->
	`¥ršt
(&
§
, 
æag_nÙ
), (buf));

1618 
	`¢´štf
(
dad
, (dad), "%s:%04X", 
buf
, 
dpÜt
);

1620 
	`¡rıy
(
dad
, "-");

1622 
	`´štf
("IPX %6ld %6ld %-26 %-26 %-5s", 
txq
, 
rxq
, 
§d
, 
dad
, 
¡
);

1623 ià(
æag_exp
 > 1) {

1624 ià(!(
æag_nÙ
 & 
FLAG_NUM_USER
è&& ((
pw
 = 
	`g‘pwuid
(
uid
)è!ğ
NULL
))

1625 
	`´štf
(" %-10s", 
pw
->
pw_Çme
);

1627 
	`´štf
(" %-10d", 
uid
);

1629 
	`´štf
("\n");

1631 
	`fşo£
(
f
);

1633 
	}
}

1636 
	$içû_šfo
()

1638 ià(
skfd
 < 0) {

1639 ià((
skfd
 = 
	`sock‘s_İ’
(0)) < 0) {

1640 
	`³¼Ü
("socket");

1641 
	`ex™
(1);

1643 
	`´štf
(
	`_
("Kernel Interfaceable\n"));

1645 ià(
æag_exp
 < 2) {

1646 
iã_shÜt
 = 1;

1647 
	`´štf
(
	`_
("Iface MTU Met RX-OK RX-ERR RX-DRP RX-OVR TX-OK TX-ERR TX-DRP TX-OVR Flg\n"));

1650 ià(
	`fÜ_®l_š‹rçûs
(
do_if_´št
, &
æag_®l
) < 0) {

1651 
	`³¼Ü
(
	`_
("missing interface information"));

1652 
	`ex™
(1);

1654 ià(
æag_út
)

1655 
	`if_ÿche_ä“
();

1657 
	`şo£
(
skfd
);

1658 
skfd
 = -1;

1662 
	}
}

1665 
	$v”siÚ
()

1667 
	`´štf
("%s\n%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
SigÇtu»
, 
F—tu»s
);

1668 
	`ex™
(
E_VERSION
);

1669 
	}
}

1672 
	$u§ge
()

1674 
	`årštf
(
¡d”r
, 
	`_
("usage:‚etstat [-vWeenNcCF] [<Af>] -r‚etstat {-V|--version|-h|--help}\n"));

1675 
	`årštf
(
¡d”r
, 
	`_
("‚etstat [-vWnNcaeol] [<Socket> ...]\n"));

1676 
	`årštf
(
¡d”r
, 
	`_
("‚etstat { [-vWeenNac] -i | [-cnNe] -M | -s [-6tuw] }\n\n"));

1678 
	`årštf
(
¡d”r
, 
	`_
(" -r, --route display„outingable\n"));

1679 
	`årštf
(
¡d”r
, 
	`_
(" -i, --interfaces display interfaceable\n"));

1680 
	`årštf
(
¡d”r
, 
	`_
(" -g, --groups display multicast group memberships\n"));

1681 
	`årštf
(
¡d”r
, 
	`_
(" -s, --statistics display‚etworking statistics (like SNMP)\n"));

1682 #ià
HAVE_FW_MASQUERADE


1683 
	`årštf
(
¡d”r
, 
	`_
(" -M, --masquerade display masqueraded connections\n\n"));

1685 
	`årštf
(
¡d”r
, 
	`_
(" -v, --verbose be verbose\n"));

1686 
	`årštf
(
¡d”r
, 
	`_
(" -W, --wide don'truncate IP‡ddresses\n"));

1687 
	`årštf
(
¡d”r
, 
	`_
(" -n, --numeric don't„esolve‚ames\n"));

1688 
	`årštf
(
¡d”r
, 
	`_
(" --numeric-hosts don't„esolve host‚ames\n"));

1689 
	`årštf
(
¡d”r
, 
	`_
(" --numeric-ports don't„esolve…ort‚ames\n"));

1690 
	`årštf
(
¡d”r
, 
	`_
(" --numeric-users don't„esolve user‚ames\n"));

1691 
	`årštf
(
¡d”r
, 
	`_
(" -N, --symbolic„esolve hardware‚ames\n"));

1692 
	`årštf
(
¡d”r
, 
	`_
(" -e, --extend display other/more information\n"));

1693 
	`årštf
(
¡d”r
, 
	`_
(" -p, --programs display PID/Program‚ame for sockets\n"));

1694 
	`årštf
(
¡d”r
, 
	`_
(" -c, --continuous continuous†isting\n\n"));

1695 
	`årštf
(
¡d”r
, 
	`_
(" -l, --listening display†istening server sockets\n"));

1696 
	`årštf
(
¡d”r
, 
	`_
(" -a, --all, --listening display‡ll sockets (default: connected)\n"));

1697 
	`årštf
(
¡d”r
, 
	`_
(" -o, --timers displayimers\n"));

1698 
	`årštf
(
¡d”r
, 
	`_
(" -F, --fib display Forwarding Information Base (default)\n"));

1699 
	`årštf
(
¡d”r
, 
	`_
(" -C, --cache display„outing cache instead of FIB\n\n"));

1701 
	`årštf
(
¡d”r
, 
	`_
(" <Socket>={-t|--tcp} {-u|--udp} {-U|--udplite} {-w|--raw} {-x|--unix} --ax25 --ipx --netrom\n"));

1702 
	`årštf
(
¡d”r
, 
	`_
(" <AF>=U£ '-6|-4' o¸'-A <af>' o¸'--<af>'; deçuÉ: %s\n"), 
DFLT_AF
);

1703 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible‡ddress families (which support„outing):\n"));

1704 
	`´št_aæi¡
(1);

1705 
	`ex™
(
E_USAGE
);

1706 
	}
}

1709 
	gmaš


1710 (
	g¬gc
, *
	g¬gv
[]) {

1711 
	gi
;

1712 
	glİ
;

1713 
İtiÚ
 
	glÚgİts
[] =

1715 
AFTRANS_OPTS
,

1720 #ià
HAVE_FW_MASQUERADE


1747 {
NULL
, 0, 0, 0}

1750 #ià
I18N


1751 
£oÿË
 (
LC_ALL
, "");

1752 
bšd‹xtdomaš
("net-tools", "/usr/share/locale");

1753 
‹xtdomaš
("net-tools");

1755 
g‘rou‹_š™
();

1757 
	gaâame
[0] = '\0';

1758 (
	gi
 = 
g‘İt_lÚg
(
¬gc
, 
¬gv
, "A:CFMacdeghnNİrsStuUvVWwx64?", 
lÚgİts
, &
lİ
)è!ğ
EOF
)

1759 
i
) {

1763 ià(
lİ
 < 0 ||†İ >ğ
AFTRANS_CNT
) {

1764 
EINTERN
("netstat.c", "longopts 1„ange");

1767 ià(
aá¿ns_İt
(
lÚgİts
[
lİ
].
Çme
))

1768 
ex™
(1);

1771 ià(
aá¿ns_İt
(
İrg
))

1772 
ex™
(1);

1775 
æag_mas
++;

1778 
æag_®l
++;

1781 
æag_l¡
++;

1784 
æag_út
++;

1788 
æag_deb
++;

1791 
æag_igmp
++;

1794 
æag_exp
++;

1797 
æag_´g
++;

1800 
æag_št
++;

1803 
æag_wide
++;

1806 
æag_nÙ
 |ğ
FLAG_NUM
;

1809 
æag_nÙ
 |ğ
FLAG_NUM_HOST
;

1812 
æag_nÙ
 |ğ
FLAG_NUM_PORT
;

1815 
æag_nÙ
 |ğ
FLAG_NUM_USER
;

1818 
æag_nÙ
 |ğ
FLAG_SYM
;

1821 
æag_cf
 |ğ
FLAG_CACHE
;

1824 
æag_cf
 |ğ
FLAG_FIB
;

1827 
æag_İt
++;

1830 ià(
aá¿ns_İt
("inet6"))

1831 
ex™
(1);

1834 ià(
aá¿ns_İt
("inet"))

1835 
ex™
(1);

1838 
v”siÚ
();

1841 
æag_v”
 |ğ
FLAG_VERBOSE
;

1844 
æag_rou
++;

1847 
æag_tı
++;

1850 
æag_sùp
++;

1853 
æag_udp
++;

1856 
æag_ud¶™e
++;

1859 
æag_¿w
++;

1862 ià(
aá¿ns_İt
("unix"))

1863 
ex™
(1);

1867 
u§ge
();

1869 
æag_¡a
++;

1872 ià(
	gæag_št
 + 
	gæag_rou
 + 
	gæag_mas
 + 
	gæag_¡a
 > 1)

1873 
u§ge
();

1875 ià((
	gæag_š‘
 || 
	gæag_š‘6
 || 
	gæag_¡a
) &&

1876 !(
	gæag_tı
 || 
	gæag_sùp
 || 
	gæag_udp
 || 
	gæag_ud¶™e
 || 
	gæag_¿w
))

1877 
	gæag_tı
 = 
æag_sùp
 = 
æag_udp
 = 
æag_ud¶™e
 = 
æag_¿w
 = 1;

1879 ià((
	gæag_tı
 || 
	gæag_sùp
 || 
	gæag_udp
 || 
	gæag_ud¶™e
 || 
	gæag_¿w
 || 
	gæag_igmp
) &&

1880 !(
	gæag_š‘
 || 
	gæag_š‘6
))

1881 
	gæag_š‘
 = 
æag_š‘6
 = 1;

1883 
	gæag_¬g
 = 
æag_tı
 + 
æag_sùp
 + 
æag_ud¶™e
 + 
æag_udp
 + 
æag_¿w
 + 
æag_unx


1884 + 
æag_x
 + 
æag_ax25
 + 
æag_ÃŒom
 + 
æag_igmp
 + 
æag_x25
 + 
æag_ro£
;

1886 ià(
	gæag_mas
) {

1887 #ià
HAVE_FW_MASQUERADE
 && 
HAVE_AFINET


1888 #ià
MORE_THAN_ONE_MASQ_AF


1889 ià(!
	gaâame
[0])

1890 
¡rıy
(
aâame
, 
DFLT_AF
);

1893 
	gi
 = 
_masq_šfo
(
æag_nÙ
 & 
FLAG_NUM_HOST
,

1894 
æag_nÙ
 & 
FLAG_NUM_PORT
, 
æag_exp
);

1895 ià(
	gi
 || !
	gæag_út
)

1897 
wa™_cÚtšous
();

1900 
ENOSUPP
("netstat", "FW_MASQUERADE");

1901 
	gi
 = -1;

1903  (
	gi
);

1906 ià(
	gæag_¡a
) {

1907 ià(!
	gaâame
[0])

1908 
¡rıy
(
aâame
, 
DFLT_AF
);

1910 ià(!
¡rcmp
(
aâame
, "inet")) {

1911 #ià
HAVE_AFINET


1912 
š™b
();

1913 
·r£¢mp
(
æag_¿w
, 
æag_tı
, 
æag_udp
);

1915 
ENOSUPP
("netstat", "AF INET");

1917 } if(!
¡rcmp
(
aâame
, "inet6")) {

1918 #ià
HAVE_AFINET6


1919 
š™b6
();

1920 
·r£¢mp6
(
æag_¿w
, 
æag_tı
, 
æag_udp
);

1922 
ENOSUPP
("netstat", "AF INET6");

1925 
´štf
(
_
("Ãt¡©: NØ¡©i¡ic suµÜˆfÜ s³cif›d‡dd»s çmy: %s\n"), 
aâame
);

1926 
ex™
(1);

1928 
ex™
(0);

1931 ià(
	gæag_rou
) {

1932 
	gİtiÚs
 = 0;

1934 ià(!
	gaâame
[0])

1935 
¡rıy
(
aâame
, 
DFLT_AF
);

1937 ià(
	gæag_exp
 == 2)

1938 
æag_exp
 = 1;

1939 ià(
	gæag_exp
 == 1)

1940 
æag_exp
 = 2;

1942 
	gİtiÚs
 = (
æag_exp
 & 
FLAG_EXT
è| 
æag_nÙ
 | 
æag_cf
 | 
æag_v”
;

1943 ià(!
	gæag_cf
)

1944 
	gİtiÚs
 |ğ
FLAG_FIB
;

1947 
	gi
 = 
rou‹_šfo
(
aâame
, 
İtiÚs
);

1948 ià(
	gi
 || !
	gæag_út
)

1950 
wa™_cÚtšous
();

1952  (
	gi
);

1954 ià(
	gæag_št
) {

1956 
	gi
 = 
içû_šfo
();

1957 ià(!
	gæag_út
 || 
	gi
)

1959 
wa™_cÚtšous
();

1961  (
	gi
);

1964 ià(!
	gæag_¬g
 || 
	gæag_tı
 || 
	gæag_sùp
 || 
	gæag_udp
 || 
	gæag_ud¶™e
 || 
	gæag_¿w
) {

1965 #ià
HAVE_AFINET


1966 
´g_ÿche_lßd
();

1967 
´štf
(
_
("Active Internet connections "));

1969 ià(
	gæag_®l
)

1970 
´štf
(
_
("(servers‡ndƒstablished)"));

1972 ià(
	gæag_l¡
)

1973 
´štf
(
_
("(only servers)"));

1975 
´štf
(
_
("(w/o servers)"));

1977 
´štf
(
_
("\nProto Recv-Q Send-Q Local Address Foreign Address State "));

1978 ià(
	gæag_exp
 > 1)

1979 
´štf
(
_
(" User Inode "));

1980 
´št_´ogÇme_bªÃr
();

1981 ià(
	gæag_İt
)

1982 
´štf
(
_
(" Timer"));

1983 
´štf
("\n");

1985 ià(
	gæag_¬g
) {

1986 
	gi
 = 1;

1987 
ENOSUPP
("netstat", "AF INET");

1991 #ià
HAVE_AFINET


1992 ià(!
	gæag_¬g
 || 
	gæag_tı
) {

1993 
	gi
 = 
tı_šfo
();

1994 ià(
	gi
)

1995  (
	gi
);

1998 ià(!
	gæag_¬g
 || 
	gæag_sùp
) {

1999 
	gi
 = 
sùp_šfo
();

2000 ià(
	gi
)

2001  (
	gi
);

2004 ià(!
	gæag_¬g
 || 
	gæag_udp
) {

2005 
	gi
 = 
udp_šfo
();

2006 ià(
	gi
)

2007  (
	gi
);

2010 ià(!
	gæag_¬g
 || 
	gæag_ud¶™e
) {

2011 
	gi
 = 
ud¶™e_šfo
();

2012 ià(
	gi
)

2013  (
	gi
);

2016 ià(!
	gæag_¬g
 || 
	gæag_¿w
) {

2017 
	gi
 = 
¿w_šfo
();

2018 ià(
	gi
)

2019  (
	gi
);

2022 ià(
	gæag_igmp
) {

2023 #ià
HAVE_AFINET6


2024 
´štf
( "IPv6/");

2026 
´štf
Ğ
_
("IPv4 Group Memberships\n") );

2027 
´štf
Ğ
_
("Interface RefCnt Group\n") );

2028 
´štf
( "--------------- ------ ---------------------\n" );

2029 
	gi
 = 
igmp_šfo
();

2030 ià(
	gi
)

2031  (
	gi
);

2035 ià(!
	gæag_¬g
 || 
	gæag_unx
) {

2036 #ià
HAVE_AFUNIX


2037 
´g_ÿche_lßd
();

2038 
	gi
 = 
unix_šfo
();

2039 ià(
	gi
)

2040  (
	gi
);

2042 ià(
	gæag_¬g
) {

2043 
	gi
 = 1;

2044 
ENOSUPP
("netstat", "AF UNIX");

2048 ià(!
	gæag_¬g
 || 
	gæag_x
) {

2049 #ià
HAVE_AFIPX


2050 
	gi
 = 
x_šfo
();

2051 ià(
	gi
)

2052  (
	gi
);

2054 ià(
	gæag_¬g
) {

2055 
	gi
 = 1;

2056 
ENOSUPP
("netstat", "AF IPX");

2060 ià(!
	gæag_¬g
 || 
	gæag_ax25
) {

2061 #ià
HAVE_AFAX25


2062 
	gi
 = 
ax25_šfo
();

2063 ià(
	gi
)

2064  (
	gi
);

2066 ià(
	gæag_¬g
) {

2067 
	gi
 = 1;

2068 
ENOSUPP
("netstat", "AF AX25");

2072 if(!
	gæag_¬g
 || 
	gæag_x25
) {

2073 #ià
HAVE_AFX25


2075 
	gi
 = 
x25_šfo
();

2076 ià(
	gi
)

2077 (
	gi
);

2079 ià(
	gæag_¬g
) {

2080 
	gi
 = 1;

2081 
ENOSUPP
("netstat", "AF X25");

2085 ià(!
	gæag_¬g
 || 
	gæag_ÃŒom
) {

2086 #ià
HAVE_AFNETROM


2087 
	gi
 = 
ÃŒom_šfo
();

2088 ià(
	gi
)

2089  (
	gi
);

2091 ià(
	gæag_¬g
) {

2092 
	gi
 = 1;

2093 
ENOSUPP
("netstat", "AF NETROM");

2097 ià(!
	gæag_¬g
 || 
	gæag_ro£
) {

2098 #ià0 && 
HAVE_AFROSE


2099 
	gi
 = 
ro£_šfo
();

2100 ià(
	gi
)

2101  (
	gi
);

2103 ià(
	gæag_¬g
) {

2104 
	gi
 = 1;

2105 
ENOSUPP
("netstat", "AF ROSE");

2110 ià(!
	gæag_út
 || 
	gi
)

2112 
wa™_cÚtšous
();

2113 
´g_ÿche_ş—r
();

2115  (
	gi
);

	@interface/net-tools/plipconfig.c

32 
	~<¡dio.h
>

33 
	~<¡dlib.h
>

34 
	~<¡ršg.h
>

35 
	~<uni¡d.h
>

36 
	~<sys/sock‘.h
>

37 
	~<sys/ioùl.h
>

38 
	~<Ãt/if.h
>

39 
	~<lšux/if_¶.h
>

41 
	~"cÚfig.h
"

42 
	~"š.h
"

43 
	~"Ãt-suµÜt.h
"

44 
	~"v”siÚ.h
"

46 
	gİt_a
 = 0;

47 
	gİt_i
 = 0;

48 
	gİt_v
 = 0;

49 
	gskfd
 = -1;

51 
iäeq
 
	giä
;

52 
¶cÚf
 *
	g¶
;

54 *
	gR–—£
 = 
RELEASE
,

55 *
	gV”siÚ
 = "plipconfig 0.2",

56 *
	gSigÇtu»
 = "John Paul Morrison, Alan Coxƒt‡l.";

58 
	$v”siÚ
()

60 
	`´štf
("%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
SigÇtu»
);

61 
	`ex™
(
E_VERSION
);

62 
	}
}

64 
	$u§ge
()

66 
	`årštf
(
¡d”r
, 
	`_
("Usage:…lipconfig [-a] [-i] [-v] interface\n"));

67 
	`årštf
(
¡d”r
, 
	`_
(" [nibble NN] [trigger NN]\n"));

68 
	`årštf
(
¡d”r
, 
	`_
("…lipconfig -V | --version\n"));

69 
	`ex™
(-1);

70 
	}
}

72 
	$´št_¶
()

74 
	`´štf
(
	`_
("%s\ŠibbË %lurigg” %lu\n"), 
iä
.
iä_Çme
, 
¶
->
nibbË
,…l->
Œigg”
);

75 
	}
}

77 
	$maš
(
¬gc
, **
¬gv
)

79 
»t
 = 0;

80 **
¥p
;

82 #ià
I18N


83 
	`£oÿË
 (
LC_ALL
, "");

84 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

85 
	`‹xtdomaš
("net-tools");

88 ià((
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)) < 0) {

89 
	`³¼Ü
("socket");

90 
	`ex™
(-1);

93 
¬gc
--;

94 
¬gv
++;

95 
¬gv
[0] && *argv[0] == '-') {

96 ià(!
	`¡rcmp
(*
¬gv
, "-a"))

97 
İt_a
 = 1;

98 ià(!
	`¡rcmp
(*
¬gv
, "-v"))

99 
İt_v
 = 1;

100 ià(!
	`¡rcmp
(*
¬gv
, "-V") || !strcmp(*argv, "--version"))

101 
	`v”siÚ
();

102 
¬gv
++;

103 
¬gc
--;

106 ià(
¬gc
 == 0)

107 
	`u§ge
();

109 
¥p
 = 
¬gv
;

110 
	`¡ºıy
(
iä
.
iä_Çme
, *
¥p
++, 
IFNAMSIZ
);

111 
¶
=(
¶cÚf
 *)&
iä
.
iä_d©a
;

113 
¶
->
pcmd
 = 
PLIP_GET_TIMEOUT
;

114 ià(
	`ioùl
(
skfd
, 
SIOCDEVPLIP
, &
iä
) < 0) {

115 
	`³¼Ü
("ioctl");

116 
	`ex™
(-1);

118 ià(*
¥p
 =ğ(*è
NULL
) {

119 
	`´št_¶
();

120 (è
	`şo£
(
skfd
);

121 
	`ex™
(0);

123 *
¥p
 !ğ(*è
NULL
) {

124 ià(!
	`¡rcmp
(*
¥p
, "nibble")) {

125 ià(*++
¥p
 =ğ
NULL
)

126 
	`u§ge
();

127 
¶
->
nibbË
 = 
	`©oi
(*
¥p
);

128 
¥p
++;

131 ià(!
	`¡rcmp
(*
¥p
, "trigger")) {

132 ià(*++
¥p
 =ğ
NULL
)

133 
	`u§ge
();

134 
¶
->
Œigg”
 = 
	`©oi
(*
¥p
);

135 
¥p
++;

138 
	`u§ge
();

141 
¶
->
pcmd
 = 
PLIP_SET_TIMEOUT
;

142 ià(
	`ioùl
(
skfd
, 
SIOCDEVPLIP
, &
iä
) < 0)

143 
	`³¼Ü
("ioctl");

145 
	`´št_¶
();

148 (è
	`şo£
(
skfd
);

150  (
»t
);

151 
	}
}

	@interface/net-tools/rarp.c

20 
	~<sys/ty³s.h
>

21 
	~<sys/sock‘.h
>

22 
	~<sys/ioùl.h
>

23 
	~<Ãtš‘/š.h
>

24 
	~<¬·/š‘.h
>

25 
	~<Ãt/if.h
>

26 
	~<Ãt/if_¬p.h
>

27 
	~<¡dlib.h
>

28 
	~<¡dio.h
>

29 
	~<”ºo.h
>

30 
	~<fú.h
>

31 
	~<Ãtdb.h
>

32 
	~<¡ršg.h
>

33 
	~<uni¡d.h
>

34 
	~<g‘İt.h
>

36 
	#DFLT_HW
 "‘h”"

	)

38 
	~"cÚfig.h
"

39 
	~"š.h
"

40 
	~"Ãt-suµÜt.h
"

41 
	~"v”siÚ.h
"

42 
	~"·thÇmes.h
"

43 
	~"´oc.h
"

45 
	gno_¿½_mes§ge
[] = 
N_
("This kernel does‚ot support RARP.\n");

47 
	gv”siÚ_¡ršg
[] = 
RELEASE
 "\nrarp 1.03 (2001-04-04)\n";

49 
hwty³
 *
	gh¬dw¬e
 = 
NULL
;

52 
	$¿½_d–‘e
(
fd
, 
ho¡’t
 *
hp
)

54 
¬´eq
 
»q
;

55 
sockaddr_š
 *
si
;

56 
found
 = 0;

57 **
addr
;

60 
addr
 = 
hp
->
h_addr_li¡
; *add¸!ğ
NULL
;‡ddr++) {

61 
	`mem£t
((*è&
»q
, 0, (req));

62 
si
 = (
sockaddr_š
 *è&
»q
.
¬p_·
;

63 
si
->
sš_çmy
 = 
hp
->
h_add¹y³
;

64 
	`memıy
((*è&
si
->
sš_addr
, *
addr
, 
hp
->
h_Ëngth
);

67 ià(
	`ioùl
(
fd
, 
SIOCDRARP
, &
»q
) == 0) {

68 
found
++;

70 
”ºo
) {

71 
ENXIO
:

73 
ENODEV
:

74 
	`åuts
(
	`_
(
no_¿½_mes§ge
), 
¡d”r
);

77 
	`³¼Ü
("SIOCDRARP");

83 ià(
found
 == 0)

84 
	`´štf
(
	`_
("nØRARPƒÁry fÜ %s.\n"), 
hp
->
h_Çme
);

86 
	}
}

90 
	$¿½_£t
(
fd
, 
ho¡’t
 *
hp
, *
hw_addr
)

92 
¬´eq
 
»q
;

93 
sockaddr_š
 *
si
;

94 
sockaddr
 
§p
;

96 ià(
h¬dw¬e
->
	`šput
(
hw_addr
, &
§p
)) {

97 
	`årštf
(
¡d”r
, 
	`_
("%s: bad h¬dw¬add»ss\n"), 
hw_addr
);

101 
	`mem£t
((*è&
»q
, 0, (req));

102 
si
 = (
sockaddr_š
 *è&
»q
.
¬p_·
;

103 
si
->
sš_çmy
 = 
hp
->
h_add¹y³
;

104 
	`memıy
((*è&
si
->
sš_addr
, 
hp
->
h_addr_li¡
[0], hp->
h_Ëngth
);

105 
»q
.
¬p_ha
.
§_çmy
 = 
h¬dw¬e
->
ty³
;

106 
	`memıy
(
»q
.
¬p_ha
.
§_d©a
, 
§p
.§_d©a, 
h¬dw¬e
->
®’
);

109 ià(
	`ioùl
(
fd
, 
SIOCSRARP
, &
»q
) < 0) {

110 ià(
”ºo
 =ğ
ENODEV
)

111 
	`åuts
(
	`_
(
no_¿½_mes§ge
), 
¡d”r
);

113 
	`³¼Ü
("SIOCSRARP");

117 
	}
}

120 
	$¿½_fe
(
fd
, cÚ¡ *
Çme
)

122 
buff
[1024];

123 *
ho¡
, *
addr
;

124 
lš’r
;

125 
FILE
 *
å
;

126 
ho¡’t
 *
hp
;

128 ià((
å
 = 
	`fİ’
(
Çme
, "r")è=ğ
NULL
) {

129 
	`årštf
(
¡d”r
, 
	`_
("¿½: cªnÙ o³Àf%s:%s.\n"), 
Çme
, 
	`¡»¼Ü
(
”ºo
));

133 
lš’r
 = 0;

134 
	`fg‘s
(
buff
, (buff), 
å
)) {

135 ++
lš’r
;

136 ià(
buff
[0] == '#' || buff[0] == '\0')

138 ià((
addr
 = 
	`¡¹ok
(
buff
, "\À\t")è=ğ
NULL
)

140 ià((
ho¡
 = 
	`¡¹ok
(
NULL
, "\n \t")) == NULL) {

141 
	`årštf
(
¡d”r
, 
	`_
("¿½: fÜm©ƒ¼Ü‡ˆ%s:%u\n"), 
Çme
, 
lš’r
);

144 ià((
hp
 = 
	`g‘ho¡byÇme
(
ho¡
)è=ğ
NULL
) {

145 
	`årštf
(
¡d”r
, 
	`_
("¿½: %s: unknowÀho¡\n"), 
ho¡
);

147 ià(
	`¿½_£t
(
fd
, 
hp
, 
addr
) != 0) {

148 
	`årštf
(
¡d”r
, 
	`_
("¿½: cªnÙ s‘ƒÁry from %s:%u\n"), 
Çme
, 
lš’r
);

152 (è
	`fşo£
(
å
);

154 
	}
}

156 
	$di¥Ïy_ÿche
()

158 
FILE
 *
fd
 = 
	`´oc_fİ’
(
_PATH_PROCNET_RARP
);

159 
bufãr
[256];

160 ià(
fd
 =ğ
NULL
) {

161 ià(
”ºo
 =ğ
ENOENT
)

162 
	`åuts
(
	`_
(
no_¿½_mes§ge
), 
¡d”r
);

164 
	`³¼Ü
(
_PATH_PROCNET_RARP
);

167 
	`ãof
(
fd
) == 0) {

168 ià(
	`fg‘s
(
bufãr
, 255, 
fd
))

169 
	`åuts
(
bufãr
, 
¡dout
);

171 
	`fşo£
(
fd
);

173 
	}
}

175 
	$u§ge
()

177 
	`årštf
(
¡d”r
, 
	`_
("Usage:„arp -a†istƒntries in cache.\n"));

178 
	`årštf
(
¡d”r
, 
	`_
("„arp -d <hostname> deleteƒntry from cache.\n"));

179 
	`årštf
(
¡d”r
, 
	`_
("„arp [<HW>] -s <hostname> <hwaddr>‡ddƒntryo cache.\n"));

180 
	`årštf
(
¡d”r
, 
	`_
("„arp -f‡ddƒntries from /etc/ethers.\n"));

181 
	`årštf
(
¡d”r
, 
	`_
("„arp -V display…rogram version.\n\n"));

183 
	`årštf
(
¡d”r
, 
	`_
(" <HW>=U£ '-H <hw>'Ø¥ecify h¬dw¬add»s ty³. DeçuÉ: %s\n"), 
DFLT_HW
);

184 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible hardwareypes (which support ARP):\n"));

185 
	`´št_hwli¡
(1);

186 
	`ex™
(
E_USAGE
);

187 
	}
}

189 
	#MODE_DISPLAY
 1

	)

190 
	#MODE_DELETE
 2

	)

191 
	#MODE_SET
 3

	)

192 
	#MODE_ETHERS
 4

	)

194 
İtiÚ
 
	glÚgİts
[] =

196 {"v”siÚ", 0, 
NULL
, 'V'},

197 {"v”bo£", 0, 
NULL
, 'v'},

198 {"li¡", 0, 
NULL
, 'a'},

199 {"£t", 0, 
NULL
, 's'},

200 {"d–‘e", 0, 
NULL
, 'd'},

201 {"h–p", 0, 
NULL
, 'h'},

202 {
NULL
, 0, NULL, 0}

205 
	$maš
(
¬gc
, **
¬gv
)

207 
»suÉ
 = 0, 
mode
 = 0, 
c
, 
Çrgs
 = 0, 
v”bo£
 = 0;

208 *
¬gs
[3];

209 
ho¡’t
 *
hp
;

210 
fd
;

212 #ià
I18N


213 
	`£oÿË
 (
LC_ALL
, "");

214 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

215 
	`‹xtdomaš
("net-tools");

219 
h¬dw¬e
 = 
	`g‘_hwty³
(
DFLT_HW
);

222 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "-ht:aHdsVvf", 
lÚgİts
, 
NULL
);

223 
c
) {

224 
EOF
:

227 
	`u§ge
();

229 
	`årštf
(
¡d”r
, 
v”siÚ_¡ršg
);

230 
	`ex™
(
E_VERSION
);

233 
v”bo£
++;

238 ià(
mode
) {

239 
	`årštf
(
¡d”r
, 
	`_
("%s: iÎeg® o±iÚ mix.\n"), 
¬gv
[0]);

240 
	`u§ge
();

242 
mode
 = (
c
 =ğ'a' ? 
MODE_DISPLAY
 : (ø=ğ'd' ? 
MODE_DELETE
 : 
MODE_SET
));

246 
mode
 = 
MODE_ETHERS
;

250 ià(
İrg
) {

251 
h¬dw¬e
 = 
	`g‘_hwty³
(
İrg
);

253 
	`u§ge
();

257 ià(
Çrgs
 == 2) {

258 
	`u§ge
();

259 
	`ex™
(1);

261 
¬gs
[
Çrgs
++] = 
İrg
;

265 
	`u§ge
();

267 } 
c
 !ğ
EOF
);

269 ià(
h¬dw¬e
 =ğ
NULL
) {

270 
	`årštf
(
¡d”r
, 
	`_
("¿½: %s: unknowÀh¬dw¬ty³.\n"), 
İrg
);

271 
	`ex™
(1);

273 
mode
) {

275 
	`u§ge
();

277 
MODE_DISPLAY
:

278 ià(
Çrgs
 !ğ(
mode
 - 1)) {

279 
	`u§ge
();

281 
»suÉ
 = 
	`di¥Ïy_ÿche
();

284 
MODE_DELETE
:

285 
MODE_SET
:

286 ià(
Çrgs
 !ğ(
mode
 - 1)) {

287 
	`u§ge
();

289 ià((
hp
 = 
	`g‘ho¡byÇme
(
¬gs
[0])è=ğ
NULL
) {

290 
	`årštf
(
¡d”r
, 
	`_
("¿½: %s: unknowÀho¡\n"), 
¬gs
[0]);

291 
	`ex™
(1);

293 ià(
fd
 = 
	`sock‘
(
PF_INET
, 
SOCK_DGRAM
, 0), fd < 0) {

294 
	`³¼Ü
("socket");

295 
	`ex™
(1);

297 
»suÉ
 = (
mode
 =ğ
MODE_DELETE
è? 
	`¿½_d–‘e
(
fd
, 
hp
è: 
	`¿½_£t
(fd, hp, 
¬gs
[1]);

298 
	`şo£
(
fd
);

301 
MODE_ETHERS
:

302 ià(
Çrgs
 != 0 &&‚args != 1)

303 
	`u§ge
();

304 ià(
fd
 = 
	`sock‘
(
PF_INET
, 
SOCK_DGRAM
, 0), fd < 0) {

305 
	`³¼Ü
("socket");

306 
	`ex™
(1);

308 
»suÉ
 = 
	`¿½_fe
(
fd
, 
Çrgs
 ? 
¬gs
[0] : 
_PATH_ETHERS
);

309 
	`şo£
(
fd
);

312 
	`ex™
(
»suÉ
);

313 
	}
}

	@interface/net-tools/route.c

39 
	~<sys/ty³s.h
>

40 
	~<sys/ioùl.h
>

41 
	~<sys/sock‘.h
>

42 
	~<Ãt/if.h
>

44 
	~<Ãtš‘/š.h
>

45 
	~<Ãtdb.h
>

46 
	~<Ãtš‘/š.h
>

47 
	~<¬·/Çme£r.h
>

48 
	~<»sŞv.h
>

49 
	~<lšux/·¿m.h
>

50 
	~<¡dio.h
>

51 
	~<”ºo.h
>

52 
	~<fú.h
>

53 
	~<¡dlib.h
>

54 
	~<¡ršg.h
>

55 
	~<g‘İt.h
>

56 
	~<uni¡d.h
>

57 
	~<ùy³.h
>

58 
	~"Ãt-suµÜt.h
"

59 
	~"cÚfig.h
"

60 
	~"š.h
"

61 
	~"·thÇmes.h
"

62 
	~"v”siÚ.h
"

64 
	#DFLT_AF
 "š‘"

	)

66 
	#FEATURE_ROUTE


	)

67 
	~"lib/Ãt-ã©u»s.h
"

69 *
	gR–—£
 = 
RELEASE
, *
	gV”siÚ
 = "route 1.98 (2001-04-15)";

71 
	gİt_n
 = 0;

72 
	gİt_v
 = 0;

73 
	gİt_e
 = 1;

74 
	gİt_fc
 = 0;

75 
	gİt_h
 = 0;

76 
aáy³
 *
	g­
;

78 
	$u§ge
()

80 
	`årštf
(
¡d”r
, 
	`_
("Usage:„oute [-nNvee] [-FC] [<AF>] List kernel„outingables\n"));

81 
	`årštf
(
¡d”r
, 
	`_
("„oute [-v] [-FC] {add|del|flush} ... Modify„outingable for AF.\n\n"));

83 
	`årštf
(
¡d”r
, 
	`_
("„oute {-h|--help} [<AF>] Detailed usage syntax for specified AF.\n"));

84 
	`årštf
(
¡d”r
, 
	`_
("„oute {-V|--version} Display version/author‡ndƒxit.\n\n"));

86 
	`årštf
(
¡d”r
, 
	`_
(" -v, --verbose be verbose\n"));

87 
	`årštf
(
¡d”r
, 
	`_
(" -n, --numeric don't„esolve‚ames\n"));

88 
	`årštf
(
¡d”r
, 
	`_
(" -e, --extend display other/more information\n"));

89 
	`årštf
(
¡d”r
, 
	`_
(" -F, --fib display Forwarding Information Base (default)\n"));

90 
	`årštf
(
¡d”r
, 
	`_
(" -C, --cache display„outing cache instead of FIB\n\n"));

92 
	`årštf
(
¡d”r
, 
	`_
(" <AF>=U£ '-A <af>' o¸'--<af>'; deçuÉ: %s\n"), 
DFLT_AF
);

93 
	`årštf
(
¡d”r
, 
	`_
(" List of…ossible‡ddress families (which support„outing):\n"));

94 
	`´št_aæi¡
(1);

95 
	`ex™
(
E_USAGE
);

96 
	}
}

99 
	$v”siÚ
()

101 
	`årštf
(
¡d”r
, "%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
F—tu»s
);

102 
	`ex™
(
E_VERSION
);

103 
	}
}

106 
	$maš
(
¬gc
, **
¬gv
)

108 
i
, 
lİ
, 
wh©
 = 0;

109 
İtiÚ
 
lÚgİts
[] =

111 
AFTRANS_OPTS
,

121 {
NULL
, 0, 0, 0}

123 **
tmp
;

124 *
´ogÇme
;

125 
İtiÚs
;

126 #ià
I18N


127 
	`£oÿË
 (
LC_ALL
, "");

128 
	`bšd‹xtdomaš
("net-tools", "/usr/share/locale");

129 
	`‹xtdomaš
("net-tools");

131 
	`g‘rou‹_š™
();

132 
	`£Œou‹_š™
();

133 
aâame
[0] = '\0';

134 
´ogÇme
 = 
¬gv
[0];

137 
tmp
 = 
¬gv
; *tmp;mp++) {

138 ià(!
	`¡rcmp
(*
tmp
, "-net"))

139 
	`¡rıy
(*
tmp
, "#net");

140 ià(!
	`¡rcmp
(*
tmp
, "-host"))

141 
	`¡rıy
(*
tmp
, "#host");

145 (
i
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "A:eCFhnN64Vv?", 
lÚgİts
, &
lİ
)è!ğ
EOF
)

146 
i
) {

150 
İt_n
 |ğ
FLAG_NUM
;

153 
İt_n
 |ğ
FLAG_SYM
;

156 
İt_v
 |ğ
FLAG_VERBOSE
;

159 
İt_e
++;

162 ià(
lİ
 < 0 ||†İ >ğ
AFTRANS_CNT
) {

163 
	`EINTERN
("route.c", "longopts 1„ange");

166 ià((
i
 = 
	`aá¿ns_İt
(
lÚgİts
[
lİ
].
Çme
)))

167 
	`ex™
(
i
);

170 
İt_fc
 |ğ
FLAG_CACHE
;

173 
İt_fc
 |ğ
FLAG_FIB
;

176 ià((
i
 = 
	`aá¿ns_İt
(
İrg
)))

177 
	`ex™
(
i
);

180 ià((
i
 = 
	`aá¿ns_İt
("inet6")))

181 
	`ex™
(
i
);

184 ià((
i
 = 
	`aá¿ns_İt
("inet")))

185 
	`ex™
(
i
);

188 
	`v”siÚ
();

191 
İt_h
++;

194 
	`u§ge
();

197 
¬gv
 +ğ
İtšd
;

198 
¬gc
 -ğ
İtšd
;

200 ià(
İt_h
) {

201 ià(!
aâame
[0])

202 
	`u§ge
();

204 
wh©
 = 
RTACTION_HELP
;

206 ià(!
aâame
[0])

208 
	`aá¿ns_def
("rou‹", 
´ogÇme
, 
DFLT_AF
);

211 ià(*
¬gv
 =ğ
NULL
) {

212 
wh©
 = 
RTACTION_SHOW
;

214 ià(!
	`¡rcmp
(*
¬gv
, "add"))

215 
wh©
 = 
RTACTION_ADD
;

216 ià(!
	`¡rcmp
(*
¬gv
, "del") || !strcmp(*argv, "delete"))

217 
wh©
 = 
RTACTION_DEL
;

218 ià(!
	`¡rcmp
(*
¬gv
, "flush"))

219 
wh©
 = 
RTACTION_FLUSH
;

221 
	`u§ge
();

225 
İtiÚs
 = (
İt_e
 & 
FLAG_EXT
è| 
İt_n
 | 
İt_fc
 | 
İt_v
;

226 ià(!
İt_fc
)

227 
İtiÚs
 |ğ
FLAG_FIB
;

229 ià(
wh©
 =ğ
RTACTION_SHOW
)

230 
i
 = 
	`rou‹_šfo
(
aâame
, 
İtiÚs
);

232 
i
 = 
	`rou‹_ed™
(
wh©
, 
aâame
, 
İtiÚs
, ++
¬gv
);

234 ià(
i
 =ğ
E_OPTERR
)

235 
	`u§ge
();

237  (
i
);

238 
	}
}

	@interface/net-tools/slattach.c

31 
	~<sys/·¿m.h
>

32 
	~<sys/ty³s.h
>

33 
	~<sys/sock‘.h
>

34 
	~<sys/ioùl.h
>

35 
	~<sys/¡©.h
>

36 
	~<¡dio.h
>

37 
	~<ùy³.h
>

38 
	~<”ºo.h
>

39 
	~<fú.h
>

40 
	~<lim™s.h
>

41 
	~<pwd.h
>

42 
	~<sigÇl.h
>

43 
	~<¡dlib.h
>

44 
	~<¡ršg.h
>

45 
	~<uni¡d.h
>

46 
	~<g‘İt.h
>

47 
	~<lšux/if_¦.h
>

49 #ià
defšed
(
__GLIBC__
)

50 #ià
__GLIBC__
 =ğ2 && 
__GLIBC_MINOR__
 == 0

51 
	~<‹rmb™s.h
>

53 
	~<‹rmios.h
>

57 
	~"·thÇmes.h
"

58 
	~"Ãt-suµÜt.h
"

59 
	~"v”siÚ.h
"

60 
	~"cÚfig.h
"

61 
	~"š.h
"

62 
	~"ut.h
"

64 #iâdeà
_PATH_LOCKD


65 
	#_PATH_LOCKD
 "/v¬/lock"

	)

67 #iâdeà
_UID_UUCP


68 
	#_UID_UUCP
 "uuı"

	)

72 
	#DEF_PROTO
 "c¦"

	)

75 cÚ¡ *
	gR–—£
 = 
RELEASE
,

76 *
	gV”siÚ
 = "$Id: slattach.c,v 1.12 2009-09-06 22:59:43 vapier Exp $",

77 *
	gSigÇtu»
 = "net-tools, Fred N. van Kempenƒt‡l.";

81 cÚ¡ *
	m¥“d
;

82 
	mcode
;

83 } 
	g‰y_¥“ds
[] = {

84 { "50", 
B50
 }, { "75", 
B75
 },

85 { "110", 
B110
 }, { "300", 
B300
 },

86 { "600", 
B600
 }, { "1200", 
B1200
 },

87 { "2400", 
B2400
 }, { "4800", 
B4800
 },

88 { "9600", 
B9600
 },

89 #ifdeà
B14400


90 { "14400", 
B14400
 },

92 #ifdeà
B19200


93 { "19200", 
B19200
 },

95 #ifdeà
B38400


96 { "38400", 
B38400
 },

98 #ifdeà
B57600


99 { "57600", 
B57600
 },

101 #ifdeà
B115200


102 { "115200", 
B115200
 },

104 { 
NULL
, 0 }

106 
‹rmios
 
	g‰y_§ved
,

107 
	g‰y_cu¼’t
;

108 
	g‰y_sdisc
,

109 
	g‰y_ldisc
,

110 
	g‰y_fd
 = -1;

111 
	gİt_c
 = 0;

112 
	gİt_e
 = 0;

113 
	gİt_h
 = 0;

114 #ifdeà
SIOCSKEEPALIVE


115 
	gİt_k
 = 0;

117 
	gİt_l
 = 0;

118 
	gİt_L
 = 0;

119 
	gİt_m
 = 0;

120 
	gİt_n
 = 0;

121 #ifdeà
SIOCSOUTFILL


122 
	gİt_o
 = 0;

124 
	gİt_q
 = 0;

125 
	gİt_d
 = 0;

126 
	gİt_v
 = 0;

130 
	$‰y_nomesg
(
fd
)

132 ià(
İt_n
 == 0) (0);

133 (
	`fchmod
(
fd
, 0600));

134 
	}
}

138 
	$‰y_®»ady_locked
(*
Çm
)

140 
i
 = 0, 
pid
 = 0;

141 
FILE
 *
fd
 = (FILE *)0;

144 ià((
fd
 = 
	`fİ’
(
Çm
, "r")è=ğ(
FILE
 *)0)

150 
i
 = 
	`fsÿnf
(
fd
, "%d", &
pid
);

151 (è
	`fşo£
(
fd
);

153 ià(
i
 != 1)

157 ià(
	`kl
(
pid
, 0) == 0)

162 
	}
}

166 
	$‰y_lock
(*
·th
, 
mode
)

168 
§ved_·th
[
PATH_MAX
];

169 
§ved_lock
 = 0;

170 
·sswd
 *
pw
;

171 
fd
;

172 
­id
[16];

175 ià((
İt_l
 =ğ0è|| ((
·th
 =ğ
NULL
è&& (
§ved_lock
 == 0))) (0);

177 ià(
mode
 == 1) {

178 
	`¥rštf
(
§ved_·th
, "%s/LCK..%s", 
_PATH_LOCKD
, 
·th
);

179 ià(
	`‰y_®»ady_locked
(
§ved_·th
)) {

180 
	`årštf
(
¡d”r
, 
	`_
("¦©ch: /dev/% ®»ady†ocked!\n"), 
·th
);

183 ià((
fd
 = 
	`ü—t
(
§ved_·th
, 0644)) < 0) {

184 ià(
”ºo
 !ğ
EEXIST
)

185 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

186 
	`_
("slattach:ty_lock: (%s): %s\n"),

187 
§ved_·th
, 
	`¡»¼Ü
(
”ºo
));

190 
	`¥rštf
(
­id
, "%10d\n", 
	`g‘pid
());

191 ià(
	`wr™e
(
fd
, 
­id
, 
	`¡¾’
(apid)) != strlen(apid)) {

192 
	`årštf
(
¡d”r
, 
	`_
("slattach: cannot write PID file\n"));

193 
	`şo£
(
fd
);

194 
	`uÆšk
(
§ved_·th
);

199 ià((
pw
 = 
	`g‘pwÇm
(
_UID_UUCP
)è=ğ
NULL
) {

200 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_lock: UUCP user %s unknown!\n"),

201 
_UID_UUCP
);

202 (è
	`şo£
(
fd
);

205 (è
	`fchown
(
fd
, 
pw
->
pw_uid
,…w->
pw_gid
);

207 (è
	`şo£
(
fd
);

209 
§ved_lock
 = 1;

211 ià(
§ved_lock
 != 1) (0);

212 ià(
	`uÆšk
(
§ved_·th
) < 0) {

213 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

214 "¦©ch:ty_uÆock: (%s): %s\n", 
§ved_·th
,

215 
	`¡»¼Ü
(
”ºo
));

218 
§ved_lock
 = 0;

222 
	}
}

227 
	$‰y_fšd_¥“d
(cÚ¡ *
¥“d
)

229 
i
;

231 
i
 = 0;

232 
‰y_¥“ds
[
i
].
¥“d
 !ğ
NULL
) {

233 ià(!
	`¡rcmp
(
‰y_¥“ds
[
i
].
¥“d
, s³ed)èÑty_¥“ds[i].
code
);

234 
i
++;

236 (-
EINVAL
);

237 
	}
}

242 
	$‰y_£t_¡İb™s
(
‹rmios
 *
‰y
, *
¡İb™s
)

244 ià(
İt_d
è
	`´štf
("¦©ch:ty_£t_¡İb™s: %c\n", *
¡İb™s
);

245 *
¡İb™s
) {

247 
‰y
->
c_cæag
 &ğ~
CSTOPB
;

251 
‰y
->
c_cæag
 |ğ
CSTOPB
;

255 (-
EINVAL
);

258 
	}
}

263 
	$‰y_£t_d©ab™s
(
‹rmios
 *
‰y
, *
d©ab™s
)

265 ià(
İt_d
è
	`´štf
("¦©ch:ty_£t_d©ab™s: %c\n", *
d©ab™s
);

266 
‰y
->
c_cæag
 &ğ~
CSIZE
;

267 *
d©ab™s
) {

269 
‰y
->
c_cæag
 |ğ
CS5
;

273 
‰y
->
c_cæag
 |ğ
CS6
;

277 
‰y
->
c_cæag
 |ğ
CS7
;

281 
‰y
->
c_cæag
 |ğ
CS8
;

285 (-
EINVAL
);

288 
	}
}

293 
	$‰y_£t_·r™y
(
‹rmios
 *
‰y
, *
·r™y
)

295 ià(
İt_d
è
	`´štf
("¦©ch:ty_£t_·r™y: %c\n", *
·r™y
);

296 
	`touµ”
(*
·r™y
)) {

298 
‰y
->
c_cæag
 &ğ~(
PARENB
 | 
PARODD
);

302 
‰y
->
c_cæag
 &ğ~(
PARENB
 | 
PARODD
);

303 
‰y
->
c_cæag
 |ğ(
PARENB
 | 
PARODD
);

307 
‰y
->
c_cæag
 &ğ~(
PARENB
 | 
PARODD
);

308 
‰y
->
c_cæag
 |ğ(
PARENB
);

312 (-
EINVAL
);

315 
	}
}

320 
	$‰y_£t_¥“d
(
‹rmios
 *
‰y
, cÚ¡ *
¥“d
)

322 
code
;

324 ià(
İt_d
è
	`´štf
("¦©ch:ty_£t_¥“d: %s\n", 
¥“d
);

325 ià((
code
 = 
	`‰y_fšd_¥“d
(
¥“d
)) < 0) (code);

326 
‰y
->
c_cæag
 &ğ~
CBAUD
;

327 
‰y
->
c_cæag
 |ğ
code
;

329 
	}
}

334 
	$‰y_£t_¿w
(
‹rmios
 *
‰y
)

336 
i
;

337 
¥“d
;

339 
i
 = 0; i < 
NCCS
; i++)

340 
‰y
->
c_cc
[
i
] = '\0';

341 
‰y
->
c_cc
[
VMIN
] = 1;

342 
‰y
->
c_cc
[
VTIME
] = 0;

343 
‰y
->
c_iæag
 = (
IGNBRK
 | 
IGNPAR
);

344 
‰y
->
c_oæag
 = (0);

345 
‰y
->
c_læag
 = (0);

346 
¥“d
 = (
‰y
->
c_cæag
 & 
CBAUD
);

347 
‰y
->
c_cæag
 = (
HUPCL
 | 
CREAD
);

348 ià(
İt_L
)

349 
‰y
->
c_cæag
 |ğ
CLOCAL
;

351 
‰y
->
c_cæag
 |ğ
CRTSCTS
;

352 
‰y
->
c_cæag
 |ğ
¥“d
;

354 
	}
}

359 
	$‰y_g‘_¡©e
(
‹rmios
 *
‰y
)

361 ià(
	`ioùl
(
‰y_fd
, 
TCGETS
, 
‰y
) < 0) {

362 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

363 "¦©ch:ty_g‘_¡©e: %s\n", 
	`¡»¼Ü
(
”ºo
));

364 (-
”ºo
);

367 
	}
}

372 
	$‰y_£t_¡©e
(
‹rmios
 *
‰y
)

374 ià(
	`ioùl
(
‰y_fd
, 
TCSETS
, 
‰y
) < 0) {

375 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

376 "¦©ch:ty_£t_¡©e: %s\n", 
	`¡»¼Ü
(
”ºo
));

377 (-
”ºo
);

380 
	}
}

385 
	$‰y_g‘_disc
(*
disc
)

387 ià(
	`ioùl
(
‰y_fd
, 
TIOCGETD
, 
disc
) < 0) {

388 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

389 "¦©ch:ty_g‘_disc: %s\n", 
	`¡»¼Ü
(
”ºo
));

390 (-
”ºo
);

393 
	}
}

398 
	$‰y_£t_disc
(
disc
)

400 ià(
disc
 =ğ-1èdisøğ
‰y_sdisc
;

402 ià(
	`ioùl
(
‰y_fd
, 
TIOCSETD
, &
disc
) < 0) {

403 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

404 "¦©ch:ty_£t_disc(%d, %d): %s\n", 
‰y_fd
,

405 
disc
, 
	`¡»¼Ü
(
”ºo
));

406 (-
”ºo
);

409 
	}
}

414 
	$‰y_g‘_Çme
(*
Çme
)

416 ià(
	`ioùl
(
‰y_fd
, 
SIOCGIFNAME
, 
Çme
) < 0) {

417 ià(
İt_q
 == 0)

418 
	`³¼Ü
("tty_get_name");

419 (-
”ºo
);

422 
	}
}

427 
	$‰y_hªgup
()

429 
‹rmios
 
‰y
;

431 
‰y
 = 
‰y_cu¼’t
;

432 (è
	`‰y_£t_¥“d
(&
‰y
, "0");

433 ià(
	`‰y_£t_¡©e
(&
‰y
) < 0) {

434 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("¦©ch:ty_hªgup(DROP): %s\n"), 
	`¡»¼Ü
(
”ºo
));

435 (-
”ºo
);

438 (è
	`¦“p
(1);

440 ià(
	`‰y_£t_¡©e
(&
‰y_cu¼’t
) < 0) {

441 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("¦©ch:ty_hªgup(RAISE): %s\n"), 
	`¡»¼Ü
(
”ºo
));

442 (-
”ºo
);

445 
	}
}

450 
	$‰y_şo£
()

452 (è
	`‰y_£t_disc
(
‰y_sdisc
);

453 (è
	`‰y_hªgup
();

454 (è
	`‰y_lock
(
NULL
, 0);

456 
	}
}

461 
	$‰y_İ’
(*
Çme
, cÚ¡ *
¥“d
)

463 
·thbuf
[
PATH_MAX
];

464 *
·th_İ’
, *
·th_lock
;

465 
fd
;

468 ià(
Çme
 !ğ
NULL
) {

469 ià(
Çme
[0] != '/') {

470 ià(
	`¡¾’
(
Çme
 + 6è> (
·thbuf
)) {

471 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

472 
	`_
("slattach:ty‚ameoo†ong\n"));

475 
	`¥rštf
(
·thbuf
, "/dev/%s", 
Çme
);

476 
·th_İ’
 = 
·thbuf
;

477 
·th_lock
 = 
Çme
;

478 } ià(!
	`¡ºcmp
(
Çme
, "/dev/", 5)) {

479 
·th_İ’
 = 
Çme
;

480 
·th_lock
 = 
Çme
 + 5;

482 
·th_İ’
 = 
Çme
;

483 
·th_lock
 = 
Çme
;

485 ià(
İt_d
è
	`´štf
("slattach:ty_open:†ooking for†ock\n");

486 ià(
	`‰y_lock
(
·th_lock
, 1)) (-1);

487 ià(
İt_d
è
	`´štf
("¦©ch:ty_İ’:ryšgØİ’ %s\n", 
·th_İ’
);

488 ià((
fd
 = 
	`İ’
(
·th_İ’
, 
O_RDWR
|
O_NDELAY
)) < 0) {

489 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
,

491 
·th_İ’
, 
	`¡»¼Ü
(
”ºo
));

492 (-
”ºo
);

494 
‰y_fd
 = 
fd
;

495 ià(
İt_d
è
	`´štf
("¦©ch:ty_İ’: % (fd=%dè", 
·th_İ’
, 
fd
);

497 
‰y_fd
 = 0;

501 ià(
	`‰y_g‘_¡©e
(&
‰y_§ved
) < 0) {

502 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_open: cannot get current state!\n"));

503 (-
”ºo
);

505 
‰y_cu¼’t
 = 
‰y_§ved
;

508 ià(
	`‰y_g‘_disc
(&
‰y_sdisc
) < 0) {

509 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_open: cannot get current†ine disc!\n"));

510 (-
”ºo
);

512 
‰y_ldisc
 = 
‰y_sdisc
;

515 ià(
İt_m
 == 0) {

516 ià(
	`‰y_£t_¿w
(&
‰y_cu¼’t
) < 0) {

517 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_open: cannot set RAW mode!\n"));

518 (-
”ºo
);

522 ià(
¥“d
 !ğ
NULL
) {

523 ià(
	`‰y_£t_¥“d
(&
‰y_cu¼’t
, 
¥“d
) != 0) {

524 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_open: cannot set %s bps!\n"),

525 
¥“d
);

526 (-
”ºo
);

531 ià(
	`‰y_£t_d©ab™s
(&
‰y_cu¼’t
, "8") ||

532 
	`‰y_£t_¡İb™s
(&
‰y_cu¼’t
, "1") ||

533 
	`‰y_£t_·r™y
(&
‰y_cu¼’t
, "N")) {

534 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach:ty_open: cannot set 8N1 mode!\n"));

535 (-
”ºo
);

539 ià((
fd
 = 
	`‰y_£t_¡©e
(&
‰y_cu¼’t
)) < 0) (fd);

543 (è
	`‰y_nomesg
(
‰y_fd
);

546 
	}
}

551 
	$sig_ÿtch
(
sig
)

554 
	`‰y_şo£
();

555 
	`ex™
(0);

556 
	}
}

560 
	$u§ge
()

562 *
u§ge_msg
 = "Usage: slattach [-ehlLmnqv] "

563 #ifdeà
SIOCSKEEPALIVE


566 #ifdeà
SIOCSOUTFILL


572 
	`årštf
(
¡d”r
, 
u§ge_msg
);

573 
	`ex™
(1);

574 
	}
}

578 
	$v”siÚ
()

580 
	`´štf
("%s\n%s\n%s\n", 
R–—£
, 
V”siÚ
, 
SigÇtu»
);

581 
	`ex™
(
E_VERSION
);

582 
	}
}

586 
	$maš
(
¬gc
, *
¬gv
[])

588 
·th_buf
[128];

589 *
·th_dev
;

590 
buff
[128];

591 cÚ¡ *
¥“d
 = 
NULL
;

592 cÚ¡ *
´Ùo
 = 
DEF_PROTO
;

593 cÚ¡ *
extcmd
 = 
NULL
;

594 
s
;

595 
İtiÚ
 
lÚgİts
[] = {

596 { "v”siÚ", 0, 
NULL
, 'V' },

597 { 
NULL
, 0, NULL, 0 }

600 
	`¡rıy
(
·th_buf
, "");

601 
·th_dev
 = 
·th_buf
;

604 
İ‹¼
 = 0;

605 (
s
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "c:ehlLmÅ:qs:vdVk:o:", 
lÚgİts
, 
NULL
)è!ğ
EOF
) s) {

607 
extcmd
 = 
İrg
;

611 
İt_e
 = 1 - opt_e;

615 
İt_h
 = 1 - opt_h;

618 #ifdeà
SIOCSKEEPALIVE


620 
İt_k
 = 
	`©oi
(
İrg
);

625 
İt_L
 = 1 - opt_L;

629 
İt_l
 = 1 - opt_l;

633 
İt_m
 = 1 - opt_m;

637 
İt_n
 = 1 - opt_n;

640 #ifdeà
SIOCSOUTFILL


642 
İt_o
 = 
	`©oi
(
İrg
);

647 
´Ùo
 = 
İrg
;

651 
İt_q
 = 1 - opt_q;

655 
¥“d
 = 
İrg
;

659 
İt_d
 = 1 - opt_d;

663 
İt_v
 = 1 - opt_v;

667 
	`v”siÚ
();

671 
	`u§ge
();

675 ià(
	`£tvbuf
(
¡dout
,0,
_IOLBF
,0)) {

676 ià(
İt_q
 =ğ0è
	`årštf
(
¡d”r
, 
	`_
("slattach: setvbuf(stdout,0,_IOLBF,0) : %s\n"),

677 
	`¡»¼Ü
(
”ºo
));

678 
	`ex™
(1);

681 
	`aùiv©e_š™
();

683 ià(!
	`¡rcmp
(
´Ùo
, "tty"))

684 
İt_m
++;

687 ià(
İtšd
 !ğ(
¬gc
 - 1)è
	`u§ge
();

688 
	`§ã_¡ºıy
(
·th_buf
, 
¬gv
[
İtšd
], (path_buf));

689 ià(!
	`¡rcmp
(
·th_buf
, "-")) {

690 
İt_e
 = 1;

691 
·th_dev
 = 
NULL
;

692 ià(
	`‰y_İ’
(
NULL
, 
¥“d
) < 0) { (3); }

694 
·th_dev
 = 
·th_buf
;

695 ià(
	`‰y_İ’
(
·th_dev
, 
¥“d
) < 0) { (3); }

699 ià(!
	`¡rcmp
(
´Ùo
, "tty")) {

700 
‰y_sdisc
 = 
N_TTY
;

701 
	`‰y_şo£
();

704 ià(
	`aùiv©e_ld
(
´Ùo
, 
‰y_fd
))

706 ià((
İt_v
 =ğ1è|| (
İt_d
 == 1)) {

707 ià(
	`‰y_g‘_Çme
(
buff
)) { (3); }

708 
	`´štf
(
	`_
("% ¡¬‹d"), 
´Ùo
);

709 ià(
·th_dev
 !ğ
NULL
è
	`´štf
(
	`_
(" on %s"),…ath_dev);

710 
	`´štf
(
	`_
(" iÁ”çû %s\n"), 
buff
);

714 #ifdeà
SIOCSKEEPALIVE


715 ià(
İt_k
 && (
	`ioùl
(
‰y_fd
, 
SIOCSKEEPALIVE
, &opt_k) < 0))

716 
	`årštf
(
¡d”r
, "¦©ch: ioùl(SIOCSKEEPALIVE): %s\n", 
	`¡»¼Ü
(
”ºo
));

718 #ifdeà
SIOCSOUTFILL


719 ià(
İt_o
 && (
	`ioùl
(
‰y_fd
, 
SIOCSOUTFILL
, &opt_o) < 0))

720 
	`årštf
(
¡d”r
, "¦©ch: ioùl(SIOCSOUTFILL): %s\n", 
	`¡»¼Ü
(
”ºo
));

723 (è
	`sigÇl
(
SIGHUP
, 
sig_ÿtch
);

724 (è
	`sigÇl
(
SIGINT
, 
sig_ÿtch
);

725 (è
	`sigÇl
(
SIGQUIT
, 
sig_ÿtch
);

726 (è
	`sigÇl
(
SIGTERM
, 
sig_ÿtch
);

729 ià(
İt_e
 == 0) {

731 if(
İt_h
 == 1) {

732 
n
 = 0;

734 
	`ioùl
(
‰y_fd
, 
TIOCMGET
, &
n
);

735 if(!(
n
 & 
TIOCM_CAR
))

737 
	`¦“p
(15);

740 
	`¦“p
(60);

743 
	`‰y_şo£
();

744 if(
extcmd
)

745 
	`sy¡em
(
extcmd
);

747 
	`ex™
(0);

748 
	}
}

	@interface/net-tools/statistics.c

8 
	~<ùy³.h
>

9 
	~<¡dio.h
>

10 
	~<¡dlib.h
>

11 
	~<¡ršg.h
>

12 
	~"cÚfig.h
"

13 
	~"š.h
"

14 
	~"´oc.h
"

18 #ifdeà
WARN


19 
	#UFWARN
(
x
è
	)
x

21 
	#UFWARN
(
x
)

	)

24 
	g´št_¡©ic
,
	gf_¿w
,
	gf_tı
,
	gf_udp
,
	gf_unknown
 = 1;

26 
	eS‹
 {

27 
	mnumb”
 = 0, 
	mİt_numb”
, 
	mi_fÜw¬d
, 
	mi_šp_icmp
, 
	mi_ou_icmp
, 
	mi_¹o_®g
,

28 
	mMaxS‹


31 
	#nÜm®
 
numb”


	)

33 
	s’Œy
 {

34 *
	mt™Ë
;

35 *
	mout
;

36 
S‹
 
	mty³
;

39 
	s¡©edesc
 {

40 
	mšd’t
;

41 *
	mt™Ë
;

44 
¡©edesc
 
	g¡©es
[] = {

45 [
numb”
] = { 4, 
NULL
 },

46 [
İt_numb”
] = { 4, 
NULL
 },

47 [
i_fÜw¬d
] = { 4, 
NULL
 },

48 [
i_šp_icmp
] = { 8, 
N_
("ICMP input histogram:") },

49 [
i_ou_icmp
] = { 8, 
N_
("ICMP output histogram:") },

50 [
MaxS‹
] = {0},

53 
S‹
 
	g¡©e
;

55 
	#I_STATIC
 (1<<16è

	)

56 
	#I_TITLE
 (1<<17)

	)

64 
’Œy
 
	gI±ab
[] =

66 {"FÜw¬dšg", 
N_
("FÜw¬dšg i %s"), 
i_fÜw¬d
 | 
I_STATIC
},

67 {"DeçuÉTTL", 
N_
("DeçuÉ TTL i %u"), 
numb”
 | 
I_STATIC
},

68 {"InReûives", 
N_
("%uÙ®…ack‘ »ûived"), 
numb”
},

69 {"InHdrE¼Üs", 
N_
("%u w™h inv®id h—d”s"), 
İt_numb”
},

70 {"InAddrE¼Üs", 
N_
("%u w™h inv®id‡dd»s£s"), 
İt_numb”
},

71 {"FÜwD©ag¿ms", 
N_
("%u fÜw¬ded"), 
numb”
},

72 {"InUnknownPrÙos", 
N_
("%u w™h unknowÀ´ÙocŞ"), 
İt_numb”
},

73 {"InDisÿrds", 
N_
("%u incomšg…ack‘ disÿrded"), 
numb”
},

74 {"InD–iv”s", 
N_
("%u incomšg…ack‘ d–iv”ed"), 
numb”
},

75 {"OutReque¡s", 
N_
("%u„eque¡ £Á out"), 
numb”
},

76 {"OutDisÿrds", 
N_
("%u outgošg…ack‘ drİ³d"), 
İt_numb”
},

77 {"OutNoRou‹s", 
N_
("%u drİ³d beÿu£ oàmissšg„ou‹"), 
İt_numb”
},

78 {"R—smTimeout", 
N_
("%u f¿gm’t drİ³d‡á”imeout"), 
İt_numb”
},

79 {"R—smReqds", 
N_
("%u„—s£mbl› »quœed"), 
İt_numb”
},

80 {"R—smOKs", 
N_
("%u…ack‘ »as£mbËd ok"), 
İt_numb”
},

81 {"R—smFas", 
N_
("%u…ack‘„—s£mbË çed"), 
İt_numb”
},

82 {"F¿gOKs", 
N_
("%u f¿gm’t »ûived ok"), 
İt_numb”
},

83 {"F¿gFas", 
N_
("%u f¿gm’t çed"), 
İt_numb”
},

84 {"F¿gC»©es", 
N_
("%u f¿gm’t ü—‹d"), 
İt_numb”
}

87 
’Œy
 
	gIp6b
[] =

89 {"Ip6InReûives", 
N_
("%uÙ®…ack‘ »ûived"), 
numb”
},

90 {"Ip6InHdrE¼Üs", 
N_
("%u w™h inv®id h—d”s"), 
İt_numb”
},

91 {"Ip6InTooBigE¼Üs", 
N_
("%u w™h…ack‘ toØbig"), 
İt_numb”
},

92 {"Ip6InNoRou‹s", 
N_
("%u incomšg…ack‘ w™h‚Ørou‹"), 
İt_numb”
},

93 {"Ip6InAddrE¼Üs", 
N_
("%u w™h inv®id‡dd»s£s"), 
İt_numb”
},

94 {"Ip6InUnknownPrÙos", 
N_
("%u w™h unknowÀ´ÙocŞ"), 
İt_numb”
},

95 {"Ip6InTrunÿ‹dPkts", 
N_
("%u w™hrunÿ‹d…ack‘s"), 
İt_numb”
},

96 {"Ip6InDisÿrds", 
N_
("%u incomšg…ack‘ disÿrded"), 
numb”
},

97 {"Ip6InD–iv”s", 
N_
("%u incomšg…ack‘ d–iv”ed"), 
numb”
},

98 {"Ip6OutFÜwD©ag¿ms", 
N_
("%u fÜw¬ded"), 
numb”
},

99 {"Ip6OutReque¡s", 
N_
("%u„eque¡ £Á out"), 
numb”
},

100 {"Ip6OutDisÿrds", 
N_
("%u outgošg…ack‘ drİ³d"), 
İt_numb”
},

101 {"Ip6OutNoRou‹s", 
N_
("%u drİ³d beÿu£ oàmissšg„ou‹"), 
İt_numb”
},

102 {"Ip6R—smTimeout", 
N_
("%u f¿gm’t drİ³d‡á”imeout"), 
İt_numb”
},

103 {"Ip6R—smReqds", 
N_
("%u„—s£mbl› »quœed"), 
İt_numb”
},

104 {"Ip6R—smOKs", 
N_
("%u…ack‘ »as£mbËd ok"), 
İt_numb”
},

105 {"Ip6R—smFas", 
N_
("%u…ack‘„—s£mbË çed"), 
İt_numb”
},

106 {"Ip6F¿gOKs", 
N_
("%u f¿gm’t »ûived ok"), 
İt_numb”
},

107 {"Ip6F¿gFas", 
N_
("%u f¿gm’t çed"), 
İt_numb”
},

108 {"Ip6F¿gC»©es", 
N_
("%u f¿gm’t ü—‹d"), 
İt_numb”
},

109 {"Ip6InMÿ¡Pkts", 
N_
("%u incomšg muÉiÿ¡…ack‘s"), 
İt_numb”
},

110 {"Ip6OutMÿ¡Pkts", 
N_
("%u outgošg muÉiÿ¡…ack‘s"), 
İt_numb”
}

113 
’Œy
 
	gIcm±ab
[] =

115 {"InMsgs", 
N_
("%u ICMP mes§ge »ûived"), 
numb”
},

116 {"InE¼Üs", 
N_
("%u iÅuˆICMP mes§gçed."), 
numb”
},

117 {"InDe¡UÄ—chs", 
N_
("de¡š©iÚ uÄ—chabË: %u"), 
i_šp_icmp
 | 
I_TITLE
},

118 {"InTimeExcds", 
N_
("timeouˆš¿ns™: %u"), 
i_šp_icmp
 | 
I_TITLE
},

119 {"InP¬mProbs", 
N_
("wrÚg…¬am‘”s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

120 {"InSrcQu’chs", 
N_
("sourû qu’ches: %u"), 
i_šp_icmp
 | 
I_TITLE
},

121 {"InRedœeùs", 
N_
("»dœeùs: %u"), 
i_šp_icmp
 | 
I_TITLE
},

122 {"InEchos", 
N_
("echØ»que¡s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

123 {"InEchoR•s", 
N_
("echØ»¶›s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

124 {"InTime¡amps", 
N_
("time¡am°»que¡: %u"), 
i_šp_icmp
 | 
I_TITLE
},

125 {"InTime¡ampR•s", 
N_
("time¡am°»¶y: %u"), 
i_šp_icmp
 | 
I_TITLE
},

126 {"InAddrMasks", 
N_
("add»s mask„eque¡: %u"), 
i_šp_icmp
 | 
I_TITLE
},

127 {"InAddrMaskR•s", 
N_
("add»s mask„•l›s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

128 {"OutMsgs", 
N_
("%u ICMP mes§ge £Á"), 
numb”
},

129 {"OutE¼Üs", 
N_
("%u ICMP mes§ge çed"), 
numb”
},

130 {"OutDe¡UÄ—chs", 
N_
("de¡š©iÚ uÄ—chabË: %u"), 
i_ou_icmp
 | 
I_TITLE
},

131 {"OutTimeExcds", 
N_
("timexûeded: %u"), 
i_ou_icmp
 | 
I_TITLE
},

132 {"OutP¬mProbs", 
N_
("wrÚg…¬am‘”s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

133 {"OutSrcQu’chs", 
N_
("sourû qu’ch: %u"), 
i_ou_icmp
 | 
I_TITLE
},

134 {"OutRedœeùs", 
N_
("»dœeù: %u"), 
i_ou_icmp
 | 
I_TITLE
},

135 {"OutEchos", 
N_
("echØ»que¡: %u"), 
i_ou_icmp
 | 
I_TITLE
},

136 {"OutEchoR•s", 
N_
("echØ»¶›s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

137 {"OutTime¡amps", 
N_
("time¡am°»que¡s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

138 {"OutTime¡ampR•s", 
N_
("time¡am°»¶›s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

139 {"OutAddrMasks", 
N_
("add»s mask„eque¡s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

140 {"OutAddrMaskR•s", 
N_
("add»s mask„•l›s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

143 
’Œy
 
	gIcmp6b
[] =

145 {"Icmp6InMsgs", 
N_
("%u ICMP mes§ge »ûived"), 
numb”
},

146 {"Icmp6InE¼Üs", 
N_
("%u iÅuˆICMP mes§gçed."), 
numb”
},

147 {"Icmp6InDe¡UÄ—chs", 
N_
("de¡š©iÚ uÄ—chabË: %u"), 
i_šp_icmp
 | 
I_TITLE
},

148 {"Icmp6InPktTooBigs", 
N_
("·ck‘ toØbig: %u"), 
i_šp_icmp
 | 
I_TITLE
},

149 {"Icmp6InTimeExcds", 
N_
("»ûived ICMPv6imexûeded: %u"), 
i_šp_icmp
 | 
I_TITLE
},

150 {"Icmp6InP¬mProbËms", 
N_
("·¿m‘”…robËm: %u"), 
i_šp_icmp
 | 
I_TITLE
},

151 {"Icmp6InEchos", 
N_
("echØ»que¡s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

152 {"Icmp6InEchoR•l›s", 
N_
("echØ»¶›s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

153 {"Icmp6InGroupMembQu”›s", 
N_
("grou°memb” qu”›s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

154 {"Icmp6InGroupMembRe¥Ú£s", 
N_
("grou°memb”„e¥Ú£s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

155 {"Icmp6InGroupMembReduùiÚs", 
N_
("grou°memb”„eduùiÚs: %u"), 
i_šp_icmp
 | 
I_TITLE
},

156 {"Icmp6InRou‹rSŞic™s", 
N_
("rou‹¸sŞic™s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

157 {"Icmp6InRou‹rAdv”ti£m’ts", 
N_
("rou‹¸adv”ti£m’t: %u"), 
i_šp_icmp
 | 
I_TITLE
},

158 {"Icmp6InNeighbÜSŞic™s", 
N_
("Ãighbou¸sŞic™s: %u"), 
i_šp_icmp
 | 
I_TITLE
},

159 {"Icmp6InNeighbÜAdv”ti£m’ts", 
N_
("Ãighbou¸adv”ti£m’t: %u"), 
i_šp_icmp
 | 
I_TITLE
},

160 {"Icmp6InRedœeùs", 
N_
("»dœeùs: %u"), 
i_šp_icmp
 | 
I_TITLE
},

161 {"Icmp6OutMsgs", 
N_
("%u ICMP mes§ge £Á"), 
numb”
},

162 {"Icmp6OutDe¡UÄ—chs", 
N_
("de¡š©iÚ uÄ—chabË: %u"), 
i_ou_icmp
 | 
I_TITLE
},

163 {"Icmp6OutPktTooBigs", 
N_
("·ck‘ toØbig: %u"), 
i_ou_icmp
 | 
I_TITLE
},

164 {"Icmp6OutTimeExcds", 
N_
("£Á ICMPv6imexûeded: %u"), 
i_ou_icmp
 | 
I_TITLE
},

165 {"Icmp6OutP¬mProbËms", 
N_
("·¿m‘”…robËm: %u"), 
i_ou_icmp
 | 
I_TITLE
},

166 {"Icmp6OutEchos", 
N_
("echØ»que¡s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

167 {"Icmp6OutEchoR•l›s", 
N_
("echØ»¶›s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

168 {"Icmp6OutGroupMembQu”›s", 
N_
("grou°memb” qu”›s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

169 {"Icmp6OutGroupMembRe¥Ú£s", 
N_
("grou°memb”„e¥Ú£s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

170 {"Icmp6OutGroupMembReduùiÚs", 
N_
("grou°memb”„eduùiÚs: %u"), 
i_ou_icmp
 | 
I_TITLE
},

171 {"Icmp6OutRou‹rSŞic™s", 
N_
("rou‹¸sŞic™s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

172 {"Icmp6OutRou‹rAdv”ti£m’t ", 
N_
("rou‹¸adv”ti£m’t: %u"), 
i_ou_icmp
 | 
I_TITLE
},

173 {"Icmp6OutNeighbÜSŞic™s", 
N_
("ÃighbÜ sŞic™s: %u"), 
i_ou_icmp
 | 
I_TITLE
},

174 {"Icmp6OutNeighbÜAdv”ti£m’ts", 
N_
("ÃighbÜ‡dv”ti£m’ts: %u"), 
i_ou_icmp
 | 
I_TITLE
},

175 {"Icmp6OutRedœeùs", 
N_
("»dœeùs: %u"), 
i_ou_icmp
 | 
I_TITLE
},

178 
’Œy
 
	gTıb
[] =

180 {"RtoAlgÜ™hm", 
N_
("RTO‡lgÜ™hm i %s"), 
i_¹o_®g
 | 
I_STATIC
},

181 {"RtoMš", "", 
numb”
},

182 {"RtoMax", "", 
numb”
},

183 {"MaxCÚn", "", 
numb”
},

184 {"AùiveO³ns", 
N_
("%u‡ùivcÚÃùiÚ İ’šgs"), 
numb”
},

185 {"PassiveO³ns", 
N_
("%u…assivcÚÃùiÚ o³nšgs"), 
numb”
},

186 {"A‰em±Fas", 
N_
("%u faed cÚÃùiÚ‡‰em±s"), 
numb”
},

187 {"E¡abRe£ts", 
N_
("%u cÚÃùiÚ„e£t »ûived"), 
numb”
},

188 {"Cu¼E¡ab", 
N_
("%u cÚÃùiÚ e¡ablished"), 
numb”
},

189 {"InSegs", 
N_
("%u segm’t »ûived"), 
numb”
},

190 {"OutSegs", 
N_
("%u segm’t £nd out"), 
numb”
},

191 {"R‘¿nsSegs", 
N_
("%u segm’t »Œªsm™ed"), 
numb”
},

192 {"InE¼s", 
N_
("%u bad segm’t »ûived."), 
numb”
},

193 {"OutR¡s", 
N_
("%u„e£t £Á"), 
numb”
},

196 
’Œy
 
	gUd±ab
[] =

198 {"InD©ag¿ms", 
N_
("%u…ack‘ »ûived"), 
numb”
},

199 {"NoPÜts", 
N_
("%u…ack‘ tØunknowÀpÜˆ»ûived."), 
numb”
},

200 {"InE¼Üs", 
N_
("%u…ack‘„eûiv”rÜs"), 
numb”
},

201 {"OutD©ag¿ms", 
N_
("%u…ack‘ £Á"), 
numb”
},

204 
’Œy
 
	gUdp6b
[] =

206 {"Udp6InD©ag¿ms", 
N_
("%u…ack‘ »ûived"), 
numb”
},

207 {"Udp6NoPÜts", 
N_
("%u…ack‘ tØunknowÀpÜˆ»ûived."), 
numb”
},

208 {"Udp6InE¼Üs", 
N_
("%u…ack‘„eûiv”rÜs"), 
numb”
},

209 {"Udp6OutD©ag¿ms", 
N_
("%u…ack‘ £Á"), 
numb”
},

212 
’Œy
 
	gTıex‰ab
[] =

214 {"Syncook›sS’t", 
N_
("%u SYN cook› £Á"), 
İt_numb”
},

215 {"Syncook›sRecv", 
N_
("%u SYN cook› »ûived"), 
İt_numb”
},

216 {"Syncook›sFaed", 
N_
("%u inv®id SYN cook› »ûived"), 
İt_numb”
},

218 { "EmbryÚicR¡s", 
N_
("%u„esets„eceived forƒmbryonic SYN_RECV sockets"),

219 
İt_numb”
 },

220 { "PruÃC®Ëd", 
N_
("%u…ackets…runed from„eceive queue because of socket"

221 " bufã¸ov”run"), 
İt_numb”
 },

223 { "RcvPruÃd", 
N_
("%u…ack‘ ´uÃd from„eûivqueue"), 
İt_numb”
 },

224 { "OfoPruÃd", 
N_
("%u…ackets dropped from out-of-order queue because of"

225 " sock‘ bufã¸ov”run"), 
İt_numb”
 },

226 { "OutOfWšdowIcmps", 
N_
("%u ICMP…ackets dropped becausehey were "

227 "out-of-wšdow"), 
İt_numb”
 },

228 { "LockDrİ³dIcmps", 
N_
("%u ICMP…ackets dropped because"

229 " sock‘ wa locked"), 
İt_numb”
 },

230 { "TW", 
N_
("%u TCP sock‘ fšishedimwa™ iÀç¡im”"), 
İt_numb”
 },

231 { "TWRecyşed", 
N_
("%uimwa™ sock‘ »cyşed byim¡amp"), 
İt_numb”
 },

232 { "TWKËd", 
N_
("%u TCP sock‘ fšishedimwa™ iÀ¦owim”"), 
İt_numb”
 },

233 { "PAWSPassive", 
N_
("%u…assive connections„ejected because of"

234 "im¡amp"), 
İt_numb”
 },

235 { "PAWSAùive", 
N_
("%u‡ctive connections„ejected because of "

236 "tim¡amp"), 
İt_numb”
 },

237 { "PAWSE¡ab", 
N_
("%u…ackets„ejects inƒstablished connections because of"

238 "ime¡amp"), 
İt_numb”
 },

239 { "D–ayedACKs", 
N_
("%u d–ayed‡ck £Á"), 
İt_numb”
 },

240 { "D–ayedACKLocked", 
N_
("%u delayed‡cks further delayed because of"

241 "†ocked sock‘"), 
İt_numb”
 },

242 { "D–ayedACKLo¡", 
N_
("Quick‡ck modwa aùiv©ed %uimes"), 
İt_numb”
 },

243 { "Li¡’Ov”æows", 
N_
("%uimeshe†isten queue of‡ socket overflowed"),

244 
İt_numb”
 },

245 { "Li¡’Drİs", 
N_
("%u SYN tØLISTEN sock‘ drİ³d"), 
İt_numb”
 },

246 { "TCPP»queued", 
N_
("%u…ackets directly queuedo„ecvmsg…requeue."),

247 
İt_numb”
 },

248 { "TCPDœeùCİyFromBacklog", 
N_
("%u by‹ dœeùly iÀ´oûs cÚ‹xˆäom backlog"), 
İt_numb”
 },

249 { "TCPDœeùCİyFromP»queue", 
N_
("%u bytes directly„eceived in…rocess context from…requeue"),

250 
İt_numb”
 },

251 { "TCPP»queueDrİ³d", 
N_
("%u…ack‘ drİ³d from…»queue"), 
İt_numb”
 },

252 { "TCPHPH™s", 
N_
("%u…ack‘ h—d” ´ediùed"), 
numb”
 },

253 { "TCPHPH™sToU£r", 
N_
("%u…ackets header…redicted‡nd "

254 "dœeùly queuedØu£r"), 
İt_numb”
 },

255 { "SockM®locOOM", 
N_
("Ran %uimes out of system memory during "

256 "·ck‘ s’dšg"), 
İt_numb”
 },

257 { "TCPPu»Acks", 
N_
("%u‡cknowËdgm’t nÙ cÚššg d©¨·ylßd„eûived"), 
İt_numb”
 },

258 { "TCPHPAcks", 
N_
("%u…»diùed‡cknowËdgm’ts"), 
İt_numb”
 },

259 { "TCPR’oRecov”y", 
N_
("%uime »cov”ed from…ack‘†os dutØç¡„‘¿nsm™"), 
İt_numb”
 },

260 { "TCPSackRecov”y", 
N_
("%uime »cov”ed from…ack‘†os by s–eùivacknowËdgem’ts"), 
İt_numb”
 },

261 { "TCPSACKR’egšg", 
N_
("%u bad SACK block »ûived"), 
İt_numb”
 },

262 { "TCPFACKReÜd”", 
N_
("D‘eùed„eÜd”šg %uime usšg FACK"), 
İt_numb”
 },

263 { "TCPSACKReÜd”", 
N_
("D‘eùed„eÜd”šg %uime usšg SACK"), 
İt_numb”
 },

264 { "TCPTSReÜd”", 
N_
("D‘eùed„eÜd”šg %uime usšgim¡amp"), 
İt_numb”
 },

265 { "TCPR’oReÜd”", 
N_
("D‘eùed„eÜd”šg %uime usšg„’Øç¡„‘¿nsm™"), 
İt_numb”
 },

266 { "TCPFuÎUndo", 
N_
("%u cÚge¡iÚ wšdow fuÎy„ecov”ed w™houˆ¦ow s¹"), 
İt_numb”
 },

267 { "TCPP¬tŸlUndo", 
N_
("%u cÚge¡iÚ wšdow ·¹ŸÎy„ecov”ed usšg HÛ heuri¡ic"), 
İt_numb”
 },

268 { "TCPDSackUndo", 
N_
("%u cÚge¡iÚ wšdow„ecov”ed w™houˆ¦ow s¹ usšg DSACK"), 
İt_numb”
 },

269 { "TCPLossUndo", 
N_
("%u cÚge¡iÚ wšdow »cov”ed w™houˆ¦ow s¹‡á”…¬tŸÈack"), 
İt_numb”
 },

270 { "TCPLo¡R‘¿nsm™s", 
N_
("%u„‘¿nsm™ lo¡"), 
İt_numb”
 },

271 { "TCPR’oFau»s", 
N_
("%uimeout aá”„’Øç¡„‘¿nsm™"), 
İt_numb”
 },

272 { "TCPSackFau»s", 
N_
("%uimeout aá” SACK„ecov”y"), 
İt_numb”
 },

273 { "TCPLossFau»s", 
N_
("%uimeout š†os ¡©e"), 
İt_numb”
 },

274 { "TCPFa¡R‘¿ns", 
N_
("%u fa¡„‘¿nsm™s"), 
İt_numb”
 },

275 { "TCPFÜw¬dR‘¿ns", 
N_
("%u fÜw¬d„‘¿nsm™s"), 
İt_numb”
 },

276 { "TCPSlowS¹R‘¿ns", 
N_
("%u„‘¿nsm™ š slow s¹"), 
İt_numb”
 },

277 { "TCPTimeouts", 
N_
("%u oth” TCPimeouts"), 
İt_numb”
 },

278 { "TCPR’oRecov”yFaed", 
N_
("%u„’Øç¡„‘¿nsm™ çed"), 
İt_numb”
 },

279 { "TCPSackRecov”yFa", 
N_
("%u SACK„‘¿nsm™ çed"), 
İt_numb”
 },

280 { "TCPScheduËrFaed", 
N_
("%uime »ûiv” scheduËdoØÏ‹ fÜ dœeù…roûssšg"), 
İt_numb”
 },

281 { "TCPRcvCŞÏp£d", 
N_
("%u…ack‘ cŞÏp£d iÀ»ûivqueudutØlow sock‘ bufãr"), 
İt_numb”
 },

282 { "TCPDSACKOldS’t", 
N_
("%u DSACK £Á fÜ old…ack‘s"), 
İt_numb”
 },

283 { "TCPDSACKOfoS’t", 
N_
("%u DSACK £Á fÜ ouˆoàÜd”…ack‘s"), 
İt_numb”
 },

284 { "TCPDSACKRecv", 
N_
("%u DSACK »ûived"), 
İt_numb”
 },

285 { "TCPDSACKOfoRecv", 
N_
("%u DSACK fÜ ouˆoàÜd”…ack‘ »ûived"), 
İt_numb”
 },

286 { "TCPAbÜtOnSyn", 
N_
("%u cÚÃùiÚ »£ˆdutØuÃx³ùed SYN"), 
İt_numb”
 },

287 { "TCPAbÜtOnD©a", 
N_
("%u cÚÃùiÚ »£ˆdutØuÃx³ùed d©a"), 
İt_numb”
 },

288 { "TCPAbÜtOnClo£", 
N_
("%u cÚÃùiÚ »£ˆdutØ—¾y u£¸şo£"), 
İt_numb”
 },

289 { "TCPAbÜtOnMemÜy", 
N_
("%u cÚÃùiÚ abÜ‹d dutØmemÜy…»ssu»"), 
İt_numb”
 },

290 { "TCPAbÜtOnTimeout", 
N_
("%u cÚÃùiÚ abÜ‹d dutØtimeout"), 
İt_numb”
 },

291 { "TCPAbÜtOnLšg”", 
N_
("%u cÚÃùiÚ abÜ‹d‡á” u£¸şo£ iÀlšg”imeout"), 
İt_numb”
 },

292 { "TCPAbÜtFaed", 
N_
("%uime uÇbËdØ£nd RST dutØnØmemÜy"), 
İt_numb”
 },

293 { "TCPMemÜyP»ssu»s", 
N_
("TCP„ª†ow oÀmemÜy %uimes"), 
İt_numb”
 },

294 { "TCPLoss", 
N_
("%u TCP d©¨los ev’ts"), 
İt_numb”
 },

295 { "TCPDSACKUndo", 
N_
("%u congestion windows„ecovered without slow start by DSACK"),

296 
İt_numb”
 },

297 { "TCPR’oRecov”yFa", 
N_
("%u cÏssiøR’Øç¡„‘¿nsm™ çed"), 
İt_numb”
 },

300 
	sbb
 {

301 *
	mt™Ë
;

302 
’Œy
 *
	mb
;

303 
size_t
 
	msize
;

304 *
	mæag
;

307 
bb
 
	g¢m±abs
[] =

309 {"Ip", 
I±ab
, (I±ab), &
f_¿w
},

310 {"Icmp", 
Icm±ab
, (Icm±ab), &
f_¿w
},

311 {"Tı", 
Tıb
, (Tıb), &
f_tı
},

312 {"Udp", 
Ud±ab
, (Ud±ab), &
f_udp
},

313 {"TıExt", 
Tıex‰ab
, (Tıex‰ab), &
f_tı
},

314 {
NULL
}

317 
bb
 
	g¢mp6bs
[] =

319 {"Ip6", 
Ip6b
, (Ip6b), &
f_¿w
},

320 {"Icmp6", 
Icmp6b
, (Icmp6b), &
f_¿w
},

321 {"Udp6", 
Udp6b
, (Udp6b), &
f_udp
},

322 {"Tı6", 
Tıb
, (Tıb), &
f_tı
},

323 {
NULL
}

328 
	$cm³Ár›s
(cÚ¡ *
a
, cÚ¡ *
b
)

330  
	`¡rcmp
(((
’Œy
 *è
a
)->
t™Ë
, ((’Œy *è
b
)->title);

331 
	}
}

333 
	$´štv®
(
bb
 *
b
, *
t™Ë
, 
v®
)

335 
’Œy
 *
’t
 = 
NULL
, 
key
;

336 
ty³
;

337 
buf
[512];

339 
key
.
t™Ë
 =itle;

340 ià(
b
->tab)

341 
’t
 = 
	`b£¬ch
(&
key
, 
b
->b,ab->
size
 / (
’Œy
),

342 (
’Œy
), 
cm³Ár›s
);

343 ià(!
’t
) {

344 ià(
v®
)

345 
	`´štf
("%*s%s: %d\n", 
¡©es
[
¡©e
].
šd’t
, "", 
t™Ë
, 
v®
);

348 
ty³
 = 
’t
->type;

349 ià(
ty³
 & 
I_STATIC
) {

350 
ty³
 &ğ~
I_STATIC
;

351 ià(!
´št_¡©ic
)

354 ià(*
’t
->
out
 == '\0')

357 ià(
ty³
 & 
I_TITLE
) {

358 
ty³
 &ğ~
I_TITLE
;

359 ià(
¡©e
 !ğ
ty³
)

360 
	`´štf
("%*s%s\n", 
¡©es
[
¡©e
].
šd’t
, "", 
	`_
(¡©es[
ty³
].
t™Ë
));

362 
buf
[0] = '\0';

363 
ty³
) {

364 
İt_numb”
:

365 ià(
v®
 == 0)

368 
numb”
:

369 
	`¢´štf
(
buf
, (buf), 
	`_
(
’t
->
out
), 
v®
);

371 
i_fÜw¬d
:

372 
ty³
 = 
nÜm®
;

373 
	`¢´štf
(
buf
, (buf), 
	`_
(
’t
->
out
), 
v®
 == 2 ? _("enabled") : _("disabled"));

375 
i_ou_icmp
:

376 
i_šp_icmp
:

377 ià(
v®
 > 0)

378 
	`¢´štf
(
buf
, (buf), 
	`_
(
’t
->
out
), 
v®
);

380 
i_¹o_®g
:

383 
	`abÜt
();

385 ià(
buf
[0])

386 
	`´štf
("%*s%s\n", 
¡©es
[
ty³
].
šd’t
, "", 
buf
);

388 
¡©e
 = 
ty³
;

389 
	}
}

391 
bb
 *
	$ÃwbË
(
bb
 *
bs
, *
t™Ë
)

393 
bb
 *
t
;

394 
bb
 
dummyb
;

396 
t
 = 
bs
;->
t™Ë
;++) {

397 ià(!
	`¡rcmp
(
t™Ë
, 
t
->title)) {

398 ià(*(
t
->
æag
))

399 
	`´štf
("%s:\n", 
	`_
(
t™Ë
));

400 
¡©e
 = 
nÜm®
;

401  
t
;

404 ià(!
f_unknown
)

405  
NULL
;

406 
	`´štf
("%s:\n", 
	`_
(
t™Ë
));

407 
dummyb
.
t™Ë
 =itle;

408 
dummyb
.
æag
 = &
f_unknown
;

409  &
dummyb
;

410 
	}
}

412 
	$´oûss_fd
(
FILE
 *
f
, 
®l
, *
f‹r
)

414 
buf1
[2048], 
buf2
[2048];

415 *
¥
, *
Å
, *
p
;

416 
	`fg‘s
(
buf1
,  buf1, 
f
)) {

417 
’dæag
;

418 
bb
 *
b
;

420 ià(
buf1
[0] == '\n')

423 ià(!
	`fg‘s
(
buf2
,  buf2, 
f
))

425 
¥
 = 
	`¡rchr
(
buf1
, ':');

426 
Å
 = 
	`¡rchr
(
buf2
, ':');

427 ià(!
Å
 || !
¥
)

428 
fÜm©”r
;

429 *
¥
 = '\0';

431 ià(!
®l
)

432 ià(
	`¡ºcmp
(
buf1
, 
f‹r
, 
	`¡¾’
(filter)))

435 
b
 = 
	`ÃwbË
(
¢m±abs
, 
buf1
);

436 ià(
b
 =ğ
NULL
) {

437 
	`´štf
("unknowÀ%s\n", 
buf1
);

440 
Å
++;

441 
¥
++;

443 
’dæag
 = 0;

444 !
’dæag
) {

445 
¥
 +ğ
	`¡r¥n
(sp, " \t\n");

446 
Å
 +ğ
	`¡r¥n
(np, " \t\n");

449 
p
 = 
¥
+
	`¡rc¥n
(sp, " \t\n");

450 ià(*
p
 == '\0')

451 
’dæag
 = 1;

452 *
p
 = '\0';

454 ià(*
¥
 !ğ'\0' && *(
b
->
æag
))

455 
	`´štv®
(
b
, 
¥
, 
	`¡¹oul
(
Å
, &np, 10));

457 
¥
 = 
p
 + 1;

462 
fÜm©”r
:

464 
	}
}

466 
	$ıyt™Ë
(*
Üigš®
, *
Ãw
)

468 *
±r
 = 
Üigš®
;

469 *
±r
 != '6' && *ptr != '\0') {

470 *
Ãw
 = *
±r
;

471 
Ãw
++;

472 
±r
++;

474 *
Ãw
 = *
±r
;

475 
Ãw
++;

476 *
Ãw
 = '\0';

477 
	}
}

479 
	$´oûss6_fd
(
FILE
 *
f
)

481 
buf1
[1024],
buf2
[50],
buf3
[1024];

482 
v®
;

483 
bb
 *
b
 = 
NULL
;

484 
ıæg
 = 0;

486 
	`fg‘s
(
buf1
,  buf1, 
f
)) {

487 
	`ssÿnf
(
buf1
, "% %lu", 
buf2
, &
v®
);

488 if(!
ıæg
) {

489 
	`ıyt™Ë
(
buf2
, 
buf3
);

490 
b
 = 
	`ÃwbË
(
¢mp6bs
, 
buf3
);

491 
ıæg
 = 1;

493 if(!
	`¡r¡r
(
buf2
, 
buf3
)) {

494 
	`ıyt™Ë
(
buf2
, 
buf3
);

495 
b
 = 
	`ÃwbË
(
¢mp6bs
, 
buf3
);

497 ià(*(
b
->
æag
))

498 
	`´štv®
(
b
, 
buf2
, 
v®
);

501 
	}
}

503 
	$·r£¢mp
(
æag_¿w
, 
æag_tı
, 
æag_udp
)

505 
FILE
 *
f
;

507 
f_¿w
 = 
æag_¿w
; 
f_tı
 = 
æag_tı
; 
f_udp
 = 
æag_udp
;

509 
f
 = 
	`´oc_fİ’
("/proc/net/snmp");

510 ià(!
f
) {

511 
	`³¼Ü
(
	`_
("cannot open /proc/net/snmp"));

515 ià(
	`´oûss_fd
(
f
, 1, 
NULL
) < 0)

516 
	`årštf
(
¡d”r
, 
	`_
("Problem while…arsing /proc/net/snmp\n"));

518 ià(
	`ã¼Ü
(
f
))

519 
	`³¼Ü
("/proc/net/snmp");

521 
	`fşo£
(
f
);

523 
f
 = 
	`´oc_fİ’
("/proc/net/netstat");

525 ià(
f
) {

526 ià(
	`´oûss_fd
(
f
, 1, 
NULL
) <0)

527 
	`årštf
(
¡d”r
, 
	`_
("Problem while…arsing /proc/net/netstat\n"));

529 ià(
	`ã¼Ü
(
f
))

530 
	`³¼Ü
("/proc/net/netstat");

532 
	`fşo£
(
f
);

535 
	}
}

537 
	$·r£¢mp6
(
æag_¿w
, 
æag_tı
, 
æag_udp
)

539 
FILE
 *
f
;

541 
f_¿w
 = 
æag_¿w
; 
f_tı
 = 
æag_tı
; 
f_udp
 = 
æag_udp
;

543 
f
 = 
	`fİ’
("/proc/net/snmp6", "r");

544 ià(!
f
) {

545 
	`³¼Ü
(
	`_
("cannot open /proc/net/snmp6"));

548 
	`´oûss6_fd
(
f
);

549 ià(
	`ã¼Ü
(
f
))

550 
	`³¼Ü
("/proc/net/snmp6");

552 
	`fşo£
(
f
);

553 
f
 = 
	`fİ’
("/proc/net/snmp", "r");

554 ià(!
f
) {

555 
	`³¼Ü
(
	`_
("cannot open /proc/net/snmp"));

558 
	`´oûss_fd
(
f
, 0, "Tcp");

559 ià(
	`ã¼Ü
(
f
))

560 
	`³¼Ü
("/proc/net/snmp");

562 
	`fşo£
(
f
);

563 
	}
}

565 
	$š™b
()

567 
bb
 *
t
;

570 
t
 = 
¢m±abs
;->
t™Ë
;++)

571 
	`qsÜt
(
t
->
b
,->
size
 / (
’Œy
),

572 (
’Œy
), 
cm³Ár›s
);

573 
	}
}

575 
	$š™b6
()

577 
bb
 *
t
;

579 
t
 = 
¢mp6bs
;->
t™Ë
;++)

580 
	`qsÜt
(
t
->
b
,->
size
 / (
’Œy
),

581 (
’Œy
), 
cm³Ár›s
);

582 
	}
}

	@interface/net-tools/version.h

1 
	#RELEASE
 "Ãt-toŞ 1.60"

	)

	@libnl/example_c/interface.c

33 
	~<Ãšk/Ãšk.h
>

34 
	~<Ãšk/g’l/g’l.h
>

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<uni¡d.h
>

39 
	~<sy¦og.h
>

40 
	~<fú.h
>

41 
	~<sys/ioùl.h
>

42 
	~<sys/sock‘.h
>

43 
	~<sys/ioùl.h
>

44 
	~<Ãtš‘/š.h
>

45 
	~<¬·/š‘.h
>

46 
	~<¡ršg.h
>

48 
	~<lšux/Ãtdeviû.h
>

49 
	~<lšux/if_¬p.h
>

50 
	~<lšux/sockios.h
>

52 
	#SPRINT_BSIZE
 64

	)

53 
	#SPRINT_BUF
(
x
èx[
SPRINT_BSIZE
]

	)

56 cÚ¡ *
	$Î_addr_n2a
(*
addr
, 
®’
, 
ty³
, *
buf
, 
bËn
)

58 
i
;

59 
l
;

61 ià(
®’
 == 4 &&

62 (
ty³
 =ğ
ARPHRD_TUNNEL
 ||y³ =ğ
ARPHRD_SIT
 ||y³ =ğ
ARPHRD_IPGRE
)) {

63  
	`š‘_Áİ
(
AF_INET
, 
addr
, 
buf
, 
bËn
);

65 ià(
®’
 =ğ16 && 
ty³
 =ğ
ARPHRD_TUNNEL6
) {

66  
	`š‘_Áİ
(
AF_INET6
, 
addr
, 
buf
, 
bËn
);

68 
l
 = 0;

69 
i
=0; i<
®’
; i++) {

70 ià(
i
==0) {

71 
	`¢´štf
(
buf
+
l
, 
bËn
, "%02x", 
addr
[
i
]);

72 
bËn
 -= 2;

73 
l
 += 2;

75 
	`¢´štf
(
buf
+
l
, 
bËn
, ":%02x", 
addr
[
i
]);

76 
bËn
 -= 3;

77 
l
 += 3;

80  
buf
;

81 
	}
}

84 
	$·r£_¹©Œ
(
¹©Œ
 *
tb
[], 
max
, ¹©Œ *
¹a
, 
Ën
)

86 
	`mem£t
(
tb
, 0, (
¹©Œ
 *è* (
max
 + 1));

87 
	`RTA_OK
(
¹a
, 
Ën
)) {

88 ià((
¹a
->
¹a_ty³
 <ğ
max
è&& (!
tb
[rta->rta_type]))

89 
tb
[
¹a
->
¹a_ty³
] =„ta;

90 
¹a
 = 
	`RTA_NEXT
Ô,
Ën
);

92 ià(
Ën
)

93 
	`årštf
(
¡d”r
, "!!!Defic™ %d,„_Ën=%d\n", 
Ën
, 
¹a
->
¹a_Ën
);

95 
	}
}

99 cÚ¡ *
	$¹_addr_n2a
(
af
, 
Ën
, cÚ¡ *
addr
, *
buf
, 
buæ’
)

101 
af
) {

102 
AF_INET
:

103 
AF_INET6
:

104  
	`š‘_Áİ
(
af
, 
addr
, 
buf
, 
buæ’
);

106 
AF_IPX
:

107  
	`x_Áİ
(
af
, 
addr
, 
buf
, 
buæ’
);

108 
AF_DECÃt
:

110 
dn_Çddr
 
dÇ
 = { 2, { 0, 0, }};

111 
	`memıy
(
dÇ
.
a_addr
, 
addr
, 2);

112  
	`dÃt_Áİ
(
af
, &
dÇ
, 
buf
, 
buæ’
);

118 
	}
}

122 
	$ÿÎback
(
Æ_msg
 *
msg
, *
¬g
)

124 
Æmsghdr
 *
Æh
 = 
	`Æmsg_hdr
(
msg
);

125 
ifšfomsg
 *
içû
 = 
	`NLMSG_DATA
(
Æh
);

126 
¹©Œ
 *
hdr
 = 
	`IFLA_RTA
(
içû
);

127 
»maššg
 = 
Æh
->
Æmsg_Ën
 - 
	`NLMSG_LENGTH
((*
içû
));

128 
Ën
 = 
Æh
->
Æmsg_Ën
;

129 
	`SPRINT_BUF
(
b1
);

131 
¹©Œ
 * 
tb
[
IFLA_MAX
+1];

133 
	`´štf
("Got something.\n");

134 
	`Æ_msg_dump
(
msg
, 
¡dout
);

137 
Ën
 -ğ
	`NLMSG_LENGTH
((*
içû
));

138 ià(
Ën
 < 0)

142 
	`·r£_¹©Œ
(
tb
, 
IFLA_MAX
, 
	`IFLA_RTA
(
içû
), 
Ën
);

143 ià(
tb
[
IFLA_IFNAME
] =ğ
NULL
)

145 
	`årštf
(
¡d”r
, "BUG: deviû w™h ifšdex %d ha n iâame\n", 
içû
->
ifi_šdex
);

148 
	`´štf
("deviû index %d,‚am%s\r\n", 
içû
->
ifi_šdex
, (*)
	`RTA_DATA
(
tb
[
IFLA_IFNAME
]));

149 ià(
tb
[
IFLA_ADDRESS
])

151 
	`´štf
Ğ"maøadd»ss:%s\r\n", 
	`Î_addr_n2a
(
	`RTA_DATA
(
tb
[
IFLA_ADDRESS
]),

152 
	`RTA_PAYLOAD
(
tb
[
IFLA_ADDRESS
]),

153 
içû
->
ifi_ty³
,

154 
b1
, (b1)));

156 ià(
tb
[
IFA_LOCAL
])

158 
	`´štf
("‡dd¸%s\r\n", 
	`¹_addr_n2a
(
içû
->
ifi_çmy
,

159 
	`RTA_PAYLOAD
(
tb
[
IFA_LOCAL
]),

160 
	`RTA_DATA
(
tb
[
IFA_LOCAL
]),

161 
b1
, (1)));

163 ià(
tb
[
IFA_ADDRESS
] =ğ
NULL
 ||

164 
	`memcmp
(
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]), RTA_DATAÑb[
IFA_LOCAL
]), 4) == 0) {

165 
	`årštf
(
å
, "/%d ", 
içû
->
iç_´efixËn
);

167 
	`årštf
(
å
, "…eer %s/%d ",

168 
	`¹_addr_n2a
(
içû
->
ifi_çmy
,

169 
	`RTA_PAYLOAD
(
tb
[
IFA_ADDRESS
]),

170 
	`RTA_DATA
(
tb
[
IFA_ADDRESS
]),

171 
buf
, (buf)),

172 
içû
->
iç_´efixËn
);

175 
	`´štf
("endl\r\n");

177 
	`RTA_OK
(
hdr
, 
»maššg
)) {

180 ià(
hdr
->
¹a_ty³
 =ğ
IFLA_IFNAME
) {

181 
	`´štf
("Found‚‘wÜk iÁ”çû %d: %s\n", 
içû
->
ifi_šdex
, (*è
	`RTA_DATA
(
hdr
));

184 
hdr
 = 
	`RTA_NEXT
(hdr, 
»maššg
);

187  
NL_OK
;

188 
	}
}

190 
	$maš
() {

192 
Æ_sock
 *
sock‘
 = 
	`Æ_sock‘_®loc
();

193 
	`Æ_cÚÃù
(
sock‘
, 
NETLINK_ROUTE
);

196 
¹g’msg
 
¹_hdr
 = { .
¹g’_çmy
 = 
AF_PACKET
, };

197 
»t
 = 
	`Æ_£nd_sim¶e
(
sock‘
, 
RTM_GETLINK
, 
NLM_F_REQUEST
 | 
NLM_F_DUMP
, &
¹_hdr
, (rt_hdr));

198 
	`´štf
("Æ_£nd_sim¶»tuºed %d\n", 
»t
);

201 
	`Æ_sock‘_modify_cb
(
sock‘
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ÿÎback
, 
NULL
);

202 
	`Æ_»cvmsgs_deçuÉ
(
sock‘
);

205 
	}
}

	@libnl/example_c/scan_access_points.c

48 
	~<”ºo.h
>

49 
	~<Ãšk/g’l/g’l.h
>

50 
	~<lšux/Æ80211.h
>

53 
	sŒigg”_»suÉs
 {

54 
	mdÚe
;

55 
	mabÜ‹d
;

59 
	$”rÜ_hªdËr
(
sockaddr_Æ
 *
Æa
, 
Æmsg”r
 *
”r
, *
¬g
) {

61 
	`´štf
("error_handler() called.\n");

62 *
»t
 = 
¬g
;

63 *
»t
 = 
”r
->
”rÜ
;

64  
NL_STOP
;

65 
	}
}

68 
	$fšish_hªdËr
(
Æ_msg
 *
msg
, *
¬g
) {

70 *
»t
 = 
¬g
;

71 *
»t
 = 0;

72  
NL_SKIP
;

73 
	}
}

76 
	$ack_hªdËr
(
Æ_msg
 *
msg
, *
¬g
) {

78 *
»t
 = 
¬g
;

79 *
»t
 = 0;

80  
NL_STOP
;

81 
	}
}

84 
	$no_£q_check
(
Æ_msg
 *
msg
, *
¬g
) {

86  
NL_OK
;

87 
	}
}

90 
	$mac_addr_n2a
(*
mac_addr
, *
¬g
) {

92 
i
, 
l
;

94 
l
 = 0;

95 
i
 = 0; i < 6; i++) {

96 ià(
i
 == 0) {

97 
	`¥rštf
(
mac_addr
+
l
, "%02x", 
¬g
[
i
]);

98 
l
 += 2;

100 
	`¥rštf
(
mac_addr
+
l
, ":%02x", 
¬g
[
i
]);

101 
l
 += 3;

104 
	}
}

107 
	$´št_ssid
(*
›
, 
›Ën
) {

108 
ušt8_t
 
Ën
;

109 
ušt8_t
 *
d©a
;

110 
i
;

112 
›Ën
 >ğ2 && i–’ >ğ
›
[1]) {

113 ià(
›
[0] == 0 && ie[1] >= 0 && ie[1] <= 32) {

114 
Ën
 = 
›
[1];

115 
d©a
 = 
›
 + 2;

116 
i
 = 0; i < 
Ën
; i++) {

117 ià(
	`i¥ršt
(
d©a
[
i
]è&& d©a[i] !ğ' ' && d©a[i] !ğ'\\'è
	`´štf
("%c", data[i]);

118 ià(
d©a
[
i
] =ğ' ' && (˜!ğ0 && i !ğ
Ën
 -1)è
	`´štf
(" ");

119 
	`´štf
("\\x%.2x", 
d©a
[
i
]);

123 
›Ën
 -ğ
›
[1] + 2;

124 
›
 += ie[1] + 2;

126 
	}
}

129 
	$ÿÎback_Œigg”
(
Æ_msg
 *
msg
, *
¬g
) {

131 
g’lmsghdr
 *
gÆh
 = 
	`Æmsg_d©a
(
	`Æmsg_hdr
(
msg
));

132 
Œigg”_»suÉs
 *
»suÉs
 = 
¬g
;

138 ià(
gÆh
->
cmd
 =ğ
NL80211_CMD_SCAN_ABORTED
) {

139 
	`´štf
("Got NL80211_CMD_SCAN_ABORTED.\n");

140 
»suÉs
->
dÚe
 = 1;

141 
»suÉs
->
abÜ‹d
 = 1;

142 } ià(
gÆh
->
cmd
 =ğ
NL80211_CMD_NEW_SCAN_RESULTS
) {

143 
	`´štf
("Got NL80211_CMD_NEW_SCAN_RESULTS.\n");

144 
»suÉs
->
dÚe
 = 1;

145 
»suÉs
->
abÜ‹d
 = 0;

148  
NL_SKIP
;

149 
	}
}

152 
	$ÿÎback_dump
(
Æ_msg
 *
msg
, *
¬g
) {

154 
g’lmsghdr
 *
gÆh
 = 
	`Æmsg_d©a
(
	`Æmsg_hdr
(
msg
));

155 
mac_addr
[20];

156 
Æ©Œ
 *
tb
[
NL80211_ATTR_MAX
 + 1];

157 
Æ©Œ
 *
bss
[
NL80211_BSS_MAX
 + 1];

158 
Æa_pŞicy
 
bss_pŞicy
[
NL80211_BSS_MAX
 + 1] = {

159 [
NL80211_BSS_TSF
] = { .
ty³
 = 
NLA_U64
 },

160 [
NL80211_BSS_FREQUENCY
] = { .
ty³
 = 
NLA_U32
 },

161 [
NL80211_BSS_BSSID
] = { },

162 [
NL80211_BSS_BEACON_INTERVAL
] = { .
ty³
 = 
NLA_U16
 },

163 [
NL80211_BSS_CAPABILITY
] = { .
ty³
 = 
NLA_U16
 },

164 [
NL80211_BSS_INFORMATION_ELEMENTS
] = { },

165 [
NL80211_BSS_SIGNAL_MBM
] = { .
ty³
 = 
NLA_U32
 },

166 [
NL80211_BSS_SIGNAL_UNSPEC
] = { .
ty³
 = 
NLA_U8
 },

167 [
NL80211_BSS_STATUS
] = { .
ty³
 = 
NLA_U32
 },

168 [
NL80211_BSS_SEEN_MS_AGO
] = { .
ty³
 = 
NLA_U32
 },

169 [
NL80211_BSS_BEACON_IES
] = { },

173 
	`Æa_·r£
(
tb
, 
NL80211_ATTR_MAX
, 
	`g’lmsg_©Œd©a
(
gÆh
, 0), 
	`g’lmsg_©ŒËn
(gÆh, 0), 
NULL
);

174 ià(!
tb
[
NL80211_ATTR_BSS
]) {

175 
	`´štf
("bss info missing!\n");

176  
NL_SKIP
;

178 ià(
	`Æa_·r£_Ã¡ed
(
bss
, 
NL80211_BSS_MAX
, 
tb
[
NL80211_ATTR_BSS
], 
bss_pŞicy
)) {

179 
	`´štf
("failedo…arse‚ested‡ttributes!\n");

180  
NL_SKIP
;

182 ià(!
bss
[
NL80211_BSS_BSSID
]è 
NL_SKIP
;

183 ià(!
bss
[
NL80211_BSS_INFORMATION_ELEMENTS
]è 
NL_SKIP
;

186 
	`mac_addr_n2a
(
mac_addr
, 
	`Æa_d©a
(
bss
[
NL80211_BSS_BSSID
]));

187 
	`´štf
("%s, ", 
mac_addr
);

188 
	`´štf
("%d MHz, ", 
	`Æa_g‘_u32
(
bss
[
NL80211_BSS_FREQUENCY
]));

189 
	`´št_ssid
(
	`Æa_d©a
(
bss
[
NL80211_BSS_INFORMATION_ELEMENTS
]), 
	`Æa_Ën
(bss[NL80211_BSS_INFORMATION_ELEMENTS]));

190 
	`´štf
("\n");

192  
NL_SKIP
;

193 
	}
}

196 
	$do_sÿn_Œigg”
(
Æ_sock
 *
sock‘
, 
if_šdex
, 
driv”_id
) {

198 
Œigg”_»suÉs
 
»suÉs
 = { .
dÚe
 = 0, .
abÜ‹d
 = 0 };

199 
Æ_msg
 *
msg
;

200 
Æ_cb
 *
cb
;

201 
Æ_msg
 *
ssids_to_sÿn
;

202 
”r
;

203 
»t
;

204 
mcid
 = 
	`g’l_ù¾_»sŞve_g½
(
sock‘
, "nl80211", "scan");

205 
	`Æ_sock‘_add_memb”sh
(
sock‘
, 
mcid
);

208 
msg
 = 
	`Æmsg_®loc
();

209 ià(!
msg
) {

210 
	`´štf
("ERROR: Failedo‡llocate‚etlink message for msg.\n");

211  -
ENOMEM
;

213 
ssids_to_sÿn
 = 
	`Æmsg_®loc
();

214 ià(!
ssids_to_sÿn
) {

215 
	`´štf
("ERROR: Failedo‡llocate‚etlink message for ssids_to_scan.\n");

216 
	`Æmsg_ä“
(
msg
);

217  -
ENOMEM
;

219 
cb
 = 
	`Æ_cb_®loc
(
NL_CB_DEFAULT
);

220 ià(!
cb
) {

221 
	`´štf
("ERROR: Failedo‡llocate‚etlink callbacks.\n");

222 
	`Æmsg_ä“
(
msg
);

223 
	`Æmsg_ä“
(
ssids_to_sÿn
);

224  -
ENOMEM
;

228 
	`g’lmsg_put
(
msg
, 0, 0, 
driv”_id
, 0, 0, 
NL80211_CMD_TRIGGER_SCAN
, 0);

229 
	`Æa_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
if_šdex
);

230 
	`Æa_put
(
ssids_to_sÿn
, 1, 0, "");

231 
	`Æa_put_Ã¡ed
(
msg
, 
NL80211_ATTR_SCAN_SSIDS
, 
ssids_to_sÿn
);

232 
	`Æmsg_ä“
(
ssids_to_sÿn
);

233 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ÿÎback_Œigg”
, &
»suÉs
);

234 
	`Æ_cb_”r
(
cb
, 
NL_CB_CUSTOM
, 
”rÜ_hªdËr
, &
”r
);

235 
	`Æ_cb_£t
(
cb
, 
NL_CB_FINISH
, 
NL_CB_CUSTOM
, 
fšish_hªdËr
, &
”r
);

236 
	`Æ_cb_£t
(
cb
, 
NL_CB_ACK
, 
NL_CB_CUSTOM
, 
ack_hªdËr
, &
”r
);

237 
	`Æ_cb_£t
(
cb
, 
NL_CB_SEQ_CHECK
, 
NL_CB_CUSTOM
, 
no_£q_check
, 
NULL
);

241 
”r
 = 1;

242 
»t
 = 
	`Æ_£nd_auto
(
sock‘
, 
msg
);

243 
	`´štf
("NL80211_CMD_TRIGGER_SCAN s’ˆ%d by‹ tØthk”Ãl.\n", 
»t
);

244 
	`´štf
("Waiting for scano complete...\n");

245 
”r
 > 0è
»t
 = 
	`Æ_»cvmsgs
(
sock‘
, 
cb
);

246 ià(
”r
 < 0) {

247 
	`´štf
("WARNING:ƒ¼ ha ¨v®uoà%d.\n", 
”r
);

249 ià(
»t
 < 0) {

250 
	`´štf
("ERROR:‚l_»cvmsgs(è»tuºed %d (%s).\n", 
»t
, 
	`Æ_g‘”rÜ
(-ret));

251  
»t
;

253 !
»suÉs
.
dÚe
è
	`Æ_»cvmsgs
(
sock‘
, 
cb
);

254 ià(
»suÉs
.
abÜ‹d
) {

255 
	`´štf
("ERROR: Kernel‡borted scan.\n");

258 
	`´štf
("Scan is done.\n");

261 
	`Æmsg_ä“
(
msg
);

262 
	`Æ_cb_put
(
cb
);

263 
	`Æ_sock‘_drİ_memb”sh
(
sock‘
, 
mcid
);

265 
	}
}

268 
	$maš
() {

269 
if_šdex
 = 
	`if_Çm‘ošdex
("wlan0");

272 
Æ_sock
 *
sock‘
 = 
	`Æ_sock‘_®loc
();

273 
	`g’l_cÚÃù
(
sock‘
);

274 
driv”_id
 = 
	`g’l_ù¾_»sŞve
(
sock‘
, "nl80211");

277 
”r
 = 
	`do_sÿn_Œigg”
(
sock‘
, 
if_šdex
, 
driv”_id
);

278 ià(
”r
 != 0) {

279 
	`´štf
("do_sÿn_Œigg”(èçed w™h %d.\n", 
”r
);

280  
”r
;

284 
Æ_msg
 *
msg
 = 
	`Æmsg_®loc
();

285 
	`g’lmsg_put
(
msg
, 0, 0, 
driv”_id
, 0, 
NLM_F_DUMP
, 
NL80211_CMD_GET_SCAN
, 0);

286 
	`Æa_put_u32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
if_šdex
);

287 
	`Æ_sock‘_modify_cb
(
sock‘
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ÿÎback_dump
, 
NULL
);

288 
»t
 = 
	`Æ_£nd_auto
(
sock‘
, 
msg
);

289 
	`´štf
("NL80211_CMD_GET_SCAN s’ˆ%d by‹ tØthk”Ãl.\n", 
»t
);

290 
»t
 = 
	`Æ_»cvmsgs_deçuÉ
(
sock‘
);

291 
	`Æmsg_ä“
(
msg
);

292 ià(
»t
 < 0) {

293 
	`´štf
("ERROR:‚l_»cvmsgs_deçuÉ(è»tuºed %d (%s).\n", 
»t
, 
	`Æ_g‘”rÜ
(-ret));

294  
»t
;

298 
	}
}

	@libnl/example_c/show_wifi_interface.c

62 
	~<Ãšk/Ãšk.h
>

63 
	~<Ãšk/g’l/g’l.h
>

64 
	~<lšux/Æ80211.h
>

67 
	$ÿÎback
(
Æ_msg
 *
msg
, *
¬g
) {

68 
g’lmsghdr
 *
gÆh
 = 
	`Æmsg_d©a
(
	`Æmsg_hdr
(
msg
));

69 
Æ©Œ
 *
tb_msg
[
NL80211_ATTR_MAX
 + 1];

70 *
why
 = 
¬g
;

77 
	`Æa_·r£
(
tb_msg
, 
NL80211_ATTR_MAX
, 
	`g’lmsg_©Œd©a
(
gÆh
, 0), 
	`g’lmsg_©ŒËn
(gÆh, 0), 
NULL
);

80 ià(
tb_msg
[
NL80211_ATTR_IFNAME
]) {

81 
	`´štf
("IÁ”çû %s\n", 
	`Æa_g‘_¡ršg
(
tb_msg
[
NL80211_ATTR_IFNAME
]));

83 
	`´štf
("Unnamed/non-netdev interface\n");

85 ià(
why
 && 
tb_msg
[
NL80211_ATTR_WIPHY
]) {

86 
	`´štf
("List mode,‚o interface specified.\n");

87 
thiswhy
 = 
	`Æa_g‘_u32
(
tb_msg
[
NL80211_ATTR_WIPHY
]);

88 ià(*
why
 !ğ
thiswhy
è
	`´štf
("phy#%d\n",hiswiphy);

89 *
why
 = 
thiswhy
;

90 } ià(
tb_msg
[
NL80211_ATTR_WIPHY
]) {

91 
	`´štf
("why %d\n", 
	`Æa_g‘_u32
(
tb_msg
[
NL80211_ATTR_WIPHY
]));

93 ià(
tb_msg
[
NL80211_ATTR_MAC
]) {

96 
	`´štf
("NOT IMPLEMENTED\n");

99 ià(
tb_msg
[
NL80211_ATTR_SSID
]) {

102 
	`´štf
("NOT IMPLEMENTED\n");

107 ià(
tb_msg
[
NL80211_ATTR_IFINDEX
]è
	`´štf
("ifšdex %d\n", 
	`Æa_g‘_u32
(tb_msg[NL80211_ATTR_IFINDEX]));

109 ià(
tb_msg
[
NL80211_ATTR_IFTYPE
])

110 
	`´štf
("NOT IMPLEMENTED\n");

114 ià(
tb_msg
[
NL80211_ATTR_WIPHY_FREQ
]) {

115 
ušt32_t
 
äeq
 = 
	`Æa_g‘_u32
(
tb_msg
[
NL80211_ATTR_WIPHY_FREQ
]);

117 
	`´štf
("NOT IMPLEMENTED");

133 
	`´štf
("\n");

136 
	`´štf
("------------------------------\n");

138  
NL_SKIP
;

139 
	}
}

141 
	$maš
() {

142 
Æ_msg
 *
msg
;

143 
»t
;

146 
Æ_sock
 *
sock‘
 = 
	`Æ_sock‘_®loc
();

147 
	`g’l_cÚÃù
(
sock‘
);

148 
driv”_id
 = 
	`g’l_ù¾_»sŞve
(
sock‘
, "nl80211");

151 
	`´štf
(">>> Getting info for wlan0:\n");

152 
	`Æ_sock‘_modify_cb
(
sock‘
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ÿÎback
, 
NULL
);

153 
msg
 = 
	`Æmsg_®loc
();

154 
if_šdex
 = 
	`if_Çm‘ošdex
("wlan0");

155 
	`g’lmsg_put
(
msg
, 0, 0, 
driv”_id
, 0, 0, 
NL80211_CMD_GET_INTERFACE
, 0);

156 
	`NLA_PUT_U32
(
msg
, 
NL80211_ATTR_IFINDEX
, 
if_šdex
);

157 
»t
 = 
	`Æ_£nd_auto_com¶‘e
(
sock‘
, 
msg
);

158 
	`´štf
("Æ_£nd_auto_com¶‘»tuºed %d\n", 
»t
);

159 
	`Æ_»cvmsgs_deçuÉ
(
sock‘
);

160 
	`Æ_wa™_fÜ_ack
(
sock‘
);

163 
	`´štf
(">>> Getting info for‡ll interfaces:\n");

164 
dev_dump_why
 = -1;

165 
	`Æ_sock‘_modify_cb
(
sock‘
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ÿÎback
, &
dev_dump_why
);

166 
msg
 = 
	`Æmsg_®loc
();

167 
	`g’lmsg_put
(
msg
, 0, 0, 
driv”_id
, 0, 
NLM_F_DUMP
, 
NL80211_CMD_GET_INTERFACE
, 0);

168 
»t
 = 
	`Æ_£nd_auto_com¶‘e
(
sock‘
, 
msg
);

169 
	`´štf
("Æ_£nd_auto_com¶‘»tuºed %d\n", 
»t
);

170 
	`Æ_»cvmsgs_deçuÉ
(
sock‘
);

172 
	`´štf
(">>> Programƒxit.\n");

176 
Æa_put_çu»
:

177 
	`Æmsg_ä“
(
msg
);

179 
	}
}

	@mylibnl/libnl-3.2.25/include/linux/can/netlink.h

10 #iâdeà
CAN_NETLINK_H


11 
	#CAN_NETLINK_H


	)

13 
	~<lšux/ty³s.h
>

22 
	sÿn_b™timšg
 {

23 
__u32
 
	mb™¿‹
;

24 
__u32
 
	m§m¶e_pošt
;

25 
__u32
 
	mtq
;

26 
__u32
 
	m´İ_£g
;

27 
__u32
 
	mpha£_£g1
;

28 
__u32
 
	mpha£_£g2
;

29 
__u32
 
	msjw
;

30 
__u32
 
	mb½
;

38 
	sÿn_b™timšg_cÚ¡
 {

39 
	mÇme
[16];

40 
__u32
 
	mt£g1_mš
;

41 
__u32
 
	mt£g1_max
;

42 
__u32
 
	mt£g2_mš
;

43 
__u32
 
	mt£g2_max
;

44 
__u32
 
	msjw_max
;

45 
__u32
 
	mb½_mš
;

46 
__u32
 
	mb½_max
;

47 
__u32
 
	mb½_šc
;

53 
	sÿn_şock
 {

54 
__u32
 
	mäeq
;

60 
	eÿn_¡©e
 {

61 
	mCAN_STATE_ERROR_ACTIVE
 = 0,

62 
	mCAN_STATE_ERROR_WARNING
,

63 
	mCAN_STATE_ERROR_PASSIVE
,

64 
	mCAN_STATE_BUS_OFF
,

65 
	mCAN_STATE_STOPPED
,

66 
	mCAN_STATE_SLEEPING
,

67 
	mCAN_STATE_MAX


73 
	sÿn_b”r_couÁ”
 {

74 
__u16
 
	mtx”r
;

75 
__u16
 
	mrx”r
;

81 
	sÿn_ù¾mode
 {

82 
__u32
 
	mmask
;

83 
__u32
 
	mæags
;

86 
	#CAN_CTRLMODE_LOOPBACK
 0x01

	)

87 
	#CAN_CTRLMODE_LISTENONLY
 0x02

	)

88 
	#CAN_CTRLMODE_3_SAMPLES
 0x04

	)

89 
	#CAN_CTRLMODE_ONE_SHOT
 0x08

	)

90 
	#CAN_CTRLMODE_BERR_REPORTING
 0x10

	)

95 
	sÿn_deviû_¡©s
 {

96 
__u32
 
	mbus_”rÜ
;

97 
__u32
 
	m”rÜ_w¬nšg
;

98 
__u32
 
	m”rÜ_·ssive
;

99 
__u32
 
	mbus_off
;

100 
__u32
 
	m¬b™¿tiÚ_lo¡
;

101 
__u32
 
	m»¡¬ts
;

108 
	mIFLA_CAN_UNSPEC
,

109 
	mIFLA_CAN_BITTIMING
,

110 
	mIFLA_CAN_BITTIMING_CONST
,

111 
	mIFLA_CAN_CLOCK
,

112 
	mIFLA_CAN_STATE
,

113 
	mIFLA_CAN_CTRLMODE
,

114 
	mIFLA_CAN_RESTART_MS
,

115 
	mIFLA_CAN_RESTART
,

116 
	mIFLA_CAN_BERR_COUNTER
,

117 
	m__IFLA_CAN_MAX


120 
	#IFLA_CAN_MAX
 (
__IFLA_CAN_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/fib_rules.h

1 #iâdeà
__LINUX_FIB_RULES_H


2 
	#__LINUX_FIB_RULES_H


	)

5 
	#FIB_RULE_PERMANENT
 0x00000001

	)

6 
	#FIB_RULE_INVERT
 0x00000002

	)

7 
	#FIB_RULE_UNRESOLVED
 0x00000004

	)

8 
	#FIB_RULE_IIF_DETACHED
 0x00000008

	)

9 
	#FIB_RULE_DEV_DETACHED
 
FIB_RULE_IIF_DETACHED


	)

10 
	#FIB_RULE_OIF_DETACHED
 0x00000010

	)

13 
	#FIB_RULE_FIND_SADDR
 0x00010000

	)

15 
	sfib_ruË_hdr
 {

16 
__u8
 
	mçmy
;

17 
__u8
 
	md¡_Ën
;

18 
__u8
 
	m¤c_Ën
;

19 
__u8
 
	mtos
;

21 
__u8
 
	mbË
;

22 
__u8
 
	m»s1
;

23 
__u8
 
	m»s2
;

24 
__u8
 
	maùiÚ
;

26 
__u32
 
	mæags
;

30 
	mFRA_UNSPEC
,

31 
	mFRA_DST
,

32 
	mFRA_SRC
,

33 
	mFRA_IIFNAME
,

34 
	#FRA_IFNAME
 
FRA_IIFNAME


	)

35 
	mFRA_GOTO
,

36 
	mFRA_UNUSED2
,

37 
	mFRA_PRIORITY
,

38 
	mFRA_UNUSED3
,

39 
	mFRA_UNUSED4
,

40 
	mFRA_UNUSED5
,

41 
	mFRA_FWMARK
,

42 
	mFRA_FLOW
,

43 
	mFRA_UNUSED6
,

44 
	mFRA_UNUSED7
,

45 
	mFRA_UNUSED8
,

46 
	mFRA_TABLE
,

47 
	mFRA_FWMASK
,

48 
	mFRA_OIFNAME
,

49 
	m__FRA_MAX


52 
	#FRA_MAX
 (
__FRA_MAX
 - 1)

	)

55 
	mFR_ACT_UNSPEC
,

56 
	mFR_ACT_TO_TBL
,

57 
	mFR_ACT_GOTO
,

58 
	mFR_ACT_NOP
,

59 
	mFR_ACT_RES3
,

60 
	mFR_ACT_RES4
,

61 
	mFR_ACT_BLACKHOLE
,

62 
	mFR_ACT_UNREACHABLE
,

63 
	mFR_ACT_PROHIBIT
,

64 
	m__FR_ACT_MAX
,

67 
	#FR_ACT_MAX
 (
__FR_ACT_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/gen_stats.h

1 #iâdeà
__LINUX_GEN_STATS_H


2 
	#__LINUX_GEN_STATS_H


	)

4 
	~<lšux/ty³s.h
>

7 
	mTCA_STATS_UNSPEC
,

8 
	mTCA_STATS_BASIC
,

9 
	mTCA_STATS_RATE_EST
,

10 
	mTCA_STATS_QUEUE
,

11 
	mTCA_STATS_APP
,

12 
	m__TCA_STATS_MAX
,

14 
	#TCA_STATS_MAX
 (
__TCA_STATS_MAX
 - 1)

	)

21 
	sgÃt_¡©s_basic
 {

22 
__u64
 
	mby‹s
;

23 
__u32
 
	m·ck‘s
;

25 
	sgÃt_¡©s_basic_·cked
 {

26 
__u64
 
	mby‹s
;

27 
__u32
 
	m·ck‘s
;

28 } 
__©Œibu‹__
 ((
·cked
));

35 
	sgÃt_¡©s_¿‹_e¡
 {

36 
__u32
 
	mbps
;

37 
__u32
 
	mµs
;

48 
	sgÃt_¡©s_queue
 {

49 
__u32
 
	mqËn
;

50 
__u32
 
	mbacklog
;

51 
__u32
 
	mdrİs
;

52 
__u32
 
	m»queues
;

53 
__u32
 
	mov”lim™s
;

61 
	sgÃt_e¡im©Ü
 {

62 sigÃd 
	mš‹rv®
;

63 
	mewma_log
;

	@mylibnl/libnl-3.2.25/include/linux/genetlink.h

1 #iâdeà
__LINUX_GENERIC_NETLINK_H


2 
	#__LINUX_GENERIC_NETLINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	#GENL_NAMSIZ
 16

	)

9 
	#GENL_MIN_ID
 
NLMSG_MIN_TYPE


	)

10 
	#GENL_MAX_ID
 1023

	)

12 
	sg’lmsghdr
 {

13 
__u8
 
	mcmd
;

14 
__u8
 
	mv”siÚ
;

15 
__u16
 
	m»£rved
;

18 
	#GENL_HDRLEN
 
	`NLMSG_ALIGN
((
g’lmsghdr
))

	)

20 
	#GENL_ADMIN_PERM
 0x01

	)

21 
	#GENL_CMD_CAP_DO
 0x02

	)

22 
	#GENL_CMD_CAP_DUMP
 0x04

	)

23 
	#GENL_CMD_CAP_HASPOL
 0x08

	)

28 
	#GENL_ID_GENERATE
 0

	)

29 
	#GENL_ID_CTRL
 
NLMSG_MIN_TYPE


	)

36 
	mCTRL_CMD_UNSPEC
,

37 
	mCTRL_CMD_NEWFAMILY
,

38 
	mCTRL_CMD_DELFAMILY
,

39 
	mCTRL_CMD_GETFAMILY
,

40 
	mCTRL_CMD_NEWOPS
,

41 
	mCTRL_CMD_DELOPS
,

42 
	mCTRL_CMD_GETOPS
,

43 
	mCTRL_CMD_NEWMCAST_GRP
,

44 
	mCTRL_CMD_DELMCAST_GRP
,

45 
	mCTRL_CMD_GETMCAST_GRP
,

46 
	m__CTRL_CMD_MAX
,

49 
	#CTRL_CMD_MAX
 (
__CTRL_CMD_MAX
 - 1)

	)

52 
	mCTRL_ATTR_UNSPEC
,

53 
	mCTRL_ATTR_FAMILY_ID
,

54 
	mCTRL_ATTR_FAMILY_NAME
,

55 
	mCTRL_ATTR_VERSION
,

56 
	mCTRL_ATTR_HDRSIZE
,

57 
	mCTRL_ATTR_MAXATTR
,

58 
	mCTRL_ATTR_OPS
,

59 
	mCTRL_ATTR_MCAST_GROUPS
,

60 
	m__CTRL_ATTR_MAX
,

63 
	#CTRL_ATTR_MAX
 (
__CTRL_ATTR_MAX
 - 1)

	)

66 
	mCTRL_ATTR_OP_UNSPEC
,

67 
	mCTRL_ATTR_OP_ID
,

68 
	mCTRL_ATTR_OP_FLAGS
,

69 
	m__CTRL_ATTR_OP_MAX
,

72 
	#CTRL_ATTR_OP_MAX
 (
__CTRL_ATTR_OP_MAX
 - 1)

	)

75 
	mCTRL_ATTR_MCAST_GRP_UNSPEC
,

76 
	mCTRL_ATTR_MCAST_GRP_NAME
,

77 
	mCTRL_ATTR_MCAST_GRP_ID
,

78 
	m__CTRL_ATTR_MCAST_GRP_MAX
,

81 
	#CTRL_ATTR_MCAST_GRP_MAX
 (
__CTRL_ATTR_MCAST_GRP_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	#IFNAMSIZ
 16

	)

23 
	#IFALIASZ
 256

	)

26 
	#IFF_UP
 0x1

	)

27 
	#IFF_BROADCAST
 0x2

	)

28 
	#IFF_DEBUG
 0x4

	)

29 
	#IFF_LOOPBACK
 0x8

	)

30 
	#IFF_POINTOPOINT
 0x10

	)

31 
	#IFF_NOTRAILERS
 0x20

	)

32 
	#IFF_RUNNING
 0x40

	)

33 
	#IFF_NOARP
 0x80

	)

34 
	#IFF_PROMISC
 0x100

	)

35 
	#IFF_ALLMULTI
 0x200

	)

37 
	#IFF_MASTER
 0x400

	)

38 
	#IFF_SLAVE
 0x800

	)

40 
	#IFF_MULTICAST
 0x1000

	)

42 
	#IFF_PORTSEL
 0x2000

	)

43 
	#IFF_AUTOMEDIA
 0x4000

	)

44 
	#IFF_DYNAMIC
 0x8000

	)

46 
	#IFF_LOWER_UP
 0x10000

	)

47 
	#IFF_DORMANT
 0x20000

	)

49 
	#IFF_ECHO
 0x40000

	)

51 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

52 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

55 
	#IFF_802_1Q_VLAN
 0x1

	)

56 
	#IFF_EBRIDGE
 0x2

	)

57 
	#IFF_SLAVE_INACTIVE
 0x4

	)

58 
	#IFF_MASTER_8023AD
 0x8

	)

59 
	#IFF_MASTER_ALB
 0x10

	)

60 
	#IFF_BONDING
 0x20

	)

61 
	#IFF_SLAVE_NEEDARP
 0x40

	)

62 
	#IFF_ISATAP
 0x80

	)

63 
	#IFF_MASTER_ARPMON
 0x100

	)

64 
	#IFF_WAN_HDLC
 0x200

	)

65 
	#IFF_XMIT_DST_RELEASE
 0x400

	)

68 
	#IFF_DONT_BRIDGE
 0x800

	)

69 
	#IFF_IN_NETPOLL
 0x1000

	)

70 
	#IFF_DISABLE_NETPOLL
 0x2000

	)

71 
	#IFF_MACVLAN_PORT
 0x4000

	)

72 
	#IFF_BRIDGE_PORT
 0x8000

	)

73 
	#IFF_OVS_DATAPATH
 0x10000

	)

76 
	#IF_GET_IFACE
 0x0001

	)

77 
	#IF_GET_PROTO
 0x0002

	)

80 
	#IF_IFACE_V35
 0x1000

	)

81 
	#IF_IFACE_V24
 0x1001

	)

82 
	#IF_IFACE_X21
 0x1002

	)

83 
	#IF_IFACE_T1
 0x1003

	)

84 
	#IF_IFACE_E1
 0x1004

	)

85 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

86 
	#IF_IFACE_X21D
 0x1006

	)

89 
	#IF_PROTO_HDLC
 0x2000

	)

90 
	#IF_PROTO_PPP
 0x2001

	)

91 
	#IF_PROTO_CISCO
 0x2002

	)

92 
	#IF_PROTO_FR
 0x2003

	)

93 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

94 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

95 
	#IF_PROTO_X25
 0x2006

	)

96 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

97 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

98 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

99 
	#IF_PROTO_FR_PVC
 0x200A

	)

100 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

101 
	#IF_PROTO_RAW
 0x200C

	)

105 
	mIF_OPER_UNKNOWN
,

106 
	mIF_OPER_NOTPRESENT
,

107 
	mIF_OPER_DOWN
,

108 
	mIF_OPER_LOWERLAYERDOWN
,

109 
	mIF_OPER_TESTING
,

110 
	mIF_OPER_DORMANT
,

111 
	mIF_OPER_UP
,

116 
	mIF_LINK_MODE_DEFAULT
,

117 
	mIF_LINK_MODE_DORMANT
,

122 
	mIF_CARRIER_DOWN
,

123 
	mIF_CARRIER_UP


136 
	sifm­
 {

137 
	mmem_¡¬t
;

138 
	mmem_’d
;

139 
	mba£_addr
;

140 
	mœq
;

141 
	mdma
;

142 
	mpÜt
;

	@mylibnl/libnl-3.2.25/include/linux/if_addr.h

1 #iâdeà
__LINUX_IF_ADDR_H


2 
	#__LINUX_IF_ADDR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	siçddrmsg
 {

8 
__u8
 
	miç_çmy
;

9 
__u8
 
	miç_´efixËn
;

10 
__u8
 
	miç_æags
;

11 
__u8
 
	miç_scİe
;

12 
__u32
 
	miç_šdex
;

26 
	mIFA_UNSPEC
,

27 
	mIFA_ADDRESS
,

28 
	mIFA_LOCAL
,

29 
	mIFA_LABEL
,

30 
	mIFA_BROADCAST
,

31 
	mIFA_ANYCAST
,

32 
	mIFA_CACHEINFO
,

33 
	mIFA_MULTICAST
,

34 
	mIFA_FLAGS
,

35 
	m__IFA_MAX
,

38 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

41 
	#IFA_F_SECONDARY
 0x01

	)

42 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

44 
	#IFA_F_NODAD
 0x02

	)

45 
	#IFA_F_OPTIMISTIC
 0x04

	)

46 
	#IFA_F_DADFAILED
 0x08

	)

47 
	#IFA_F_HOMEADDRESS
 0x10

	)

48 
	#IFA_F_DEPRECATED
 0x20

	)

49 
	#IFA_F_TENTATIVE
 0x40

	)

50 
	#IFA_F_PERMANENT
 0x80

	)

51 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

52 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

54 
	siç_ÿchešfo
 {

55 
__u32
 
	miç_´eã»d
;

56 
__u32
 
	miç_v®id
;

57 
__u32
 
	mc¡amp
;

58 
__u32
 
	mt¡amp
;

	@mylibnl/libnl-3.2.25/include/linux/if_arp.h

23 #iâdeà
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<lšux/Ãtdeviû.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

89 
	#ARPHRD_IEEE802154
 804

	)

91 
	#ARPHRD_PHONET
 820

	)

92 
	#ARPHRD_PHONET_PIPE
 821

	)

93 
	#ARPHRD_CAIF
 822

	)

95 
	#ARPHRD_VOID
 0xFFFF

	)

96 
	#ARPHRD_NONE
 0xFFFE

	)

99 
	#ARPOP_REQUEST
 1

	)

100 
	#ARPOP_REPLY
 2

	)

101 
	#ARPOP_RREQUEST
 3

	)

102 
	#ARPOP_RREPLY
 4

	)

103 
	#ARPOP_InREQUEST
 8

	)

104 
	#ARPOP_InREPLY
 9

	)

105 
	#ARPOP_NAK
 10

	)

109 
	s¬´eq
 {

110 
sockaddr
 
	m¬p_·
;

111 
sockaddr
 
	m¬p_ha
;

112 
	m¬p_æags
;

113 
sockaddr
 
	m¬p_Ãtmask
;

114 
	m¬p_dev
[16];

117 
	s¬´eq_Şd
 {

118 
sockaddr
 
	m¬p_·
;

119 
sockaddr
 
	m¬p_ha
;

120 
	m¬p_æags
;

121 
sockaddr
 
	m¬p_Ãtmask
;

125 
	#ATF_COM
 0x02

	)

126 
	#ATF_PERM
 0x04

	)

127 
	#ATF_PUBL
 0x08

	)

128 
	#ATF_USETRAILERS
 0x10

	)

129 
	#ATF_NETMASK
 0x20

	)

131 
	#ATF_DONTPUB
 0x40

	)

137 
	s¬phdr
 {

138 
__be16
 
	m¬_hrd
;

139 
__be16
 
	m¬_´o
;

140 
	m¬_hÊ
;

141 
	m¬_¶n
;

142 
__be16
 
	m¬_İ
;

148 
	m¬_sha
[
ETH_ALEN
];

149 
	m¬_s
[4];

150 
	m¬_tha
[
ETH_ALEN
];

151 
	m¬_t
[4];

	@mylibnl/libnl-3.2.25/include/linux/if_bridge.h

13 #iâdeà
_UAPI_LINUX_IF_BRIDGE_H


14 
	#_UAPI_LINUX_IF_BRIDGE_H


	)

16 
	~<lšux/ty³s.h
>

18 
	#SYSFS_BRIDGE_ATTR
 "bridge"

	)

19 
	#SYSFS_BRIDGE_FDB
 "brfÜw¬d"

	)

20 
	#SYSFS_BRIDGE_PORT_SUBDIR
 "brif"

	)

21 
	#SYSFS_BRIDGE_PORT_ATTR
 "b½Üt"

	)

22 
	#SYSFS_BRIDGE_PORT_LINK
 "bridge"

	)

24 
	#BRCTL_VERSION
 1

	)

26 
	#BRCTL_GET_VERSION
 0

	)

27 
	#BRCTL_GET_BRIDGES
 1

	)

28 
	#BRCTL_ADD_BRIDGE
 2

	)

29 
	#BRCTL_DEL_BRIDGE
 3

	)

30 
	#BRCTL_ADD_IF
 4

	)

31 
	#BRCTL_DEL_IF
 5

	)

32 
	#BRCTL_GET_BRIDGE_INFO
 6

	)

33 
	#BRCTL_GET_PORT_LIST
 7

	)

34 
	#BRCTL_SET_BRIDGE_FORWARD_DELAY
 8

	)

35 
	#BRCTL_SET_BRIDGE_HELLO_TIME
 9

	)

36 
	#BRCTL_SET_BRIDGE_MAX_AGE
 10

	)

37 
	#BRCTL_SET_AGEING_TIME
 11

	)

38 
	#BRCTL_SET_GC_INTERVAL
 12

	)

39 
	#BRCTL_GET_PORT_INFO
 13

	)

40 
	#BRCTL_SET_BRIDGE_STP_STATE
 14

	)

41 
	#BRCTL_SET_BRIDGE_PRIORITY
 15

	)

42 
	#BRCTL_SET_PORT_PRIORITY
 16

	)

43 
	#BRCTL_SET_PATH_COST
 17

	)

44 
	#BRCTL_GET_FDB_ENTRIES
 18

	)

46 
	#BR_STATE_DISABLED
 0

	)

47 
	#BR_STATE_LISTENING
 1

	)

48 
	#BR_STATE_LEARNING
 2

	)

49 
	#BR_STATE_FORWARDING
 3

	)

50 
	#BR_STATE_BLOCKING
 4

	)

52 
	s__bridge_šfo
 {

53 
__u64
 
	mdesigÇ‹d_roÙ
;

54 
__u64
 
	mbridge_id
;

55 
__u32
 
	mroÙ_·th_co¡
;

56 
__u32
 
	mmax_age
;

57 
__u32
 
	mh–lo_time
;

58 
__u32
 
	mfÜw¬d_d–ay
;

59 
__u32
 
	mbridge_max_age
;

60 
__u32
 
	mbridge_h–lo_time
;

61 
__u32
 
	mbridge_fÜw¬d_d–ay
;

62 
__u8
 
	mtİŞogy_chªge
;

63 
__u8
 
	mtİŞogy_chªge_d‘eùed
;

64 
__u8
 
	mroÙ_pÜt
;

65 
__u8
 
	m¡p_’abËd
;

66 
__u32
 
	magešg_time
;

67 
__u32
 
	mgc_š‹rv®
;

68 
__u32
 
	mh–lo_tim”_v®ue
;

69 
__u32
 
	mtú_tim”_v®ue
;

70 
__u32
 
	mtİŞogy_chªge_tim”_v®ue
;

71 
__u32
 
	mgc_tim”_v®ue
;

74 
	s__pÜt_šfo
 {

75 
__u64
 
	mdesigÇ‹d_roÙ
;

76 
__u64
 
	mdesigÇ‹d_bridge
;

77 
__u16
 
	mpÜt_id
;

78 
__u16
 
	mdesigÇ‹d_pÜt
;

79 
__u32
 
	m·th_co¡
;

80 
__u32
 
	mdesigÇ‹d_co¡
;

81 
__u8
 
	m¡©e
;

82 
__u8
 
	mtİ_chªge_ack
;

83 
__u8
 
	mcÚfig_³ndšg
;

84 
__u8
 
	munu£d0
;

85 
__u32
 
	mmes§ge_age_tim”_v®ue
;

86 
__u32
 
	mfÜw¬d_d–ay_tim”_v®ue
;

87 
__u32
 
	mhŞd_tim”_v®ue
;

90 
	s__fdb_’Œy
 {

91 
__u8
 
	mmac_addr
[6];

92 
__u8
 
	mpÜt_no
;

93 
__u8
 
	mis_loÿl
;

94 
__u32
 
	magešg_tim”_v®ue
;

95 
__u8
 
	mpÜt_hi
;

96 
__u8
 
	m·d0
;

97 
__u16
 
	munu£d
;

101 
	#BRIDGE_FLAGS_MASTER
 1

	)

102 
	#BRIDGE_FLAGS_SELF
 2

	)

104 
	#BRIDGE_MODE_VEB
 0

	)

105 
	#BRIDGE_MODE_VEPA
 1

	)

114 
	mIFLA_BRIDGE_FLAGS
,

115 
	mIFLA_BRIDGE_MODE
,

116 
	m__IFLA_BRIDGE_MAX
,

118 
	#IFLA_BRIDGE_MAX
 (
__IFLA_BRIDGE_MAX
 - 1)

	)

131 
	mMDBA_UNSPEC
,

132 
	mMDBA_MDB
,

133 
	mMDBA_ROUTER
,

134 
	m__MDBA_MAX
,

136 
	#MDBA_MAX
 (
__MDBA_MAX
 - 1)

	)

139 
	mMDBA_MDB_UNSPEC
,

140 
	mMDBA_MDB_ENTRY
,

141 
	m__MDBA_MDB_MAX
,

143 
	#MDBA_MDB_MAX
 (
__MDBA_MDB_MAX
 - 1)

	)

146 
	mMDBA_MDB_ENTRY_UNSPEC
,

147 
	mMDBA_MDB_ENTRY_INFO
,

148 
	m__MDBA_MDB_ENTRY_MAX
,

150 
	#MDBA_MDB_ENTRY_MAX
 (
__MDBA_MDB_ENTRY_MAX
 - 1)

	)

153 
	mMDBA_ROUTER_UNSPEC
,

154 
	mMDBA_ROUTER_PORT
,

155 
	m__MDBA_ROUTER_MAX
,

157 
	#MDBA_ROUTER_MAX
 (
__MDBA_ROUTER_MAX
 - 1)

	)

159 
	sbr_pÜt_msg
 {

160 
__u8
 
	mçmy
;

161 
__u32
 
	mifšdex
;

164 
	sbr_mdb_’Œy
 {

165 
__u32
 
	mifšdex
;

166 
	#MDB_TEMPORARY
 0

	)

167 
	#MDB_PERMANENT
 1

	)

168 
__u8
 
	m¡©e
;

171 
__be32
 
	m4
;

172 
š6_addr
 
	m6
;

173 } 
	mu
;

174 
__be16
 
	m´Ùo
;

175 } 
	maddr
;

179 
	mMDBA_SET_ENTRY_UNSPEC
,

180 
	mMDBA_SET_ENTRY
,

181 
	m__MDBA_SET_ENTRY_MAX
,

183 
	#MDBA_SET_ENTRY_MAX
 (
__MDBA_SET_ENTRY_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_IP
 0x0800

	)

46 
	#ETH_P_X25
 0x0805

	)

47 
	#ETH_P_ARP
 0x0806

	)

48 
	#ETH_P_BPQ
 0x08FF

	)

49 
	#ETH_P_IEEEPUP
 0x0a00

	)

50 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

51 
	#ETH_P_DEC
 0x6000

	)

52 
	#ETH_P_DNA_DL
 0x6001

	)

53 
	#ETH_P_DNA_RC
 0x6002

	)

54 
	#ETH_P_DNA_RT
 0x6003

	)

55 
	#ETH_P_LAT
 0x6004

	)

56 
	#ETH_P_DIAG
 0x6005

	)

57 
	#ETH_P_CUST
 0x6006

	)

58 
	#ETH_P_SCA
 0x6007

	)

59 
	#ETH_P_TEB
 0x6558

	)

60 
	#ETH_P_RARP
 0x8035

	)

61 
	#ETH_P_ATALK
 0x809B

	)

62 
	#ETH_P_AARP
 0x80F3

	)

63 
	#ETH_P_8021Q
 0x8100

	)

64 
	#ETH_P_IPX
 0x8137

	)

65 
	#ETH_P_IPV6
 0x86DD

	)

66 
	#ETH_P_PAUSE
 0x8808

	)

67 
	#ETH_P_SLOW
 0x8809

	)

68 
	#ETH_P_WCCP
 0x883E

	)

70 
	#ETH_P_PPP_DISC
 0x8863

	)

71 
	#ETH_P_PPP_SES
 0x8864

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_LINK_CTL
 0x886ø

	)

76 
	#ETH_P_ATMFATE
 0x8884

	)

79 
	#ETH_P_PAE
 0x888E

	)

80 
	#ETH_P_AOE
 0x88A2

	)

81 
	#ETH_P_TIPC
 0x88CA

	)

82 
	#ETH_P_1588
 0x88F7

	)

83 
	#ETH_P_FCOE
 0x8906

	)

84 
	#ETH_P_FIP
 0x8914

	)

85 
	#ETH_P_EDSA
 0xDADA

	)

91 
	#ETH_P_802_3
 0x0001

	)

92 
	#ETH_P_AX25
 0x0002

	)

93 
	#ETH_P_ALL
 0x0003

	)

94 
	#ETH_P_802_2
 0x0004

	)

95 
	#ETH_P_SNAP
 0x0005

	)

96 
	#ETH_P_DDCMP
 0x0006

	)

97 
	#ETH_P_WAN_PPP
 0x0007

	)

98 
	#ETH_P_PPP_MP
 0x0008

	)

99 
	#ETH_P_LOCALTALK
 0x0009

	)

100 
	#ETH_P_CAN
 0x000C

	)

101 
	#ETH_P_PPPTALK
 0x0010

	)

102 
	#ETH_P_TR_802_2
 0x0011

	)

103 
	#ETH_P_MOBITEX
 0x0015

	)

104 
	#ETH_P_CONTROL
 0x0016

	)

105 
	#ETH_P_IRDA
 0x0017

	)

106 
	#ETH_P_ECONET
 0x0018

	)

107 
	#ETH_P_HDLC
 0x0019

	)

108 
	#ETH_P_ARCNET
 0x001A

	)

109 
	#ETH_P_DSA
 0x001B

	)

110 
	#ETH_P_TRAILER
 0x001C

	)

111 
	#ETH_P_PHONET
 0x00F5

	)

112 
	#ETH_P_IEEE802154
 0x00F6

	)

113 
	#ETH_P_CAIF
 0x00F7

	)

119 
	s‘hhdr
 {

120 
	mh_de¡
[
ETH_ALEN
];

121 
	mh_sourû
[
ETH_ALEN
];

122 
__be16
 
	mh_´Ùo
;

123 } 
__©Œibu‹__
((
·cked
));

	@mylibnl/libnl-3.2.25/include/linux/if_link.h

1 #iâdeà
_UAPI_LINUX_IF_LINK_H


2 
	#_UAPI_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

41 
	s¹Æ_lšk_¡©s64
 {

42 
__u64
 
	mrx_·ck‘s
;

43 
__u64
 
	mtx_·ck‘s
;

44 
__u64
 
	mrx_by‹s
;

45 
__u64
 
	mtx_by‹s
;

46 
__u64
 
	mrx_”rÜs
;

47 
__u64
 
	mtx_”rÜs
;

48 
__u64
 
	mrx_drİ³d
;

49 
__u64
 
	mtx_drİ³d
;

50 
__u64
 
	mmuÉiÿ¡
;

51 
__u64
 
	mcŞlisiÚs
;

54 
__u64
 
	mrx_Ëngth_”rÜs
;

55 
__u64
 
	mrx_ov”_”rÜs
;

56 
__u64
 
	mrx_üc_”rÜs
;

57 
__u64
 
	mrx_äame_”rÜs
;

58 
__u64
 
	mrx_fifo_”rÜs
;

59 
__u64
 
	mrx_mis£d_”rÜs
;

62 
__u64
 
	mtx_abÜ‹d_”rÜs
;

63 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

64 
__u64
 
	mtx_fifo_”rÜs
;

65 
__u64
 
	mtx_h—¹b—t_”rÜs
;

66 
__u64
 
	mtx_wšdow_”rÜs
;

69 
__u64
 
	mrx_com´es£d
;

70 
__u64
 
	mtx_com´es£d
;

74 
	s¹Æ_lšk_ifm­
 {

75 
__u64
 
	mmem_¡¬t
;

76 
__u64
 
	mmem_’d
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	mœq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mpÜt
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	mIFLA_EXT_MASK
,

141 
	mIFLA_PROMISCUITY
,

142 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

143 
	mIFLA_NUM_TX_QUEUES
,

144 
	mIFLA_NUM_RX_QUEUES
,

145 
	mIFLA_CARRIER
,

146 
	mIFLA_PHYS_PORT_ID
,

147 
	m__IFLA_MAX


151 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

154 
	mIFLA_INET_UNSPEC
,

155 
	mIFLA_INET_CONF
,

156 
	m__IFLA_INET_MAX
,

159 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

192 
	mIFLA_INET6_UNSPEC
,

193 
	mIFLA_INET6_FLAGS
,

194 
	mIFLA_INET6_CONF
,

195 
	mIFLA_INET6_STATS
,

196 
	mIFLA_INET6_MCAST
,

197 
	mIFLA_INET6_CACHEINFO
,

198 
	mIFLA_INET6_ICMP6STATS
,

199 
	m__IFLA_INET6_MAX


202 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

205 
	mBRIDGE_MODE_UNSPEC
,

206 
	mBRIDGE_MODE_HAIRPIN
,

210 
	mIFLA_BRPORT_UNSPEC
,

211 
	mIFLA_BRPORT_STATE
,

212 
	mIFLA_BRPORT_PRIORITY
,

213 
	mIFLA_BRPORT_COST
,

214 
	mIFLA_BRPORT_MODE
,

215 
	mIFLA_BRPORT_GUARD
,

216 
	mIFLA_BRPORT_PROTECT
,

217 
	mIFLA_BRPORT_FAST_LEAVE
,

218 
	m__IFLA_BRPORT_MAX


220 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

222 
	siæa_ÿchešfo
 {

223 
__u32
 
	mmax_»asm_Ën
;

224 
__u32
 
	mt¡amp
;

225 
__u32
 
	m»achabË_time
;

226 
__u32
 
	m»Œªs_time
;

230 
	mIFLA_INFO_UNSPEC
,

231 
	mIFLA_INFO_KIND
,

232 
	mIFLA_INFO_DATA
,

233 
	mIFLA_INFO_XSTATS
,

234 
	m__IFLA_INFO_MAX
,

237 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

242 
	mIFLA_VLAN_UNSPEC
,

243 
	mIFLA_VLAN_ID
,

244 
	mIFLA_VLAN_FLAGS
,

245 
	mIFLA_VLAN_EGRESS_QOS
,

246 
	mIFLA_VLAN_INGRESS_QOS
,

247 
	mIFLA_VLAN_PROTOCOL
,

248 
	m__IFLA_VLAN_MAX
,

251 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

253 
	siæa_vÏn_æags
 {

254 
__u32
 
	mæags
;

255 
__u32
 
	mmask
;

259 
	mIFLA_VLAN_QOS_UNSPEC
,

260 
	mIFLA_VLAN_QOS_MAPPING
,

261 
	m__IFLA_VLAN_QOS_MAX


264 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

266 
	siæa_vÏn_qos_m­pšg
 {

267 
__u32
 
	mäom
;

268 
__u32
 
	mto
;

273 
	mIFLA_MACVLAN_UNSPEC
,

274 
	mIFLA_MACVLAN_MODE
,

275 
	mIFLA_MACVLAN_FLAGS
,

276 
	m__IFLA_MACVLAN_MAX
,

279 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

281 
	emacvÏn_mode
 {

282 
	mMACVLAN_MODE_PRIVATE
 = 1,

283 
	mMACVLAN_MODE_VEPA
 = 2,

284 
	mMACVLAN_MODE_BRIDGE
 = 4,

285 
	mMACVLAN_MODE_PASSTHRU
 = 8,

288 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

292 
	mIFLA_VXLAN_UNSPEC
,

293 
	mIFLA_VXLAN_ID
,

294 
	mIFLA_VXLAN_GROUP
,

295 
	mIFLA_VXLAN_LINK
,

296 
	mIFLA_VXLAN_LOCAL
,

297 
	mIFLA_VXLAN_TTL
,

298 
	mIFLA_VXLAN_TOS
,

299 
	mIFLA_VXLAN_LEARNING
,

300 
	mIFLA_VXLAN_AGEING
,

301 
	mIFLA_VXLAN_LIMIT
,

302 
	mIFLA_VXLAN_PORT_RANGE
,

303 
	mIFLA_VXLAN_PROXY
,

304 
	mIFLA_VXLAN_RSC
,

305 
	mIFLA_VXLAN_L2MISS
,

306 
	mIFLA_VXLAN_L3MISS
,

307 
	m__IFLA_VXLAN_MAX


309 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

311 
	siæa_vxÏn_pÜt_¿nge
 {

312 
__be16
 
	mlow
;

313 
__be16
 
	mhigh
;

317 
	mVETH_INFO_UNSPEC
,

318 
	mVETH_INFO_PEER
,

320 
	m__VETH_INFO_MAX


321 
	#VETH_INFO_MAX
 (
__VETH_INFO_MAX
 - 1)

	)

327 
	mIFLA_VF_INFO_UNSPEC
,

328 
	mIFLA_VF_INFO
,

329 
	m__IFLA_VF_INFO_MAX
,

332 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

335 
	mIFLA_VF_UNSPEC
,

336 
	mIFLA_VF_MAC
,

337 
	mIFLA_VF_VLAN
,

338 
	mIFLA_VF_TX_RATE
,

339 
	mIFLA_VF_SPOOFCHK
,

340 
	m__IFLA_VF_MAX
,

343 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

345 
	siæa_vf_mac
 {

346 
__u32
 
	mvf
;

347 
__u8
 
	mmac
[32];

350 
	siæa_vf_vÏn
 {

351 
__u32
 
	mvf
;

352 
__u32
 
	mvÏn
;

353 
__u32
 
	mqos
;

356 
	siæa_vf_tx_¿‹
 {

357 
__u32
 
	mvf
;

358 
__u32
 
	m¿‹
;

361 
	siæa_vf_¥oofchk
 {

362 
__u32
 
	mvf
;

363 
__u32
 
	m£‰šg
;

382 
	mIFLA_VF_PORT_UNSPEC
,

383 
	mIFLA_VF_PORT
,

384 
	m__IFLA_VF_PORT_MAX
,

387 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

390 
	mIFLA_PORT_UNSPEC
,

391 
	mIFLA_PORT_VF
,

392 
	mIFLA_PORT_PROFILE
,

393 
	mIFLA_PORT_VSI_TYPE
,

394 
	mIFLA_PORT_INSTANCE_UUID
,

395 
	mIFLA_PORT_HOST_UUID
,

396 
	mIFLA_PORT_REQUEST
,

397 
	mIFLA_PORT_RESPONSE
,

398 
	m__IFLA_PORT_MAX
,

401 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

403 
	#PORT_PROFILE_MAX
 40

	)

404 
	#PORT_UUID_MAX
 16

	)

405 
	#PORT_SELF_VF
 -1

	)

408 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

409 
	mPORT_REQUEST_PREASSOCIATE_RR
,

410 
	mPORT_REQUEST_ASSOCIATE
,

411 
	mPORT_REQUEST_DISASSOCIATE
,

415 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

416 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

417 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

418 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

419 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

420 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

421 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

423 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

424 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

425 
	mPORT_PROFILE_RESPONSE_INVALID
,

426 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

427 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

428 
	mPORT_PROFILE_RESPONSE_ERROR
,

431 
	siæa_pÜt_vsi
 {

432 
__u8
 
	mvsi_mgr_id
;

433 
__u8
 
	mvsi_ty³_id
[3];

434 
__u8
 
	mvsi_ty³_v”siÚ
;

435 
__u8
 
	m·d
[3];

442 
	mIFLA_IPOIB_UNSPEC
,

443 
	mIFLA_IPOIB_PKEY
,

444 
	mIFLA_IPOIB_MODE
,

445 
	mIFLA_IPOIB_UMCAST
,

446 
	m__IFLA_IPOIB_MAX


450 
	mIPOIB_MODE_DATAGRAM
 = 0,

451 
	mIPOIB_MODE_CONNECTED
 = 1,

454 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/if_tunnel.h

1 #iâdeà
_UAPI_IF_TUNNEL_H_


2 
	#_UAPI_IF_TUNNEL_H_


	)

4 
	~<lšux/ty³s.h
>

5 
	~<asm/by‹Üd”.h
>

8 
	#SIOCGETTUNNEL
 (
SIOCDEVPRIVATE
 + 0)

	)

9 
	#SIOCADDTUNNEL
 (
SIOCDEVPRIVATE
 + 1)

	)

10 
	#SIOCDELTUNNEL
 (
SIOCDEVPRIVATE
 + 2)

	)

11 
	#SIOCCHGTUNNEL
 (
SIOCDEVPRIVATE
 + 3)

	)

12 
	#SIOCGETPRL
 (
SIOCDEVPRIVATE
 + 4)

	)

13 
	#SIOCADDPRL
 (
SIOCDEVPRIVATE
 + 5)

	)

14 
	#SIOCDELPRL
 (
SIOCDEVPRIVATE
 + 6)

	)

15 
	#SIOCCHGPRL
 (
SIOCDEVPRIVATE
 + 7)

	)

16 
	#SIOCGET6RD
 (
SIOCDEVPRIVATE
 + 8)

	)

17 
	#SIOCADD6RD
 (
SIOCDEVPRIVATE
 + 9)

	)

18 
	#SIOCDEL6RD
 (
SIOCDEVPRIVATE
 + 10)

	)

19 
	#SIOCCHG6RD
 (
SIOCDEVPRIVATE
 + 11)

	)

21 
	#GRE_CSUM
 
	`__ıu_to_be16
(0x8000)

	)

22 
	#GRE_ROUTING
 
	`__ıu_to_be16
(0x4000)

	)

23 
	#GRE_KEY
 
	`__ıu_to_be16
(0x2000)

	)

24 
	#GRE_SEQ
 
	`__ıu_to_be16
(0x1000)

	)

25 
	#GRE_STRICT
 
	`__ıu_to_be16
(0x0800)

	)

26 
	#GRE_REC
 
	`__ıu_to_be16
(0x0700)

	)

27 
	#GRE_FLAGS
 
	`__ıu_to_be16
(0x00F8)

	)

28 
	#GRE_VERSION
 
	`__ıu_to_be16
(0x0007)

	)

30 
	s_tuÂ–_·rm
 {

31 
	mÇme
[
IFNAMSIZ
];

32 
	mlšk
;

33 
__be16
 
	mi_æags
;

34 
__be16
 
	mo_æags
;

35 
__be32
 
	mi_key
;

36 
__be32
 
	mo_key
;

37 
hdr
 
	mh
;

41 
	mIFLA_IPTUN_UNSPEC
,

42 
	mIFLA_IPTUN_LINK
,

43 
	mIFLA_IPTUN_LOCAL
,

44 
	mIFLA_IPTUN_REMOTE
,

45 
	mIFLA_IPTUN_TTL
,

46 
	mIFLA_IPTUN_TOS
,

47 
	mIFLA_IPTUN_ENCAP_LIMIT
,

48 
	mIFLA_IPTUN_FLOWINFO
,

49 
	mIFLA_IPTUN_FLAGS
,

50 
	mIFLA_IPTUN_PROTO
,

51 
	mIFLA_IPTUN_PMTUDISC
,

52 
	mIFLA_IPTUN_6RD_PREFIX
,

53 
	mIFLA_IPTUN_6RD_RELAY_PREFIX
,

54 
	mIFLA_IPTUN_6RD_PREFIXLEN
,

55 
	mIFLA_IPTUN_6RD_RELAY_PREFIXLEN
,

56 
	m__IFLA_IPTUN_MAX
,

58 
	#IFLA_IPTUN_MAX
 (
__IFLA_IPTUN_MAX
 - 1)

	)

61 
	#SIT_ISATAP
 0x0001

	)

63 
	s_tuÂ–_´l
 {

64 
__be32
 
	maddr
;

65 
__u16
 
	mæags
;

66 
__u16
 
	m__»£rved
;

67 
__u32
 
	md©®’
;

68 
__u32
 
	m__»£rved2
;

73 
	#PRL_DEFAULT
 0x0001

	)

75 
	s_tuÂ–_6rd
 {

76 
š6_addr
 
	m´efix
;

77 
__be32
 
	m»Ïy_´efix
;

78 
__u16
 
	m´efixËn
;

79 
__u16
 
	m»Ïy_´efixËn
;

83 
	mIFLA_GRE_UNSPEC
,

84 
	mIFLA_GRE_LINK
,

85 
	mIFLA_GRE_IFLAGS
,

86 
	mIFLA_GRE_OFLAGS
,

87 
	mIFLA_GRE_IKEY
,

88 
	mIFLA_GRE_OKEY
,

89 
	mIFLA_GRE_LOCAL
,

90 
	mIFLA_GRE_REMOTE
,

91 
	mIFLA_GRE_TTL
,

92 
	mIFLA_GRE_TOS
,

93 
	mIFLA_GRE_PMTUDISC
,

94 
	mIFLA_GRE_ENCAP_LIMIT
,

95 
	mIFLA_GRE_FLOWINFO
,

96 
	mIFLA_GRE_FLAGS
,

97 
	m__IFLA_GRE_MAX
,

100 
	#IFLA_GRE_MAX
 (
__IFLA_GRE_MAX
 - 1)

	)

103 
	#VTI_ISVTI
 0x0001

	)

106 
	mIFLA_VTI_UNSPEC
,

107 
	mIFLA_VTI_LINK
,

108 
	mIFLA_VTI_IKEY
,

109 
	mIFLA_VTI_OKEY
,

110 
	mIFLA_VTI_LOCAL
,

111 
	mIFLA_VTI_REMOTE
,

112 
	m__IFLA_VTI_MAX
,

115 
	#IFLA_VTI_MAX
 (
__IFLA_VTI_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/if_vlan.h

13 #iâdeà
_LINUX_IF_VLAN_H_


14 
	#_LINUX_IF_VLAN_H_


	)

19 
	evÏn_ioùl_cmds
 {

20 
	mADD_VLAN_CMD
,

21 
	mDEL_VLAN_CMD
,

22 
	mSET_VLAN_INGRESS_PRIORITY_CMD
,

23 
	mSET_VLAN_EGRESS_PRIORITY_CMD
,

24 
	mGET_VLAN_INGRESS_PRIORITY_CMD
,

25 
	mGET_VLAN_EGRESS_PRIORITY_CMD
,

26 
	mSET_VLAN_NAME_TYPE_CMD
,

27 
	mSET_VLAN_FLAG_CMD
,

28 
	mGET_VLAN_REALDEV_NAME_CMD
,

29 
	mGET_VLAN_VID_CMD


32 
	evÏn_æags
 {

33 
	mVLAN_FLAG_REORDER_HDR
 = 0x1,

34 
	mVLAN_FLAG_GVRP
 = 0x2,

35 
	mVLAN_FLAG_LOOSE_BINDING
 = 0x4,

38 
	evÏn_Çme_ty³s
 {

39 
	mVLAN_NAME_TYPE_PLUS_VID
,

40 
	mVLAN_NAME_TYPE_RAW_PLUS_VID
,

41 
	mVLAN_NAME_TYPE_PLUS_VID_NO_PAD
,

42 
	mVLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD
,

43 
	mVLAN_NAME_TYPE_HIGHEST


46 
	svÏn_ioùl_¬gs
 {

47 
	mcmd
;

48 
	mdeviû1
[24];

51 
	mdeviû2
[24];

52 
	mVID
;

53 
	mskb_´iÜ™y
;

54 
	mÇme_ty³
;

55 
	mbšd_ty³
;

56 
	mæag
;

57 } 
	mu
;

59 
	mvÏn_qos
;

	@mylibnl/libnl-3.2.25/include/linux/ip.h

17 #iâdeà
_UAPI_LINUX_IP_H


18 
	#_UAPI_LINUX_IP_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<asm/by‹Üd”.h
>

22 
	#IPTOS_TOS_MASK
 0x1E

	)

23 
	#IPTOS_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

24 
	#IPTOS_LOWDELAY
 0x10

	)

25 
	#IPTOS_THROUGHPUT
 0x08

	)

26 
	#IPTOS_RELIABILITY
 0x04

	)

27 
	#IPTOS_MINCOST
 0x02

	)

29 
	#IPTOS_PREC_MASK
 0xE0

	)

30 
	#IPTOS_PREC
(
tos
è(Ños)&
IPTOS_PREC_MASK
)

	)

31 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

32 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

33 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

34 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

35 
	#IPTOS_PREC_FLASH
 0x60

	)

36 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

37 
	#IPTOS_PREC_PRIORITY
 0x20

	)

38 
	#IPTOS_PREC_ROUTINE
 0x00

	)

42 
	#IPOPT_COPY
 0x80

	)

43 
	#IPOPT_CLASS_MASK
 0x60

	)

44 
	#IPOPT_NUMBER_MASK
 0x1f

	)

46 
	#IPOPT_COPIED
(
o
è((o)&
IPOPT_COPY
)

	)

47 
	#IPOPT_CLASS
(
o
è((o)&
IPOPT_CLASS_MASK
)

	)

48 
	#IPOPT_NUMBER
(
o
è((o)&
IPOPT_NUMBER_MASK
)

	)

50 
	#IPOPT_CONTROL
 0x00

	)

51 
	#IPOPT_RESERVED1
 0x20

	)

52 
	#IPOPT_MEASUREMENT
 0x40

	)

53 
	#IPOPT_RESERVED2
 0x60

	)

55 
	#IPOPT_END
 (0 |
IPOPT_CONTROL
)

	)

56 
	#IPOPT_NOOP
 (1 |
IPOPT_CONTROL
)

	)

57 
	#IPOPT_SEC
 (2 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

58 
	#IPOPT_LSRR
 (3 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

59 
	#IPOPT_TIMESTAMP
 (4 |
IPOPT_MEASUREMENT
)

	)

60 
	#IPOPT_CIPSO
 (6 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

61 
	#IPOPT_RR
 (7 |
IPOPT_CONTROL
)

	)

62 
	#IPOPT_SID
 (8 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

63 
	#IPOPT_SSRR
 (9 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

64 
	#IPOPT_RA
 (20|
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

66 
	#IPVERSION
 4

	)

67 
	#MAXTTL
 255

	)

68 
	#IPDEFTTL
 64

	)

70 
	#IPOPT_OPTVAL
 0

	)

71 
	#IPOPT_OLEN
 1

	)

72 
	#IPOPT_OFFSET
 2

	)

73 
	#IPOPT_MINOFF
 4

	)

74 
	#MAX_IPOPTLEN
 40

	)

75 
	#IPOPT_NOP
 
IPOPT_NOOP


	)

76 
	#IPOPT_EOL
 
IPOPT_END


	)

77 
	#IPOPT_TS
 
IPOPT_TIMESTAMP


	)

79 
	#IPOPT_TS_TSONLY
 0

	)

80 
	#IPOPT_TS_TSANDADDR
 1

	)

81 
	#IPOPT_TS_PRESPEC
 3

	)

83 
	#IPV4_BEET_PHMAXLEN
 8

	)

85 
	shdr
 {

86 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

87 
__u8
 
	mihl
:4,

88 
	mv”siÚ
:4;

89 #–ià
defšed
 (
__BIG_ENDIAN_BITFIELD
)

90 
__u8
 
	mv”siÚ
:4,

91 
	mihl
:4;

95 
__u8
 
	mtos
;

96 
__be16
 
	mtÙ_Ën
;

97 
__be16
 
	mid
;

98 
__be16
 
	mäag_off
;

99 
__u8
 
	m‰l
;

100 
__u8
 
	m´ÙocŞ
;

101 
__sum16
 
	mcheck
;

102 
__be32
 
	m§ddr
;

103 
__be32
 
	mdaddr
;

108 
	s_auth_hdr
 {

109 
__u8
 
	mÃxthdr
;

110 
__u8
 
	mhd¾’
;

111 
__be16
 
	m»£rved
;

112 
__be32
 
	m¥i
;

113 
__be32
 
	m£q_no
;

114 
__u8
 
	mauth_d©a
[0];

117 
	s_e¥_hdr
 {

118 
__be32
 
	m¥i
;

119 
__be32
 
	m£q_no
;

120 
__u8
 
	m’c_d©a
[0];

123 
	s_comp_hdr
 {

124 
__u8
 
	mÃxthdr
;

125 
__u8
 
	mæags
;

126 
__be16
 
	mıi
;

129 
	s_b“t_phdr
 {

130 
__u8
 
	mÃxthdr
;

131 
__u8
 
	mhd¾’
;

132 
__u8
 
	m·dËn
;

133 
__u8
 
	m»£rved
;

139 
	mIPV4_DEVCONF_FORWARDING
=1,

140 
	mIPV4_DEVCONF_MC_FORWARDING
,

141 
	mIPV4_DEVCONF_PROXY_ARP
,

142 
	mIPV4_DEVCONF_ACCEPT_REDIRECTS
,

143 
	mIPV4_DEVCONF_SECURE_REDIRECTS
,

144 
	mIPV4_DEVCONF_SEND_REDIRECTS
,

145 
	mIPV4_DEVCONF_SHARED_MEDIA
,

146 
	mIPV4_DEVCONF_RP_FILTER
,

147 
	mIPV4_DEVCONF_ACCEPT_SOURCE_ROUTE
,

148 
	mIPV4_DEVCONF_BOOTP_RELAY
,

149 
	mIPV4_DEVCONF_LOG_MARTIANS
,

150 
	mIPV4_DEVCONF_TAG
,

151 
	mIPV4_DEVCONF_ARPFILTER
,

152 
	mIPV4_DEVCONF_MEDIUM_ID
,

153 
	mIPV4_DEVCONF_NOXFRM
,

154 
	mIPV4_DEVCONF_NOPOLICY
,

155 
	mIPV4_DEVCONF_FORCE_IGMP_VERSION
,

156 
	mIPV4_DEVCONF_ARP_ANNOUNCE
,

157 
	mIPV4_DEVCONF_ARP_IGNORE
,

158 
	mIPV4_DEVCONF_PROMOTE_SECONDARIES
,

159 
	mIPV4_DEVCONF_ARP_ACCEPT
,

160 
	mIPV4_DEVCONF_ARP_NOTIFY
,

161 
	mIPV4_DEVCONF_ACCEPT_LOCAL
,

162 
	mIPV4_DEVCONF_SRC_VMARK
,

163 
	mIPV4_DEVCONF_PROXY_ARP_PVLAN
,

164 
	mIPV4_DEVCONF_ROUTE_LOCALNET
,

165 
	mIPV4_DEVCONF_IGMPV2_UNSOLICITED_REPORT_INTERVAL
,

166 
	mIPV4_DEVCONF_IGMPV3_UNSOLICITED_REPORT_INTERVAL
,

167 
	m__IPV4_DEVCONF_MAX


170 
	#IPV4_DEVCONF_MAX
 (
__IPV4_DEVCONF_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/ip_mp_alg.h

7 #iâdeà
_LINUX_IP_MP_ALG_H


8 
	#_LINUX_IP_MP_ALG_H


	)

10 
	e_mp_®g
 {

11 
	mIP_MP_ALG_NONE
,

12 
	mIP_MP_ALG_RR
,

13 
	mIP_MP_ALG_DRR
,

14 
	mIP_MP_ALG_RANDOM
,

15 
	mIP_MP_ALG_WRANDOM
,

16 
	m__IP_MP_ALG_MAX


19 
	#IP_MP_ALG_MAX
 (
__IP_MP_ALG_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/ipv6.h

1 #iâdeà
_IPV6_H


2 
	#_IPV6_H


	)

4 
	~<asm/by‹Üd”.h
>

8 
	#IPV6_MIN_MTU
 1280

	)

17 
	#IPV6_SRCRT_STRICT
 0x01

	)

18 
	#IPV6_SRCRT_TYPE_0
 0

	)

19 
	#IPV6_SRCRT_TYPE_2
 2

	)

24 
	sv6_¹_hdr
 {

25 
__u8
 
	mÃxthdr
;

26 
__u8
 
	mhd¾’
;

27 
__u8
 
	mty³
;

28 
__u8
 
	m£gm’ts_Ëá
;

37 
	sv6_İt_hdr
 {

38 
__u8
 
	mÃxthdr
;

39 
__u8
 
	mhd¾’
;

43 } 
__©Œibu‹__
((
·cked
));

45 
	#v6_de¡İt_hdr
 
v6_İt_hdr


	)

46 
	#v6_hİİt_hdr
 
v6_İt_hdr


	)

53 
	s¹0_hdr
 {

54 
v6_¹_hdr
 
	m¹_hdr
;

55 
__u32
 
	m»£rved
;

56 
š6_addr
 
	maddr
[0];

58 
	#¹0_ty³
 
¹_hdr
.
ty³


	)

65 
	s¹2_hdr
 {

66 
v6_¹_hdr
 
	m¹_hdr
;

67 
__u32
 
	m»£rved
;

68 
š6_addr
 
	maddr
;

70 
	#¹2_ty³
 
¹_hdr
.
ty³


	)

77 
	sv6_de¡İt_hao
 {

78 
__u8
 
	mty³
;

79 
__u8
 
	mËngth
;

80 
š6_addr
 
	maddr
;

81 } 
__©Œibu‹__
((
·cked
));

90 
	sv6hdr
 {

91 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

92 
__u8
 
	m´iÜ™y
:4,

93 
	mv”siÚ
:4;

94 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

95 
__u8
 
	mv”siÚ
:4,

96 
	m´iÜ™y
:4;

100 
__u8
 
	mæow_lbl
[3];

102 
__be16
 
	m·ylßd_Ën
;

103 
__u8
 
	mÃxthdr
;

104 
__u8
 
	mhİ_lim™
;

106 
š6_addr
 
	m§ddr
;

107 
š6_addr
 
	mdaddr
;

113 
	mDEVCONF_FORWARDING
 = 0,

114 
	mDEVCONF_HOPLIMIT
,

115 
	mDEVCONF_MTU6
,

116 
	mDEVCONF_ACCEPT_RA
,

117 
	mDEVCONF_ACCEPT_REDIRECTS
,

118 
	mDEVCONF_AUTOCONF
,

119 
	mDEVCONF_DAD_TRANSMITS
,

120 
	mDEVCONF_RTR_SOLICITS
,

121 
	mDEVCONF_RTR_SOLICIT_INTERVAL
,

122 
	mDEVCONF_RTR_SOLICIT_DELAY
,

123 
	mDEVCONF_USE_TEMPADDR
,

124 
	mDEVCONF_TEMP_VALID_LFT
,

125 
	mDEVCONF_TEMP_PREFERED_LFT
,

126 
	mDEVCONF_REGEN_MAX_RETRY
,

127 
	mDEVCONF_MAX_DESYNC_FACTOR
,

128 
	mDEVCONF_MAX_ADDRESSES
,

129 
	mDEVCONF_FORCE_MLD_VERSION
,

130 
	mDEVCONF_ACCEPT_RA_DEFRTR
,

131 
	mDEVCONF_ACCEPT_RA_PINFO
,

132 
	mDEVCONF_ACCEPT_RA_RTR_PREF
,

133 
	mDEVCONF_RTR_PROBE_INTERVAL
,

134 
	mDEVCONF_ACCEPT_RA_RT_INFO_MAX_PLEN
,

135 
	mDEVCONF_PROXY_NDP
,

136 
	mDEVCONF_OPTIMISTIC_DAD
,

137 
	mDEVCONF_ACCEPT_SOURCE_ROUTE
,

138 
	mDEVCONF_MC_FORWARDING
,

139 
	mDEVCONF_DISABLE_IPV6
,

140 
	mDEVCONF_ACCEPT_DAD
,

141 
	mDEVCONF_FORCE_TLLAO
,

142 
	mDEVCONF_MAX


	@mylibnl/libnl-3.2.25/include/linux/neighbour.h

1 #iâdeà
__LINUX_NEIGHBOUR_H


2 
	#__LINUX_NEIGHBOUR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	sndmsg
 {

8 
__u8
 
	mndm_çmy
;

9 
__u8
 
	mndm_·d1
;

10 
__u16
 
	mndm_·d2
;

11 
__s32
 
	mndm_ifšdex
;

12 
__u16
 
	mndm_¡©e
;

13 
__u8
 
	mndm_æags
;

14 
__u8
 
	mndm_ty³
;

18 
	mNDA_UNSPEC
,

19 
	mNDA_DST
,

20 
	mNDA_LLADDR
,

21 
	mNDA_CACHEINFO
,

22 
	mNDA_PROBES
,

23 
	m__NDA_MAX


26 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

32 
	#NTF_USE
 0x01

	)

33 
	#NTF_PROXY
 0x08

	)

34 
	#NTF_ROUTER
 0x80

	)

40 
	#NUD_INCOMPLETE
 0x01

	)

41 
	#NUD_REACHABLE
 0x02

	)

42 
	#NUD_STALE
 0x04

	)

43 
	#NUD_DELAY
 0x08

	)

44 
	#NUD_PROBE
 0x10

	)

45 
	#NUD_FAILED
 0x20

	)

48 
	#NUD_NOARP
 0x40

	)

49 
	#NUD_PERMANENT
 0x80

	)

50 
	#NUD_NONE
 0x00

	)

57 
	snda_ÿchešfo
 {

58 
__u32
 
	mndm_cÚfœmed
;

59 
__u32
 
	mndm_u£d
;

60 
__u32
 
	mndm_upd©ed
;

61 
__u32
 
	mndm_»fút
;

89 
	sndt_¡©s
 {

90 
__u64
 
	mndts_®locs
;

91 
__u64
 
	mndts_de¡roys
;

92 
__u64
 
	mndts_hash_grows
;

93 
__u64
 
	mndts_»s_çed
;

94 
__u64
 
	mndts_lookups
;

95 
__u64
 
	mndts_h™s
;

96 
__u64
 
	mndts_rcv_´obes_mÿ¡
;

97 
__u64
 
	mndts_rcv_´obes_uÿ¡
;

98 
__u64
 
	mndts_³riodic_gc_runs
;

99 
__u64
 
	mndts_fÜûd_gc_runs
;

103 
	mNDTPA_UNSPEC
,

104 
	mNDTPA_IFINDEX
,

105 
	mNDTPA_REFCNT
,

106 
	mNDTPA_REACHABLE_TIME
,

107 
	mNDTPA_BASE_REACHABLE_TIME
,

108 
	mNDTPA_RETRANS_TIME
,

109 
	mNDTPA_GC_STALETIME
,

110 
	mNDTPA_DELAY_PROBE_TIME
,

111 
	mNDTPA_QUEUE_LEN
,

112 
	mNDTPA_APP_PROBES
,

113 
	mNDTPA_UCAST_PROBES
,

114 
	mNDTPA_MCAST_PROBES
,

115 
	mNDTPA_ANYCAST_DELAY
,

116 
	mNDTPA_PROXY_DELAY
,

117 
	mNDTPA_PROXY_QLEN
,

118 
	mNDTPA_LOCKTIME
,

119 
	m__NDTPA_MAX


121 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

123 
	sndtmsg
 {

124 
__u8
 
	mndtm_çmy
;

125 
__u8
 
	mndtm_·d1
;

126 
__u16
 
	mndtm_·d2
;

129 
	sndt_cÚfig
 {

130 
__u16
 
	mndtc_key_Ën
;

131 
__u16
 
	mndtc_’Œy_size
;

132 
__u32
 
	mndtc_’Œ›s
;

133 
__u32
 
	mndtc_Ï¡_æush
;

134 
__u32
 
	mndtc_Ï¡_¿nd
;

135 
__u32
 
	mndtc_hash_ºd
;

136 
__u32
 
	mndtc_hash_mask
;

137 
__u32
 
	mndtc_hash_chaš_gc
;

138 
__u32
 
	mndtc_´oxy_qËn
;

142 
	mNDTA_UNSPEC
,

143 
	mNDTA_NAME
,

144 
	mNDTA_THRESH1
,

145 
	mNDTA_THRESH2
,

146 
	mNDTA_THRESH3
,

147 
	mNDTA_CONFIG
,

148 
	mNDTA_PARMS
,

149 
	mNDTA_STATS
,

150 
	mNDTA_GC_INTERVAL
,

151 
	m__NDTA_MAX


153 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter.h

1 #iâdeà
__LINUX_NETFILTER_H


2 
	#__LINUX_NETFILTER_H


	)

4 
	~<lšux/ty³s.h
>

7 
	#NF_DROP
 0

	)

8 
	#NF_ACCEPT
 1

	)

9 
	#NF_STOLEN
 2

	)

10 
	#NF_QUEUE
 3

	)

11 
	#NF_REPEAT
 4

	)

12 
	#NF_STOP
 5

	)

13 
	#NF_MAX_VERDICT
 
NF_STOP


	)

17 
	#NF_VERDICT_MASK
 0x0000ffff

	)

18 
	#NF_VERDICT_BITS
 16

	)

20 
	#NF_VERDICT_QMASK
 0xffff0000

	)

21 
	#NF_VERDICT_QBITS
 16

	)

23 
	#NF_QUEUE_NR
(
x
è((((xè<< 
NF_VERDICT_BITS
è& 
NF_VERDICT_QMASK
è| 
NF_QUEUE
)

	)

27 
	#NFC_UNKNOWN
 0x4000

	)

28 
	#NFC_ALTERED
 0x8000

	)

30 
	enf_š‘_hooks
 {

31 
	mNF_INET_PRE_ROUTING
,

32 
	mNF_INET_LOCAL_IN
,

33 
	mNF_INET_FORWARD
,

34 
	mNF_INET_LOCAL_OUT
,

35 
	mNF_INET_POST_ROUTING
,

36 
	mNF_INET_NUMHOOKS


40 
	mNFPROTO_UNSPEC
 = 0,

41 
	mNFPROTO_IPV4
 = 2,

42 
	mNFPROTO_ARP
 = 3,

43 
	mNFPROTO_BRIDGE
 = 7,

44 
	mNFPROTO_IPV6
 = 10,

45 
	mNFPROTO_DECNET
 = 12,

46 
	mNFPROTO_NUMPROTO
,

49 
	unf_š‘_addr
 {

50 
__u32
 
	m®l
[4];

51 
__be32
 
	m
;

52 
__be32
 
	m6
[4];

53 
š_addr
 
	mš
;

54 
š6_addr
 
	mš6
;

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nf_conntrack_common.h

1 #iâdeà
_UAPI_NF_CONNTRACK_COMMON_H


2 
	#_UAPI_NF_CONNTRACK_COMMON_H


	)

6 
	e_cÚÁ¿ck_šfo
 {

8 
	mIP_CT_ESTABLISHED
,

12 
	mIP_CT_RELATED
,

16 
	mIP_CT_NEW
,

19 
	mIP_CT_IS_REPLY
,

21 
	mIP_CT_ESTABLISHED_REPLY
 = 
IP_CT_ESTABLISHED
 + 
IP_CT_IS_REPLY
,

22 
	mIP_CT_RELATED_REPLY
 = 
IP_CT_RELATED
 + 
IP_CT_IS_REPLY
,

23 
	mIP_CT_NEW_REPLY
 = 
IP_CT_NEW
 + 
IP_CT_IS_REPLY
,

25 
	mIP_CT_NUMBER
 = 
IP_CT_IS_REPLY
 * 2 - 1

29 
	e_cÚÁ¿ck_¡©us
 {

31 
	mIPS_EXPECTED_BIT
 = 0,

32 
	mIPS_EXPECTED
 = (1 << 
IPS_EXPECTED_BIT
),

35 
	mIPS_SEEN_REPLY_BIT
 = 1,

36 
	mIPS_SEEN_REPLY
 = (1 << 
IPS_SEEN_REPLY_BIT
),

39 
	mIPS_ASSURED_BIT
 = 2,

40 
	mIPS_ASSURED
 = (1 << 
IPS_ASSURED_BIT
),

43 
	mIPS_CONFIRMED_BIT
 = 3,

44 
	mIPS_CONFIRMED
 = (1 << 
IPS_CONFIRMED_BIT
),

47 
	mIPS_SRC_NAT_BIT
 = 4,

48 
	mIPS_SRC_NAT
 = (1 << 
IPS_SRC_NAT_BIT
),

51 
	mIPS_DST_NAT_BIT
 = 5,

52 
	mIPS_DST_NAT
 = (1 << 
IPS_DST_NAT_BIT
),

55 
	mIPS_NAT_MASK
 = (
IPS_DST_NAT
 | 
IPS_SRC_NAT
),

58 
	mIPS_SEQ_ADJUST_BIT
 = 6,

59 
	mIPS_SEQ_ADJUST
 = (1 << 
IPS_SEQ_ADJUST_BIT
),

62 
	mIPS_SRC_NAT_DONE_BIT
 = 7,

63 
	mIPS_SRC_NAT_DONE
 = (1 << 
IPS_SRC_NAT_DONE_BIT
),

65 
	mIPS_DST_NAT_DONE_BIT
 = 8,

66 
	mIPS_DST_NAT_DONE
 = (1 << 
IPS_DST_NAT_DONE_BIT
),

69 
	mIPS_NAT_DONE_MASK
 = (
IPS_DST_NAT_DONE
 | 
IPS_SRC_NAT_DONE
),

72 
	mIPS_DYING_BIT
 = 9,

73 
	mIPS_DYING
 = (1 << 
IPS_DYING_BIT
),

76 
	mIPS_FIXED_TIMEOUT_BIT
 = 10,

77 
	mIPS_FIXED_TIMEOUT
 = (1 << 
IPS_FIXED_TIMEOUT_BIT
),

80 
	mIPS_TEMPLATE_BIT
 = 11,

81 
	mIPS_TEMPLATE
 = (1 << 
IPS_TEMPLATE_BIT
),

84 
	mIPS_UNTRACKED_BIT
 = 12,

85 
	mIPS_UNTRACKED
 = (1 << 
IPS_UNTRACKED_BIT
),

88 
	mIPS_HELPER_BIT
 = 13,

89 
	mIPS_HELPER
 = (1 << 
IPS_HELPER_BIT
),

93 
	e_cÚÁ¿ck_ev’ts
 {

94 
	mIPCT_NEW
,

95 
	mIPCT_RELATED
,

96 
	mIPCT_DESTROY
,

97 
	mIPCT_REPLY
,

98 
	mIPCT_ASSURED
,

99 
	mIPCT_PROTOINFO
,

100 
	mIPCT_HELPER
,

101 
	mIPCT_MARK
,

102 
	mIPCT_NATSEQADJ
,

103 
	mIPCT_SECMARK
,

106 
	e_cÚÁ¿ck_ex³ù_ev’ts
 {

107 
	mIPEXP_NEW
,

108 
	mIPEXP_DESTROY
,

112 
	#NF_CT_EXPECT_PERMANENT
 0x1

	)

113 
	#NF_CT_EXPECT_INACTIVE
 0x2

	)

114 
	#NF_CT_EXPECT_USERSPACE
 0x4

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink.h

1 #iâdeà
_UAPI_NFNETLINK_H


2 
	#_UAPI_NFNETLINK_H


	)

3 
	~<lšux/ty³s.h
>

4 
	~<lšux/Ãtf‹r/nâ‘lšk_com·t.h
>

6 
	enâ‘lšk_groups
 {

7 
	mNFNLGRP_NONE
,

8 
	#NFNLGRP_NONE
 
NFNLGRP_NONE


	)

9 
	mNFNLGRP_CONNTRACK_NEW
,

10 
	#NFNLGRP_CONNTRACK_NEW
 
NFNLGRP_CONNTRACK_NEW


	)

11 
	mNFNLGRP_CONNTRACK_UPDATE
,

12 
	#NFNLGRP_CONNTRACK_UPDATE
 
NFNLGRP_CONNTRACK_UPDATE


	)

13 
	mNFNLGRP_CONNTRACK_DESTROY
,

14 
	#NFNLGRP_CONNTRACK_DESTROY
 
NFNLGRP_CONNTRACK_DESTROY


	)

15 
	mNFNLGRP_CONNTRACK_EXP_NEW
,

16 
	#NFNLGRP_CONNTRACK_EXP_NEW
 
NFNLGRP_CONNTRACK_EXP_NEW


	)

17 
	mNFNLGRP_CONNTRACK_EXP_UPDATE
,

18 
	#NFNLGRP_CONNTRACK_EXP_UPDATE
 
NFNLGRP_CONNTRACK_EXP_UPDATE


	)

19 
	mNFNLGRP_CONNTRACK_EXP_DESTROY
,

20 
	#NFNLGRP_CONNTRACK_EXP_DESTROY
 
NFNLGRP_CONNTRACK_EXP_DESTROY


	)

21 
	m__NFNLGRP_MAX
,

23 
	#NFNLGRP_MAX
 (
__NFNLGRP_MAX
 - 1)

	)

27 
	snfg’msg
 {

28 
__u8
 
	mnfg’_çmy
;

29 
__u8
 
	mv”siÚ
;

30 
__be16
 
	m»s_id
;

33 
	#NFNETLINK_V0
 0

	)

39 
	#NFNL_SUBSYS_ID
(
x
è((x & 0xff00è>> 8)

	)

40 
	#NFNL_MSG_TYPE
(
x
è(x & 0x00ff)

	)

44 
	#NFNL_SUBSYS_NONE
 0

	)

45 
	#NFNL_SUBSYS_CTNETLINK
 1

	)

46 
	#NFNL_SUBSYS_CTNETLINK_EXP
 2

	)

47 
	#NFNL_SUBSYS_QUEUE
 3

	)

48 
	#NFNL_SUBSYS_ULOG
 4

	)

49 
	#NFNL_SUBSYS_OSF
 5

	)

50 
	#NFNL_SUBSYS_IPSET
 6

	)

51 
	#NFNL_SUBSYS_ACCT
 7

	)

52 
	#NFNL_SUBSYS_CTNETLINK_TIMEOUT
 8

	)

53 
	#NFNL_SUBSYS_CTHELPER
 9

	)

54 
	#NFNL_SUBSYS_COUNT
 10

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_compat.h

1 #iâdeà
_NFNETLINK_COMPAT_H


2 
	#_NFNETLINK_COMPAT_H


	)

4 
	~<lšux/ty³s.h
>

6 #iâdeà
__KERNEL__


10 
	#NF_NETLINK_CONNTRACK_NEW
 0x00000001

	)

11 
	#NF_NETLINK_CONNTRACK_UPDATE
 0x00000002

	)

12 
	#NF_NETLINK_CONNTRACK_DESTROY
 0x00000004

	)

13 
	#NF_NETLINK_CONNTRACK_EXP_NEW
 0x00000008

	)

14 
	#NF_NETLINK_CONNTRACK_EXP_UPDATE
 0x00000010

	)

15 
	#NF_NETLINK_CONNTRACK_EXP_DESTROY
 0x00000020

	)

24 
	snç‰r
 {

25 
__u16
 
	mnç_Ën
;

26 
__u16
 
	mnç_ty³
;

33 
	#NFNL_NFA_NEST
 0x8000

	)

34 
	#NFA_TYPE
(
©Œ
è(×‰r)->
nç_ty³
 & 0x7fff)

	)

36 
	#NFA_ALIGNTO
 4

	)

37 
	#NFA_ALIGN
(
Ën
è((Ö’è+ 
NFA_ALIGNTO
 - 1è& ~(NFA_ALIGNTO - 1))

	)

38 
	#NFA_OK
(
nç
,
Ën
è(Ö’è> 0 && (nç)->
nç_Ën
 >ğ(
nç‰r
) \

39 && (
nç
)->
nç_Ën
 <ğ(
Ën
))

	)

40 
	#NFA_NEXT
(
nç
,
©ŒËn
è(×‰¾’è-ğ
	`NFA_ALIGN
(Òç)->
nç_Ën
), \

41 (
nç‰r
 *)(((*)(
nç
)è+ 
	`NFA_ALIGN
(Òç)->
nç_Ën
)))

	)

42 
	#NFA_LENGTH
(
Ën
è(
	`NFA_ALIGN
((
nç‰r
)è+ (Ën))

	)

43 
	#NFA_SPACE
(
Ën
è
	`NFA_ALIGN
(
	`NFA_LENGTH
Ö’))

	)

44 
	#NFA_DATA
(
nç
è((*)(((*)Òç)è+ 
	`NFA_LENGTH
(0)))

	)

45 
	#NFA_PAYLOAD
(
nç
è(()(Òç)->
nç_Ën
è- 
	`NFA_LENGTH
(0))

	)

46 
	#NFA_NEST
(
skb
, 
ty³
) \

47 ({ 
nç‰r
 *
__¡¬t
 = (nç‰¸*)
	`skb__poš‹r
(
skb
); \

48 
	`NFA_PUT
(
skb
, (
NFNL_NFA_NEST
 | 
ty³
), 0, 
NULL
); \

49 
__¡¬t
; })

	)

50 
	#NFA_NEST_END
(
skb
, 
¡¬t
) \

51 ({ (
¡¬t
)->
nç_Ën
 = 
	`skb__poš‹r
(
skb
) - (*)(start); \

52 (
skb
)->
Ën
; })

	)

53 
	#NFA_NEST_CANCEL
(
skb
, 
¡¬t
) \

54 ({ ià(
¡¬t
) \

55 
	`skb_Œim
(
skb
, (*è(
¡¬t
è- (skb)->
d©a
); \

56 -1; })

	)

58 
	#NFM_NFA
(
n
è((
nç‰r
 *)(((*)(n)) \

59 + 
	`NLMSG_ALIGN
((
nfg’msg
))))

	)

60 
	#NFM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò, (
nfg’msg
))

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_conntrack.h

1 #iâdeà
_IPCONNTRACK_NETLINK_H


2 
	#_IPCONNTRACK_NETLINK_H


	)

3 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

5 
	eú_msg_ty³s
 {

6 
	mIPCTNL_MSG_CT_NEW
,

7 
	mIPCTNL_MSG_CT_GET
,

8 
	mIPCTNL_MSG_CT_DELETE
,

9 
	mIPCTNL_MSG_CT_GET_CTRZERO
,

10 
	mIPCTNL_MSG_CT_GET_STATS_CPU
,

11 
	mIPCTNL_MSG_CT_GET_STATS
,

13 
	mIPCTNL_MSG_MAX


16 
	eùÆ_exp_msg_ty³s
 {

17 
	mIPCTNL_MSG_EXP_NEW
,

18 
	mIPCTNL_MSG_EXP_GET
,

19 
	mIPCTNL_MSG_EXP_DELETE
,

20 
	mIPCTNL_MSG_EXP_GET_STATS_CPU
,

22 
	mIPCTNL_MSG_EXP_MAX


26 
	eù©Œ_ty³
 {

27 
	mCTA_UNSPEC
,

28 
	mCTA_TUPLE_ORIG
,

29 
	mCTA_TUPLE_REPLY
,

30 
	mCTA_STATUS
,

31 
	mCTA_PROTOINFO
,

32 
	mCTA_HELP
,

33 
	mCTA_NAT_SRC
,

34 
	#CTA_NAT
 
CTA_NAT_SRC


	)

35 
	mCTA_TIMEOUT
,

36 
	mCTA_MARK
,

37 
	mCTA_COUNTERS_ORIG
,

38 
	mCTA_COUNTERS_REPLY
,

39 
	mCTA_USE
,

40 
	mCTA_ID
,

41 
	mCTA_NAT_DST
,

42 
	mCTA_TUPLE_MASTER
,

43 
	mCTA_NAT_SEQ_ADJ_ORIG
,

44 
	mCTA_NAT_SEQ_ADJ_REPLY
,

45 
	mCTA_SECMARK
,

46 
	mCTA_ZONE
,

47 
	mCTA_SECCTX
,

48 
	mCTA_TIMESTAMP
,

49 
	mCTA_MARK_MASK
,

50 
	m__CTA_MAX


52 
	#CTA_MAX
 (
__CTA_MAX
 - 1)

	)

54 
	eù©Œ_tu¶e
 {

55 
	mCTA_TUPLE_UNSPEC
,

56 
	mCTA_TUPLE_IP
,

57 
	mCTA_TUPLE_PROTO
,

58 
	m__CTA_TUPLE_MAX


60 
	#CTA_TUPLE_MAX
 (
__CTA_TUPLE_MAX
 - 1)

	)

62 
	eù©Œ_
 {

63 
	mCTA_IP_UNSPEC
,

64 
	mCTA_IP_V4_SRC
,

65 
	mCTA_IP_V4_DST
,

66 
	mCTA_IP_V6_SRC
,

67 
	mCTA_IP_V6_DST
,

68 
	m__CTA_IP_MAX


70 
	#CTA_IP_MAX
 (
__CTA_IP_MAX
 - 1)

	)

72 
	eù©Œ_l4´Ùo
 {

73 
	mCTA_PROTO_UNSPEC
,

74 
	mCTA_PROTO_NUM
,

75 
	mCTA_PROTO_SRC_PORT
,

76 
	mCTA_PROTO_DST_PORT
,

77 
	mCTA_PROTO_ICMP_ID
,

78 
	mCTA_PROTO_ICMP_TYPE
,

79 
	mCTA_PROTO_ICMP_CODE
,

80 
	mCTA_PROTO_ICMPV6_ID
,

81 
	mCTA_PROTO_ICMPV6_TYPE
,

82 
	mCTA_PROTO_ICMPV6_CODE
,

83 
	m__CTA_PROTO_MAX


85 
	#CTA_PROTO_MAX
 (
__CTA_PROTO_MAX
 - 1)

	)

87 
	eù©Œ_´Ùošfo
 {

88 
	mCTA_PROTOINFO_UNSPEC
,

89 
	mCTA_PROTOINFO_TCP
,

90 
	mCTA_PROTOINFO_DCCP
,

91 
	mCTA_PROTOINFO_SCTP
,

92 
	m__CTA_PROTOINFO_MAX


94 
	#CTA_PROTOINFO_MAX
 (
__CTA_PROTOINFO_MAX
 - 1)

	)

96 
	eù©Œ_´Ùošfo_tı
 {

97 
	mCTA_PROTOINFO_TCP_UNSPEC
,

98 
	mCTA_PROTOINFO_TCP_STATE
,

99 
	mCTA_PROTOINFO_TCP_WSCALE_ORIGINAL
,

100 
	mCTA_PROTOINFO_TCP_WSCALE_REPLY
,

101 
	mCTA_PROTOINFO_TCP_FLAGS_ORIGINAL
,

102 
	mCTA_PROTOINFO_TCP_FLAGS_REPLY
,

103 
	m__CTA_PROTOINFO_TCP_MAX


105 
	#CTA_PROTOINFO_TCP_MAX
 (
__CTA_PROTOINFO_TCP_MAX
 - 1)

	)

107 
	eù©Œ_´Ùošfo_dcı
 {

108 
	mCTA_PROTOINFO_DCCP_UNSPEC
,

109 
	mCTA_PROTOINFO_DCCP_STATE
,

110 
	mCTA_PROTOINFO_DCCP_ROLE
,

111 
	mCTA_PROTOINFO_DCCP_HANDSHAKE_SEQ
,

112 
	m__CTA_PROTOINFO_DCCP_MAX
,

114 
	#CTA_PROTOINFO_DCCP_MAX
 (
__CTA_PROTOINFO_DCCP_MAX
 - 1)

	)

116 
	eù©Œ_´Ùošfo_sùp
 {

117 
	mCTA_PROTOINFO_SCTP_UNSPEC
,

118 
	mCTA_PROTOINFO_SCTP_STATE
,

119 
	mCTA_PROTOINFO_SCTP_VTAG_ORIGINAL
,

120 
	mCTA_PROTOINFO_SCTP_VTAG_REPLY
,

121 
	m__CTA_PROTOINFO_SCTP_MAX


123 
	#CTA_PROTOINFO_SCTP_MAX
 (
__CTA_PROTOINFO_SCTP_MAX
 - 1)

	)

125 
	eù©Œ_couÁ”s
 {

126 
	mCTA_COUNTERS_UNSPEC
,

127 
	mCTA_COUNTERS_PACKETS
,

128 
	mCTA_COUNTERS_BYTES
,

129 
	mCTA_COUNTERS32_PACKETS
,

130 
	mCTA_COUNTERS32_BYTES
,

131 
	m__CTA_COUNTERS_MAX


133 
	#CTA_COUNTERS_MAX
 (
__CTA_COUNTERS_MAX
 - 1)

	)

135 
	eù©Œ_t¡amp
 {

136 
	mCTA_TIMESTAMP_UNSPEC
,

137 
	mCTA_TIMESTAMP_START
,

138 
	mCTA_TIMESTAMP_STOP
,

139 
	m__CTA_TIMESTAMP_MAX


141 
	#CTA_TIMESTAMP_MAX
 (
__CTA_TIMESTAMP_MAX
 - 1)

	)

143 
	eù©Œ_Çt
 {

144 
	mCTA_NAT_UNSPEC
,

145 
	mCTA_NAT_V4_MINIP
,

146 
	#CTA_NAT_MINIP
 
CTA_NAT_V4_MINIP


	)

147 
	mCTA_NAT_V4_MAXIP
,

148 
	#CTA_NAT_MAXIP
 
CTA_NAT_V4_MAXIP


	)

149 
	mCTA_NAT_PROTO
,

150 
	mCTA_NAT_V6_MINIP
,

151 
	mCTA_NAT_V6_MAXIP
,

152 
	m__CTA_NAT_MAX


154 
	#CTA_NAT_MAX
 (
__CTA_NAT_MAX
 - 1)

	)

156 
	eù©Œ_´ÙÚ©
 {

157 
	mCTA_PROTONAT_UNSPEC
,

158 
	mCTA_PROTONAT_PORT_MIN
,

159 
	mCTA_PROTONAT_PORT_MAX
,

160 
	m__CTA_PROTONAT_MAX


162 
	#CTA_PROTONAT_MAX
 (
__CTA_PROTONAT_MAX
 - 1)

	)

164 
	eù©Œ_Çt£q
 {

165 
	mCTA_NAT_SEQ_UNSPEC
,

166 
	mCTA_NAT_SEQ_CORRECTION_POS
,

167 
	mCTA_NAT_SEQ_OFFSET_BEFORE
,

168 
	mCTA_NAT_SEQ_OFFSET_AFTER
,

169 
	m__CTA_NAT_SEQ_MAX


171 
	#CTA_NAT_SEQ_MAX
 (
__CTA_NAT_SEQ_MAX
 - 1)

	)

173 
	eù©Œ_ex³ù
 {

174 
	mCTA_EXPECT_UNSPEC
,

175 
	mCTA_EXPECT_MASTER
,

176 
	mCTA_EXPECT_TUPLE
,

177 
	mCTA_EXPECT_MASK
,

178 
	mCTA_EXPECT_TIMEOUT
,

179 
	mCTA_EXPECT_ID
,

180 
	mCTA_EXPECT_HELP_NAME
,

181 
	mCTA_EXPECT_ZONE
,

182 
	mCTA_EXPECT_FLAGS
,

183 
	mCTA_EXPECT_CLASS
,

184 
	mCTA_EXPECT_NAT
,

185 
	mCTA_EXPECT_FN
,

186 
	m__CTA_EXPECT_MAX


188 
	#CTA_EXPECT_MAX
 (
__CTA_EXPECT_MAX
 - 1)

	)

190 
	eù©Œ_ex³ù_Çt
 {

191 
	mCTA_EXPECT_NAT_UNSPEC
,

192 
	mCTA_EXPECT_NAT_DIR
,

193 
	mCTA_EXPECT_NAT_TUPLE
,

194 
	m__CTA_EXPECT_NAT_MAX


196 
	#CTA_EXPECT_NAT_MAX
 (
__CTA_EXPECT_NAT_MAX
 - 1)

	)

198 
	eù©Œ_h–p
 {

199 
	mCTA_HELP_UNSPEC
,

200 
	mCTA_HELP_NAME
,

201 
	mCTA_HELP_INFO
,

202 
	m__CTA_HELP_MAX


204 
	#CTA_HELP_MAX
 (
__CTA_HELP_MAX
 - 1)

	)

206 
	eù©Œ_£cùx
 {

207 
	mCTA_SECCTX_UNSPEC
,

208 
	mCTA_SECCTX_NAME
,

209 
	m__CTA_SECCTX_MAX


211 
	#CTA_SECCTX_MAX
 (
__CTA_SECCTX_MAX
 - 1)

	)

213 
	eù©Œ_¡©s_ıu
 {

214 
	mCTA_STATS_UNSPEC
,

215 
	mCTA_STATS_SEARCHED
,

216 
	mCTA_STATS_FOUND
,

217 
	mCTA_STATS_NEW
,

218 
	mCTA_STATS_INVALID
,

219 
	mCTA_STATS_IGNORE
,

220 
	mCTA_STATS_DELETE
,

221 
	mCTA_STATS_DELETE_LIST
,

222 
	mCTA_STATS_INSERT
,

223 
	mCTA_STATS_INSERT_FAILED
,

224 
	mCTA_STATS_DROP
,

225 
	mCTA_STATS_EARLY_DROP
,

226 
	mCTA_STATS_ERROR
,

227 
	mCTA_STATS_SEARCH_RESTART
,

228 
	m__CTA_STATS_MAX
,

230 
	#CTA_STATS_MAX
 (
__CTA_STATS_MAX
 - 1)

	)

232 
	eù©Œ_¡©s_glob®
 {

233 
	mCTA_STATS_GLOBAL_UNSPEC
,

234 
	mCTA_STATS_GLOBAL_ENTRIES
,

235 
	m__CTA_STATS_GLOBAL_MAX
,

237 
	#CTA_STATS_GLOBAL_MAX
 (
__CTA_STATS_GLOBAL_MAX
 - 1)

	)

239 
	eù©Œ_ex³ù_¡©s
 {

240 
	mCTA_STATS_EXP_UNSPEC
,

241 
	mCTA_STATS_EXP_NEW
,

242 
	mCTA_STATS_EXP_CREATE
,

243 
	mCTA_STATS_EXP_DELETE
,

244 
	m__CTA_STATS_EXP_MAX
,

246 
	#CTA_STATS_EXP_MAX
 (
__CTA_STATS_EXP_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_log.h

1 #iâdeà
_NFNETLINK_LOG_H


2 
	#_NFNETLINK_LOG_H


	)

8 #iâdeà
__®igÃd_be64


9 
	#__®igÃd_be64
 
u_št64_t
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

12 
	~<lšux/ty³s.h
>

13 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

15 
	enfuÊl_msg_ty³s
 {

16 
	mNFULNL_MSG_PACKET
,

17 
	mNFULNL_MSG_CONFIG
,

19 
	mNFULNL_MSG_MAX


22 
	snfuÊl_msg_·ck‘_hdr
 {

23 
__be16
 
	mhw_´ÙocŞ
;

24 
__u8
 
	mhook
;

25 
__u8
 
	m_·d
;

28 
	snfuÊl_msg_·ck‘_hw
 {

29 
__be16
 
	mhw_add¾’
;

30 
__u16
 
	m_·d
;

31 
__u8
 
	mhw_addr
[8];

34 
	snfuÊl_msg_·ck‘_time¡amp
 {

35 
__®igÃd_be64
 
	m£c
;

36 
__®igÃd_be64
 
	mu£c
;

39 
	enfuÊl_©Œ_ty³
 {

40 
	mNFULA_UNSPEC
,

41 
	mNFULA_PACKET_HDR
,

42 
	mNFULA_MARK
,

43 
	mNFULA_TIMESTAMP
,

44 
	mNFULA_IFINDEX_INDEV
,

45 
	mNFULA_IFINDEX_OUTDEV
,

46 
	mNFULA_IFINDEX_PHYSINDEV
,

47 
	mNFULA_IFINDEX_PHYSOUTDEV
,

48 
	mNFULA_HWADDR
,

49 
	mNFULA_PAYLOAD
,

50 
	mNFULA_PREFIX
,

51 
	mNFULA_UID
,

52 
	mNFULA_SEQ
,

53 
	mNFULA_SEQ_GLOBAL
,

54 
	mNFULA_GID
,

55 
	mNFULA_HWTYPE
,

56 
	mNFULA_HWHEADER
,

57 
	mNFULA_HWLEN
,

59 
	m__NFULA_MAX


61 
	#NFULA_MAX
 (
__NFULA_MAX
 - 1)

	)

63 
	enfuÊl_msg_cÚfig_cmds
 {

64 
	mNFULNL_CFG_CMD_NONE
,

65 
	mNFULNL_CFG_CMD_BIND
,

66 
	mNFULNL_CFG_CMD_UNBIND
,

67 
	mNFULNL_CFG_CMD_PF_BIND
,

68 
	mNFULNL_CFG_CMD_PF_UNBIND
,

71 
	snfuÊl_msg_cÚfig_cmd
 {

72 
__u8
 
	mcommªd
;

73 } 
__©Œibu‹__
 ((
·cked
));

75 
	snfuÊl_msg_cÚfig_mode
 {

76 
__be32
 
	mcİy_¿nge
;

77 
__u8
 
	mcİy_mode
;

78 
__u8
 
	m_·d
;

79 } 
__©Œibu‹__
 ((
·cked
));

81 
	enfuÊl_©Œ_cÚfig
 {

82 
	mNFULA_CFG_UNSPEC
,

83 
	mNFULA_CFG_CMD
,

84 
	mNFULA_CFG_MODE
,

85 
	mNFULA_CFG_NLBUFSIZ
,

86 
	mNFULA_CFG_TIMEOUT
,

87 
	mNFULA_CFG_QTHRESH
,

88 
	mNFULA_CFG_FLAGS
,

89 
	m__NFULA_CFG_MAX


91 
	#NFULA_CFG_MAX
 (
__NFULA_CFG_MAX
 -1)

	)

93 
	#NFULNL_COPY_NONE
 0x00

	)

94 
	#NFULNL_COPY_META
 0x01

	)

95 
	#NFULNL_COPY_PACKET
 0x02

	)

98 
	#NFULNL_CFG_F_SEQ
 0x0001

	)

99 
	#NFULNL_CFG_F_SEQ_GLOBAL
 0x0002

	)

	@mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_queue.h

1 #iâdeà
_NFNETLINK_QUEUE_H


2 
	#_NFNETLINK_QUEUE_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

7 #iâdeà
__®igÃd_be64


8 
	#__®igÃd_be64
 
u_št64_t
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

11 
	enfqÆ_msg_ty³s
 {

12 
	mNFQNL_MSG_PACKET
,

13 
	mNFQNL_MSG_VERDICT
,

14 
	mNFQNL_MSG_CONFIG
,

15 
	mNFQNL_MSG_VERDICT_BATCH
,

17 
	mNFQNL_MSG_MAX


20 
	snfqÆ_msg_·ck‘_hdr
 {

21 
__be32
 
	m·ck‘_id
;

22 
__be16
 
	mhw_´ÙocŞ
;

23 
__u8
 
	mhook
;

24 } 
__©Œibu‹__
 ((
·cked
));

26 
	snfqÆ_msg_·ck‘_hw
 {

27 
__be16
 
	mhw_add¾’
;

28 
__u16
 
	m_·d
;

29 
__u8
 
	mhw_addr
[8];

32 
	snfqÆ_msg_·ck‘_time¡amp
 {

33 
__®igÃd_be64
 
	m£c
;

34 
__®igÃd_be64
 
	mu£c
;

37 
	enfqÆ_©Œ_ty³
 {

38 
	mNFQA_UNSPEC
,

39 
	mNFQA_PACKET_HDR
,

40 
	mNFQA_VERDICT_HDR
,

41 
	mNFQA_MARK
,

42 
	mNFQA_TIMESTAMP
,

43 
	mNFQA_IFINDEX_INDEV
,

44 
	mNFQA_IFINDEX_OUTDEV
,

45 
	mNFQA_IFINDEX_PHYSINDEV
,

46 
	mNFQA_IFINDEX_PHYSOUTDEV
,

47 
	mNFQA_HWADDR
,

48 
	mNFQA_PAYLOAD
,

49 
	mNFQA_CT
,

50 
	mNFQA_CT_INFO
,

51 
	mNFQA_CAP_LEN
,

53 
	m__NFQA_MAX


55 
	#NFQA_MAX
 (
__NFQA_MAX
 - 1)

	)

57 
	snfqÆ_msg_v”diù_hdr
 {

58 
__be32
 
	mv”diù
;

59 
__be32
 
	mid
;

63 
	enfqÆ_msg_cÚfig_cmds
 {

64 
	mNFQNL_CFG_CMD_NONE
,

65 
	mNFQNL_CFG_CMD_BIND
,

66 
	mNFQNL_CFG_CMD_UNBIND
,

67 
	mNFQNL_CFG_CMD_PF_BIND
,

68 
	mNFQNL_CFG_CMD_PF_UNBIND
,

71 
	snfqÆ_msg_cÚfig_cmd
 {

72 
__u8
 
	mcommªd
;

73 
__u8
 
	m_·d
;

74 
__be16
 
	mpf
;

77 
	enfqÆ_cÚfig_mode
 {

78 
	mNFQNL_COPY_NONE
,

79 
	mNFQNL_COPY_META
,

80 
	mNFQNL_COPY_PACKET
,

83 
	snfqÆ_msg_cÚfig_·¿ms
 {

84 
__be32
 
	mcİy_¿nge
;

85 
__u8
 
	mcİy_mode
;

86 } 
__©Œibu‹__
 ((
·cked
));

89 
	enfqÆ_©Œ_cÚfig
 {

90 
	mNFQA_CFG_UNSPEC
,

91 
	mNFQA_CFG_CMD
,

92 
	mNFQA_CFG_PARAMS
,

93 
	mNFQA_CFG_QUEUE_MAXLEN
,

94 
	mNFQA_CFG_MASK
,

95 
	mNFQA_CFG_FLAGS
,

96 
	m__NFQA_CFG_MAX


98 
	#NFQA_CFG_MAX
 (
__NFQA_CFG_MAX
-1)

	)

101 
	#NFQA_CFG_F_FAIL_OPEN
 (1 << 0)

	)

102 
	#NFQA_CFG_F_CONNTRACK
 (1 << 1)

	)

103 
	#NFQA_CFG_F_MAX
 (1 << 2)

	)

	@mylibnl/libnl-3.2.25/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/sock‘.h
>

5 
	~<lšux/ty³s.h
>

7 
	#NETLINK_ROUTE
 0

	)

8 
	#NETLINK_UNUSED
 1

	)

9 
	#NETLINK_USERSOCK
 2

	)

10 
	#NETLINK_FIREWALL
 3

	)

11 
	#NETLINK_INET_DIAG
 4

	)

12 
	#NETLINK_NFLOG
 5

	)

13 
	#NETLINK_XFRM
 6

	)

14 
	#NETLINK_SELINUX
 7

	)

15 
	#NETLINK_ISCSI
 8

	)

16 
	#NETLINK_AUDIT
 9

	)

17 
	#NETLINK_FIB_LOOKUP
 10

	)

18 
	#NETLINK_CONNECTOR
 11

	)

19 
	#NETLINK_NETFILTER
 12

	)

20 
	#NETLINK_IP6_FW
 13

	)

21 
	#NETLINK_DNRTMSG
 14

	)

22 
	#NETLINK_KOBJECT_UEVENT
 15

	)

23 
	#NETLINK_GENERIC
 16

	)

25 
	#NETLINK_SCSITRANSPORT
 18

	)

26 
	#NETLINK_ECRYPTFS
 19

	)

27 
	#NETLINK_RDMA
 20

	)

29 
	#MAX_LINKS
 32

	)

31 
	ssockaddr_Æ
 {

32 
§_çmy_t
 
	mÆ_çmy
;

33 
	mÆ_·d
;

34 
__u32
 
	mÆ_pid
;

35 
__u32
 
	mÆ_groups
;

38 
	sÆmsghdr
 {

39 
__u32
 
	mÆmsg_Ën
;

40 
__u16
 
	mÆmsg_ty³
;

41 
__u16
 
	mÆmsg_æags
;

42 
__u32
 
	mÆmsg_£q
;

43 
__u32
 
	mÆmsg_pid
;

48 
	#NLM_F_REQUEST
 1

	)

49 
	#NLM_F_MULTI
 2

	)

50 
	#NLM_F_ACK
 4

	)

51 
	#NLM_F_ECHO
 8

	)

52 
	#NLM_F_DUMP_INTR
 16

	)

55 
	#NLM_F_ROOT
 0x100

	)

56 
	#NLM_F_MATCH
 0x200

	)

57 
	#NLM_F_ATOMIC
 0x400

	)

58 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

61 
	#NLM_F_REPLACE
 0x100

	)

62 
	#NLM_F_EXCL
 0x200

	)

63 
	#NLM_F_CREATE
 0x400

	)

64 
	#NLM_F_APPEND
 0x800

	)

75 
	#NLMSG_ALIGNTO
 4U

	)

76 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

77 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

78 
	#NLMSG_LENGTH
(
Ën
è(Ö’)+
	`NLMSG_ALIGN
(
NLMSG_HDRLEN
))

	)

79 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

80 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

81 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

82 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

83 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

84 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

85 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

86 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

88 
	#NLMSG_NOOP
 0x1

	)

89 
	#NLMSG_ERROR
 0x2

	)

90 
	#NLMSG_DONE
 0x3

	)

91 
	#NLMSG_OVERRUN
 0x4

	)

93 
	#NLMSG_MIN_TYPE
 0x10

	)

95 
	sÆmsg”r
 {

96 
	m”rÜ
;

97 
Æmsghdr
 
	mmsg
;

100 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

101 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

102 
	#NETLINK_PKTINFO
 3

	)

103 
	#NETLINK_BROADCAST_ERROR
 4

	)

104 
	#NETLINK_NO_ENOBUFS
 5

	)

106 
	sÆ_pktšfo
 {

107 
__u32
 
	mgroup
;

110 
	#NET_MAJOR
 36

	)

113 
	mNETLINK_UNCONNECTED
 = 0,

114 
	mNETLINK_CONNECTED
,

126 
	sÆ©Œ
 {

127 
__u16
 
	mÆa_Ën
;

128 
__u16
 
	mÆa_ty³
;

141 
	#NLA_F_NESTED
 (1 << 15)

	)

142 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

143 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

145 
	#NLA_ALIGNTO
 4

	)

146 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

147 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@mylibnl/libnl-3.2.25/include/linux/pkt_cls.h

1 #iâdeà
__LINUX_PKT_CLS_H


2 
	#__LINUX_PKT_CLS_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_sched.h
>

10 
	#_TC_MAKE32
(
x
è((x))

	)

12 
	#_TC_MAKEMASK1
(
n
è(
	`_TC_MAKE32
(1è<< _TC_MAKE32Ò))

	)

13 
	#_TC_MAKEMASK
(
v
,
n
è(
	`_TC_MAKE32
((_TC_MAKE32(1)<<(v))-1è<< _TC_MAKE32Ò))

	)

14 
	#_TC_MAKEVALUE
(
v
,
n
è(
	`_TC_MAKE32
(vè<< _TC_MAKE32Ò))

	)

15 
	#_TC_GETVALUE
(
v
,
n
,
m
è((
	`_TC_MAKE32
(vè& _TC_MAKE32(m)è>> _TC_MAKE32Ò))

	)

38 
	#TC_MUNGED
 
	`_TC_MAKEMASK1
(0)

	)

39 
	#SET_TC_MUNGED
(
v
èĞ
TC_MUNGED
 | (v & ~TC_MUNGED))

	)

40 
	#CLR_TC_MUNGED
(
v
èĞv & ~
TC_MUNGED
)

	)

42 
	#TC_OK2MUNGE
 
	`_TC_MAKEMASK1
(1)

	)

43 
	#SET_TC_OK2MUNGE
(
v
èĞ
TC_OK2MUNGE
 | (v & ~TC_OK2MUNGE))

	)

44 
	#CLR_TC_OK2MUNGE
(
v
èĞv & ~
TC_OK2MUNGE
)

	)

46 
	#S_TC_VERD
 
	`_TC_MAKE32
(2)

	)

47 
	#M_TC_VERD
 
	`_TC_MAKEMASK
(4,
S_TC_VERD
)

	)

48 
	#G_TC_VERD
(
x
è
	`_TC_GETVALUE
(x,
S_TC_VERD
,
M_TC_VERD
)

	)

49 
	#V_TC_VERD
(
x
è
	`_TC_MAKEVALUE
(x,
S_TC_VERD
)

	)

50 
	#SET_TC_VERD
(
v
,
n
è((
	`V_TC_VERD
Ò)è| (v & ~
M_TC_VERD
))

	)

52 
	#S_TC_FROM
 
	`_TC_MAKE32
(6)

	)

53 
	#M_TC_FROM
 
	`_TC_MAKEMASK
(2,
S_TC_FROM
)

	)

54 
	#G_TC_FROM
(
x
è
	`_TC_GETVALUE
(x,
S_TC_FROM
,
M_TC_FROM
)

	)

55 
	#V_TC_FROM
(
x
è
	`_TC_MAKEVALUE
(x,
S_TC_FROM
)

	)

56 
	#SET_TC_FROM
(
v
,
n
è((
	`V_TC_FROM
Ò)è| (v & ~
M_TC_FROM
))

	)

57 
	#AT_STACK
 0x0

	)

58 
	#AT_INGRESS
 0x1

	)

59 
	#AT_EGRESS
 0x2

	)

61 
	#TC_NCLS
 
	`_TC_MAKEMASK1
(8)

	)

62 
	#SET_TC_NCLS
(
v
èĞ
TC_NCLS
 | (v & ~TC_NCLS))

	)

63 
	#CLR_TC_NCLS
(
v
èĞv & ~
TC_NCLS
)

	)

65 
	#S_TC_RTTL
 
	`_TC_MAKE32
(9)

	)

66 
	#M_TC_RTTL
 
	`_TC_MAKEMASK
(3,
S_TC_RTTL
)

	)

67 
	#G_TC_RTTL
(
x
è
	`_TC_GETVALUE
(x,
S_TC_RTTL
,
M_TC_RTTL
)

	)

68 
	#V_TC_RTTL
(
x
è
	`_TC_MAKEVALUE
(x,
S_TC_RTTL
)

	)

69 
	#SET_TC_RTTL
(
v
,
n
è((
	`V_TC_RTTL
Ò)è| (v & ~
M_TC_RTTL
))

	)

71 
	#S_TC_AT
 
	`_TC_MAKE32
(12)

	)

72 
	#M_TC_AT
 
	`_TC_MAKEMASK
(2,
S_TC_AT
)

	)

73 
	#G_TC_AT
(
x
è
	`_TC_GETVALUE
(x,
S_TC_AT
,
M_TC_AT
)

	)

74 
	#V_TC_AT
(
x
è
	`_TC_MAKEVALUE
(x,
S_TC_AT
)

	)

75 
	#SET_TC_AT
(
v
,
n
è((
	`V_TC_AT
Ò)è| (v & ~
M_TC_AT
))

	)

79 
	mTCA_ACT_UNSPEC
,

80 
	mTCA_ACT_KIND
,

81 
	mTCA_ACT_OPTIONS
,

82 
	mTCA_ACT_INDEX
,

83 
	mTCA_ACT_STATS
,

84 
	m__TCA_ACT_MAX


87 
	#TCA_ACT_MAX
 
__TCA_ACT_MAX


	)

88 
	#TCA_OLD_COMPAT
 (
TCA_ACT_MAX
+1)

	)

89 
	#TCA_ACT_MAX_PRIO
 32

	)

90 
	#TCA_ACT_BIND
 1

	)

91 
	#TCA_ACT_NOBIND
 0

	)

92 
	#TCA_ACT_UNBIND
 1

	)

93 
	#TCA_ACT_NOUNBIND
 0

	)

94 
	#TCA_ACT_REPLACE
 1

	)

95 
	#TCA_ACT_NOREPLACE
 0

	)

96 
	#MAX_REC_LOOP
 4

	)

97 
	#MAX_RED_LOOP
 4

	)

99 
	#TC_ACT_UNSPEC
 (-1)

	)

100 
	#TC_ACT_OK
 0

	)

101 
	#TC_ACT_RECLASSIFY
 1

	)

102 
	#TC_ACT_SHOT
 2

	)

103 
	#TC_ACT_PIPE
 3

	)

104 
	#TC_ACT_STOLEN
 4

	)

105 
	#TC_ACT_QUEUED
 5

	)

106 
	#TC_ACT_REPEAT
 6

	)

107 
	#TC_ACT_JUMP
 0x10000000

	)

111 
	mTCA_ID_UNSPEC
=0,

112 
	mTCA_ID_POLICE
=1,

114 
	m__TCA_ID_MAX
=255

117 
	#TCA_ID_MAX
 
__TCA_ID_MAX


	)

119 
	stc_pŞiû
 {

120 
__u32
 
	mšdex
;

121 
	maùiÚ
;

122 
	#TC_POLICE_UNSPEC
 
TC_ACT_UNSPEC


	)

123 
	#TC_POLICE_OK
 
TC_ACT_OK


	)

124 
	#TC_POLICE_RECLASSIFY
 
TC_ACT_RECLASSIFY


	)

125 
	#TC_POLICE_SHOT
 
TC_ACT_SHOT


	)

126 
	#TC_POLICE_PIPE
 
TC_ACT_PIPE


	)

128 
__u32
 
	mlim™
;

129 
__u32
 
	mbur¡
;

130 
__u32
 
	mmtu
;

131 
tc_¿‹¥ec
 
	m¿‹
;

132 
tc_¿‹¥ec
 
	m³ak¿‹
;

133 
	m»fút
;

134 
	mbšdút
;

135 
__u32
 
	mÿ·b
;

138 
	stcf_t
 {

139 
__u64
 
	mš¡®l
;

140 
__u64
 
	mÏ¡u£
;

141 
__u64
 
	mexpœes
;

144 
	stc_út
 {

145 
	m»fút
;

146 
	mbšdút
;

149 
	#tc_g’
 \

150 
__u32
 
šdex
; \

151 
__u32
 
ÿ·b
; \

152 
aùiÚ
; \

153 
»fút
; \

154 
bšdút


	)

157 
	mTCA_POLICE_UNSPEC
,

158 
	mTCA_POLICE_TBF
,

159 
	mTCA_POLICE_RATE
,

160 
	mTCA_POLICE_PEAKRATE
,

161 
	mTCA_POLICE_AVRATE
,

162 
	mTCA_POLICE_RESULT
,

163 
	m__TCA_POLICE_MAX


164 
	#TCA_POLICE_RESULT
 
TCA_POLICE_RESULT


	)

167 
	#TCA_POLICE_MAX
 (
__TCA_POLICE_MAX
 - 1)

	)

171 
	#TC_U32_HTID
(
h
è((h)&0xFFF00000)

	)

172 
	#TC_U32_USERHTID
(
h
è(
	`TC_U32_HTID
(h)>>20)

	)

173 
	#TC_U32_HASH
(
h
è(((h)>>12)&0xFF)

	)

174 
	#TC_U32_NODE
(
h
è((h)&0xFFF)

	)

175 
	#TC_U32_KEY
(
h
è((h)&0xFFFFF)

	)

176 
	#TC_U32_UNSPEC
 0

	)

177 
	#TC_U32_ROOT
 (0xFFF00000)

	)

180 
	mTCA_U32_UNSPEC
,

181 
	mTCA_U32_CLASSID
,

182 
	mTCA_U32_HASH
,

183 
	mTCA_U32_LINK
,

184 
	mTCA_U32_DIVISOR
,

185 
	mTCA_U32_SEL
,

186 
	mTCA_U32_POLICE
,

187 
	mTCA_U32_ACT
,

188 
	mTCA_U32_INDEV
,

189 
	mTCA_U32_PCNT
,

190 
	mTCA_U32_MARK
,

191 
	m__TCA_U32_MAX


194 
	#TCA_U32_MAX
 (
__TCA_U32_MAX
 - 1)

	)

196 
	stc_u32_key
 {

197 
__be32
 
	mmask
;

198 
__be32
 
	mv®
;

199 
	moff
;

200 
	moffmask
;

203 
	stc_u32_£l
 {

204 
	mæags
;

205 
	moffshiá
;

206 
	mnkeys
;

208 
__be16
 
	moffmask
;

209 
__u16
 
	moff
;

210 
	moffoff
;

212 
	mhoff
;

213 
__be32
 
	mhmask
;

214 
tc_u32_key
 
	mkeys
[0];

217 
	stc_u32_m¬k
 {

218 
__u32
 
	mv®
;

219 
__u32
 
	mmask
;

220 
__u32
 
	msucûss
;

223 
	stc_u32_pút
 {

224 
__u64
 
	mrút
;

225 
__u64
 
	mrh™
;

226 
__u64
 
	mkúts
[0];

231 
	#TC_U32_TERMINAL
 1

	)

232 
	#TC_U32_OFFSET
 2

	)

233 
	#TC_U32_VAROFFSET
 4

	)

234 
	#TC_U32_EAT
 8

	)

236 
	#TC_U32_MAXDEPTH
 8

	)

242 
	mTCA_RSVP_UNSPEC
,

243 
	mTCA_RSVP_CLASSID
,

244 
	mTCA_RSVP_DST
,

245 
	mTCA_RSVP_SRC
,

246 
	mTCA_RSVP_PINFO
,

247 
	mTCA_RSVP_POLICE
,

248 
	mTCA_RSVP_ACT
,

249 
	m__TCA_RSVP_MAX


252 
	#TCA_RSVP_MAX
 (
__TCA_RSVP_MAX
 - 1 )

	)

254 
	stc_rsvp_gpi
 {

255 
__u32
 
	mkey
;

256 
__u32
 
	mmask
;

257 
	moff£t
;

260 
	stc_rsvp_pšfo
 {

261 
tc_rsvp_gpi
 
	mdpi
;

262 
tc_rsvp_gpi
 
	m¥i
;

263 
__u8
 
	m´ÙocŞ
;

264 
__u8
 
	mtuÂ–id
;

265 
__u8
 
	mtuÂ–hdr
;

266 
__u8
 
	m·d
;

272 
	mTCA_ROUTE4_UNSPEC
,

273 
	mTCA_ROUTE4_CLASSID
,

274 
	mTCA_ROUTE4_TO
,

275 
	mTCA_ROUTE4_FROM
,

276 
	mTCA_ROUTE4_IIF
,

277 
	mTCA_ROUTE4_POLICE
,

278 
	mTCA_ROUTE4_ACT
,

279 
	m__TCA_ROUTE4_MAX


282 
	#TCA_ROUTE4_MAX
 (
__TCA_ROUTE4_MAX
 - 1)

	)

288 
	mTCA_FW_UNSPEC
,

289 
	mTCA_FW_CLASSID
,

290 
	mTCA_FW_POLICE
,

291 
	mTCA_FW_INDEV
,

292 
	mTCA_FW_ACT
,

293 
	mTCA_FW_MASK
,

294 
	m__TCA_FW_MAX


297 
	#TCA_FW_MAX
 (
__TCA_FW_MAX
 - 1)

	)

302 
	mTCA_TCINDEX_UNSPEC
,

303 
	mTCA_TCINDEX_HASH
,

304 
	mTCA_TCINDEX_MASK
,

305 
	mTCA_TCINDEX_SHIFT
,

306 
	mTCA_TCINDEX_FALL_THROUGH
,

307 
	mTCA_TCINDEX_CLASSID
,

308 
	mTCA_TCINDEX_POLICE
,

309 
	mTCA_TCINDEX_ACT
,

310 
	m__TCA_TCINDEX_MAX


313 
	#TCA_TCINDEX_MAX
 (
__TCA_TCINDEX_MAX
 - 1)

	)

318 
	mFLOW_KEY_SRC
,

319 
	mFLOW_KEY_DST
,

320 
	mFLOW_KEY_PROTO
,

321 
	mFLOW_KEY_PROTO_SRC
,

322 
	mFLOW_KEY_PROTO_DST
,

323 
	mFLOW_KEY_IIF
,

324 
	mFLOW_KEY_PRIORITY
,

325 
	mFLOW_KEY_MARK
,

326 
	mFLOW_KEY_NFCT
,

327 
	mFLOW_KEY_NFCT_SRC
,

328 
	mFLOW_KEY_NFCT_DST
,

329 
	mFLOW_KEY_NFCT_PROTO_SRC
,

330 
	mFLOW_KEY_NFCT_PROTO_DST
,

331 
	mFLOW_KEY_RTCLASSID
,

332 
	mFLOW_KEY_SKUID
,

333 
	mFLOW_KEY_SKGID
,

334 
	mFLOW_KEY_VLAN_TAG
,

335 
	mFLOW_KEY_RXHASH
,

336 
	m__FLOW_KEY_MAX
,

339 
	#FLOW_KEY_MAX
 (
__FLOW_KEY_MAX
 - 1)

	)

342 
	mFLOW_MODE_MAP
,

343 
	mFLOW_MODE_HASH
,

347 
	mTCA_FLOW_UNSPEC
,

348 
	mTCA_FLOW_KEYS
,

349 
	mTCA_FLOW_MODE
,

350 
	mTCA_FLOW_BASECLASS
,

351 
	mTCA_FLOW_RSHIFT
,

352 
	mTCA_FLOW_ADDEND
,

353 
	mTCA_FLOW_MASK
,

354 
	mTCA_FLOW_XOR
,

355 
	mTCA_FLOW_DIVISOR
,

356 
	mTCA_FLOW_ACT
,

357 
	mTCA_FLOW_POLICE
,

358 
	mTCA_FLOW_EMATCHES
,

359 
	mTCA_FLOW_PERTURB
,

360 
	m__TCA_FLOW_MAX


363 
	#TCA_FLOW_MAX
 (
__TCA_FLOW_MAX
 - 1)

	)

368 
	mTCA_BASIC_UNSPEC
,

369 
	mTCA_BASIC_CLASSID
,

370 
	mTCA_BASIC_EMATCHES
,

371 
	mTCA_BASIC_ACT
,

372 
	mTCA_BASIC_POLICE
,

373 
	m__TCA_BASIC_MAX


376 
	#TCA_BASIC_MAX
 (
__TCA_BASIC_MAX
 - 1)

	)

382 
	mTCA_CGROUP_UNSPEC
,

383 
	mTCA_CGROUP_ACT
,

384 
	mTCA_CGROUP_POLICE
,

385 
	mTCA_CGROUP_EMATCHES
,

386 
	m__TCA_CGROUP_MAX
,

389 
	#TCA_CGROUP_MAX
 (
__TCA_CGROUP_MAX
 - 1)

	)

393 
	stcf_em©ch_Œ“_hdr
 {

394 
__u16
 
	mnm©ches
;

395 
__u16
 
	m´ogid
;

399 
	mTCA_EMATCH_TREE_UNSPEC
,

400 
	mTCA_EMATCH_TREE_HDR
,

401 
	mTCA_EMATCH_TREE_LIST
,

402 
	m__TCA_EMATCH_TREE_MAX


404 
	#TCA_EMATCH_TREE_MAX
 (
__TCA_EMATCH_TREE_MAX
 - 1)

	)

406 
	stcf_em©ch_hdr
 {

407 
__u16
 
	mm©chid
;

408 
__u16
 
	mkšd
;

409 
__u16
 
	mæags
;

410 
__u16
 
	m·d
;

427 
	#TCF_EM_REL_END
 0

	)

428 
	#TCF_EM_REL_AND
 (1<<0)

	)

429 
	#TCF_EM_REL_OR
 (1<<1)

	)

430 
	#TCF_EM_INVERT
 (1<<2)

	)

431 
	#TCF_EM_SIMPLE
 (1<<3)

	)

433 
	#TCF_EM_REL_MASK
 3

	)

434 
	#TCF_EM_REL_VALID
(
v
è(((vè& 
TCF_EM_REL_MASK
è!ğTCF_EM_REL_MASK)

	)

437 
	mTCF_LAYER_LINK
,

438 
	mTCF_LAYER_NETWORK
,

439 
	mTCF_LAYER_TRANSPORT
,

440 
	m__TCF_LAYER_MAX


442 
	#TCF_LAYER_MAX
 (
__TCF_LAYER_MAX
 - 1)

	)

448 
	#TCF_EM_CONTAINER
 0

	)

449 
	#TCF_EM_CMP
 1

	)

450 
	#TCF_EM_NBYTE
 2

	)

451 
	#TCF_EM_U32
 3

	)

452 
	#TCF_EM_META
 4

	)

453 
	#TCF_EM_TEXT
 5

	)

454 
	#TCF_EM_VLAN
 6

	)

455 
	#TCF_EM_MAX
 6

	)

458 
	mTCF_EM_PROG_TC


462 
	mTCF_EM_OPND_EQ
,

463 
	mTCF_EM_OPND_GT
,

464 
	mTCF_EM_OPND_LT


	@mylibnl/libnl-3.2.25/include/linux/pkt_sched.h

1 #iâdeà
__LINUX_PKT_SCHED_H


2 
	#__LINUX_PKT_SCHED_H


	)

4 
	~<lšux/ty³s.h
>

19 
	#TC_PRIO_BESTEFFORT
 0

	)

20 
	#TC_PRIO_FILLER
 1

	)

21 
	#TC_PRIO_BULK
 2

	)

22 
	#TC_PRIO_INTERACTIVE_BULK
 4

	)

23 
	#TC_PRIO_INTERACTIVE
 6

	)

24 
	#TC_PRIO_CONTROL
 7

	)

26 
	#TC_PRIO_MAX
 15

	)

32 
	stc_¡©s
 {

33 
__u64
 
	mby‹s
;

34 
__u32
 
	m·ck‘s
;

35 
__u32
 
	mdrİs
;

36 
__u32
 
	mov”lim™s
;

38 
__u32
 
	mbps
;

39 
__u32
 
	mµs
;

40 
__u32
 
	mqËn
;

41 
__u32
 
	mbacklog
;

44 
	stc_e¡im©Ü
 {

45 sigÃd 
	mš‹rv®
;

46 
	mewma_log
;

66 
	#TC_H_MAJ_MASK
 (0xFFFF0000U)

	)

67 
	#TC_H_MIN_MASK
 (0x0000FFFFU)

	)

68 
	#TC_H_MAJ
(
h
è((h)&
TC_H_MAJ_MASK
)

	)

69 
	#TC_H_MIN
(
h
è((h)&
TC_H_MIN_MASK
)

	)

70 
	#TC_H_MAKE
(
maj
,
mš
è(((maj)&
TC_H_MAJ_MASK
)|((mš)&
TC_H_MIN_MASK
))

	)

72 
	#TC_H_UNSPEC
 (0U)

	)

73 
	#TC_H_ROOT
 (0xFFFFFFFFU)

	)

74 
	#TC_H_INGRESS
 (0xFFFFFFF1U)

	)

76 
	stc_¿‹¥ec
 {

77 
	mûÎ_log
;

78 
	m__»£rved
;

79 
	mov”h—d
;

80 
	mûÎ_®ign
;

81 
	mmpu
;

82 
__u32
 
	m¿‹
;

85 
	#TC_RTAB_SIZE
 1024

	)

87 
	stc_size¥ec
 {

88 
	mûÎ_log
;

89 
	msize_log
;

90 
	mûÎ_®ign
;

91 
	mov”h—d
;

92 
	mlškÏy”
;

93 
	mmpu
;

94 
	mmtu
;

95 
	mtsize
;

99 
	mTCA_STAB_UNSPEC
,

100 
	mTCA_STAB_BASE
,

101 
	mTCA_STAB_DATA
,

102 
	m__TCA_STAB_MAX


105 
	#TCA_STAB_MAX
 (
__TCA_STAB_MAX
 - 1)

	)

109 
	stc_fifo_qİt
 {

110 
__u32
 
	mlim™
;

115 
	#TCQ_PRIO_BANDS
 16

	)

116 
	#TCQ_MIN_PRIO_BANDS
 2

	)

118 
	stc_´io_qİt
 {

119 
	mbªds
;

120 
__u8
 
	m´iom­
[
TC_PRIO_MAX
+1];

125 
	stc_muÉiq_qİt
 {

126 
__u16
 
	mbªds
;

127 
__u16
 
	mmax_bªds
;

132 
	#TCQ_PLUG_BUFFER
 0

	)

133 
	#TCQ_PLUG_RELEASE_ONE
 1

	)

134 
	#TCQ_PLUG_RELEASE_INDEFINITE
 2

	)

135 
	#TCQ_PLUG_LIMIT
 3

	)

137 
	stc_¶ug_qİt
 {

147 
	maùiÚ
;

148 
__u32
 
	mlim™
;

153 
	stc_tbf_qİt
 {

154 
tc_¿‹¥ec
 
	m¿‹
;

155 
tc_¿‹¥ec
 
	m³ak¿‹
;

156 
__u32
 
	mlim™
;

157 
__u32
 
	mbufãr
;

158 
__u32
 
	mmtu
;

162 
	mTCA_TBF_UNSPEC
,

163 
	mTCA_TBF_PARMS
,

164 
	mTCA_TBF_RTAB
,

165 
	mTCA_TBF_PTAB
,

166 
	m__TCA_TBF_MAX
,

169 
	#TCA_TBF_MAX
 (
__TCA_TBF_MAX
 - 1)

	)

178 
	stc_sfq_qİt
 {

179 
	mquªtum
;

180 
	m³¹urb_³riod
;

181 
__u32
 
	mlim™
;

182 
	mdivisÜ
;

183 
	mæows
;

186 
	stc_sfq_x¡©s
 {

187 
__s32
 
	m®lÙ
;

202 
	mTCA_RED_UNSPEC
,

203 
	mTCA_RED_PARMS
,

204 
	mTCA_RED_STAB
,

205 
	m__TCA_RED_MAX
,

208 
	#TCA_RED_MAX
 (
__TCA_RED_MAX
 - 1)

	)

210 
	stc_»d_qİt
 {

211 
__u32
 
	mlim™
;

212 
__u32
 
	mqth_mš
;

213 
__u32
 
	mqth_max
;

214 
	mWlog
;

215 
	mPlog
;

216 
	mSûÎ_log
;

217 
	mæags
;

218 
	#TC_RED_ECN
 1

	)

219 
	#TC_RED_HARDDROP
 2

	)

222 
	stc_»d_x¡©s
 {

223 
__u32
 
	m—¾y
;

224 
__u32
 
	mpdrİ
;

225 
__u32
 
	mÙh”
;

226 
__u32
 
	mm¬ked
;

231 
	#MAX_DPs
 16

	)

234 
	mTCA_GRED_UNSPEC
,

235 
	mTCA_GRED_PARMS
,

236 
	mTCA_GRED_STAB
,

237 
	mTCA_GRED_DPS
,

238 
	m__TCA_GRED_MAX
,

241 
	#TCA_GRED_MAX
 (
__TCA_GRED_MAX
 - 1)

	)

243 
	stc_g»d_qİt
 {

244 
__u32
 
	mlim™
;

245 
__u32
 
	mqth_mš
;

246 
__u32
 
	mqth_max
;

247 
__u32
 
	mDP
;

248 
__u32
 
	mbacklog
;

249 
__u32
 
	mqave
;

250 
__u32
 
	mfÜûd
;

251 
__u32
 
	m—¾y
;

252 
__u32
 
	mÙh”
;

253 
__u32
 
	mpdrİ
;

254 
__u8
 
	mWlog
;

255 
__u8
 
	mPlog
;

256 
__u8
 
	mSûÎ_log
;

257 
__u8
 
	m´io
;

258 
__u32
 
	m·ck‘s
;

259 
__u32
 
	mby‹sš
;

263 
	stc_g»d_sİt
 {

264 
__u32
 
	mDPs
;

265 
__u32
 
	mdef_DP
;

266 
__u8
 
	mgrio
;

267 
__u8
 
	mæags
;

268 
__u16
 
	m·d1
;

274 
	mTCA_CHOKE_UNSPEC
,

275 
	mTCA_CHOKE_PARMS
,

276 
	mTCA_CHOKE_STAB
,

277 
	m__TCA_CHOKE_MAX
,

280 
	#TCA_CHOKE_MAX
 (
__TCA_CHOKE_MAX
 - 1)

	)

282 
	stc_choke_qİt
 {

283 
__u32
 
	mlim™
;

284 
__u32
 
	mqth_mš
;

285 
__u32
 
	mqth_max
;

286 
	mWlog
;

287 
	mPlog
;

288 
	mSûÎ_log
;

289 
	mæags
;

292 
	stc_choke_x¡©s
 {

293 
__u32
 
	m—¾y
;

294 
__u32
 
	mpdrİ
;

295 
__u32
 
	mÙh”
;

296 
__u32
 
	mm¬ked
;

297 
__u32
 
	mm©ched
;

301 
	#TC_HTB_NUMPRIO
 8

	)

302 
	#TC_HTB_MAXDEPTH
 8

	)

303 
	#TC_HTB_PROTOVER
 3

	)

305 
	stc_htb_İt
 {

306 
tc_¿‹¥ec
 
	m¿‹
;

307 
tc_¿‹¥ec
 
	mû
;

308 
__u32
 
	mbufãr
;

309 
__u32
 
	mcbufãr
;

310 
__u32
 
	mquªtum
;

311 
__u32
 
	mËv–
;

312 
__u32
 
	m´io
;

314 
	stc_htb_glob
 {

315 
__u32
 
	mv”siÚ
;

316 
__u32
 
	m¿‹2quªtum
;

317 
__u32
 
	mdefşs
;

318 
__u32
 
	mdebug
;

321 
__u32
 
	mdœeù_pkts
;

324 
	mTCA_HTB_UNSPEC
,

325 
	mTCA_HTB_PARMS
,

326 
	mTCA_HTB_INIT
,

327 
	mTCA_HTB_CTAB
,

328 
	mTCA_HTB_RTAB
,

329 
	m__TCA_HTB_MAX
,

332 
	#TCA_HTB_MAX
 (
__TCA_HTB_MAX
 - 1)

	)

334 
	stc_htb_x¡©s
 {

335 
__u32
 
	mËnds
;

336 
__u32
 
	mbÜrows
;

337 
__u32
 
	mgŸÁs
;

338 
__u32
 
	mtok’s
;

339 
__u32
 
	mùok’s
;

344 
	stc_hfsc_qİt
 {

345 
__u16
 
	mdefşs
;

348 
	stc_£rviû_curve
 {

349 
__u32
 
	mm1
;

350 
__u32
 
	md
;

351 
__u32
 
	mm2
;

354 
	stc_hfsc_¡©s
 {

355 
__u64
 
	mwÜk
;

356 
__u64
 
	m¹wÜk
;

357 
__u32
 
	m³riod
;

358 
__u32
 
	mËv–
;

362 
	mTCA_HFSC_UNSPEC
,

363 
	mTCA_HFSC_RSC
,

364 
	mTCA_HFSC_FSC
,

365 
	mTCA_HFSC_USC
,

366 
	m__TCA_HFSC_MAX
,

369 
	#TCA_HFSC_MAX
 (
__TCA_HFSC_MAX
 - 1)

	)

374 
	#TC_CBQ_MAXPRIO
 8

	)

375 
	#TC_CBQ_MAXLEVEL
 8

	)

376 
	#TC_CBQ_DEF_EWMA
 5

	)

378 
	stc_cbq_lssİt
 {

379 
	mchªge
;

380 
	mæags
;

381 
	#TCF_CBQ_LSS_BOUNDED
 1

	)

382 
	#TCF_CBQ_LSS_ISOLATED
 2

	)

383 
	mewma_log
;

384 
	mËv–
;

385 
	#TCF_CBQ_LSS_FLAGS
 1

	)

386 
	#TCF_CBQ_LSS_EWMA
 2

	)

387 
	#TCF_CBQ_LSS_MAXIDLE
 4

	)

388 
	#TCF_CBQ_LSS_MINIDLE
 8

	)

389 
	#TCF_CBQ_LSS_OFFTIME
 0x10

	)

390 
	#TCF_CBQ_LSS_AVPKT
 0x20

	)

391 
__u32
 
	mmaxidË
;

392 
__u32
 
	mmšidË
;

393 
__u32
 
	mofáime
;

394 
__u32
 
	mavpkt
;

397 
	stc_cbq_w¼İt
 {

398 
	mæags
;

399 
	m´iÜ™y
;

400 
	mıriÜ™y
;

401 
	m__»£rved
;

402 
__u32
 
	m®lÙ
;

403 
__u32
 
	mweight
;

406 
	stc_cbq_ovl
 {

407 
	m¡¿‹gy
;

408 
	#TC_CBQ_OVL_CLASSIC
 0

	)

409 
	#TC_CBQ_OVL_DELAY
 1

	)

410 
	#TC_CBQ_OVL_LOWPRIO
 2

	)

411 
	#TC_CBQ_OVL_DROP
 3

	)

412 
	#TC_CBQ_OVL_RCLASSIC
 4

	)

413 
	m´iÜ™y2
;

414 
__u16
 
	m·d
;

415 
__u32
 
	m³ÇÉy
;

418 
	stc_cbq_pŞiû
 {

419 
	mpŞiû
;

420 
	m__»s1
;

421 
	m__»s2
;

424 
	stc_cbq_fİt
 {

425 
__u32
 
	m¥l™
;

426 
__u32
 
	mdefm­
;

427 
__u32
 
	mdefchªge
;

430 
	stc_cbq_x¡©s
 {

431 
__u32
 
	mbÜrows
;

432 
__u32
 
	mov”aùiÚs
;

433 
__s32
 
	mavgidË
;

434 
__s32
 
	mund”time
;

438 
	mTCA_CBQ_UNSPEC
,

439 
	mTCA_CBQ_LSSOPT
,

440 
	mTCA_CBQ_WRROPT
,

441 
	mTCA_CBQ_FOPT
,

442 
	mTCA_CBQ_OVL_STRATEGY
,

443 
	mTCA_CBQ_RATE
,

444 
	mTCA_CBQ_RTAB
,

445 
	mTCA_CBQ_POLICE
,

446 
	m__TCA_CBQ_MAX
,

449 
	#TCA_CBQ_MAX
 (
__TCA_CBQ_MAX
 - 1)

	)

454 
	mTCA_DSMARK_UNSPEC
,

455 
	mTCA_DSMARK_INDICES
,

456 
	mTCA_DSMARK_DEFAULT_INDEX
,

457 
	mTCA_DSMARK_SET_TC_INDEX
,

458 
	mTCA_DSMARK_MASK
,

459 
	mTCA_DSMARK_VALUE
,

460 
	m__TCA_DSMARK_MAX
,

463 
	#TCA_DSMARK_MAX
 (
__TCA_DSMARK_MAX
 - 1)

	)

468 
	mTCA_FQ_CODEL_UNSPEC
,

469 
	mTCA_FQ_CODEL_TARGET
,

470 
	mTCA_FQ_CODEL_LIMIT
,

471 
	mTCA_FQ_CODEL_INTERVAL
,

472 
	mTCA_FQ_CODEL_ECN
,

473 
	mTCA_FQ_CODEL_FLOWS
,

474 
	mTCA_FQ_CODEL_QUANTUM
,

475 
	m__TCA_FQ_CODEL_MAX


478 
	#TCA_FQ_CODEL_MAX
 (
__TCA_FQ_CODEL_MAX
 - 1)

	)

483 
	mTCA_ATM_UNSPEC
,

484 
	mTCA_ATM_FD
,

485 
	mTCA_ATM_PTR
,

486 
	mTCA_ATM_HDR
,

487 
	mTCA_ATM_EXCESS
,

488 
	mTCA_ATM_ADDR
,

489 
	mTCA_ATM_STATE
,

490 
	m__TCA_ATM_MAX
,

493 
	#TCA_ATM_MAX
 (
__TCA_ATM_MAX
 - 1)

	)

498 
	mTCA_NETEM_UNSPEC
,

499 
	mTCA_NETEM_CORR
,

500 
	mTCA_NETEM_DELAY_DIST
,

501 
	mTCA_NETEM_REORDER
,

502 
	mTCA_NETEM_CORRUPT
,

503 
	mTCA_NETEM_LOSS
,

504 
	m__TCA_NETEM_MAX
,

507 
	#TCA_NETEM_MAX
 (
__TCA_NETEM_MAX
 - 1)

	)

509 
	stc_Ã‹m_qİt
 {

510 
__u32
 
	mÏ‹ncy
;

511 
__u32
 
	mlim™
;

512 
__u32
 
	mloss
;

513 
__u32
 
	mg­
;

514 
__u32
 
	mdu¶iÿ‹
;

515 
__u32
 
	mj™‹r
;

518 
	stc_Ã‹m_cÜr
 {

519 
__u32
 
	md–ay_cÜr
;

520 
__u32
 
	mloss_cÜr
;

521 
__u32
 
	mdup_cÜr
;

524 
	stc_Ã‹m_»Üd”
 {

525 
__u32
 
	m´obab™y
;

526 
__u32
 
	mcÜ»ÏtiÚ
;

529 
	stc_Ã‹m_cÜru±
 {

530 
__u32
 
	m´obab™y
;

531 
__u32
 
	mcÜ»ÏtiÚ
;

535 
	mNETEM_LOSS_UNSPEC
,

536 
	mNETEM_LOSS_GI
,

537 
	mNETEM_LOSS_GE
,

538 
	m__NETEM_LOSS_MAX


540 
	#NETEM_LOSS_MAX
 (
__NETEM_LOSS_MAX
 - 1)

	)

543 
	stc_Ã‹m_gimod–
 {

544 
__u32
 
	mp13
;

545 
__u32
 
	mp31
;

546 
__u32
 
	mp32
;

547 
__u32
 
	mp14
;

548 
__u32
 
	mp23
;

552 
	stc_Ã‹m_gemod–
 {

553 
__u32
 
	mp
;

554 
__u32
 
	mr
;

555 
__u32
 
	mh
;

556 
__u32
 
	mk1
;

559 
	#NETEM_DIST_SCALE
 8192

	)

560 
	#NETEM_DIST_MAX
 16384

	)

565 
	mTCA_DRR_UNSPEC
,

566 
	mTCA_DRR_QUANTUM
,

567 
	m__TCA_DRR_MAX


570 
	#TCA_DRR_MAX
 (
__TCA_DRR_MAX
 - 1)

	)

572 
	stc_d¼_¡©s
 {

573 
__u32
 
	mdefic™
;

577 
	#TC_QOPT_BITMASK
 15

	)

578 
	#TC_QOPT_MAX_QUEUE
 16

	)

580 
	stc_mq´io_qİt
 {

581 
__u8
 
	mnum_tc
;

582 
__u8
 
	m´io_tc_m­
[
TC_QOPT_BITMASK
 + 1];

583 
__u8
 
	mhw
;

584 
__u16
 
	mcouÁ
[
TC_QOPT_MAX_QUEUE
];

585 
__u16
 
	moff£t
[
TC_QOPT_MAX_QUEUE
];

591 
	mTCA_SFB_UNSPEC
,

592 
	mTCA_SFB_PARMS
,

593 
	m__TCA_SFB_MAX
,

596 
	#TCA_SFB_MAX
 (
__TCA_SFB_MAX
 - 1)

	)

601 
	stc_sfb_qİt
 {

602 
__u32
 
	m»hash_š‹rv®
;

603 
__u32
 
	mw¬mup_time
;

604 
__u32
 
	mmax
;

605 
__u32
 
	mbš_size
;

606 
__u32
 
	mšüem’t
;

607 
__u32
 
	mdeüem’t
;

608 
__u32
 
	mlim™
;

609 
__u32
 
	m³ÇÉy_¿‹
;

610 
__u32
 
	m³ÇÉy_bur¡
;

613 
	stc_sfb_x¡©s
 {

614 
__u32
 
	m—¾ydrİ
;

615 
__u32
 
	m³ÇÉydrİ
;

616 
__u32
 
	mbuck‘drİ
;

617 
__u32
 
	mqueuedrİ
;

618 
__u32
 
	mchddrİ
;

619 
__u32
 
	mm¬ked
;

620 
__u32
 
	mmaxqËn
;

621 
__u32
 
	mmax´ob
;

622 
__u32
 
	mavg´ob
;

625 
	#SFB_MAX_PROB
 0xFFFF

	)

629 
	mTCA_QFQ_UNSPEC
,

630 
	mTCA_QFQ_WEIGHT
,

631 
	mTCA_QFQ_LMAX
,

632 
	m__TCA_QFQ_MAX


635 
	#TCA_QFQ_MAX
 (
__TCA_QFQ_MAX
 - 1)

	)

637 
	stc_qfq_¡©s
 {

638 
__u32
 
	mweight
;

639 
__u32
 
	mlmax
;

	@mylibnl/libnl-3.2.25/include/linux/rtnetlink.h

1 #iâdeà
__LINUX_RTNETLINK_H


2 
	#__LINUX_RTNETLINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

6 
	~<lšux/if_lšk.h
>

7 
	~<lšux/if_addr.h
>

8 
	~<lšux/Ãighbour.h
>

13 
	#RTNL_FAMILY_IPMR
 128

	)

14 
	#RTNL_FAMILY_IP6MR
 129

	)

15 
	#RTNL_FAMILY_MAX
 129

	)

24 
	mRTM_BASE
 = 16,

25 
	#RTM_BASE
 
RTM_BASE


	)

27 
	mRTM_NEWLINK
 = 16,

28 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

29 
	mRTM_DELLINK
,

30 
	#RTM_DELLINK
 
RTM_DELLINK


	)

31 
	mRTM_GETLINK
,

32 
	#RTM_GETLINK
 
RTM_GETLINK


	)

33 
	mRTM_SETLINK
,

34 
	#RTM_SETLINK
 
RTM_SETLINK


	)

36 
	mRTM_NEWADDR
 = 20,

37 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

38 
	mRTM_DELADDR
,

39 
	#RTM_DELADDR
 
RTM_DELADDR


	)

40 
	mRTM_GETADDR
,

41 
	#RTM_GETADDR
 
RTM_GETADDR


	)

43 
	mRTM_NEWROUTE
 = 24,

44 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

45 
	mRTM_DELROUTE
,

46 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

47 
	mRTM_GETROUTE
,

48 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

50 
	mRTM_NEWNEIGH
 = 28,

51 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

52 
	mRTM_DELNEIGH
,

53 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

54 
	mRTM_GETNEIGH
,

55 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

57 
	mRTM_NEWRULE
 = 32,

58 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

59 
	mRTM_DELRULE
,

60 
	#RTM_DELRULE
 
RTM_DELRULE


	)

61 
	mRTM_GETRULE
,

62 
	#RTM_GETRULE
 
RTM_GETRULE


	)

64 
	mRTM_NEWQDISC
 = 36,

65 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

66 
	mRTM_DELQDISC
,

67 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

68 
	mRTM_GETQDISC
,

69 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

71 
	mRTM_NEWTCLASS
 = 40,

72 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

73 
	mRTM_DELTCLASS
,

74 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

75 
	mRTM_GETTCLASS
,

76 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

78 
	mRTM_NEWTFILTER
 = 44,

79 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

80 
	mRTM_DELTFILTER
,

81 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

82 
	mRTM_GETTFILTER
,

83 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

85 
	mRTM_NEWACTION
 = 48,

86 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

87 
	mRTM_DELACTION
,

88 
	#RTM_DELACTION
 
RTM_DELACTION


	)

89 
	mRTM_GETACTION
,

90 
	#RTM_GETACTION
 
RTM_GETACTION


	)

92 
	mRTM_NEWPREFIX
 = 52,

93 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

95 
	mRTM_GETMULTICAST
 = 58,

96 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

98 
	mRTM_GETANYCAST
 = 62,

99 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

101 
	mRTM_NEWNEIGHTBL
 = 64,

102 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

103 
	mRTM_GETNEIGHTBL
 = 66,

104 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

105 
	mRTM_SETNEIGHTBL
,

106 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

108 
	mRTM_NEWNDUSEROPT
 = 68,

109 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

111 
	mRTM_NEWADDRLABEL
 = 72,

112 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

113 
	mRTM_DELADDRLABEL
,

114 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

115 
	mRTM_GETADDRLABEL
,

116 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

118 
	mRTM_GETDCB
 = 78,

119 
	#RTM_GETDCB
 
RTM_GETDCB


	)

120 
	mRTM_SETDCB
,

121 
	#RTM_SETDCB
 
RTM_SETDCB


	)

123 
	m__RTM_MAX
,

124 
	#RTM_MAX
 (((
__RTM_MAX
 + 3è& ~3è- 1)

	)

127 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

128 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

129 
	#RTM_FAM
(
cmd
è(((cmdè- 
RTM_BASE
è>> 2)

	)

137 
	s¹©Œ
 {

138 
	m¹a_Ën
;

139 
	m¹a_ty³
;

144 
	#RTA_ALIGNTO
 4

	)

145 
	#RTA_ALIGN
(
Ën
èĞ(Ö’)+
RTA_ALIGNTO
-1è& ~(RTA_ALIGNTO-1è)

	)

146 
	#RTA_OK
(
¹a
,
Ën
è(Ö’è>ğ()(
¹©Œ
) && \

147 (
¹a
)->
¹a_Ën
 >ğ(
¹©Œ
) && \

148 (
¹a
)->
¹a_Ën
 <ğ(
Ën
))

	)

149 
	#RTA_NEXT
(
¹a
,
©ŒËn
è(×‰¾’è-ğ
	`RTA_ALIGN
(Ô)->
¹a_Ën
), \

150 (
¹©Œ
*)(((*)(
¹a
)è+ 
	`RTA_ALIGN
(Ô)->
¹a_Ën
)))

	)

151 
	#RTA_LENGTH
(
Ën
è(
	`RTA_ALIGN
((
¹©Œ
)è+ (Ën))

	)

152 
	#RTA_SPACE
(
Ën
è
	`RTA_ALIGN
(
	`RTA_LENGTH
Ö’))

	)

153 
	#RTA_DATA
(
¹a
è((*)(((*)Ô)è+ 
	`RTA_LENGTH
(0)))

	)

154 
	#RTA_PAYLOAD
(
¹a
è(()(Ô)->
¹a_Ën
è- 
	`RTA_LENGTH
(0))

	)

163 
	s¹msg
 {

164 
	m¹m_çmy
;

165 
	m¹m_d¡_Ën
;

166 
	m¹m_¤c_Ën
;

167 
	m¹m_tos
;

169 
	m¹m_bË
;

170 
	m¹m_´ÙocŞ
;

171 
	m¹m_scİe
;

172 
	m¹m_ty³
;

174 
	m¹m_æags
;

180 
	mRTN_UNSPEC
,

181 
	mRTN_UNICAST
,

182 
	mRTN_LOCAL
,

183 
	mRTN_BROADCAST
,

185 
	mRTN_ANYCAST
,

187 
	mRTN_MULTICAST
,

188 
	mRTN_BLACKHOLE
,

189 
	mRTN_UNREACHABLE
,

190 
	mRTN_PROHIBIT
,

191 
	mRTN_THROW
,

192 
	mRTN_NAT
,

193 
	mRTN_XRESOLVE
,

194 
	m__RTN_MAX


197 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

202 
	#RTPROT_UNSPEC
 0

	)

203 
	#RTPROT_REDIRECT
 1

	)

205 
	#RTPROT_KERNEL
 2

	)

206 
	#RTPROT_BOOT
 3

	)

207 
	#RTPROT_STATIC
 4

	)

216 
	#RTPROT_GATED
 8

	)

217 
	#RTPROT_RA
 9

	)

218 
	#RTPROT_MRT
 10

	)

219 
	#RTPROT_ZEBRA
 11

	)

220 
	#RTPROT_BIRD
 12

	)

221 
	#RTPROT_DNROUTED
 13

	)

222 
	#RTPROT_XORP
 14

	)

223 
	#RTPROT_NTK
 15

	)

224 
	#RTPROT_DHCP
 16

	)

237 
	e¹_scİe_t
 {

238 
	mRT_SCOPE_UNIVERSE
=0,

240 
	mRT_SCOPE_SITE
=200,

241 
	mRT_SCOPE_LINK
=253,

242 
	mRT_SCOPE_HOST
=254,

243 
	mRT_SCOPE_NOWHERE
=255

248 
	#RTM_F_NOTIFY
 0x100

	)

249 
	#RTM_F_CLONED
 0x200

	)

250 
	#RTM_F_EQUALIZE
 0x400

	)

251 
	#RTM_F_PREFIX
 0x800

	)

255 
	e¹_şass_t
 {

256 
	mRT_TABLE_UNSPEC
=0,

258 
	mRT_TABLE_COMPAT
=252,

259 
	mRT_TABLE_DEFAULT
=253,

260 
	mRT_TABLE_MAIN
=254,

261 
	mRT_TABLE_LOCAL
=255,

262 
	mRT_TABLE_MAX
=0xFFFFFFFF

268 
	e¹©Œ_ty³_t
 {

269 
	mRTA_UNSPEC
,

270 
	mRTA_DST
,

271 
	mRTA_SRC
,

272 
	mRTA_IIF
,

273 
	mRTA_OIF
,

274 
	mRTA_GATEWAY
,

275 
	mRTA_PRIORITY
,

276 
	mRTA_PREFSRC
,

277 
	mRTA_METRICS
,

278 
	mRTA_MULTIPATH
,

279 
	mRTA_PROTOINFO
,

280 
	mRTA_FLOW
,

281 
	mRTA_CACHEINFO
,

282 
	mRTA_SESSION
,

283 
	mRTA_MP_ALGO
,

284 
	mRTA_TABLE
,

285 
	mRTA_MARK
,

286 
	m__RTA_MAX


289 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

291 
	#RTM_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
¹msg
))))

	)

292 
	#RTM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
¹msg
))

	)

303 
	s¹Ãxthİ
 {

304 
	m¹nh_Ën
;

305 
	m¹nh_æags
;

306 
	m¹nh_hİs
;

307 
	m¹nh_ifšdex
;

312 
	#RTNH_F_DEAD
 1

	)

313 
	#RTNH_F_PERVASIVE
 2

	)

314 
	#RTNH_F_ONLINK
 4

	)

318 
	#RTNH_ALIGNTO
 4

	)

319 
	#RTNH_ALIGN
(
Ën
èĞ(Ö’)+
RTNH_ALIGNTO
-1è& ~(RTNH_ALIGNTO-1è)

	)

320 
	#RTNH_OK
(
¹nh
,
Ën
è(ÔŠh)->
¹nh_Ën
 >ğ(
¹Ãxthİ
) && \

321 (()(
¹nh
)->
¹nh_Ën
è<ğ(
Ën
))

	)

322 
	#RTNH_NEXT
(
¹nh
è((
¹Ãxthİ
*)(((*)ÔŠh)è+ 
	`RTNH_ALIGN
(ÔŠh)->
¹nh_Ën
)))

	)

323 
	#RTNH_LENGTH
(
Ën
è(
	`RTNH_ALIGN
((
¹Ãxthİ
)è+ (Ën))

	)

324 
	#RTNH_SPACE
(
Ën
è
	`RTNH_ALIGN
(
	`RTNH_LENGTH
Ö’))

	)

325 
	#RTNH_DATA
(
¹nh
è((
¹©Œ
*)(((*)ÔŠh)è+ 
	`RTNH_LENGTH
(0)))

	)

329 
	s¹a_ÿchešfo
 {

330 
__u32
 
	m¹a_şÁ»f
;

331 
__u32
 
	m¹a_Ï¡u£
;

332 
__s32
 
	m¹a_expœes
;

333 
__u32
 
	m¹a_”rÜ
;

334 
__u32
 
	m¹a_u£d
;

336 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

337 
__u32
 
	m¹a_id
;

338 
__u32
 
	m¹a_ts
;

339 
__u32
 
	m¹a_t§ge
;

345 
	mRTAX_UNSPEC
,

346 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

347 
	mRTAX_LOCK
,

348 
	#RTAX_LOCK
 
RTAX_LOCK


	)

349 
	mRTAX_MTU
,

350 
	#RTAX_MTU
 
RTAX_MTU


	)

351 
	mRTAX_WINDOW
,

352 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

353 
	mRTAX_RTT
,

354 
	#RTAX_RTT
 
RTAX_RTT


	)

355 
	mRTAX_RTTVAR
,

356 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

357 
	mRTAX_SSTHRESH
,

358 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

359 
	mRTAX_CWND
,

360 
	#RTAX_CWND
 
RTAX_CWND


	)

361 
	mRTAX_ADVMSS
,

362 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

363 
	mRTAX_REORDERING
,

364 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

365 
	mRTAX_HOPLIMIT
,

366 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

367 
	mRTAX_INITCWND
,

368 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

369 
	mRTAX_FEATURES
,

370 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

371 
	mRTAX_RTO_MIN
,

372 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

373 
	mRTAX_INITRWND
,

374 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

375 
	m__RTAX_MAX


378 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

380 
	#RTAX_FEATURE_ECN
 0x00000001

	)

381 
	#RTAX_FEATURE_SACK
 0x00000002

	)

382 
	#RTAX_FEATURE_TIMESTAMP
 0x00000004

	)

383 
	#RTAX_FEATURE_ALLFRAG
 0x00000008

	)

385 
	s¹a_£ssiÚ
 {

386 
__u8
 
	m´Ùo
;

387 
__u8
 
	m·d1
;

388 
__u16
 
	m·d2
;

392 
__u16
 
	m¥Üt
;

393 
__u16
 
	mdpÜt
;

394 } 
	mpÜts
;

397 
__u8
 
	mty³
;

398 
__u8
 
	mcode
;

399 
__u16
 
	mid’t
;

400 } 
	micm±
;

402 
__u32
 
	m¥i
;

403 } 
	mu
;

410 
	s¹g’msg
 {

411 
	m¹g’_çmy
;

423 
	sifšfomsg
 {

424 
	mifi_çmy
;

425 
	m__ifi_·d
;

426 
	mifi_ty³
;

427 
	mifi_šdex
;

428 
	mifi_æags
;

429 
	mifi_chªge
;

436 
	s´efixmsg
 {

437 
	m´efix_çmy
;

438 
	m´efix_·d1
;

439 
	m´efix_·d2
;

440 
	m´efix_ifšdex
;

441 
	m´efix_ty³
;

442 
	m´efix_Ën
;

443 
	m´efix_æags
;

444 
	m´efix_·d3
;

449 
	mPREFIX_UNSPEC
,

450 
	mPREFIX_ADDRESS
,

451 
	mPREFIX_CACHEINFO
,

452 
	m__PREFIX_MAX


455 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

457 
	s´efix_ÿchešfo
 {

458 
__u32
 
	m´eã¼ed_time
;

459 
__u32
 
	mv®id_time
;

467 
	stcmsg
 {

468 
	mtcm_çmy
;

469 
	mtcm__·d1
;

470 
	mtcm__·d2
;

471 
	mtcm_ifšdex
;

472 
__u32
 
	mtcm_hªdË
;

473 
__u32
 
	mtcm_·»Á
;

474 
__u32
 
	mtcm_šfo
;

478 
	mTCA_UNSPEC
,

479 
	mTCA_KIND
,

480 
	mTCA_OPTIONS
,

481 
	mTCA_STATS
,

482 
	mTCA_XSTATS
,

483 
	mTCA_RATE
,

484 
	mTCA_FCNT
,

485 
	mTCA_STATS2
,

486 
	mTCA_STAB
,

487 
	m__TCA_MAX


490 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

492 
	#TCA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

493 
	#TCA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tcmsg
))

	)

499 
	sndu£rİtmsg
 {

500 
	mndu£rİt_çmy
;

501 
	mndu£rİt_·d1
;

502 
	mndu£rİt_İts_Ën
;

503 
	mndu£rİt_ifšdex
;

504 
__u8
 
	mndu£rİt_icmp_ty³
;

505 
__u8
 
	mndu£rİt_icmp_code
;

506 
	mndu£rİt_·d2
;

507 
	mndu£rİt_·d3
;

512 
	mNDUSEROPT_UNSPEC
,

513 
	mNDUSEROPT_SRCADDR
,

514 
	m__NDUSEROPT_MAX


517 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

519 #iâdeà
__KERNEL__


521 
	#RTMGRP_LINK
 1

	)

522 
	#RTMGRP_NOTIFY
 2

	)

523 
	#RTMGRP_NEIGH
 4

	)

524 
	#RTMGRP_TC
 8

	)

526 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

527 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

528 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

529 
	#RTMGRP_IPV4_RULE
 0x80

	)

531 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

532 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

533 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

534 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

536 
	#RTMGRP_DECÃt_IFADDR
 0x1000

	)

537 
	#RTMGRP_DECÃt_ROUTE
 0x4000

	)

539 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

543 
	e¹Ãšk_groups
 {

544 
	mRTNLGRP_NONE
,

545 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

546 
	mRTNLGRP_LINK
,

547 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

548 
	mRTNLGRP_NOTIFY
,

549 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

550 
	mRTNLGRP_NEIGH
,

551 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

552 
	mRTNLGRP_TC
,

553 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

554 
	mRTNLGRP_IPV4_IFADDR
,

555 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

556 
	mRTNLGRP_IPV4_MROUTE
,

557 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

558 
	mRTNLGRP_IPV4_ROUTE
,

559 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

560 
	mRTNLGRP_IPV4_RULE
,

561 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

562 
	mRTNLGRP_IPV6_IFADDR
,

563 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

564 
	mRTNLGRP_IPV6_MROUTE
,

565 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

566 
	mRTNLGRP_IPV6_ROUTE
,

567 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

568 
	mRTNLGRP_IPV6_IFINFO
,

569 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

570 
	mRTNLGRP_DECÃt_IFADDR
,

571 
	#RTNLGRP_DECÃt_IFADDR
 
RTNLGRP_DECÃt_IFADDR


	)

572 
	mRTNLGRP_NOP2
,

573 
	mRTNLGRP_DECÃt_ROUTE
,

574 
	#RTNLGRP_DECÃt_ROUTE
 
RTNLGRP_DECÃt_ROUTE


	)

575 
	mRTNLGRP_DECÃt_RULE
,

576 
	#RTNLGRP_DECÃt_RULE
 
RTNLGRP_DECÃt_RULE


	)

577 
	mRTNLGRP_NOP4
,

578 
	mRTNLGRP_IPV6_PREFIX
,

579 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

580 
	mRTNLGRP_IPV6_RULE
,

581 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

582 
	mRTNLGRP_ND_USEROPT
,

583 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

584 
	mRTNLGRP_PHONET_IFADDR
,

585 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

586 
	mRTNLGRP_PHONET_ROUTE
,

587 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

588 
	m__RTNLGRP_MAX


590 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

593 
	stÿmsg
 {

594 
	mtÿ_çmy
;

595 
	mtÿ__·d1
;

596 
	mtÿ__·d2
;

598 
	#TA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tÿmsg
))))

	)

599 
	#TA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tÿmsg
))

	)

600 
	#TCA_ACT_TAB
 1

	)

601 
	#TCAA_MAX
 1

	)

	@mylibnl/libnl-3.2.25/include/linux/snmp.h

7 #iâdeà
_LINUX_SNMP_H


8 
	#_LINUX_SNMP_H


	)

20 
	mIPSTATS_MIB_NUM
 = 0,

22 
	mIPSTATS_MIB_INPKTS
,

23 
	mIPSTATS_MIB_INOCTETS
,

24 
	mIPSTATS_MIB_INDELIVERS
,

25 
	mIPSTATS_MIB_OUTFORWDATAGRAMS
,

26 
	mIPSTATS_MIB_OUTPKTS
,

27 
	mIPSTATS_MIB_OUTOCTETS
,

29 
	mIPSTATS_MIB_INHDRERRORS
,

30 
	mIPSTATS_MIB_INTOOBIGERRORS
,

31 
	mIPSTATS_MIB_INNOROUTES
,

32 
	mIPSTATS_MIB_INADDRERRORS
,

33 
	mIPSTATS_MIB_INUNKNOWNPROTOS
,

34 
	mIPSTATS_MIB_INTRUNCATEDPKTS
,

35 
	mIPSTATS_MIB_INDISCARDS
,

36 
	mIPSTATS_MIB_OUTDISCARDS
,

37 
	mIPSTATS_MIB_OUTNOROUTES
,

38 
	mIPSTATS_MIB_REASMTIMEOUT
,

39 
	mIPSTATS_MIB_REASMREQDS
,

40 
	mIPSTATS_MIB_REASMOKS
,

41 
	mIPSTATS_MIB_REASMFAILS
,

42 
	mIPSTATS_MIB_FRAGOKS
,

43 
	mIPSTATS_MIB_FRAGFAILS
,

44 
	mIPSTATS_MIB_FRAGCREATES
,

45 
	mIPSTATS_MIB_INMCASTPKTS
,

46 
	mIPSTATS_MIB_OUTMCASTPKTS
,

47 
	mIPSTATS_MIB_INBCASTPKTS
,

48 
	mIPSTATS_MIB_OUTBCASTPKTS
,

49 
	mIPSTATS_MIB_INMCASTOCTETS
,

50 
	mIPSTATS_MIB_OUTMCASTOCTETS
,

51 
	mIPSTATS_MIB_INBCASTOCTETS
,

52 
	mIPSTATS_MIB_OUTBCASTOCTETS
,

53 
	mIPSTATS_MIB_CSUMERRORS
,

54 
	mIPSTATS_MIB_NOECTPKTS
,

55 
	mIPSTATS_MIB_ECT1PKTS
,

56 
	mIPSTATS_MIB_ECT0PKTS
,

57 
	mIPSTATS_MIB_CEPKTS
,

58 
	m__IPSTATS_MIB_MAX


68 
	mICMP_MIB_NUM
 = 0,

69 
	mICMP_MIB_INMSGS
,

70 
	mICMP_MIB_INERRORS
,

71 
	mICMP_MIB_INDESTUNREACHS
,

72 
	mICMP_MIB_INTIMEEXCDS
,

73 
	mICMP_MIB_INPARMPROBS
,

74 
	mICMP_MIB_INSRCQUENCHS
,

75 
	mICMP_MIB_INREDIRECTS
,

76 
	mICMP_MIB_INECHOS
,

77 
	mICMP_MIB_INECHOREPS
,

78 
	mICMP_MIB_INTIMESTAMPS
,

79 
	mICMP_MIB_INTIMESTAMPREPS
,

80 
	mICMP_MIB_INADDRMASKS
,

81 
	mICMP_MIB_INADDRMASKREPS
,

82 
	mICMP_MIB_OUTMSGS
,

83 
	mICMP_MIB_OUTERRORS
,

84 
	mICMP_MIB_OUTDESTUNREACHS
,

85 
	mICMP_MIB_OUTTIMEEXCDS
,

86 
	mICMP_MIB_OUTPARMPROBS
,

87 
	mICMP_MIB_OUTSRCQUENCHS
,

88 
	mICMP_MIB_OUTREDIRECTS
,

89 
	mICMP_MIB_OUTECHOS
,

90 
	mICMP_MIB_OUTECHOREPS
,

91 
	mICMP_MIB_OUTTIMESTAMPS
,

92 
	mICMP_MIB_OUTTIMESTAMPREPS
,

93 
	mICMP_MIB_OUTADDRMASKS
,

94 
	mICMP_MIB_OUTADDRMASKREPS
,

95 
	mICMP_MIB_CSUMERRORS
,

96 
	m__ICMP_MIB_MAX


99 
	#__ICMPMSG_MIB_MAX
 512

	)

107 
	mICMP6_MIB_NUM
 = 0,

108 
	mICMP6_MIB_INMSGS
,

109 
	mICMP6_MIB_INERRORS
,

110 
	mICMP6_MIB_OUTMSGS
,

111 
	mICMP6_MIB_OUTERRORS
,

112 
	mICMP6_MIB_CSUMERRORS
,

113 
	m__ICMP6_MIB_MAX


116 
	#__ICMP6MSG_MIB_MAX
 512

	)

125 
	mTCP_MIB_NUM
 = 0,

126 
	mTCP_MIB_RTOALGORITHM
,

127 
	mTCP_MIB_RTOMIN
,

128 
	mTCP_MIB_RTOMAX
,

129 
	mTCP_MIB_MAXCONN
,

130 
	mTCP_MIB_ACTIVEOPENS
,

131 
	mTCP_MIB_PASSIVEOPENS
,

132 
	mTCP_MIB_ATTEMPTFAILS
,

133 
	mTCP_MIB_ESTABRESETS
,

134 
	mTCP_MIB_CURRESTAB
,

135 
	mTCP_MIB_INSEGS
,

136 
	mTCP_MIB_OUTSEGS
,

137 
	mTCP_MIB_RETRANSSEGS
,

138 
	mTCP_MIB_INERRS
,

139 
	mTCP_MIB_OUTRSTS
,

140 
	mTCP_MIB_CSUMERRORS
,

141 
	m__TCP_MIB_MAX


151 
	mUDP_MIB_NUM
 = 0,

152 
	mUDP_MIB_INDATAGRAMS
,

153 
	mUDP_MIB_NOPORTS
,

154 
	mUDP_MIB_INERRORS
,

155 
	mUDP_MIB_OUTDATAGRAMS
,

156 
	mUDP_MIB_RCVBUFERRORS
,

157 
	mUDP_MIB_SNDBUFERRORS
,

158 
	mUDP_MIB_CSUMERRORS
,

159 
	m__UDP_MIB_MAX


165 
	mLINUX_MIB_NUM
 = 0,

166 
	mLINUX_MIB_SYNCOOKIESSENT
,

167 
	mLINUX_MIB_SYNCOOKIESRECV
,

168 
	mLINUX_MIB_SYNCOOKIESFAILED
,

169 
	mLINUX_MIB_EMBRYONICRSTS
,

170 
	mLINUX_MIB_PRUNECALLED
,

171 
	mLINUX_MIB_RCVPRUNED
,

172 
	mLINUX_MIB_OFOPRUNED
,

173 
	mLINUX_MIB_OUTOFWINDOWICMPS
,

174 
	mLINUX_MIB_LOCKDROPPEDICMPS
,

175 
	mLINUX_MIB_ARPFILTER
,

176 
	mLINUX_MIB_TIMEWAITED
,

177 
	mLINUX_MIB_TIMEWAITRECYCLED
,

178 
	mLINUX_MIB_TIMEWAITKILLED
,

179 
	mLINUX_MIB_PAWSPASSIVEREJECTED
,

180 
	mLINUX_MIB_PAWSACTIVEREJECTED
,

181 
	mLINUX_MIB_PAWSESTABREJECTED
,

182 
	mLINUX_MIB_DELAYEDACKS
,

183 
	mLINUX_MIB_DELAYEDACKLOCKED
,

184 
	mLINUX_MIB_DELAYEDACKLOST
,

185 
	mLINUX_MIB_LISTENOVERFLOWS
,

186 
	mLINUX_MIB_LISTENDROPS
,

187 
	mLINUX_MIB_TCPPREQUEUED
,

188 
	mLINUX_MIB_TCPDIRECTCOPYFROMBACKLOG
,

189 
	mLINUX_MIB_TCPDIRECTCOPYFROMPREQUEUE
,

190 
	mLINUX_MIB_TCPPREQUEUEDROPPED
,

191 
	mLINUX_MIB_TCPHPHITS
,

192 
	mLINUX_MIB_TCPHPHITSTOUSER
,

193 
	mLINUX_MIB_TCPPUREACKS
,

194 
	mLINUX_MIB_TCPHPACKS
,

195 
	mLINUX_MIB_TCPRENORECOVERY
,

196 
	mLINUX_MIB_TCPSACKRECOVERY
,

197 
	mLINUX_MIB_TCPSACKRENEGING
,

198 
	mLINUX_MIB_TCPFACKREORDER
,

199 
	mLINUX_MIB_TCPSACKREORDER
,

200 
	mLINUX_MIB_TCPRENOREORDER
,

201 
	mLINUX_MIB_TCPTSREORDER
,

202 
	mLINUX_MIB_TCPFULLUNDO
,

203 
	mLINUX_MIB_TCPPARTIALUNDO
,

204 
	mLINUX_MIB_TCPDSACKUNDO
,

205 
	mLINUX_MIB_TCPLOSSUNDO
,

206 
	mLINUX_MIB_TCPLOSTRETRANSMIT
,

207 
	mLINUX_MIB_TCPRENOFAILURES
,

208 
	mLINUX_MIB_TCPSACKFAILURES
,

209 
	mLINUX_MIB_TCPLOSSFAILURES
,

210 
	mLINUX_MIB_TCPFASTRETRANS
,

211 
	mLINUX_MIB_TCPFORWARDRETRANS
,

212 
	mLINUX_MIB_TCPSLOWSTARTRETRANS
,

213 
	mLINUX_MIB_TCPTIMEOUTS
,

214 
	mLINUX_MIB_TCPLOSSPROBES
,

215 
	mLINUX_MIB_TCPLOSSPROBERECOVERY
,

216 
	mLINUX_MIB_TCPRENORECOVERYFAIL
,

217 
	mLINUX_MIB_TCPSACKRECOVERYFAIL
,

218 
	mLINUX_MIB_TCPSCHEDULERFAILED
,

219 
	mLINUX_MIB_TCPRCVCOLLAPSED
,

220 
	mLINUX_MIB_TCPDSACKOLDSENT
,

221 
	mLINUX_MIB_TCPDSACKOFOSENT
,

222 
	mLINUX_MIB_TCPDSACKRECV
,

223 
	mLINUX_MIB_TCPDSACKOFORECV
,

224 
	mLINUX_MIB_TCPABORTONDATA
,

225 
	mLINUX_MIB_TCPABORTONCLOSE
,

226 
	mLINUX_MIB_TCPABORTONMEMORY
,

227 
	mLINUX_MIB_TCPABORTONTIMEOUT
,

228 
	mLINUX_MIB_TCPABORTONLINGER
,

229 
	mLINUX_MIB_TCPABORTFAILED
,

230 
	mLINUX_MIB_TCPMEMORYPRESSURES
,

231 
	mLINUX_MIB_TCPSACKDISCARD
,

232 
	mLINUX_MIB_TCPDSACKIGNOREDOLD
,

233 
	mLINUX_MIB_TCPDSACKIGNOREDNOUNDO
,

234 
	mLINUX_MIB_TCPSPURIOUSRTOS
,

235 
	mLINUX_MIB_TCPMD5NOTFOUND
,

236 
	mLINUX_MIB_TCPMD5UNEXPECTED
,

237 
	mLINUX_MIB_SACKSHIFTED
,

238 
	mLINUX_MIB_SACKMERGED
,

239 
	mLINUX_MIB_SACKSHIFTFALLBACK
,

240 
	mLINUX_MIB_TCPBACKLOGDROP
,

241 
	mLINUX_MIB_TCPMINTTLDROP
,

242 
	mLINUX_MIB_TCPDEFERACCEPTDROP
,

243 
	mLINUX_MIB_IPRPFILTER
,

244 
	mLINUX_MIB_TCPTIMEWAITOVERFLOW
,

245 
	mLINUX_MIB_TCPREQQFULLDOCOOKIES
,

246 
	mLINUX_MIB_TCPREQQFULLDROP
,

247 
	mLINUX_MIB_TCPRETRANSFAIL
,

248 
	mLINUX_MIB_TCPRCVCOALESCE
,

249 
	mLINUX_MIB_TCPOFOQUEUE
,

250 
	mLINUX_MIB_TCPOFODROP
,

251 
	mLINUX_MIB_TCPOFOMERGE
,

252 
	mLINUX_MIB_TCPCHALLENGEACK
,

253 
	mLINUX_MIB_TCPSYNCHALLENGE
,

254 
	mLINUX_MIB_TCPFASTOPENACTIVE
,

255 
	mLINUX_MIB_TCPFASTOPENPASSIVE
,

256 
	mLINUX_MIB_TCPFASTOPENPASSIVEFAIL
,

257 
	mLINUX_MIB_TCPFASTOPENLISTENOVERFLOW
,

258 
	mLINUX_MIB_TCPFASTOPENCOOKIEREQD
,

259 
	mLINUX_MIB_TCPSPURIOUS_RTX_HOSTQUEUES
,

260 
	mLINUX_MIB_BUSYPOLLRXPACKETS
,

261 
	m__LINUX_MIB_MAX


267 
	mLINUX_MIB_XFRMNUM
 = 0,

268 
	mLINUX_MIB_XFRMINERROR
,

269 
	mLINUX_MIB_XFRMINBUFFERERROR
,

270 
	mLINUX_MIB_XFRMINHDRERROR
,

271 
	mLINUX_MIB_XFRMINNOSTATES
,

272 
	mLINUX_MIB_XFRMINSTATEPROTOERROR
,

273 
	mLINUX_MIB_XFRMINSTATEMODEERROR
,

274 
	mLINUX_MIB_XFRMINSTATESEQERROR
,

275 
	mLINUX_MIB_XFRMINSTATEEXPIRED
,

276 
	mLINUX_MIB_XFRMINSTATEMISMATCH
,

277 
	mLINUX_MIB_XFRMINSTATEINVALID
,

278 
	mLINUX_MIB_XFRMINTMPLMISMATCH
,

279 
	mLINUX_MIB_XFRMINNOPOLS
,

280 
	mLINUX_MIB_XFRMINPOLBLOCK
,

281 
	mLINUX_MIB_XFRMINPOLERROR
,

282 
	mLINUX_MIB_XFRMOUTERROR
,

283 
	mLINUX_MIB_XFRMOUTBUNDLEGENERROR
,

284 
	mLINUX_MIB_XFRMOUTBUNDLECHECKERROR
,

285 
	mLINUX_MIB_XFRMOUTNOSTATES
,

286 
	mLINUX_MIB_XFRMOUTSTATEPROTOERROR
,

287 
	mLINUX_MIB_XFRMOUTSTATEMODEERROR
,

288 
	mLINUX_MIB_XFRMOUTSTATESEQERROR
,

289 
	mLINUX_MIB_XFRMOUTSTATEEXPIRED
,

290 
	mLINUX_MIB_XFRMOUTPOLBLOCK
,

291 
	mLINUX_MIB_XFRMOUTPOLDEAD
,

292 
	mLINUX_MIB_XFRMOUTPOLERROR
,

293 
	mLINUX_MIB_XFRMFWDHDRERROR
,

294 
	mLINUX_MIB_XFRMOUTSTATEINVALID
,

295 
	mLINUX_MIB_XFRMACQUIREERROR
,

296 
	m__LINUX_MIB_XFRMMAX


	@mylibnl/libnl-3.2.25/include/linux/tc_act/tc_mirred.h

1 #iâdeà
__LINUX_TC_MIR_H


2 
	#__LINUX_TC_MIR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

7 
	#TCA_ACT_MIRRED
 8

	)

8 
	#TCA_EGRESS_REDIR
 1

	)

9 
	#TCA_EGRESS_MIRROR
 2

	)

10 
	#TCA_INGRESS_REDIR
 3

	)

11 
	#TCA_INGRESS_MIRROR
 4

	)

13 
	stc_mœ»d
 {

14 
	mtc_g’
;

15 
	m—ùiÚ
;

16 
__u32
 
	mifšdex
;

20 
	mTCA_MIRRED_UNSPEC
,

21 
	mTCA_MIRRED_TM
,

22 
	mTCA_MIRRED_PARMS
,

23 
	m__TCA_MIRRED_MAX


25 
	#TCA_MIRRED_MAX
 (
__TCA_MIRRED_MAX
 - 1)

	)

	@mylibnl/libnl-3.2.25/include/linux/tc_ematch/tc_em_meta.h

1 #iâdeà
__LINUX_TC_EM_META_H


2 
	#__LINUX_TC_EM_META_H


	)

5 
	mTCA_EM_META_UNSPEC
,

6 
	mTCA_EM_META_HDR
,

7 
	mTCA_EM_META_LVALUE
,

8 
	mTCA_EM_META_RVALUE
,

9 
	m__TCA_EM_META_MAX


11 
	#TCA_EM_META_MAX
 (
__TCA_EM_META_MAX
 - 1)

	)

13 
	stcf_m‘a_v®
 {

14 
__u16
 
	mkšd
;

15 
__u8
 
	mshiá
;

16 
__u8
 
	mİ
;

19 
	#TCF_META_TYPE_MASK
 (0xà<< 12)

	)

20 
	#TCF_META_TYPE
(
kšd
è(((kšdè& 
TCF_META_TYPE_MASK
è>> 12)

	)

21 
	#TCF_META_ID_MASK
 0x7ff

	)

22 
	#TCF_META_ID
(
kšd
è((kšdè& 
TCF_META_ID_MASK
)

	)

25 
	mTCF_META_TYPE_VAR
,

26 
	mTCF_META_TYPE_INT
,

27 
	m__TCF_META_TYPE_MAX


29 
	#TCF_META_TYPE_MAX
 (
__TCF_META_TYPE_MAX
 - 1)

	)

32 
	mTCF_META_ID_VALUE
,

33 
	mTCF_META_ID_RANDOM
,

34 
	mTCF_META_ID_LOADAVG_0
,

35 
	mTCF_META_ID_LOADAVG_1
,

36 
	mTCF_META_ID_LOADAVG_2
,

37 
	mTCF_META_ID_DEV
,

38 
	mTCF_META_ID_PRIORITY
,

39 
	mTCF_META_ID_PROTOCOL
,

40 
	mTCF_META_ID_PKTTYPE
,

41 
	mTCF_META_ID_PKTLEN
,

42 
	mTCF_META_ID_DATALEN
,

43 
	mTCF_META_ID_MACLEN
,

44 
	mTCF_META_ID_NFMARK
,

45 
	mTCF_META_ID_TCINDEX
,

46 
	mTCF_META_ID_RTCLASSID
,

47 
	mTCF_META_ID_RTIIF
,

48 
	mTCF_META_ID_SK_FAMILY
,

49 
	mTCF_META_ID_SK_STATE
,

50 
	mTCF_META_ID_SK_REUSE
,

51 
	mTCF_META_ID_SK_BOUND_IF
,

52 
	mTCF_META_ID_SK_REFCNT
,

53 
	mTCF_META_ID_SK_SHUTDOWN
,

54 
	mTCF_META_ID_SK_PROTO
,

55 
	mTCF_META_ID_SK_TYPE
,

56 
	mTCF_META_ID_SK_RCVBUF
,

57 
	mTCF_META_ID_SK_RMEM_ALLOC
,

58 
	mTCF_META_ID_SK_WMEM_ALLOC
,

59 
	mTCF_META_ID_SK_OMEM_ALLOC
,

60 
	mTCF_META_ID_SK_WMEM_QUEUED
,

61 
	mTCF_META_ID_SK_RCV_QLEN
,

62 
	mTCF_META_ID_SK_SND_QLEN
,

63 
	mTCF_META_ID_SK_ERR_QLEN
,

64 
	mTCF_META_ID_SK_FORWARD_ALLOCS
,

65 
	mTCF_META_ID_SK_SNDBUF
,

66 
	mTCF_META_ID_SK_ALLOCS
,

67 
	mTCF_META_ID_SK_ROUTE_CAPS
,

68 
	mTCF_META_ID_SK_HASH
,

69 
	mTCF_META_ID_SK_LINGERTIME
,

70 
	mTCF_META_ID_SK_ACK_BACKLOG
,

71 
	mTCF_META_ID_SK_MAX_ACK_BACKLOG
,

72 
	mTCF_META_ID_SK_PRIO
,

73 
	mTCF_META_ID_SK_RCVLOWAT
,

74 
	mTCF_META_ID_SK_RCVTIMEO
,

75 
	mTCF_META_ID_SK_SNDTIMEO
,

76 
	mTCF_META_ID_SK_SENDMSG_OFF
,

77 
	mTCF_META_ID_SK_WRITE_PENDING
,

78 
	mTCF_META_ID_VLAN_TAG
,

79 
	mTCF_META_ID_RXHASH
,

80 
	m__TCF_META_ID_MAX


82 
	#TCF_META_ID_MAX
 (
__TCF_META_ID_MAX
 - 1)

	)

84 
	stcf_m‘a_hdr
 {

85 
tcf_m‘a_v®
 
	mËá
;

86 
tcf_m‘a_v®
 
	mright
;

	@mylibnl/libnl-3.2.25/include/netlink-private/cache-api.h

12 #iâdeà
NETLINK_CACHE_API_H_


13 
	#NETLINK_CACHE_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

18 #ifdeà
__ılu¥lus


112 
	#END_OF_MSGTYPES_LIST
 { -1, -1, 
NULL
 }

	)

117 
	sÆ_msgty³


120 
mt_id
;

123 
mt_aù
;

126 * 
mt_Çme
;

132 
	sÆ_af_group


135 
ag_çmy
;

138 
ag_group
;

141 
	#END_OF_GROUP_LIST
 
AF_UNSPEC
, 0

	)

149 
	sÆ_·r£r_·¿m


152 (*
µ_cb
)(
Æ_objeù
 *, 
Æ_·r£r_·¿m
 *);

155 * 
µ_¬g
;

165 
	sÆ_ÿche_İs


168 * 
co_Çme
;

171 
co_hdrsize
;

174 
co_´ÙocŞ
;

177 
co_hash_size
;

180 
co_æags
;

183 
co_»fút
;

186 
Æ_af_group
 * 
co_groups
;

192 (*
co_»que¡_upd©e
)(
Æ_ÿche
 *, 
Æ_sock
 *);

199 (*
co_msg_·r£r
)(
Æ_ÿche_İs
 *, 
sockaddr_Æ
 *,

200 
Æmsghdr
 *, 
Æ_·r£r_·¿m
 *);

224 (*
co_ev’t_f‹r
)(
Æ_ÿche
 *, 
Æ_objeù
 *
obj
);

239 (*
co_šşude_ev’t
)(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
,

240 
chªge_func_t
 
chªge_cb
, *
d©a
);

242 (*
»£rved_1
)();

243 (*
»£rved_2
)();

244 (*
»£rved_3
)();

245 (*
»£rved_4
)();

246 (*
»£rved_5
)();

247 (*
»£rved_6
)();

248 (*
»£rved_7
)();

249 (*
»£rved_8
)();

252 
Æ_objeù_İs
 * 
co_obj_İs
;

255 
Æ_ÿche_İs
 *
co_Ãxt
;

257 
Æ_ÿche
 *
co_majÜ_ÿche
;

258 
g’l_İs
 * 
co_g’l
;

261 
Æ_msgty³
 
co_msgty³s
[];

266 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/genl.h

12 #iâdeà
NETLINK_GENL_PRIV_H_


13 
	#NETLINK_GENL_PRIV_H_


	)

15 
	~<Ãšk-´iv©e/Ãšk.h
>

16 
	~<Ãšk/Ãšk.h
>

18 
	#GENL_HDRSIZE
(
hd¾’
è(
GENL_HDRLEN
 + (hd¾’))

	)

20 
g’l_»sŞve_id
(
g’l_İs
 *
İs
);

	@mylibnl/libnl-3.2.25/include/netlink-private/netlink.h

12 #iâdeà
NETLINK_LOCAL_H_


13 
	#NETLINK_LOCAL_H_


	)

15 
	~<¡dio.h
>

16 
	~<”ºo.h
>

17 
	~<¡dlib.h
>

18 
	~<¡ršg.h
>

19 
	~<uni¡d.h
>

20 
	~<fú.h
>

21 
	~<m©h.h
>

22 
	~<time.h
>

23 
	~<¡d¬g.h
>

24 
	~<ùy³.h
>

25 
	~<sys/ty³s.h
>

26 
	~<sys/¡©.h
>

27 
	~<sys/sock‘.h
>

28 
	~<š‰y³s.h
>

29 
	~<as£¹.h
>

30 
	~<lim™s.h
>

31 
	~<£¬ch.h
>

33 
	~<¬·/š‘.h
>

34 
	~<Ãtdb.h
>

36 
	~<defs.h
>

38 #iâdeà
SOL_NETLINK


39 
	#SOL_NETLINK
 270

	)

42 
	~<lšux/ty³s.h
>

45 
	~<lšux/if.h
>

46 
	~<lšux/if_¬p.h
>

47 
	~<lšux/if_‘h”.h
>

48 
	~<lšux/‘htoŞ.h
>

49 
	~<lšux/pkt_sched.h
>

50 
	~<lšux/pkt_şs.h
>

51 
	~<lšux/g’_¡©s.h
>

52 
	~<lšux/_mp_®g.h
>

53 
	~<lšux/©m.h
>

54 
	~<lšux/.h
>

55 
	~<lšux/v6.h
>

56 
	~<lšux/¢mp.h
>

58 #iâdeà
DISABLE_PTHREADS


59 
	~<±h»ad.h
>

62 
	~<Ãšk/Ãšk.h
>

63 
	~<Ãšk/hªdËrs.h
>

64 
	~<Ãšk/ÿche.h
>

65 
	~<Ãšk/rou‹/tc.h
>

66 
	~<Ãšk-´iv©e/objeù-­i.h
>

67 
	~<Ãšk-´iv©e/ÿche-­i.h
>

68 
	~<Ãšk-´iv©e/ty³s.h
>

70 
	#NSEC_PER_SEC
 1000000000L

	)

72 
	sŒªs_tbl
 {

73 
	mi
;

74 cÚ¡ *
	ma
;

77 
	#__ADD
(
id
, 
Çme
è{ .
i
 = id, .
a
 = #Çm},

	)

79 
	sŒªs_li¡
 {

80 
	mi
;

81 *
	ma
;

82 
Æ_li¡_h—d
 
	mli¡
;

85 #ifdeà
NL_DEBUG


86 
	#NL_DBG
(
LVL
,
FMT
,
ARG
...) \

88 ià(
LVL
 <ğ
Æ_debug
) \

89 
	`årštf
(
¡d”r
, \

90 "DBG<" #LVL ">%20s:%-4u %s: " 
FMT
, \

91 
__FILE__
, 
__LINE__
, \

92 
__PRETTY_FUNCTION__
, ##
ARG
); \

93 } 0)

	)

95 
	#NL_DBG
(
LVL
,
FMT
,
ARG
...èdØ{ } 0)

	)

98 
	#BUG
() \

100 
	`årštf
(
¡d”r
, "BUG‡t file…osition %s:%d:%s\n", \

101 
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
); \

102 
	`as£¹
(0); \

103 } 0)

	)

105 
	#BUG_ON
(
cÚd™iÚ
) \

107 ià(
cÚd™iÚ
) \

108 
	`BUG
(); \

109 } 0)

	)

112 
	#APPBUG
(
msg
) \

114 
	`årštf
(
¡d”r
, "APPLICATION BUG: %s:%d:%s: %s\n", \

115 
__FILE__
, 
__LINE__
, 
__PRETTY_FUNCTION__
, 
msg
); \

116 
	`as£¹
(0); \

117 } 0)

	)

119 
__Æ_»ad_num_¡r_fe
(cÚ¡ *
·th
,

120 (*
cb
)(, const *));

122 
	`__Œªs_li¡_add
(, cÚ¡ *, 
Æ_li¡_h—d
 *);

123 
	`__Œªs_li¡_ş—r
(
Æ_li¡_h—d
 *);

125 *
	`__ty³2¡r
(, *, 
size_t
, cÚ¡ 
Œªs_tbl
 *, size_t);

126 
	`__¡r2ty³
(cÚ¡ *, cÚ¡ 
Œªs_tbl
 *, 
size_t
);

128 *
	`__li¡_ty³2¡r
(, *, 
size_t
, 
Æ_li¡_h—d
 *);

129 
	`__li¡_¡r2ty³
(cÚ¡ *, 
Æ_li¡_h—d
 *);

131 *
	`__æags2¡r
(, *, 
size_t
, cÚ¡ 
Œªs_tbl
 *, size_t);

132 
	`__¡r2æags
(cÚ¡ *, cÚ¡ 
Œªs_tbl
 *, 
size_t
);

134 
	`dump_äom_İs
(
Æ_objeù
 *, 
Æ_dump_·¿ms
 *);

136 
šlše
 
	$Æ_cb_ÿÎ
(
Æ_cb
 *
cb
, 
ty³
, 
Æ_msg
 *
msg
)

138 
»t
;

140 
cb
->
cb_aùive
 = 
ty³
;

141 
»t
 = 
cb
->
cb_£t
[
ty³
](
msg
, cb->
cb_¬gs
[type]);

142 
cb
->
cb_aùive
 = 
__NL_CB_TYPE_MAX
;

143  
»t
;

144 
	}
}

146 
	#ARRAY_SIZE
(
X
è((Xè/ ((X)[0]))

	)

149 #iâdeà
off£tof


150 
	#off£tof
(
TYPE
, 
MEMBER
è((
size_t
è&((TYPE *)0)->MEMBER)

	)

153 
	#__š™
 
	`__©Œibu‹__
 ((
cÚ¡ruùÜ
))

	)

154 
	#__ex™
 
	`__©Œibu‹__
 ((
de¡ruùÜ
))

	)

155 #undeà
__d•»ÿ‹d


156 
	#__d•»ÿ‹d
 
	`__©Œibu‹__
 ((
d•»ÿ‹d
))

	)

158 
	#mš
(
x
,
y
) ({ \

159 
	`ty³of
(
x
è
_x
 = (x); \

160 
	`ty³of
(
y
è
_y
 = (y); \

161 (è(&
_x
 =ğ&
_y
); \

162 
_x
 < 
_y
 ? _x : _y; })

	)

164 
	#max
(
x
,
y
) ({ \

165 
	`ty³of
(
x
è
_x
 = (x); \

166 
	`ty³of
(
y
è
_y
 = (y); \

167 (è(&
_x
 =ğ&
_y
); \

168 
_x
 > 
_y
 ? _x : _y; })

	)

170 
	#mš_t
(
ty³
,
x
,
y
) \

171 ({ 
ty³
 
__x
 = (
x
);y³ 
__y
 = (
y
); __x < __y ? __x: __y; })

	)

172 
	#max_t
(
ty³
,
x
,
y
) \

173 ({ 
ty³
 
__x
 = (
x
);y³ 
__y
 = (
y
); __x > __y ? __x: __y; })

	)

175 
Æ_ÿche_·r£
(
Æ_ÿche_İs
 *, 
sockaddr_Æ
 *,

176 
Æmsghdr
 *, 
Æ_·r£r_·¿m
 *);

179 
šlše
 
	$¹Æ_cİy_¿‹¥ec
(
¹Æ_¿‹¥ec
 *
d¡
,

180 
tc_¿‹¥ec
 *
¤c
)

182 
d¡
->
rs_ûÎ_log
 = 
¤c
->
ûÎ_log
;

183 
d¡
->
rs_ov”h—d
 = 
¤c
->
ov”h—d
;

184 
d¡
->
rs_ûÎ_®ign
 = 
¤c
->
ûÎ_®ign
;

185 
d¡
->
rs_mpu
 = 
¤c
->
mpu
;

186 
d¡
->
rs_¿‹
 = 
¤c
->
¿‹
;

187 
	}
}

189 
šlše
 
	$¹Æ_rcİy_¿‹¥ec
(
tc_¿‹¥ec
 *
d¡
,

190 
¹Æ_¿‹¥ec
 *
¤c
)

192 
d¡
->
ûÎ_log
 = 
¤c
->
rs_ûÎ_log
;

193 
d¡
->
ov”h—d
 = 
¤c
->
rs_ov”h—d
;

194 
d¡
->
ûÎ_®ign
 = 
¤c
->
rs_ûÎ_®ign
;

195 
d¡
->
mpu
 = 
¤c
->
rs_mpu
;

196 
d¡
->
¿‹
 = 
¤c
->
rs_¿‹
;

197 
	}
}

199 
šlše
 *
	$Æ_ÿche_Çme
(
Æ_ÿche
 *
ÿche
)

201  
ÿche
->
c_İs
 ? cache->c_İs->
co_Çme
 : "unknown";

202 
	}
}

204 
	#GENL_FAMILY
(
id
, 
Çme
) \

206 { 
id
, 
NL_ACT_UNSPEC
, 
Çme
 }, \

207 
END_OF_MSGTYPES_LIST
, \

208 }

	)

210 
šlše
 
	$wa™_fÜ_ack
(
Æ_sock
 *
sk
)

212 ià(
sk
->
s_æags
 & 
NL_NO_AUTO_ACK
)

215  
	`Æ_wa™_fÜ_ack
(
sk
);

216 
	}
}

218 
šlše
 
	$bud_syscÚf_·th
(**
¡½
, cÚ¡ *
f’ame
)

220 *
syscÚfdœ
;

222 
syscÚfdœ
 = 
	`g‘’v
("NLSYSCONFDIR");

224 ià(!
syscÚfdœ
)

225 
syscÚfdœ
 = 
SYSCONFDIR
;

227  
	`a¥rštf
(
¡½
, "%s/%s", 
syscÚfdœ
, 
f’ame
);

228 
	}
}

230 #iâdeà
DISABLE_PTHREADS


231 
	#NL_LOCK
(
NAME
è
	`±h»ad_mu‹x_t
 (NAMEèğ
PTHREAD_MUTEX_INITIALIZER


	)

232 
	#NL_RW_LOCK
(
NAME
è
	`±h»ad_rwlock_t
 (NAMEèğ
PTHREAD_RWLOCK_INITIALIZER


	)

234 
šlše
 
	$Æ_lock
(
±h»ad_mu‹x_t
 *
lock
)

236 
	`±h»ad_mu‹x_lock
(
lock
);

237 
	}
}

239 
šlše
 
	$Æ_uÆock
(
±h»ad_mu‹x_t
 *
lock
)

241 
	`±h»ad_mu‹x_uÆock
(
lock
);

242 
	}
}

244 
šlše
 
	$Æ_»ad_lock
(
±h»ad_rwlock_t
 *
lock
)

246 
	`±h»ad_rwlock_rdlock
(
lock
);

247 
	}
}

249 
šlše
 
	$Æ_»ad_uÆock
(
±h»ad_rwlock_t
 *
lock
)

251 
	`±h»ad_rwlock_uÆock
(
lock
);

252 
	}
}

254 
šlše
 
	$Æ_wr™e_lock
(
±h»ad_rwlock_t
 *
lock
)

256 
	`±h»ad_rwlock_w¾ock
(
lock
);

257 
	}
}

259 
šlše
 
	$Æ_wr™e_uÆock
(
±h»ad_rwlock_t
 *
lock
)

261 
	`±h»ad_rwlock_uÆock
(
lock
);

262 
	}
}

265 
	#NL_LOCK
(
NAME
è
__unu£d_lock_
 ##NAME 
	`__©Œibu‹__
((
unu£d
))

	)

266 
	#NL_RW_LOCK
(
NAME
è
__unu£d_lock_
 ##NAME 
	`__©Œibu‹__
((
unu£d
))

	)

268 
	#Æ_lock
(
LOCK
èdØ{ } 0)

	)

269 
	#Æ_uÆock
(
LOCK
èdØ{ } 0)

	)

270 
	#Æ_»ad_lock
(
LOCK
èdØ{ } 0)

	)

271 
	#Æ_»ad_uÆock
(
LOCK
èdØ{ } 0)

	)

272 
	#Æ_wr™e_lock
(
LOCK
èdØ{ } 0)

	)

273 
	#Æ_wr™e_uÆock
(
LOCK
èdØ{ } 0)

	)

	@mylibnl/libnl-3.2.25/include/netlink-private/object-api.h

12 #iâdeà
NETLINK_OBJECT_API_H_


13 
	#NETLINK_OBJECT_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/uts.h
>

17 
	~<Ãšk/objeù.h
>

19 #ifdeà
__ılu¥lus


185 
	#NLHDR_COMMON
 \

186 
û_»fút
; \

187 
Æ_objeù_İs
 * 
û_İs
; \

188 
Æ_ÿche
 * 
û_ÿche
; \

189 
Æ_li¡_h—d
 
û_li¡
; \

190 
û_msgty³
; \

191 
û_æags
; \

192 
ušt32_t
 
û_mask
;

	)

194 
	sÆ_objeù


196 
NLHDR_COMMON


208 
	#AVAILABLE
(
A
, 
B
, 
ATTR
è(((A)->
û_mask
 & (B)->û_maskè& (ATTR))

	)

219 
	#AVAILABLE_MISMATCH
(
A
, 
B
, 
ATTR
è(((A)->
û_mask
 ^ (B)->û_maskè& (ATTR))

	)

236 
	#ATTR_MISMATCH
(
A
, 
B
, 
ATTR
, 
EXPR
è(
	`AVAILABLE_MISMATCH
(A, B, ATTR) || \

237 (
	`AVAILABLE
(
A
, 
B
, 
ATTR
è&& (
EXPR
)))

	)

260 
	#ATTR_DIFF
(
LIST
, 
ATTR
, 
A
, 
B
, 
EXPR
) \

261 ({ 
diff
 = 0; \

262 ià(((
LIST
è& (
ATTR
)è&& 
	`ATTR_MISMATCH
(
A
, 
B
, ATTR, 
EXPR
)) \

263 
diff
 = 
ATTR
; \

264 
diff
; })

	)

269 
	sÆ_objeù_İs


276 * 
oo_Çme
;

279 
size_t
 
oo_size
;

282 
ušt32_t
 
oo_id_©Œs
;

290 (*
oo_cÚ¡ruùÜ
)(
Æ_objeù
 *);

299 (*
oo_ä“_d©a
)(
Æ_objeù
 *);

311 (*
oo_şÚe
)(
Æ_objeù
 *, nl_object *);

322 (*
oo_dump
[
NL_DUMP_MAX
+1])(
Æ_objeù
 *,

323 
Æ_dump_·¿ms
 *);

336 (*
oo_com·»
)(
Æ_objeù
 *, nl_object *,

337 
ušt32_t
, );

350 (*
oo_upd©e
)(
Æ_objeù
 *, nl_object *);

360 (*
oo_keyg’
)(
Æ_objeù
 *, 
ušt32_t
 *, uint32_t);

362 *(*
oo_©Œs2¡r
)(, *, 
size_t
);

367 
ušt32_t
 (*
oo_id_©Œs_g‘
)(
Æ_objeù
 *);

372 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/route/link/api.h

12 #iâdeà
NETLINK_LINK_API_H_


13 
	#NETLINK_LINK_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


26 
	s¹Æ_lšk_šfo_İs


29 * 
io_Çme
;

32 
io_»fút
;

37 (*
io_®loc
)(
¹Æ_lšk
 *);

42 (*
io_·r£
)(
¹Æ_lšk
 *,

43 
Æ©Œ
 *,

44 
Æ©Œ
 *);

48 (*
io_dump
[
NL_DUMP_MAX
+1])(
¹Æ_lšk
 *,

49 
Æ_dump_·¿ms
 *);

53 (*
io_şÚe
)(
¹Æ_lšk
 *, rtnl_link *);

57 (*
io_put_©Œs
)(
Æ_msg
 *, 
¹Æ_lšk
 *);

61 (*
io_ä“
)(
¹Æ_lšk
 *);

63 
Æ_li¡_h—d
 
io_li¡
;

66 
¹Æ_lšk_šfo_İs
 *
¹Æ_lšk_šfo_İs_lookup
(const *);

67 
¹Æ_lšk_šfo_İs_put
(
¹Æ_lšk_šfo_İs
 *);

68 
¹Æ_lšk_»gi¡”_šfo
(
¹Æ_lšk_šfo_İs
 *);

69 
¹Æ_lšk_uÄegi¡”_šfo
(
¹Æ_lšk_šfo_İs
 *);

77 
	s¹Æ_lšk_af_İs


80 cÚ¡ 
	gao_çmy
;

83 
	gao_»fút
;

89 cÚ¡ 
Æa_pŞicy
 *
	gao_´Ùšfo_pŞicy
;

94 * (*
	gao_®loc
)(
	g¹Æ_lšk
 *);

98 * (*
	gao_şÚe
)(
	g¹Æ_lšk
 *, *);

101 (*
	gao_ä“
)(
	g¹Æ_lšk
 *, *);

105 (*
	gao_·r£_´Ùšfo
)(
	g¹Æ_lšk
 *,

106 
	gÆ©Œ
 *, *);

110 (*
	gao_·r£_af
)(
	g¹Æ_lšk
 *,

111 
	gÆ©Œ
 *, *);

115 (*
	gao_fl_af
)(
	g¹Æ_lšk
 *,

116 
Æ_msg
 *
	gmsg
, *);

119 (*
	gao_dump
[
NL_DUMP_MAX
+1])(
	g¹Æ_lšk
 *,

120 
	gÆ_dump_·¿ms
 *,

133 (*
	gao_com·»
)(
	g¹Æ_lšk
 *,

134 
	g¹Æ_lšk
 *, , 
	gušt32_t
, );

137 
¹Æ_lšk_af_İs
 *
¹Æ_lšk_af_İs_lookup
();

138 
¹Æ_lšk_af_İs_put
(
¹Æ_lšk_af_İs
 *);

139 * 
¹Æ_lšk_af_®loc
(
¹Æ_lšk
 *,

140 cÚ¡ 
¹Æ_lšk_af_İs
 *);

141 * 
¹Æ_lšk_af_d©a
(cÚ¡ 
¹Æ_lšk
 *,

142 cÚ¡ 
¹Æ_lšk_af_İs
 *);

143 
¹Æ_lšk_af_»gi¡”
(
¹Æ_lšk_af_İs
 *);

144 
¹Æ_lšk_af_uÄegi¡”
(
¹Æ_lšk_af_İs
 *);

145 
¹Æ_lšk_af_d©a_com·»
(
¹Æ_lšk
 *
a
,

146 
¹Æ_lšk
 *
b
,

147 
çmy
);

149 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/route/tc-api.h

12 #iâdeà
NETLINK_TC_API_H_


13 
	#NETLINK_TC_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/msg.h
>

17 
	~<Ãšk/rou‹/tc.h
>

19 #ifdeà
__ılu¥lus


30 
	s¹Æ_tc_İs


35 *
to_kšd
;

40 
¹Æ_tc_ty³
 
to_ty³
;

46 
size_t
 
to_size
;

51 (*
to_dump
[
NL_DUMP_MAX
+1])(
¹Æ_tc
 *, *,

52 
Æ_dump_·¿ms
 *);

56 (*
to_msg_fl
)(
¹Æ_tc
 *, *, 
Æ_msg
 *);

63 (*
to_msg_fl_¿w
)(
¹Æ_tc
 *, *, 
Æ_msg
 *);

68 (*
to_msg_·r£r
)(
¹Æ_tc
 *, *);

73 (*
to_ä“_d©a
)(
¹Æ_tc
 *, *);

78 (*
to_şÚe
)(*, *);

83 
Æ_li¡_h—d
 
to_li¡
;

86 
	s¹Æ_tc_ty³_İs


88 
¹Æ_tc_ty³
 
‰_ty³
;

90 *
‰_dump_´efix
;

95 (*
‰_dump
[
NL_DUMP_MAX
+1])(
¹Æ_tc
 *,

96 
Æ_dump_·¿ms
 *);

99 
¹Æ_tc_msg_·r£
(
Æmsghdr
 *,

100 
¹Æ_tc
 *);

101 
¹Æ_tc_msg_bud
(
¹Æ_tc
 *, ,

102 , 
Æ_msg
 **);

104 
¹Æ_tc_ä“_d©a
(
Æ_objeù
 *);

105 
¹Æ_tc_şÚe
(
Æ_objeù
 *,

106 
Æ_objeù
 *);

107 
¹Æ_tc_dump_lše
(
Æ_objeù
 *,

108 
Æ_dump_·¿ms
 *);

109 
¹Æ_tc_dump_d‘as
(
Æ_objeù
 *,

110 
Æ_dump_·¿ms
 *);

111 
¹Æ_tc_dump_¡©s
(
Æ_objeù
 *,

112 
Æ_dump_·¿ms
 *);

113 
¹Æ_tc_com·»
(
Æ_objeù
 *,

114 
Æ_objeù
 *,

115 
ušt32_t
, );

117 * 
¹Æ_tc_d©a
(
¹Æ_tc
 *);

118 * 
¹Æ_tc_d©a_check
(
¹Æ_tc
 *,

119 
¹Æ_tc_İs
 *);

121 
¹Æ_tc_İs
 * 
¹Æ_tc_lookup_İs
(
¹Æ_tc_ty³
,

123 
¹Æ_tc_İs
 * 
¹Æ_tc_g‘_İs
(
¹Æ_tc
 *);

124 
¹Æ_tc_»gi¡”
(
¹Æ_tc_İs
 *);

125 
¹Æ_tc_uÄegi¡”
(
¹Æ_tc_İs
 *);

127 
¹Æ_tc_ty³_»gi¡”
(
¹Æ_tc_ty³_İs
 *);

128 
¹Æ_tc_ty³_uÄegi¡”
(
¹Æ_tc_ty³_İs
 *);

130 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/socket.h

12 #iâdeà
NETLINK_SOCKET_PRIV_H_


13 
	#NETLINK_SOCKET_PRIV_H_


	)

15 
	~<Ãšk-´iv©e/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
_Æ_sock‘_is_loÿl_pÜt_un¥ecif›d
 (
Æ_sock
 *
sk
);

22 
ušt32_t
 
_Æ_sock‘_g’”©e_loÿl_pÜt_no_»Ëa£
(
Æ_sock
 *
sk
);

24 
_Æ_sock‘_u£d_pÜts_»Ëa£_®l
(cÚ¡ 
ušt32_t
 *
u£d_pÜts
);

25 
_Æ_sock‘_u£d_pÜts_£t
(
ušt32_t
 *
u£d_pÜts
, ušt32_ˆ
pÜt
);

27 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/tc.h

12 #iâdeà
NETLINK_TC_PRIV_H_


13 
	#NETLINK_TC_PRIV_H_


	)

15 
	~<Ãšk-´iv©e/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
	#TCA_ATTR_HANDLE
 0x0001

	)

22 
	#TCA_ATTR_PARENT
 0x0002

	)

23 
	#TCA_ATTR_IFINDEX
 0x0004

	)

24 
	#TCA_ATTR_KIND
 0x0008

	)

25 
	#TCA_ATTR_FAMILY
 0x0010

	)

26 
	#TCA_ATTR_INFO
 0x0020

	)

27 
	#TCA_ATTR_OPTS
 0x0040

	)

28 
	#TCA_ATTR_STATS
 0x0080

	)

29 
	#TCA_ATTR_XSTATS
 0x0100

	)

30 
	#TCA_ATTR_LINK
 0x0200

	)

31 
	#TCA_ATTR_MTU
 0x0400

	)

32 
	#TCA_ATTR_MPU
 0x0800

	)

33 
	#TCA_ATTR_OVERHEAD
 0x1000

	)

34 
	#TCA_ATTR_LINKTYPE
 0x2000

	)

35 
	#TCA_ATTR_MAX
 
TCA_ATTR_LINKTYPE


	)

37 
tÿ_·r£
(
Æ©Œ
 **, , 
¹Æ_tc
 *,

38 
Æa_pŞicy
 *);

40 
	#RTNL_TC_RTABLE_SIZE
 256

	)

42 
¹Æ_tc_bud_¿‹_bË
(
¹Æ_tc
 *
tc
, 
¹Æ_¿‹¥ec
 *,

43 
ušt32_t
 *);

46 
šlše
 *
tÿ_x¡©s
(
¹Æ_tc
 *
tÿ
)

48  
	gtÿ
->
	gtc_x¡©s
->
	gd_d©a
;

51 
Æ_af_group
 
tc_groups
[];

53 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink-private/types.h

13 #iâdeà
NETLINK_LOCAL_TYPES_H_


14 
	#NETLINK_LOCAL_TYPES_H_


	)

16 
	~<Ãšk/li¡.h
>

17 
	~<Ãšk/rou‹/lšk.h
>

18 
	~<Ãšk/rou‹/qdisc.h
>

19 
	~<Ãšk/rou‹/¹Æ.h
>

20 
	~<Ãšk/rou‹/rou‹.h
>

21 
	~<Ãšk/idŸg/idŸgÆ.h
>

22 
	~<Ãšk/Ãtf‹r/ù.h
>

23 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

24 
	~<lšux/tc_aù/tc_mœ»d.h
>

26 
	#NL_SOCK_BUFSIZE_SET
 (1<<0)

	)

27 
	#NL_SOCK_PASSCRED
 (1<<1)

	)

28 
	#NL_OWN_PORT
 (1<<2)

	)

29 
	#NL_MSG_PEEK
 (1<<3)

	)

30 
	#NL_NO_AUTO_ACK
 (1<<4)

	)

32 
	#NL_MSG_CRED_PRESENT
 1

	)

34 
	gÆ_ÿche_İs
;

35 
	gÆ_sock
;

36 
	gÆ_objeù
;

37 
	gÆ_hash_bË
;

39 
	sÆ_cb


41 
Æ_»cvmsg_msg_cb_t
 
	mcb_£t
[
NL_CB_TYPE_MAX
+1];

42 * 
	mcb_¬gs
[
NL_CB_TYPE_MAX
+1];

44 
Æ_»cvmsg_”r_cb_t
 
	mcb_”r
;

45 * 
	mcb_”r_¬g
;

49 (*
	mcb_»cvmsgs_ow
)(
	mÆ_sock
 *,

50 
	mÆ_cb
 *);

54 (*
	mcb_»cv_ow
)(
	mÆ_sock
 *,

55 
	msockaddr_Æ
 *,

57 
	muüed
 **);

61 (*
	mcb_£nd_ow
)(
	mÆ_sock
 *,

62 
	mÆ_msg
 *);

64 
	mcb_»fút
;

66 
Æ_cb_ty³
 
	mcb_aùive
;

69 
	sÆ_sock


71 
sockaddr_Æ
 
	ms_loÿl
;

72 
sockaddr_Æ
 
	ms_³”
;

73 
	ms_fd
;

74 
	ms_´Ùo
;

75 
	ms_£q_Ãxt
;

76 
	ms_£q_ex³ù
;

77 
	ms_æags
;

78 
Æ_cb
 * 
	ms_cb
;

79 
size_t
 
	ms_bufsize
;

82 
	sÆ_ÿche


84 
Æ_li¡_h—d
 
	mc_™ems
;

85 
	mc_n™ems
;

86 
	mc_Ÿrg1
;

87 
	mc_Ÿrg2
;

88 
	mc_»fút
;

89 
	mc_æags
;

90 
Æ_hash_bË
 * 
	mhashbË
;

91 
Æ_ÿche_İs
 * 
	mc_İs
;

94 
	sÆ_ÿche_assoc


96 
Æ_ÿche
 * 
	mÿ_ÿche
;

97 
chªge_func_t
 
	mÿ_chªge
;

98 * 
	mÿ_chªge_d©a
;

101 
	sÆ_ÿche_mngr


103 
	mcm_´ÙocŞ
;

104 
	mcm_æags
;

105 
	mcm_Çssocs
;

106 
Æ_sock
 * 
	mcm_sock
;

107 
Æ_sock
 * 
	mcm_sync_sock
;

108 
Æ_ÿche_assoc
 * 
	mcm_assocs
;

111 
	gÆ_·r£r_·¿m
;

113 
	#LOOSE_COMPARISON
 1

	)

115 
	#NL_OBJ_MARK
 1

	)

117 
	sÆ_d©a


119 
size_t
 
	md_size
;

120 * 
	md_d©a
;

123 
	sÆ_addr


125 
	ma_çmy
;

126 
	ma_maxsize
;

127 
	ma_Ën
;

128 
	ma_´efixËn
;

129 
	ma_»fút
;

130 
	ma_addr
[0];

133 
	sÆ_msg


135 
	mnm_´ÙocŞ
;

136 
	mnm_æags
;

137 
sockaddr_Æ
 
	mnm_¤c
;

138 
sockaddr_Æ
 
	mnm_d¡
;

139 
uüed
 
	mnm_üeds
;

140 
Æmsghdr
 * 
	mnm_Æh
;

141 
size_t
 
	mnm_size
;

142 
	mnm_»fút
;

145 
	s¹Æ_lšk_m­


147 
ušt64_t
 
	mlm_mem_¡¬t
;

148 
ušt64_t
 
	mlm_mem_’d
;

149 
ušt64_t
 
	mlm_ba£_addr
;

150 
ušt16_t
 
	mlm_œq
;

151 
ušt8_t
 
	mlm_dma
;

152 
ušt8_t
 
	mlm_pÜt
;

155 
	#IFQDISCSIZ
 32

	)

157 
	s¹Æ_lšk


159 
NLHDR_COMMON


161 
	ml_Çme
[
IFNAMSIZ
];

162 
ušt32_t
 
	ml_çmy
;

163 
ušt32_t
 
	ml_¬±y³
;

164 
ušt32_t
 
	ml_šdex
;

165 
ušt32_t
 
	ml_æags
;

166 
ušt32_t
 
	ml_chªge
;

167 
ušt32_t
 
	ml_mtu
;

168 
ušt32_t
 
	ml_lšk
;

169 
ušt32_t
 
	ml_txqËn
;

170 
ušt32_t
 
	ml_weight
;

171 
ušt32_t
 
	ml_ma¡”
;

172 
Æ_addr
 * 
	ml_addr
;

173 
Æ_addr
 * 
	ml_bÿ¡
;

174 
	ml_qdisc
[
IFQDISCSIZ
];

175 
¹Æ_lšk_m­
 
	ml_m­
;

176 
ušt64_t
 
	ml_¡©s
[
RTNL_LINK_STATS_MAX
+1];

177 
ušt32_t
 
	ml_æag_mask
;

178 
ušt32_t
 
	ml_num_vf
;

179 
ušt8_t
 
	ml_İ”¡©e
;

180 
ušt8_t
 
	ml_lškmode
;

182 * 
	ml_šfo_kšd
;

183 
¹Æ_lšk_šfo_İs
 * 
	ml_šfo_İs
;

184 * 
	ml_af_d©a
[
AF_MAX
];

185 * 
	ml_šfo
;

186 * 
	ml_içlŸs
;

187 
ušt32_t
 
	ml_´omiscu™y
;

188 
ušt32_t
 
	ml_num_tx_queues
;

189 
ušt32_t
 
	ml_num_rx_queues
;

190 
ušt32_t
 
	ml_group
;

191 
ušt8_t
 
	ml_ÿ¼›r
;

193 
¹Æ_lšk_af_İs
 * 
	ml_af_İs
;

194 
Æ_d©a
 * 
	ml_phys_pÜt_id
;

195 
	ml_ns_fd
;

196 
pid_t
 
	ml_ns_pid
;

199 
	s¹Æ_nÿchešfo


201 
ušt32_t
 
	mnci_cÚfœmed
;

202 
ušt32_t
 
	mnci_u£d
;

203 
ušt32_t
 
	mnci_upd©ed
;

204 
ušt32_t
 
	mnci_»fút
;

208 
	s¹Æ_Ãigh


210 
NLHDR_COMMON


211 
ušt32_t
 
	mn_çmy
;

212 
ušt32_t
 
	mn_ifšdex
;

213 
ušt16_t
 
	mn_¡©e
;

214 
ušt8_t
 
	mn_æags
;

215 
ušt8_t
 
	mn_ty³
;

216 
Æ_addr
 *
	mn_Îaddr
;

217 
Æ_addr
 *
	mn_d¡
;

218 
ušt32_t
 
	mn_´obes
;

219 
¹Æ_nÿchešfo
 
	mn_ÿchešfo
;

220 
ušt32_t
 
	mn_¡©e_mask
;

221 
ušt32_t
 
	mn_æag_mask
;

222 
ušt32_t
 
	mn_ma¡”
;

226 
	s¹Æ_addr_ÿchešfo


229 
ušt32_t
 
	maci_´eã»d
;

232 
ušt32_t
 
	maci_v®id
;

235 
ušt32_t
 
	maci_c¡amp
;

238 
ušt32_t
 
	maci_t¡amp
;

241 
	s¹Æ_addr


243 
NLHDR_COMMON


245 
ušt8_t
 
	ma_çmy
;

246 
ušt8_t
 
	ma_´efixËn
;

247 
ušt8_t
 
	ma_scİe
;

248 
ušt32_t
 
	ma_æags
;

249 
ušt32_t
 
	ma_ifšdex
;

251 
Æ_addr
 *
	ma_³”
;

252 
Æ_addr
 *
	ma_loÿl
;

253 
Æ_addr
 *
	ma_bÿ¡
;

254 
Æ_addr
 *
	ma_ªyÿ¡
;

255 
Æ_addr
 *
	ma_muÉiÿ¡
;

257 
¹Æ_addr_ÿchešfo
 
	ma_ÿchešfo
;

259 
	ma_Ïb–
[
IFNAMSIZ
];

260 
ušt32_t
 
	ma_æag_mask
;

261 
¹Æ_lšk
 *
	ma_lšk
;

264 
	s¹Æ_Ãxthİ


266 
ušt8_t
 
	m¹nh_æags
;

267 
ušt8_t
 
	m¹nh_æag_mask
;

268 
ušt8_t
 
	m¹nh_weight
;

270 
ušt32_t
 
	m¹nh_ifšdex
;

271 
Æ_addr
 * 
	m¹nh_g©eway
;

272 
ušt32_t
 
	mû_mask
;

273 
Æ_li¡_h—d
 
	m¹nh_li¡
;

274 
ušt32_t
 
	m¹nh_»®ms
;

277 
	s¹Æ_rou‹


279 
NLHDR_COMMON


281 
ušt8_t
 
	m¹_çmy
;

282 
ušt8_t
 
	m¹_d¡_Ën
;

283 
ušt8_t
 
	m¹_¤c_Ën
;

284 
ušt8_t
 
	m¹_tos
;

285 
ušt8_t
 
	m¹_´ÙocŞ
;

286 
ušt8_t
 
	m¹_scİe
;

287 
ušt8_t
 
	m¹_ty³
;

288 
ušt8_t
 
	m¹_nm‘rics
;

289 
ušt32_t
 
	m¹_æags
;

290 
Æ_addr
 * 
	m¹_d¡
;

291 
Æ_addr
 * 
	m¹_¤c
;

292 
ušt32_t
 
	m¹_bË
;

293 
ušt32_t
 
	m¹_iif
;

294 
ušt32_t
 
	m¹_´io
;

295 
ušt32_t
 
	m¹_m‘rics
[
RTAX_MAX
];

296 
ušt32_t
 
	m¹_m‘rics_mask
;

297 
ušt32_t
 
	m¹_Ä_nh
;

298 
Æ_addr
 * 
	m¹_´ef_¤c
;

299 
Æ_li¡_h—d
 
	m¹_Ãxthİs
;

300 
¹Æ_¹ÿchešfo
 
	m¹_ÿchešfo
;

301 
ušt32_t
 
	m¹_æag_mask
;

304 
	s¹Æ_ruË


306 
NLHDR_COMMON


307 
ušt8_t
 
	mr_çmy
;

308 
ušt8_t
 
	mr_aùiÚ
;

309 
ušt8_t
 
	mr_dsf›ld
;

310 
ušt8_t
 
	mr_unu£d
;

311 
ušt32_t
 
	mr_bË
;

312 
ušt32_t
 
	mr_æags
;

313 
ušt32_t
 
	mr_´io
;

314 
ušt32_t
 
	mr_m¬k
;

315 
ušt32_t
 
	mr_mask
;

316 
ušt32_t
 
	mr_gÙo
;

317 
ušt32_t
 
	mr_æow
;

318 
Æ_addr
 *
	mr_¤c
;

319 
Æ_addr
 *
	mr_d¡
;

320 
	mr_iiâame
[
IFNAMSIZ
];

321 
	mr_oiâame
[
IFNAMSIZ
];

324 
	s¹Æ_Ãightbl_·rms


330 
ušt32_t
 
	mÁp_ifšdex
;

335 
ušt32_t
 
	mÁp_»fút
;

342 
ušt32_t
 
	mÁp_queue_Ën
;

348 
ušt32_t
 
	mÁp_­p_´obes
;

353 
ušt32_t
 
	mÁp_uÿ¡_´obes
;

358 
ušt32_t
 
	mÁp_mÿ¡_´obes
;

363 
ušt64_t
 
	mÁp_ba£_»achabË_time
;

368 
ušt64_t
 
	mÁp_»achabË_time
;

374 
ušt64_t
 
	mÁp_»Œªs_time
;

380 
ušt64_t
 
	mÁp_gc_¡®e_time
;

386 
ušt64_t
 
	mÁp_´obe_d–ay
;

392 
ušt64_t
 
	mÁp_ªyÿ¡_d–ay
;

398 
ušt64_t
 
	mÁp_locktime
;

404 
ušt64_t
 
	mÁp_´oxy_d–ay
;

409 
ušt32_t
 
	mÁp_´oxy_qËn
;

414 
ušt32_t
 
	mÁp_mask
;

417 
	#NTBLNAMSIZ
 32

	)

423 
	s¹Æ_Ãightbl


425 
NLHDR_COMMON


427 
	mÁ_Çme
[
NTBLNAMSIZ
];

428 
ušt32_t
 
	mÁ_çmy
;

429 
ušt32_t
 
	mÁ_gc_th»sh1
;

430 
ušt32_t
 
	mÁ_gc_th»sh2
;

431 
ušt32_t
 
	mÁ_gc_th»sh3
;

432 
ušt64_t
 
	mÁ_gc_š‹rv®
;

433 
ndt_cÚfig
 
	mÁ_cÚfig
;

434 
¹Æ_Ãightbl_·rms
 
	mÁ_·rms
;

435 
ndt_¡©s
 
	mÁ_¡©s
;

438 
	s¹Æ_¿‹¥ec


440 
ušt8_t
 
	mrs_ûÎ_log
;

441 
ušt16_t
 
	mrs_ov”h—d
;

442 
št16_t
 
	mrs_ûÎ_®ign
;

443 
ušt16_t
 
	mrs_mpu
;

444 
ušt32_t
 
	mrs_¿‹
;

447 
	s¹Æ_t¡©s


450 
ušt64_t
 
	mby‹s
;

451 
ušt64_t
 
	m·ck‘s
;

452 } 
	mtcs_basic
;

455 
ušt32_t
 
	mbps
;

456 
ušt32_t
 
	mµs
;

457 } 
	mtcs_¿‹_e¡
;

460 
ušt32_t
 
	mqËn
;

461 
ušt32_t
 
	mbacklog
;

462 
ušt32_t
 
	mdrİs
;

463 
ušt32_t
 
	m»queues
;

464 
ušt32_t
 
	mov”lim™s
;

465 } 
	mtcs_queue
;

468 
	#TCKINDSIZ
 32

	)

470 
	#NL_TC_GENERIC
(
´e
) \

471 
NLHDR_COMMON
 \

472 
ušt32_t
 
´e
 ##
_çmy
; \

473 
ušt32_t
 
´e
 ##
_ifšdex
; \

474 
ušt32_t
 
´e
 ##
_hªdË
; \

475 
ušt32_t
 
´e
 ##
_·»Á
; \

476 
ušt32_t
 
´e
 ##
_šfo
; \

477 
ušt32_t
 
´e
 ##
_mtu
; \

478 
ušt32_t
 
´e
 ##
_mpu
; \

479 
ušt32_t
 
´e
 ##
_ov”h—d
; \

480 
ušt32_t
 
´e
 ##
_lškty³
; \

481 
´e
 ##
_kšd
[
TCKINDSIZ
]; \

482 
Æ_d©a
 * 
´e
 ##
_İts
; \

483 
ušt64_t
 
´e
 ##
_¡©s
[
RTNL_TC_STATS_MAX
+1]; \

484 
Æ_d©a
 * 
´e
 ##
_x¡©s
; \

485 
Æ_d©a
 * 
´e
 ##
_subd©a
; \

486 
¹Æ_lšk
 * 
´e
 ##
_lšk
; \

487 
¹Æ_tc_İs
 * 
´e
 ##
_İs
; \

488 
¹Æ_tc_ty³
 
´e
 ##
_ty³


	)

490 
	s¹Æ_tc


492 
NL_TC_GENERIC
(
tc
);

495 
	s¹Æ_qdisc


497 
NL_TC_GENERIC
(
q
);

500 
	s¹Æ_şass


502 
NL_TC_GENERIC
(
c
);

505 
	s¹Æ_şs


507 
NL_TC_GENERIC
(
c
);

508 
ušt16_t
 
	mc_´io
;

509 
ušt16_t
 
	mc_´ÙocŞ
;

512 
	s¹Æ_aù


514 
NL_TC_GENERIC
(
c
);

515 
¹Æ_aù
 * 
	ma_Ãxt
;

518 
	s¹Æ_mœ»d


520 
tc_mœ»d
 
	mm_·rm
;

523 
	s¹Æ_u32


525 
ušt32_t
 
	mcu_divisÜ
;

526 
ušt32_t
 
	mcu_hash
;

527 
ušt32_t
 
	mcu_şassid
;

528 
ušt32_t
 
	mcu_lšk
;

529 
Æ_d©a
 * 
	mcu_pút
;

530 
Æ_d©a
 * 
	mcu_£ËùÜ
;

531 
¹Æ_aù
* 
	mcu_aù
;

532 
Æ_d©a
 * 
	mcu_pŞiû
;

533 
	mcu_šdev
[
IFNAMSIZ
];

534 
	mcu_mask
;

537 
	s¹Æ_cgroup


539 
¹Æ_em©ch_Œ“
 *
	mcg_em©ch
;

540 
	mcg_mask
;

543 
	s¹Æ_fw


545 
ušt32_t
 
	mcf_şassid
;

546 
Æ_d©a
 * 
	mcf_aù
;

547 
Æ_d©a
 * 
	mcf_pŞiû
;

548 
	mcf_šdev
[
IFNAMSIZ
];

549 
ušt32_t
 
	mcf_fwmask
;

550 
	mcf_mask
;

553 
	s¹Æ_em©ch


555 
ušt16_t
 
	me_id
;

556 
ušt16_t
 
	me_kšd
;

557 
ušt16_t
 
	me_æags
;

558 
ušt16_t
 
	me_šdex
;

559 
size_t
 
	me_d©®’
;

561 
Æ_li¡_h—d
 
	me_chds
;

562 
Æ_li¡_h—d
 
	me_li¡
;

563 
¹Æ_em©ch_İs
 *
	me_İs
;

565 * 
	me_d©a
;

568 
	s¹Æ_em©ch_Œ“


570 
ušt16_t
 
	m‘_´ogid
;

571 
Æ_li¡_h—d
 
	m‘_li¡
;

575 
	s¹Æ_dsm¬k_qdisc


577 
ušt16_t
 
	mqdm_šdiûs
;

578 
ušt16_t
 
	mqdm_deçuÉ_šdex
;

579 
ušt32_t
 
	mqdm_£t_tc_šdex
;

580 
ušt32_t
 
	mqdm_mask
;

583 
	s¹Æ_dsm¬k_şass


585 
ušt8_t
 
	mcdm_bmask
;

586 
ušt8_t
 
	mcdm_v®ue
;

587 
ušt32_t
 
	mcdm_mask
;

590 
	s¹Æ_fifo


592 
ušt32_t
 
	mqf_lim™
;

593 
ušt32_t
 
	mqf_mask
;

596 
	s¹Æ_´io


598 
ušt32_t
 
	mqp_bªds
;

599 
ušt8_t
 
	mqp_´iom­
[
TC_PRIO_MAX
+1];

600 
ušt32_t
 
	mqp_mask
;

603 
	s¹Æ_tbf


605 
ušt32_t
 
	mqt_lim™
;

606 
¹Æ_¿‹¥ec
 
	mqt_¿‹
;

607 
ušt32_t
 
	mqt_¿‹_buck‘
;

608 
ušt32_t
 
	mqt_¿‹_txtime
;

609 
¹Æ_¿‹¥ec
 
	mqt_³ak¿‹
;

610 
ušt32_t
 
	mqt_³ak¿‹_buck‘
;

611 
ušt32_t
 
	mqt_³ak¿‹_txtime
;

612 
ušt32_t
 
	mqt_mask
;

615 
	s¹Æ_sfq


617 
ušt32_t
 
	mqs_quªtum
;

618 
ušt32_t
 
	mqs_³¹urb
;

619 
ušt32_t
 
	mqs_lim™
;

620 
ušt32_t
 
	mqs_divisÜ
;

621 
ušt32_t
 
	mqs_æows
;

622 
ušt32_t
 
	mqs_mask
;

625 
	s¹Æ_Ã‹m_cÜr


627 
ušt32_t
 
	mnmc_d–ay
;

628 
ušt32_t
 
	mnmc_loss
;

629 
ušt32_t
 
	mnmc_du¶iÿ‹
;

632 
	s¹Æ_Ã‹m_»o


634 
ušt32_t
 
	mnmro_´obab™y
;

635 
ušt32_t
 
	mnmro_cÜ»ÏtiÚ
;

638 
	s¹Æ_Ã‹m_ü±


640 
ušt32_t
 
	mnmü_´obab™y
;

641 
ušt32_t
 
	mnmü_cÜ»ÏtiÚ
;

644 
	s¹Æ_Ã‹m_di¡


646 
št16_t
 * 
	mdi¡_d©a
;

647 
size_t
 
	mdi¡_size
;

650 
	s¹Æ_Ã‹m


652 
ušt32_t
 
	mqnm_Ï‹ncy
;

653 
ušt32_t
 
	mqnm_lim™
;

654 
ušt32_t
 
	mqnm_loss
;

655 
ušt32_t
 
	mqnm_g­
;

656 
ušt32_t
 
	mqnm_du¶iÿ‹
;

657 
ušt32_t
 
	mqnm_j™‹r
;

658 
ušt32_t
 
	mqnm_mask
;

659 
¹Æ_Ã‹m_cÜr
 
	mqnm_cÜr
;

660 
¹Æ_Ã‹m_»o
 
	mqnm_ro
;

661 
¹Æ_Ã‹m_ü±
 
	mqnm_ü±
;

662 
¹Æ_Ã‹m_di¡
 
	mqnm_di¡
;

665 
	s¹Æ_htb_qdisc


667 
ušt32_t
 
	mqh_¿‹2quªtum
;

668 
ušt32_t
 
	mqh_defşs
;

669 
ušt32_t
 
	mqh_mask
;

670 
ušt32_t
 
	mqh_dœeù_pkts
;

673 
	s¹Æ_htb_şass


675 
ušt32_t
 
	mch_´io
;

676 
¹Æ_¿‹¥ec
 
	mch_¿‹
;

677 
¹Æ_¿‹¥ec
 
	mch_û
;

678 
ušt32_t
 
	mch_rbufãr
;

679 
ušt32_t
 
	mch_cbufãr
;

680 
ušt32_t
 
	mch_quªtum
;

681 
ušt32_t
 
	mch_mask
;

682 
ušt32_t
 
	mch_Ëv–
;

685 
	s¹Æ_cbq


687 
tc_cbq_lssİt
 
	mcbq_lss
;

688 
tc_¿‹¥ec
 
	mcbq_¿‹
;

689 
tc_cbq_w¼İt
 
	mcbq_w¼
;

690 
tc_cbq_ovl
 
	mcbq_ovl
;

691 
tc_cbq_fİt
 
	mcbq_fİt
;

692 
tc_cbq_pŞiû
 
	mcbq_pŞiû
;

695 
	s¹Æ_»d


697 
ušt32_t
 
	mqr_lim™
;

698 
ušt32_t
 
	mqr_qth_mš
;

699 
ušt32_t
 
	mqr_qth_max
;

700 
ušt8_t
 
	mqr_æags
;

701 
ušt8_t
 
	mqr_wlog
;

702 
ušt8_t
 
	mqr_¶og
;

703 
ušt8_t
 
	mqr_sûÎ_log
;

704 
ušt32_t
 
	mqr_mask
;

707 
	s¹Æ_¶ug


709 
	maùiÚ
;

710 
ušt32_t
 
	mlim™
;

713 
	s¹Æ_fq_cod–


715 
	mfq_lim™
;

716 
ušt32_t
 
	mfq_rg‘
;

717 
ušt32_t
 
	mfq_š‹rv®
;

718 
	mfq_æows
;

719 
ušt32_t
 
	mfq_quªtum
;

720 
	mfq_eú
;

721 
ušt32_t
 
	mfq_mask
;

724 
	sæÆ_»que¡


726 
NLHDR_COMMON


728 
Æ_addr
 * 
	mÌ_addr
;

729 
ušt32_t
 
	mÌ_fwm¬k
;

730 
ušt8_t
 
	mÌ_tos
;

731 
ušt8_t
 
	mÌ_scİe
;

732 
ušt8_t
 
	mÌ_bË
;

736 
	sæÆ_»suÉ


738 
NLHDR_COMMON


740 
æÆ_»que¡
 * 
	mä_»q
;

741 
ušt8_t
 
	mä_bË_id
;

742 
ušt8_t
 
	mä_´efixËn
;

743 
ušt8_t
 
	mä_nh_£l
;

744 
ušt8_t
 
	mä_ty³
;

745 
ušt8_t
 
	mä_scİe
;

746 
ušt32_t
 
	mä_”rÜ
;

749 
	#GENL_OP_HAS_POLICY
 1

	)

750 
	#GENL_OP_HAS_DOIT
 2

	)

751 
	#GENL_OP_HAS_DUMPIT
 4

	)

753 
	sg’l_çmy_İ


755 
ušt32_t
 
	mo_id
;

756 
ušt32_t
 
	mo_æags
;

758 
Æ_li¡_h—d
 
	mo_li¡
;

761 
	sg’l_çmy_g½
 {

762 
g’l_çmy
 *
	mçmy
;

763 
Æ_li¡_h—d
 
	mli¡
;

764 
	mÇme
[
GENL_NAMSIZ
];

765 
u_št32_t
 
	mid
;

768 
	sg’l_çmy


770 
NLHDR_COMMON


772 
ušt16_t
 
	mgf_id
;

773 
	mgf_Çme
[
GENL_NAMSIZ
];

774 
ušt32_t
 
	mgf_v”siÚ
;

775 
ušt32_t
 
	mgf_hdrsize
;

776 
ušt32_t
 
	mgf_max©Œ
;

778 
Æ_li¡_h—d
 
	mgf_İs
;

779 
Æ_li¡_h—d
 
	mgf_mc_g½s
;

782 
	unâl_ù_´Ùo


785 
ušt16_t
 
	m¤c
;

786 
ušt16_t
 
	md¡
;

787 } 
	mpÜt
;

789 
ušt16_t
 
	mid
;

790 
ušt8_t
 
	mty³
;

791 
ušt8_t
 
	mcode
;

792 } 
	micmp
;

795 
	snâl_ù_dœ
 {

796 
Æ_addr
 * 
	m¤c
;

797 
Æ_addr
 * 
	md¡
;

798 
nâl_ù_´Ùo
 
	m´Ùo
;

799 
ušt64_t
 
	m·ck‘s
;

800 
ušt64_t
 
	mby‹s
;

803 
	unâl_ù_´Ùošfo
 {

805 
ušt8_t
 
	m¡©e
;

806 } 
	mtı
;

809 
	snâl_ù
 {

810 
NLHDR_COMMON


812 
ušt8_t
 
	mù_çmy
;

813 
ušt8_t
 
	mù_´Ùo
;

814 
nâl_ù_´Ùošfo
 
	mù_´Ùošfo
;

816 
ušt32_t
 
	mù_¡©us
;

817 
ušt32_t
 
	mù_¡©us_mask
;

818 
ušt32_t
 
	mù_timeout
;

819 
ušt32_t
 
	mù_m¬k
;

820 
ušt32_t
 
	mù_u£
;

821 
ušt32_t
 
	mù_id
;

822 
ušt16_t
 
	mù_zÚe
;

824 
nâl_ù_dœ
 
	mù_Üig
;

825 
nâl_ù_dœ
 
	mù_»¶
;

827 
nâl_ù_time¡amp
 
	mù_t¡amp
;

830 
	unâl_exp_´Ùod©a
 {

832 
ušt16_t
 
	m¤c
;

833 
ušt16_t
 
	md¡
;

834 } 
	mpÜt
;

836 
ušt16_t
 
	mid
;

837 
ušt8_t
 
	mty³
;

838 
ušt8_t
 
	mcode
;

839 } 
	micmp
;

843 
	snâl_exp_´Ùo


845 
ušt8_t
 
	ml4´ÙÚum
;

846 
nâl_exp_´Ùod©a
 
	ml4´Ùod©a
;

849 
	snâl_exp_dœ
 {

850 
Æ_addr
 * 
	m¤c
;

851 
Æ_addr
 * 
	md¡
;

852 
nâl_exp_´Ùo
 
	m´Ùo
;

855 
	snâl_exp
 {

856 
NLHDR_COMMON


858 
ušt8_t
 
	mexp_çmy
;

859 
ušt32_t
 
	mexp_timeout
;

860 
ušt32_t
 
	mexp_id
;

861 
ušt16_t
 
	mexp_zÚe
;

862 
ušt32_t
 
	mexp_şass
;

863 
ušt32_t
 
	mexp_æags
;

864 * 
	mexp_h–³r_Çme
;

865 * 
	mexp_â
;

866 
ušt8_t
 
	mexp_Çt_dœ
;

868 
nâl_exp_dœ
 
	mexp_ex³ù
;

869 
nâl_exp_dœ
 
	mexp_ma¡”
;

870 
nâl_exp_dœ
 
	mexp_mask
;

871 
nâl_exp_dœ
 
	mexp_Çt
;

874 
	snâl_log
 {

875 
NLHDR_COMMON


877 
ušt16_t
 
	mlog_group
;

878 
ušt8_t
 
	mlog_cİy_mode
;

879 
ušt32_t
 
	mlog_cİy_¿nge
;

880 
ušt32_t
 
	mlog_æush_timeout
;

881 
ušt32_t
 
	mlog_®loc_size
;

882 
ušt32_t
 
	mlog_queue_th»shŞd
;

883 
ušt32_t
 
	mlog_æags
;

884 
ušt32_t
 
	mlog_æag_mask
;

887 
	snâl_log_msg
 {

888 
NLHDR_COMMON


890 
ušt8_t
 
	mlog_msg_çmy
;

891 
ušt8_t
 
	mlog_msg_hook
;

892 
ušt16_t
 
	mlog_msg_hw´Ùo
;

893 
ušt32_t
 
	mlog_msg_m¬k
;

894 
timev®
 
	mlog_msg_time¡amp
;

895 
ušt32_t
 
	mlog_msg_šdev
;

896 
ušt32_t
 
	mlog_msg_outdev
;

897 
ušt32_t
 
	mlog_msg_physšdev
;

898 
ušt32_t
 
	mlog_msg_physoutdev
;

899 
ušt8_t
 
	mlog_msg_hwaddr
[8];

900 
	mlog_msg_hwaddr_Ën
;

901 * 
	mlog_msg_·ylßd
;

902 
	mlog_msg_·ylßd_Ën
;

903 * 
	mlog_msg_´efix
;

904 
ušt32_t
 
	mlog_msg_uid
;

905 
ušt32_t
 
	mlog_msg_gid
;

906 
ušt32_t
 
	mlog_msg_£q
;

907 
ušt32_t
 
	mlog_msg_£q_glob®
;

910 
	snâl_queue
 {

911 
NLHDR_COMMON


913 
ušt16_t
 
	mqueue_group
;

914 
ušt32_t
 
	mqueue_maxËn
;

915 
ušt32_t
 
	mqueue_cİy_¿nge
;

916 
ušt8_t
 
	mqueue_cİy_mode
;

919 
	snâl_queue_msg
 {

920 
NLHDR_COMMON


922 
ušt16_t
 
	mqueue_msg_group
;

923 
ušt8_t
 
	mqueue_msg_çmy
;

924 
ušt8_t
 
	mqueue_msg_hook
;

925 
ušt16_t
 
	mqueue_msg_hw´Ùo
;

926 
ušt32_t
 
	mqueue_msg_·ck‘id
;

927 
ušt32_t
 
	mqueue_msg_m¬k
;

928 
timev®
 
	mqueue_msg_time¡amp
;

929 
ušt32_t
 
	mqueue_msg_šdev
;

930 
ušt32_t
 
	mqueue_msg_outdev
;

931 
ušt32_t
 
	mqueue_msg_physšdev
;

932 
ušt32_t
 
	mqueue_msg_physoutdev
;

933 
ušt8_t
 
	mqueue_msg_hwaddr
[8];

934 
	mqueue_msg_hwaddr_Ën
;

935 * 
	mqueue_msg_·ylßd
;

936 
	mqueue_msg_·ylßd_Ën
;

937 
ušt32_t
 
	mqueue_msg_v”diù
;

940 
	sem©ch_quÙed
 {

941 * 
	md©a
;

942 
size_t
 
	mËn
;

943 
	mšdex
;

946 
	sidŸgÆ_memšfo
 {

947 
NLHDR_COMMON


949 
ušt32_t
 
	midŸg_rmem
;

950 
ušt32_t
 
	midŸg_wmem
;

951 
ušt32_t
 
	midŸg_fmem
;

952 
ušt32_t
 
	midŸg_tmem
;

955 
	sidŸgÆ_vegasšfo
 {

956 
NLHDR_COMMON


958 
ušt32_t
 
	mtıv_’abËd
;

959 
ušt32_t
 
	mtıv_¹tút
;

960 
ušt32_t
 
	mtıv_¹t
;

961 
ušt32_t
 
	mtıv_mš¹t
;

964 
	sidŸgÆ_msg
 {

965 
NLHDR_COMMON


967 
ušt8_t
 
	midŸg_çmy
;

968 
ušt8_t
 
	midŸg_¡©e
;

969 
ušt8_t
 
	midŸg_tim”
;

970 
ušt8_t
 
	midŸg_»Œªs
;

971 
ušt16_t
 
	midŸg_¥Üt
;

972 
ušt16_t
 
	midŸg_dpÜt
;

973 
Æ_addr
 * 
	midŸg_¤c
;

974 
Æ_addr
 * 
	midŸg_d¡
;

975 
ušt32_t
 
	midŸg_ifšdex
;

976 
ušt32_t
 
	midŸg_expœes
;

977 
ušt32_t
 
	midŸg_rqueue
;

978 
ušt32_t
 
	midŸg_wqueue
;

979 
ušt32_t
 
	midŸg_uid
;

980 
ušt32_t
 
	midŸg_šode
;

982 
ušt8_t
 
	midŸg_tos
;

983 
ušt8_t
 
	midŸg_tşass
;

984 
ušt8_t
 
	midŸg_shutdown
;

985 * 
	midŸg_cÚg
;

986 
idŸgÆ_memšfo
 * 
	midŸg_memšfo
;

987 
idŸgÆ_vegasšfo
 * 
	midŸg_vegasšfo
;

988 
tı_šfo
 
	midŸg_tıšfo
;

989 
ušt32_t
 
	midŸg_skmemšfo
[
IDIAG_SK_MEMINFO_VARS
];

992 
	sidŸgÆ_»q
 {

993 
NLHDR_COMMON


995 
ušt8_t
 
	midŸg_çmy
;

996 
ušt8_t
 
	midŸg_ext
;

997 
Æ_addr
 * 
	midŸg_¤c
;

998 
Æ_addr
 * 
	midŸg_d¡
;

999 
ušt32_t
 
	midŸg_ifšdex
;

1000 
ušt32_t
 
	midŸg_¡©es
;

1001 
ušt32_t
 
	midŸg_dbs
;

	@mylibnl/libnl-3.2.25/include/netlink/addr.h

12 #iâdeà
NETLINK_ADDR_H_


13 
	#NETLINK_ADDR_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_addr
;

24 
Æ_addr
 * 
Æ_addr_®loc
(
size_t
);

25 
Æ_addr
 * 
Æ_addr_®loc_©Œ
(
Æ©Œ
 *, );

26 
Æ_addr
 * 
Æ_addr_bud
(, *, 
size_t
);

27 
Æ_addr_·r£
(cÚ¡ *, , 
Æ_addr
 **);

28 
Æ_addr
 * 
Æ_addr_şÚe
(nl_addr *);

31 
Æ_addr
 * 
Æ_addr_g‘
(nl_addr *);

32 
Æ_addr_put
(
Æ_addr
 *);

33 
Æ_addr_sh¬ed
(
Æ_addr
 *);

35 
Æ_addr_cmp
(
Æ_addr
 *, nl_addr *);

36 
Æ_addr_cmp_´efix
(
Æ_addr
 *, nl_addr *);

37 
Æ_addr_isz”o
(
Æ_addr
 *);

38 
Æ_addr_v®id
(*, );

39 
Æ_addr_guess_çmy
(
Æ_addr
 *);

40 
Æ_addr_fl_sockaddr
(
Æ_addr
 *,

41 
sockaddr
 *, 
sockËn_t
 *);

42 
Æ_addr_šfo
(
Æ_addr
 *, 
addršfo
 **);

43 
Æ_addr_»sŞve
(
Æ_addr
 *, *, 
size_t
);

46 
Æ_addr_£t_çmy
(
Æ_addr
 *, );

47 
Æ_addr_g‘_çmy
(
Æ_addr
 *);

48 
Æ_addr_£t_bš¬y_addr
(
Æ_addr
 *, *,

49 
size_t
);

50 * 
Æ_addr_g‘_bš¬y_addr
(
Æ_addr
 *);

51 
Æ_addr_g‘_Ën
(
Æ_addr
 *);

52 
Æ_addr_£t_´efixËn
(
Æ_addr
 *, );

53 
Æ_addr_g‘_´efixËn
(
Æ_addr
 *);

56 * 
Æ_af2¡r
(, *, 
size_t
);

57 
Æ_¡r2af
(const *);

60 * 
Æ_addr2¡r
(
Æ_addr
 *, *, 
size_t
);

62 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/attr.h

12 #iâdeà
NETLINK_ATTR_H_


13 
	#NETLINK_ATTR_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/objeù.h
>

17 
	~<Ãšk/addr.h
>

18 
	~<Ãšk/d©a.h
>

20 #ifdeà
__ılu¥lus


24 
Æ_msg
;

38 
NLA_UNSPEC
,

39 
NLA_U8
,

40 
NLA_U16
,

41 
NLA_U32
,

42 
NLA_U64
,

43 
NLA_STRING
,

44 
NLA_FLAG
,

45 
NLA_MSECS
,

46 
NLA_NESTED
,

47 
__NLA_TYPE_MAX
,

50 
	#NLA_TYPE_MAX
 (
__NLA_TYPE_MAX
 - 1)

	)

60 
	sÆa_pŞicy
 {

62 
ušt16_t
 
ty³
;

65 
ušt16_t
 
mšËn
;

68 
ušt16_t
 
maxËn
;

72 
Æa_©Œ_size
(
·ylßd
);

73 
Æa_tÙ®_size
(
·ylßd
);

74 
Æa_·dËn
(
·ylßd
);

77 
Æa_ty³
(cÚ¡ 
Æ©Œ
 *);

78 * 
Æa_d©a
(cÚ¡ 
Æ©Œ
 *);

79 
Æa_Ën
(cÚ¡ 
Æ©Œ
 *);

80 
Æa_ok
(cÚ¡ 
Æ©Œ
 *, );

81 
Æ©Œ
 * 
Æa_Ãxt
(const nlattr *, *);

82 
Æa_·r£
(
Æ©Œ
 **, , nlattr *,

83 , 
Æa_pŞicy
 *);

84 
Æa_v®id©e
(
Æ©Œ
 *, , ,

85 
Æa_pŞicy
 *);

86 
Æ©Œ
 * 
Æa_fšd
(nlattr *, , );

89 
Æa_memıy
(*, 
Æ©Œ
 *, );

90 
size_t
 
Æa_¡¾ıy
(*, cÚ¡ 
Æ©Œ
 *, size_t);

91 
Æa_memcmp
(cÚ¡ 
Æ©Œ
 *, cÚ¡ *, 
size_t
);

92 
Æa_¡rcmp
(cÚ¡ 
Æ©Œ
 *, const *);

95 
Æ©Œ
 * 
Æa_»£rve
(
Æ_msg
 *, , );

96 
Æa_put
(
Æ_msg
 *, , , const *);

97 
Æa_put_d©a
(
Æ_msg
 *, , 
Æ_d©a
 *);

98 
Æa_put_addr
(
Æ_msg
 *, , 
Æ_addr
 *);

101 
ušt8_t
 
Æa_g‘_u8
(
Æ©Œ
 *);

102 
Æa_put_u8
(
Æ_msg
 *, , 
ušt8_t
);

103 
ušt16_t
 
Æa_g‘_u16
(
Æ©Œ
 *);

104 
Æa_put_u16
(
Æ_msg
 *, , 
ušt16_t
);

105 
ušt32_t
 
Æa_g‘_u32
(
Æ©Œ
 *);

106 
Æa_put_u32
(
Æ_msg
 *, , 
ušt32_t
);

107 
ušt64_t
 
Æa_g‘_u64
(
Æ©Œ
 *);

108 
Æa_put_u64
(
Æ_msg
 *, , 
ušt64_t
);

111 * 
Æa_g‘_¡ršg
(
Æ©Œ
 *);

112 * 
Æa_¡rdup
(
Æ©Œ
 *);

113 
Æa_put_¡ršg
(
Æ_msg
 *, , const *);

116 
Æa_g‘_æag
(
Æ©Œ
 *);

117 
Æa_put_æag
(
Æ_msg
 *, );

120 
Æa_g‘_m£cs
(
Æ©Œ
 *);

121 
Æa_put_m£cs
(
Æ_msg
 *, , );

124 
Æa_put_Ã¡ed
(
Æ_msg
 *, , nl_msg *);

125 
Æ©Œ
 * 
Æa_Ã¡_¡¬t
(
Æ_msg
 *, );

126 
Æa_Ã¡_’d
(
Æ_msg
 *, 
Æ©Œ
 *);

127 
Æa_Ã¡_ÿnûl
(
Æ_msg
 *, 
Æ©Œ
 *);

128 
Æa_·r£_Ã¡ed
(
Æ©Œ
 **, , nlattr *,

129 
Æa_pŞicy
 *);

130 
Æa_is_Ã¡ed
(
Æ©Œ
 *);

145 
	#NLA_PUT
(
msg
, 
©Œty³
, 
©ŒËn
, 
d©a
) \

147 ià(
	`Æa_put
(
msg
, 
©Œty³
, 
©ŒËn
, 
d©a
) < 0) \

148 
Æa_put_çu»
; \

149 } 0)

	)

159 
	#NLA_PUT_TYPE
(
msg
, 
ty³
, 
©Œty³
, 
v®ue
) \

161 
ty³
 
__tmp
 = 
v®ue
; \

162 
	`NLA_PUT
(
msg
, 
©Œty³
, (
ty³
), &
__tmp
); \

163 } 0)

	)

171 
	#NLA_PUT_U8
(
msg
, 
©Œty³
, 
v®ue
) \

172 
	`NLA_PUT_TYPE
(
msg
, 
ušt8_t
, 
©Œty³
, 
v®ue
)

	)

180 
	#NLA_PUT_U16
(
msg
, 
©Œty³
, 
v®ue
) \

181 
	`NLA_PUT_TYPE
(
msg
, 
ušt16_t
, 
©Œty³
, 
v®ue
)

	)

189 
	#NLA_PUT_U32
(
msg
, 
©Œty³
, 
v®ue
) \

190 
	`NLA_PUT_TYPE
(
msg
, 
ušt32_t
, 
©Œty³
, 
v®ue
)

	)

198 
	#NLA_PUT_U64
(
msg
, 
©Œty³
, 
v®ue
) \

199 
	`NLA_PUT_TYPE
(
msg
, 
ušt64_t
, 
©Œty³
, 
v®ue
)

	)

207 
	#NLA_PUT_STRING
(
msg
, 
©Œty³
, 
v®ue
) \

208 
	`NLA_PUT
(
msg
, 
©Œty³
, (è
	`¡¾’
(
v®ue
è+ 1, v®ue)

	)

215 
	#NLA_PUT_FLAG
(
msg
, 
©Œty³
) \

216 
	`NLA_PUT
(
msg
, 
©Œty³
, 0, 
NULL
)

	)

224 
	#NLA_PUT_MSECS
(
msg
, 
©Œty³
, 
m£cs
) \

225 
	`NLA_PUT_U64
(
msg
, 
©Œty³
, 
m£cs
)

	)

233 
	#NLA_PUT_ADDR
(
msg
, 
©Œty³
, 
addr
) \

234 
	`NLA_PUT
(
msg
, 
©Œty³
, 
	`Æ_addr_g‘_Ën
(
addr
), \

235 
	`Æ_addr_g‘_bš¬y_addr
(
addr
))

	)

243 
	#NLA_PUT_DATA
(
msg
, 
©Œty³
, 
d©a
) \

244 
	`NLA_PUT
(
msg
, 
©Œty³
, 
	`Æ_d©a_g‘_size
(
d©a
), \

245 
	`Æ_d©a_g‘
(
d©a
))

	)

262 
	#Æa_fÜ_—ch_©Œ
(
pos
, 
h—d
, 
Ën
, 
»m
) \

263 
pos
 = 
h—d
, 
»m
 = 
Ën
; \

264 
	`Æa_ok
(
pos
, 
»m
); \

265 
pos
 = 
	`Æa_Ãxt
Õos, &(
»m
)))

	)

274 
	#Æa_fÜ_—ch_Ã¡ed
(
pos
, 
Æa
, 
»m
) \

275 
pos
 = 
	`Æa_d©a
(
Æa
), 
»m
 = 
	`Æa_Ën
(nla); \

276 
	`Æa_ok
(
pos
, 
»m
); \

277 
pos
 = 
	`Æa_Ãxt
Õos, &(
»m
)))

	)

281 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/cache-api.h

12 #iâdeà
NETLINK_DUMMY_CACHE_API_H_


13 
	#NETLINK_DUMMY_CACHE_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

	@mylibnl/libnl-3.2.25/include/netlink/cache.h

12 #iâdeà
NETLINK_CACHE_H_


13 
	#NETLINK_CACHE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/msg.h
>

17 
	~<Ãšk/uts.h
>

18 
	~<Ãšk/objeù.h
>

20 #ifdeà
__ılu¥lus


25 
NL_ACT_UNSPEC
,

26 
NL_ACT_NEW
,

27 
NL_ACT_DEL
,

28 
NL_ACT_GET
,

29 
NL_ACT_SET
,

30 
NL_ACT_CHANGE
,

31 
__NL_ACT_MAX
,

34 
	#NL_ACT_MAX
 (
__NL_ACT_MAX
 - 1)

	)

36 
Æ_ÿche
;

37 (*
chªge_func_t
)(
	tÆ_ÿche
 *, 
	tÆ_objeù
 *, , *);

43 
	#NL_CACHE_AF_ITER
 0x0001

	)

46 
Æ_ÿche_n™ems
(
Æ_ÿche
 *);

47 
Æ_ÿche_n™ems_f‹r
(
Æ_ÿche
 *,

48 
Æ_objeù
 *);

49 
Æ_ÿche_İs
 * 
Æ_ÿche_g‘_İs
(
Æ_ÿche
 *);

50 
Æ_objeù
 * 
Æ_ÿche_g‘_fœ¡
(
Æ_ÿche
 *);

51 
Æ_objeù
 * 
Æ_ÿche_g‘_Ï¡
(
Æ_ÿche
 *);

52 
Æ_objeù
 * 
Æ_ÿche_g‘_Ãxt
(nl_object *);

53 
Æ_objeù
 * 
Æ_ÿche_g‘_´ev
(nl_object *);

55 
Æ_ÿche
 * 
Æ_ÿche_®loc
(
Æ_ÿche_İs
 *);

56 
Æ_ÿche_®loc_ªd_fl
(
Æ_ÿche_İs
 *,

57 
Æ_sock
 *,

58 
Æ_ÿche
 **);

59 
Æ_ÿche_®loc_Çme
(const *,

60 
Æ_ÿche
 **);

61 
Æ_ÿche
 * 
Æ_ÿche_sub£t
(nl_cache *,

62 
Æ_objeù
 *);

63 
Æ_ÿche
 * 
Æ_ÿche_şÚe
(nl_cache *);

64 
Æ_ÿche_ş—r
(
Æ_ÿche
 *);

65 
Æ_ÿche_g‘
(
Æ_ÿche
 *);

66 
Æ_ÿche_ä“
(
Æ_ÿche
 *);

67 
Æ_ÿche_put
(
Æ_ÿche
 *
ÿche
);

70 
Æ_ÿche_add
(
Æ_ÿche
 *,

71 
Æ_objeù
 *);

72 
Æ_ÿche_·r£_ªd_add
(
Æ_ÿche
 *,

73 
Æ_msg
 *);

74 
Æ_ÿche_move
(
Æ_ÿche
 *,

75 
Æ_objeù
 *);

76 
Æ_ÿche_»move
(
Æ_objeù
 *);

77 
Æ_ÿche_»fl
(
Æ_sock
 *,

78 
Æ_ÿche
 *);

79 
Æ_ÿche_pickup
(
Æ_sock
 *,

80 
Æ_ÿche
 *);

81 
Æ_ÿche_»sync
(
Æ_sock
 *,

82 
Æ_ÿche
 *,

83 
chªge_func_t
,

85 
Æ_ÿche_šşude
(
Æ_ÿche
 *,

86 
Æ_objeù
 *,

87 
chªge_func_t
,

89 
Æ_ÿche_£t_¬g1
(
Æ_ÿche
 *, );

90 
Æ_ÿche_£t_¬g2
(
Æ_ÿche
 *, );

91 
Æ_ÿche_£t_æags
(
Æ_ÿche
 *, );

94 
Æ_ÿche_is_em±y
(
Æ_ÿche
 *);

95 
Æ_objeù
 * 
Æ_ÿche_£¬ch
(
Æ_ÿche
 *,

96 
Æ_objeù
 *);

97 
Æ_objeù
 *
Æ_ÿche_fšd
(
Æ_ÿche
 *,

98 
Æ_objeù
 *);

99 
Æ_ÿche_m¬k_®l
(
Æ_ÿche
 *);

102 
Æ_ÿche_dump
(
Æ_ÿche
 *,

103 
Æ_dump_·¿ms
 *);

104 
Æ_ÿche_dump_f‹r
(
Æ_ÿche
 *,

105 
Æ_dump_·¿ms
 *,

106 
Æ_objeù
 *);

109 
Æ_ÿche_fÜ—ch
(
Æ_ÿche
 *,

110 (*
cb
)(
Æ_objeù
 *,

112 *
¬g
);

113 
Æ_ÿche_fÜ—ch_f‹r
(
Æ_ÿche
 *,

114 
Æ_objeù
 *,

115 (*
cb
)(

116 
Æ_objeù
 *,

118 *
¬g
);

123 
Æ_ÿche_İs
 * 
Æ_ÿche_İs_lookup
(const *);

124 
Æ_ÿche_İs
 * 
Æ_ÿche_İs_lookup_§ã
(const *);

125 
Æ_ÿche_İs
 * 
Æ_ÿche_İs_assocŸ‹
(, );

126 
Æ_ÿche_İs
 * 
Æ_ÿche_İs_assocŸ‹_§ã
(, );

127 
Æ_msgty³
 * 
Æ_msgty³_lookup
(
Æ_ÿche_İs
 *, );

128 
Æ_ÿche_İs_fÜ—ch
((*
cb
)(
Æ_ÿche_İs
 *, *), *);

129 
Æ_ÿche_mngt_»gi¡”
(
Æ_ÿche_İs
 *);

130 
Æ_ÿche_mngt_uÄegi¡”
(
Æ_ÿche_İs
 *);

133 
Æ_ÿche_mngt_´ovide
(
Æ_ÿche
 *);

134 
Æ_ÿche_mngt_uÅrovide
(
Æ_ÿche
 *);

135 
Æ_ÿche
 * 
Æ_ÿche_mngt_»quœe
(const *);

136 
Æ_ÿche
 * 
Æ_ÿche_mngt_»quœe_§ã
(const *);

137 
Æ_ÿche
 * 
__Æ_ÿche_mngt_»quœe
(const *);

139 
	gÆ_ÿche_mngr
;

141 
	#NL_AUTO_PROVIDE
 1

	)

142 
	#NL_ALLOCATED_SOCK
 2

	)

144 
Æ_ÿche_mngr_®loc
(
Æ_sock
 *,

146 
Æ_ÿche_mngr
 **);

147 
Æ_ÿche_mngr_add
(
Æ_ÿche_mngr
 *,

149 
chªge_func_t
,

151 
Æ_ÿche
 **);

152 
Æ_ÿche_mngr_add_ÿche
(
Æ_ÿche_mngr
 *
mngr
,

153 
Æ_ÿche
 *
ÿche
,

154 
chªge_func_t
 
cb
, *
d©a
);

155 
Æ_ÿche_mngr_g‘_fd
(
Æ_ÿche_mngr
 *);

156 
Æ_ÿche_mngr_pŞl
(
Æ_ÿche_mngr
 *,

158 
Æ_ÿche_mngr_d©a_»ady
(
Æ_ÿche_mngr
 *);

159 
Æ_ÿche_mngr_šfo
(
Æ_ÿche_mngr
 *,

160 
Æ_dump_·¿ms
 *);

161 
Æ_ÿche_mngr_ä“
(
Æ_ÿche_mngr
 *);

163 
Æ_ÿche_İs_g‘
(
Æ_ÿche_İs
 *);

164 
Æ_ÿche_İs_put
(
Æ_ÿche_İs
 *);

166 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/cli/addr.h

12 #iâdeà
__NETLINK_CLI_ADDR_H_


13 
	#__NETLINK_CLI_ADDR_H_


	)

15 
	~<Ãšk/rou‹/addr.h
>

17 
	#Æ_şi_addr_®loc_ÿche
(
sk
) \

18 
	`Æ_şi_®loc_ÿche
((
sk
), "add»ss", 
¹Æ_addr_®loc_ÿche
)

	)

20 
¹Æ_addr
 *
Æ_şi_addr_®loc
();

22 
Æ_şi_addr_·r£_çmy
(
¹Æ_addr
 *, *);

23 
Æ_şi_addr_·r£_loÿl
(
¹Æ_addr
 *, *);

24 
Æ_şi_addr_·r£_dev
(
¹Æ_addr
 *, 
Æ_ÿche
 *,*);

25 
Æ_şi_addr_·r£_Ïb–
(
¹Æ_addr
 *, *);

26 
Æ_şi_addr_·r£_³”
(
¹Æ_addr
 *, *);

27 
Æ_şi_addr_·r£_scİe
(
¹Æ_addr
 *, *);

28 
Æ_şi_addr_·r£_brßdÿ¡
(
¹Æ_addr
 *, *);

29 
Æ_şi_addr_·r£_´eã¼ed
(
¹Æ_addr
 *, *);

30 
Æ_şi_addr_·r£_v®id
(
¹Æ_addr
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/class.h

12 #iâdeà
__NETLINK_CLI_CLASS_H_


13 
	#__NETLINK_CLI_CLASS_H_


	)

15 
	~<Ãšk/rou‹/şass.h
>

16 
	~<Ãšk/şi/tc.h
>

18 
¹Æ_şass
 *
Æ_şi_şass_®loc
();

19 
Æ_ÿche
 *
Æ_şi_şass_®loc_ÿche
(
Æ_sock
 *, );

	@mylibnl/libnl-3.2.25/include/netlink/cli/cls.h

12 #iâdeà
__NETLINK_CLI_CLS_H_


13 
	#__NETLINK_CLI_CLS_H_


	)

15 
	~<Ãšk/rou‹/şassif›r.h
>

16 
	~<Ãšk/şi/tc.h
>

18 
¹Æ_şs
 * 
Æ_şi_şs_®loc
();

19 
Æ_ÿche
 * 
Æ_şi_şs_®loc_ÿche
(
Æ_sock
 *,

20 , 
ušt32_t
);

21 
Æ_şi_şs_·r£_´Ùo
(
¹Æ_şs
 *, *);

22 
¹Æ_em©ch_Œ“
 *
Æ_şi_şs_·r£_em©ch
(
¹Æ_şs
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/ct.h

12 #iâdeà
__NETLINK_CLI_CT_H_


13 
	#__NETLINK_CLI_CT_H_


	)

15 
	~<Ãšk/Ãtf‹r/ù.h
>

16 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_commÚ.h
>

18 
nâl_ù
 *
Æ_şi_ù_®loc
();

19 
Æ_ÿche
 *
Æ_şi_ù_®loc_ÿche
(
Æ_sock
 *);

21 
Æ_şi_ù_·r£_çmy
(
nâl_ù
 *, *);

22 
Æ_şi_ù_·r£_´ÙocŞ
(
nâl_ù
 *, *);

23 
Æ_şi_ù_·r£_m¬k
(
nâl_ù
 *, *);

24 
Æ_şi_ù_·r£_timeout
(
nâl_ù
 *, *);

25 
Æ_şi_ù_·r£_id
(
nâl_ù
 *, *);

26 
Æ_şi_ù_·r£_u£
(
nâl_ù
 *, *);

27 
Æ_şi_ù_·r£_¤c
(
nâl_ù
 *, , *);

28 
Æ_şi_ù_·r£_d¡
(
nâl_ù
 *, , *);

29 
Æ_şi_ù_·r£_¤c_pÜt
(
nâl_ù
 *, , *);

30 
Æ_şi_ù_·r£_d¡_pÜt
(
nâl_ù
 *, , *);

31 
Æ_şi_ù_·r£_tı_¡©e
(
nâl_ù
 *, *);

32 
Æ_şi_ù_·r£_¡©us
(
nâl_ù
 *, *);

33 
Æ_şi_ù_·r£_zÚe
(
nâl_ù
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/exp.h

13 #iâdeà
__NETLINK_CLI_EXP_H_


14 
	#__NETLINK_CLI_EXP_H_


	)

16 
	~<Ãšk/Ãtf‹r/exp.h
>

17 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_commÚ.h
>

19 
nâl_exp
 *
Æ_şi_exp_®loc
();

20 
Æ_ÿche
 *
Æ_şi_exp_®loc_ÿche
(
Æ_sock
 *);

22 
Æ_şi_exp_·r£_çmy
(
nâl_exp
 *, *);

23 
Æ_şi_exp_·r£_timeout
(
nâl_exp
 *, *);

24 
Æ_şi_exp_·r£_id
(
nâl_exp
 *, *);

25 
Æ_şi_exp_·r£_h–³r_Çme
(
nâl_exp
 *, *);

26 
Æ_şi_exp_·r£_zÚe
(
nâl_exp
 *, *);

27 
Æ_şi_exp_·r£_æags
(
nâl_exp
 *, *);

28 
Æ_şi_exp_·r£_şass
(
nâl_exp
 *, *);

29 
Æ_şi_exp_·r£_Çt_dœ
(
nâl_exp
 *, *);

30 
Æ_şi_exp_·r£_â
(
nâl_exp
 *, *);

32 
Æ_şi_exp_·r£_¤c
(
nâl_exp
 *, , *);

33 
Æ_şi_exp_·r£_d¡
(
nâl_exp
 *, , *);

34 
Æ_şi_exp_·r£_l4´ÙÚum
(
nâl_exp
 *, , *);

35 
Æ_şi_exp_·r£_¤c_pÜt
(
nâl_exp
 *, , *);

36 
Æ_şi_exp_·r£_d¡_pÜt
(
nâl_exp
 *, , *);

37 
Æ_şi_exp_·r£_icmp_id
(
nâl_exp
 *, , *);

38 
Æ_şi_exp_·r£_icmp_ty³
(
nâl_exp
 *, , *);

39 
Æ_şi_exp_·r£_icmp_code
(
nâl_exp
 *, , *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/link.h

12 #iâdeà
__NETLINK_CLI_LINK_H_


13 
	#__NETLINK_CLI_LINK_H_


	)

15 
	~<Ãšk/rou‹/lšk.h
>

16 
	~<Ãšk/şi/uts.h
>

18 
¹Æ_lšk
 *
Æ_şi_lšk_®loc
();

19 
Æ_ÿche
 *
Æ_şi_lšk_®loc_ÿche_çmy
(
Æ_sock
 *, );

20 
Æ_ÿche
 *
Æ_şi_lšk_®loc_ÿche
(
Æ_sock
 *);

22 
Æ_şi_lšk_·r£_çmy
(
¹Æ_lšk
 *, *);

23 
Æ_şi_lšk_·r£_Çme
(
¹Æ_lšk
 *, *);

24 
Æ_şi_lšk_·r£_mtu
(
¹Æ_lšk
 *, *);

25 
Æ_şi_lšk_·r£_ifšdex
(
¹Æ_lšk
 *, *);

26 
Æ_şi_lšk_·r£_txqËn
(
¹Æ_lšk
 *, *);

27 
Æ_şi_lšk_·r£_weight
(
¹Æ_lšk
 *, *);

28 
Æ_şi_lšk_·r£_içlŸs
(
¹Æ_lšk
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/neigh.h

12 #iâdeà
__NETLINK_CLI_NEIGH_H_


13 
	#__NETLINK_CLI_NEIGH_H_


	)

15 
	~<Ãšk/rou‹/Ãighbour.h
>

17 
	#Æ_şi_Ãigh_®loc_ÿche
(
sk
) \

18 
	`Æ_şi_®loc_ÿche
((
sk
), "Ãighbour", 
¹Æ_Ãigh_®loc_ÿche
)

	)

20 
¹Æ_Ãigh
 *
Æ_şi_Ãigh_®loc
();

21 
Æ_şi_Ãigh_·r£_d¡
(
¹Æ_Ãigh
 *, *);

22 
Æ_şi_Ãigh_·r£_Îaddr
(
¹Æ_Ãigh
 *, *);

23 
Æ_şi_Ãigh_·r£_dev
(
¹Æ_Ãigh
 *, 
Æ_ÿche
 *, *);

24 
Æ_şi_Ãigh_·r£_çmy
(
¹Æ_Ãigh
 *, *);

25 
Æ_şi_Ãigh_·r£_¡©e
(
¹Æ_Ãigh
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/qdisc.h

12 #iâdeà
__NETLINK_CLI_QDISC_H_


13 
	#__NETLINK_CLI_QDISC_H_


	)

15 
	~<Ãšk/rou‹/qdisc.h
>

17 
	#Æ_şi_qdisc_®loc_ÿche
(
sk
) \

18 
	`Æ_şi_®loc_ÿche
((
sk
), "queueing disciplines", \

19 
¹Æ_qdisc_®loc_ÿche
)

	)

21 
¹Æ_qdisc
 *
Æ_şi_qdisc_®loc
();

	@mylibnl/libnl-3.2.25/include/netlink/cli/route.h

12 #iâdeà
__NETLINK_CLI_ROUTE_H_


13 
	#__NETLINK_CLI_ROUTE_H_


	)

15 
	~<Ãšk/rou‹/rou‹.h
>

17 
¹Æ_rou‹
 *
Æ_şi_rou‹_®loc
();

19 
Æ_ÿche
 *
Æ_şi_rou‹_®loc_ÿche
(
Æ_sock
 *, );

21 
Æ_şi_rou‹_·r£_çmy
(
¹Æ_rou‹
 *, *);

22 
Æ_şi_rou‹_·r£_d¡
(
¹Æ_rou‹
 *, *);

23 
Æ_şi_rou‹_·r£_¤c
(
¹Æ_rou‹
 *, *);

24 
Æ_şi_rou‹_·r£_´ef_¤c
(
¹Æ_rou‹
 *, *);

25 
Æ_şi_rou‹_·r£_m‘ric
(
¹Æ_rou‹
 *, *);

26 
Æ_şi_rou‹_·r£_Ãxthİ
(
¹Æ_rou‹
 *, *, 
Æ_ÿche
 *);

27 
Æ_şi_rou‹_·r£_bË
(
¹Æ_rou‹
 *, *);

28 
Æ_şi_rou‹_·r£_´io
(
¹Æ_rou‹
 *, *);

29 
Æ_şi_rou‹_·r£_scİe
(
¹Æ_rou‹
 *, *);

30 
Æ_şi_rou‹_·r£_´ÙocŞ
(
¹Æ_rou‹
 *, *);

31 
Æ_şi_rou‹_·r£_ty³
(
¹Æ_rou‹
 *, *);

32 
Æ_şi_rou‹_·r£_iif
(
¹Æ_rou‹
 *, *, 
Æ_ÿche
 *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/rule.h

12 #iâdeà
__NETLINK_CLI_RULE_H_


13 
	#__NETLINK_CLI_RULE_H_


	)

15 
	~<Ãšk/rou‹/ruË.h
>

17 
¹Æ_ruË
 *
Æ_şi_ruË_®loc
();

18 
Æ_ÿche
 *
Æ_şi_ruË_®loc_ÿche
(
Æ_sock
 *);

19 
Æ_şi_ruË_·r£_çmy
(
¹Æ_ruË
 *, *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/tc.h

12 #iâdeà
__NETLINK_CLI_TC_H_


13 
	#__NETLINK_CLI_TC_H_


	)

15 
	~<Ãšk/rou‹/tc.h
>

17 
	g¹Æ_tc_İs
;

19 
Æ_şi_tc_·r£_dev
(
¹Æ_tc
 *, 
Æ_ÿche
 *, *);

20 
Æ_şi_tc_·r£_·»Á
(
¹Æ_tc
 *, *);

21 
Æ_şi_tc_·r£_hªdË
(
¹Æ_tc
 *, *, );

22 
Æ_şi_tc_·r£_mtu
(
¹Æ_tc
 *, *);

23 
Æ_şi_tc_·r£_mpu
(
¹Æ_tc
 *, *);

24 
Æ_şi_tc_·r£_ov”h—d
(
¹Æ_tc
 *, *);

25 
Æ_şi_tc_·r£_lškty³
(
¹Æ_tc
 *, *);

26 
Æ_şi_tc_·r£_kšd
(
¹Æ_tc
 *, *);

28 
	sÆ_şi_tc_moduË


30 cÚ¡ * 
	mtm_Çme
;

31 
¹Æ_tc_ty³
 
	mtm_ty³
;

32 
¹Æ_tc_İs
 * 
	mtm_İs
;

33 (*
	mtm_·r£_¬gv
)(
	m¹Æ_tc
 *, , **);

34 
Æ_li¡_h—d
 
	mtm_li¡
;

37 
Æ_şi_tc_moduË
 *
Æ_şi_tc_lookup
(
¹Æ_tc_İs
 *);

38 
Æ_şi_tc_»gi¡”
(
Æ_şi_tc_moduË
 *);

39 
Æ_şi_tc_uÄegi¡”
(
Æ_şi_tc_moduË
 *);

	@mylibnl/libnl-3.2.25/include/netlink/cli/utils.h

12 #iâdeà
__NETLINK_CLI_UTILS_H_


13 
	#__NETLINK_CLI_UTILS_H_


	)

15 
	~<¡dio.h
>

16 
	~<¡ršg.h
>

17 
	~<¡dlib.h
>

18 
	~<¡d¬g.h
>

19 
	~<lim™s.h
>

20 
	~<š‰y³s.h
>

21 
	~<”ºo.h
>

22 
	~<¡dšt.h
>

23 
	~<ùy³.h
>

24 
	~<g‘İt.h
>

25 
	~<dlfú.h
>

26 
	~<sys/ty³s.h
>

27 
	~<sys/sock‘.h
>

29 
	~<Ãšk/Ãšk.h
>

30 
	~<Ãšk/uts.h
>

31 
	~<Ãšk/addr.h
>

32 
	~<Ãšk/li¡.h
>

33 
	~<Ãšk/rou‹/¹Æ.h
>

34 
	~<Ãšk/rou‹/lšk.h
>

35 
	~<Ãšk/rou‹/addr.h
>

36 
	~<Ãšk/rou‹/Ãighbour.h
>

37 
	~<Ãšk/rou‹/Ãightbl.h
>

38 
	~<Ãšk/rou‹/rou‹.h
>

39 
	~<Ãšk/rou‹/ruË.h
>

40 
	~<Ãšk/rou‹/qdisc.h
>

41 
	~<Ãšk/rou‹/şass.h
>

42 
	~<Ãšk/rou‹/şassif›r.h
>

43 
	~<Ãšk/rou‹/şs/em©ch.h
>

44 
	~<Ãšk/fib_lookup/lookup.h
>

45 
	~<Ãšk/fib_lookup/»que¡.h
>

46 
	~<Ãšk/g’l/g’l.h
>

47 
	~<Ãšk/g’l/ù¾.h
>

48 
	~<Ãšk/g’l/mngt.h
>

49 
	~<Ãšk/Ãtf‹r/ù.h
>

51 #ifdeà
__ılu¥lus


55 #iâdeà
__š™


56 
	#__š™
 
	`__©Œibu‹__
((
cÚ¡ruùÜ
))

	)

59 #iâdeà
__ex™


60 
	#__ex™
 
	`__©Œibu‹__
((
de¡ruùÜ
))

	)

63 
ušt32_t
 
Æ_şi_·r£_u32
(const *);

64 
Æ_şi_´št_v”siÚ
();

65 
Æ_şi_çl
(, const *, ...);

66 
Æ_addr
 * 
Æ_şi_addr_·r£
(const *, );

67 
Æ_şi_cÚÃù
(
Æ_sock
 *, );

68 
Æ_sock
 * 
Æ_şi_®loc_sock‘
();

69 
Æ_şi_·r£_dum±y³
(const *);

70 
Æ_şi_cÚfœm
(
Æ_objeù
 *,

71 
Æ_dump_·¿ms
 *, );

73 
Æ_ÿche
 *
Æ_şi_®loc_ÿche
(
Æ_sock
 *, const *,

74 (*
ac
)(
Æ_sock
 *, 
Æ_ÿche
 **));

76 
Æ_şi_lßd_moduË
(const *, const *);

78 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/data.h

12 #iâdeà
NETLINK_DATA_H_


13 
	#NETLINK_DATA_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_d©a
;

24 
Æ_d©a
 * 
Æ_d©a_®loc
(*, 
size_t
);

25 
Æ_d©a
 * 
Æ_d©a_®loc_©Œ
(
Æ©Œ
 *);

26 
Æ_d©a
 * 
Æ_d©a_şÚe
(nl_data *);

27 
Æ_d©a_­³nd
(
Æ_d©a
 *, *, 
size_t
);

28 
Æ_d©a_ä“
(
Æ_d©a
 *);

31 * 
Æ_d©a_g‘
(
Æ_d©a
 *);

32 
size_t
 
Æ_d©a_g‘_size
(
Æ_d©a
 *);

35 
Æ_d©a_cmp
(
Æ_d©a
 *, nl_data *);

37 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/errno.h

12 #iâdeà
NETLINK_ERRNO_H_


13 
	#NETLINK_ERRNO_H_


	)

15 #ifdeà
__ılu¥lus


19 
	#NLE_SUCCESS
 0

	)

20 
	#NLE_FAILURE
 1

	)

21 
	#NLE_INTR
 2

	)

22 
	#NLE_BAD_SOCK
 3

	)

23 
	#NLE_AGAIN
 4

	)

24 
	#NLE_NOMEM
 5

	)

25 
	#NLE_EXIST
 6

	)

26 
	#NLE_INVAL
 7

	)

27 
	#NLE_RANGE
 8

	)

28 
	#NLE_MSGSIZE
 9

	)

29 
	#NLE_OPNOTSUPP
 10

	)

30 
	#NLE_AF_NOSUPPORT
 11

	)

31 
	#NLE_OBJ_NOTFOUND
 12

	)

32 
	#NLE_NOATTR
 13

	)

33 
	#NLE_MISSING_ATTR
 14

	)

34 
	#NLE_AF_MISMATCH
 15

	)

35 
	#NLE_SEQ_MISMATCH
 16

	)

36 
	#NLE_MSG_OVERFLOW
 17

	)

37 
	#NLE_MSG_TRUNC
 18

	)

38 
	#NLE_NOADDR
 19

	)

39 
	#NLE_SRCRT_NOSUPPORT
 20

	)

40 
	#NLE_MSG_TOOSHORT
 21

	)

41 
	#NLE_MSGTYPE_NOSUPPORT
 22

	)

42 
	#NLE_OBJ_MISMATCH
 23

	)

43 
	#NLE_NOCACHE
 24

	)

44 
	#NLE_BUSY
 25

	)

45 
	#NLE_PROTO_MISMATCH
 26

	)

46 
	#NLE_NOACCESS
 27

	)

47 
	#NLE_PERM
 28

	)

48 
	#NLE_PKTLOC_FILE
 29

	)

49 
	#NLE_PARSE_ERR
 30

	)

50 
	#NLE_NODEV
 31

	)

51 
	#NLE_IMMUTABLE
 32

	)

52 
	#NLE_DUMP_INTR
 33

	)

54 
	#NLE_MAX
 
NLE_DUMP_INTR


	)

56 cÚ¡ * 
Æ_g‘”rÜ
();

57 
Æ_³¼Ü
(, const *);

58 
Æ_sy£¼2Æ”r
();

60 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/fib_lookup/lookup.h

12 #iâdeà
NETLINK_FIB_LOOKUP_H_


13 
	#NETLINK_FIB_LOOKUP_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

18 
	~<Ãšk/fib_lookup/»que¡.h
>

20 #ifdeà
__ılu¥lus


24 
æÆ_»suÉ
;

26 
æÆ_»suÉ
 * 
æÆ_»suÉ_®loc
();

27 
æÆ_»suÉ_put
(
æÆ_»suÉ
 *);

29 
Æ_ÿche
 * 
æÆ_»suÉ_®loc_ÿche
();

31 
æÆ_lookup_bud_»que¡
(
æÆ_»que¡
 *,

33 
Æ_msg
 **);

34 
æÆ_lookup
(
Æ_sock
 *,

35 
æÆ_»que¡
 *,

36 
Æ_ÿche
 *);

38 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/fib_lookup/request.h

12 #iâdeà
NETLINK_FIB_LOOKUP_REQUEST_H_


13 
	#NETLINK_FIB_LOOKUP_REQUEST_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/addr.h
>

18 #ifdeà
__ılu¥lus


22 
æÆ_»que¡
;

24 
	#REQUEST_CAST
(
±r
è((
æÆ_»que¡
 *èÕŒ))

	)

26 
æÆ_»que¡
 * 
æÆ_»que¡_®loc
();

28 
æÆ_»que¡_£t_fwm¬k
(
æÆ_»que¡
 *,

29 
ušt64_t
);

30 
ušt64_t
 
æÆ_»que¡_g‘_fwm¬k
(
æÆ_»que¡
 *);

31 
æÆ_»que¡_£t_tos
(
æÆ_»que¡
 *,

33 
æÆ_»que¡_g‘_tos
(
æÆ_»que¡
 *);

34 
æÆ_»que¡_£t_scİe
(
æÆ_»que¡
 *,

36 
æÆ_»que¡_g‘_scİe
(
æÆ_»que¡
 *);

37 
æÆ_»que¡_£t_bË
(
æÆ_»que¡
 *,

39 
æÆ_»que¡_g‘_bË
(
æÆ_»que¡
 *);

40 
æÆ_»que¡_£t_addr
(
æÆ_»que¡
 *,

41 
Æ_addr
 *);

42 
Æ_addr
 * 
æÆ_»que¡_g‘_addr
(
æÆ_»que¡
 *);

44 
æÆ_»que¡_cmp
(
æÆ_»que¡
 *,

45 
æÆ_»que¡
 *);

47 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/genl/ctrl.h

12 #iâdeà
NETLINK_GENL_CTRL_H_


13 
	#NETLINK_GENL_CTRL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

19 #ifdeà
__ılu¥lus


23 
g’l_çmy
;

25 
g’l_ù¾_®loc_ÿche
(
Æ_sock
 *,

26 
Æ_ÿche
 **);

27 
g’l_çmy
 * 
g’l_ù¾_£¬ch
(
Æ_ÿche
 *, );

28 
g’l_çmy
 * 
g’l_ù¾_£¬ch_by_Çme
(
Æ_ÿche
 *,

30 
g’l_ù¾_»sŞve
(
Æ_sock
 *,

32 
g’l_ù¾_»sŞve_g½
(
Æ_sock
 *
sk
,

33 cÚ¡ *
çmy
,

34 cÚ¡ *
g½
);

36 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/genl/family.h

12 #iâdeà
NETLINK_GENL_FAMILY_H_


13 
	#NETLINK_GENL_FAMILY_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

18 #ifdeà
__ılu¥lus


22 
g’l_çmy
;

24 
g’l_çmy
 * 
g’l_çmy_®loc
();

25 
g’l_çmy_put
(
g’l_çmy
 *);

27 
g’l_çmy_g‘_id
(
g’l_çmy
 *);

28 
g’l_çmy_£t_id
(
g’l_çmy
 *, );

29 * 
g’l_çmy_g‘_Çme
(
g’l_çmy
 *);

30 
g’l_çmy_£t_Çme
(
g’l_çmy
 *, const *);

31 
ušt8_t
 
g’l_çmy_g‘_v”siÚ
(
g’l_çmy
 *);

32 
g’l_çmy_£t_v”siÚ
(
g’l_çmy
 *, 
ušt8_t
);

33 
ušt32_t
 
g’l_çmy_g‘_hdrsize
(
g’l_çmy
 *);

34 
g’l_çmy_£t_hdrsize
(
g’l_çmy
 *, 
ušt32_t
);

35 
ušt32_t
 
g’l_çmy_g‘_max©Œ
(
g’l_çmy
 *);

36 
g’l_çmy_£t_max©Œ
(
g’l_çmy
 *, 
ušt32_t
);

38 
g’l_çmy_add_İ
(
g’l_çmy
 *, , );

39 
g’l_çmy_add_g½
(
g’l_çmy
 *, 
ušt32_t
 ,

43 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/genl/genl.h

12 #iâdeà
NETLINK_GENL_H_


13 
	#NETLINK_GENL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/msg.h
>

17 
	~<Ãšk/©Œ.h
>

19 #ifdeà
__ılu¥lus


23 
g’l_cÚÃù
(
Æ_sock
 *);

24 
g’l_£nd_sim¶e
(
Æ_sock
 *, , ,

27 * 
g’lmsg_put
(
Æ_msg
 *, 
ušt32_t
, uint32_t,

28 , , , 
ušt8_t
, uint8_t);

30 
g’lmsg_v®id_hdr
(
Æmsghdr
 *, );

31 
g’lmsg_v®id©e
(
Æmsghdr
 *, , ,

32 
Æa_pŞicy
 *);

33 
g’lmsg_·r£
(
Æmsghdr
 *, , 
Æ©Œ
 **,

34 , 
Æa_pŞicy
 *);

35 
g’lmsghdr
 *

36 
g’lmsg_hdr
(
Æmsghdr
 *);

37 * 
g’lmsg_d©a
(cÚ¡ 
g’lmsghdr
 *);

38 * 
g’lmsg_u£r_hdr
(cÚ¡ 
g’lmsghdr
 *);

39 * 
g’lmsg_u£r_d©a
(cÚ¡ 
g’lmsghdr
 *, const );

40 
g’lmsg_u£r_d©®’
(cÚ¡ 
g’lmsghdr
 *,

42 
g’lmsg_Ën
(cÚ¡ 
g’lmsghdr
 *);

43 
Æ©Œ
 * 
g’lmsg_©Œd©a
(cÚ¡ 
g’lmsghdr
 *, );

44 
g’lmsg_©ŒËn
(cÚ¡ 
g’lmsghdr
 *, );

46 * 
g’l_İ2Çme
(, , *, 
size_t
);

48 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/genl/mngt.h

12 #iâdeà
NETLINK_GENL_MNGT_H_


13 
	#NETLINK_GENL_MNGT_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/©Œ.h
>

17 
	~<Ãšk/li¡.h
>

19 #ifdeà
__ılu¥lus


23 
Æ_ÿche_İs
;

37 
	sg’l_šfo


40 
sockaddr_Æ
 * 
who
;

43 
Æmsghdr
 * 
Æh
;

46 
g’lmsghdr
 * 
g’lhdr
;

49 * 
u£rhdr
;

52 
Æ©Œ
 ** 
©Œs
;

87 
	sg’l_cmd


90 
c_id
;

93 * 
c_Çme
;

96 
c_max©Œ
;

99 (*
c_msg_·r£r
)(
Æ_ÿche_İs
 *,

100 
g’l_cmd
 *,

101 
g’l_šfo
 *, *);

104 
Æa_pŞicy
 * 
c_©Œ_pŞicy
;

132 
	sg’l_İs


135 
o_hdrsize
;

138 
o_id
;

141 * 
o_Çme
;

147 
Æ_ÿche_İs
 * 
o_ÿche_İs
;

150 
g’l_cmd
 * 
o_cmds
;

153 
o_ncmds
;

159 
Æ_li¡_h—d
 
o_li¡
;

162 
g’l_»gi¡”_çmy
(
g’l_İs
 *);

163 
g’l_uÄegi¡”_çmy
(
g’l_İs
 *);

164 
g’l_hªdË_msg
(
Æ_msg
 *, *);

166 
g’l_»gi¡”
(
Æ_ÿche_İs
 *);

167 
g’l_uÄegi¡”
(
Æ_ÿche_İs
 *);

169 
g’l_İs_»sŞve
(
Æ_sock
 *, 
g’l_İs
 *);

170 
g’l_mngt_»sŞve
(
Æ_sock
 *);

172 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/handlers.h

12 #iâdeà
NETLINK_HANDLERS_H_


13 
	#NETLINK_HANDLERS_H_


	)

15 
	~<¡dio.h
>

16 
	~<¡dšt.h
>

17 
	~<sys/ty³s.h
>

18 
	~<Ãšk/Ãšk-com·t.h
>

19 
	~<Ãšk/Ãšk-k”Ãl.h
>

21 #ifdeà
__ılu¥lus


25 
Æ_cb
;

26 
Æ_sock
;

27 
Æ_msg
;

28 
uüed
;

41 (*
Æ_»cvmsg_msg_cb_t
)(
	tÆ_msg
 *
	tmsg
, *
	t¬g
);

50 (*
Æ_»cvmsg_”r_cb_t
)(
	tsockaddr_Æ
 *
	tÆa
,

51 
	tÆmsg”r
 *
	tÆ”r
, *
	t¬g
);

59 
	eÆ_cb_aùiÚ
 {

61 
NL_OK
,

63 
NL_SKIP
,

65 
NL_STOP
,

72 
	eÆ_cb_kšd
 {

74 
NL_CB_DEFAULT
,

76 
NL_CB_VERBOSE
,

78 
NL_CB_DEBUG
,

80 
NL_CB_CUSTOM
,

81 
__NL_CB_KIND_MAX
,

84 
	#NL_CB_KIND_MAX
 (
__NL_CB_KIND_MAX
 - 1)

	)

90 
	eÆ_cb_ty³
 {

92 
NL_CB_VALID
,

94 
NL_CB_FINISH
,

96 
NL_CB_OVERRUN
,

98 
NL_CB_SKIPPED
,

100 
NL_CB_ACK
,

102 
NL_CB_MSG_IN
,

104 
NL_CB_MSG_OUT
,

106 
NL_CB_INVALID
,

108 
NL_CB_SEQ_CHECK
,

110 
NL_CB_SEND_ACK
,

112 
NL_CB_DUMP_INTR
,

113 
__NL_CB_TYPE_MAX
,

116 
	#NL_CB_TYPE_MAX
 (
__NL_CB_TYPE_MAX
 - 1)

	)

118 
Æ_cb
 * 
Æ_cb_®loc
(
Æ_cb_kšd
);

119 
Æ_cb
 * 
Æ_cb_şÚe
(nl_cb *);

120 
Æ_cb
 * 
Æ_cb_g‘
(nl_cb *);

121 
Æ_cb_put
(
Æ_cb
 *);

123 
Æ_cb_£t
(
Æ_cb
 *, 
Æ_cb_ty³
, 
Æ_cb_kšd
,

124 
Æ_»cvmsg_msg_cb_t
, *);

125 
Æ_cb_£t_®l
(
Æ_cb
 *, 
Æ_cb_kšd
,

126 
Æ_»cvmsg_msg_cb_t
, *);

127 
Æ_cb_”r
(
Æ_cb
 *, 
Æ_cb_kšd
, 
Æ_»cvmsg_”r_cb_t
,

130 
Æ_cb_ov”wr™e_»cvmsgs
(
Æ_cb
 *,

131 (*
func
)(
Æ_sock
 *,

132 
Æ_cb
 *));

133 
Æ_cb_ov”wr™e_»cv
(
Æ_cb
 *,

134 (*
func
)(
Æ_sock
 *,

135 
sockaddr_Æ
 *,

137 
uüed
 **));

138 
Æ_cb_ov”wr™e_£nd
(
Æ_cb
 *,

139 (*
func
)(
Æ_sock
 *,

140 
Æ_msg
 *));

142 
Æ_cb_ty³
 
Æ_cb_aùive_ty³
(
Æ_cb
 *
cb
);

144 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/hash.h

6 #iâdeà
CCAN_HASH_H


7 
	#CCAN_HASH_H


	)

8 
	~<¡dšt.h
>

9 
	~<¡dlib.h
>

10 
	~<’dŸn.h
>

17 #ifdeà
__LITTLE_ENDIAN


18 
	#HAVE_LITTLE_ENDIAN
 1

	)

19 #–ià
__BIG_ENDIAN


20 
	#HAVE_BIG_ENDIAN
 1

	)

22 #”rÜ 
Unknown
 
’dŸÂess
. 
Fau»
 
š
 
’dŸn
.
h


64 
	#__Æ_hash
(
p
, 
num
, 
ba£
è
	`Æ_hash_ªy
(Õ), (num)*(*Õ)), (ba£))

	)

67 
ušt32_t
 
Æ_hash_ªy
(cÚ¡ *
key
, 
size_t
 
Ëngth
, ušt32_ˆ
ba£
);

	@mylibnl/libnl-3.2.25/include/netlink/hashtable.h

12 #iâdeà
NETLINK_HASHTABLE_H_


13 
	#NETLINK_HASHTABLE_H_


	)

15 #ifdeà
__ılu¥lus


19 
	sÆ_hash_node
 {

20 
ušt32_t
 
key
;

21 
ušt32_t
 
key_size
;

22 
Æ_objeù
 * 
obj
;

23 
Æ_hash_node
 * 
Ãxt
;

24 } 
	tÆ_hash_node_t
;

26 
	sÆ_hash_bË
 {

27 
size
;

28 
Æ_hash_node_t
 ** 
nodes
;

29 } 
	tÆ_hash_bË_t
;

32 
	#NL_MAX_HASH_ENTRIES
 1024

	)

35 
Æ_hash_bË_t
 * 
Æ_hash_bË_®loc
(
size
);

36 
Æ_hash_bË_ä“
(
Æ_hash_bË_t
 *
ht
);

38 
Æ_hash_bË_add
(
Æ_hash_bË_t
 *
ht
,

39 
Æ_objeù
 *
obj
);

40 
Æ_hash_bË_d–
(
Æ_hash_bË_t
 *
ht
,

41 
Æ_objeù
 *
obj
);

43 
Æ_objeù
 * 
Æ_hash_bË_lookup
(
Æ_hash_bË_t
 *
ht
,

44 
Æ_objeù
 *
obj
);

45 
ušt32_t
 
Æ_hash
(*
k
, 
size_t
 
Ëngth
,

46 
ušt32_t
 
š™v®
);

48 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/idiag/idiagnl.h

12 #iâdeà
NETLINK_IDIAGNL_H_


13 
	#NETLINK_IDIAGNL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


24 
	#IDIAG_TCPDIAG_GETSOCK
 18

	)

25 
	#IDIAG_DCCPDIAG_GETSOCK
 19

	)

26 
	#IDIAG_GETSOCK_MAX
 24

	)

33 
IDIAG_SS_UNKNOWN
,

34 
IDIAG_SS_ESTABLISHED
,

35 
IDIAG_SS_SYN_SENT
,

36 
IDIAG_SS_SYN_RECV
,

37 
IDIAG_SS_FIN_WAIT1
,

38 
IDIAG_SS_FIN_WAIT2
,

39 
IDIAG_SS_TIME_WAIT
,

40 
IDIAG_SS_CLOSE
,

41 
IDIAG_SS_CLOSE_WAIT
,

42 
IDIAG_SS_LAST_ACK
,

43 
IDIAG_SS_LISTEN
,

44 
IDIAG_SS_CLOSING
,

45 
IDIAG_SS_MAX


52 
	#IDIAG_SS_ALL
 ((1<<
IDIAG_SS_MAX
)-1)

	)

59 
IDIAG_ATTR_NONE
,

60 
IDIAG_ATTR_MEMINFO
,

61 
IDIAG_ATTR_INFO
,

62 
IDIAG_ATTR_VEGASINFO
,

63 
IDIAG_ATTR_CONG
,

64 
IDIAG_ATTR_TOS
,

65 
IDIAG_ATTR_TCLASS
,

66 
IDIAG_ATTR_SKMEMINFO
,

67 
IDIAG_ATTR_SHUTDOWN
,

68 
IDIAG_ATTR_MAX
,

75 
	#IDIAG_ATTR_ALL
 ((1<<
IDIAG_ATTR_MAX
)-1)

	)

82 
IDIAG_SK_MEMINFO_RMEM_ALLOC
,

83 
IDIAG_SK_MEMINFO_RCVBUF
,

84 
IDIAG_SK_MEMINFO_WMEM_ALLOC
,

85 
IDIAG_SK_MEMINFO_SNDBUF
,

86 
IDIAG_SK_MEMINFO_FWD_ALLOC
,

87 
IDIAG_SK_MEMINFO_WMEM_QUEUED
,

88 
IDIAG_SK_MEMINFO_OPTMEM
,

89 
IDIAG_SK_MEMINFO_BACKLOG
,

91 
IDIAG_SK_MEMINFO_VARS
,

99 
IDIAG_TIMER_OFF
,

100 
IDIAG_TIMER_ON
,

101 
IDIAG_TIMER_KEEPALIVE
,

102 
IDIAG_TIMER_TIMEWAIT
,

103 
IDIAG_TIMER_PERSIST
,

104 
IDIAG_TIMER_UNKNOWN
,

107 * 
idŸgÆ_¡©e2¡r
(, *, 
size_t
);

108 
idŸgÆ_¡r2¡©e
(const *);

110 
idŸgÆ_cÚÃù
(
Æ_sock
 *);

111 
idŸgÆ_£nd_sim¶e
(
Æ_sock
 *, , 
ušt8_t
, 
ušt16_t
,

112 
ušt16_t
);

114 * 
idŸgÆ_tim”2¡r
(, *, 
size_t
);

115 
idŸgÆ_¡r2tim”
(const *);

116 * 
idŸgÆ_©Œs2¡r
(, *, 
size_t
);

117 * 
idŸgÆ_tı¡©e2¡r
(
ušt8_t
, *, 
size_t
);

118 * 
idŸgÆ_tıİts2¡r
(
ušt8_t
, *, 
size_t
);

119 * 
idŸgÆ_shutdown2¡r
(
ušt8_t
, *, 
size_t
);

120 * 
idŸgÆ_exts2¡r
(
ušt8_t
, *, 
size_t
);

122 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/idiag/meminfo.h

12 #iâdeà
NETLINK_IDIAGNL_MEMINFO_H_


13 
	#NETLINK_IDIAGNL_MEMINFO_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_objeù_İs
 
idŸgÆ_memšfo_obj_İs
;

23 
idŸgÆ_memšfo
 *
idŸgÆ_memšfo_®loc
();

24 
idŸgÆ_memšfo_g‘
(
idŸgÆ_memšfo
 *);

25 
idŸgÆ_memšfo_put
(
idŸgÆ_memšfo
 *);

27 
ušt32_t
 
idŸgÆ_memšfo_g‘_rmem
(cÚ¡ 
idŸgÆ_memšfo
 *);

28 
ušt32_t
 
idŸgÆ_memšfo_g‘_wmem
(cÚ¡ 
idŸgÆ_memšfo
 *);

29 
ušt32_t
 
idŸgÆ_memšfo_g‘_fmem
(cÚ¡ 
idŸgÆ_memšfo
 *);

30 
ušt32_t
 
idŸgÆ_memšfo_g‘_tmem
(cÚ¡ 
idŸgÆ_memšfo
 *);

32 
idŸgÆ_memšfo_£t_rmem
(
idŸgÆ_memšfo
 *, 
ušt32_t
);

33 
idŸgÆ_memšfo_£t_wmem
(
idŸgÆ_memšfo
 *, 
ušt32_t
);

34 
idŸgÆ_memšfo_£t_fmem
(
idŸgÆ_memšfo
 *, 
ušt32_t
);

35 
idŸgÆ_memšfo_£t_tmem
(
idŸgÆ_memšfo
 *, 
ušt32_t
);

37 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/idiag/msg.h

12 #iâdeà
NETLINK_IDIAGNL_MSG_H_


13 
	#NETLINK_IDIAGNL_MSG_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
idŸgÆ_msg
;

22 
Æ_objeù_İs
 
idŸgÆ_msg_obj_İs
;

24 
idŸgÆ_msg
 * 
idŸgÆ_msg_®loc
();

25 
idŸgÆ_msg_®loc_ÿche
(
Æ_sock
 *, , ,

26 
Æ_ÿche
**);

27 
idŸgÆ_msg_g‘
(
idŸgÆ_msg
 *);

28 
idŸgÆ_msg_put
(
idŸgÆ_msg
 *);

29 
ušt8_t
 
idŸgÆ_msg_g‘_çmy
(cÚ¡ 
idŸgÆ_msg
 *);

30 
idŸgÆ_msg_£t_çmy
(
idŸgÆ_msg
 *, 
ušt8_t
);

31 
ušt8_t
 
idŸgÆ_msg_g‘_¡©e
(cÚ¡ 
idŸgÆ_msg
 *);

32 
idŸgÆ_msg_£t_¡©e
(
idŸgÆ_msg
 *, 
ušt8_t
);

33 
ušt8_t
 
idŸgÆ_msg_g‘_tim”
(cÚ¡ 
idŸgÆ_msg
 *);

34 
idŸgÆ_msg_£t_tim”
(
idŸgÆ_msg
 *, 
ušt8_t
);

35 
ušt8_t
 
idŸgÆ_msg_g‘_»Œªs
(cÚ¡ 
idŸgÆ_msg
 *);

36 
idŸgÆ_msg_£t_»Œªs
(
idŸgÆ_msg
 *, 
ušt8_t
);

37 
ušt16_t
 
idŸgÆ_msg_g‘_¥Üt
(
idŸgÆ_msg
 *);

38 
idŸgÆ_msg_£t_¥Üt
(
idŸgÆ_msg
 *, 
ušt16_t
);

39 
ušt16_t
 
idŸgÆ_msg_g‘_dpÜt
(
idŸgÆ_msg
 *);

40 
idŸgÆ_msg_£t_dpÜt
(
idŸgÆ_msg
 *, 
ušt16_t
);

41 
Æ_addr
 * 
idŸgÆ_msg_g‘_¤c
(cÚ¡ 
idŸgÆ_msg
 *);

42 
idŸgÆ_msg_£t_¤c
(
idŸgÆ_msg
 *,

43 
Æ_addr
 *);

44 
Æ_addr
 * 
idŸgÆ_msg_g‘_d¡
(cÚ¡ 
idŸgÆ_msg
 *);

45 
idŸgÆ_msg_£t_d¡
(
idŸgÆ_msg
 *,

46 
Æ_addr
 *);

47 
ušt32_t
 
idŸgÆ_msg_g‘_ifšdex
(cÚ¡ 
idŸgÆ_msg
 *);

48 
idŸgÆ_msg_£t_ifšdex
(
idŸgÆ_msg
 *, 
ušt32_t
);

49 
ušt32_t
 
idŸgÆ_msg_g‘_expœes
(cÚ¡ 
idŸgÆ_msg
 *);

50 
idŸgÆ_msg_£t_expœes
(
idŸgÆ_msg
 *, 
ušt32_t
);

51 
ušt32_t
 
idŸgÆ_msg_g‘_rqueue
(cÚ¡ 
idŸgÆ_msg
 *);

52 
idŸgÆ_msg_£t_rqueue
(
idŸgÆ_msg
 *, 
ušt32_t
);

53 
ušt32_t
 
idŸgÆ_msg_g‘_wqueue
(cÚ¡ 
idŸgÆ_msg
 *);

54 
idŸgÆ_msg_£t_wqueue
(
idŸgÆ_msg
 *, 
ušt32_t
);

55 
ušt32_t
 
idŸgÆ_msg_g‘_uid
(cÚ¡ 
idŸgÆ_msg
 *);

56 
idŸgÆ_msg_£t_uid
(
idŸgÆ_msg
 *, 
ušt32_t
);

57 
ušt32_t
 
idŸgÆ_msg_g‘_šode
(cÚ¡ 
idŸgÆ_msg
 *);

58 
idŸgÆ_msg_£t_šode
(
idŸgÆ_msg
 *, 
ušt32_t
);

59 
ušt8_t
 
idŸgÆ_msg_g‘_tos
(cÚ¡ 
idŸgÆ_msg
 *);

60 
idŸgÆ_msg_£t_tos
(
idŸgÆ_msg
 *, 
ušt8_t
);

61 
ušt8_t
 
idŸgÆ_msg_g‘_tşass
(cÚ¡ 
idŸgÆ_msg
 *);

62 
idŸgÆ_msg_£t_tşass
(
idŸgÆ_msg
 *, 
ušt8_t
);

63 
ušt8_t
 
idŸgÆ_msg_g‘_shutdown
(cÚ¡ 
idŸgÆ_msg
 *);

64 
idŸgÆ_msg_£t_shutdown
(
idŸgÆ_msg
 *, 
ušt8_t
);

65 * 
idŸgÆ_msg_g‘_cÚg
(cÚ¡ 
idŸgÆ_msg
 *);

66 
idŸgÆ_msg_£t_cÚg
(
idŸgÆ_msg
 *, *);

67 
idŸgÆ_memšfo
 *
idŸgÆ_msg_g‘_memšfo
(cÚ¡ 
idŸgÆ_msg
 *);

68 
idŸgÆ_msg_£t_memšfo
(
idŸgÆ_msg
 *,

69 
idŸgÆ_memšfo
 *);

70 
idŸgÆ_vegasšfo
 *
idŸgÆ_msg_g‘_vegasšfo
(cÚ¡ 
idŸgÆ_msg
 *);

71 
idŸgÆ_msg_£t_vegasšfo
(
idŸgÆ_msg
 *,

72 
idŸgÆ_vegasšfo
 *);

73 
tı_šfo
 
idŸgÆ_msg_g‘_tıšfo
(cÚ¡ 
idŸgÆ_msg
 *);

74 
idŸgÆ_msg_£t_tıšfo
(
idŸgÆ_msg
 *,

75 
tı_šfo
 *);

77 
idŸgÆ_msg_·r£
(
Æmsghdr
 *,

78 
idŸgÆ_msg
 **);

79 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/idiag/req.h

12 #iâdeà
NETLINK_IDIAGNL_REQ_H_


13 
	#NETLINK_IDIAGNL_REQ_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
idŸgÆ_»q
;

22 
Æ_objeù_İs
 
idŸgÆ_»q_obj_İs
;

24 
idŸgÆ_»q
 * 
idŸgÆ_»q_®loc
();

25 
idŸgÆ_»q_g‘
(
idŸgÆ_»q
 *);

26 
idŸgÆ_»q_put
(
idŸgÆ_»q
 *);

27 
ušt8_t
 
idŸgÆ_»q_g‘_çmy
(cÚ¡ 
idŸgÆ_»q
 *);

28 
idŸgÆ_»q_£t_çmy
(
idŸgÆ_»q
 *,

29 
ušt8_t
);

30 
ušt8_t
 
idŸgÆ_»q_g‘_ext
(cÚ¡ 
idŸgÆ_»q
 *);

31 
idŸgÆ_»q_£t_ext
(
idŸgÆ_»q
 *, 
ušt8_t
);

32 
ušt32_t
 
idŸgÆ_»q_g‘_ifšdex
(cÚ¡ 
idŸgÆ_»q
 *);

33 
idŸgÆ_»q_£t_ifšdex
(
idŸgÆ_»q
 *,

34 
ušt32_t
);

35 
ušt32_t
 
idŸgÆ_»q_g‘_¡©es
(cÚ¡ 
idŸgÆ_»q
 *);

36 
idŸgÆ_»q_£t_¡©es
(
idŸgÆ_»q
 *,

37 
ušt32_t
);

38 
ušt32_t
 
idŸgÆ_»q_g‘_dbs
(cÚ¡ 
idŸgÆ_»q
 *);

39 
idŸgÆ_»q_£t_dbs
(
idŸgÆ_»q
 *, 
ušt32_t
);

40 
Æ_addr
 * 
idŸgÆ_»q_g‘_¤c
(cÚ¡ 
idŸgÆ_»q
 *);

41 
idŸgÆ_»q_£t_¤c
(
idŸgÆ_»q
 *,

42 
Æ_addr
 *);

43 
Æ_addr
 * 
idŸgÆ_»q_g‘_d¡
(cÚ¡ 
idŸgÆ_»q
 *);

44 
idŸgÆ_»q_£t_d¡
(
idŸgÆ_»q
 *,

45 
Æ_addr
 *);

46 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/idiag/vegasinfo.h

12 #iâdeà
NETLINK_IDIAGNL_VEGASINFO_H_


13 
	#NETLINK_IDIAGNL_VEGASINFO_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_objeù_İs
 
idŸgÆ_vegasšfo_obj_İs
;

22 
idŸgÆ_vegasšfo
 * 
idŸgÆ_vegasšfo_®loc
();

23 
idŸgÆ_vegasšfo_g‘
(
idŸgÆ_vegasšfo
 *);

24 
idŸgÆ_vegasšfo_put
(
idŸgÆ_vegasšfo
 *);

26 
ušt32_t
 
idŸgÆ_vegasšfo_g‘_’abËd
(cÚ¡ 
idŸgÆ_vegasšfo
 *);

27 
ušt32_t
 
idŸgÆ_vegasšfo_g‘_¹tút
(cÚ¡ 
idŸgÆ_vegasšfo
 *);

28 
ušt32_t
 
idŸgÆ_vegasšfo_g‘_¹t
(cÚ¡ 
idŸgÆ_vegasšfo
 *);

29 
ušt32_t
 
idŸgÆ_vegasšfo_g‘_mš¹t
(cÚ¡ 
idŸgÆ_vegasšfo
 *);

31 
idŸgÆ_vegasšfo_£t_’abËd
(
idŸgÆ_vegasšfo
 *,

32 
ušt32_t
);

33 
idŸgÆ_vegasšfo_£t_¹tút
(
idŸgÆ_vegasšfo
 *,

34 
ušt32_t
);

35 
idŸgÆ_vegasšfo_£t_¹t
(
idŸgÆ_vegasšfo
 *, 
ušt32_t
);

36 
idŸgÆ_vegasšfo_£t_mš¹t
(
idŸgÆ_vegasšfo
 *,

37 
ušt32_t
);

39 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/list.h

12 #iâdeà
NETLINK_LIST_H_


13 
	#NETLINK_LIST_H_


	)

15 
	sÆ_li¡_h—d


17 
Æ_li¡_h—d
 * 
	mÃxt
;

18 
Æ_li¡_h—d
 * 
	m´ev
;

21 
šlše
 
	$NL_INIT_LIST_HEAD
(
Æ_li¡_h—d
 *
li¡
)

23 
li¡
->
Ãxt
 =†ist;

24 
li¡
->
´ev
 =†ist;

25 
	}
}

27 
šlše
 
	$__Æ_li¡_add
(
Æ_li¡_h—d
 *
obj
,

28 
Æ_li¡_h—d
 *
´ev
,

29 
Æ_li¡_h—d
 *
Ãxt
)

31 
´ev
->
Ãxt
 = 
obj
;

32 
obj
->
´ev
 =…rev;

33 
Ãxt
->
´ev
 = 
obj
;

34 
obj
->
Ãxt
 =‚ext;

35 
	}
}

37 
šlše
 
	$Æ_li¡_add_
(
Æ_li¡_h—d
 *
obj
,

38 
Æ_li¡_h—d
 *
h—d
)

40 
	`__Æ_li¡_add
(
obj
, 
h—d
->
´ev
, head);

41 
	}
}

43 
šlše
 
	$Æ_li¡_add_h—d
(
Æ_li¡_h—d
 *
obj
,

44 
Æ_li¡_h—d
 *
h—d
)

46 
	`__Æ_li¡_add
(
obj
, 
h—d
, h—d->
Ãxt
);

47 
	}
}

49 
šlše
 
	$Æ_li¡_d–
(
Æ_li¡_h—d
 *
obj
)

51 
obj
->
Ãxt
->
´ev
 = obj->prev;

52 
obj
->
´ev
->
Ãxt
 = obj->next;

53 
	}
}

55 
šlše
 
	$Æ_li¡_em±y
(
Æ_li¡_h—d
 *
h—d
)

57  
h—d
->
Ãxt
 == head;

58 
	}
}

60 
	#Æ_cÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

61 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (
±r
); \

62 (
ty³
 *)Ğ(*)
__m±r
 - ((
size_t
è&(Ñy³ *)0)->
memb”
));})

	)

64 
	#Æ_li¡_’Œy
(
±r
, 
ty³
, 
memb”
) \

65 
	`Æ_cÚš”_of
(
±r
, 
ty³
, 
memb”
)

	)

67 
	#Æ_li¡_©_
(
pos
, 
h—d
, 
memb”
) \

68 ((
pos
)->
memb”
.
Ãxt
 =ğ(
h—d
))

	)

70 
	#Æ_li¡_©_h—d
(
pos
, 
h—d
, 
memb”
) \

71 ((
pos
)->
memb”
.
´ev
 =ğ(
h—d
))

	)

73 
	#NL_LIST_HEAD
(
Çme
) \

74 
Æ_li¡_h—d
 
Çme
 = { &Òame), &Òameè}

	)

76 
	#Æ_li¡_fœ¡_’Œy
(
h—d
, 
ty³
, 
memb”
) \

77 
	`Æ_li¡_’Œy
((
h—d
)->
Ãxt
, 
ty³
, 
memb”
)

	)

79 
	#Æ_li¡_fÜ_—ch_’Œy
(
pos
, 
h—d
, 
memb”
) \

80 
pos
 = 
	`Æ_li¡_’Œy
((
h—d
)->
Ãxt
, 
	`ty³of
(*pos), 
memb”
); \

81 &(
pos
)->
memb”
 !ğ(
h—d
); \

82 (
pos
èğ
	`Æ_li¡_’Œy
(Õos)->
memb”
.
Ãxt
, 
	`ty³of
(*Õos)), memb”))

	)

84 
	#Æ_li¡_fÜ_—ch_’Œy_§ã
(
pos
, 
n
, 
h—d
, 
memb”
) \

85 
pos
 = 
	`Æ_li¡_’Œy
((
h—d
)->
Ãxt
, 
	`ty³of
(*pos), 
memb”
), \

86 
n
 = 
	`Æ_li¡_’Œy
(
pos
->
memb”
.
Ãxt
, 
	`ty³of
(*pos), member); \

87 &(
pos
)->
memb”
 !ğ(
h—d
); \

88 
pos
 = 
n
,‚ = 
	`Æ_li¡_’Œy
Ò->
memb”
.
Ãxt
, 
	`ty³of
(*n), memb”))

	)

90 
	#Æ_š™_li¡_h—d
(
h—d
) \

91 dØ{ (
h—d
)->
Ãxt
 = (h—d); (h—d)->
´ev
 = (h—d); } 0)

	)

	@mylibnl/libnl-3.2.25/include/netlink/msg.h

12 #iâdeà
NETLINK_MSG_H_


13 
	#NETLINK_MSG_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/objeù.h
>

17 
	~<Ãšk/©Œ.h
>

19 #ifdeà
__ılu¥lus


23 
	#NL_DONTPAD
 0

	)

33 
	#NL_AUTO_PORT
 0

	)

34 
	#NL_AUTO_PID
 
NL_AUTO_PORT


	)

44 
	#NL_AUTO_SEQ
 0

	)

46 
Æ_msg
;

47 
Æ_Œ“
;

48 
uüed
;

50 
Æmsg_size
();

51 
Æmsg_tÙ®_size
();

52 
Æmsg_·dËn
();

54 * 
Æmsg_d©a
(cÚ¡ 
Æmsghdr
 *);

55 
Æmsg_d©®’
(cÚ¡ 
Æmsghdr
 *);

56 * 
Æmsg_
(cÚ¡ 
Æmsghdr
 *);

59 
Æ©Œ
 * 
Æmsg_©Œd©a
(cÚ¡ 
Æmsghdr
 *, );

60 
Æmsg_©ŒËn
(cÚ¡ 
Æmsghdr
 *, );

63 
Æmsg_v®id_hdr
(cÚ¡ 
Æmsghdr
 *, );

64 
Æmsg_ok
(cÚ¡ 
Æmsghdr
 *, );

65 
Æmsghdr
 * 
Æmsg_Ãxt
(nlmsghdr *, *);

66 
Æmsg_·r£
(
Æmsghdr
 *, , 
Æ©Œ
 **,

67 , 
Æa_pŞicy
 *);

68 
Æ©Œ
 * 
Æmsg_fšd_©Œ
(
Æmsghdr
 *, , );

69 
Æmsg_v®id©e
(
Æmsghdr
 *, , ,

70 
Æa_pŞicy
 *);

72 
Æ_msg
 * 
Æmsg_®loc
();

73 
Æ_msg
 * 
Æmsg_®loc_size
(
size_t
);

74 
Æ_msg
 * 
Æmsg_®loc_sim¶e
(, );

75 
Æmsg_£t_deçuÉ_size
(
size_t
);

76 
Æ_msg
 * 
Æmsg_šh”™
(
Æmsghdr
 *);

77 
Æ_msg
 * 
Æmsg_cÚv”t
(
Æmsghdr
 *);

78 * 
Æmsg_»£rve
(
Æ_msg
 *, 
size_t
, );

79 
Æmsg_­³nd
(
Æ_msg
 *, *, 
size_t
, );

80 
Æmsg_ex·nd
(
Æ_msg
 *, 
size_t
);

82 
Æmsghdr
 * 
Æmsg_put
(
Æ_msg
 *, 
ušt32_t
, uint32_t,

84 
Æmsghdr
 * 
Æmsg_hdr
(
Æ_msg
 *);

85 
Æmsg_g‘
(
Æ_msg
 *);

86 
Æmsg_ä“
(
Æ_msg
 *);

89 
Æmsg_£t_´Ùo
(
Æ_msg
 *, );

90 
Æmsg_g‘_´Ùo
(
Æ_msg
 *);

91 
size_t
 
Æmsg_g‘_max_size
(
Æ_msg
 *);

92 
Æmsg_£t_¤c
(
Æ_msg
 *, 
sockaddr_Æ
 *);

93 
sockaddr_Æ
 *
Æmsg_g‘_¤c
(
Æ_msg
 *);

94 
Æmsg_£t_d¡
(
Æ_msg
 *, 
sockaddr_Æ
 *);

95 
sockaddr_Æ
 *
Æmsg_g‘_d¡
(
Æ_msg
 *);

96 
Æmsg_£t_üeds
(
Æ_msg
 *, 
uüed
 *);

97 
uüed
 * 
Æmsg_g‘_üeds
(
Æ_msg
 *);

99 * 
Æ_Æmsgty³2¡r
(, *, 
size_t
);

100 
Æ_¡r2Æmsgty³
(const *);

102 * 
Æ_Æmsg_æags2¡r
(, *, 
size_t
);

104 
Æ_msg_·r£
(
Æ_msg
 *,

105 (*
cb
)(
Æ_objeù
 *, *),

108 
Æ_msg_dump
(
Æ_msg
 *, 
FILE
 *);

123 
	#Æmsg_fÜ_—ch_©Œ
(
pos
, 
Æh
, 
hd¾’
, 
»m
) \

124 
	`Æa_fÜ_—ch_©Œ
(
pos
, 
	`Æmsg_©Œd©a
(
Æh
, 
hd¾’
), \

125 
	`Æmsg_©ŒËn
(
Æh
, 
hd¾’
), 
»m
)

	)

133 
	#Æmsg_fÜ_—ch
(
pos
, 
h—d
, 
Ën
) \

134 
»m
 = 
Ën
, 
pos
 = 
h—d
; \

135 
	`Æmsg_ok
(
pos
, 
»m
); \

136 
pos
 = 
	`Æmsg_Ãxt
Õos, &
»m
))

	)

138 
	#Æmsg_fÜ_—ch_msg
(
pos
, 
h—d
, 
Ën
, 
»m
) \

139 
	`Æmsg_fÜ_—ch
(
pos
, 
h—d
, 
Ën
)

	)

143 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/ct.h

14 #iâdeà
NETLINK_CT_H_


15 
	#NETLINK_CT_H_


	)

17 
	~<Ãšk/Ãšk.h
>

18 
	~<Ãšk/addr.h
>

19 
	~<Ãšk/ÿche.h
>

20 
	~<Ãšk/msg.h
>

22 #ifdeà
__ılu¥lus


26 
nâl_ù
;

28 
	snâl_ù_time¡amp
 {

29 
ušt64_t
 
¡¬t
;

30 
ušt64_t
 
¡İ
;

33 
Æ_objeù_İs
 
ù_obj_İs
;

35 
nâl_ù
 * 
nâl_ù_®loc
();

36 
nâl_ù_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

38 
nâlmsg_ù_group
(
Æmsghdr
 *);

39 
nâlmsg_ù_·r£
(
Æmsghdr
 *, 
nâl_ù
 **);

41 
nâl_ù_g‘
(
nâl_ù
 *);

42 
nâl_ù_put
(
nâl_ù
 *);

44 
nâl_ù_dump_»que¡
(
Æ_sock
 *);

46 
nâl_ù_bud_add_»que¡
(cÚ¡ 
nâl_ù
 *, ,

47 
Æ_msg
 **);

48 
nâl_ù_add
(
Æ_sock
 *, cÚ¡ 
nâl_ù
 *, );

50 
nâl_ù_bud_d–‘e_»que¡
(cÚ¡ 
nâl_ù
 *, ,

51 
Æ_msg
 **);

52 
nâl_ù_d–
(
Æ_sock
 *, cÚ¡ 
nâl_ù
 *, );

54 
nâl_ù_bud_qu”y_»que¡
(cÚ¡ 
nâl_ù
 *, ,

55 
Æ_msg
 **);

56 
nâl_ù_qu”y
(
Æ_sock
 *, cÚ¡ 
nâl_ù
 *, );

58 
nâl_ù_£t_çmy
(
nâl_ù
 *, 
ušt8_t
);

59 
ušt8_t
 
nâl_ù_g‘_çmy
(cÚ¡ 
nâl_ù
 *);

61 
nâl_ù_£t_´Ùo
(
nâl_ù
 *, 
ušt8_t
);

62 
nâl_ù_‹¡_´Ùo
(cÚ¡ 
nâl_ù
 *);

63 
ušt8_t
 
nâl_ù_g‘_´Ùo
(cÚ¡ 
nâl_ù
 *);

65 
nâl_ù_£t_tı_¡©e
(
nâl_ù
 *, 
ušt8_t
);

66 
nâl_ù_‹¡_tı_¡©e
(cÚ¡ 
nâl_ù
 *);

67 
ušt8_t
 
nâl_ù_g‘_tı_¡©e
(cÚ¡ 
nâl_ù
 *);

68 * 
nâl_ù_tı_¡©e2¡r
(
ušt8_t
, *, 
size_t
);

69 
nâl_ù_¡r2tı_¡©e
(cÚ¡ *
Çme
);

71 
nâl_ù_£t_¡©us
(
nâl_ù
 *, 
ušt32_t
);

72 
nâl_ù_un£t_¡©us
(
nâl_ù
 *, 
ušt32_t
);

73 
nâl_ù_‹¡_¡©us
(cÚ¡ 
nâl_ù
 *
ù
);

74 
ušt32_t
 
nâl_ù_g‘_¡©us
(cÚ¡ 
nâl_ù
 *);

75 * 
nâl_ù_¡©us2¡r
(, *, 
size_t
);

76 
nâl_ù_¡r2¡©us
(const *);

78 
nâl_ù_£t_timeout
(
nâl_ù
 *, 
ušt32_t
);

79 
nâl_ù_‹¡_timeout
(cÚ¡ 
nâl_ù
 *);

80 
ušt32_t
 
nâl_ù_g‘_timeout
(cÚ¡ 
nâl_ù
 *);

82 
nâl_ù_£t_m¬k
(
nâl_ù
 *, 
ušt32_t
);

83 
nâl_ù_‹¡_m¬k
(cÚ¡ 
nâl_ù
 *);

84 
ušt32_t
 
nâl_ù_g‘_m¬k
(cÚ¡ 
nâl_ù
 *);

86 
nâl_ù_£t_u£
(
nâl_ù
 *, 
ušt32_t
);

87 
nâl_ù_‹¡_u£
(cÚ¡ 
nâl_ù
 *);

88 
ušt32_t
 
nâl_ù_g‘_u£
(cÚ¡ 
nâl_ù
 *);

90 
nâl_ù_£t_id
(
nâl_ù
 *, 
ušt32_t
);

91 
nâl_ù_‹¡_id
(cÚ¡ 
nâl_ù
 *);

92 
ušt32_t
 
nâl_ù_g‘_id
(cÚ¡ 
nâl_ù
 *);

94 
nâl_ù_£t_zÚe
(
nâl_ù
 *, 
ušt16_t
);

95 
nâl_ù_‹¡_zÚe
(cÚ¡ 
nâl_ù
 *);

96 
ušt16_t
 
nâl_ù_g‘_zÚe
(cÚ¡ 
nâl_ù
 *);

98 
nâl_ù_£t_¤c
(
nâl_ù
 *, , 
Æ_addr
 *);

99 
Æ_addr
 * 
nâl_ù_g‘_¤c
(cÚ¡ 
nâl_ù
 *, );

101 
nâl_ù_£t_d¡
(
nâl_ù
 *, , 
Æ_addr
 *);

102 
Æ_addr
 * 
nâl_ù_g‘_d¡
(cÚ¡ 
nâl_ù
 *, );

104 
nâl_ù_£t_¤c_pÜt
(
nâl_ù
 *, , 
ušt16_t
);

105 
nâl_ù_‹¡_¤c_pÜt
(cÚ¡ 
nâl_ù
 *, );

106 
ušt16_t
 
nâl_ù_g‘_¤c_pÜt
(cÚ¡ 
nâl_ù
 *, );

108 
nâl_ù_£t_d¡_pÜt
(
nâl_ù
 *, , 
ušt16_t
);

109 
nâl_ù_‹¡_d¡_pÜt
(cÚ¡ 
nâl_ù
 *, );

110 
ušt16_t
 
nâl_ù_g‘_d¡_pÜt
(cÚ¡ 
nâl_ù
 *, );

112 
nâl_ù_£t_icmp_id
(
nâl_ù
 *, , 
ušt16_t
);

113 
nâl_ù_‹¡_icmp_id
(cÚ¡ 
nâl_ù
 *, );

114 
ušt16_t
 
nâl_ù_g‘_icmp_id
(cÚ¡ 
nâl_ù
 *, );

116 
nâl_ù_£t_icmp_ty³
(
nâl_ù
 *, , 
ušt8_t
);

117 
nâl_ù_‹¡_icmp_ty³
(cÚ¡ 
nâl_ù
 *, );

118 
ušt8_t
 
nâl_ù_g‘_icmp_ty³
(cÚ¡ 
nâl_ù
 *, );

120 
nâl_ù_£t_icmp_code
(
nâl_ù
 *, , 
ušt8_t
);

121 
nâl_ù_‹¡_icmp_code
(cÚ¡ 
nâl_ù
 *, );

122 
ušt8_t
 
nâl_ù_g‘_icmp_code
(cÚ¡ 
nâl_ù
 *, );

124 
nâl_ù_£t_·ck‘s
(
nâl_ù
 *, , 
ušt64_t
);

125 
nâl_ù_‹¡_·ck‘s
(cÚ¡ 
nâl_ù
 *, );

126 
ušt64_t
 
nâl_ù_g‘_·ck‘s
(cÚ¡ 
nâl_ù
 *,);

128 
nâl_ù_£t_by‹s
(
nâl_ù
 *, , 
ušt64_t
);

129 
nâl_ù_‹¡_by‹s
(cÚ¡ 
nâl_ù
 *, );

130 
ušt64_t
 
nâl_ù_g‘_by‹s
(cÚ¡ 
nâl_ù
 *, );

132 
nâl_ù_£t_time¡amp
(
nâl_ù
 *, 
ušt64_t
, uint64_t);

133 
nâl_ù_‹¡_time¡amp
(cÚ¡ 
nâl_ù
 *);

134 cÚ¡ 
nâl_ù_time¡amp
 *
nâl_ù_g‘_time¡amp
(cÚ¡ 
nâl_ù
 *);

136 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/exp.h

15 #iâdeà
NETLINK_EXP_H_


16 
	#NETLINK_EXP_H_


	)

18 
	~<Ãšk/Ãšk.h
>

19 
	~<Ãšk/addr.h
>

20 
	~<Ãšk/ÿche.h
>

21 
	~<Ãšk/msg.h
>

23 
	~<lšux/v”siÚ.h
>

25 #ifdeà
__ılu¥lus


29 
nâl_exp
;

31 
	enâl_exp_tu¶es
 {

32 
NFNL_EXP_TUPLE_EXPECT
,

33 
NFNL_EXP_TUPLE_MASTER
,

34 
NFNL_EXP_TUPLE_MASK
,

35 
NFNL_EXP_TUPLE_NAT
,

36 
NFNL_EXP_TUPLE_MAX


39 
Æ_objeù_İs
 
exp_obj_İs
;

41 
nâl_exp
 * 
nâl_exp_®loc
();

42 
nâl_exp_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

44 
nâlmsg_exp_group
(
Æmsghdr
 *);

45 
nâlmsg_exp_·r£
(
Æmsghdr
 *, 
nâl_exp
 **);

47 
nâl_exp_g‘
(
nâl_exp
 *);

48 
nâl_exp_put
(
nâl_exp
 *);

50 
nâl_exp_dump_»que¡
(
Æ_sock
 *);

52 
nâl_exp_bud_add_»que¡
(cÚ¡ 
nâl_exp
 *, ,

53 
Æ_msg
 **);

54 
nâl_exp_add
(
Æ_sock
 *, cÚ¡ 
nâl_exp
 *, );

56 
nâl_exp_bud_d–‘e_»que¡
(cÚ¡ 
nâl_exp
 *, ,

57 
Æ_msg
 **);

58 
nâl_exp_d–
(
Æ_sock
 *, cÚ¡ 
nâl_exp
 *, );

60 
nâl_exp_bud_qu”y_»que¡
(cÚ¡ 
nâl_exp
 *, ,

61 
Æ_msg
 **);

62 
nâl_exp_qu”y
(
Æ_sock
 *, cÚ¡ 
nâl_exp
 *, );

64 
nâl_exp_£t_çmy
(
nâl_exp
 *, 
ušt8_t
);

65 
ušt8_t
 
nâl_exp_g‘_çmy
(cÚ¡ 
nâl_exp
 *);

67 
nâl_exp_£t_timeout
(
nâl_exp
 *, 
ušt32_t
);

68 
nâl_exp_‹¡_timeout
(cÚ¡ 
nâl_exp
 *);

69 
ušt32_t
 
nâl_exp_g‘_timeout
(cÚ¡ 
nâl_exp
 *);

71 
nâl_exp_£t_id
(
nâl_exp
 *, 
ušt32_t
);

72 
nâl_exp_‹¡_id
(cÚ¡ 
nâl_exp
 *);

73 
ušt32_t
 
nâl_exp_g‘_id
(cÚ¡ 
nâl_exp
 *);

75 
nâl_exp_£t_h–³r_Çme
(
nâl_exp
 *, *);

76 
nâl_exp_‹¡_h–³r_Çme
(cÚ¡ 
nâl_exp
 *);

77 cÚ¡ * 
nâl_exp_g‘_h–³r_Çme
(cÚ¡ 
nâl_exp
 *);

79 
nâl_exp_£t_zÚe
(
nâl_exp
 *, 
ušt16_t
);

80 
nâl_exp_‹¡_zÚe
(cÚ¡ 
nâl_exp
 *);

81 
ušt16_t
 
nâl_exp_g‘_zÚe
(cÚ¡ 
nâl_exp
 *);

83 
nâl_exp_£t_æags
(
nâl_exp
 *, 
ušt32_t
);

84 
nâl_exp_‹¡_æags
(cÚ¡ 
nâl_exp
 *);

85 
ušt32_t
 
nâl_exp_g‘_æags
(cÚ¡ 
nâl_exp
 *);

87 
nâl_exp_£t_şass
(
nâl_exp
 *, 
ušt32_t
);

88 
nâl_exp_‹¡_şass
(cÚ¡ 
nâl_exp
 *);

89 
ušt32_t
 
nâl_exp_g‘_şass
(cÚ¡ 
nâl_exp
 *);

91 
nâl_exp_£t_â
(
nâl_exp
 *, *);

92 
nâl_exp_‹¡_â
(cÚ¡ 
nâl_exp
 *);

93 cÚ¡ * 
nâl_exp_g‘_â
(cÚ¡ 
nâl_exp
 *);

95 
nâl_exp_£t_Çt_dœ
(
nâl_exp
 *, 
ušt8_t
);

96 
nâl_exp_‹¡_Çt_dœ
(cÚ¡ 
nâl_exp
 *);

97 
ušt8_t
 
nâl_exp_g‘_Çt_dœ
(cÚ¡ 
nâl_exp
 *);

102 
nâl_exp_£t_¤c
(
nâl_exp
 *, , 
Æ_addr
 *);

103 
nâl_exp_‹¡_¤c
(cÚ¡ 
nâl_exp
 *, );

104 
Æ_addr
 * 
nâl_exp_g‘_¤c
(cÚ¡ 
nâl_exp
 *, );

106 
nâl_exp_£t_d¡
(
nâl_exp
 *, , 
Æ_addr
 *);

107 
nâl_exp_‹¡_d¡
(cÚ¡ 
nâl_exp
 *, );

108 
Æ_addr
 * 
nâl_exp_g‘_d¡
(cÚ¡ 
nâl_exp
 *, );

110 
nâl_exp_£t_l4´ÙÚum
(
nâl_exp
 *, , 
ušt8_t
);

111 
nâl_exp_‹¡_l4´ÙÚum
(cÚ¡ 
nâl_exp
 *, );

112 
ušt8_t
 
nâl_exp_g‘_l4´ÙÚum
(cÚ¡ 
nâl_exp
 *, );

114 
nâl_exp_£t_pÜts
(
nâl_exp
 *, , 
ušt16_t
, uint16_t);

115 
nâl_exp_‹¡_pÜts
(cÚ¡ 
nâl_exp
 *, );

116 
ušt16_t
 
nâl_exp_g‘_¤c_pÜt
(cÚ¡ 
nâl_exp
 *, );

117 
ušt16_t
 
nâl_exp_g‘_d¡_pÜt
(cÚ¡ 
nâl_exp
 *, );

119 
nâl_exp_£t_icmp
(
nâl_exp
 *, , 
ušt16_t
, 
ušt8_t
, uint8_t);

120 
nâl_exp_‹¡_icmp
(cÚ¡ 
nâl_exp
 *, );

121 
ušt16_t
 
nâl_exp_g‘_icmp_id
(cÚ¡ 
nâl_exp
 *, );

122 
ušt8_t
 
nâl_exp_g‘_icmp_ty³
(cÚ¡ 
nâl_exp
 *, );

123 
ušt8_t
 
nâl_exp_g‘_icmp_code
(cÚ¡ 
nâl_exp
 *, );

125 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/log.h

15 #iâdeà
NETLINK_LOG_H_


16 
	#NETLINK_LOG_H_


	)

18 
	~<Ãšk/Ãšk.h
>

20 #ifdeà
__ılu¥lus


24 
Æ_sock
;

25 
Æmsghdr
;

26 
nâl_log
;

28 
Æ_objeù_İs
 
log_obj_İs
;

30 
	enâl_log_cİy_mode
 {

31 
	gNFNL_LOG_COPY_NONE
,

32 
	gNFNL_LOG_COPY_META
,

33 
	gNFNL_LOG_COPY_PACKET
,

36 
	enâl_log_æags
 {

37 
	gNFNL_LOG_FLAG_SEQ
 = 0x1,

38 
	gNFNL_LOG_FLAG_SEQ_GLOBAL
 = 0x2,

42 
nâl_log
 * 
nâl_log_®loc
();

43 
nâlmsg_log_·r£
(
Æmsghdr
 *,

44 
nâl_log
 **);

46 
nâl_log_g‘
(
nâl_log
 *);

47 
nâl_log_put
(
nâl_log
 *);

50 
nâl_log_£t_group
(
nâl_log
 *, 
ušt16_t
);

51 
nâl_log_‹¡_group
(cÚ¡ 
nâl_log
 *);

52 
ušt16_t
 
nâl_log_g‘_group
(cÚ¡ 
nâl_log
 *);

54 
nâl_log_£t_cİy_mode
(
nâl_log
 *,

55 
nâl_log_cİy_mode
);

56 
nâl_log_‹¡_cİy_mode
(cÚ¡ 
nâl_log
 *);

57 
nâl_log_cİy_mode
 
nâl_log_g‘_cİy_mode
(cÚ¡ 
nâl_log
 *);

59 * 
nâl_log_cİy_mode2¡r
(
nâl_log_cİy_mode
,

60 *, 
size_t
);

61 
nâl_log_cİy_mode
 
nâl_log_¡r2cİy_mode
(const *);

63 
nâl_log_£t_cİy_¿nge
(
nâl_log
 *, 
ušt32_t
);

64 
nâl_log_‹¡_cİy_¿nge
(cÚ¡ 
nâl_log
 *);

65 
ušt32_t
 
nâl_log_g‘_cİy_¿nge
(cÚ¡ 
nâl_log
 *);

67 
nâl_log_£t_æush_timeout
(
nâl_log
 *, 
ušt32_t
);

68 
nâl_log_‹¡_æush_timeout
(cÚ¡ 
nâl_log
 *);

69 
ušt32_t
 
nâl_log_g‘_æush_timeout
(cÚ¡ 
nâl_log
 *);

71 
nâl_log_£t_®loc_size
(
nâl_log
 *, 
ušt32_t
);

72 
nâl_log_‹¡_®loc_size
(cÚ¡ 
nâl_log
 *);

73 
ušt32_t
 
nâl_log_g‘_®loc_size
(cÚ¡ 
nâl_log
 *);

75 
nâl_log_£t_queue_th»shŞd
(
nâl_log
 *, 
ušt32_t
);

76 
nâl_log_‹¡_queue_th»shŞd
(cÚ¡ 
nâl_log
 *);

77 
ušt32_t
 
nâl_log_g‘_queue_th»shŞd
(cÚ¡ 
nâl_log
 *);

79 
nâl_log_£t_æags
(
nâl_log
 *, );

80 
nâl_log_un£t_æags
(
nâl_log
 *, );

81 
nâl_log_g‘_æags
(cÚ¡ 
nâl_log
 *);

83 * 
nâl_log_æags2¡r
(, *, 
size_t
);

84 
nâl_log_¡r2æags
(const *);

86 
nâl_log_bud_pf_bšd
(
ušt8_t
, 
Æ_msg
 **);

87 
nâl_log_pf_bšd
(
Æ_sock
 *, 
ušt8_t
);

89 
nâl_log_bud_pf_unbšd
(
ušt8_t
, 
Æ_msg
 **);

90 
nâl_log_pf_unbšd
(
Æ_sock
 *, 
ušt8_t
);

92 
nâl_log_bud_ü—‹_»que¡
(cÚ¡ 
nâl_log
 *,

93 
Æ_msg
 **);

94 
nâl_log_ü—‹
(
Æ_sock
 *, cÚ¡ 
nâl_log
 *);

96 
nâl_log_bud_chªge_»que¡
(cÚ¡ 
nâl_log
 *,

97 
Æ_msg
 **);

98 
nâl_log_chªge
(
Æ_sock
 *, cÚ¡ 
nâl_log
 *);

100 
nâl_log_bud_d–‘e_»que¡
(cÚ¡ 
nâl_log
 *,

101 
Æ_msg
 **);

102 
nâl_log_d–‘e
(
Æ_sock
 *, cÚ¡ 
nâl_log
 *);

104 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/log_msg.h

15 #iâdeà
NETLINK_LOG_MSG_H_


16 
	#NETLINK_LOG_MSG_H_


	)

18 
	~<Ãšk/Ãšk.h
>

20 #ifdeà
__ılu¥lus


24 
Æmsghdr
;

25 
nâl_log_msg
;

27 
Æ_objeù_İs
 
log_msg_obj_İs
;

30 
nâl_log_msg
 *
nâl_log_msg_®loc
();

31 
nâlmsg_log_msg_·r£
(
Æmsghdr
 *,

32 
nâl_log_msg
 **);

34 
nâl_log_msg_g‘
(
nâl_log_msg
 *);

35 
nâl_log_msg_put
(
nâl_log_msg
 *);

37 
nâl_log_msg_£t_çmy
(
nâl_log_msg
 *, 
ušt8_t
);

38 
ušt8_t
 
nâl_log_msg_g‘_çmy
(cÚ¡ 
nâl_log_msg
 *);

40 
nâl_log_msg_£t_hw´Ùo
(
nâl_log_msg
 *, 
ušt16_t
);

41 
nâl_log_msg_‹¡_hw´Ùo
(cÚ¡ 
nâl_log_msg
 *);

42 
ušt16_t
 
nâl_log_msg_g‘_hw´Ùo
(cÚ¡ 
nâl_log_msg
 *);

44 
nâl_log_msg_£t_hook
(
nâl_log_msg
 *, 
ušt8_t
);

45 
nâl_log_msg_‹¡_hook
(cÚ¡ 
nâl_log_msg
 *);

46 
ušt8_t
 
nâl_log_msg_g‘_hook
(cÚ¡ 
nâl_log_msg
 *);

48 
nâl_log_msg_£t_m¬k
(
nâl_log_msg
 *, 
ušt32_t
);

49 
nâl_log_msg_‹¡_m¬k
(cÚ¡ 
nâl_log_msg
 *);

50 
ušt32_t
 
nâl_log_msg_g‘_m¬k
(cÚ¡ 
nâl_log_msg
 *);

52 
nâl_log_msg_£t_time¡amp
(
nâl_log_msg
 *,

53 
timev®
 *);

54 cÚ¡ 
timev®
 *
nâl_log_msg_g‘_time¡amp
(cÚ¡ 
nâl_log_msg
 *);

56 
nâl_log_msg_£t_šdev
(
nâl_log_msg
 *, 
ušt32_t
);

57 
ušt32_t
 
nâl_log_msg_g‘_šdev
(cÚ¡ 
nâl_log_msg
 *);

59 
nâl_log_msg_£t_outdev
(
nâl_log_msg
 *, 
ušt32_t
);

60 
ušt32_t
 
nâl_log_msg_g‘_outdev
(cÚ¡ 
nâl_log_msg
 *);

62 
nâl_log_msg_£t_physšdev
(
nâl_log_msg
 *, 
ušt32_t
);

63 
ušt32_t
 
nâl_log_msg_g‘_physšdev
(cÚ¡ 
nâl_log_msg
 *);

65 
nâl_log_msg_£t_physoutdev
(
nâl_log_msg
 *, 
ušt32_t
);

66 
ušt32_t
 
nâl_log_msg_g‘_physoutdev
(cÚ¡ 
nâl_log_msg
 *);

68 
nâl_log_msg_£t_hwaddr
(
nâl_log_msg
 *, 
ušt8_t
 *, );

69 cÚ¡ 
ušt8_t
 * 
nâl_log_msg_g‘_hwaddr
(cÚ¡ 
nâl_log_msg
 *, *);

71 
nâl_log_msg_£t_·ylßd
(
nâl_log_msg
 *, 
ušt8_t
 *, );

72 cÚ¡ * 
nâl_log_msg_g‘_·ylßd
(cÚ¡ 
nâl_log_msg
 *, *);

74 
nâl_log_msg_£t_´efix
(
nâl_log_msg
 *, *);

75 cÚ¡ * 
nâl_log_msg_g‘_´efix
(cÚ¡ 
nâl_log_msg
 *);

77 
nâl_log_msg_£t_uid
(
nâl_log_msg
 *, 
ušt32_t
);

78 
nâl_log_msg_‹¡_uid
(cÚ¡ 
nâl_log_msg
 *);

79 
ušt32_t
 
nâl_log_msg_g‘_uid
(cÚ¡ 
nâl_log_msg
 *);

81 
nâl_log_msg_£t_gid
(
nâl_log_msg
 *, 
ušt32_t
);

82 
nâl_log_msg_‹¡_gid
(cÚ¡ 
nâl_log_msg
 *);

83 
ušt32_t
 
nâl_log_msg_g‘_gid
(cÚ¡ 
nâl_log_msg
 *);

85 
nâl_log_msg_£t_£q
(
nâl_log_msg
 *, 
ušt32_t
);

86 
nâl_log_msg_‹¡_£q
(cÚ¡ 
nâl_log_msg
 *);

87 
ušt32_t
 
nâl_log_msg_g‘_£q
(cÚ¡ 
nâl_log_msg
 *);

89 
nâl_log_msg_£t_£q_glob®
(
nâl_log_msg
 *, 
ušt32_t
);

90 
nâl_log_msg_‹¡_£q_glob®
(cÚ¡ 
nâl_log_msg
 *);

91 
ušt32_t
 
nâl_log_msg_g‘_£q_glob®
(cÚ¡ 
nâl_log_msg
 *);

93 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/netfilter.h

12 #iâdeà
NETLINK_NETFILTER_H_


13 
	#NETLINK_NETFILTER_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 * 
nâl_v”diù2¡r
(, *, 
size_t
);

22 
nâl_¡r2v”diù
(const *);

24 * 
nâl_š‘_hook2¡r
(, *, 
size_t
);

25 
nâl_¡r2š‘_hook
(const *);

27 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/nfnl.h

14 #iâdeà
NETLINK_NFNL_H_


15 
	#NETLINK_NFNL_H_


	)

17 
	~<Ãšk/Ãšk.h
>

19 #ifdeà
__ılu¥lus


23 
	#NFNL_HDRLEN
 
	`NLMSG_ALIGN
((
nfg’msg
))

	)

24 
	#NFNLMSG_TYPE
(
subsys
, 
subty³
è(((subsysè<< 8è| (subty³))

	)

26 
nâl_cÚÃù
(
Æ_sock
 *);

28 
ušt8_t
 
nâlmsg_subsys
(
Æmsghdr
 *);

29 
ušt8_t
 
nâlmsg_subty³
(
Æmsghdr
 *);

30 
ušt8_t
 
nâlmsg_çmy
(
Æmsghdr
 *);

31 
ušt16_t
 
nâlmsg_»s_id
(
Æmsghdr
 *);

33 
nâl_£nd_sim¶e
(
Æ_sock
 *, 
ušt8_t
, uint8_t,

34 , 
ušt8_t
, 
ušt16_t
);

35 
Æ_msg
 * 
nâlmsg_®loc_sim¶e
(
ušt8_t
, uint8_t, ,

36 
ušt8_t
, 
ušt16_t
);

37 
nâlmsg_put
(
Æ_msg
 *, 
ušt32_t
, uint32_t,

38 
ušt8_t
, ušt8_t, , ušt8_t, 
ušt16_t
);

40 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/queue.h

12 #iâdeà
NETLINK_QUEUE_H_


13 
	#NETLINK_QUEUE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_sock
;

22 
Æmsghdr
;

23 
nâl_queue
;

25 
Æ_objeù_İs
 
queue_obj_İs
;

27 
	enâl_queue_cİy_mode
 {

28 
	gNFNL_QUEUE_COPY_NONE
,

29 
	gNFNL_QUEUE_COPY_META
,

30 
	gNFNL_QUEUE_COPY_PACKET
,

34 
Æ_sock
 * 
nâl_queue_sock‘_®loc
();

36 
nâl_queue
 * 
nâl_queue_®loc
();

38 
nâl_queue_g‘
(
nâl_queue
 *);

39 
nâl_queue_put
(
nâl_queue
 *);

42 
nâl_queue_£t_group
(
nâl_queue
 *, 
ušt16_t
);

43 
nâl_queue_‹¡_group
(cÚ¡ 
nâl_queue
 *);

44 
ušt16_t
 
nâl_queue_g‘_group
(cÚ¡ 
nâl_queue
 *);

46 
nâl_queue_£t_maxËn
(
nâl_queue
 *, 
ušt32_t
);

47 
nâl_queue_‹¡_maxËn
(cÚ¡ 
nâl_queue
 *);

48 
ušt32_t
 
nâl_queue_g‘_maxËn
(cÚ¡ 
nâl_queue
 *);

50 
nâl_queue_£t_cİy_mode
(
nâl_queue
 *,

51 
nâl_queue_cİy_mode
);

52 
nâl_queue_‹¡_cİy_mode
(cÚ¡ 
nâl_queue
 *);

53 
nâl_queue_cİy_mode
 
nâl_queue_g‘_cİy_mode
(cÚ¡ 
nâl_queue
 *);

55 * 
nâl_queue_cİy_mode2¡r
(
nâl_queue_cİy_mode
,

56 *, 
size_t
);

57 
nâl_queue_cİy_mode
 
nâl_queue_¡r2cİy_mode
(const *);

59 
nâl_queue_£t_cİy_¿nge
(
nâl_queue
 *,

60 
ušt32_t
);

61 
nâl_queue_‹¡_cİy_¿nge
(cÚ¡ 
nâl_queue
 *);

62 
ušt32_t
 
nâl_queue_g‘_cİy_¿nge
(cÚ¡ 
nâl_queue
 *);

64 
nâl_queue_bud_pf_bšd
(
ušt8_t
, 
Æ_msg
 **);

65 
nâl_queue_pf_bšd
(
Æ_sock
 *, 
ušt8_t
);

67 
nâl_queue_bud_pf_unbšd
(
ušt8_t
, 
Æ_msg
 **);

68 
nâl_queue_pf_unbšd
(
Æ_sock
 *, 
ušt8_t
);

70 
nâl_queue_bud_ü—‹_»que¡
(cÚ¡ 
nâl_queue
 *,

71 
Æ_msg
 **);

72 
nâl_queue_ü—‹
(
Æ_sock
 *,

73 cÚ¡ 
nâl_queue
 *);

75 
nâl_queue_bud_chªge_»que¡
(cÚ¡ 
nâl_queue
 *,

76 
Æ_msg
 **);

77 
nâl_queue_chªge
(
Æ_sock
 *,

78 cÚ¡ 
nâl_queue
 *);

80 
nâl_queue_bud_d–‘e_»que¡
(cÚ¡ 
nâl_queue
 *,

81 
Æ_msg
 **);

82 
nâl_queue_d–‘e
(
Æ_sock
 *,

83 cÚ¡ 
nâl_queue
 *);

85 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netfilter/queue_msg.h

12 #iâdeà
NETLINK_QUEUE_MSG_H_


13 
	#NETLINK_QUEUE_MSG_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 
Æ_sock
;

22 
Æmsghdr
;

23 
nâl_queue_msg
;

25 
Æ_objeù_İs
 
queue_msg_obj_İs
;

28 
nâl_queue_msg
 * 
nâl_queue_msg_®loc
();

29 
nâlmsg_queue_msg_·r£
(
Æmsghdr
 *,

30 
nâl_queue_msg
 **);

32 
nâl_queue_msg_g‘
(
nâl_queue_msg
 *);

33 
nâl_queue_msg_put
(
nâl_queue_msg
 *);

35 
nâl_queue_msg_£t_group
(
nâl_queue_msg
 *, 
ušt16_t
);

36 
nâl_queue_msg_‹¡_group
(cÚ¡ 
nâl_queue_msg
 *);

37 
ušt16_t
 
nâl_queue_msg_g‘_group
(cÚ¡ 
nâl_queue_msg
 *);

39 
nâl_queue_msg_£t_çmy
(
nâl_queue_msg
 *, 
ušt8_t
);

40 
nâl_queue_msg_‹¡_çmy
(cÚ¡ 
nâl_queue_msg
 *);

41 
ušt8_t
 
nâl_queue_msg_g‘_çmy
(cÚ¡ 
nâl_queue_msg
 *);

43 
nâl_queue_msg_£t_·ck‘id
(
nâl_queue_msg
 *, 
ušt32_t
);

44 
nâl_queue_msg_‹¡_·ck‘id
(cÚ¡ 
nâl_queue_msg
 *);

45 
ušt32_t
 
nâl_queue_msg_g‘_·ck‘id
(cÚ¡ 
nâl_queue_msg
 *);

47 
nâl_queue_msg_£t_hw´Ùo
(
nâl_queue_msg
 *, 
ušt16_t
);

48 
nâl_queue_msg_‹¡_hw´Ùo
(cÚ¡ 
nâl_queue_msg
 *);

49 
ušt16_t
 
nâl_queue_msg_g‘_hw´Ùo
(cÚ¡ 
nâl_queue_msg
 *);

51 
nâl_queue_msg_£t_hook
(
nâl_queue_msg
 *, 
ušt8_t
);

52 
nâl_queue_msg_‹¡_hook
(cÚ¡ 
nâl_queue_msg
 *);

53 
ušt8_t
 
nâl_queue_msg_g‘_hook
(cÚ¡ 
nâl_queue_msg
 *);

55 
nâl_queue_msg_£t_m¬k
(
nâl_queue_msg
 *, 
ušt32_t
);

56 
nâl_queue_msg_‹¡_m¬k
(cÚ¡ 
nâl_queue_msg
 *);

57 
ušt32_t
 
nâl_queue_msg_g‘_m¬k
(cÚ¡ 
nâl_queue_msg
 *);

59 
nâl_queue_msg_£t_time¡amp
(
nâl_queue_msg
 *,

60 
timev®
 *);

61 
nâl_queue_msg_‹¡_time¡amp
(cÚ¡ 
nâl_queue_msg
 *);

62 cÚ¡ 
timev®
 * 
nâl_queue_msg_g‘_time¡amp
(cÚ¡ 
nâl_queue_msg
 *);

64 
nâl_queue_msg_£t_šdev
(
nâl_queue_msg
 *, 
ušt32_t
);

65 
nâl_queue_msg_‹¡_šdev
(cÚ¡ 
nâl_queue_msg
 *);

66 
ušt32_t
 
nâl_queue_msg_g‘_šdev
(cÚ¡ 
nâl_queue_msg
 *);

68 
nâl_queue_msg_£t_outdev
(
nâl_queue_msg
 *, 
ušt32_t
);

69 
nâl_queue_msg_‹¡_outdev
(cÚ¡ 
nâl_queue_msg
 *);

70 
ušt32_t
 
nâl_queue_msg_g‘_outdev
(cÚ¡ 
nâl_queue_msg
 *);

72 
nâl_queue_msg_£t_physšdev
(
nâl_queue_msg
 *, 
ušt32_t
);

73 
nâl_queue_msg_‹¡_physšdev
(cÚ¡ 
nâl_queue_msg
 *);

74 
ušt32_t
 
nâl_queue_msg_g‘_physšdev
(cÚ¡ 
nâl_queue_msg
 *);

76 
nâl_queue_msg_£t_physoutdev
(
nâl_queue_msg
 *, 
ušt32_t
);

77 
nâl_queue_msg_‹¡_physoutdev
(cÚ¡ 
nâl_queue_msg
 *);

78 
ušt32_t
 
nâl_queue_msg_g‘_physoutdev
(cÚ¡ 
nâl_queue_msg
 *);

80 
nâl_queue_msg_£t_hwaddr
(
nâl_queue_msg
 *, 
ušt8_t
 *, );

81 
nâl_queue_msg_‹¡_hwaddr
(cÚ¡ 
nâl_queue_msg
 *);

82 cÚ¡ 
ušt8_t
 * 
nâl_queue_msg_g‘_hwaddr
(cÚ¡ 
nâl_queue_msg
 *, *);

84 
nâl_queue_msg_£t_·ylßd
(
nâl_queue_msg
 *, 
ušt8_t
 *, );

85 
nâl_queue_msg_‹¡_·ylßd
(cÚ¡ 
nâl_queue_msg
 *);

86 cÚ¡ * 
nâl_queue_msg_g‘_·ylßd
(cÚ¡ 
nâl_queue_msg
 *, *);

88 
nâl_queue_msg_£t_v”diù
(
nâl_queue_msg
 *,

90 
nâl_queue_msg_‹¡_v”diù
(cÚ¡ 
nâl_queue_msg
 *);

91 
nâl_queue_msg_g‘_v”diù
(cÚ¡ 
nâl_queue_msg
 *);

93 
Æ_msg
 * 
nâl_queue_msg_bud_v”diù
(cÚ¡ 
nâl_queue_msg
 *);

94 
nâl_queue_msg_£nd_v”diù
(
Æ_sock
 *,

95 cÚ¡ 
nâl_queue_msg
 *);

96 
nâl_queue_msg_£nd_v”diù_b©ch
(
Æ_sock
 *,

97 cÚ¡ 
nâl_queue_msg
 *);

98 
nâl_queue_msg_£nd_v”diù_·ylßd
(
Æ_sock
 *,

99 cÚ¡ 
nâl_queue_msg
 *,

101 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/netlink-compat.h

12 #iâdeà
NETLINK_COMPAT_H_


13 
	#NETLINK_COMPAT_H_


	)

15 #ià!
defšed
 
_LINUX_SOCKET_H
 && !defšed 
_BITS_SOCKADDR_H


16 
	t§_çmy_t
;

19 #iâdeà
IFNAMSIZ


21 
	#IFNAMSIZ
 16

	)

25 #iâdeà
ARPHRD_INFINIBAND


26 
	#ARPHRD_INFINIBAND
 32

	)

30 #iâdeà
ETH_P_MPLS_UC


31 
	#ETH_P_MPLS_UC
 0x8847

	)

34 #iâdeà
ETH_P_MPLS_MC


35 
	#ETH_P_MPLS_MC
 0x8848

	)

38 #iâdeà 
ETH_P_EDP2


39 
	#ETH_P_EDP2
 0x88A2

	)

42 #iâdeà
ETH_P_HDLC


43 
	#ETH_P_HDLC
 0x0019

	)

46 #iâdeà
AF_LLC


47 
	#AF_LLC
 26

	)

	@mylibnl/libnl-3.2.25/include/netlink/netlink-kernel.h

1 #iâdeà
__NETLINK_KERNEL_H_


2 
	#__NETLINK_KERNEL_H_


	)

16 
	ssockaddr_Æ


19 
§_çmy_t
 
	mÆ_çmy
;

22 
	mÆ_·d
;

25 
ušt32_t
 
	mÆ_pid
;

28 
ušt32_t
 
	mÆ_groups
;

40 
	sÆmsghdr


43 
ušt32_t
 
	mÆmsg_Ën
;

46 
ušt16_t
 
	mÆmsg_ty³
;

49 
ušt16_t
 
	mÆmsg_æags
;

52 
ušt32_t
 
	mÆmsg_£q
;

55 
ušt32_t
 
	mÆmsg_pid
;

67 
	#NLM_F_REQUEST
 1

	)

73 
	#NLM_F_MULTI
 2

	)

78 
	#NLM_F_ACK
 4

	)

83 
	#NLM_F_ECHO
 8

	)

95 
	#NLM_F_ROOT
 0x100

	)

100 
	#NLM_F_MATCH
 0x200

	)

107 
	#NLM_F_ATOMIC
 0x400

	)

112 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

124 
	#NLM_F_REPLACE
 0x100

	)

129 
	#NLM_F_EXCL
 0x200

	)

134 
	#NLM_F_CREATE
 0x400

	)

139 
	#NLM_F_APPEND
 0x800

	)

151 
	#NLMSG_NOOP
 0x1

	)

158 
	#NLMSG_ERROR
 0x2

	)

163 
	#NLMSG_DONE
 0x3

	)

168 
	#NLMSG_OVERRUN
 0x4

	)

173 
	#NLMSG_MIN_TYPE
 0x10

	)

180 
	sÆmsg”r


183 
	m”rÜ
;

186 
Æmsghdr
 
	mmsg
;

189 
	sÆ_pktšfo


191 
__u32
 
	mgroup
;

199 
	#NLMSG_ALIGNTO
 4

	)

206 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

213 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

237 
	sÆ©Œ
 {

241 
__u16
 
	mÆa_Ën
;

246 
__u16
 
	mÆa_ty³
;

268 
	#NLA_F_NESTED
 (1 << 15)

	)

269 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

270 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

274 
	#NLA_ALIGNTO
 4

	)

281 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

288 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@mylibnl/libnl-3.2.25/include/netlink/netlink.h

12 #iâdeà
NETLINK_NETLINK_H_


13 
	#NETLINK_NETLINK_H_


	)

15 
	~<¡dio.h
>

16 
	~<¡dšt.h
>

17 
	~<¡ršg.h
>

18 
	~<¡dlib.h
>

19 
	~<sys/pŞl.h
>

20 
	~<sys/sock‘.h
>

21 
	~<sys/ty³s.h
>

22 
	~<sys/time.h
>

23 
	~<Ãtdb.h
>

24 
	~<Ãšk/Ãšk-com·t.h
>

25 
	~<lšux/Ãšk.h
>

26 
	~<lšux/¹Ãšk.h
>

27 
	~<lšux/g’‘lšk.h
>

28 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

29 
	~<Ãtš‘/tı.h
>

30 
	~<Ãšk/v”siÚ.h
>

31 
	~<Ãšk/”ºo.h
>

32 
	~<Ãšk/ty³s.h
>

33 
	~<Ãšk/hªdËrs.h
>

34 
	~<Ãšk/sock‘.h
>

35 
	~<Ãšk/objeù.h
>

37 #ifdeà
__ılu¥lus


41 
uüed
;

42 
Æ_ÿche_İs
;

43 
Æ_·r£r_·¿m
;

44 
Æ_objeù
;

45 
Æ_sock
;

47 
Æ_debug
;

48 
Æ_dump_·¿ms
 
Æ_debug_dp
;

51 
Æ_cÚÃù
(
Æ_sock
 *, );

52 
Æ_şo£
(
Æ_sock
 *);

55 
Æ_£ndto
(
Æ_sock
 *, *, 
size_t
);

56 
Æ_£ndmsg
(
Æ_sock
 *, 
Æ_msg
 *,

57 
msghdr
 *);

58 
Æ_£nd
(
Æ_sock
 *, 
Æ_msg
 *);

59 
Æ_£nd_iovec
(
Æ_sock
 *, 
Æ_msg
 *,

60 
iovec
 *, );

61 
Æ_com¶‘e_msg
(
Æ_sock
 *,

62 
Æ_msg
 *);

63 
Æ_auto_com¶‘e
(
Æ_sock
 *,

64 
Æ_msg
 *);

65 
Æ_£nd_auto
(
Æ_sock
 *, 
Æ_msg
 *);

66 
Æ_£nd_auto_com¶‘e
(
Æ_sock
 *,

67 
Æ_msg
 *);

68 
Æ_£nd_sync
(
Æ_sock
 *, 
Æ_msg
 *);

69 
Æ_£nd_sim¶e
(
Æ_sock
 *, , ,

70 *, 
size_t
);

73 
Æ_»cv
(
Æ_sock
 *,

74 
sockaddr_Æ
 *, **,

75 
uüed
 **);

77 
Æ_»cvmsgs
(
Æ_sock
 *, 
Æ_cb
 *);

78 
Æ_»cvmsgs_»pÜt
(
Æ_sock
 *, 
Æ_cb
 *);

80 
Æ_»cvmsgs_deçuÉ
(
Æ_sock
 *);

82 
Æ_wa™_fÜ_ack
(
Æ_sock
 *);

84 
Æ_pickup
(
Æ_sock
 *,

85 (*
·r£r
)(
Æ_ÿche_İs
 *,

86 
sockaddr_Æ
 *,

87 
Æmsghdr
 *,

88 
Æ_·r£r_·¿m
 *),

89 
Æ_objeù
 **);

91 * 
Æ_Æçmy2¡r
(, *, 
size_t
);

92 
Æ_¡r2Æçmy
(const *);

94 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/object-api.h

12 #iâdeà
NETLINK_DUMMY_OBJECT_API_H_


13 
	#NETLINK_DUMMY_OBJECT_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/uts.h
>

17 
	~<Ãšk/objeù.h
>

	@mylibnl/libnl-3.2.25/include/netlink/object.h

12 #iâdeà
NETLINK_OBJECT_H_


13 
	#NETLINK_OBJECT_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/uts.h
>

18 #ifdeà
__ılu¥lus


22 
Æ_ÿche
;

23 
Æ_objeù
;

24 
Æ_objeù_İs
;

26 
	#OBJ_CAST
(
±r
è((
Æ_objeù
 *èÕŒ))

	)

29 
Æ_objeù
 * 
Æ_objeù_®loc
(
Æ_objeù_İs
 *);

30 
Æ_objeù_®loc_Çme
(const *,

31 
Æ_objeù
 **);

32 
Æ_objeù_ä“
(
Æ_objeù
 *);

33 
Æ_objeù
 * 
Æ_objeù_şÚe
(Æ_objeù *
obj
);

34 
Æ_objeù_upd©e
(
Æ_objeù
 *
d¡
,

35 
Æ_objeù
 *
¤c
);

36 
Æ_objeù_g‘
(
Æ_objeù
 *);

37 
Æ_objeù_put
(
Æ_objeù
 *);

38 
Æ_objeù_sh¬ed
(
Æ_objeù
 *);

39 
Æ_objeù_dump
(
Æ_objeù
 *,

40 
Æ_dump_·¿ms
 *);

41 
Æ_objeù_dump_buf
(
Æ_objeù
 *, *, 
size_t
);

42 
Æ_objeù_id’tiÿl
(
Æ_objeù
 *,

43 
Æ_objeù
 *);

44 
ušt32_t
 
Æ_objeù_diff
(
Æ_objeù
 *,

45 
Æ_objeù
 *);

46 
Æ_objeù_m©ch_f‹r
(
Æ_objeù
 *,

47 
Æ_objeù
 *);

48 * 
Æ_objeù_©Œs2¡r
(
Æ_objeù
 *,

49 
ušt32_t
 
©Œs
, *
buf
,

50 
size_t
);

51 * 
Æ_objeù_©Œ_li¡
(
Æ_objeù
 *,

52 *, 
size_t
);

53 
Æ_objeù_keyg’
(
Æ_objeù
 *,

54 
ušt32_t
 *, uint32_t);

57 
Æ_objeù_m¬k
(
Æ_objeù
 *);

58 
Æ_objeù_unm¬k
(
Æ_objeù
 *);

59 
Æ_objeù_is_m¬ked
(
Æ_objeù
 *);

62 
Æ_objeù_g‘_»fút
(
Æ_objeù
 *);

63 
Æ_ÿche
 * 
Æ_objeù_g‘_ÿche
(
Æ_objeù
 *);

64 cÚ¡ * 
Æ_objeù_g‘_ty³
(cÚ¡ 
Æ_objeù
 *);

65 
Æ_objeù_g‘_msgty³
(cÚ¡ 
Æ_objeù
 *);

66 
Æ_objeù_İs
 * 
Æ_objeù_g‘_İs
(cÚ¡ 
Æ_objeù
 *);

67 
ušt32_t
 
Æ_objeù_g‘_id_©Œs
(
Æ_objeù
 *
obj
);

70 
šlše
 * 
Æ_objeù_´iv
(
Æ_objeù
 *
obj
)

72  
	gobj
;

76 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/act/mirred.h

12 #iâdeà
NETLINK_MIRRED_H_


13 
	#NETLINK_MIRRED_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/aùiÚ.h
>

18 
	~<lšux/tc_aù/tc_mœ»d.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_mœ»d_£t_aùiÚ
(
¹Æ_aù
 *, );

25 
¹Æ_mœ»d_g‘_aùiÚ
(
¹Æ_aù
 *);

26 
¹Æ_mœ»d_£t_ifšdex
(
¹Æ_aù
 *, 
ušt32_t
);

27 
ušt32_t
 
¹Æ_mœ»d_g‘_ifšdex
(
¹Æ_aù
 *);

28 
¹Æ_mœ»d_£t_pŞicy
(
¹Æ_aù
 *, );

29 
¹Æ_mœ»d_g‘_pŞicy
(
¹Æ_aù
 *);

31 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/action.h

12 #iâdeà
NETLINK_ACTION_H_


13 
	#NETLINK_ACTION_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/tc.h
>

18 
	~<Ãšk/uts.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_aù
 *
¹Æ_aù_®loc
();

25 
¹Æ_aù_g‘
(
¹Æ_aù
 *);

26 
¹Æ_aù_put
(
¹Æ_aù
 *);

27 
¹Æ_aù_bud_add_»que¡
(
¹Æ_aù
 *, ,

28 
Æ_msg
 **);

29 
¹Æ_aù_add
(
Æ_sock
 *, 
¹Æ_aù
 *, );

31 
¹Æ_aù_bud_chªge_»que¡
(
¹Æ_aù
 *, ,

32 
Æ_msg
 **);

33 
¹Æ_aù_bud_d–‘e_»que¡
(
¹Æ_aù
 *, ,

34 
Æ_msg
 **);

35 
¹Æ_aù_d–‘e
(
Æ_sock
 *, 
¹Æ_aù
 *,

37 
¹Æ_aù_­³nd
(
¹Æ_aù
 **, rtnl_act *);

38 
¹Æ_aù_»move
(
¹Æ_aù
 **, rtnl_act *);

39 
¹Æ_aù_fl
(
Æ_msg
 *, , 
¹Æ_aù
 *);

40 
¹Æ_aù_put_®l
(
¹Æ_aù
 **);

41 
¹Æ_aù_·r£
(
¹Æ_aù
 **, 
Æ©Œ
 *);

42 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/addr.h

14 #iâdeà
NETADDR_ADDR_H_


15 
	#NETADDR_ADDR_H_


	)

17 
	~<Ãšk/Ãšk.h
>

18 
	~<Ãšk/ÿche.h
>

19 
	~<Ãšk/addr.h
>

20 
	~<Ãšk/rou‹/lšk.h
>

22 #ifdeà
__ılu¥lus


26 
¹Æ_addr
;

29 
¹Æ_addr
 *
¹Æ_addr_®loc
();

30 
¹Æ_addr_put
(
¹Æ_addr
 *);

32 
¹Æ_addr_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

33 
¹Æ_addr
 *

34 
¹Æ_addr_g‘
(
Æ_ÿche
 *, , 
Æ_addr
 *);

36 
¹Æ_addr_bud_add_»que¡
(
¹Æ_addr
 *, ,

37 
Æ_msg
 **);

38 
¹Æ_addr_add
(
Æ_sock
 *, 
¹Æ_addr
 *, );

40 
¹Æ_addr_bud_d–‘e_»que¡
(
¹Æ_addr
 *, ,

41 
Æ_msg
 **);

42 
¹Æ_addr_d–‘e
(
Æ_sock
 *,

43 
¹Æ_addr
 *, );

45 * 
¹Æ_addr_æags2¡r
(, *, 
size_t
);

46 
¹Æ_addr_¡r2æags
(const *);

48 
¹Æ_addr_£t_Ïb–
(
¹Æ_addr
 *, const *);

49 * 
¹Æ_addr_g‘_Ïb–
(
¹Æ_addr
 *);

51 
¹Æ_addr_£t_ifšdex
(
¹Æ_addr
 *, );

52 
¹Æ_addr_g‘_ifšdex
(
¹Æ_addr
 *);

54 
¹Æ_addr_£t_lšk
(
¹Æ_addr
 *, 
¹Æ_lšk
 *);

55 
¹Æ_lšk
 *

56 
¹Æ_addr_g‘_lšk
(
¹Æ_addr
 *);

58 
¹Æ_addr_£t_çmy
(
¹Æ_addr
 *, );

59 
¹Æ_addr_g‘_çmy
(
¹Æ_addr
 *);

61 
¹Æ_addr_£t_´efixËn
(
¹Æ_addr
 *, );

62 
¹Æ_addr_g‘_´efixËn
(
¹Æ_addr
 *);

64 
¹Æ_addr_£t_scİe
(
¹Æ_addr
 *, );

65 
¹Æ_addr_g‘_scİe
(
¹Æ_addr
 *);

67 
¹Æ_addr_£t_æags
(
¹Æ_addr
 *, );

68 
¹Æ_addr_un£t_æags
(
¹Æ_addr
 *, );

69 
¹Æ_addr_g‘_æags
(
¹Æ_addr
 *);

71 
¹Æ_addr_£t_loÿl
(
¹Æ_addr
 *,

72 
Æ_addr
 *);

73 
Æ_addr
 *
¹Æ_addr_g‘_loÿl
(
¹Æ_addr
 *);

75 
¹Æ_addr_£t_³”
(
¹Æ_addr
 *, 
Æ_addr
 *);

76 
Æ_addr
 *
¹Æ_addr_g‘_³”
(
¹Æ_addr
 *);

78 
¹Æ_addr_£t_brßdÿ¡
(
¹Æ_addr
 *, 
Æ_addr
 *);

79 
Æ_addr
 *
¹Æ_addr_g‘_brßdÿ¡
(
¹Æ_addr
 *);

81 
¹Æ_addr_£t_muÉiÿ¡
(
¹Æ_addr
 *, 
Æ_addr
 *);

82 
Æ_addr
 *
¹Æ_addr_g‘_muÉiÿ¡
(
¹Æ_addr
 *);

84 
¹Æ_addr_£t_ªyÿ¡
(
¹Æ_addr
 *, 
Æ_addr
 *);

85 
Æ_addr
 *
¹Æ_addr_g‘_ªyÿ¡
(
¹Æ_addr
 *);

87 
ušt32_t
 
¹Æ_addr_g‘_v®id_liãtime
(
¹Æ_addr
 *);

88 
¹Æ_addr_£t_v®id_liãtime
(
¹Æ_addr
 *, 
ušt32_t
);

89 
ušt32_t
 
¹Æ_addr_g‘_´eã¼ed_liãtime
(
¹Æ_addr
 *);

90 
¹Æ_addr_£t_´eã¼ed_liãtime
(
¹Æ_addr
 *, 
ušt32_t
);

91 
ušt32_t
 
¹Æ_addr_g‘_ü—‹_time
(
¹Æ_addr
 *);

92 
ušt32_t
 
¹Æ_addr_g‘_Ï¡_upd©e_time
(
¹Æ_addr
 *);

94 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/class.h

12 #iâdeà
NETLINK_CLASS_H_


13 
	#NETLINK_CLASS_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/tc.h
>

17 
	~<Ãšk/rou‹/qdisc.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_şass
;

25 
¹Æ_şass
 *

26 
¹Æ_şass_®loc
();

27 
¹Æ_şass_put
(
¹Æ_şass
 *);

29 
¹Æ_şass_®loc_ÿche
(
Æ_sock
 *, ,

30 
Æ_ÿche
 **);

31 
¹Æ_şass
 *

32 
¹Æ_şass_g‘
(
Æ_ÿche
 *, , 
ušt32_t
);

34 
¹Æ_qdisc
 *

35 
¹Æ_şass_Ëaf_qdisc
(
¹Æ_şass
 *,

36 
Æ_ÿche
 *);

38 
¹Æ_şass_bud_add_»que¡
(
¹Æ_şass
 *, ,

39 
Æ_msg
 **);

40 
¹Æ_şass_add
(
Æ_sock
 *, 
¹Æ_şass
 *,

43 
¹Æ_şass_bud_d–‘e_»que¡
(
¹Æ_şass
 *,

44 
Æ_msg
 **);

45 
¹Æ_şass_d–‘e
(
Æ_sock
 *,

46 
¹Æ_şass
 *);

49 
¹Æ_şass_fÜ—ch_chd
(
¹Æ_şass
 *,

50 
Æ_ÿche
 *,

51 (*
cb
)(
Æ_objeù
 *,

54 
__©Œibu‹__
((
d•»ÿ‹d
));

55 
¹Æ_şass_fÜ—ch_şs
(
¹Æ_şass
 *,

56 
Æ_ÿche
 *,

57 (*
cb
)(
Æ_objeù
 *,

60 
__©Œibu‹__
((
d•»ÿ‹d
));

62 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/classifier.h

12 #iâdeà
NETLINK_CLASSIFIER_H_


13 
	#NETLINK_CLASSIFIER_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/tc.h
>

18 
	~<Ãšk/uts.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_şs
 *
¹Æ_şs_®loc
();

25 
¹Æ_şs_put
(
¹Æ_şs
 *);

27 
¹Æ_şs_®loc_ÿche
(
Æ_sock
 *, , 
ušt32_t
,

28 
Æ_ÿche
 **);

30 
¹Æ_şs_bud_add_»que¡
(
¹Æ_şs
 *, ,

31 
Æ_msg
 **);

32 
¹Æ_şs_add
(
Æ_sock
 *, 
¹Æ_şs
 *, );

33 
¹Æ_şs_chªge
(
Æ_sock
 *, 
¹Æ_şs
 *, );

35 
¹Æ_şs_bud_chªge_»que¡
(
¹Æ_şs
 *, ,

36 
Æ_msg
 **);

37 
¹Æ_şs_bud_d–‘e_»que¡
(
¹Æ_şs
 *, ,

38 
Æ_msg
 **);

39 
¹Æ_şs_d–‘e
(
Æ_sock
 *, 
¹Æ_şs
 *,

42 
¹Æ_şs_£t_´io
(
¹Æ_şs
 *, 
ušt16_t
);

43 
ušt16_t
 
¹Æ_şs_g‘_´io
(
¹Æ_şs
 *);

45 
¹Æ_şs_£t_´ÙocŞ
(
¹Æ_şs
 *, 
ušt16_t
);

46 
ušt16_t
 
¹Æ_şs_g‘_´ÙocŞ
(
¹Æ_şs
 *);

48 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/basic.h

12 #iâdeà
NETLINK_BASIC_H_


13 
	#NETLINK_BASIC_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şassif›r.h
>

17 
	~<Ãšk/rou‹/şs/em©ch.h
>

18 
	~<Ãšk/rou‹/aùiÚ.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_basic_£t_rg‘
(
¹Æ_şs
 *, 
ušt32_t
);

25 
ušt32_t
 
¹Æ_basic_g‘_rg‘
(
¹Æ_şs
 *);

26 
¹Æ_basic_£t_em©ch
(
¹Æ_şs
 *,

27 
¹Æ_em©ch_Œ“
 *);

28 
¹Æ_em©ch_Œ“
 *
¹Æ_basic_g‘_em©ch
(
¹Æ_şs
 *);

29 
¹Æ_basic_add_aùiÚ
(
¹Æ_şs
 *, 
¹Æ_aù
 *);

30 
¹Æ_basic_d–_aùiÚ
(
¹Æ_şs
 *, 
¹Æ_aù
 *);

32 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/cgroup.h

12 #iâdeà
NETLINK_CLS_CGROUP_H_


13 
	#NETLINK_CLS_CGROUP_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/şassif›r.h
>

18 
	~<Ãšk/rou‹/şs/em©ch.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_cgroup_£t_em©ch
(
¹Æ_şs
 *,

25 
¹Æ_em©ch_Œ“
 *);

26 
¹Æ_em©ch_Œ“
 * 
¹Æ_cgroup_g‘_em©ch
(
¹Æ_şs
 *);

28 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch.h

12 #iâdeà
NETLINK_CLS_EMATCH_H_


13 
	#NETLINK_CLS_EMATCH_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/msg.h
>

17 
	~<Ãšk/rou‹/şassif›r.h
>

18 
	~<lšux/pkt_şs.h
>

20 #ifdeà
__ılu¥lus


25 
	#RTNL_EMATCH_PROGID
 2

	)

27 
¹Æ_em©ch
;

28 
¹Æ_em©ch_Œ“
;

33 
	s¹Æ_em©ch_İs


35 
eo_kšd
;

36 cÚ¡ * 
eo_Çme
;

37 
size_t
 
eo_mšËn
;

38 
size_t
 
eo_d©®’
;

40 (*
eo_·r£
)(
¹Æ_em©ch
 *, *, 
size_t
);

41 (*
eo_dump
)(
¹Æ_em©ch
 *,

42 
Æ_dump_·¿ms
 *);

43 (*
eo_fl
)(
¹Æ_em©ch
 *, 
Æ_msg
 *);

44 (*
eo_ä“
)(
¹Æ_em©ch
 *);

45 
Æ_li¡_h—d
 
eo_li¡
;

48 
¹Æ_em©ch_»gi¡”
(
¹Æ_em©ch_İs
 *);

49 
¹Æ_em©ch_İs
 * 
¹Æ_em©ch_lookup_İs
();

50 
¹Æ_em©ch_İs
 * 
¹Æ_em©ch_lookup_İs_by_Çme
(const *);

52 
¹Æ_em©ch
 * 
¹Æ_em©ch_®loc
();

53 
¹Æ_em©ch_add_chd
(
¹Æ_em©ch
 *,

54 
¹Æ_em©ch
 *);

55 
¹Æ_em©ch_uÆšk
(
¹Æ_em©ch
 *);

56 
¹Æ_em©ch_ä“
(
¹Æ_em©ch
 *);

58 * 
¹Æ_em©ch_d©a
(
¹Æ_em©ch
 *);

59 
¹Æ_em©ch_£t_æags
(
¹Æ_em©ch
 *,

60 
ušt16_t
);

61 
¹Æ_em©ch_un£t_æags
(
¹Æ_em©ch
 *,

62 
ušt16_t
);

63 
ušt16_t
 
¹Æ_em©ch_g‘_æags
(
¹Æ_em©ch
 *);

64 
¹Æ_em©ch_£t_İs
(
¹Æ_em©ch
 *,

65 
¹Æ_em©ch_İs
 *);

66 
¹Æ_em©ch_£t_kšd
(
¹Æ_em©ch
 *,

67 
ušt16_t
);

68 
¹Æ_em©ch_£t_Çme
(
¹Æ_em©ch
 *,

71 
¹Æ_em©ch_Œ“
 *
¹Æ_em©ch_Œ“_®loc
(
ušt16_t
);

72 
¹Æ_em©ch_Œ“_ä“
(
¹Æ_em©ch_Œ“
 *);

73 
¹Æ_em©ch_Œ“_add
(
¹Æ_em©ch_Œ“
 *,

74 
¹Æ_em©ch
 *);

76 
¹Æ_em©ch_·r£_©Œ
(
Æ©Œ
 *,

77 
¹Æ_em©ch_Œ“
 **);

78 
¹Æ_em©ch_fl_©Œ
(
Æ_msg
 *, ,

79 
¹Æ_em©ch_Œ“
 *);

80 
¹Æ_em©ch_Œ“_dump
(
¹Æ_em©ch_Œ“
 *,

81 
Æ_dump_·¿ms
 *);

84 
¹Æ_em©ch_·r£_ex´
(const *, **,

85 
¹Æ_em©ch_Œ“
 **);

87 * 
¹Æ_em©ch_off£t2txt
(
ušt8_t
, 
ušt16_t
,

88 *, 
size_t
);

89 * 
¹Æ_em©ch_İnd2txt
(
ušt8_t
, *, 
size_t
);

91 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/cmp.h

12 #iâdeà
NETLINK_CLS_EMATCH_CMP_H_


13 
	#NETLINK_CLS_EMATCH_CMP_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
	~<lšux/tc_em©ch/tc_em_cmp.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_em©ch_cmp_£t
(
¹Æ_em©ch
 *,

24 
tcf_em_cmp
 *);

25 
tcf_em_cmp
 *

26 
¹Æ_em©ch_cmp_g‘
(
¹Æ_em©ch
 *);

28 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/meta.h

12 #iâdeà
NETLINK_CLS_EMATCH_META_H_


13 
	#NETLINK_CLS_EMATCH_META_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
	~<lšux/tc_em©ch/tc_em_m‘a.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_m‘a_v®ue
;

25 
¹Æ_m‘a_v®ue
 * 
¹Æ_m‘a_v®ue_®loc_št
(
ušt64_t
);

26 
¹Æ_m‘a_v®ue
 * 
¹Æ_m‘a_v®ue_®loc_v¬
(*, 
size_t
);

27 
¹Æ_m‘a_v®ue
 * 
¹Æ_m‘a_v®ue_®loc_id
(
ušt8_t
, 
ušt16_t
,

28 
ušt8_t
, 
ušt64_t
);

29 
¹Æ_m‘a_v®ue_put
(
¹Æ_m‘a_v®ue
 *);

31 
¹Æ_em©ch_m‘a_£t_lv®ue
(
¹Æ_em©ch
 *,

32 
¹Æ_m‘a_v®ue
 *);

33 
¹Æ_em©ch_m‘a_£t_rv®ue
(
¹Æ_em©ch
 *,

34 
¹Æ_m‘a_v®ue
 *);

35 
¹Æ_em©ch_m‘a_£t_İ”ªd
(
¹Æ_em©ch
 *, 
ušt8_t
);

37 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/nbyte.h

12 #iâdeà
NETLINK_CLS_EMATCH_NBYTE_H_


13 
	#NETLINK_CLS_EMATCH_NBYTE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
	~<lšux/tc_em©ch/tc_em_nby‹.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_em©ch_nby‹_£t_off£t
(
¹Æ_em©ch
 *,

24 
ušt8_t
, 
ušt16_t
);

25 
ušt16_t
 
¹Æ_em©ch_nby‹_g‘_off£t
(
¹Æ_em©ch
 *);

26 
ušt8_t
 
¹Æ_em©ch_nby‹_g‘_Ïy”
(
¹Æ_em©ch
 *);

27 
¹Æ_em©ch_nby‹_£t_·‰”n
(
¹Æ_em©ch
 *,

28 
ušt8_t
 *, 
size_t
);

29 
ušt8_t
 * 
¹Æ_em©ch_nby‹_g‘_·‰”n
(
¹Æ_em©ch
 *);

30 
size_t
 
¹Æ_em©ch_nby‹_g‘_Ën
(
¹Æ_em©ch
 *);

32 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/text.h

12 #iâdeà
NETLINK_CLS_EMATCH_TEXT_H_


13 
	#NETLINK_CLS_EMATCH_TEXT_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
	~<lšux/tc_em©ch/tc_em_‹xt.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_em©ch_‹xt_£t_äom
(
¹Æ_em©ch
 *,

24 
ušt8_t
, 
ušt16_t
);

25 
ušt16_t
 
¹Æ_em©ch_‹xt_g‘_äom_off£t
(
¹Æ_em©ch
 *);

26 
ušt8_t
 
¹Æ_em©ch_‹xt_g‘_äom_Ïy”
(
¹Æ_em©ch
 *);

27 
¹Æ_em©ch_‹xt_£t_to
(
¹Æ_em©ch
 *,

28 
ušt8_t
, 
ušt16_t
);

29 
ušt16_t
 
¹Æ_em©ch_‹xt_g‘_to_off£t
(
¹Æ_em©ch
 *);

30 
ušt8_t
 
¹Æ_em©ch_‹xt_g‘_to_Ïy”
(
¹Æ_em©ch
 *);

31 
¹Æ_em©ch_‹xt_£t_·‰”n
(
¹Æ_em©ch
 *,

32 *, 
size_t
);

33 * 
¹Æ_em©ch_‹xt_g‘_·‰”n
(
¹Æ_em©ch
 *);

34 
size_t
 
¹Æ_em©ch_‹xt_g‘_Ën
(
¹Æ_em©ch
 *);

35 
¹Æ_em©ch_‹xt_£t_®go
(
¹Æ_em©ch
 *, const *);

36 * 
¹Æ_em©ch_‹xt_g‘_®go
(
¹Æ_em©ch
 *);

38 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/fw.h

14 #iâdeà
NETLINK_FW_H_


15 
	#NETLINK_FW_H_


	)

17 
	~<Ãšk/Ãšk.h
>

18 
	~<Ãšk/rou‹/şassif›r.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_fw_£t_şassid
(
¹Æ_şs
 *, 
ušt32_t
);

25 
¹Æ_fw_£t_mask
(
¹Æ_şs
 *, 
ušt32_t
);

27 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/police.h

12 #iâdeà
NETLINK_CLS_POLICE_H_


13 
	#NETLINK_CLS_POLICE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

18 #ifdeà
__ılu¥lus


22 * 
Æ_pŞiû2¡r
(, *, 
size_t
);

23 
Æ_¡r2pŞiû
(const *);

25 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/cls/u32.h

12 #iâdeà
NETLINK_U32_H_


13 
	#NETLINK_U32_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/şassif›r.h
>

18 
	~<Ãšk/rou‹/aùiÚ.h
>

20 #ifdeà
__ılu¥lus


24 
¹Æ_u32_£t_hªdË
(
¹Æ_şs
 *, , , );

25 
¹Æ_u32_£t_şassid
(
¹Æ_şs
 *, 
ušt32_t
);

26 
¹Æ_u32_£t_divisÜ
(
¹Æ_şs
 *, 
ušt32_t
);

27 
¹Æ_u32_£t_lšk
(
¹Æ_şs
 *, 
ušt32_t
);

28 
¹Æ_u32_£t_hashbË
(
¹Æ_şs
 *, 
ušt32_t
);

29 
¹Æ_u32_£t_hashmask
(
¹Æ_şs
 *, 
ušt32_t
, uint32_t);

30 
¹Æ_u32_£t_şs_‹rmš®
(
¹Æ_şs
 *);

32 
¹Æ_u32_£t_æags
(
¹Æ_şs
 *, );

33 
¹Æ_u32_add_key
(
¹Æ_şs
 *, 
ušt32_t
, uint32_t,

35 
¹Æ_u32_g‘_key
(
¹Æ_şs
 *, 
ušt8_t
, 
ušt32_t
 *, uint32_t *,

37 
¹Æ_u32_add_key_ušt8
(
¹Æ_şs
 *, 
ušt8_t
, uint8_t,

39 
¹Æ_u32_add_key_ušt16
(
¹Æ_şs
 *, 
ušt16_t
, uint16_t,

41 
¹Æ_u32_add_key_ušt32
(
¹Æ_şs
 *, 
ušt32_t
, uint32_t,

43 
¹Æ_u32_add_key_š_addr
(
¹Æ_şs
 *, cÚ¡ 
š_addr
 *,

44 
ušt8_t
, , );

45 
¹Æ_u32_add_key_š6_addr
(
¹Æ_şs
 *, cÚ¡ 
š6_addr
 *,

46 
ušt8_t
, , );

47 
¹Æ_u32_add_aùiÚ
(
¹Æ_şs
 *, 
¹Æ_aù
 *);

48 
¹Æ_u32_d–_aùiÚ
(
¹Æ_şs
 *, 
¹Æ_aù
 *);

50 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link.h

12 #iâdeà
NETLINK_LINK_H_


13 
	#NETLINK_LINK_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

18 
	~<lšux/if.h
>

19 
	~<sys/ty³s.h
>

21 #ifdeà
__ılu¥lus


33 
¹Æ_lšk
;

39 
RTNL_LINK_RX_PACKETS
,

40 
RTNL_LINK_TX_PACKETS
,

41 
RTNL_LINK_RX_BYTES
,

42 
RTNL_LINK_TX_BYTES
,

43 
RTNL_LINK_RX_ERRORS
,

44 
RTNL_LINK_TX_ERRORS
,

45 
RTNL_LINK_RX_DROPPED
,

46 
RTNL_LINK_TX_DROPPED
,

47 
RTNL_LINK_RX_COMPRESSED
,

48 
RTNL_LINK_TX_COMPRESSED
,

49 
RTNL_LINK_RX_FIFO_ERR
,

50 
RTNL_LINK_TX_FIFO_ERR
,

51 
RTNL_LINK_RX_LEN_ERR
,

52 
RTNL_LINK_RX_OVER_ERR
,

53 
RTNL_LINK_RX_CRC_ERR
,

54 
RTNL_LINK_RX_FRAME_ERR
,

55 
RTNL_LINK_RX_MISSED_ERR
,

56 
RTNL_LINK_TX_ABORT_ERR
,

57 
RTNL_LINK_TX_CARRIER_ERR
,

58 
RTNL_LINK_TX_HBEAT_ERR
,

59 
RTNL_LINK_TX_WIN_ERR
,

60 
RTNL_LINK_COLLISIONS
,

61 
RTNL_LINK_MULTICAST
,

62 
RTNL_LINK_IP6_INPKTS
,

63 
RTNL_LINK_IP6_INHDRERRORS
,

64 
RTNL_LINK_IP6_INTOOBIGERRORS
,

65 
RTNL_LINK_IP6_INNOROUTES
,

66 
RTNL_LINK_IP6_INADDRERRORS
,

67 
RTNL_LINK_IP6_INUNKNOWNPROTOS
,

68 
RTNL_LINK_IP6_INTRUNCATEDPKTS
,

69 
RTNL_LINK_IP6_INDISCARDS
,

70 
RTNL_LINK_IP6_INDELIVERS
,

71 
RTNL_LINK_IP6_OUTFORWDATAGRAMS
,

72 
RTNL_LINK_IP6_OUTPKTS
,

73 
RTNL_LINK_IP6_OUTDISCARDS
,

74 
RTNL_LINK_IP6_OUTNOROUTES
,

75 
RTNL_LINK_IP6_REASMTIMEOUT
,

76 
RTNL_LINK_IP6_REASMREQDS
,

77 
RTNL_LINK_IP6_REASMOKS
,

78 
RTNL_LINK_IP6_REASMFAILS
,

79 
RTNL_LINK_IP6_FRAGOKS
,

80 
RTNL_LINK_IP6_FRAGFAILS
,

81 
RTNL_LINK_IP6_FRAGCREATES
,

82 
RTNL_LINK_IP6_INMCASTPKTS
,

83 
RTNL_LINK_IP6_OUTMCASTPKTS
,

84 
RTNL_LINK_IP6_INBCASTPKTS
,

85 
RTNL_LINK_IP6_OUTBCASTPKTS
,

86 
RTNL_LINK_IP6_INOCTETS
,

87 
RTNL_LINK_IP6_OUTOCTETS
,

88 
RTNL_LINK_IP6_INMCASTOCTETS
,

89 
RTNL_LINK_IP6_OUTMCASTOCTETS
,

90 
RTNL_LINK_IP6_INBCASTOCTETS
,

91 
RTNL_LINK_IP6_OUTBCASTOCTETS
,

92 
RTNL_LINK_ICMP6_INMSGS
,

93 
RTNL_LINK_ICMP6_INERRORS
,

94 
RTNL_LINK_ICMP6_OUTMSGS
,

95 
RTNL_LINK_ICMP6_OUTERRORS
,

96 
RTNL_LINK_ICMP6_CSUMERRORS
,

97 
RTNL_LINK_IP6_CSUMERRORS
,

98 
RTNL_LINK_IP6_NOECTPKTS
,

99 
RTNL_LINK_IP6_ECT1PKTS
,

100 
RTNL_LINK_IP6_ECT0PKTS
,

101 
RTNL_LINK_IP6_CEPKTS
,

102 
__RTNL_LINK_STATS_MAX
,

103 } 
	t¹Æ_lšk_¡©_id_t
;

105 
	#RTNL_LINK_STATS_MAX
 (
__RTNL_LINK_STATS_MAX
 - 1)

	)

107 
Æa_pŞicy
 
¹Ê_lšk_pŞicy
[];

109 
¹Æ_lšk
 *
¹Æ_lšk_®loc
();

110 
¹Æ_lšk_put
(
¹Æ_lšk
 *);

112 
¹Æ_lšk_®loc_ÿche
(
Æ_sock
 *, , 
Æ_ÿche
 **);

113 
¹Æ_lšk
 *
¹Æ_lšk_g‘
(
Æ_ÿche
 *, );

114 
¹Æ_lšk
 *
¹Æ_lšk_g‘_by_Çme
(
Æ_ÿche
 *, const *);

117 
¹Æ_lšk_bud_add_»que¡
(
¹Æ_lšk
 *, ,

118 
Æ_msg
 **);

119 
¹Æ_lšk_add
(
Æ_sock
 *, 
¹Æ_lšk
 *, );

120 
¹Æ_lšk_bud_chªge_»que¡
(
¹Æ_lšk
 *,

121 
¹Æ_lšk
 *, ,

122 
Æ_msg
 **);

123 
¹Æ_lšk_chªge
(
Æ_sock
 *, 
¹Æ_lšk
 *,

124 
¹Æ_lšk
 *, );

126 
¹Æ_lšk_bud_d–‘e_»que¡
(cÚ¡ 
¹Æ_lšk
 *,

127 
Æ_msg
 **);

128 
¹Æ_lšk_d–‘e
(
Æ_sock
 *, cÚ¡ 
¹Æ_lšk
 *);

129 
¹Æ_lšk_bud_g‘_»que¡
(, const *,

130 
Æ_msg
 **);

131 
¹Æ_lšk_g‘_k”Ãl
(
Æ_sock
 *, , const *,

132 
¹Æ_lšk
 **);

135 * 
¹Æ_lšk_i2Çme
(
Æ_ÿche
 *, , *, 
size_t
);

136 
¹Æ_lšk_Çme2i
(
Æ_ÿche
 *, const *);

139 * 
¹Æ_lšk_¡©2¡r
(, *, 
size_t
);

140 
¹Æ_lšk_¡r2¡©
(const *);

143 * 
¹Æ_lšk_æags2¡r
(, *, 
size_t
);

144 
¹Æ_lšk_¡r2æags
(const *);

146 * 
¹Æ_lšk_İ”¡©e2¡r
(
ušt8_t
, *, 
size_t
);

147 
¹Æ_lšk_¡r2İ”¡©e
(const *);

149 * 
¹Æ_lšk_mode2¡r
(
ušt8_t
, *, 
size_t
);

150 
¹Æ_lšk_¡r2mode
(const *);

153 * 
¹Æ_lšk_ÿ¼›r2¡r
(
ušt8_t
, *, 
size_t
);

154 
¹Æ_lšk_¡r2ÿ¼›r
(const *);

157 
¹Æ_lšk_£t_qdisc
(
¹Æ_lšk
 *, const *);

158 * 
¹Æ_lšk_g‘_qdisc
(
¹Æ_lšk
 *);

160 
¹Æ_lšk_£t_Çme
(
¹Æ_lšk
 *, const *);

161 * 
¹Æ_lšk_g‘_Çme
(
¹Æ_lšk
 *);

163 
¹Æ_lšk_£t_group
(
¹Æ_lšk
 *, 
ušt32_t
);

164 
ušt32_t
 
¹Æ_lšk_g‘_group
(
¹Æ_lšk
 *);

166 
¹Æ_lšk_£t_æags
(
¹Æ_lšk
 *, );

167 
¹Æ_lšk_un£t_æags
(
¹Æ_lšk
 *, );

168 
¹Æ_lšk_g‘_æags
(
¹Æ_lšk
 *);

170 
¹Æ_lšk_£t_mtu
(
¹Æ_lšk
 *, );

171 
¹Æ_lšk_g‘_mtu
(
¹Æ_lšk
 *);

173 
¹Æ_lšk_£t_txqËn
(
¹Æ_lšk
 *, );

174 
¹Æ_lšk_g‘_txqËn
(
¹Æ_lšk
 *);

176 
¹Æ_lšk_£t_ifšdex
(
¹Æ_lšk
 *, );

177 
¹Æ_lšk_g‘_ifšdex
(
¹Æ_lšk
 *);

179 
¹Æ_lšk_£t_çmy
(
¹Æ_lšk
 *, );

180 
¹Æ_lšk_g‘_çmy
(
¹Æ_lšk
 *);

182 
¹Æ_lšk_£t_¬±y³
(
¹Æ_lšk
 *, );

183 
¹Æ_lšk_g‘_¬±y³
(
¹Æ_lšk
 *);

185 
¹Æ_lšk_£t_addr
(
¹Æ_lšk
 *, 
Æ_addr
 *);

186 
Æ_addr
 *
¹Æ_lšk_g‘_addr
(
¹Æ_lšk
 *);

188 
¹Æ_lšk_£t_brßdÿ¡
(
¹Æ_lšk
 *, 
Æ_addr
 *);

189 
Æ_addr
 *
¹Æ_lšk_g‘_brßdÿ¡
(
¹Æ_lšk
 *);

191 
¹Æ_lšk_£t_lšk
(
¹Æ_lšk
 *, );

192 
¹Æ_lšk_g‘_lšk
(
¹Æ_lšk
 *);

194 
¹Æ_lšk_£t_ma¡”
(
¹Æ_lšk
 *, );

195 
¹Æ_lšk_g‘_ma¡”
(
¹Æ_lšk
 *);

197 
¹Æ_lšk_£t_ÿ¼›r
(
¹Æ_lšk
 *, 
ušt8_t
);

198 
ušt8_t
 
¹Æ_lšk_g‘_ÿ¼›r
(
¹Æ_lšk
 *);

200 
¹Æ_lšk_£t_İ”¡©e
(
¹Æ_lšk
 *, 
ušt8_t
);

201 
ušt8_t
 
¹Æ_lšk_g‘_İ”¡©e
(
¹Æ_lšk
 *);

203 
¹Æ_lšk_£t_lškmode
(
¹Æ_lšk
 *, 
ušt8_t
);

204 
ušt8_t
 
¹Æ_lšk_g‘_lškmode
(
¹Æ_lšk
 *);

206 cÚ¡ * 
¹Æ_lšk_g‘_içlŸs
(
¹Æ_lšk
 *);

207 
¹Æ_lšk_£t_içlŸs
(
¹Æ_lšk
 *, const *);

209 
¹Æ_lšk_g‘_num_vf
(
¹Æ_lšk
 *, 
ušt32_t
 *);

211 
ušt64_t
 
¹Æ_lšk_g‘_¡©
(
¹Æ_lšk
 *, 
¹Æ_lšk_¡©_id_t
);

212 
¹Æ_lšk_£t_¡©
(
¹Æ_lšk
 *, 
¹Æ_lšk_¡©_id_t
,

213 cÚ¡ 
ušt64_t
);

215 
¹Æ_lšk_£t_ty³
(
¹Æ_lšk
 *, const *);

216 * 
¹Æ_lšk_g‘_ty³
(
¹Æ_lšk
 *);

218 
¹Æ_lšk_£t_´omiscu™y
(
¹Æ_lšk
 *, 
ušt32_t
);

219 
ušt32_t
 
¹Æ_lšk_g‘_´omiscu™y
(
¹Æ_lšk
 *);

221 
¹Æ_lšk_£t_num_tx_queues
(
¹Æ_lšk
 *, 
ušt32_t
);

222 
ušt32_t
 
¹Æ_lšk_g‘_num_tx_queues
(
¹Æ_lšk
 *);

224 
¹Æ_lšk_£t_num_rx_queues
(
¹Æ_lšk
 *, 
ušt32_t
);

225 
ušt32_t
 
¹Æ_lšk_g‘_num_rx_queues
(
¹Æ_lšk
 *);

227 
Æ_d©a
 * 
¹Æ_lšk_g‘_phys_pÜt_id
(
¹Æ_lšk
 *);

229 
¹Æ_lšk_£t_ns_fd
(
¹Æ_lšk
 *, );

230 
¹Æ_lšk_g‘_ns_fd
(
¹Æ_lšk
 *);

231 
¹Æ_lšk_£t_ns_pid
(
¹Æ_lšk
 *, 
pid_t
);

232 
pid_t
 
¹Æ_lšk_g‘_ns_pid
(
¹Æ_lšk
 *);

234 
¹Æ_lšk_’¦ave_ifšdex
(
Æ_sock
 *, , );

235 
¹Æ_lšk_’¦ave
(
Æ_sock
 *, 
¹Æ_lšk
 *,

236 
¹Æ_lšk
 *);

237 
¹Æ_lšk_»Ëa£_ifšdex
(
Æ_sock
 *, );

238 
¹Æ_lšk_»Ëa£
(
Æ_sock
 *, 
¹Æ_lšk
 *);

239 
¹Æ_lšk_fl_šfo
(
Æ_msg
 *, 
¹Æ_lšk
 *);

240 
¹Æ_lšk_šfo_·r£
(
¹Æ_lšk
 *, 
Æ©Œ
 **);

244 
¹Æ_lšk_£t_šfo_ty³
(
¹Æ_lšk
 *, cÚ¡ *è
__©Œibu‹__
((
d•»ÿ‹d
));

245 * 
¹Æ_lšk_g‘_šfo_ty³
(
¹Æ_lšk
 *è
__©Œibu‹__
((
d•»ÿ‹d
));

246 
¹Æ_lšk_£t_weight
(
¹Æ_lšk
 *, è
__©Œibu‹__
((
d•»ÿ‹d
));

247 
¹Æ_lšk_g‘_weight
(
¹Æ_lšk
 *è
__©Œibu‹__
((
d•»ÿ‹d
));

250 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/api.h

12 #iâdeà
NETLINK_DUMMY_LINK_API_H_


13 
	#NETLINK_DUMMY_LINK_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

	@mylibnl/libnl-3.2.25/include/netlink/route/link/bonding.h

12 #iâdeà
NETLINK_LINK_BONDING_H_


13 
	#NETLINK_LINK_BONDING_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk_bÚd_®loc
();

24 
¹Æ_lšk_bÚd_add
(
Æ_sock
 *, const *,

25 
¹Æ_lšk
 *);

27 
¹Æ_lšk_bÚd_’¦ave_ifšdex
(
Æ_sock
 *, , );

28 
¹Æ_lšk_bÚd_’¦ave
(
Æ_sock
 *, 
¹Æ_lšk
 *,

29 
¹Æ_lšk
 *);

31 
¹Æ_lšk_bÚd_»Ëa£_ifšdex
(
Æ_sock
 *, );

32 
¹Æ_lšk_bÚd_»Ëa£
(
Æ_sock
 *, 
¹Æ_lšk
 *);

34 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/bridge.h

12 #iâdeà
NETLINK_LINK_BRIDGE_H_


13 
	#NETLINK_LINK_BRIDGE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


26 
	e¹Æ_lšk_bridge_æags
 {

27 
RTNL_BRIDGE_HAIRPIN_MODE
 = 0x0001,

28 
RTNL_BRIDGE_BPDU_GUARD
 = 0x0002,

29 
RTNL_BRIDGE_ROOT_BLOCK
 = 0x0004,

30 
RTNL_BRIDGE_FAST_LEAVE
 = 0x0008,

33 
¹Æ_lšk
 *
¹Æ_lšk_bridge_®loc
();

35 
¹Æ_lšk_is_bridge
(
¹Æ_lšk
 *);

36 
¹Æ_lšk_bridge_has_ext_šfo
(
¹Æ_lšk
 *);

38 
¹Æ_lšk_bridge_£t_pÜt_¡©e
(
¹Æ_lšk
 *, 
ušt8_t
 );

39 
¹Æ_lšk_bridge_g‘_pÜt_¡©e
(
¹Æ_lšk
 *);

41 
¹Æ_lšk_bridge_£t_´iÜ™y
(
¹Æ_lšk
 *, 
ušt16_t
);

42 
¹Æ_lšk_bridge_g‘_´iÜ™y
(
¹Æ_lšk
 *);

44 
¹Æ_lšk_bridge_£t_co¡
(
¹Æ_lšk
 *, 
ušt32_t
);

45 
¹Æ_lšk_bridge_g‘_co¡
(
¹Æ_lšk
 *, 
ušt32_t
 *);

47 
¹Æ_lšk_bridge_un£t_æags
(
¹Æ_lšk
 *, );

48 
¹Æ_lšk_bridge_£t_æags
(
¹Æ_lšk
 *, );

49 
¹Æ_lšk_bridge_g‘_æags
(
¹Æ_lšk
 *);

51 * 
¹Æ_lšk_bridge_æags2¡r
(, *, 
size_t
);

52 
¹Æ_lšk_bridge_¡r2æags
(const *);

54 
¹Æ_lšk_bridge_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

55 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/can.h

12 #iâdeà
NETLINK_LINK_CAN_H_


13 
	#NETLINK_LINK_CAN_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

17 
	~<lšux/ÿn/Ãšk.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_lšk_is_ÿn
(
¹Æ_lšk
 *
lšk
);

25 *
¹Æ_lšk_ÿn_ù¾mode2¡r
(, *, 
size_t
);

26 
¹Æ_lšk_ÿn_¡r2ù¾mode
(const *);

28 
¹Æ_lšk_ÿn_»¡¬t
(
¹Æ_lšk
 *);

29 
¹Æ_lšk_ÿn_äeq
(
¹Æ_lšk
 *, 
ušt32_t
 *);

30 
¹Æ_lšk_ÿn_¡©e
(
¹Æ_lšk
 *, 
ušt32_t
 *);

32 
¹Æ_lšk_ÿn_b”r_rx
(
¹Æ_lšk
 *);

33 
¹Æ_lšk_ÿn_b”r_tx
(
¹Æ_lšk
 *);

34 
¹Æ_lšk_ÿn_b”r
(
¹Æ_lšk
 *, 
ÿn_b”r_couÁ”
 *);

36 
¹Æ_lšk_ÿn_g‘_bt_cÚ¡
(
¹Æ_lšk
 *,

37 
ÿn_b™timšg_cÚ¡
 *);

38 
¹Æ_lšk_ÿn_g‘_b™timšg
(
¹Æ_lšk
 *,

39 
ÿn_b™timšg
 *);

40 
¹Æ_lšk_ÿn_£t_b™timšg
(
¹Æ_lšk
 *,

41 
ÿn_b™timšg
 *);

43 
¹Æ_lšk_ÿn_g‘_b™¿‹
(
¹Æ_lšk
 *, 
ušt32_t
 *);

44 
¹Æ_lšk_ÿn_£t_b™¿‹
(
¹Æ_lšk
 *, 
ušt32_t
);

46 
¹Æ_lšk_ÿn_g‘_§m¶e_pošt
(
¹Æ_lšk
 *, 
ušt32_t
 *);

47 
¹Æ_lšk_ÿn_£t_§m¶e_pošt
(
¹Æ_lšk
 *, 
ušt32_t
);

49 
¹Æ_lšk_ÿn_g‘_»¡¬t_ms
(
¹Æ_lšk
 *, 
ušt32_t
 *);

50 
¹Æ_lšk_ÿn_£t_»¡¬t_ms
(
¹Æ_lšk
 *, 
ušt32_t
);

52 
¹Æ_lšk_ÿn_g‘_ù¾mode
(
¹Æ_lšk
 *, 
ušt32_t
 *);

53 
¹Æ_lšk_ÿn_£t_ù¾mode
(
¹Æ_lšk
 *, 
ušt32_t
);

54 
¹Æ_lšk_ÿn_un£t_ù¾mode
(
¹Æ_lšk
 *, 
ušt32_t
);

56 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/inet.h

12 #iâdeà
NETLINK_LINK_INET_H_


13 
	#NETLINK_LINK_INET_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


21 cÚ¡ * 
¹Æ_lšk_š‘_devcÚf2¡r
(, *, 
size_t
);

22 
¹Æ_lšk_š‘_¡r2devcÚf
(const *);

24 
¹Æ_lšk_š‘_g‘_cÚf
(
¹Æ_lšk
 *,

25 cÚ¡ , 
ušt32_t
 *);

26 
¹Æ_lšk_š‘_£t_cÚf
(
¹Æ_lšk
 *,

27 cÚ¡ , 
ušt32_t
);

29 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/info-api.h

12 #iâdeà
NETLINK_DUMMY_LINK_INFO_API_H_


13 
	#NETLINK_DUMMY_LINK_INFO_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

	@mylibnl/libnl-3.2.25/include/netlink/route/link/ip6tnl.h

12 #iâdeà
NETLINK_LINK_IP6TNL_H_


13 
	#NETLINK_LINK_IP6TNL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk_6_Šl_®loc
();

23 
¹Æ_lšk_6_Šl_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

25 
¹Æ_lšk_6_Šl_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
);

26 
ušt32_t
 
¹Æ_lšk_6_Šl_g‘_lšk
(
¹Æ_lšk
 *
lšk
);

28 
¹Æ_lšk_6_Šl_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *);

29 
¹Æ_lšk_6_Šl_g‘_loÿl
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *
addr
);

31 
¹Æ_lšk_6_Šl_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *);

32 
¹Æ_lšk_6_Šl_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *);

34 
¹Æ_lšk_6_Šl_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
);

35 
ušt8_t
 
¹Æ_lšk_6_Šl_g‘_‰l
(
¹Æ_lšk
 *
lšk
);

37 
¹Æ_lšk_6_Šl_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
);

38 
ušt8_t
 
¹Æ_lšk_6_Šl_g‘_tos
(
¹Æ_lšk
 *
lšk
);

40 
¹Æ_lšk_6_Šl_£t_’ÿ¶im™
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
’ÿp_lim™
);

41 
ušt8_t
 
¹Æ_lšk_6_Šl_g‘_’ÿ¶im™
(
¹Æ_lšk
 *
lšk
);

43 
¹Æ_lšk_6_Šl_£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
æags
);

44 
ušt32_t
 
¹Æ_lšk_6_Šl_g‘_æags
(
¹Æ_lšk
 *
lšk
);

46 
ušt32_t
 
¹Æ_lšk_6_Šl_g‘_æowšfo
(
¹Æ_lšk
 *
lšk
);

47 
¹Æ_lšk_6_Šl_£t_æowšfo
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
æowšfo
);

49 
¹Æ_lšk_6_Šl_£t_´Ùo
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
´Ùo
);

50 
ušt8_t
 
¹Æ_lšk_6_Šl_g‘_´Ùo
(
¹Æ_lšk
 *
lšk
);

52 #ifdeà
_ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/ipgre.h

12 #iâdeà
NETLINK_LINK_IPGRE_H_


13 
	#NETLINK_LINK_IPGRE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk_g»_®loc
();

23 
¹Æ_lšk_g»_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

25 
¹Æ_lšk_g»_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
);

26 
ušt32_t
 
¹Æ_lšk_g»_g‘_lšk
(
¹Æ_lšk
 *
lšk
);

28 
¹Æ_lšk_g»_£t_iæags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
iæags
);

29 
ušt16_t
 
¹Æ_lšk_g»_g‘_iæags
(
¹Æ_lšk
 *
lšk
);

31 
¹Æ_lšk_g»_£t_oæags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
oæags
);

32 
ušt16_t
 
¹Æ_lšk_g»_g‘_oæags
(
¹Æ_lšk
 *
lšk
);

34 
¹Æ_lšk_g»_£t_ikey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ikey
);

35 
ušt32_t
 
¹Æ_lšk_g»_g‘_ikey
(
¹Æ_lšk
 *
lšk
);

37 
¹Æ_lšk_g»_£t_okey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
okey
);

38 
ušt32_t
 
¹Æ_lšk_g»_g‘_okey
(
¹Æ_lšk
 *
lšk
);

40 
¹Æ_lšk_g»_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

41 
ušt32_t
 
¹Æ_lšk_g»_g‘_loÿl
(
¹Æ_lšk
 *
lšk
);

43 
¹Æ_lšk_g»_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

44 
ušt32_t
 
¹Æ_lšk_g»_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
);

46 
¹Æ_lšk_g»_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
);

47 
ušt8_t
 
¹Æ_lšk_g»_g‘_‰l
(
¹Æ_lšk
 *
lšk
);

49 
¹Æ_lšk_g»_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
);

50 
ušt8_t
 
¹Æ_lšk_g»_g‘_tos
(
¹Æ_lšk
 *
lšk
);

52 
¹Æ_lšk_g»_£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
);

53 
ušt8_t
 
¹Æ_lšk_g»_g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
);

55 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/ipip.h

12 #iâdeà
NETLINK_LINK_IPIP_H_


13 
	#NETLINK_LINK_IPIP_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk__®loc
();

23 
¹Æ_lšk__add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

25 
ušt32_t
 
¹Æ_lšk__g‘_lšk
(
¹Æ_lšk
 *
lšk
);

26 
¹Æ_lšk__£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
);

28 
¹Æ_lšk__£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

29 
ušt32_t
 
¹Æ_lšk__g‘_loÿl
(
¹Æ_lšk
 *
lšk
);

31 
¹Æ_lšk__£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

32 
ušt32_t
 
¹Æ_lšk__g‘_»mÙe
(
¹Æ_lšk
 *
lšk
);

34 
¹Æ_lšk__£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
);

35 
ušt8_t
 
¹Æ_lšk__g‘_‰l
(
¹Æ_lšk
 *
lšk
);

37 
¹Æ_lšk__£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
);

38 
ušt8_t
 
¹Æ_lšk__g‘_tos
(
¹Æ_lšk
 *
lšk
);

40 
¹Æ_lšk__£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
);

41 
ušt8_t
 
¹Æ_lšk__g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
);

43 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/ipvti.h

12 #iâdeà
NETLINK_LINK_IPVTI_H_


13 
	#NETLINK_LINK_IPVTI_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


21 
¹Æ_lšk
 *
¹Æ_lšk_vti_®loc
();

22 
¹Æ_lšk_vti_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

24 
¹Æ_lšk_vti_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
);

25 
ušt32_t
 
¹Æ_lšk_vti_g‘_lšk
(
¹Æ_lšk
 *
lšk
);

27 
¹Æ_lšk_vti_£t_ikey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ikey
);

28 
ušt32_t
 
¹Æ_lšk_g‘_ikey
(
¹Æ_lšk
 *
lšk
);

30 
¹Æ_lšk_vti_£t_okey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
okey
);

31 
ušt32_t
 
¹Æ_lšk_g‘_okey
(
¹Æ_lšk
 *
lšk
);

33 
¹Æ_lšk_vti_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

34 
ušt32_t
 
¹Æ_lšk_g‘_loÿl
(
¹Æ_lšk
 *
lšk
);

36 
¹Æ_lšk_vti_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

37 
ušt32_t
 
¹Æ_lšk_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
);

39 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/macvlan.h

12 #iâdeà
NETLINK_LINK_MACVLAN_H_


13 
	#NETLINK_LINK_MACVLAN_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk_macvÏn_®loc
();

24 
¹Æ_lšk_is_macvÏn
(
¹Æ_lšk
 *);

26 * 
¹Æ_lšk_macvÏn_mode2¡r
(, *, 
size_t
);

27 
¹Æ_lšk_macvÏn_¡r2mode
(const *);

29 * 
¹Æ_lšk_macvÏn_æags2¡r
(, *, 
size_t
);

30 
¹Æ_lšk_macvÏn_¡r2æags
(const *);

32 
¹Æ_lšk_macvÏn_£t_mode
(
¹Æ_lšk
 *,

33 
ušt32_t
);

34 
ušt32_t
 
¹Æ_lšk_macvÏn_g‘_mode
(
¹Æ_lšk
 *);

36 
¹Æ_lšk_macvÏn_£t_æags
(
¹Æ_lšk
 *,

37 
ušt16_t
);

38 
¹Æ_lšk_macvÏn_un£t_æags
(
¹Æ_lšk
 *,

39 
ušt16_t
);

40 
ušt16_t
 
¹Æ_lšk_macvÏn_g‘_æags
(
¹Æ_lšk
 *);

42 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/sit.h

12 #iâdeà
NETLINK_LINK_SIT_H_


13 
	#NETLINK_LINK_SIT_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_lšk
 *
¹Æ_lšk_s™_®loc
();

23 
¹Æ_lšk_s™_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
);

25 
¹Æ_lšk_s™_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
);

26 
ušt32_t
 
¹Æ_lšk_s™_g‘_lšk
(
¹Æ_lšk
 *
lšk
);

28 
¹Æ_lšk_s™_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

29 
ušt32_t
 
¹Æ_lšk_g‘_s™_loÿl
(
¹Æ_lšk
 *
lšk
);

31 
¹Æ_lšk_s™_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
);

32 
ušt32_t
 
¹Æ_lšk_s™_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
);

34 
¹Æ_lšk_s™_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
);

35 
ušt8_t
 
¹Æ_lšk_s™_g‘_‰l
(
¹Æ_lšk
 *
lšk
);

37 
¹Æ_lšk_s™_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
);

38 
ušt8_t
 
¹Æ_lšk_s™_g‘_tos
(
¹Æ_lšk
 *
lšk
);

40 
¹Æ_lšk_s™_£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
);

41 
ušt8_t
 
¹Æ_lšk_s™_g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
);

43 
¹Æ_lšk_s™_£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
æags
);

44 
ušt16_t
 
¹Æ_lšk_s™_g‘_æags
(
¹Æ_lšk
 *
lšk
);

46 
¹Æ_lšk_s™_£t_´Ùo
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
´Ùo
);

47 
ušt8_t
 
¹Æ_lšk_g‘_´Ùo
(
¹Æ_lšk
 *
lšk
);

49 #ifdeà
_ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/veth.h

12 #iâdeà
NETLINK_LINK_VETH_H_


13 
	#NETLINK_LINK_VETH_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

17 
	~<sys/ty³s.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_lšk
 *
¹Æ_lšk_v‘h_®loc
();

24 
¹Æ_lšk_v‘h_»Ëa£
(
¹Æ_lšk
 *);

26 
¹Æ_lšk_is_v‘h
(
¹Æ_lšk
 *);

28 
¹Æ_lšk
 *
¹Æ_lšk_v‘h_g‘_³”
(rtnl_link *);

29 
¹Æ_lšk_v‘h_add
(
Æ_sock
 *
sock
, cÚ¡ *
Çme
,

30 cÚ¡ *
³”
, 
pid_t
 
pid
);

32 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/vlan.h

12 #iâdeà
NETLINK_LINK_VLAN_H_


13 
	#NETLINK_LINK_VLAN_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
	svÏn_m­


24 
ušt32_t
 
vm_äom
;

25 
ušt32_t
 
vm_to
;

28 
	#VLAN_PRIO_MAX
 7

	)

30 
¹Æ_lšk
 *
¹Æ_lšk_vÏn_®loc
();

32 
¹Æ_lšk_is_vÏn
(
¹Æ_lšk
 *);

34 * 
¹Æ_lšk_vÏn_æags2¡r
(, *, 
size_t
);

35 
¹Æ_lšk_vÏn_¡r2æags
(const *);

37 
¹Æ_lšk_vÏn_£t_´ÙocŞ
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
);

38 
¹Æ_lšk_vÏn_g‘_´ÙocŞ
(
¹Æ_lšk
 *
lšk
);

40 
¹Æ_lšk_vÏn_£t_id
(
¹Æ_lšk
 *, 
ušt16_t
);

41 
¹Æ_lšk_vÏn_g‘_id
(
¹Æ_lšk
 *);

43 
¹Æ_lšk_vÏn_£t_æags
(
¹Æ_lšk
 *,

45 
¹Æ_lšk_vÏn_un£t_æags
(
¹Æ_lšk
 *,

47 
¹Æ_lšk_vÏn_g‘_æags
(
¹Æ_lšk
 *);

49 
¹Æ_lšk_vÏn_£t_šg»ss_m­
(
¹Æ_lšk
 *,

50 , 
ušt32_t
);

51 
ušt32_t
 * 
¹Æ_lšk_vÏn_g‘_šg»ss_m­
(
¹Æ_lšk
 *);

53 
¹Æ_lšk_vÏn_£t_eg»ss_m­
(
¹Æ_lšk
 *,

54 
ušt32_t
, );

55 
vÏn_m­
 *
¹Æ_lšk_vÏn_g‘_eg»ss_m­
(
¹Æ_lšk
 *,

58 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/link/vxlan.h

12 #iâdeà
NETLINK_LINK_VXLAN_H_


13 
	#NETLINK_LINK_VXLAN_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/lšk.h
>

18 #ifdeà
__ılu¥lus


22 
	#VXLAN_ID_MAX
 16777215

	)

24 
¹Æ_lšk
 *
¹Æ_lšk_vxÏn_®loc
();

26 
¹Æ_lšk_is_vxÏn
(
¹Æ_lšk
 *);

28 
¹Æ_lšk_vxÏn_£t_id
(
¹Æ_lšk
 *, 
ušt32_t
);

29 
¹Æ_lšk_vxÏn_g‘_id
(
¹Æ_lšk
 *, 
ušt32_t
 *);

31 
¹Æ_lšk_vxÏn_£t_group
(
¹Æ_lšk
 *, 
Æ_addr
 *);

32 
¹Æ_lšk_vxÏn_g‘_group
(
¹Æ_lšk
 *, 
Æ_addr
 **);

34 
¹Æ_lšk_vxÏn_£t_lšk
(
¹Æ_lšk
 *, 
ušt32_t
);

35 
¹Æ_lšk_vxÏn_g‘_lšk
(
¹Æ_lšk
 *, 
ušt32_t
 *);

37 
¹Æ_lšk_vxÏn_£t_loÿl
(
¹Æ_lšk
 *, 
Æ_addr
 *);

38 
¹Æ_lšk_vxÏn_g‘_loÿl
(
¹Æ_lšk
 *, 
Æ_addr
 **);

40 
¹Æ_lšk_vxÏn_£t_‰l
(
¹Æ_lšk
 *, 
ušt8_t
);

41 
¹Æ_lšk_vxÏn_g‘_‰l
(
¹Æ_lšk
 *);

43 
¹Æ_lšk_vxÏn_£t_tos
(
¹Æ_lšk
 *, 
ušt8_t
);

44 
¹Æ_lšk_vxÏn_g‘_tos
(
¹Æ_lšk
 *);

46 
¹Æ_lšk_vxÏn_£t_Ë¬nšg
(
¹Æ_lšk
 *, 
ušt8_t
);

47 
¹Æ_lšk_vxÏn_g‘_Ë¬nšg
(
¹Æ_lšk
 *);

48 
¹Æ_lšk_vxÏn_’abË_Ë¬nšg
(
¹Æ_lšk
 *);

49 
¹Æ_lšk_vxÏn_di§bË_Ë¬nšg
(
¹Æ_lšk
 *);

51 
¹Æ_lšk_vxÏn_£t_agešg
(
¹Æ_lšk
 *, 
ušt32_t
);

52 
¹Æ_lšk_vxÏn_g‘_agešg
(
¹Æ_lšk
 *, 
ušt32_t
 *);

54 
¹Æ_lšk_vxÏn_£t_lim™
(
¹Æ_lšk
 *, 
ušt32_t
);

55 
¹Æ_lšk_vxÏn_g‘_lim™
(
¹Æ_lšk
 *, 
ušt32_t
 *);

57 
¹Æ_lšk_vxÏn_£t_pÜt_¿nge
(
¹Æ_lšk
 *,

58 
iæa_vxÏn_pÜt_¿nge
 *);

59 
¹Æ_lšk_vxÏn_g‘_pÜt_¿nge
(
¹Æ_lšk
 *,

60 
iæa_vxÏn_pÜt_¿nge
 *);

62 
¹Æ_lšk_vxÏn_£t_´oxy
(
¹Æ_lšk
 *, 
ušt8_t
);

63 
¹Æ_lšk_vxÏn_g‘_´oxy
(
¹Æ_lšk
 *);

64 
¹Æ_lšk_vxÏn_’abË_´oxy
(
¹Æ_lšk
 *);

65 
¹Æ_lšk_vxÏn_di§bË_´oxy
(
¹Æ_lšk
 *);

67 
¹Æ_lšk_vxÏn_£t_rsc
(
¹Æ_lšk
 *, 
ušt8_t
);

68 
¹Æ_lšk_vxÏn_g‘_rsc
(
¹Æ_lšk
 *);

69 
¹Æ_lšk_vxÏn_’abË_rsc
(
¹Æ_lšk
 *);

70 
¹Æ_lšk_vxÏn_di§bË_rsc
(
¹Æ_lšk
 *);

72 
¹Æ_lšk_vxÏn_£t_l2miss
(
¹Æ_lšk
 *, 
ušt8_t
);

73 
¹Æ_lšk_vxÏn_g‘_l2miss
(
¹Æ_lšk
 *);

74 
¹Æ_lšk_vxÏn_’abË_l2miss
(
¹Æ_lšk
 *);

75 
¹Æ_lšk_vxÏn_di§bË_l2miss
(
¹Æ_lšk
 *);

77 
¹Æ_lšk_vxÏn_£t_l3miss
(
¹Æ_lšk
 *, 
ušt8_t
);

78 
¹Æ_lšk_vxÏn_g‘_l3miss
(
¹Æ_lšk
 *);

79 
¹Æ_lšk_vxÏn_’abË_l3miss
(
¹Æ_lšk
 *);

80 
¹Æ_lšk_vxÏn_di§bË_l3miss
(
¹Æ_lšk
 *);

82 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/neighbour.h

12 #iâdeà
NETLINK_NEIGHBOUR_H_


13 
	#NETLINK_NEIGHBOUR_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_Ãigh
;

25 
¹Æ_Ãigh
 *
¹Æ_Ãigh_®loc
();

26 
¹Æ_Ãigh_put
(
¹Æ_Ãigh
 *);

28 
¹Æ_Ãigh_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

29 
¹Æ_Ãigh
 *
¹Æ_Ãigh_g‘
(
Æ_ÿche
 *, ,

30 
Æ_addr
 *);

32 
¹Æ_Ãigh_·r£
(
Æmsghdr
 *, 
¹Æ_Ãigh
 **);

34 * 
¹Æ_Ãigh_¡©e2¡r
(, *, 
size_t
);

35 
¹Æ_Ãigh_¡r2¡©e
(const *);

37 * 
¹Æ_Ãigh_æags2¡r
(, *, 
size_t
);

38 
¹Æ_Ãigh_¡r2æag
(const *);

40 
¹Æ_Ãigh_add
(
Æ_sock
 *, 
¹Æ_Ãigh
 *, );

41 
¹Æ_Ãigh_bud_add_»que¡
(
¹Æ_Ãigh
 *, ,

42 
Æ_msg
 **);

44 
¹Æ_Ãigh_d–‘e
(
Æ_sock
 *, 
¹Æ_Ãigh
 *, );

45 
¹Æ_Ãigh_bud_d–‘e_»que¡
(
¹Æ_Ãigh
 *, ,

46 
Æ_msg
 **);

48 
¹Æ_Ãigh_£t_¡©e
(
¹Æ_Ãigh
 *, );

49 
¹Æ_Ãigh_g‘_¡©e
(
¹Æ_Ãigh
 *);

50 
¹Æ_Ãigh_un£t_¡©e
(
¹Æ_Ãigh
 *,

53 
¹Æ_Ãigh_£t_æags
(
¹Æ_Ãigh
 *,

55 
¹Æ_Ãigh_un£t_æags
(
¹Æ_Ãigh
 *,

57 
¹Æ_Ãigh_g‘_æags
(
¹Æ_Ãigh
 *);

59 
¹Æ_Ãigh_£t_ifšdex
(
¹Æ_Ãigh
 *,

61 
¹Æ_Ãigh_g‘_ifšdex
(
¹Æ_Ãigh
 *);

63 
¹Æ_Ãigh_£t_Îaddr
(
¹Æ_Ãigh
 *,

64 
Æ_addr
 *);

65 
Æ_addr
 * 
¹Æ_Ãigh_g‘_Îaddr
(
¹Æ_Ãigh
 *);

67 
¹Æ_Ãigh_£t_d¡
(
¹Æ_Ãigh
 *,

68 
Æ_addr
 *);

69 
Æ_addr
 * 
¹Æ_Ãigh_g‘_d¡
(
¹Æ_Ãigh
 *);

71 
¹Æ_Ãigh_£t_ty³
(
¹Æ_Ãigh
 *, );

72 
¹Æ_Ãigh_g‘_ty³
(
¹Æ_Ãigh
 *);

74 
¹Æ_Ãigh_£t_çmy
(
¹Æ_Ãigh
 *, );

75 
¹Æ_Ãigh_g‘_çmy
(
¹Æ_Ãigh
 *);

77 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/neightbl.h

12 #iâdeà
NETLINK_NEIGHTBL_H_


13 
	#NETLINK_NEIGHTBL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_Ãightbl
;

25 
¹Æ_Ãightbl
 *
¹Æ_Ãightbl_®loc
();

26 
¹Æ_Ãightbl_put
(
¹Æ_Ãightbl
 *);

27 
¹Æ_Ãightbl_ä“
(
¹Æ_Ãightbl
 *);

28 
¹Æ_Ãightbl_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

29 
¹Æ_Ãightbl
 *
¹Æ_Ãightbl_g‘
(
Æ_ÿche
 *,

31 
¹Æ_Ãightbl_dump
(
¹Æ_Ãightbl
 *, 
FILE
 *,

32 
Æ_dump_·¿ms
 *);

34 
¹Æ_Ãightbl_bud_chªge_»que¡
(
¹Æ_Ãightbl
 *,

35 
¹Æ_Ãightbl
 *,

36 
Æ_msg
 **);

37 
¹Æ_Ãightbl_chªge
(
Æ_sock
 *, 
¹Æ_Ãightbl
 *,

38 
¹Æ_Ãightbl
 *);

40 
¹Æ_Ãightbl_£t_çmy
(
¹Æ_Ãightbl
 *, );

41 
¹Æ_Ãightbl_£t_gc_Œesh1
(
¹Æ_Ãightbl
 *, );

42 
¹Æ_Ãightbl_£t_gc_Œesh2
(
¹Æ_Ãightbl
 *, );

43 
¹Æ_Ãightbl_£t_gc_Œesh3
(
¹Æ_Ãightbl
 *, );

44 
¹Æ_Ãightbl_£t_Çme
(
¹Æ_Ãightbl
 *, const *);

45 
¹Æ_Ãightbl_£t_dev
(
¹Æ_Ãightbl
 *, );

46 
¹Æ_Ãightbl_£t_queue_Ën
(
¹Æ_Ãightbl
 *, );

47 
¹Æ_Ãightbl_£t_´oxy_queue_Ën
(
¹Æ_Ãightbl
 *, );

48 
¹Æ_Ãightbl_£t_­p_´obes
(
¹Æ_Ãightbl
 *, );

49 
¹Æ_Ãightbl_£t_uÿ¡_´obes
(
¹Æ_Ãightbl
 *, );

50 
¹Æ_Ãightbl_£t_mÿ¡_´obes
(
¹Æ_Ãightbl
 *, );

51 
¹Æ_Ãightbl_£t_ba£_»achabË_time
(
¹Æ_Ãightbl
 *,

52 
ušt64_t
);

53 
¹Æ_Ãightbl_£t_»Œªs_time
(
¹Æ_Ãightbl
 *, 
ušt64_t
);

54 
¹Æ_Ãightbl_£t_gc_¡®e_time
(
¹Æ_Ãightbl
 *, 
ušt64_t
);

55 
¹Æ_Ãightbl_£t_d–ay_´obe_time
(
¹Æ_Ãightbl
 *,

56 
ušt64_t
);

57 
¹Æ_Ãightbl_£t_ªyÿ¡_d–ay
(
¹Æ_Ãightbl
 *, 
ušt64_t
);

58 
¹Æ_Ãightbl_£t_´oxy_d–ay
(
¹Æ_Ãightbl
 *, 
ušt64_t
);

59 
¹Æ_Ãightbl_£t_locktime
(
¹Æ_Ãightbl
 *, 
ušt64_t
);

61 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/nexthop.h

12 #iâdeà
NETLINK_ROUTE_NEXTHOP_H_


13 
	#NETLINK_ROUTE_NEXTHOP_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/addr.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_Ãxthİ
;

25 
NH_DUMP_FROM_ONELINE
 = -2,

26 
NH_DUMP_FROM_DETAILS
 = -1,

27 
NH_DUMP_FROM_ENV
 = 0,

31 
¹Æ_Ãxthİ
 * 
¹Æ_rou‹_nh_®loc
();

32 
¹Æ_Ãxthİ
 * 
¹Æ_rou‹_nh_şÚe
(rtnl_nexthop *);

33 
¹Æ_rou‹_nh_ä“
(
¹Æ_Ãxthİ
 *);

35 
¹Æ_rou‹_nh_com·»
(
¹Æ_Ãxthİ
 *,

36 
¹Æ_Ãxthİ
 *,

37 
ušt32_t
, );

39 
¹Æ_rou‹_nh_dump
(
¹Æ_Ãxthİ
 *,

40 
Æ_dump_·¿ms
 *);

42 
¹Æ_rou‹_nh_£t_weight
(
¹Æ_Ãxthİ
 *, 
ušt8_t
);

43 
ušt8_t
 
¹Æ_rou‹_nh_g‘_weight
(
¹Æ_Ãxthİ
 *);

44 
¹Æ_rou‹_nh_£t_ifšdex
(
¹Æ_Ãxthİ
 *, );

45 
¹Æ_rou‹_nh_g‘_ifšdex
(
¹Æ_Ãxthİ
 *);

46 
¹Æ_rou‹_nh_£t_g©eway
(
¹Æ_Ãxthİ
 *,

47 
Æ_addr
 *);

48 
Æ_addr
 * 
¹Æ_rou‹_nh_g‘_g©eway
(
¹Æ_Ãxthİ
 *);

49 
¹Æ_rou‹_nh_£t_æags
(
¹Æ_Ãxthİ
 *,

51 
¹Æ_rou‹_nh_un£t_æags
(
¹Æ_Ãxthİ
 *,

53 
¹Æ_rou‹_nh_g‘_æags
(
¹Æ_Ãxthİ
 *);

54 
¹Æ_rou‹_nh_£t_»®ms
(
¹Æ_Ãxthİ
 *,

55 
ušt32_t
);

56 
ušt32_t
 
¹Æ_rou‹_nh_g‘_»®ms
(
¹Æ_Ãxthİ
 *);

58 * 
¹Æ_rou‹_nh_æags2¡r
(, *, 
size_t
);

59 
¹Æ_rou‹_nh_¡r2æags
(const *);

61 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/pktloc.h

12 #iâdeà
NETLINK_PKTLOC_H_


13 
	#NETLINK_PKTLOC_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/tc.h
>

19 
	~<lšux/tc_em©ch/tc_em_cmp.h
>

21 #ifdeà
__ılu¥lus


25 
	s¹Æ_pkoc


27 * 
Çme
;

28 
ušt8_t
 
Ïy”
;

29 
ušt8_t
 
shiá
;

30 
ušt16_t
 
off£t
;

31 
ušt16_t
 
®ign
;

32 
ušt32_t
 
mask
;

33 
ušt32_t
 
»fút
;

35 
Æ_li¡_h—d
 
li¡
;

38 
¹Æ_pkoc_lookup
(cÚ¡ *, 
¹Æ_pkoc
 **);

39 
¹Æ_pkoc
 *
¹Æ_pkoc_®loc
();

40 
¹Æ_pkoc_put
(
¹Æ_pkoc
 *);

41 
¹Æ_pkoc_add
(
¹Æ_pkoc
 *);

42 
¹Æ_pkoc_fÜ—ch
((*
cb
)(
¹Æ_pkoc
 *, *),

45 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc.h

12 #iâdeà
NETLINK_QDISC_H_


13 
	#NETLINK_QDISC_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/tc.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_qdisc
;

25 
¹Æ_qdisc
 *

26 
¹Æ_qdisc_®loc
();

27 
¹Æ_qdisc_put
(
¹Æ_qdisc
 *);

29 
¹Æ_qdisc_®loc_ÿche
(
Æ_sock
 *, 
Æ_ÿche
 **);

31 
¹Æ_qdisc
 *

32 
¹Æ_qdisc_g‘
(
Æ_ÿche
 *, , 
ušt32_t
);

34 
¹Æ_qdisc
 *

35 
¹Æ_qdisc_g‘_by_·»Á
(
Æ_ÿche
 *, , 
ušt32_t
);

37 
¹Æ_qdisc_bud_add_»que¡
(
¹Æ_qdisc
 *, ,

38 
Æ_msg
 **);

39 
¹Æ_qdisc_add
(
Æ_sock
 *, 
¹Æ_qdisc
 *, );

41 
¹Æ_qdisc_bud_upd©e_»que¡
(
¹Æ_qdisc
 *,

42 
¹Æ_qdisc
 *,

43 , 
Æ_msg
 **);

45 
¹Æ_qdisc_upd©e
(
Æ_sock
 *, 
¹Æ_qdisc
 *,

46 
¹Æ_qdisc
 *, );

48 
¹Æ_qdisc_bud_d–‘e_»que¡
(
¹Æ_qdisc
 *,

49 
Æ_msg
 **);

50 
¹Æ_qdisc_d–‘e
(
Æ_sock
 *, 
¹Æ_qdisc
 *);

53 
¹Æ_qdisc_fÜ—ch_chd
(
¹Æ_qdisc
 *, 
Æ_ÿche
 *,

54 (*
cb
)(
Æ_objeù
 *, *),

55 *è
__©Œibu‹__
 ((
d•»ÿ‹d
));

57 
¹Æ_qdisc_fÜ—ch_şs
(
¹Æ_qdisc
 *, 
Æ_ÿche
 *,

58 (*
cb
)(
Æ_objeù
 *, *),

59 *è
__©Œibu‹__
 ((
d•»ÿ‹d
));

61 
¹Æ_qdisc_bud_chªge_»que¡
(
¹Æ_qdisc
 *,

62 
¹Æ_qdisc
 *,

63 
Æ_msg
 **)

64 
__©Œibu‹__
 ((
d•»ÿ‹d
));

66 
¹Æ_qdisc_chªge
(
Æ_sock
 *, 
¹Æ_qdisc
 *,

67 
¹Æ_qdisc
 *è
__©Œibu‹__
 ((
d•»ÿ‹d
));

69 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/cbq.h

12 #iâdeà
NETLINK_CBQ_H_


13 
	#NETLINK_CBQ_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/rou‹/qdisc.h
>

19 #ifdeà
__ılu¥lus


23 * 
Æ_ovl_¡¿‹gy2¡r
(, *, 
size_t
);

24 
Æ_¡r2ovl_¡¿‹gy
(const *);

26 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/dsmark.h

12 #iâdeà
NETLINK_DSMARK_H_


13 
	#NETLINK_DSMARK_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

17 
	~<Ãšk/rou‹/şass.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_şass_dsm¬k_£t_b™mask
(
¹Æ_şass
 *, 
ušt8_t
);

24 
¹Æ_şass_dsm¬k_g‘_b™mask
(
¹Æ_şass
 *);

26 
¹Æ_şass_dsm¬k_£t_v®ue
(
¹Æ_şass
 *, 
ušt8_t
);

27 
¹Æ_şass_dsm¬k_g‘_v®ue
(
¹Æ_şass
 *);

29 
¹Æ_qdisc_dsm¬k_£t_šdiûs
(
¹Æ_qdisc
 *, 
ušt16_t
);

30 
¹Æ_qdisc_dsm¬k_g‘_šdiûs
(
¹Æ_qdisc
 *);

32 
¹Æ_qdisc_dsm¬k_£t_deçuÉ_šdex
(
¹Æ_qdisc
 *,

33 
ušt16_t
);

34 
¹Æ_qdisc_dsm¬k_g‘_deçuÉ_šdex
(
¹Æ_qdisc
 *);

36 
¹Æ_qdisc_dsm¬k_£t_£t_tc_šdex
(
¹Æ_qdisc
 *, );

37 
¹Æ_qdisc_dsm¬k_g‘_£t_tc_šdex
(
¹Æ_qdisc
 *);

39 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/fifo.h

12 #iâdeà
NETLINK_FIFO_H_


13 
	#NETLINK_FIFO_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_qdisc_fifo_£t_lim™
(
¹Æ_qdisc
 *, );

23 
¹Æ_qdisc_fifo_g‘_lim™
(
¹Æ_qdisc
 *);

25 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/fq_codel.h

12 #iâdeà
NETLINK_FQ_CODEL_H_


13 
	#NETLINK_FQ_CODEL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_qdisc_fq_cod–_£t_lim™
(
¹Æ_qdisc
 *, );

23 
¹Æ_qdisc_fq_cod–_g‘_lim™
(
¹Æ_qdisc
 *);

25 
¹Æ_qdisc_fq_cod–_£t_rg‘
(
¹Æ_qdisc
 *, 
ušt32_t
);

26 
ušt32_t
 
¹Æ_qdisc_fq_cod–_g‘_rg‘
(
¹Æ_qdisc
 *);

28 
¹Æ_qdisc_fq_cod–_£t_š‹rv®
(
¹Æ_qdisc
 *, 
ušt32_t
);

29 
ušt32_t
 
¹Æ_qdisc_fq_cod–_g‘_š‹rv®
(
¹Æ_qdisc
 *);

31 
¹Æ_qdisc_fq_cod–_£t_quªtum
(
¹Æ_qdisc
 *, 
ušt32_t
);

32 
ušt32_t
 
¹Æ_qdisc_fq_cod–_g‘_quªtum
(
¹Æ_qdisc
 *);

34 
¹Æ_qdisc_fq_cod–_£t_æows
(
¹Æ_qdisc
 *, );

35 
¹Æ_qdisc_fq_cod–_g‘_æows
(
¹Æ_qdisc
 *);

37 
¹Æ_qdisc_fq_cod–_£t_eú
(
¹Æ_qdisc
 *, );

38 
¹Æ_qdisc_fq_cod–_g‘_eú
(
¹Æ_qdisc
 *);

40 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/htb.h

14 #iâdeà
NETLINK_HTB_H_


15 
	#NETLINK_HTB_H_


	)

17 
	~<Ãšk/Ãšk.h
>

18 
	~<Ãšk/rou‹/tc.h
>

19 
	~<Ãšk/rou‹/qdisc.h
>

20 
	~<Ãšk/rou‹/şass.h
>

22 #ifdeà
__ılu¥lus


26 
ušt32_t
 
¹Æ_htb_g‘_¿‹2quªtum
(
¹Æ_qdisc
 *);

27 
¹Æ_htb_£t_¿‹2quªtum
(
¹Æ_qdisc
 *, 
ušt32_t
);

28 
ušt32_t
 
¹Æ_htb_g‘_defşs
(
¹Æ_qdisc
 *);

29 
¹Æ_htb_£t_defşs
(
¹Æ_qdisc
 *, 
ušt32_t
);

31 
ušt32_t
 
¹Æ_htb_g‘_´io
(
¹Æ_şass
 *);

32 
¹Æ_htb_£t_´io
(
¹Æ_şass
 *, 
ušt32_t
);

33 
ušt32_t
 
¹Æ_htb_g‘_¿‹
(
¹Æ_şass
 *);

34 
¹Æ_htb_£t_¿‹
(
¹Æ_şass
 *, 
ušt32_t
);

35 
ušt32_t
 
¹Æ_htb_g‘_û
(
¹Æ_şass
 *);

36 
¹Æ_htb_£t_û
(
¹Æ_şass
 *, 
ušt32_t
);

37 
ušt32_t
 
¹Æ_htb_g‘_rbufãr
(
¹Æ_şass
 *);

38 
¹Æ_htb_£t_rbufãr
(
¹Æ_şass
 *, 
ušt32_t
);

39 
ušt32_t
 
¹Æ_htb_g‘_cbufãr
(
¹Æ_şass
 *);

40 
¹Æ_htb_£t_cbufãr
(
¹Æ_şass
 *, 
ušt32_t
);

41 
ušt32_t
 
¹Æ_htb_g‘_quªtum
(
¹Æ_şass
 *);

42 
¹Æ_htb_£t_quªtum
(
¹Æ_şass
 *, 
ušt32_t
);

43 
¹Æ_htb_g‘_Ëv–
(
¹Æ_şass
 *);

45 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/netem.h

12 #iâdeà
NETLINK_NETEM_H_


13 
	#NETLINK_NETEM_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_Ã‹m_£t_lim™
(
¹Æ_qdisc
 *, );

23 
¹Æ_Ã‹m_g‘_lim™
(
¹Æ_qdisc
 *);

26 
¹Æ_Ã‹m_£t_g­
(
¹Æ_qdisc
 *, );

27 
¹Æ_Ã‹m_g‘_g­
(
¹Æ_qdisc
 *);

29 
¹Æ_Ã‹m_£t_»Üd”_´obab™y
(
¹Æ_qdisc
 *, );

30 
¹Æ_Ã‹m_g‘_»Üd”_´obab™y
(
¹Æ_qdisc
 *);

32 
¹Æ_Ã‹m_£t_»Üd”_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *, );

33 
¹Æ_Ã‹m_g‘_»Üd”_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *);

36 
¹Æ_Ã‹m_£t_cÜru±iÚ_´obab™y
(
¹Æ_qdisc
 *, );

37 
¹Æ_Ã‹m_g‘_cÜru±iÚ_´obab™y
(
¹Æ_qdisc
 *);

39 
¹Æ_Ã‹m_£t_cÜru±iÚ_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *, );

40 
¹Æ_Ã‹m_g‘_cÜru±iÚ_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *);

43 
¹Æ_Ã‹m_£t_loss
(
¹Æ_qdisc
 *, );

44 
¹Æ_Ã‹m_g‘_loss
(
¹Æ_qdisc
 *);

46 
¹Æ_Ã‹m_£t_loss_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *, );

47 
¹Æ_Ã‹m_g‘_loss_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *);

50 
¹Æ_Ã‹m_£t_du¶iÿ‹
(
¹Æ_qdisc
 *, );

51 
¹Æ_Ã‹m_g‘_du¶iÿ‹
(
¹Æ_qdisc
 *);

53 
¹Æ_Ã‹m_£t_du¶iÿ‹_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *, );

54 
¹Æ_Ã‹m_g‘_du¶iÿ‹_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *);

57 
¹Æ_Ã‹m_£t_d–ay
(
¹Æ_qdisc
 *, );

58 
¹Æ_Ã‹m_g‘_d–ay
(
¹Æ_qdisc
 *);

60 
¹Æ_Ã‹m_£t_j™‹r
(
¹Æ_qdisc
 *, );

61 
¹Æ_Ã‹m_g‘_j™‹r
(
¹Æ_qdisc
 *);

63 
¹Æ_Ã‹m_£t_d–ay_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *, );

64 
¹Æ_Ã‹m_g‘_d–ay_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *);

67 
	#MAXDIST
 65536

	)

68 
¹Æ_Ã‹m_£t_d–ay_di¡ributiÚ
(
¹Æ_qdisc
 *, const *);

69 
¹Æ_Ã‹m_g‘_d–ay_di¡ributiÚ_size
(
¹Æ_qdisc
 *);

70 
¹Æ_Ã‹m_g‘_d–ay_di¡ributiÚ
(
¹Æ_qdisc
 *, 
št16_t
 **);

72 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/plug.h

12 #iâdeà
NETLINK_PLUG_H_


13 
	#NETLINK_PLUG_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_qdisc_¶ug_£t_lim™
(
¹Æ_qdisc
 *, );

23 
¹Æ_qdisc_¶ug_bufãr
(
¹Æ_qdisc
 *);

24 
¹Æ_qdisc_¶ug_»Ëa£_Úe
(
¹Æ_qdisc
 *);

25 
¹Æ_qdisc_¶ug_»Ëa£_šdefš™e
(
¹Æ_qdisc
 *);

27 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/prio.h

12 #iâdeà
NETLINK_PRIO_H_


13 
	#NETLINK_PRIO_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


31 
	#QDISC_PRIO_DEFAULT_BANDS
 3

	)

37 
	#QDISC_PRIO_DEFAULT_PRIOMAP
 \

38 { 1, 2, 2, 2, 1, 2, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1 }

	)

42 
¹Æ_qdisc_´io_£t_bªds
(
¹Æ_qdisc
 *, );

43 
¹Æ_qdisc_´io_g‘_bªds
(
¹Æ_qdisc
 *);

44 
¹Æ_qdisc_´io_£t_´iom­
(
¹Æ_qdisc
 *, 
ušt8_t
[], );

45 
ušt8_t
 *
¹Æ_qdisc_´io_g‘_´iom­
(
¹Æ_qdisc
 *);

47 * 
¹Æ_´io2¡r
(, *, 
size_t
);

48 
¹Æ_¡r2´io
(const *);

50 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/red.h

12 #iâdeà
NETLINK_RED_H_


13 
	#NETLINK_RED_H_


	)

15 
	~<Ãšk/Ãšk.h
>

	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/sfq.h

12 #iâdeà
NETLINK_SFQ_H_


13 
	#NETLINK_SFQ_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

18 #ifdeà
__ılu¥lus


22 
¹Æ_sfq_£t_quªtum
(
¹Æ_qdisc
 *, );

23 
¹Æ_sfq_g‘_quªtum
(
¹Æ_qdisc
 *);

25 
¹Æ_sfq_£t_lim™
(
¹Æ_qdisc
 *, );

26 
¹Æ_sfq_g‘_lim™
(
¹Æ_qdisc
 *);

28 
¹Æ_sfq_£t_³¹urb
(
¹Æ_qdisc
 *, );

29 
¹Æ_sfq_g‘_³¹urb
(
¹Æ_qdisc
 *);

31 
¹Æ_sfq_g‘_divisÜ
(
¹Æ_qdisc
 *);

33 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/qdisc/tbf.h

12 #iâdeà
NETLINK_TBF_H_


13 
	#NETLINK_TBF_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/tc.h
>

17 
	~<Ãšk/rou‹/qdisc.h
>

19 #ifdeà
__ılu¥lus


23 
¹Æ_qdisc_tbf_£t_lim™
(
¹Æ_qdisc
 *, );

24 
¹Æ_qdisc_tbf_£t_lim™_by_Ï‹ncy
(
¹Æ_qdisc
 *, );

25 
¹Æ_qdisc_tbf_g‘_lim™
(
¹Æ_qdisc
 *);

27 
¹Æ_qdisc_tbf_£t_¿‹
(
¹Æ_qdisc
 *, , , );

28 
¹Æ_qdisc_tbf_g‘_¿‹
(
¹Æ_qdisc
 *);

29 
¹Æ_qdisc_tbf_g‘_¿‹_buck‘
(
¹Æ_qdisc
 *);

30 
¹Æ_qdisc_tbf_g‘_¿‹_ûÎ
(
¹Æ_qdisc
 *);

32 
¹Æ_qdisc_tbf_£t_³ak¿‹
(
¹Æ_qdisc
 *, , , );

33 
¹Æ_qdisc_tbf_g‘_³ak¿‹
(
¹Æ_qdisc
 *);

34 
¹Æ_qdisc_tbf_g‘_³ak¿‹_buck‘
(
¹Æ_qdisc
 *);

35 
¹Æ_qdisc_tbf_g‘_³ak¿‹_ûÎ
(
¹Æ_qdisc
 *);

37 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/route.h

12 #iâdeà
NETLINK_ROUTE_H_


13 
	#NETLINK_ROUTE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

18 
	~<Ãšk/d©a.h
>

19 
	~<Ãšk/rou‹/Ãxthİ.h
>

20 
	~<Ãšk/rou‹/¹Æ.h
>

21 
	~<lšux/š_rou‹.h
>

23 #ifdeà
__ılu¥lus


33 
	#ROUTE_CACHE_CONTENT
 1

	)

35 
¹Æ_rou‹
;

37 
	s¹Æ_¹ÿchešfo


39 
ušt32_t
 
¹ci_şÁ»f
;

40 
ušt32_t
 
¹ci_Ï¡_u£
;

41 
ušt32_t
 
¹ci_expœes
;

42 
št32_t
 
¹ci_”rÜ
;

43 
ušt32_t
 
¹ci_u£d
;

44 
ušt32_t
 
¹ci_id
;

45 
ušt32_t
 
¹ci_ts
;

46 
ušt32_t
 
¹ci_t§ge
;

49 
Æ_objeù_İs
 
rou‹_obj_İs
;

51 
¹Æ_rou‹
 * 
¹Æ_rou‹_®loc
();

52 
¹Æ_rou‹_put
(
¹Æ_rou‹
 *);

53 
¹Æ_rou‹_®loc_ÿche
(
Æ_sock
 *, , ,

54 
Æ_ÿche
 **);

56 
¹Æ_rou‹_g‘
(
¹Æ_rou‹
 *);

58 
¹Æ_rou‹_·r£
(
Æmsghdr
 *, 
¹Æ_rou‹
 **);

59 
¹Æ_rou‹_bud_msg
(
Æ_msg
 *, 
¹Æ_rou‹
 *);

61 
¹Æ_rou‹_bud_add_»que¡
(
¹Æ_rou‹
 *, ,

62 
Æ_msg
 **);

63 
¹Æ_rou‹_add
(
Æ_sock
 *, 
¹Æ_rou‹
 *, );

64 
¹Æ_rou‹_bud_d–_»que¡
(
¹Æ_rou‹
 *, ,

65 
Æ_msg
 **);

66 
¹Æ_rou‹_d–‘e
(
Æ_sock
 *, 
¹Æ_rou‹
 *, );

68 
¹Æ_rou‹_£t_bË
(
¹Æ_rou‹
 *, 
ušt32_t
);

69 
ušt32_t
 
¹Æ_rou‹_g‘_bË
(
¹Æ_rou‹
 *);

70 
¹Æ_rou‹_£t_scİe
(
¹Æ_rou‹
 *, 
ušt8_t
);

71 
ušt8_t
 
¹Æ_rou‹_g‘_scİe
(
¹Æ_rou‹
 *);

72 
¹Æ_rou‹_£t_tos
(
¹Æ_rou‹
 *, 
ušt8_t
);

73 
ušt8_t
 
¹Æ_rou‹_g‘_tos
(
¹Æ_rou‹
 *);

74 
¹Æ_rou‹_£t_´ÙocŞ
(
¹Æ_rou‹
 *, 
ušt8_t
);

75 
ušt8_t
 
¹Æ_rou‹_g‘_´ÙocŞ
(
¹Æ_rou‹
 *);

76 
¹Æ_rou‹_£t_´iÜ™y
(
¹Æ_rou‹
 *, 
ušt32_t
);

77 
ušt32_t
 
¹Æ_rou‹_g‘_´iÜ™y
(
¹Æ_rou‹
 *);

78 
¹Æ_rou‹_£t_çmy
(
¹Æ_rou‹
 *, 
ušt8_t
);

79 
ušt8_t
 
¹Æ_rou‹_g‘_çmy
(
¹Æ_rou‹
 *);

80 
¹Æ_rou‹_£t_ty³
(
¹Æ_rou‹
 *, 
ušt8_t
);

81 
ušt8_t
 
¹Æ_rou‹_g‘_ty³
(
¹Æ_rou‹
 *);

82 
¹Æ_rou‹_£t_æags
(
¹Æ_rou‹
 *, 
ušt32_t
);

83 
¹Æ_rou‹_un£t_æags
(
¹Æ_rou‹
 *, 
ušt32_t
);

84 
ušt32_t
 
¹Æ_rou‹_g‘_æags
(
¹Æ_rou‹
 *);

85 
¹Æ_rou‹_£t_m‘ric
(
¹Æ_rou‹
 *, , );

86 
¹Æ_rou‹_un£t_m‘ric
(
¹Æ_rou‹
 *, );

87 
¹Æ_rou‹_g‘_m‘ric
(
¹Æ_rou‹
 *, , 
ušt32_t
 *);

88 
¹Æ_rou‹_£t_d¡
(
¹Æ_rou‹
 *, 
Æ_addr
 *);

89 
Æ_addr
 *
¹Æ_rou‹_g‘_d¡
(
¹Æ_rou‹
 *);

90 
¹Æ_rou‹_£t_¤c
(
¹Æ_rou‹
 *, 
Æ_addr
 *);

91 
Æ_addr
 *
¹Æ_rou‹_g‘_¤c
(
¹Æ_rou‹
 *);

92 
¹Æ_rou‹_£t_´ef_¤c
(
¹Æ_rou‹
 *, 
Æ_addr
 *);

93 
Æ_addr
 *
¹Æ_rou‹_g‘_´ef_¤c
(
¹Æ_rou‹
 *);

94 
¹Æ_rou‹_£t_iif
(
¹Æ_rou‹
 *, );

95 
¹Æ_rou‹_g‘_iif
(
¹Æ_rou‹
 *);

96 
¹Æ_rou‹_g‘_¤c_Ën
(
¹Æ_rou‹
 *);

98 
¹Æ_rou‹_add_Ãxthİ
(
¹Æ_rou‹
 *,

99 
¹Æ_Ãxthİ
 *);

100 
¹Æ_rou‹_»move_Ãxthİ
(
¹Æ_rou‹
 *,

101 
¹Æ_Ãxthİ
 *);

102 
Æ_li¡_h—d
 *
¹Æ_rou‹_g‘_Ãxthİs
(
¹Æ_rou‹
 *);

103 
¹Æ_rou‹_g‘_Âexthİs
(
¹Æ_rou‹
 *);

105 
¹Æ_rou‹_fÜ—ch_Ãxthİ
(
¹Æ_rou‹
 *
r
,

106 (*
cb
)(
¹Æ_Ãxthİ
 *, *),

107 *
¬g
);

109 
¹Æ_Ãxthİ
 * 
¹Æ_rou‹_Ãxthİ_n
(
¹Æ_rou‹
 *
r
, 
n
);

111 
¹Æ_rou‹_guess_scİe
(
¹Æ_rou‹
 *);

113 * 
¹Æ_rou‹_bË2¡r
(, *, 
size_t
);

114 
¹Æ_rou‹_¡r2bË
(const *);

115 
¹Æ_rou‹_»ad_bË_Çmes
(const *);

117 * 
¹Æ_rou‹_´Ùo2¡r
(, *, 
size_t
);

118 
¹Æ_rou‹_¡r2´Ùo
(const *);

119 
¹Æ_rou‹_»ad_´ÙocŞ_Çmes
(const *);

121 * 
¹Æ_rou‹_m‘ric2¡r
(, *, 
size_t
);

122 
¹Æ_rou‹_¡r2m‘ric
(const *);

124 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/rtnl.h

12 #iâdeà
NETLINK_RTNL_H_


13 
	#NETLINK_RTNL_H_


	)

15 
	~<Ãšk/Ãšk.h
>

17 #ifdeà
__ılu¥lus


30 
	#RTNL_REALM_MASK
 (0xFFFF)

	)

35 
	#RTNL_REALM_FROM
(
»®m
è(Ô—lmè>> 16)

	)

40 
	#RTNL_REALM_TO
(
»®m
è(Ô—lmè& 
RTNL_REALM_MASK
)

	)

45 
	#RTNL_MAKE_REALM
(
äom
, 
to
) \

46 ((
	`RTNL_REALM_TO
(
äom
è<< 16è& RTNL_REALM_TO(
to
))

	)

52 
Æ_¹g’_»que¡
(
Æ_sock
 *, , , );

55 * 
Æ_¹Áy³2¡r
(, *, 
size_t
);

56 
Æ_¡r2¹Áy³
(const *);

59 * 
¹Æ_scİe2¡r
(, *, 
size_t
);

60 
¹Æ_¡r2scİe
(const *);

63 * 
¹Æ_»®ms2¡r
(
ušt32_t
, *, 
size_t
);

65 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/rule.h

12 #iâdeà
NETLINK_RULE_H_


13 
	#NETLINK_RULE_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/addr.h
>

18 
	~<Ãšk/rou‹/rou‹.h
>

19 
	~<lšux/fib_ruËs.h
>

21 #ifdeà
__ılu¥lus


25 
¹Æ_ruË
;

28 
¹Æ_ruË
 * 
¹Æ_ruË_®loc
();

29 
¹Æ_ruË_put
(
¹Æ_ruË
 *);

31 
¹Æ_ruË_®loc_ÿche
(
Æ_sock
 *, ,

32 
Æ_ÿche
 **);

33 
¹Æ_ruË_dump
(
¹Æ_ruË
 *, 
FILE
 *, 
Æ_dump_·¿ms
 *);

35 
¹Æ_ruË_bud_add_»que¡
(
¹Æ_ruË
 *, ,

36 
Æ_msg
 **);

37 
¹Æ_ruË_add
(
Æ_sock
 *, 
¹Æ_ruË
 *, );

38 
¹Æ_ruË_bud_d–‘e_»que¡
(
¹Æ_ruË
 *, ,

39 
Æ_msg
 **);

40 
¹Æ_ruË_d–‘e
(
Æ_sock
 *, 
¹Æ_ruË
 *, );

44 
¹Æ_ruË_£t_çmy
(
¹Æ_ruË
 *, );

45 
¹Æ_ruË_g‘_çmy
(
¹Æ_ruË
 *);

46 
¹Æ_ruË_£t_´io
(
¹Æ_ruË
 *, 
ušt32_t
);

47 
ušt32_t
 
¹Æ_ruË_g‘_´io
(
¹Æ_ruË
 *);

48 
¹Æ_ruË_£t_m¬k
(
¹Æ_ruË
 *, 
ušt32_t
);

49 
ušt32_t
 
¹Æ_ruË_g‘_m¬k
(
¹Æ_ruË
 *);

50 
¹Æ_ruË_£t_mask
(
¹Æ_ruË
 *, 
ušt32_t
);

51 
ušt32_t
 
¹Æ_ruË_g‘_mask
(
¹Æ_ruË
 *);

52 
¹Æ_ruË_£t_bË
(
¹Æ_ruË
 *, 
ušt32_t
);

53 
ušt32_t
 
¹Æ_ruË_g‘_bË
(
¹Æ_ruË
 *);

54 
¹Æ_ruË_£t_dsf›ld
(
¹Æ_ruË
 *, 
ušt8_t
);

55 
ušt8_t
 
¹Æ_ruË_g‘_dsf›ld
(
¹Æ_ruË
 *);

56 
¹Æ_ruË_£t_¤c
(
¹Æ_ruË
 *, 
Æ_addr
 *);

57 
Æ_addr
 * 
¹Æ_ruË_g‘_¤c
(
¹Æ_ruË
 *);

58 
¹Æ_ruË_£t_d¡
(
¹Æ_ruË
 *, 
Æ_addr
 *);

59 
Æ_addr
 * 
¹Æ_ruË_g‘_d¡
(
¹Æ_ruË
 *);

60 
¹Æ_ruË_£t_aùiÚ
(
¹Æ_ruË
 *, 
ušt8_t
);

61 
ušt8_t
 
¹Æ_ruË_g‘_aùiÚ
(
¹Æ_ruË
 *);

62 
¹Æ_ruË_£t_iif
(
¹Æ_ruË
 *, const *);

63 * 
¹Æ_ruË_g‘_iif
(
¹Æ_ruË
 *);

64 
¹Æ_ruË_£t_oif
(
¹Æ_ruË
 *, const *);

65 * 
¹Æ_ruË_g‘_oif
(
¹Æ_ruË
 *);

66 
¹Æ_ruË_£t_»®ms
(
¹Æ_ruË
 *, 
ušt32_t
);

67 
ušt32_t
 
¹Æ_ruË_g‘_»®ms
(
¹Æ_ruË
 *);

68 
¹Æ_ruË_£t_gÙo
(
¹Æ_ruË
 *, 
ušt32_t
);

69 
ušt32_t
 
¹Æ_ruË_g‘_gÙo
(
¹Æ_ruË
 *);

71 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/route/tc-api.h

12 #iâdeà
NETLINK_DUMMY_TC_API_H_


13 
	#NETLINK_DUMMY_TC_API_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/msg.h
>

17 
	~<Ãšk/rou‹/tc.h
>

	@mylibnl/libnl-3.2.25/include/netlink/route/tc.h

12 #iâdeà
NETLINK_TC_H_


13 
	#NETLINK_TC_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/ÿche.h
>

17 
	~<Ãšk/d©a.h
>

18 
	~<Ãšk/rou‹/lšk.h
>

19 
	~<lšux/pkt_sched.h
>

20 
	~<lšux/pkt_şs.h
>

22 #ifdeà
__ılu¥lus


26 
	e¹Æ_tc_ty³
 {

27 
RTNL_TC_TYPE_QDISC
,

28 
RTNL_TC_TYPE_CLASS
,

29 
RTNL_TC_TYPE_CLS
,

30 
RTNL_TC_TYPE_ACT
,

31 
__RTNL_TC_TYPE_MAX
,

34 
	#RTNL_TC_TYPE_MAX
 (
__RTNL_TC_TYPE_MAX
 - 1)

	)

40 
	#TC_HANDLE
(
maj
, 
mš
è(
	`TC_H_MAJ
((majè<< 16è| 
	`TC_H_MIN
(mš))

	)

46 
¹Æ_tc
;

56 
	#TC_CAST
(
±r
è((
¹Æ_tc
 *èÕŒ))

	)

66 
	e¹Æ_tc_¡©
 {

67 
RTNL_TC_PACKETS
,

68 
RTNL_TC_BYTES
,

69 
RTNL_TC_RATE_BPS
,

70 
RTNL_TC_RATE_PPS
,

71 
RTNL_TC_QLEN
,

72 
RTNL_TC_BACKLOG
,

73 
RTNL_TC_DROPS
,

74 
RTNL_TC_REQUEUES
,

75 
RTNL_TC_OVERLIMITS
,

76 
__RTNL_TC_STATS_MAX
,

79 
	#RTNL_TC_STATS_MAX
 (
__RTNL_TC_STATS_MAX
 - 1)

	)

81 
¹Æ_tc_£t_ifšdex
(
¹Æ_tc
 *, );

82 
¹Æ_tc_g‘_ifšdex
(
¹Æ_tc
 *);

83 
¹Æ_tc_£t_lšk
(
¹Æ_tc
 *, 
¹Æ_lšk
 *);

84 
¹Æ_lšk
 *
¹Æ_tc_g‘_lšk
(
¹Æ_tc
 *);

85 
¹Æ_tc_£t_mtu
(
¹Æ_tc
 *, 
ušt32_t
);

86 
ušt32_t
 
¹Æ_tc_g‘_mtu
(
¹Æ_tc
 *);

87 
¹Æ_tc_£t_mpu
(
¹Æ_tc
 *, 
ušt32_t
);

88 
ušt32_t
 
¹Æ_tc_g‘_mpu
(
¹Æ_tc
 *);

89 
¹Æ_tc_£t_ov”h—d
(
¹Æ_tc
 *, 
ušt32_t
);

90 
ušt32_t
 
¹Æ_tc_g‘_ov”h—d
(
¹Æ_tc
 *);

91 
¹Æ_tc_£t_lškty³
(
¹Æ_tc
 *, 
ušt32_t
);

92 
ušt32_t
 
¹Æ_tc_g‘_lškty³
(
¹Æ_tc
 *);

93 
¹Æ_tc_£t_hªdË
(
¹Æ_tc
 *, 
ušt32_t
);

94 
ušt32_t
 
¹Æ_tc_g‘_hªdË
(
¹Æ_tc
 *);

95 
¹Æ_tc_£t_·»Á
(
¹Æ_tc
 *, 
ušt32_t
);

96 
ušt32_t
 
¹Æ_tc_g‘_·»Á
(
¹Æ_tc
 *);

97 
¹Æ_tc_£t_kšd
(
¹Æ_tc
 *, const *);

98 * 
¹Æ_tc_g‘_kšd
(
¹Æ_tc
 *);

99 
ušt64_t
 
¹Æ_tc_g‘_¡©
(
¹Æ_tc
 *, 
¹Æ_tc_¡©
);

101 
¹Æ_tc_ÿlc_txtime
(, );

102 
¹Æ_tc_ÿlc_bufsize
(, );

103 
¹Æ_tc_ÿlc_ûÎ_log
();

105 
¹Æ_tc_»ad_şassid_fe
();

106 * 
¹Æ_tc_hªdË2¡r
(
ušt32_t
, *, 
size_t
);

107 
¹Æ_tc_¡r2hªdË
(cÚ¡ *, 
ušt32_t
 *);

108 
¹Æ_şassid_g’”©e
(cÚ¡ *, 
ušt32_t
 *,

109 
ušt32_t
);

111 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/socket.h

12 #iâdeà
NETLINK_SOCKET_H_


13 
	#NETLINK_SOCKET_H_


	)

15 
	~<Ãšk/ty³s.h
>

16 
	~<Ãšk/hªdËrs.h
>

18 #ifdeà
__ılu¥lus


22 
Æ_sock
 * 
Æ_sock‘_®loc
();

23 
Æ_sock
 * 
Æ_sock‘_®loc_cb
(
Æ_cb
 *);

24 
Æ_sock‘_ä“
(
Æ_sock
 *);

26 
ušt32_t
 
Æ_sock‘_g‘_loÿl_pÜt
(cÚ¡ 
Æ_sock
 *);

27 
Æ_sock‘_£t_loÿl_pÜt
(
Æ_sock
 *, 
ušt32_t
);

29 
Æ_sock‘_add_memb”shs
(
Æ_sock
 *, , ...);

30 
Æ_sock‘_add_memb”sh
(
Æ_sock
 *, );

31 
Æ_sock‘_drİ_memb”shs
(
Æ_sock
 *, , ...);

32 
Æ_sock‘_drİ_memb”sh
(
Æ_sock
 *,

34 
Æ_još_groups
(
Æ_sock
 *, );

37 
ušt32_t
 
Æ_sock‘_g‘_³”_pÜt
(cÚ¡ 
Æ_sock
 *);

38 
Æ_sock‘_£t_³”_pÜt
(
Æ_sock
 *,

39 
ušt32_t
);

40 
ušt32_t
 
Æ_sock‘_g‘_³”_groups
(cÚ¡ 
Æ_sock
 *
sk
);

41 
Æ_sock‘_£t_³”_groups
(
Æ_sock
 *
sk
, 
ušt32_t
 
groups
);

42 
Æ_cb
 * 
Æ_sock‘_g‘_cb
(cÚ¡ 
Æ_sock
 *);

43 
Æ_sock‘_£t_cb
(
Æ_sock
 *,

44 
Æ_cb
 *);

45 
Æ_sock‘_modify_cb
(
Æ_sock
 *, 
Æ_cb_ty³
,

46 
Æ_cb_kšd
,

47 
Æ_»cvmsg_msg_cb_t
, *);

48 
Æ_sock‘_modify_”r_cb
(
Æ_sock
 *, 
Æ_cb_kšd
,

49 
Æ_»cvmsg_”r_cb_t
, *);

51 
Æ_sock‘_£t_bufãr_size
(
Æ_sock
 *, , );

52 
Æ_sock‘_£t_msg_buf_size
(
Æ_sock
 *, 
size_t
);

53 
size_t
 
Æ_sock‘_g‘_msg_buf_size
(
Æ_sock
 *);

54 
Æ_sock‘_£t_·ssüed
(
Æ_sock
 *, );

55 
Æ_sock‘_»cv_pktšfo
(
Æ_sock
 *, );

57 
Æ_sock‘_di§bË_£q_check
(
Æ_sock
 *);

58 
Æ_sock‘_u£_£q
(
Æ_sock
 *);

59 
Æ_sock‘_di§bË_auto_ack
(
Æ_sock
 *);

60 
Æ_sock‘_’abË_auto_ack
(
Æ_sock
 *);

62 
Æ_sock‘_g‘_fd
(cÚ¡ 
Æ_sock
 *);

63 
Æ_sock‘_£t_nÚblockšg
(cÚ¡ 
Æ_sock
 *);

64 
Æ_sock‘_’abË_msg_³ek
(
Æ_sock
 *);

65 
Æ_sock‘_di§bË_msg_³ek
(
Æ_sock
 *);

67 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/types.h

12 #iâdeà
__NETLINK_TYPES_H_


13 
	#__NETLINK_TYPES_H_


	)

15 
	~<¡dio.h
>

21 
	eÆ_dump_ty³
 {

22 
	mNL_DUMP_LINE
,

23 
	mNL_DUMP_DETAILS
,

24 
	mNL_DUMP_STATS
,

25 
	m__NL_DUMP_MAX
,

27 
	#NL_DUMP_MAX
 (
__NL_DUMP_MAX
 - 1)

	)

33 
	sÆ_dump_·¿ms


38 
Æ_dump_ty³
 
	mdp_ty³
;

44 
	mdp_´efix
;

49 
	mdp_´št_šdex
;

54 
	mdp_dump_msgty³
;

63 (*
	mdp_cb
)(
	mÆ_dump_·¿ms
 *, *);

73 (*
	mdp_Æ_cb
)(
	mÆ_dump_·¿ms
 *, );

78 *
	mdp_d©a
;

83 
FILE
 * 
	mdp_fd
;

88 * 
	mdp_buf
;

93 
size_t
 
	mdp_buæ’
;

99 
	mdp_´e_dump
;

105 
	mdp_iv¬
;

107 
	mdp_lše
;

	@mylibnl/libnl-3.2.25/include/netlink/utils.h

12 #iâdeà
NETLINK_UTILS_H_


13 
	#NETLINK_UTILS_H_


	)

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/li¡.h
>

18 #ifdeà
__ılu¥lus


31 
	#NL_PROB_MIN
 0x0

	)

37 
	#NL_PROB_MAX
 0xffffffff

	)

42 
NL_BYTE_RATE
,

43 
NL_BIT_RATE
,

47 
Æ_ÿnûl_down_by‹s
(, **);

48 
Æ_ÿnûl_down_b™s
(, **);

49 
Æ_¿‹2¡r
(, , *, 
size_t
);

50 
Æ_ÿnûl_down_us
(
ušt32_t
, **);

53 
Æ_size2št
(const *);

54 * 
Æ_size2¡r
(cÚ¡ 
size_t
, *, const size_t);

55 
Æ_´ob2št
(const *);

58 
Æ_g‘_u£r_hz
();

59 
Æ_g‘_psched_hz
();

60 
ušt32_t
 
Æ_us2ticks
(uint32_t);

61 
ušt32_t
 
Æ_ticks2us
(uint32_t);

62 
Æ_¡r2m£c
(cÚ¡ *, 
ušt64_t
 *);

63 * 
Æ_m£c2¡r
(
ušt64_t
, *, 
size_t
);

66 * 
Æ_Î´Ùo2¡r
(, *, 
size_t
);

67 
Æ_¡r2Î´Ùo
(const *);

70 * 
Æ_‘h”_´Ùo2¡r
(, *, 
size_t
);

71 
Æ_¡r2‘h”_´Ùo
(const *);

74 * 
Æ__´Ùo2¡r
(, *, 
size_t
);

75 
Æ_¡r2_´Ùo
(const *);

78 
Æ_Ãw_lše
(
Æ_dump_·¿ms
 *);

79 
Æ_dump
(
Æ_dump_·¿ms
 *, const *, ...);

80 
Æ_dump_lše
(
Æ_dump_·¿ms
 *, const *, ...);

83 
	gNL_CAPABILITY_NONE
,

90 
	gNL_CAPABILITY_ROUTE_BUILD_MSG_SET_SCOPE
 = 1,

91 
	#NL_CAPABILITY_ROUTE_BUILD_MSG_SET_SCOPE
 
NL_CAPABILITY_ROUTE_BUILD_MSG_SET_SCOPE


	)

97 
	gNL_CAPABILITY_ROUTE_LINK_VETH_GET_PEER_OWN_REFERENCE
 = 2,

98 
	#NL_CAPABILITY_ROUTE_LINK_VETH_GET_PEER_OWN_REFERENCE
 
NL_CAPABILITY_ROUTE_LINK_VETH_GET_PEER_OWN_REFERENCE


	)

104 
	gNL_CAPABILITY_ROUTE_LINK_CLS_ADD_ACT_OWN_REFERENCE
 = 3,

105 
	#NL_CAPABILITY_ROUTE_LINK_CLS_ADD_ACT_OWN_REFERENCE
 
NL_CAPABILITY_ROUTE_LINK_CLS_ADD_ACT_OWN_REFERENCE


	)

113 
	gNL_CAPABILITY_NL_CONNECT_RETRY_GENERATE_PORT_ON_ADDRINUSE
 = 4,

114 
	#NL_CAPABILITY_NL_CONNECT_RETRY_GENERATE_PORT_ON_ADDRINUSE
 
NL_CAPABILITY_NL_CONNECT_RETRY_GENERATE_PORT_ON_ADDRINUSE


	)

116 
	g__NL_CAPABILITY_MAX


117 
	#NL_CAPABILITY_MAX
 (
__NL_CAPABILITY_MAX
 - 1)

	)

119 
Æ_has_ÿ·b™y
 (
ÿ·b™y
);

121 #ifdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/include/netlink/version.h

12 #iâdeà
NETLINK_VERSION_H_


13 
	#NETLINK_VERSION_H_


	)

17 
	#LIBNL_STRING
 "libÆ 3.2.25"

	)

18 
	#LIBNL_VERSION
 "3.2.25"

	)

20 
	#LIBNL_VER_MAJ
 3

	)

21 
	#LIBNL_VER_MIN
 2

	)

22 
	#LIBNL_VER_MIC
 25

	)

23 
	#LIBNL_VER
(
maj
,
mš
è((majè<< 8 | (mš))

	)

24 
	#LIBNL_VER_NUM
 
	`LIBNL_VER
(
LIBNL_VER_MAJ
, 
LIBNL_VER_MIN
)

	)

26 
	#LIBNL_CURRENT
 220

	)

27 
	#LIBNL_REVISION
 0

	)

28 
	#LIBNL_AGE
 20

	)

32 cÚ¡ 
Æ_v”_num
;

33 cÚ¡ 
Æ_v”_maj
;

34 cÚ¡ 
Æ_v”_mš
;

35 cÚ¡ 
Æ_v”_mic
;

	@mylibnl/libnl-3.2.25/lib/addr.c

30 
	~<Ãšk-´iv©e/Ãšk.h
>

31 
	~<Ãšk/Ãšk.h
>

32 
	~<Ãšk/uts.h
>

33 
	~<Ãšk/addr.h
>

34 
	~<lšux/sock‘.h
>

38 
šlše
 
ušt16_t
 
	$dn_Áohs
(
ušt16_t
 
addr
)

41 
ušt8_t
 
by‹
[2];

42 
ušt16_t
 
wÜd
;

43 } 
u
 = {

44 .
wÜd
 = 
addr
,

47  ((
ušt16_t
è
u
.
by‹
[0]) | (((uint16_t) u.byte[1]) << 8);

48 
	}
}

50 
šlše
 
	$do_dig™
(*
¡r
, 
ušt16_t
 *
addr
, ušt16_ˆ
sÿË
,

51 
size_t
 *
pos
, size_ˆ
Ën
, *
¡¬‹d
)

53 
ušt16_t
 
tmp
 = *
addr
 / 
sÿË
;

55 ià(*
pos
 =ğ
Ën
)

58 ià(((
tmp
è> 0è|| *
¡¬‹d
 || (
sÿË
 == 1)) {

59 *
¡r
 = 
tmp
 + '0';

60 *
¡¬‹d
 = 1;

61 (*
pos
)++;

62 *
addr
 -ğ(
tmp
 * 
sÿË
);

66 
	}
}

68 cÚ¡ *
	$dÃt_Áİ
(*
addrbuf
, 
size_t
 
add¾’
, *
¡r
,

69 
size_t
 
Ën
)

71 
ušt16_t
 
addr
 = 
	`dn_Áohs
(*(ušt16_ˆ*)
addrbuf
);

72 
ušt16_t
 
¬—
 = 
addr
 >> 10;

73 
size_t
 
pos
 = 0;

74 
¡¬‹d
 = 0;

76 ià(
add¾’
 != 2)

77  
NULL
;

79 
addr
 &= 0x03ff;

81 ià(
Ën
 == 0)

82  
¡r
;

84 ià(
	`do_dig™
(
¡r
 + 
pos
, &
¬—
, 10, &pos, 
Ën
, &
¡¬‹d
))

85  
¡r
;

87 ià(
	`do_dig™
(
¡r
 + 
pos
, &
¬—
, 1, &pos, 
Ën
, &
¡¬‹d
))

88  
¡r
;

90 ià(
pos
 =ğ
Ën
)

91  
¡r
;

93 *(
¡r
 + 
pos
) = '.';

94 
pos
++;

95 
¡¬‹d
 = 0;

97 ià(
	`do_dig™
(
¡r
 + 
pos
, &
addr
, 1000, &pos, 
Ën
, &
¡¬‹d
))

98  
¡r
;

100 ià(
	`do_dig™
(
¡r
 + 
pos
, &
addr
, 100, &pos, 
Ën
, &
¡¬‹d
))

101  
¡r
;

103 ià(
	`do_dig™
(
¡r
 + 
pos
, &
addr
, 10, &pos, 
Ën
, &
¡¬‹d
))

104  
¡r
;

106 ià(
	`do_dig™
(
¡r
 + 
pos
, &
addr
, 1, &pos, 
Ën
, &
¡¬‹d
))

107  
¡r
;

109 ià(
pos
 =ğ
Ën
)

110  
¡r
;

112 *(
¡r
 + 
pos
) = 0;

114  
¡r
;

115 
	}
}

117 
	$dÃt_num
(cÚ¡ *
¤c
, 
ušt16_t
 * 
d¡
)

119 
rv
 = 0;

120 
tmp
;

121 *
d¡
 = 0;

123 (
tmp
 = *
¤c
++) != 0) {

124 
tmp
 -= '0';

125 ià((
tmp
 < 0) || (tmp > 9))

126  
rv
;

128 
rv
++;

129 (*
d¡
) *= 10;

130 (*
d¡
è+ğ
tmp
;

133  
rv
;

134 
	}
}

136 
šlše
 
	$dÃt_±Ú
(cÚ¡ *
¤c
, *
addrbuf
)

138 
ušt16_t
 
¬—
 = 0;

139 
ušt16_t
 
node
 = 0;

140 
pos
;

142 
pos
 = 
	`dÃt_num
(
¤c
, &
¬—
);

143 ià((
pos
 =ğ0è|| (
¬—
 > 63) ||

144 ((*(
¤c
 + 
pos
) != '.') && (*(src +…os) != ',')))

145  -
NLE_INVAL
;

147 
pos
 = 
	`dÃt_num
(
¤c
 +…o + 1, &
node
);

148 ià((
pos
 =ğ0è|| (
node
 > 1023))

149  -
NLE_INVAL
;

151 *(
ušt16_t
 *)
addrbuf
 = 
	`dn_Áohs
((
¬—
 << 10è| 
node
);

154 
	}
}

156 
	$addr_de¡roy
(
Æ_addr
 *
addr
)

158 ià(!
addr
)

161 ià(
addr
->
a_»fút
 != 1)

162 
	`BUG
();

164 
	`ä“
(
addr
);

165 
	}
}

185 
Æ_addr
 *
	$Æ_addr_®loc
(
size_t
 
maxsize
)

187 
Æ_addr
 *
addr
;

189 
addr
 = 
	`ÿÎoc
(1, (*addrè+ 
maxsize
);

190 ià(!
addr
)

191  
NULL
;

193 
addr
->
a_»fút
 = 1;

194 
addr
->
a_maxsize
 = 
maxsize
;

196  
addr
;

197 
	}
}

216 
Æ_addr
 *
	$Æ_addr_bud
(
çmy
, *
buf
, 
size_t
 
size
)

218 
Æ_addr
 *
addr
;

220 
addr
 = 
	`Æ_addr_®loc
(
size
);

221 ià(!
addr
)

222  
NULL
;

224 
addr
->
a_çmy
 = 
çmy
;

225 
addr
->
a_Ën
 = 
size
;

226 
addr
->
a_´efixËn
 = 
size
*8;

228 ià(
size
)

229 
	`memıy
(
addr
->
a_addr
, 
buf
, 
size
);

231  
addr
;

232 
	}
}

255 
Æ_addr
 *
	$Æ_addr_®loc_©Œ
(
Æ©Œ
 *
Æa
, 
çmy
)

257  
	`Æ_addr_bud
(
çmy
, 
	`Æa_d©a
(
Æa
), 
	`Æa_Ën
(nla));

258 
	}
}

291 
	$Æ_addr_·r£
(cÚ¡ *
addr¡r
, 
hšt
, 
Æ_addr
 **
»suÉ
)

293 
”r
, 
cİy
 = 0, 
Ën
 = 0, 
çmy
 = 
AF_UNSPEC
;

294 *
¡r
, *
´efix
, 
buf
[32];

295 
Æ_addr
 *
addr
 = 
NULL
;

297 
¡r
 = 
	`¡rdup
(
addr¡r
);

298 ià(!
¡r
) {

299 
”r
 = -
NLE_NOMEM
;

300 
”rout
;

303 
´efix
 = 
	`¡rchr
(
¡r
, '/');

304 ià(
´efix
)

305 *
´efix
 = '\0';

307 ià(!
	`¡rÿ£cmp
(
¡r
, "none")) {

308 
çmy
 = 
hšt
;

309 
´efix
;

312 ià(!
	`¡rÿ£cmp
(
¡r
, "default") ||

313 !
	`¡rÿ£cmp
(
¡r
, "all") ||

314 !
	`¡rÿ£cmp
(
¡r
, "any")) {

316 
Ën
 = 0;

318 
hšt
) {

319 
AF_INET
:

320 
AF_UNSPEC
:

324 
çmy
 = 
AF_INET
;

325 
´efix
;

327 
AF_INET6
:

328 
çmy
 = 
AF_INET6
;

329 
´efix
;

331 
AF_LLC
:

332 
çmy
 = 
AF_LLC
;

333 
´efix
;

336 
”r
 = -
NLE_AF_NOSUPPORT
;

337 
”rout
;

341 
cİy
 = 1;

343 ià(
hšt
 =ğ
AF_INET
 || hšˆ=ğ
AF_UNSPEC
) {

344 ià(
	`š‘_±Ú
(
AF_INET
, 
¡r
, 
buf
) > 0) {

345 
çmy
 = 
AF_INET
;

346 
Ën
 = 4;

347 
´efix
;

349 ià(
hšt
 =ğ
AF_INET
) {

350 
”r
 = -
NLE_NOADDR
;

351 
”rout
;

355 ià(
hšt
 =ğ
AF_INET6
 || hšˆ=ğ
AF_UNSPEC
) {

356 ià(
	`š‘_±Ú
(
AF_INET6
, 
¡r
, 
buf
) > 0) {

357 
çmy
 = 
AF_INET6
;

358 
Ën
 = 16;

359 
´efix
;

361 ià(
hšt
 =ğ
AF_INET6
) {

362 
”r
 = -
NLE_NOADDR
;

363 
”rout
;

367 ià((
hšt
 =ğ
AF_LLC
 || hšˆ=ğ
AF_UNSPEC
è&& 
	`¡rchr
(
¡r
, ':')) {

368 
a
, 
b
, 
c
, 
d
, 
e
, 
f
;

370 ià(
	`ssÿnf
(
¡r
, "%02x:%02x:%02x:%02x:%02x:%02x",

371 &
a
, &
b
, &
c
, &
d
, &
e
, &
f
) == 6) {

372 
çmy
 = 
AF_LLC
;

373 
Ën
 = 6;

374 
buf
[0] = (è
a
;

375 
buf
[1] = (è
b
;

376 
buf
[2] = (è
c
;

377 
buf
[3] = (è
d
;

378 
buf
[4] = (è
e
;

379 
buf
[5] = (è
f
;

380 
´efix
;

383 ià(
hšt
 =ğ
AF_LLC
) {

384 
”r
 = -
NLE_NOADDR
;

385 
”rout
;

389 ià((
hšt
 =ğ
AF_DECÃt
 || hšˆ=ğ
AF_UNSPEC
) &&

390 (
	`¡rchr
(
¡r
, '.') || strchr(str, ','))) {

391 ià(
	`dÃt_±Ú
(
¡r
, 
buf
) > 0) {

392 
çmy
 = 
AF_DECÃt
;

393 
Ën
 = 2;

394 
´efix
;

396 ià(
hšt
 =ğ
AF_DECÃt
) {

397 
”r
 = -
NLE_NOADDR
;

398 
”rout
;

402 ià(
hšt
 =ğ
AF_UNSPEC
 && 
	`¡rchr
(
¡r
, ':')) {

403 
size_t
 
i
 = 0;

404 *
s
 = 
¡r
, *
p
;

406 
l
 = 
	`¡¹Ş
(
s
, &
p
, 16);

408 ià(
s
 =ğ
p
 || 
l
 > 0xfà|| 
i
 >ğ(
buf
)) {

409 
”r
 = -
NLE_INVAL
;

410 
”rout
;

413 
buf
[
i
++] = (è
l
;

414 ià(*
p
 == '\0')

416 
s
 = ++
p
;

419 
Ën
 = 
i
;

420 
çmy
 = 
AF_UNSPEC
;

421 
´efix
;

424 
”r
 = -
NLE_NOADDR
;

425 
”rout
;

427 
´efix
:

428 
addr
 = 
	`Æ_addr_®loc
(
Ën
);

429 ià(!
addr
) {

430 
”r
 = -
NLE_NOMEM
;

431 
”rout
;

434 
	`Æ_addr_£t_çmy
(
addr
, 
çmy
);

436 ià(
cİy
)

437 
	`Æ_addr_£t_bš¬y_addr
(
addr
, 
buf
, 
Ën
);

439 ià(
´efix
) {

440 *
p
;

441 
¶
 = 
	`¡¹Ş
(++
´efix
, &
p
, 0);

442 ià(
p
 =ğ
´efix
) {

443 
	`addr_de¡roy
(
addr
);

444 
”r
 = -
NLE_INVAL
;

445 
”rout
;

447 
	`Æ_addr_£t_´efixËn
(
addr
, 
¶
);

449 
	`Æ_addr_£t_´efixËn
(
addr
, 
Ën
 * 8);

451 *
»suÉ
 = 
addr
;

452 
”r
 = 0;

453 
”rout
:

454 
	`ä“
(
¡r
);

456  
”r
;

457 
	}
}

471 
Æ_addr
 *
	$Æ_addr_şÚe
(
Æ_addr
 *
addr
)

473 
Æ_addr
 *
Ãw
;

475 
Ãw
 = 
	`Æ_addr_bud
(
addr
->
a_çmy
,‡ddr->
a_addr
,‡ddr->
a_Ën
);

476 ià(
Ãw
)

477 
Ãw
->
a_´efixËn
 = 
addr
->a_prefixlen;

479  
Ãw
;

480 
	}
}

501 
Æ_addr
 *
	$Æ_addr_g‘
(
Æ_addr
 *
addr
)

503 
addr
->
a_»fút
++;

505  
addr
;

506 
	}
}

517 
	$Æ_addr_put
(
Æ_addr
 *
addr
)

519 ià(!
addr
)

522 ià(
addr
->
a_»fút
 == 1)

523 
	`addr_de¡roy
(
addr
);

525 
addr
->
a_»fút
--;

526 
	}
}

534 
	$Æ_addr_sh¬ed
(
Æ_addr
 *
addr
)

536  
addr
->
a_»fút
 > 1;

537 
	}
}

563 
	$Æ_addr_cmp
(
Æ_addr
 *
a
, Æ_add¸*
b
)

565 
d
 = 
a
->
a_çmy
 - 
b
->a_family;

567 ià(
d
 == 0) {

568 
d
 = 
a
->
a_Ën
 - 
b
->a_len;

570 ià(
a
->
a_Ën
 && 
d
 == 0) {

571 
d
 = 
	`memcmp
(
a
->
a_addr
, 
b
->a_addr,‡->
a_Ën
);

573 ià(
d
 == 0)

574  (
a
->
a_´efixËn
 - 
b
->a_prefixlen);

578  
d
;

579 
	}
}

594 
	$Æ_addr_cmp_´efix
(
Æ_addr
 *
a
, Æ_add¸*
b
)

596 
d
 = 
a
->
a_çmy
 - 
b
->a_family;

598 ià(
d
 == 0) {

599 
Ën
 = 
	`mš
(
a
->
a_´efixËn
, 
b
->a_prefixlen);

600 
by‹s
 = 
Ën
 / 8;

602 
d
 = 
	`memcmp
(
a
->
a_addr
, 
b
->a_addr, 
by‹s
);

603 ià(
d
 =ğ0 && (
Ën
 % 8) != 0) {

604 
mask
 = (0xFF00 >> (
Ën
 % 8)) & 0xFF;

606 
d
 = (
a
->
a_addr
[
by‹s
] & 
mask
) -

607 (
b
->
a_addr
[
by‹s
] & 
mask
);

611  
d
;

612 
	}
}

620 
	$Æ_addr_isz”o
(
Æ_addr
 *
addr
)

622 
i
;

624 
i
 = 0; i < 
addr
->
a_Ën
; i++)

625 ià(
addr
->
a_addr
[
i
])

629 
	}
}

639 
	$Æ_addr_v®id
(*
addr
, 
çmy
)

641 
»t
;

642 
buf
[32];

644 
çmy
) {

645 
AF_INET
:

646 
AF_INET6
:

647 
»t
 = 
	`š‘_±Ú
(
çmy
, 
addr
, 
buf
);

648 ià(
»t
 <= 0)

652 
AF_DECÃt
:

653 
»t
 = 
	`dÃt_±Ú
(
addr
, 
buf
);

654 ià(
»t
 <= 0)

658 
AF_LLC
:

659 ià(
	`ssÿnf
(
addr
, "%*02x:%*02x:%*02x:%*02x:%*02x:%*02x") != 6)

665 
	}
}

673 
	$Æ_addr_guess_çmy
(
Æ_addr
 *
addr
)

675 
addr
->
a_Ën
) {

677  
AF_INET
;

679  
AF_LLC
;

681  
AF_INET6
;

683  
AF_UNSPEC
;

685 
	}
}

700 
	$Æ_addr_fl_sockaddr
(
Æ_addr
 *
addr
, 
sockaddr
 *
§
,

701 
sockËn_t
 *
§Ën
)

703 
addr
->
a_çmy
) {

704 
AF_INET
: {

705 
sockaddr_š
 *
§i
 = (sockaddr_š *è
§
;

707 ià(*
§Ën
 < (*
§i
))

708  -
NLE_INVAL
;

710 
§i
->
sš_çmy
 = 
addr
->
a_çmy
;

711 
	`memıy
(&
§i
->
sš_addr
, 
addr
->
a_addr
, 4);

712 *
§Ën
 = (*
§i
);

716 
AF_INET6
: {

717 
sockaddr_š6
 *
§6
 = (sockaddr_š6 *è
§
;

719 ià(*
§Ën
 < (*
§6
))

720  -
NLE_INVAL
;

722 
§6
->
sš6_çmy
 = 
addr
->
a_çmy
;

723 
	`memıy
(&
§6
->
sš6_addr
, 
addr
->
a_addr
, 16);

724 *
§Ën
 = (*
§6
);

729  -
NLE_INVAL
;

733 
	}
}

756 
	$Æ_addr_šfo
(
Æ_addr
 *
addr
, 
addršfo
 **
»suÉ
)

758 
”r
;

759 
buf
[
INET6_ADDRSTRLEN
+5];

760 
addršfo
 
hšt
 = {

761 .
ai_æags
 = 
AI_NUMERICHOST
,

762 .
ai_çmy
 = 
addr
->
a_çmy
,

765 
	`Æ_addr2¡r
(
addr
, 
buf
, (buf));

767 
”r
 = 
	`g‘addršfo
(
buf
, 
NULL
, &
hšt
, 
»suÉ
);

768 ià(
”r
 != 0) {

769 
”r
) {

770 
EAI_ADDRFAMILY
:  -
NLE_AF_NOSUPPORT
;

771 
EAI_AGAIN
:  -
NLE_AGAIN
;

772 
EAI_BADFLAGS
:  -
NLE_INVAL
;

773 
EAI_FAIL
:  -
NLE_NOADDR
;

774 
EAI_FAMILY
:  -
NLE_AF_NOSUPPORT
;

775 
EAI_MEMORY
:  -
NLE_NOMEM
;

776 
EAI_NODATA
:  -
NLE_NOADDR
;

777 
EAI_NONAME
:  -
NLE_OBJ_NOTFOUND
;

778 
EAI_SERVICE
:  -
NLE_OPNOTSUPP
;

779 
EAI_SOCKTYPE
:  -
NLE_BAD_SOCK
;

780 :  -
NLE_FAILURE
;

785 
	}
}

800 
	$Æ_addr_»sŞve
(
Æ_addr
 *
addr
, *
ho¡
, 
size_t
 
ho¡Ën
)

802 
”r
;

803 
sockaddr_š6
 
buf
;

804 
sockËn_t
 
§Ën
 = (
buf
);

806 
”r
 = 
	`Æ_addr_fl_sockaddr
(
addr
, (
sockaddr
 *è&
buf
, &
§Ën
);

807 ià(
”r
 < 0)

808  
”r
;

810 
”r
 = 
	`g‘Çmešfo
((
sockaddr
 *è&
buf
, 
§Ën
, 
ho¡
, 
ho¡Ën
,

811 
NULL
, 0, 
NI_NAMEREQD
);

812 ià(
”r
 < 0)

813  
	`Æ_sy£¼2Æ”r
(
”r
);

816 
	}
}

832 
	$Æ_addr_£t_çmy
(
Æ_addr
 *
addr
, 
çmy
)

834 
addr
->
a_çmy
 = 
çmy
;

835 
	}
}

845 
	$Æ_addr_g‘_çmy
(
Æ_addr
 *
addr
)

847  
addr
->
a_çmy
;

848 
	}
}

870 
	$Æ_addr_£t_bš¬y_addr
(
Æ_addr
 *
addr
, *
buf
, 
size_t
 
Ën
)

872 ià(
Ën
 > 
addr
->
a_maxsize
)

873  -
NLE_RANGE
;

875 
addr
->
a_Ën
 = 
Ën
;

876 
	`mem£t
(
addr
->
a_addr
, 0,‡ddr->
a_maxsize
);

878 ià(
Ën
)

879 
	`memıy
(
addr
->
a_addr
, 
buf
, 
Ën
);

882 
	}
}

893 *
	$Æ_addr_g‘_bš¬y_addr
(
Æ_addr
 *
addr
)

895  
addr
->
a_addr
;

896 
	}
}

905 
	$Æ_addr_g‘_Ën
(
Æ_addr
 *
addr
)

907  
addr
->
a_Ën
;

908 
	}
}

917 
	$Æ_addr_£t_´efixËn
(
Æ_addr
 *
addr
, 
´efixËn
)

919 
addr
->
a_´efixËn
 = 
´efixËn
;

920 
	}
}

928 
	$Æ_addr_g‘_´efixËn
(
Æ_addr
 *
addr
)

930  
addr
->
a_´efixËn
;

931 
	}
}

951 *
	$Æ_addr2¡r
(
Æ_addr
 *
addr
, *
buf
, 
size_t
 
size
)

953 
i
;

954 
tmp
[16];

956 ià(!
addr
 || !addr->
a_Ën
) {

957 
	`¢´štf
(
buf
, 
size
, "none");

958 ià(
addr
)

959 
´efix
;

961  
buf
;

964 
addr
->
a_çmy
) {

965 
AF_INET
:

966 
	`š‘_Áİ
(
AF_INET
, 
addr
->
a_addr
, 
buf
, 
size
);

969 
AF_INET6
:

970 
	`š‘_Áİ
(
AF_INET6
, 
addr
->
a_addr
, 
buf
, 
size
);

973 
AF_DECÃt
:

974 
	`dÃt_Áİ
(
addr
->
a_addr
,‡ddr->
a_Ën
, 
buf
, 
size
);

977 
AF_LLC
:

979 
	`¢´štf
(
buf
, 
size
, "%02x",

980 (è
addr
->
a_addr
[0]);

981 
i
 = 1; i < 
addr
->
a_Ën
; i++) {

982 
	`¢´štf
(
tmp
, (tmp), ":%02x",

983 (è
addr
->
a_addr
[
i
]);

984 
	`¡ºÿt
(
buf
, 
tmp
, 
size
 - 
	`¡¾’
(buf) - 1);

989 
´efix
:

990 ià(
addr
->
a_´efixËn
 !ğ(8 *‡ddr->
a_Ën
)) {

991 
	`¢´štf
(
tmp
, Ñmp), "/%u", 
addr
->
a_´efixËn
);

992 
	`¡ºÿt
(
buf
, 
tmp
, 
size
 - 
	`¡¾’
(buf) - 1);

995  
buf
;

996 
	}
}

1005 cÚ¡ 
Œªs_tbl
 
	gafs
[] = {

1006 
__ADD
(
AF_UNSPEC
,
un¥ec
)

1007 
__ADD
(
AF_UNIX
,
unix
)

1008 
__ADD
(
AF_INET
,
š‘
)

1009 
__ADD
(
AF_AX25
,
ax25
)

1010 
__ADD
(
AF_IPX
,
x
)

1011 
__ADD
(
AF_APPLETALK
,
­¶‘®k
)

1012 
__ADD
(
AF_NETROM
,
ÃŒom
)

1013 
__ADD
(
AF_BRIDGE
,
bridge
)

1014 
__ADD
(
AF_ATMPVC
,
©mpvc
)

1015 
__ADD
(
AF_X25
,
x25
)

1016 
__ADD
(
AF_INET6
,
š‘6
)

1017 
__ADD
(
AF_ROSE
,
ro£
)

1018 
__ADD
(
AF_DECÃt
,
deú‘
)

1019 
__ADD
(
AF_NETBEUI
,
Ãtbeui
)

1020 
__ADD
(
AF_SECURITY
,
£cur™y
)

1021 
__ADD
(
AF_KEY
,
key
)

1022 
__ADD
(
AF_NETLINK
,
Ãšk
)

1023 
__ADD
(
AF_PACKET
,
·ck‘
)

1024 
__ADD
(
AF_ASH
,
ash
)

1025 
__ADD
(
AF_ECONET
,
ecÚ‘
)

1026 
__ADD
(
AF_ATMSVC
,
©msvc
)

1027 #ifdeà
AF_RDS


1028 
__ADD
(
AF_RDS
,
rds
)

1030 
__ADD
(
AF_SNA
,
¢a
)

1031 
__ADD
(
AF_IRDA
,
œda
)

1032 
__ADD
(
AF_PPPOX
,
µpox
)

1033 
__ADD
(
AF_WANPIPE
,
wªpe
)

1034 
__ADD
(
AF_LLC
,
Îc
)

1035 #ifdeà
AF_CAN


1036 
__ADD
(
AF_CAN
,
ÿn
)

1038 #ifdeà
AF_TIPC


1039 
__ADD
(
AF_TIPC
,
tc
)

1041 
__ADD
(
AF_BLUETOOTH
,
blu‘oÙh
)

1042 #ifdeà
AF_IUCV


1043 
__ADD
(
AF_IUCV
,
iucv
)

1045 #ifdeà
AF_RXRPC


1046 
__ADD
(
AF_RXRPC
,
rx½c
)

1048 #ifdeà
AF_ISDN


1049 
__ADD
(
AF_ISDN
,
isdn
)

1051 #ifdeà
AF_PHONET


1052 
__ADD
(
AF_PHONET
,
phÚ‘
)

1054 #ifdeà
AF_IEEE802154


1055 
__ADD
(
AF_IEEE802154
,
›“802154
)

1057 #ifdeà
AF_CAIF


1058 
__ADD
(
AF_CAIF
,
ÿif
)

1060 #ifdeà
AF_ALG


1061 
__ADD
(
AF_ALG
,
®g
)

1063 #ifdeà
AF_NFC


1064 
__ADD
(
AF_NFC
,
nfc
)

1068 *
	$Æ_af2¡r
(
çmy
, *
buf
, 
size_t
 
size
)

1070  
	`__ty³2¡r
(
çmy
, 
buf
, 
size
, 
afs
, 
	`ARRAY_SIZE
(afs));

1071 
	}
}

1073 
	$Æ_¡r2af
(cÚ¡ *
Çme
)

1075 
çm
 = 
	`__¡r2ty³
(
Çme
, 
afs
, 
	`ARRAY_SIZE
(afs));

1076  
çm
 >ğ0 ? fam : -
EINVAL
;

1077 
	}
}

	@mylibnl/libnl-3.2.25/lib/attr.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/Ãšk.h
>

14 
	~<Ãšk/uts.h
>

15 
	~<Ãšk/addr.h
>

16 
	~<Ãšk/©Œ.h
>

17 
	~<Ãšk/msg.h
>

18 
	~<lšux/sock‘.h
>

55 
	$Æa_©Œ_size
(
·ylßd
)

57  
NLA_HDRLEN
 + 
·ylßd
;

58 
	}
}

73 
	$Æa_tÙ®_size
(
·ylßd
)

75  
	`NLA_ALIGN
(
	`Æa_©Œ_size
(
·ylßd
));

76 
	}
}

91 
	$Æa_·dËn
(
·ylßd
)

93  
	`Æa_tÙ®_size
(
·ylßd
è- 
	`Æa_©Œ_size
(payload);

94 
	}
}

109 
	$Æa_ty³
(cÚ¡ 
Æ©Œ
 *
Æa
)

111  
Æa
->
Æa_ty³
 & 
NLA_TYPE_MASK
;

112 
	}
}

120 *
	$Æa_d©a
(cÚ¡ 
Æ©Œ
 *
Æa
)

122  (*è
Æa
 + 
NLA_HDRLEN
;

123 
	}
}

131 
	$Æa_Ën
(cÚ¡ 
Æ©Œ
 *
Æa
)

133  
Æa
->
Æa_Ën
 - 
NLA_HDRLEN
;

134 
	}
}

148 
	$Æa_ok
(cÚ¡ 
Æ©Œ
 *
Æa
, 
»maššg
)

150  
»maššg
 >ğ(*
Æa
) &&

151 
Æa
->
Æa_Ën
 >= (*nla) &&

152 
Æa
->
Æa_Ën
 <ğ
»maššg
;

153 
	}
}

171 
Æ©Œ
 *
	$Æa_Ãxt
(cÚ¡ 
Æ©Œ
 *
Æa
, *
»maššg
)

173 
tÙËn
 = 
	`NLA_ALIGN
(
Æa
->
Æa_Ën
);

175 *
»maššg
 -ğ
tÙËn
;

176  (
Æ©Œ
 *è((*è
Æa
 + 
tÙËn
);

177 
	}
}

179 
ušt16_t
 
	gÆa_©Œ_mšËn
[
NLA_TYPE_MAX
+1] = {

180 [
NLA_U8
] = (
ušt8_t
),

181 [
NLA_U16
] = (
ušt16_t
),

182 [
NLA_U32
] = (
ušt32_t
),

183 [
NLA_U64
] = (
ušt64_t
),

184 [
NLA_STRING
] = 1,

185 [
NLA_FLAG
] = 0,

188 
	$v®id©e_Æa
(
Æ©Œ
 *
Æa
, 
maxty³
,

189 
Æa_pŞicy
 *
pŞicy
)

191 
Æa_pŞicy
 *
±
;

192 
mšËn
 = 0;

193 
ty³
 = 
	`Æa_ty³
(
Æa
);

195 ià(
ty³
 < 0 ||y³ > 
maxty³
)

198 
±
 = &
pŞicy
[
ty³
];

200 ià(
±
->
ty³
 > 
NLA_TYPE_MAX
)

201 
	`BUG
();

203 ià(
±
->
mšËn
)

204 
mšËn
 = 
±
->minlen;

205 ià(
±
->
ty³
 !ğ
NLA_UNSPEC
)

206 
mšËn
 = 
Æa_©Œ_mšËn
[
±
->
ty³
];

208 ià(
	`Æa_Ën
(
Æa
è< 
mšËn
)

209  -
NLE_RANGE
;

211 ià(
±
->
maxËn
 && 
	`Æa_Ën
(
Æa
) >…t->maxlen)

212  -
NLE_RANGE
;

214 ià(
±
->
ty³
 =ğ
NLA_STRING
) {

215 *
d©a
 = 
	`Æa_d©a
(
Æa
);

216 ià(
d©a
[
	`Æa_Ën
(
Æa
) - 1] != '\0')

217  -
NLE_INVAL
;

221 
	}
}

242 
	$Æa_·r£
(
Æ©Œ
 *
tb
[], 
maxty³
, Æ©Œ *
h—d
, 
Ën
,

243 
Æa_pŞicy
 *
pŞicy
)

245 
Æ©Œ
 *
Æa
;

246 
»m
, 
”r
;

248 
	`mem£t
(
tb
, 0, (
Æ©Œ
 *è* (
maxty³
 + 1));

250 
	`Æa_fÜ_—ch_©Œ
(
Æa
, 
h—d
, 
Ën
, 
»m
) {

251 
ty³
 = 
	`Æa_ty³
(
Æa
);

253 ià(
ty³
 > 
maxty³
)

256 ià(
pŞicy
) {

257 
”r
 = 
	`v®id©e_Æa
(
Æa
, 
maxty³
, 
pŞicy
);

258 ià(
”r
 < 0)

259 
”rout
;

262 ià(
tb
[
ty³
])

263 
	`NL_DBG
(1, "Attribute ofype %#x found multipleimes in message, "

264 "´eviou ©Œibu‹ i bešg ignÜed.\n", 
ty³
);

266 
tb
[
ty³
] = 
Æa
;

269 ià(
»m
 > 0)

270 
	`NL_DBG
(1, "netlink: %d bytes†eftover‡fter…arsing "

271 "©Œibu‹s.\n", 
»m
);

273 
”r
 = 0;

274 
”rout
:

275  
”r
;

276 
	}
}

294 
	$Æa_v®id©e
(
Æ©Œ
 *
h—d
, 
Ën
, 
maxty³
,

295 
Æa_pŞicy
 *
pŞicy
)

297 
Æ©Œ
 *
Æa
;

298 
»m
, 
”r
;

300 
	`Æa_fÜ_—ch_©Œ
(
Æa
, 
h—d
, 
Ën
, 
»m
) {

301 
”r
 = 
	`v®id©e_Æa
(
Æa
, 
maxty³
, 
pŞicy
);

302 ià(
”r
 < 0)

303 
”rout
;

306 
”r
 = 0;

307 
”rout
:

308  
”r
;

309 
	}
}

323 
Æ©Œ
 *
	$Æa_fšd
(
Æ©Œ
 *
h—d
, 
Ën
, 
©Œty³
)

325 
Æ©Œ
 *
Æa
;

326 
»m
;

328 
	`Æa_fÜ_—ch_©Œ
(
Æa
, 
h—d
, 
Ën
, 
»m
)

329 ià(
	`Æa_ty³
(
Æa
è=ğ
©Œty³
)

330  
Æa
;

332  
NULL
;

333 
	}
}

353 
	$Æa_memıy
(*
de¡
, 
Æ©Œ
 *
¤c
, 
couÁ
)

355 
mšËn
;

357 ià(!
¤c
)

360 
mšËn
 = 
	`mš_t
(, 
couÁ
, 
	`Æa_Ën
(
¤c
));

361 
	`memıy
(
de¡
, 
	`Æa_d©a
(
¤c
), 
mšËn
);

363  
mšËn
;

364 
	}
}

378 
size_t
 
	$Æa_¡¾ıy
(*
d¡
, cÚ¡ 
Æ©Œ
 *
Æa
, 
size_t
 
d¡size
)

380 
size_t
 
¤ş’
 = 
	`Æa_Ën
(
Æa
);

381 *
¤c
 = 
	`Æa_d©a
(
Æa
);

383 ià(
¤ş’
 > 0 && 
¤c
[srclen - 1] == '\0')

384 
¤ş’
--;

386 ià(
d¡size
 > 0) {

387 
size_t
 
Ën
 = (
¤ş’
 >ğ
d¡size
) ? dstsize - 1 : srclen;

389 
	`mem£t
(
d¡
, 0, 
d¡size
);

390 
	`memıy
(
d¡
, 
¤c
, 
Ën
);

393  
¤ş’
;

394 
	}
}

405 
	$Æa_memcmp
(cÚ¡ 
Æ©Œ
 *
Æa
, cÚ¡ *
d©a
, 
size_t
 
size
)

407 
d
 = 
	`Æa_Ën
(
Æa
è- 
size
;

409 ià(
d
 == 0)

410 
d
 = 
	`memcmp
(
	`Æa_d©a
(
Æa
), 
d©a
, 
size
);

412  
d
;

413 
	}
}

423 
	$Æa_¡rcmp
(cÚ¡ 
Æ©Œ
 *
Æa
, cÚ¡ *
¡r
)

425 
Ën
 = 
	`¡¾’
(
¡r
) + 1;

426 
d
 = 
	`Æa_Ën
(
Æa
è- 
Ën
;

428 ià(
d
 == 0)

429 
d
 = 
	`memcmp
(
	`Æa_d©a
(
Æa
), 
¡r
, 
Ën
);

431  
d
;

432 
	}
}

456 
Æ©Œ
 *
	$Æa_»£rve
(
Æ_msg
 *
msg
, 
©Œty³
, 
©ŒËn
)

458 
Æ©Œ
 *
Æa
;

459 
’
;

461 
’
 = 
	`NLMSG_ALIGN
(
msg
->
nm_Æh
->
Æmsg_Ën
è+ 
	`Æa_tÙ®_size
(
©ŒËn
);

463 ià(
’
 > 
msg
->
nm_size
)

464  
NULL
;

466 
Æa
 = (
Æ©Œ
 *è
	`Æmsg_
(
msg
->
nm_Æh
);

467 
Æa
->
Æa_ty³
 = 
©Œty³
;

468 
Æa
->
Æa_Ën
 = 
	`Æa_©Œ_size
(
©ŒËn
);

470 ià(
©ŒËn
)

471 
	`mem£t
((*è
Æa
 +‚Ï->
Æa_Ën
, 0, 
	`Æa_·dËn
(
©ŒËn
));

472 
msg
->
nm_Æh
->
Æmsg_Ën
 = 
’
;

474 
	`NL_DBG
(2, "msg %p:‡ttr <%p> %d: Reserved %d (%d) bytes‡t offset +%td "

475 "Æmsg_Ën=%d\n", 
msg
, 
Æa
,‚Ï->
Æa_ty³
,

476 
	`Æa_tÙ®_size
(
©ŒËn
),‡ttrlen,

477 (*è
Æa
 - 
	`Æmsg_d©a
(
msg
->
nm_Æh
),

478 
msg
->
nm_Æh
->
Æmsg_Ën
);

480  
Æa
;

481 
	}
}

497 
	$Æa_put
(
Æ_msg
 *
msg
, 
©Œty³
, 
d©®’
, cÚ¡ *
d©a
)

499 
Æ©Œ
 *
Æa
;

501 
Æa
 = 
	`Æa_»£rve
(
msg
, 
©Œty³
, 
d©®’
);

502 ià(!
Æa
)

503  -
NLE_NOMEM
;

505 ià(
d©®’
 > 0) {

506 
	`memıy
(
	`Æa_d©a
(
Æa
), 
d©a
, 
d©®’
);

507 
	`NL_DBG
(2, "msg %p:‡ttr <%p> %d: Wrote %d bytes‡t offset +%td\n",

508 
msg
, 
Æa
,‚Ï->
Æa_ty³
, 
d©®’
,

509 (*è
Æa
 - 
	`Æmsg_d©a
(
msg
->
nm_Æh
));

513 
	}
}

527 
	$Æa_put_d©a
(
Æ_msg
 *
msg
, 
©Œty³
, 
Æ_d©a
 *
d©a
)

529  
	`Æa_put
(
msg
, 
©Œty³
, 
	`Æ_d©a_g‘_size
(
d©a
),

530 
	`Æ_d©a_g‘
(
d©a
));

531 
	}
}

542 
	$Æa_put_addr
(
Æ_msg
 *
msg
, 
©Œty³
, 
Æ_addr
 *
addr
)

544  
	`Æa_put
(
msg
, 
©Œty³
, 
	`Æ_addr_g‘_Ën
(
addr
),

545 
	`Æ_addr_g‘_bš¬y_addr
(
addr
));

546 
	}
}

563 
	$Æa_put_u8
(
Æ_msg
 *
msg
, 
©Œty³
, 
ušt8_t
 
v®ue
)

565  
	`Æa_put
(
msg
, 
©Œty³
, (
ušt8_t
), &
v®ue
);

566 
	}
}

574 
ušt8_t
 
	$Æa_g‘_u8
(
Æ©Œ
 *
Æa
)

576  *(
ušt8_t
 *è
	`Æa_d©a
(
Æa
);

577 
	}
}

588 
	$Æa_put_u16
(
Æ_msg
 *
msg
, 
©Œty³
, 
ušt16_t
 
v®ue
)

590  
	`Æa_put
(
msg
, 
©Œty³
, (
ušt16_t
), &
v®ue
);

591 
	}
}

599 
ušt16_t
 
	$Æa_g‘_u16
(
Æ©Œ
 *
Æa
)

601  *(
ušt16_t
 *è
	`Æa_d©a
(
Æa
);

602 
	}
}

613 
	$Æa_put_u32
(
Æ_msg
 *
msg
, 
©Œty³
, 
ušt32_t
 
v®ue
)

615  
	`Æa_put
(
msg
, 
©Œty³
, (
ušt32_t
), &
v®ue
);

616 
	}
}

624 
ušt32_t
 
	$Æa_g‘_u32
(
Æ©Œ
 *
Æa
)

626  *(
ušt32_t
 *è
	`Æa_d©a
(
Æa
);

627 
	}
}

638 
	$Æa_put_u64
(
Æ_msg
 *
msg
, 
©Œty³
, 
ušt64_t
 
v®ue
)

640  
	`Æa_put
(
msg
, 
©Œty³
, (
ušt64_t
), &
v®ue
);

641 
	}
}

649 
ušt64_t
 
	$Æa_g‘_u64
(
Æ©Œ
 *
Æa
)

651 
ušt64_t
 
tmp
 = 0;

653 ià(
Æa
 && 
	`Æa_Ën
ÒÏè>ğ(
tmp
))

654 
	`memıy
(&
tmp
, 
	`Æa_d©a
(
Æa
), (tmp));

656  
tmp
;

657 
	}
}

674 
	$Æa_put_¡ršg
(
Æ_msg
 *
msg
, 
©Œty³
, cÚ¡ *
¡r
)

676  
	`Æa_put
(
msg
, 
©Œty³
, 
	`¡¾’
(
¡r
) + 1, str);

677 
	}
}

685 *
	$Æa_g‘_¡ršg
(
Æ©Œ
 *
Æa
)

687  (*è
	`Æa_d©a
(
Æa
);

688 
	}
}

690 *
	$Æa_¡rdup
(
Æ©Œ
 *
Æa
)

692  
	`¡rdup
(
	`Æa_g‘_¡ršg
(
Æa
));

693 
	}
}

709 
	$Æa_put_æag
(
Æ_msg
 *
msg
, 
©Œty³
)

711  
	`Æa_put
(
msg
, 
©Œty³
, 0, 
NULL
);

712 
	}
}

720 
	$Æa_g‘_æag
(
Æ©Œ
 *
Æa
)

722  !!
Æa
;

723 
	}
}

737 
	$Æa_put_m£cs
(
Æ_msg
 *
n
, 
©Œty³
, 
m£cs
)

739  
	`Æa_put_u64
(
n
, 
©Œty³
, 
m£cs
);

740 
	}
}

748 
	$Æa_g‘_m£cs
(
Æ©Œ
 *
Æa
)

750  
	`Æa_g‘_u64
(
Æa
);

751 
	}
}

772 
	$Æa_put_Ã¡ed
(
Æ_msg
 *
msg
, 
©Œty³
, Æ_msg *
Ã¡ed
)

774 
	`NL_DBG
(2, "msg %p:‡ttr <> %d:‡dding msg %p‡s‚ested‡ttribute\n",

775 
msg
, 
©Œty³
, 
Ã¡ed
);

777  
	`Æa_put
(
msg
, 
©Œty³
, 
	`Æmsg_d©®’
(
Ã¡ed
->
nm_Æh
),

778 
	`Æmsg_d©a
(
Ã¡ed
->
nm_Æh
));

779 
	}
}

789 
Æ©Œ
 *
	$Æa_Ã¡_¡¬t
(
Æ_msg
 *
msg
, 
©Œty³
)

791 
Æ©Œ
 *
¡¬t
 = (Æ©Œ *è
	`Æmsg_
(
msg
->
nm_Æh
);

793 ià(
	`Æa_put
(
msg
, 
©Œty³
, 0, 
NULL
) < 0)

794  
NULL
;

796 
	`NL_DBG
(2, "msg %p:‡ttr <%p> %d: starting‚esting\n",

797 
msg
, 
¡¬t
, s¹->
Æa_ty³
);

799  
¡¬t
;

800 
	}
}

811 
	$Æa_Ã¡_’d
(
Æ_msg
 *
msg
, 
Æ©Œ
 *
¡¬t
)

813 
size_t
 
·d
, 
Ën
;

815 
Ën
 = (*è
	`Æmsg_
(
msg
->
nm_Æh
è- (*è
¡¬t
;

817 ià(
Ën
 =ğ
NLA_HDRLEN
) {

822 
	`Æa_Ã¡_ÿnûl
(
msg
, 
¡¬t
);

827 
¡¬t
->
Æa_Ën
 = 
Ën
;

829 
·d
 = 
	`NLMSG_ALIGN
(
msg
->
nm_Æh
->
Æmsg_Ën
) - msg->nm_nlh->nlmsg_len;

830 ià(
·d
 > 0) {

837 ià(!
	`Æmsg_»£rve
(
msg
, 
·d
, 0))

838 
	`BUG
();

840 
	`NL_DBG
(2, "msg %p:‡ttr <%p> %d:‡dded %zu bytes of…adding\n",

841 
msg
, 
¡¬t
, s¹->
Æa_ty³
, 
·d
);

844 
	`NL_DBG
(2, "msg %p:‡ttr <%p> %d: closing‚esting,†en=%u\n",

845 
msg
, 
¡¬t
, s¹->
Æa_ty³
, s¹->
Æa_Ën
);

848 
	}
}

859 
	$Æa_Ã¡_ÿnûl
(
Æ_msg
 *
msg
, 
Æ©Œ
 *
©Œ
)

861 
ssize_t
 
Ën
;

863 
Ën
 = (*è
	`Æmsg_
(
msg
->
nm_Æh
è- (*è
©Œ
;

864 ià(
Ën
 < 0)

865 
	`BUG
();

866 ià(
Ën
 > 0) {

867 
msg
->
nm_Æh
->
Æmsg_Ën
 -ğ
Ën
;

868 
	`mem£t
(
	`Æmsg_
(
msg
->
nm_Æh
), 0, 
Ën
);

870 
	}
}

885 
	$Æa_·r£_Ã¡ed
(
Æ©Œ
 *
tb
[], 
maxty³
, Æ©Œ *
Æa
,

886 
Æa_pŞicy
 *
pŞicy
)

888  
	`Æa_·r£
(
tb
, 
maxty³
, 
	`Æa_d©a
(
Æa
), 
	`Æa_Ën
ÒÏ), 
pŞicy
);

889 
	}
}

897 
	$Æa_is_Ã¡ed
(
Æ©Œ
 *
©Œ
)

899  !!(
©Œ
->
Æa_ty³
 & 
NLA_F_NESTED
);

900 
	}
}

	@mylibnl/libnl-3.2.25/lib/cache.c

52 
	~<Ãšk-´iv©e/Ãšk.h
>

53 
	~<Ãšk/Ãšk.h
>

54 
	~<Ãšk/ÿche.h
>

55 
	~<Ãšk/objeù.h
>

56 
	~<Ãšk/hashbË.h
>

57 
	~<Ãšk/uts.h
>

68 
	$Æ_ÿche_n™ems
(
Æ_ÿche
 *
ÿche
)

70  
ÿche
->
c_n™ems
;

71 
	}
}

78 
	$Æ_ÿche_n™ems_f‹r
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
f‹r
)

80 
Æ_objeù
 *
obj
;

81 
n™ems
 = 0;

83 ià(
ÿche
->
c_İs
 =ğ
NULL
)

84 
	`BUG
();

86 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
) {

87 ià(
f‹r
 && !
	`Æ_objeù_m©ch_f‹r
(
obj
, filter))

90 
n™ems
++;

93  
n™ems
;

94 
	}
}

101 
	$Æ_ÿche_is_em±y
(
Æ_ÿche
 *
ÿche
)

103  
	`Æ_li¡_em±y
(&
ÿche
->
c_™ems
);

104 
	}
}

110 
Æ_ÿche_İs
 *
	$Æ_ÿche_g‘_İs
(
Æ_ÿche
 *
ÿche
)

112  
ÿche
->
c_İs
;

113 
	}
}

119 
Æ_objeù
 *
	$Æ_ÿche_g‘_fœ¡
(
Æ_ÿche
 *
ÿche
)

121 ià(
	`Æ_li¡_em±y
(&
ÿche
->
c_™ems
))

122  
NULL
;

124  
	`Æ_li¡_’Œy
(
ÿche
->
c_™ems
.
Ãxt
,

125 
Æ_objeù
, 
û_li¡
);

126 
	}
}

132 
Æ_objeù
 *
	$Æ_ÿche_g‘_Ï¡
(
Æ_ÿche
 *
ÿche
)

134 ià(
	`Æ_li¡_em±y
(&
ÿche
->
c_™ems
))

135  
NULL
;

137  
	`Æ_li¡_’Œy
(
ÿche
->
c_™ems
.
´ev
,

138 
Æ_objeù
, 
û_li¡
);

139 
	}
}

145 
Æ_objeù
 *
	$Æ_ÿche_g‘_Ãxt
(
Æ_objeù
 *
obj
)

147 ià(
	`Æ_li¡_©_
(
obj
, &obj->
û_ÿche
->
c_™ems
, 
û_li¡
))

148  
NULL
;

150  
	`Æ_li¡_’Œy
(
obj
->
û_li¡
.
Ãxt
,

151 
Æ_objeù
, 
û_li¡
);

152 
	}
}

158 
Æ_objeù
 *
	$Æ_ÿche_g‘_´ev
(
Æ_objeù
 *
obj
)

160 ià(
	`Æ_li¡_©_h—d
(
obj
, &obj->
û_ÿche
->
c_™ems
, 
û_li¡
))

161  
NULL
;

163  
	`Æ_li¡_’Œy
(
obj
->
û_li¡
.
´ev
,

164 
Æ_objeù
, 
û_li¡
);

165 
	}
}

183 
Æ_ÿche
 *
	$Æ_ÿche_®loc
(
Æ_ÿche_İs
 *
İs
)

185 
Æ_ÿche
 *
ÿche
;

187 
ÿche
 = 
	`ÿÎoc
(1, (*cache));

188 ià(!
ÿche
)

189  
NULL
;

191 
	`Æ_š™_li¡_h—d
(&
ÿche
->
c_™ems
);

192 
ÿche
->
c_İs
 = 
İs
;

193 
ÿche
->
c_æags
 |ğ
İs
->
co_æags
;

194 
ÿche
->
c_»fút
 = 1;

201 ià(
İs
->
co_obj_İs
->
oo_keyg’
) {

202 
hashbË_size
;

204 ià(
İs
->
co_hash_size
)

205 
hashbË_size
 = 
İs
->
co_hash_size
;

207 
hashbË_size
 = 
NL_MAX_HASH_ENTRIES
;

209 
ÿche
->
hashbË
 = 
	`Æ_hash_bË_®loc
(
hashbË_size
);

212 
	`NL_DBG
(2, "AÎoÿ‹d cach%°<%s>.\n", 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

214  
ÿche
;

215 
	}
}

233 
	$Æ_ÿche_®loc_ªd_fl
(
Æ_ÿche_İs
 *
İs
, 
Æ_sock
 *
sock
,

234 
Æ_ÿche
 **
»suÉ
)

236 
Æ_ÿche
 *
ÿche
;

237 
”r
;

239 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(
İs
)))

240  -
NLE_NOMEM
;

242 ià(
sock
 && (
”r
 = 
	`Æ_ÿche_»fl
(sock, 
ÿche
)) < 0) {

243 
	`Æ_ÿche_ä“
(
ÿche
);

244  
”r
;

247 *
»suÉ
 = 
ÿche
;

249 
	}
}

264 
	$Æ_ÿche_®loc_Çme
(cÚ¡ *
kšd
, 
Æ_ÿche
 **
»suÉ
)

266 
Æ_ÿche_İs
 *
İs
;

267 
Æ_ÿche
 *
ÿche
;

269 
İs
 = 
	`Æ_ÿche_İs_lookup_§ã
(
kšd
);

270 ià(!
İs
)

271  -
NLE_NOCACHE
;

273 
ÿche
 = 
	`Æ_ÿche_®loc
(
İs
);

274 
	`Æ_ÿche_İs_put
(
İs
);

275 ià(!
ÿche
)

276  -
NLE_NOMEM
;

278 *
»suÉ
 = 
ÿche
;

280 
	}
}

297 
Æ_ÿche
 *
	$Æ_ÿche_sub£t
(
Æ_ÿche
 *
Üig
,

298 
Æ_objeù
 *
f‹r
)

300 
Æ_ÿche
 *
ÿche
;

301 
Æ_objeù
 *
obj
;

303 ià(!
f‹r
)

304 
	`BUG
();

306 
ÿche
 = 
	`Æ_ÿche_®loc
(
Üig
->
c_İs
);

307 ià(!
ÿche
)

308  
NULL
;

310 
	`NL_DBG
(2, "Filling subset of cache %p <%s> with filter %p into %p\n",

311 
Üig
, 
	`Æ_ÿche_Çme
(Üig), 
f‹r
, 
ÿche
);

313 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
Üig
->
c_™ems
, 
û_li¡
) {

314 ià(!
	`Æ_objeù_m©ch_f‹r
(
obj
, 
f‹r
))

317 
	`Æ_ÿche_add
(
ÿche
, 
obj
);

320  
ÿche
;

321 
	}
}

337 
Æ_ÿche
 *
	$Æ_ÿche_şÚe
(
Æ_ÿche
 *
ÿche
)

339 
Æ_ÿche_İs
 *
İs
 = 
	`Æ_ÿche_g‘_İs
(
ÿche
);

340 
Æ_ÿche
 *
şÚe
;

341 
Æ_objeù
 *
obj
;

343 
şÚe
 = 
	`Æ_ÿche_®loc
(
İs
);

344 ià(!
şÚe
)

345  
NULL
;

347 
	`NL_DBG
(2, "ClÚšg %°štØ%p\n", 
ÿche
, 
şÚe
);

349 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
)

350 
	`Æ_ÿche_add
(
şÚe
, 
obj
);

352  
şÚe
;

353 
	}
}

366 
	$Æ_ÿche_ş—r
(
Æ_ÿche
 *
ÿche
)

368 
Æ_objeù
 *
obj
, *
tmp
;

370 
	`NL_DBG
(2, "CË¬šg cach%°<%s>...\n", 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

372 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
obj
, 
tmp
, &
ÿche
->
c_™ems
, 
û_li¡
)

373 
	`Æ_ÿche_»move
(
obj
);

374 
	}
}

376 
	$__Æ_ÿche_ä“
(
Æ_ÿche
 *
ÿche
)

378 
	`Æ_ÿche_ş—r
(
ÿche
);

380 ià(
ÿche
->
hashbË
)

381 
	`Æ_hash_bË_ä“
(
ÿche
->
hashbË
);

383 
	`NL_DBG
(2, "F»ešg cach%°<%s>...\n", 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

384 
	`ä“
(
ÿche
);

385 
	}
}

391 
	$Æ_ÿche_g‘
(
Æ_ÿche
 *
ÿche
)

393 
ÿche
->
c_»fút
++;

395 
	`NL_DBG
(3, "Incremented cache %p <%s>„eference counto %d\n",

396 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), cache->
c_»fút
);

397 
	}
}

408 
	$Æ_ÿche_ä“
(
Æ_ÿche
 *
ÿche
)

410 ià(!
ÿche
)

413 
ÿche
->
c_»fút
--;

415 
	`NL_DBG
(3, "Decremented cache %p <%s>„eference count, %d„emaining\n",

416 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), cache->
c_»fút
);

418 ià(
ÿche
->
c_»fút
 <= 0)

419 
	`__Æ_ÿche_ä“
(
ÿche
);

420 
	}
}

422 
	$Æ_ÿche_put
(
Æ_ÿche
 *
ÿche
)

424  
	`Æ_ÿche_ä“
(
ÿche
);

425 
	}
}

434 
	$__ÿche_add
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
)

436 
»t
;

438 
obj
->
û_ÿche
 = 
ÿche
;

440 ià(
ÿche
->
hashbË
) {

441 
»t
 = 
	`Æ_hash_bË_add
(
ÿche
->
hashbË
, 
obj
);

442 ià(
»t
 < 0) {

443 
obj
->
û_ÿche
 = 
NULL
;

444  
»t
;

448 
	`Æ_li¡_add_
(&
obj
->
û_li¡
, &
ÿche
->
c_™ems
);

449 
ÿche
->
c_n™ems
++;

451 
	`NL_DBG
(3, "Added object %po cache %p <%s>,‚items %d\n",

452 
obj
, 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), cache->
c_n™ems
);

455 
	}
}

479 
	$Æ_ÿche_add
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
)

481 
Æ_objeù
 *
Ãw
;

482 
»t
 = 0;

484 ià(
ÿche
->
c_İs
->
co_obj_İs
 !ğ
obj
->
û_İs
)

485  -
NLE_OBJ_MISMATCH
;

487 ià(!
	`Æ_li¡_em±y
(&
obj
->
û_li¡
)) {

488 
	`NL_DBG
(3, "Objeù %°®»ady iÀÿche, clÚšg‚ew objeù\n", 
obj
);

490 
Ãw
 = 
	`Æ_objeù_şÚe
(
obj
);

491 ià(!
Ãw
)

492  -
NLE_NOMEM
;

494 
	`Æ_objeù_g‘
(
obj
);

495 
Ãw
 = 
obj
;

498 
»t
 = 
	`__ÿche_add
(
ÿche
, 
Ãw
);

499 ià(
»t
 < 0)

500 
	`Æ_objeù_put
(
Ãw
);

502  
»t
;

503 
	}
}

523 
	$Æ_ÿche_move
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
)

525 ià(
ÿche
->
c_İs
->
co_obj_İs
 !ğ
obj
->
û_İs
)

526  -
NLE_OBJ_MISMATCH
;

528 
	`NL_DBG
(3, "Moving object %p from cache %po cache %p\n",

529 
obj
, obj->
û_ÿche
, 
ÿche
);

533 
	`Æ_objeù_g‘
(
obj
);

535 ià(!
	`Æ_li¡_em±y
(&
obj
->
û_li¡
))

536 
	`Æ_ÿche_»move
(
obj
);

538  
	`__ÿche_add
(
ÿche
, 
obj
);

539 
	}
}

551 
	$Æ_ÿche_»move
(
Æ_objeù
 *
obj
)

553 
»t
;

554 
Æ_ÿche
 *
ÿche
 = 
obj
->
û_ÿche
;

556 ià(
ÿche
 =ğ
NULL
)

559 ià(
ÿche
->
hashbË
) {

560 
»t
 = 
	`Æ_hash_bË_d–
(
ÿche
->
hashbË
, 
obj
);

561 ià(
»t
 < 0)

562 
	`NL_DBG
(2, "Failedo delete %p from cache %p <%s>.\n",

563 
obj
, 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

566 
	`Æ_li¡_d–
(&
obj
->
û_li¡
);

567 
obj
->
û_ÿche
 = 
NULL
;

568 
	`Æ_objeù_put
(
obj
);

569 
ÿche
->
c_n™ems
--;

571 
	`NL_DBG
(2, "Deleted object %p from cache %p <%s>.\n",

572 
obj
, 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

573 
	}
}

590 
	$Æ_ÿche_£t_¬g1
(
Æ_ÿche
 *
ÿche
, 
¬g
)

592 
ÿche
->
c_Ÿrg1
 = 
¬g
;

593 
	}
}

603 
	$Æ_ÿche_£t_¬g2
(
Æ_ÿche
 *
ÿche
, 
¬g
)

605 
ÿche
->
c_Ÿrg2
 = 
¬g
;

606 
	}
}

613 
	$Æ_ÿche_£t_æags
(
Æ_ÿche
 *
ÿche
, 
æags
)

615 
ÿche
->
c_æags
 |ğ
æags
;

616 
	}
}

642 
	$Æ_ÿche_»que¡_fuÎ_dump
(
Æ_sock
 *
sk
,

643 
Æ_ÿche
 *
ÿche
)

645 ià(
sk
->
s_´Ùo
 !ğ
ÿche
->
c_İs
->
co_´ÙocŞ
)

646  -
NLE_PROTO_MISMATCH
;

648 ià(
ÿche
->
c_İs
->
co_»que¡_upd©e
 =ğ
NULL
)

649  -
NLE_OPNOTSUPP
;

651 
	`NL_DBG
(2, "Requesting update from kernel for cache %p <%s>\n",

652 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

654  
ÿche
->
c_İs
->
	`co_»que¡_upd©e
(ÿche, 
sk
);

655 
	}
}

658 
	supd©e_xd©a
 {

659 
Æ_ÿche_İs
 *
	mİs
;

660 
Æ_·r£r_·¿m
 *
	m·¿ms
;

663 
	$upd©e_msg_·r£r
(
Æ_msg
 *
msg
, *
¬g
)

665 
upd©e_xd©a
 *
x
 = 
¬g
;

666 
»t
 = 0;

668 
»t
 = 
	`Æ_ÿche_·r£
(
x
->
İs
, &
msg
->
nm_¤c
, msg->
nm_Æh
, x->
·¿ms
);

669 ià(
»t
 =ğ-
NLE_EXIST
)

670  
NL_SKIP
;

672  
»t
;

673 
	}
}

682 
	$__ÿche_pickup
(
Æ_sock
 *
sk
, 
Æ_ÿche
 *
ÿche
,

683 
Æ_·r£r_·¿m
 *
·¿m
)

685 
”r
;

686 
Æ_cb
 *
cb
;

687 
upd©e_xd©a
 
x
 = {

688 .
İs
 = 
ÿche
->
c_İs
,

689 .
·¿ms
 = 
·¿m
,

692 
	`NL_DBG
(2, "Picking up‡nswer for cache %p <%s>\n",

693 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

695 
cb
 = 
	`Æ_cb_şÚe
(
sk
->
s_cb
);

696 ià(
cb
 =ğ
NULL
)

697  -
NLE_NOMEM
;

699 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
upd©e_msg_·r£r
, &
x
);

701 
”r
 = 
	`Æ_»cvmsgs
(
sk
, 
cb
);

702 ià(
”r
 < 0)

703 
	`NL_DBG
(2, "While…icking up for %p <%s>,„ecvmsgs()„eturned %d: %s\n",

704 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), 
”r
, 
	`Æ_g‘”rÜ
(err));

706 
	`Æ_cb_put
(
cb
);

708  
”r
;

709 
	}
}

711 
	$pickup_cb
(
Æ_objeù
 *
c
, 
Æ_·r£r_·¿m
 *
p
)

713 
Æ_ÿche
 *
ÿche
 = (Æ_ÿch*)
p
->
µ_¬g
;

714 
Æ_objeù
 *
Şd
;

716 
Şd
 = 
	`Æ_ÿche_£¬ch
(
ÿche
, 
c
);

717 ià(
Şd
) {

718 ià(
	`Æ_objeù_upd©e
(
Şd
, 
c
) == 0) {

719 
	`Æ_objeù_put
(
Şd
);

723 
	`Æ_ÿche_»move
(
Şd
);

724 
	`Æ_objeù_put
(
Şd
);

727  
	`Æ_ÿche_add
(
ÿche
, 
c
);

728 
	}
}

743 
	$Æ_ÿche_pickup
(
Æ_sock
 *
sk
, 
Æ_ÿche
 *
ÿche
)

745 
Æ_·r£r_·¿m
 
p
 = {

746 .
µ_cb
 = 
pickup_cb
,

747 .
µ_¬g
 = 
ÿche
,

750 ià(
sk
->
s_´Ùo
 !ğ
ÿche
->
c_İs
->
co_´ÙocŞ
)

751  -
NLE_PROTO_MISMATCH
;

753  
	`__ÿche_pickup
(
sk
, 
ÿche
, &
p
);

754 
	}
}

756 
	$ÿche_šşude
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
,

757 
Æ_msgty³
 *
ty³
, 
chªge_func_t
 
cb
, *
d©a
)

759 
Æ_objeù
 *
Şd
;

761 
ty³
->
mt_aù
) {

762 
NL_ACT_NEW
:

763 
NL_ACT_DEL
:

764 
Şd
 = 
	`Æ_ÿche_£¬ch
(
ÿche
, 
obj
);

765 ià(
Şd
) {

771 ià(
	`Æ_objeù_upd©e
(
Şd
, 
obj
) == 0) {

772 ià(
cb
)

773 
	`cb
(
ÿche
, 
Şd
, 
NL_ACT_CHANGE
, 
d©a
);

774 
	`Æ_objeù_put
(
Şd
);

778 
	`Æ_ÿche_»move
(
Şd
);

779 ià(
ty³
->
mt_aù
 =ğ
NL_ACT_DEL
) {

780 ià(
cb
)

781 
	`cb
(
ÿche
, 
Şd
, 
NL_ACT_DEL
, 
d©a
);

782 
	`Æ_objeù_put
(
Şd
);

786 ià(
ty³
->
mt_aù
 =ğ
NL_ACT_NEW
) {

787 
	`Æ_ÿche_move
(
ÿche
, 
obj
);

788 ià(
Şd
 =ğ
NULL
 && 
cb
)

789 
	`cb
(
ÿche
, 
obj
, 
NL_ACT_NEW
, 
d©a
);

790 ià(
Şd
) {

791 ià(
	`Æ_objeù_diff
(
Şd
, 
obj
è&& 
cb
)

792 
	`cb
(
ÿche
, 
obj
, 
NL_ACT_CHANGE
, 
d©a
);

794 
	`Æ_objeù_put
(
Şd
);

799 
	`NL_DBG
(2, "UnknowÀaùiÚ‡ssocŸ‹dØobjeù %p\n", 
obj
);

804 
	}
}

806 
	$Æ_ÿche_šşude
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
,

807 
chªge_func_t
 
chªge_cb
, *
d©a
)

809 
Æ_ÿche_İs
 *
İs
 = 
ÿche
->
c_İs
;

810 
i
;

812 ià(
İs
->
co_obj_İs
 !ğ
obj
->
û_İs
)

813  -
NLE_OBJ_MISMATCH
;

815 
i
 = 0; 
İs
->
co_msgty³s
[i].
mt_id
 >= 0; i++)

816 ià(
İs
->
co_msgty³s
[
i
].
mt_id
 =ğ
obj
->
û_msgty³
)

817  
	`ÿche_šşude
(
ÿche
, 
obj
, &
İs
->
co_msgty³s
[
i
],

818 
chªge_cb
, 
d©a
);

820 
	`NL_DBG
(3, "Object %p does‚ot seemo belongo cache %p <%s>\n",

821 
obj
, 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

823  -
NLE_MSGTYPE_NOSUPPORT
;

824 
	}
}

826 
	$»sync_cb
(
Æ_objeù
 *
c
, 
Æ_·r£r_·¿m
 *
p
)

828 
Æ_ÿche_assoc
 *
ÿ
 = 
p
->
µ_¬g
;

830  
	`Æ_ÿche_šşude
(
ÿ
->
ÿ_ÿche
, 
c
, ca->
ÿ_chªge
, ca->
ÿ_chªge_d©a
);

831 
	}
}

833 
	$Æ_ÿche_»sync
(
Æ_sock
 *
sk
, 
Æ_ÿche
 *
ÿche
,

834 
chªge_func_t
 
chªge_cb
, *
d©a
)

836 
Æ_objeù
 *
obj
, *
Ãxt
;

837 
Æ_af_group
 *
g½
;

838 
Æ_ÿche_assoc
 
ÿ
 = {

839 .
ÿ_ÿche
 = 
ÿche
,

840 .
ÿ_chªge
 = 
chªge_cb
,

841 .
ÿ_chªge_d©a
 = 
d©a
,

843 
Æ_·r£r_·¿m
 
p
 = {

844 .
µ_cb
 = 
»sync_cb
,

845 .
µ_¬g
 = &
ÿ
,

847 
”r
;

849 ià(
sk
->
s_´Ùo
 !ğ
ÿche
->
c_İs
->
co_´ÙocŞ
)

850  -
NLE_PROTO_MISMATCH
;

852 
	`NL_DBG
(1, "Resyncšg cach%°<%s>...\n", 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

855 
	`Æ_ÿche_m¬k_®l
(
ÿche
);

857 
g½
 = 
ÿche
->
c_İs
->
co_groups
;

859 ià(
g½
 && g½->
ag_group
 &&

860 (
ÿche
->
c_æags
 & 
NL_CACHE_AF_ITER
))

861 
	`Æ_ÿche_£t_¬g1
(
ÿche
, 
g½
->
ag_çmy
);

863 
»¡¬t
:

864 
”r
 = 
	`Æ_ÿche_»que¡_fuÎ_dump
(
sk
, 
ÿche
);

865 ià(
”r
 < 0)

866 
”rout
;

868 
”r
 = 
	`__ÿche_pickup
(
sk
, 
ÿche
, &
p
);

869 ià(
”r
 =ğ-
NLE_DUMP_INTR
)

870 
»¡¬t
;

871 ià(
”r
 < 0)

872 
”rout
;

874 ià(
g½
)

875 
g½
++;

876 } 
g½
 && g½->
ag_group
 &&

877 (
ÿche
->
c_æags
 & 
NL_CACHE_AF_ITER
));

879 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
obj
, 
Ãxt
, &
ÿche
->
c_™ems
, 
û_li¡
) {

880 ià(
	`Æ_objeù_is_m¬ked
(
obj
)) {

881 
	`Æ_objeù_g‘
(
obj
);

882 
	`Æ_ÿche_»move
(
obj
);

883 ià(
chªge_cb
)

884 
	`chªge_cb
(
ÿche
, 
obj
, 
NL_ACT_DEL
, 
d©a
);

885 
	`Æ_objeù_put
(
obj
);

889 
	`NL_DBG
(1, "Fšished„esyncšg %°<%s>\n", 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

891 
”r
 = 0;

892 
”rout
:

893  
”r
;

894 
	}
}

904 
	$Æ_ÿche_·r£
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

905 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
·¿ms
)

907 
i
, 
”r
;

909 ià(!
	`Æmsg_v®id_hdr
(
Æh
, 
İs
->
co_hdrsize
))

910  -
NLE_MSG_TOOSHORT
;

912 
i
 = 0; 
İs
->
co_msgty³s
[i].
mt_id
 >= 0; i++) {

913 ià(
İs
->
co_msgty³s
[
i
].
mt_id
 =ğ
Æh
->
Æmsg_ty³
) {

914 
”r
 = 
İs
->
	`co_msg_·r£r
(İs, 
who
, 
Æh
, 
·¿ms
);

915 ià(
”r
 !ğ-
NLE_OPNOTSUPP
)

916 
”rout
;

921 
”r
 = -
NLE_MSGTYPE_NOSUPPORT
;

922 
”rout
:

923  
”r
;

924 
	}
}

940 
	$Æ_ÿche_·r£_ªd_add
(
Æ_ÿche
 *
ÿche
, 
Æ_msg
 *
msg
)

942 
Æ_·r£r_·¿m
 
p
 = {

943 .
µ_cb
 = 
pickup_cb
,

944 .
µ_¬g
 = 
ÿche
,

947  
	`Æ_ÿche_·r£
(
ÿche
->
c_İs
, 
NULL
, 
	`Æmsg_hdr
(
msg
), &
p
);

948 
	}
}

960 
	$Æ_ÿche_»fl
(
Æ_sock
 *
sk
, 
Æ_ÿche
 *
ÿche
)

962 
Æ_af_group
 *
g½
;

963 
”r
;

965 ià(
sk
->
s_´Ùo
 !ğ
ÿche
->
c_İs
->
co_´ÙocŞ
)

966  -
NLE_PROTO_MISMATCH
;

968 
	`Æ_ÿche_ş—r
(
ÿche
);

969 
g½
 = 
ÿche
->
c_İs
->
co_groups
;

971 ià(
g½
 && g½->
ag_group
 &&

972 (
ÿche
->
c_æags
 & 
NL_CACHE_AF_ITER
))

973 
	`Æ_ÿche_£t_¬g1
(
ÿche
, 
g½
->
ag_çmy
);

975 
»¡¬t
:

976 
”r
 = 
	`Æ_ÿche_»que¡_fuÎ_dump
(
sk
, 
ÿche
);

977 ià(
”r
 < 0)

978  
”r
;

980 
	`NL_DBG
(2, "Updating cache %p <%s> for family %u,„equest sent, waiting for„eply\n",

981 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), 
g½
 ? g½->
ag_çmy
 : 
AF_UNSPEC
);

983 
”r
 = 
	`Æ_ÿche_pickup
(
sk
, 
ÿche
);

984 ià(
”r
 =ğ-
NLE_DUMP_INTR
) {

985 
	`NL_DBG
(2, "Dump interrupted,„estarting!\n");

986 
»¡¬t
;

987 } ià(
”r
 < 0)

990 ià(
g½
)

991 
g½
++;

992 } 
g½
 && g½->
ag_group
 &&

993 (
ÿche
->
c_æags
 & 
NL_CACHE_AF_ITER
));

995  
”r
;

996 
	}
}

1004 
Æ_objeù
 *
	$__ÿche_ç¡_lookup
(
Æ_ÿche
 *
ÿche
,

1005 
Æ_objeù
 *
ÃedË
)

1007 
Æ_objeù
 *
obj
;

1009 
obj
 = 
	`Æ_hash_bË_lookup
(
ÿche
->
hashbË
, 
ÃedË
);

1010 ià(
obj
) {

1011 
	`Æ_objeù_g‘
(
obj
);

1012  
obj
;

1015  
NULL
;

1016 
	}
}

1033 
Æ_objeù
 *
	$Æ_ÿche_£¬ch
(
Æ_ÿche
 *
ÿche
,

1034 
Æ_objeù
 *
ÃedË
)

1036 
Æ_objeù
 *
obj
;

1038 ià(
ÿche
->
hashbË
)

1039  
	`__ÿche_ç¡_lookup
(
ÿche
, 
ÃedË
);

1041 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1042 ià(
	`Æ_objeù_id’tiÿl
(
obj
, 
ÃedË
)) {

1043 
	`Æ_objeù_g‘
(
obj
);

1044  
obj
;

1048  
NULL
;

1049 
	}
}

1068 
Æ_objeù
 *
	$Æ_ÿche_fšd
(
Æ_ÿche
 *
ÿche
,

1069 
Æ_objeù
 *
f‹r
)

1071 
Æ_objeù
 *
obj
;

1073 ià(
ÿche
->
c_İs
 =ğ
NULL
)

1074 
	`BUG
();

1076 ià((
	`Æ_objeù_g‘_id_©Œs
(
f‹r
è=ğf‹r->
û_mask
)

1077 && 
ÿche
->
hashbË
)

1078  
	`__ÿche_ç¡_lookup
(
ÿche
, 
f‹r
);

1080 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1081 ià(
	`Æ_objeù_m©ch_f‹r
(
obj
, 
f‹r
)) {

1082 
	`Æ_objeù_g‘
(
obj
);

1083  
obj
;

1087  
NULL
;

1088 
	}
}

1097 
	$Æ_ÿche_m¬k_®l
(
Æ_ÿche
 *
ÿche
)

1099 
Æ_objeù
 *
obj
;

1101 
	`NL_DBG
(2, "Marking‡ll objects in cache %p <%s>\n",

1102 
ÿche
, 
	`Æ_ÿche_Çme
(cache));

1104 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
)

1105 
	`Æ_objeù_m¬k
(
obj
);

1106 
	}
}

1122 
	$Æ_ÿche_dump
(
Æ_ÿche
 *
ÿche
, 
Æ_dump_·¿ms
 *
·¿ms
)

1124 
	`Æ_ÿche_dump_f‹r
(
ÿche
, 
·¿ms
, 
NULL
);

1125 
	}
}

1136 
	$Æ_ÿche_dump_f‹r
(
Æ_ÿche
 *
ÿche
,

1137 
Æ_dump_·¿ms
 *
·¿ms
,

1138 
Æ_objeù
 *
f‹r
)

1140 
ty³
 = 
·¿ms
 ?…¬ams->
dp_ty³
 : 
NL_DUMP_DETAILS
;

1141 
Æ_objeù_İs
 *
İs
;

1142 
Æ_objeù
 *
obj
;

1144 
	`NL_DBG
(2, "Dumping cache %p <%s> with filter %p\n",

1145 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), 
f‹r
);

1147 ià(
ty³
 > 
NL_DUMP_MAX
 ||ype < 0)

1148 
	`BUG
();

1150 ià(
ÿche
->
c_İs
 =ğ
NULL
)

1151 
	`BUG
();

1153 
İs
 = 
ÿche
->
c_İs
->
co_obj_İs
;

1154 ià(!
İs
->
oo_dump
[
ty³
])

1157 ià(
·¿ms
 &&…¬ams->
dp_buf
)

1158 
	`mem£t
(
·¿ms
->
dp_buf
, 0,…¬ams->
dp_buæ’
);

1160 
	`Æ_li¡_fÜ_—ch_’Œy
(
obj
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1161 ià(
f‹r
 && !
	`Æ_objeù_m©ch_f‹r
(
obj
, filter))

1164 
	`NL_DBG
(4, "Dumpšg objeù %p...\n", 
obj
);

1165 
	`dump_äom_İs
(
obj
, 
·¿ms
);

1167 
	}
}

1185 
Æ_ÿche_fÜ—ch
(
Æ_ÿche
 *
ÿche
,

1186 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

1188 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, 
NULL
, 
cb
, 
¬g
);

1189 
	}
}

1202 
Æ_ÿche_fÜ—ch_f‹r
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
f‹r
,

1203 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

1205 
Æ_objeù
 *
obj
, *
tmp
;

1207 ià(
ÿche
->
c_İs
 =ğ
NULL
)

1208 
	`BUG
();

1210 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
obj
, 
tmp
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1211 ià(
f‹r
) {

1212 
diff
 = 
	`Æ_objeù_m©ch_f‹r
(
obj
, 
f‹r
);

1214 
	`NL_DBG
(3, "%p<->%p object difference: %x\n",

1215 
obj
, 
f‹r
, 
diff
);

1217 ià(!
diff
)

1222 
	`Æ_objeù_g‘
(
obj
);

1224 
	`cb
(
obj
, 
¬g
);

1226 
	`Æ_objeù_put
(
obj
);

1228 
	}
}

	@mylibnl/libnl-3.2.25/lib/cache_mngr.c

35 
	~<Ãšk-´iv©e/Ãšk.h
>

36 
	~<Ãšk/Ãšk.h
>

37 
	~<Ãšk/ÿche.h
>

38 
	~<Ãšk/uts.h
>

41 
	#NASSOC_INIT
 16

	)

42 
	#NASSOC_EXPAND
 8

	)

45 
	$šşude_cb
(
Æ_objeù
 *
obj
, 
Æ_·r£r_·¿m
 *
p
)

47 
Æ_ÿche_assoc
 *
ÿ
 = 
p
->
µ_¬g
;

48 
Æ_ÿche_İs
 *
İs
 = 
ÿ
->
ÿ_ÿche
->
c_İs
;

50 
	`NL_DBG
(2, "Inşudšg objeù %°štØÿch%p\n", 
obj
, 
ÿ
->
ÿ_ÿche
);

51 #ifdeà
NL_DEBUG


52 ià(
Æ_debug
 >= 4)

53 
	`Æ_objeù_dump
(
obj
, &
Æ_debug_dp
);

56 ià(
İs
->
co_ev’t_f‹r
)

57 ià(
İs
->
	`co_ev’t_f‹r
(
ÿ
->
ÿ_ÿche
, 
obj
è!ğ
NL_OK
)

60 ià(
İs
->
co_šşude_ev’t
)

61  
İs
->
	`co_šşude_ev’t
(
ÿ
->
ÿ_ÿche
, 
obj
, ca->
ÿ_chªge
,

62 
ÿ
->
ÿ_chªge_d©a
);

64  
	`Æ_ÿche_šşude
(
ÿ
->
ÿ_ÿche
, 
obj
, ca->
ÿ_chªge
, ca->
ÿ_chªge_d©a
);

65 
	}
}

67 
	$ev’t_šput
(
Æ_msg
 *
msg
, *
¬g
)

69 
Æ_ÿche_mngr
 *
mngr
 = 
¬g
;

70 
´ÙocŞ
 = 
	`Æmsg_g‘_´Ùo
(
msg
);

71 
ty³
 = 
	`Æmsg_hdr
(
msg
)->
Æmsg_ty³
;

72 
Æ_ÿche_İs
 *
İs
;

73 
i
, 
n
;

74 
Æ_·r£r_·¿m
 
p
 = {

75 .
µ_cb
 = 
šşude_cb
,

78 
	`NL_DBG
(2, "Cache manager %p, handling‚ew message %p‡sƒvent\n",

79 
mngr
, 
msg
);

80 #ifdeà
NL_DEBUG


81 ià(
Æ_debug
 >= 4)

82 
	`Æ_msg_dump
(
msg
, 
¡d”r
);

85 ià(
mngr
->
cm_´ÙocŞ
 !ğ
´ÙocŞ
)

86 
	`BUG
();

88 
i
 = 0; i < 
mngr
->
cm_Çssocs
; i++) {

89 ià(
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
) {

90 
İs
 = 
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
->
c_İs
;

91 
n
 = 0; 
İs
->
co_msgty³s
[n].
mt_id
 >= 0;‚++)

92 ià(
İs
->
co_msgty³s
[
n
].
mt_id
 =ğ
ty³
)

93 
found
;

97  
NL_SKIP
;

99 
found
:

100 
	`NL_DBG
(2, "Associated message %po cache %p\n",

101 
msg
, 
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
);

102 
p
.
µ_¬g
 = &
mngr
->
cm_assocs
[
i
];

104  
	`Æ_ÿche_·r£
(
İs
, 
NULL
, 
	`Æmsg_hdr
(
msg
), &
p
);

105 
	}
}

135 
	$Æ_ÿche_mngr_®loc
(
Æ_sock
 *
sk
, 
´ÙocŞ
, 
æags
,

136 
Æ_ÿche_mngr
 **
»suÉ
)

138 
Æ_ÿche_mngr
 *
mngr
;

139 
”r
 = -
NLE_NOMEM
;

142 ià(
æags
 & 
NL_ALLOCATED_SOCK
)

143 
	`BUG
();

145 
mngr
 = 
	`ÿÎoc
(1, (*mngr));

146 ià(!
mngr
)

147  -
NLE_NOMEM
;

149 ià(!
sk
) {

150 ià(!(
sk
 = 
	`Æ_sock‘_®loc
()))

151 
”rout
;

153 
æags
 |ğ
NL_ALLOCATED_SOCK
;

156 
mngr
->
cm_sock
 = 
sk
;

157 
mngr
->
cm_Çssocs
 = 
NASSOC_INIT
;

158 
mngr
->
cm_´ÙocŞ
 = 
´ÙocŞ
;

159 
mngr
->
cm_æags
 = 
æags
;

160 
mngr
->
cm_assocs
 = 
	`ÿÎoc
(mngr->
cm_Çssocs
,

161 (
Æ_ÿche_assoc
));

162 ià(!
mngr
->
cm_assocs
)

163 
”rout
;

166 
	`Æ_sock‘_di§bË_£q_check
(
mngr
->
cm_sock
);

168 ià((
”r
 = 
	`Æ_cÚÃù
(
mngr
->
cm_sock
, 
´ÙocŞ
)) < 0)

169 
”rout
;

171 ià((
”r
 = 
	`Æ_sock‘_£t_nÚblockšg
(
mngr
->
cm_sock
)) < 0)

172 
”rout
;

175 
mngr
->
cm_sync_sock
 = 
	`Æ_sock‘_®loc
();

176 ià(!
mngr
->
cm_sync_sock
) {

177 
”r
 = -
NLE_NOMEM
;

178 
”rout
;

180 ià((
”r
 = 
	`Æ_cÚÃù
(
mngr
->
cm_sync_sock
, 
´ÙocŞ
)) < 0)

181 
”rout_ä“_sync_sock
;

183 
	`NL_DBG
(1, "Allocated cache manager %p,…rotocol %d, %d caches\n",

184 
mngr
, 
´ÙocŞ
, mngr->
cm_Çssocs
);

186 *
»suÉ
 = 
mngr
;

189 
”rout_ä“_sync_sock
:

190 
	`Æ_sock‘_ä“
(
mngr
->
cm_sync_sock
);

191 
”rout
:

192 
	`Æ_ÿche_mngr_ä“
(
mngr
);

193  
”r
;

194 
	}
}

221 
	$Æ_ÿche_mngr_add_ÿche
(
Æ_ÿche_mngr
 *
mngr
, 
Æ_ÿche
 *
ÿche
,

222 
chªge_func_t
 
cb
, *
d©a
)

224 
Æ_ÿche_İs
 *
İs
;

225 
Æ_af_group
 *
g½
;

226 
”r
, 
i
;

228 
İs
 = 
ÿche
->
c_İs
;

229 ià(!
İs
)

230  -
NLE_INVAL
;

232 ià(
İs
->
co_´ÙocŞ
 !ğ
mngr
->
cm_´ÙocŞ
)

233  -
NLE_PROTO_MISMATCH
;

235 ià(
İs
->
co_groups
 =ğ
NULL
)

236  -
NLE_OPNOTSUPP
;

238 
i
 = 0; i < 
mngr
->
cm_Çssocs
; i++)

239 ià(
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
 &&

240 
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
->
c_İs
 =ğ
İs
)

241  -
NLE_EXIST
;

243 
»Œy
:

244 
i
 = 0; i < 
mngr
->
cm_Çssocs
; i++)

245 ià(!
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
)

248 ià(
i
 >ğ
mngr
->
cm_Çssocs
) {

249 
mngr
->
cm_Çssocs
 +ğ
NASSOC_EXPAND
;

250 
mngr
->
cm_assocs
 = 
	`»®loc
(mngr->cm_assocs,

251 
mngr
->
cm_Çssocs
 *

252 (
Æ_ÿche_assoc
));

253 ià(
mngr
->
cm_assocs
 =ğ
NULL
)

254  -
NLE_NOMEM
;

256 
	`mem£t
(
mngr
->
cm_assocs
 + (mngr->
cm_Çssocs
 - 
NASSOC_EXPAND
), 0,

257 
NASSOC_EXPAND
 * (
Æ_ÿche_assoc
));

259 
	`NL_DBG
(1, "Increased capacity of cache manager %p " \

260 "tØ%d\n", 
mngr
, mngr->
cm_Çssocs
);

261 
»Œy
;

264 
g½
 = 
İs
->
co_groups
; g½->
ag_group
; grp++) {

265 
”r
 = 
	`Æ_sock‘_add_memb”sh
(
mngr
->
cm_sock
, 
g½
->
ag_group
);

266 ià(
”r
 < 0)

267  
”r
;

270 
”r
 = 
	`Æ_ÿche_»fl
(
mngr
->
cm_sync_sock
, 
ÿche
);

271 ià(
”r
 < 0)

272 
”rout_drİ_memb”sh
;

274 
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
 = 
ÿche
;

275 
mngr
->
cm_assocs
[
i
].
ÿ_chªge
 = 
cb
;

276 
mngr
->
cm_assocs
[
i
].
ÿ_chªge_d©a
 = 
d©a
;

278 ià(
mngr
->
cm_æags
 & 
NL_AUTO_PROVIDE
)

279 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

281 
	`NL_DBG
(1, "Added cache %p <%s>o cache manager %p\n",

282 
ÿche
, 
	`Æ_ÿche_Çme
(ÿche), 
mngr
);

286 
”rout_drİ_memb”sh
:

287 
g½
 = 
İs
->
co_groups
; g½->
ag_group
; grp++)

288 
	`Æ_sock‘_drİ_memb”sh
(
mngr
->
cm_sock
, 
g½
->
ag_group
);

290  
”r
;

291 
	}
}

321 
	$Æ_ÿche_mngr_add
(
Æ_ÿche_mngr
 *
mngr
, cÚ¡ *
Çme
,

322 
chªge_func_t
 
cb
, *
d©a
, 
Æ_ÿche
 **
»suÉ
)

324 
Æ_ÿche_İs
 *
İs
;

325 
Æ_ÿche
 *
ÿche
;

326 
”r
;

328 
İs
 = 
	`Æ_ÿche_İs_lookup_§ã
(
Çme
);

329 ià(!
İs
)

330  -
NLE_NOCACHE
;

332 
ÿche
 = 
	`Æ_ÿche_®loc
(
İs
);

333 
	`Æ_ÿche_İs_put
(
İs
);

334 ià(!
ÿche
)

335  -
NLE_NOMEM
;

337 
”r
 = 
	`Æ_ÿche_mngr_add_ÿche
(
mngr
, 
ÿche
, 
cb
, 
d©a
);

338 ià(
”r
 < 0)

339 
”rout_ä“_ÿche
;

341 *
»suÉ
 = 
ÿche
;

344 
”rout_ä“_ÿche
:

345 
	`Æ_ÿche_ä“
(
ÿche
);

347  
”r
;

348 
	}
}

359 
	$Æ_ÿche_mngr_g‘_fd
(
Æ_ÿche_mngr
 *
mngr
)

361  
	`Æ_sock‘_g‘_fd
(
mngr
->
cm_sock
);

362 
	}
}

383 
	$Æ_ÿche_mngr_pŞl
(
Æ_ÿche_mngr
 *
mngr
, 
timeout
)

385 
»t
;

386 
pŞlfd
 
fds
 = {

387 .
fd
 = 
	`Æ_sock‘_g‘_fd
(
mngr
->
cm_sock
),

388 .
ev’ts
 = 
POLLIN
,

391 
	`NL_DBG
(3, "Cachmªag” %p,…Şl(èfd %d\n", 
mngr
, 
fds
.
fd
);

392 
»t
 = 
	`pŞl
(&
fds
, 1, 
timeout
);

393 
	`NL_DBG
(3, "Cachmªag” %p,…Şl(è»tuºed %d\n", 
mngr
, 
»t
);

394 ià(
»t
 < 0)

395  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

398 ià(
»t
 == 0)

401  
	`Æ_ÿche_mngr_d©a_»ady
(
mngr
);

402 
	}
}

419 
	$Æ_ÿche_mngr_d©a_»ady
(
Æ_ÿche_mngr
 *
mngr
)

421 
”r
, 
Ä—d
 = 0;

422 
Æ_cb
 *
cb
;

424 
	`NL_DBG
(2, "Cache manager %p,„eading‚ew data from fd %d\n",

425 
mngr
, 
	`Æ_sock‘_g‘_fd
(mngr->
cm_sock
));

427 
cb
 = 
	`Æ_cb_şÚe
(
mngr
->
cm_sock
->
s_cb
);

428 ià(
cb
 =ğ
NULL
)

429  -
NLE_NOMEM
;

431 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ev’t_šput
, 
mngr
);

433 (
”r
 = 
	`Æ_»cvmsgs_»pÜt
(
mngr
->
cm_sock
, 
cb
)) > 0) {

434 
	`NL_DBG
(2, "Cache manager %p,„ecvmsgs„ead %d messages\n",

435 
mngr
, 
”r
);

436 
Ä—d
 +ğ
”r
;

439 
	`Æ_cb_put
(
cb
);

440 ià(
”r
 < 0 &&ƒ¼ !ğ-
NLE_AGAIN
)

441  
”r
;

443  
Ä—d
;

444 
	}
}

455 
	$Æ_ÿche_mngr_šfo
(
Æ_ÿche_mngr
 *
mngr
, 
Æ_dump_·¿ms
 *
p
)

457 
buf
[128];

458 
i
;

460 
	`Æ_dump_lše
(
p
, "ÿche-mªag” <%p>\n", 
mngr
);

461 
	`Æ_dump_lše
(
p
, " .protocol = %s\n",

462 
	`Æ_Æçmy2¡r
(
mngr
->
cm_´ÙocŞ
, 
buf
, (buf)));

463 
	`Æ_dump_lše
(
p
, " .æag  = %#x\n", 
mngr
->
cm_æags
);

464 
	`Æ_dump_lše
(
p
, " .Çssoc  = %u\n", 
mngr
->
cm_Çssocs
);

465 
	`Æ_dump_lše
(
p
, " .sock = <%p>\n", 
mngr
->
cm_sock
);

467 
i
 = 0; i < 
mngr
->
cm_Çssocs
; i++) {

468 
Æ_ÿche_assoc
 *
assoc
 = &
mngr
->
cm_assocs
[
i
];

470 ià(
assoc
->
ÿ_ÿche
) {

471 
	`Æ_dump_lše
(
p
, " .ÿche[%d] = <%p> {\n", 
i
, 
assoc
->
ÿ_ÿche
);

472 
	`Æ_dump_lše
(
p
, " .Çmğ%s\n", 
assoc
->
ÿ_ÿche
->
c_İs
->
co_Çme
);

473 
	`Æ_dump_lše
(
p
, " .chªge_funøğ<%p>\n", 
assoc
->
ÿ_chªge
);

474 
	`Æ_dump_lše
(
p
, " .chªge_d©¨ğ<%p>\n", 
assoc
->
ÿ_chªge_d©a
);

475 
	`Æ_dump_lše
(
p
, " .n™em ğ%u\n", 
	`Æ_ÿche_n™ems
(
assoc
->
ÿ_ÿche
));

476 
	`Æ_dump_lše
(
p
, " .objects = {\n");

478 
p
->
dp_´efix
 += 6;

479 
	`Æ_ÿche_dump
(
assoc
->
ÿ_ÿche
, 
p
);

480 
p
->
dp_´efix
 -= 6;

482 
	`Æ_dump_lše
(
p
, " }\n");

483 
	`Æ_dump_lše
(
p
, " }\n");

486 
	}
}

494 
	$Æ_ÿche_mngr_ä“
(
Æ_ÿche_mngr
 *
mngr
)

496 
i
;

498 ià(!
mngr
)

501 ià(
mngr
->
cm_sock
)

502 
	`Æ_şo£
(
mngr
->
cm_sock
);

504 ià(
mngr
->
cm_sync_sock
) {

505 
	`Æ_şo£
(
mngr
->
cm_sync_sock
);

506 
	`Æ_sock‘_ä“
(
mngr
->
cm_sync_sock
);

509 ià(
mngr
->
cm_æags
 & 
NL_ALLOCATED_SOCK
)

510 
	`Æ_sock‘_ä“
(
mngr
->
cm_sock
);

512 
i
 = 0; i < 
mngr
->
cm_Çssocs
; i++) {

513 ià(
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
) {

514 
	`Æ_ÿche_mngt_uÅrovide
(
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
);

515 
	`Æ_ÿche_ä“
(
mngr
->
cm_assocs
[
i
].
ÿ_ÿche
);

519 
	`ä“
(
mngr
->
cm_assocs
);

521 
	`NL_DBG
(1, "Cachmªag” %°ä“d\n", 
mngr
);

523 
	`ä“
(
mngr
);

524 
	}
}

	@mylibnl/libnl-3.2.25/lib/cache_mngt.c

28 
	~<Ãšk-´iv©e/Ãšk.h
>

29 
	~<Ãšk/Ãšk.h
>

30 
	~<Ãšk/ÿche.h
>

31 
	~<Ãšk/uts.h
>

33 
Æ_ÿche_İs
 *
	gÿche_İs
;

34 
NL_RW_LOCK
(
ÿche_İs_lock
);

41 
Æ_ÿche_İs
 *
	$__Æ_ÿche_İs_lookup
(cÚ¡ *
Çme
)

43 
Æ_ÿche_İs
 *
İs
;

45 
İs
 = 
ÿche_İs
; ops; op ğİs->
co_Ãxt
)

46 ià(!
	`¡rcmp
(
İs
->
co_Çme
, 
Çme
))

47  
İs
;

49  
NULL
;

50 
	}
}

56 
	$Æ_ÿche_İs_g‘
(
Æ_ÿche_İs
 *
İs
)

58 
İs
->
co_»fút
++;

59 
	}
}

65 
	$Æ_ÿche_İs_put
(
Æ_ÿche_İs
 *
İs
)

67 
İs
->
co_»fút
--;

68 
	}
}

79 
Æ_ÿche_İs
 *
	$Æ_ÿche_İs_lookup
(cÚ¡ *
Çme
)

81 
Æ_ÿche_İs
 *
İs
;

83 
	`Æ_»ad_lock
(&
ÿche_İs_lock
);

84 
İs
 = 
	`__Æ_ÿche_İs_lookup
(
Çme
);

85 
	`Æ_»ad_uÆock
(&
ÿche_İs_lock
);

87  
İs
;

88 
	}
}

99 
Æ_ÿche_İs
 *
	$Æ_ÿche_İs_lookup_§ã
(cÚ¡ *
Çme
)

101 
Æ_ÿche_İs
 *
İs
;

103 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

104 ià((
İs
 = 
	`__Æ_ÿche_İs_lookup
(
Çme
)))

105 
	`Æ_ÿche_İs_g‘
(
İs
);

106 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

108  
İs
;

109 
	}
}

111 
Æ_ÿche_İs
 *
	$__ÿche_İs_assocŸ‹
(
´ÙocŞ
, 
msgty³
)

113 
i
;

114 
Æ_ÿche_İs
 *
İs
;

116 
İs
 = 
ÿche_İs
; ops; op ğİs->
co_Ãxt
) {

117 ià(
İs
->
co_´ÙocŞ
 !ğ
´ÙocŞ
)

120 
i
 = 0; 
İs
->
co_msgty³s
[i].
mt_id
 >= 0; i++)

121 ià(
İs
->
co_msgty³s
[
i
].
mt_id
 =ğ
msgty³
)

122  
İs
;

125  
NULL
;

126 
	}
}

140 
Æ_ÿche_İs
 *
	$Æ_ÿche_İs_assocŸ‹
(
´ÙocŞ
, 
msgty³
)

142 
Æ_ÿche_İs
 *
İs
;

144 
	`Æ_»ad_lock
(&
ÿche_İs_lock
);

145 
İs
 = 
	`__ÿche_İs_assocŸ‹
(
´ÙocŞ
, 
msgty³
);

146 
	`Æ_»ad_uÆock
(&
ÿche_İs_lock
);

148  
İs
;

149 
	}
}

164 
Æ_ÿche_İs
 *
	$Æ_ÿche_İs_assocŸ‹_§ã
(
´ÙocŞ
, 
msgty³
)

166 
Æ_ÿche_İs
 *
İs
;

168 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

169 ià((
İs
 = 
	`__ÿche_İs_assocŸ‹
(
´ÙocŞ
, 
msgty³
)))

170 
	`Æ_ÿche_İs_g‘
(
İs
);

171 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

173  
İs
;

174 
	}
}

189 
Æ_msgty³
 *
	$Æ_msgty³_lookup
(
Æ_ÿche_İs
 *
İs
, 
msgty³
)

191 
i
;

193 
i
 = 0; 
İs
->
co_msgty³s
[i].
mt_id
 >= 0; i++)

194 ià(
İs
->
co_msgty³s
[
i
].
mt_id
 =ğ
msgty³
)

195  &
İs
->
co_msgty³s
[
i
];

197  
NULL
;

198 
	}
}

201 
Æ_ÿche_İs
 *
	$ÿche_İs_lookup_fÜ_obj
(
Æ_objeù_İs
 *
obj_İs
)

203 
Æ_ÿche_İs
 *
İs
;

205 
İs
 = 
ÿche_İs
; ops; op ğİs->
co_Ãxt
)

206 ià(
İs
->
co_obj_İs
 =ğ
obj_İs
)

207  
İs
;

209  
NULL
;

211 
	}
}

218 
Æ_ÿche_İs_fÜ—ch
((*
cb
)(
Æ_ÿche_İs
 *, *), *
¬g
)

220 
Æ_ÿche_İs
 *
İs
;

222 
	`Æ_»ad_lock
(&
ÿche_İs_lock
);

223 
İs
 = 
ÿche_İs
; ops; op ğİs->
co_Ãxt
)

224 
	`cb
(
İs
, 
¬g
);

225 
	`Æ_»ad_uÆock
(&
ÿche_İs_lock
);

226 
	}
}

236 
	$Æ_ÿche_İs_£t_æags
(
Æ_ÿche_İs
 *
İs
, 
æags
)

238 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

239 
İs
->
co_æags
 |ğ
æags
;

240 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

241 
	}
}

252 
	$Æ_ÿche_mngt_»gi¡”
(
Æ_ÿche_İs
 *
İs
)

254 ià(!
İs
->
co_Çme
 || !İs->
co_obj_İs
)

255  -
NLE_INVAL
;

257 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

258 ià(
	`__Æ_ÿche_İs_lookup
(
İs
->
co_Çme
)) {

259 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

260  -
NLE_EXIST
;

263 
İs
->
co_»fút
 = 0;

264 
İs
->
co_Ãxt
 = 
ÿche_İs
;

265 
ÿche_İs
 = 
İs
;

266 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

268 
	`NL_DBG
(1, "Regi¡”ed cachİ”©iÚ %s\n", 
İs
->
co_Çme
);

271 
	}
}

284 
	$Æ_ÿche_mngt_uÄegi¡”
(
Æ_ÿche_İs
 *
İs
)

286 
Æ_ÿche_İs
 *
t
, **

;

287 
”r
 = 0;

289 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

291 ià(
İs
->
co_»fút
 > 0) {

292 
”r
 = -
NLE_BUSY
;

293 
”rout
;

296 

 = &
ÿche_İs
; (
t
=*è!ğ
NULL
;°ğ&t->
co_Ãxt
)

297 ià(
t
 =ğ
İs
)

300 ià(!
t
) {

301 
”r
 = -
NLE_NOCACHE
;

302 
”rout
;

305 
	`NL_DBG
(1, "UÄegi¡”ed cachİ”©iÚ %s\n", 
İs
->
co_Çme
);

307 *

 = 
t
->
co_Ãxt
;

308 
”rout
:

309 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

311  
”r
;

312 
	}
}

329 
	$Æ_ÿche_mngt_´ovide
(
Æ_ÿche
 *
ÿche
)

331 
Æ_ÿche_İs
 *
İs
;

333 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

335 
İs
 = 
	`ÿche_İs_lookup_fÜ_obj
(
ÿche
->
c_İs
->
co_obj_İs
);

336 ià(!
İs
)

337 
	`BUG
();

339 
	`Æ_ÿche_g‘
(
ÿche
);

345 ià(!
İs
->
co_majÜ_ÿche
)

346 
	`Æ_ÿche_İs_g‘
(
İs
);

348 
İs
->
co_majÜ_ÿche
 = 
ÿche
;

351 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

352 
	}
}

362 
	$Æ_ÿche_mngt_uÅrovide
(
Æ_ÿche
 *
ÿche
)

364 
Æ_ÿche_İs
 *
İs
;

366 
	`Æ_wr™e_lock
(&
ÿche_İs_lock
);

368 
İs
 = 
	`ÿche_İs_lookup_fÜ_obj
(
ÿche
->
c_İs
->
co_obj_İs
);

369 ià(!
İs
)

370 
	`BUG
();

371 ià(
İs
->
co_majÜ_ÿche
 =ğ
ÿche
) {

372 
	`Æ_ÿche_ä“
(
İs
->
co_majÜ_ÿche
);

373 
	`Æ_ÿche_İs_put
(
İs
);

374 
İs
->
co_majÜ_ÿche
 = 
NULL
;

377 
	`Æ_wr™e_uÆock
(&
ÿche_İs_lock
);

378 
	}
}

380 
Æ_ÿche
 *
	$__Æ_ÿche_mngt_»quœe
(cÚ¡ *
Çme
)

382 
Æ_ÿche_İs
 *
İs
;

383 
Æ_ÿche
 *
ÿche
 = 
NULL
;

385 
İs
 = 
	`Æ_ÿche_İs_lookup_§ã
(
Çme
);

386 ià(
İs
) {

387 
ÿche
 = 
İs
->
co_majÜ_ÿche
;

388 
	`Æ_ÿche_İs_put
(
İs
);

391  
ÿche
;

392 
	}
}

405 
Æ_ÿche
 *
	$Æ_ÿche_mngt_»quœe
(cÚ¡ *
Çme
)

407 
Æ_ÿche
 *
ÿche
;

409 ià(!(
ÿche
 = 
	`__Æ_ÿche_mngt_»quœe
(
Çme
)))

410 
	`NL_DBG
(1, "Application BUG: Your‡pplication must "

413 " API docum’tiÚ fÜ mÜd‘as.\n", 
Çme
);

415  
ÿche
;

416 
	}
}

427 
Æ_ÿche
 *
	$Æ_ÿche_mngt_»quœe_§ã
(cÚ¡ *
Çme
)

429 
Æ_ÿche
 *
ÿche
;

431 ià((
ÿche
 = 
	`Æ_ÿche_mngt_»quœe
(
Çme
)))

432 
	`Æ_ÿche_g‘
(
ÿche
);

434  
ÿche
;

435 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/cls/basic.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/şs.h
>

15 
	~<Ãšk/rou‹/şs/basic.h
>

17 
	$´št_u§ge
()

19 
	`´štf
(

31 
	}
}

33 
	$·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

35 
¹Æ_şs
 *
şs
 = (¹Æ_ş *è
tc
;

36 
¹Æ_em©ch_Œ“
 *
Œ“
;

37 
ušt32_t
 
rg‘
;

38 
”r
;

41 
c
, 
İtidx
 = 0;

43 
ARG_TARGET
 = 257,

44 
ARG_DEFAULT
 = 258,

46 
İtiÚ
 
lÚg_İts
[] = {

53 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "ht:e:", 
lÚg_İts
, &
İtidx
);

54 ià(
c
 == -1)

57 
c
) {

59 
	`´št_u§ge
();

60 
	`ex™
(0);

63 ià((
”r
 = 
	`¹Æ_tc_¡r2hªdË
(
İrg
, &
rg‘
)) < 0)

64 
	`Æ_şi_çl
(
”r
, "Unableo…arsearget \"%s\":",

65 
İrg
, 
	`Æ_g‘”rÜ
(
”r
));

67 
	`¹Æ_basic_£t_rg‘
(
şs
, 
rg‘
);

71 
Œ“
 = 
	`Æ_şi_şs_·r£_em©ch
(
şs
, 
İrg
);

72 
	`¹Æ_basic_£t_em©ch
(
şs
, 
Œ“
);

76 
	}
}

78 
Æ_şi_tc_moduË
 
	gbasic_moduË
 =

80 .
tm_Çme
 = "basic",

81 .
	gtm_ty³
 = 
RTNL_TC_TYPE_CLS
,

82 .
	gtm_·r£_¬gv
 = 
·r£_¬gv
,

85 
__š™
 
	$basic_š™
()

87 
	`Æ_şi_tc_»gi¡”
(&
basic_moduË
);

88 
	}
}

90 
__ex™
 
	$basic_ex™
()

92 
	`Æ_şi_tc_uÄegi¡”
(&
basic_moduË
);

93 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/cls/cgroup.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/şs.h
>

15 
	~<Ãšk/rou‹/şs/cgroup.h
>

17 
	$´št_u§ge
()

19 
	`´štf
(

28 
	}
}

30 
	$·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

32 
¹Æ_şs
 *
şs
 = (¹Æ_ş *è
tc
;

33 
¹Æ_em©ch_Œ“
 *
Œ“
;

36 
c
, 
İtidx
 = 0;

37 
İtiÚ
 
lÚg_İts
[] = {

43 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "he:", 
lÚg_İts
, &
İtidx
);

44 ià(
c
 == -1)

47 
c
) {

49 
	`´št_u§ge
();

50 
	`ex™
(0);

53 
Œ“
 = 
	`Æ_şi_şs_·r£_em©ch
(
şs
, 
İrg
);

54 
	`¹Æ_cgroup_£t_em©ch
(
şs
, 
Œ“
);

58 
	}
}

60 
Æ_şi_tc_moduË
 
	gcgroup_moduË
 =

62 .
tm_Çme
 = "cgroup",

63 .
	gtm_ty³
 = 
RTNL_TC_TYPE_CLS
,

64 .
	gtm_·r£_¬gv
 = 
·r£_¬gv
,

67 
__š™
 
	$cgroup_š™
()

69 
	`Æ_şi_tc_»gi¡”
(&
cgroup_moduË
);

70 
	}
}

72 
__ex™
 
	$cgroup_ex™
()

74 
	`Æ_şi_tc_uÄegi¡”
(&
cgroup_moduË
);

75 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/bfifo.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/rou‹/qdisc/fifo.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

28 
	}
}

30 
	$bfifo_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

32 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

33 
lim™
;

36 
c
, 
İtidx
 = 0;

38 
ARG_LIMIT
 = 257,

40 
İtiÚ
 
lÚg_İts
[] = {

42 { "lim™", 1, 0, 
ARG_LIMIT
 },

46 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

47 ià(
c
 == -1)

50 
c
) {

52 
	`´št_u§ge
();

55 
ARG_LIMIT
:

56 
lim™
 = 
	`Æ_size2št
(
İrg
);

57 ià(
lim™
 < 0) {

58 
	`Æ_şi_çl
(
lim™
, "Unableo…arse bfifo†imit "

59 "\"%s\": Inv®id fÜm©.", 
İrg
);

62 
	`¹Æ_qdisc_fifo_£t_lim™
(
qdisc
, 
lim™
);

66 
	}
}

68 
Æ_şi_tc_moduË
 
	gbfifo_moduË
 =

70 .
tm_Çme
 = "bfifo",

71 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

72 .
	gtm_·r£_¬gv
 = 
bfifo_·r£_¬gv
,

75 
__š™
 
	$bfifo_š™
()

77 
	`Æ_şi_tc_»gi¡”
(&
bfifo_moduË
);

78 
	}
}

80 
__ex™
 
	$bfifo_ex™
()

82 
	`Æ_şi_tc_uÄegi¡”
(&
bfifo_moduË
);

83 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/blackhole.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

26 
	}
}

28 
	$bÏckhŞe_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

31 
c
, 
İtidx
 = 0;

32 
İtiÚ
 
lÚg_İts
[] = {

37 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

38 ià(
c
 == -1)

41 
c
) {

43 
	`´št_u§ge
();

47 
	}
}

49 
Æ_şi_tc_moduË
 
	gbÏckhŞe_moduË
 =

51 .
tm_Çme
 = "blackhole",

52 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

53 .
	gtm_·r£_¬gv
 = 
bÏckhŞe_·r£_¬gv
,

56 
__š™
 
	$bÏckhŞe_š™
()

58 
	`Æ_şi_tc_»gi¡”
(&
bÏckhŞe_moduË
);

59 
	}
}

61 
__ex™
 
	$bÏckhŞe_ex™
()

63 
	`Æ_şi_tc_uÄegi¡”
(&
bÏckhŞe_moduË
);

64 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/fq_codel.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/rou‹/qdisc/fq_cod–.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

32 
	}
}

34 
	$fq_cod–_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

36 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

37 
lim™
, 
æows
;

38 
ušt32_t
 
quªtum
, 
rg‘
, 
š‹rv®
;

41 
c
, 
İtidx
 = 0;

43 
ARG_LIMIT
 = 257,

44 
ARG_QUANTUM
 = 258,

45 
ARG_FLOWS
,

46 
ARG_INTERVAL
,

47 
ARG_TARGET
,

49 
İtiÚ
 
lÚg_İts
[] = {

51 { "lim™", 1, 0, 
ARG_LIMIT
 },

52 { "quªtum", 1, 0, 
ARG_QUANTUM
 },

53 { "æows", 1, 0, 
ARG_FLOWS
},

54 { "š‹rv®", 1, 0, 
ARG_INTERVAL
},

55 { "rg‘", 1, 0, 
ARG_TARGET
},

59 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

60 ià(
c
 == -1)

63 
c
) {

65 
	`´št_u§ge
();

68 
ARG_LIMIT
:

69 
lim™
 = 
	`Æ_şi_·r£_u32
(
İrg
);

70 
	`¹Æ_qdisc_fq_cod–_£t_lim™
(
qdisc
, 
lim™
);

73 
ARG_QUANTUM
:

74 
quªtum
 = 
	`Æ_şi_·r£_u32
(
İrg
);

75 
	`¹Æ_qdisc_fq_cod–_£t_quªtum
(
qdisc
, 
quªtum
);

78 
ARG_FLOWS
:

79 
æows
 = 
	`Æ_şi_·r£_u32
(
İrg
);

80 
	`¹Æ_qdisc_fq_cod–_£t_æows
(
qdisc
, 
æows
);

83 
ARG_INTERVAL
:

84 
š‹rv®
 = 
	`Æ_şi_·r£_u32
(
İrg
);

85 
	`¹Æ_qdisc_fq_cod–_£t_š‹rv®
(
qdisc
, 
š‹rv®
);

88 
ARG_TARGET
:

89 
rg‘
 = 
	`Æ_şi_·r£_u32
(
İrg
);

90 
	`¹Æ_qdisc_fq_cod–_£t_rg‘
(
qdisc
, 
rg‘
);

95 
	}
}

97 
Æ_şi_tc_moduË
 
	gfq_cod–_moduË
 =

99 .
tm_Çme
 = "fq_codel",

100 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

101 .
	gtm_·r£_¬gv
 = 
fq_cod–_·r£_¬gv
,

104 
__š™
 
	$fq_cod–_š™
()

106 
	`Æ_şi_tc_»gi¡”
(&
fq_cod–_moduË
);

107 
	}
}

109 
__ex™
 
	$fq_cod–_ex™
()

111 
	`Æ_şi_tc_uÄegi¡”
(&
fq_cod–_moduË
);

112 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/htb.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/rou‹/qdisc/htb.h
>

16 
	$´št_qdisc_u§ge
()

18 
	`´štf
(

29 
	}
}

31 
	$htb_·r£_qdisc_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

33 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

36 
c
, 
İtidx
 = 0;

38 
ARG_R2Q
 = 257,

39 
ARG_DEFAULT
 = 258,

41 
İtiÚ
 
lÚg_İts
[] = {

43 { "r2q", 1, 0, 
ARG_R2Q
 },

44 { "deçuÉ", 1, 0, 
ARG_DEFAULT
 },

48 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hv", 
lÚg_İts
, &
İtidx
);

49 ià(
c
 == -1)

52 
c
) {

54 
	`´št_qdisc_u§ge
();

57 
ARG_R2Q
:

58 
	`¹Æ_htb_£t_¿‹2quªtum
(
qdisc
, 
	`Æ_şi_·r£_u32
(
İrg
));

61 
ARG_DEFAULT
:

62 
	`¹Æ_htb_£t_defşs
(
qdisc
, 
	`Æ_şi_·r£_u32
(
İrg
));

66 
	}
}

68 
	$´št_şass_u§ge
()

70 
	`´štf
(

85 
	}
}

87 
	$htb_·r£_şass_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

89 
¹Æ_şass
 *
şass
 = (¹Æ_şas *è
tc
;

90 
¿‹
;

93 
c
, 
İtidx
 = 0;

95 
ARG_RATE
 = 257,

96 
ARG_QUANTUM
 = 258,

97 
ARG_CEIL
,

98 
ARG_PRIO
,

99 
ARG_BURST
,

100 
ARG_CBURST
,

102 
İtiÚ
 
lÚg_İts
[] = {

104 { "¿‹", 1, 0, 
ARG_RATE
 },

105 { "quªtum", 1, 0, 
ARG_QUANTUM
 },

106 { "û", 1, 0, 
ARG_CEIL
 },

107 { "´io", 1, 0, 
ARG_PRIO
 },

108 { "bur¡", 1, 0, 
ARG_BURST
 },

109 { "cbur¡", 1, 0, 
ARG_CBURST
 },

113 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

114 ià(
c
 == -1)

117 
c
) {

119 
	`´št_şass_u§ge
();

122 
ARG_RATE
:

123 
¿‹
 = 
	`Æ_size2št
(
İrg
);

124 ià(
¿‹
 < 0) {

125 
	`Æ_şi_çl
(
¿‹
, "Unableo…arse htb„ate "

126 "\"%s\": Inv®id fÜm©.", 
İrg
);

129 
	`¹Æ_htb_£t_¿‹
(
şass
, 
¿‹
);

132 
ARG_CEIL
:

133 
¿‹
 = 
	`Æ_size2št
(
İrg
);

134 ià(
¿‹
 < 0) {

135 
	`Æ_şi_çl
(
¿‹
, "Unableo…arse htb ceil„ate "

136 "\"%s\": Inv®id fÜm©.", 
İrg
);

139 
	`¹Æ_htb_£t_û
(
şass
, 
¿‹
);

142 
ARG_PRIO
:

143 
	`¹Æ_htb_£t_´io
(
şass
, 
	`Æ_şi_·r£_u32
(
İrg
));

146 
ARG_QUANTUM
:

147 
¿‹
 = 
	`Æ_size2št
(
İrg
);

148 ià(
¿‹
 < 0) {

149 
	`Æ_şi_çl
(
¿‹
, "Unableo…arse quantum "

150 "\"%s\": Inv®id fÜm©.", 
İrg
);

153 
	`¹Æ_htb_£t_quªtum
(
şass
, 
¿‹
);

156 
ARG_BURST
:

157 
¿‹
 = 
	`Æ_size2št
(
İrg
);

158 ià(
¿‹
 < 0) {

159 
	`Æ_şi_çl
(
¿‹
, "Unableo…arse burst "

160 "\"%s\": Inv®id fÜm©.", 
İrg
);

163 
	`¹Æ_htb_£t_rbufãr
(
şass
, 
¿‹
);

166 
ARG_CBURST
:

167 
¿‹
 = 
	`Æ_size2št
(
İrg
);

168 ià(
¿‹
 < 0) {

169 
	`Æ_şi_çl
(
¿‹
, "Unableo…arse cburst "

170 "\"%s\": Inv®id fÜm©.", 
İrg
);

173 
	`¹Æ_htb_£t_cbufãr
(
şass
, 
¿‹
);

177 
	}
}

179 
Æ_şi_tc_moduË
 
	ghtb_qdisc_moduË
 =

181 .
tm_Çme
 = "htb",

182 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

183 .
	gtm_·r£_¬gv
 = 
htb_·r£_qdisc_¬gv
,

186 
Æ_şi_tc_moduË
 
	ghtb_şass_moduË
 =

188 .
tm_Çme
 = "htb",

189 .
	gtm_ty³
 = 
RTNL_TC_TYPE_CLASS
,

190 .
	gtm_·r£_¬gv
 = 
htb_·r£_şass_¬gv
,

193 
__š™
 
	$htb_š™
()

195 
	`Æ_şi_tc_»gi¡”
(&
htb_qdisc_moduË
);

196 
	`Æ_şi_tc_»gi¡”
(&
htb_şass_moduË
);

197 
	}
}

199 
__ex™
 
	$htb_ex™
()

201 
	`Æ_şi_tc_uÄegi¡”
(&
htb_şass_moduË
);

202 
	`Æ_şi_tc_uÄegi¡”
(&
htb_qdisc_moduË
);

203 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/ingress.c

13 
	~<Ãšk/şi/uts.h
>

14 
	~<Ãšk/şi/tc.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

27 
	}
}

29 
	$šg»ss_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

32 
c
, 
İtidx
 = 0;

33 
İtiÚ
 
lÚg_İts
[] = {

38 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

39 ià(
c
 == -1)

42 
c
) {

44 
	`´št_u§ge
();

48 
	}
}

50 
Æ_şi_tc_moduË
 
	gšg»ss_moduË
 =

52 .
tm_Çme
 = "ingress",

53 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

54 .
	gtm_·r£_¬gv
 = 
šg»ss_·r£_¬gv
,

57 
__š™
 
	$šg»ss_š™
()

59 
	`Æ_şi_tc_»gi¡”
(&
šg»ss_moduË
);

60 
	}
}

62 
__ex™
 
	$šg»ss_ex™
()

64 
	`Æ_şi_tc_uÄegi¡”
(&
šg»ss_moduË
);

65 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/pfifo.c

13 
	~<Ãšk/şi/uts.h
>

14 
	~<Ãšk/şi/tc.h
>

15 
	~<Ãšk/rou‹/qdisc/fifo.h
>

17 
	$´št_u§ge
()

19 
	`´štf
(

29 
	}
}

31 
	$pfifo_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

33 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

36 
c
, 
İtidx
 = 0;

38 
ARG_LIMIT
 = 257,

40 
İtiÚ
 
lÚg_İts
[] = {

42 { "lim™", 1, 0, 
ARG_LIMIT
 },

46 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

47 ià(
c
 == -1)

50 
c
) {

52 
	`´št_u§ge
();

55 
ARG_LIMIT
:

56 
	`¹Æ_qdisc_fifo_£t_lim™
(
qdisc
, 
	`Æ_şi_·r£_u32
(
İrg
));

60 
	}
}

62 
Æ_şi_tc_moduË
 
	gpfifo_moduË
 =

64 .
tm_Çme
 = "pfifo",

65 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

66 .
	gtm_·r£_¬gv
 = 
pfifo_·r£_¬gv
,

69 
__š™
 
	$pfifo_š™
()

71 
	`Æ_şi_tc_»gi¡”
(&
pfifo_moduË
);

72 
	}
}

74 
__ex™
 
	$pfifo_ex™
()

76 
	`Æ_şi_tc_uÄegi¡”
(&
pfifo_moduË
);

77 
	}
}

	@mylibnl/libnl-3.2.25/lib/cli/qdisc/plug.c

13 
	~<Ãšk/şi/uts.h
>

14 
	~<Ãšk/şi/tc.h
>

15 
	~<Ãšk/rou‹/qdisc/¶ug.h
>

17 
	$´št_u§ge
()

19 
	`´štf
(

47 
	}
}

49 
	$¶ug_·r£_¬gv
(
¹Æ_tc
 *
tc
, 
¬gc
, **
¬gv
)

51 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

54 
c
, 
İtidx
 = 0;

56 
ARG_LIMIT
 = 257,

57 
ARG_BUFFER
 = 258,

58 
ARG_RELEASE_ONE
 = 259,

59 
ARG_RELEASE_INDEFINITE
 = 260,

61 
İtiÚ
 
lÚg_İts
[] = {

63 { "lim™", 1, 0, 
ARG_LIMIT
 },

64 { "bufãr", 0, 0, 
ARG_BUFFER
 },

65 { "»Ëa£-Úe", 0, 0, 
ARG_RELEASE_ONE
 },

66 { "»Ëa£-šdefš™e", 0, 0, 
ARG_RELEASE_INDEFINITE
 },

70 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "h", 
lÚg_İts
, &
İtidx
);

71 ià(
c
 == -1)

74 
c
) {

76 
	`´št_u§ge
();

79 
ARG_LIMIT
:

80 
	`¹Æ_qdisc_¶ug_£t_lim™
(
qdisc
, 
	`Æ_şi_·r£_u32
(
İrg
));

83 
ARG_BUFFER
:

84 
	`¹Æ_qdisc_¶ug_bufãr
(
qdisc
);

87 
ARG_RELEASE_ONE
:

88 
	`¹Æ_qdisc_¶ug_»Ëa£_Úe
(
qdisc
);

91 
ARG_RELEASE_INDEFINITE
:

92 
	`¹Æ_qdisc_¶ug_»Ëa£_šdefš™e
(
qdisc
);

96 
	}
}

98 
Æ_şi_tc_moduË
 
	g¶ug_moduË
 =

100 .
tm_Çme
 = "plug",

101 .
	gtm_ty³
 = 
RTNL_TC_TYPE_QDISC
,

102 .
	gtm_·r£_¬gv
 = 
¶ug_·r£_¬gv
,

105 
__š™
 
	$¶ug_š™
()

107 
	`Æ_şi_tc_»gi¡”
(&
¶ug_moduË
);

108 
	}
}

110 
__ex™
 
	$¶ug_ex™
()

112 
	`Æ_şi_tc_uÄegi¡”
(&
¶ug_moduË
);

113 
	}
}

	@mylibnl/libnl-3.2.25/lib/data.c

30 
	~<Ãšk-´iv©e/Ãšk.h
>

31 
	~<Ãšk/Ãšk.h
>

32 
	~<Ãšk/uts.h
>

33 
	~<lšux/sock‘.h
>

50 
Æ_d©a
 *
	$Æ_d©a_®loc
(*
buf
, 
size_t
 
size
)

52 
Æ_d©a
 *
d©a
;

54 
d©a
 = 
	`ÿÎoc
(1, (*data));

55 ià(!
d©a
)

56 
”rout
;

58 
d©a
->
d_d©a
 = 
	`ÿÎoc
(1, 
size
);

59 ià(!
d©a
->
d_d©a
) {

60 
	`ä“
(
d©a
);

61 
”rout
;

64 
d©a
->
d_size
 = 
size
;

66 ià(
buf
)

67 
	`memıy
(
d©a
->
d_d©a
, 
buf
, 
size
);

69  
d©a
;

70 
”rout
:

71  
NULL
;

72 
	}
}

84 
Æ_d©a
 *
	$Æ_d©a_®loc_©Œ
(
Æ©Œ
 *
Æa
)

86  
	`Æ_d©a_®loc
(
	`Æa_d©a
(
Æa
), 
	`Æa_Ën
(nla));

87 
	}
}

95 
Æ_d©a
 *
	$Æ_d©a_şÚe
(
Æ_d©a
 *
¤c
)

97  
	`Æ_d©a_®loc
(
¤c
->
d_d©a
, src->
d_size
);

98 
	}
}

111 
	$Æ_d©a_­³nd
(
Æ_d©a
 *
d©a
, *
buf
, 
size_t
 
size
)

113 ià(
size
 > 0) {

114 
d©a
->
d_d©a
 = 
	`»®loc
(d©a->d_d©a, d©a->
d_size
 + 
size
);

115 ià(!
d©a
->
d_d©a
)

116  -
NLE_NOMEM
;

118 ià(
buf
)

119 
	`memıy
(
d©a
->
d_d©a
 + d©a->
d_size
, 
buf
, 
size
);

121 
	`mem£t
(
d©a
->
d_d©a
 + d©a->
d_size
, 0, 
size
);

123 
d©a
->
d_size
 +ğ
size
;

127 
	}
}

133 
	$Æ_d©a_ä“
(
Æ_d©a
 *
d©a
)

135 ià(
d©a
)

136 
	`ä“
(
d©a
->
d_d©a
);

138 
	`ä“
(
d©a
);

139 
	}
}

153 *
	$Æ_d©a_g‘
(
Æ_d©a
 *
d©a
)

155  
d©a
->
d_size
 > 0 ? d©a->
d_d©a
 : 
NULL
;

156 
	}
}

163 
size_t
 
	$Æ_d©a_g‘_size
(
Æ_d©a
 *
d©a
)

165  
d©a
->
d_size
;

166 
	}
}

183 
	$Æ_d©a_cmp
(
Æ_d©a
 *
a
, Æ_d©¨*
b
)

185 *
a_
 = 
	`Æ_d©a_g‘
(
a
);

186 *
b_
 = 
	`Æ_d©a_g‘
(
b
);

188 ià(
a_
 && 
b_
)

189  
	`memcmp
(
a_
, 
b_
, 
	`Æ_d©a_g‘_size
(
a
));

192 
	}
}

	@mylibnl/libnl-3.2.25/lib/defs.h

8 
	#HAVE_DLFCN_H
 1

	)

11 
	#HAVE_INTTYPES_H
 1

	)

14 
	#HAVE_LIBM
 1

	)

17 
	#HAVE_LIBPTHREAD
 1

	)

20 
	#HAVE_MEMORY_H
 1

	)

23 
	#HAVE_STDINT_H
 1

	)

26 
	#HAVE_STDLIB_H
 1

	)

29 
	#HAVE_STRINGS_H
 1

	)

32 
	#HAVE_STRING_H
 1

	)

35 
	#HAVE_SYS_STAT_H
 1

	)

38 
	#HAVE_SYS_TYPES_H
 1

	)

41 
	#HAVE_UNISTD_H
 1

	)

45 
	#LT_OBJDIR
 ".libs/"

	)

48 
	#NL_DEBUG
 1

	)

54 
	#PACKAGE
 "libÆ"

	)

57 
	#PACKAGE_BUGREPORT
 ""

	)

60 
	#PACKAGE_NAME
 "libÆ"

	)

63 
	#PACKAGE_STRING
 "libÆ 3.2.25"

	)

66 
	#PACKAGE_TARNAME
 "libÆ"

	)

69 
	#PACKAGE_URL
 "h‰p://www.šäad—d.Üg/~tgr/libÆ/"

	)

72 
	#PACKAGE_VERSION
 "3.2.25"

	)

75 
	#STDC_HEADERS
 1

	)

78 
	#VERSION
 "3.2.25"

	)

85 #iâdeà
__ılu¥lus


	@mylibnl/libnl-3.2.25/lib/error.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/Ãšk.h
>

15 cÚ¡ *
	g”rmsg
[
NLE_MAX
+1] = {

16 [
NLE_SUCCESS
] = "Success",

17 [
NLE_FAILURE
] = "Unspecific failure",

18 [
NLE_INTR
] = "Interrupted system call",

19 [
NLE_BAD_SOCK
] = "Bad socket",

20 [
NLE_AGAIN
] = "Try‡gain",

21 [
NLE_NOMEM
] = "Out of memory",

22 [
NLE_EXIST
] = "Objectƒxists",

23 [
NLE_INVAL
] = "Invalid input data or…arameter",

24 [
NLE_RANGE
] = "Input data out of„ange",

25 [
NLE_MSGSIZE
] = "Message size‚ot sufficient",

26 [
NLE_OPNOTSUPP
] = "Operation‚ot supported",

27 [
NLE_AF_NOSUPPORT
] = "Address family‚ot supported",

28 [
NLE_OBJ_NOTFOUND
] = "Object‚ot found",

29 [
NLE_NOATTR
] = "Attribute‚ot‡vailable",

30 [
NLE_MISSING_ATTR
] = "Missing‡ttribute",

31 [
NLE_AF_MISMATCH
] = "Address family mismatch",

32 [
NLE_SEQ_MISMATCH
] = "Message sequence‚umber mismatch",

33 [
NLE_MSG_OVERFLOW
] = "Kernel„eported message overflow",

34 [
NLE_MSG_TRUNC
] = "Kernel„eportedruncated message",

35 [
NLE_NOADDR
] = "Invalid‡ddress for specified‡ddress family",

36 [
NLE_SRCRT_NOSUPPORT
] = "Source based„outing‚ot supported",

37 [
NLE_MSG_TOOSHORT
] = "Netlink message isoo short",

38 [
NLE_MSGTYPE_NOSUPPORT
] = "Netlink messageype is‚ot supported",

39 [
NLE_OBJ_MISMATCH
] = "Objectype does‚ot match cache",

40 [
NLE_NOCACHE
] = "Unknown or invalid cacheype",

41 [
NLE_BUSY
] = "Object busy",

42 [
NLE_PROTO_MISMATCH
] = "Protocol mismatch",

43 [
NLE_NOACCESS
] = "No Access",

44 [
NLE_PERM
] = "Operation‚ot…ermitted",

45 [
NLE_PKTLOC_FILE
] = "Unableo open…acket†ocation file",

46 [
NLE_PARSE_ERR
] = "Unableo…arse object",

47 [
NLE_NODEV
] = "No such device",

48 [
NLE_IMMUTABLE
] = "Immutable‡ttribute",

49 [
NLE_DUMP_INTR
] = "Dump inconsistency detected, interrupted",

56 cÚ¡ *
	$Æ_g‘”rÜ
(
”rÜ
)

58 
”rÜ
 = 
	`abs
(error);

60 ià(
”rÜ
 > 
NLE_MAX
)

61 
”rÜ
 = 
NLE_FAILURE
;

63  
”rmsg
[
”rÜ
];

64 
	}
}

76 
	$Æ_³¼Ü
(
”rÜ
, cÚ¡ *
s
)

78 ià(
s
 && *s)

79 
	`årštf
(
¡d”r
, "%s: %s\n", 
s
, 
	`Æ_g‘”rÜ
(
”rÜ
));

81 
	`årštf
(
¡d”r
, "%s\n", 
	`Æ_g‘”rÜ
(
”rÜ
));

82 
	}
}

84 
	$Æ_sy£¼2Æ”r
(
”rÜ
)

86 
”rÜ
 = 
	`abs
(error);

88 
”rÜ
) {

89 
EBADF
:  
NLE_BAD_SOCK
;

90 
EADDRINUSE
:  
NLE_EXIST
;

91 
EEXIST
:  
NLE_EXIST
;

92 
EADDRNOTAVAIL
:  
NLE_NOADDR
;

93 
ESRCH
:

94 
ENOENT
:  
NLE_OBJ_NOTFOUND
;

95 
EINTR
:  
NLE_INTR
;

96 
EAGAIN
:  
NLE_AGAIN
;

97 
ENOTSOCK
:  
NLE_BAD_SOCK
;

98 
ENOPROTOOPT
:  
NLE_INVAL
;

99 
EFAULT
:  
NLE_INVAL
;

100 
EACCES
:  
NLE_NOACCESS
;

101 
EINVAL
:  
NLE_INVAL
;

102 
ENOBUFS
:  
NLE_NOMEM
;

103 
ENOMEM
:  
NLE_NOMEM
;

104 
EAFNOSUPPORT
:  
NLE_AF_NOSUPPORT
;

105 
EPROTONOSUPPORT
:  
NLE_PROTO_MISMATCH
;

106 
EOPNOTSUPP
:  
NLE_OPNOTSUPP
;

107 
EPERM
:  
NLE_PERM
;

108 
EBUSY
:  
NLE_BUSY
;

109 
ERANGE
:  
NLE_RANGE
;

110 
ENODEV
:  
NLE_NODEV
;

111 :  
NLE_FAILURE
;

113 
	}
}

	@mylibnl/libnl-3.2.25/lib/fib_lookup/lookup.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/©Œ.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk/objeù.h
>

24 
	~<Ãšk/rou‹/¹Æ.h
>

25 
	~<Ãšk/rou‹/rou‹.h
>

26 
	~<Ãšk/fib_lookup/»que¡.h
>

27 
	~<Ãšk/fib_lookup/lookup.h
>

30 
Æ_ÿche_İs
 
	gfib_lookup_İs
;

31 
Æ_objeù_İs
 
	g»suÉ_obj_İs
;

34 
	sfib_»suÉ_Æ
 {

35 
ušt32_t
 
	mæ_addr
;

36 
ušt32_t
 
	mæ_fwm¬k
;

37 
	mæ_tos
;

38 
	mæ_scİe
;

39 
	mtb_id_š
;

41 
	mtb_id
;

42 
	m´efixËn
;

43 
	mnh_£l
;

44 
	mty³
;

45 
	mscİe
;

46 
	m”r
;

50 
	$»suÉ_ä“_d©a
(
Æ_objeù
 *
obj
)

52 
æÆ_»suÉ
 *
»s
 = 
	`Æ_objeù_´iv
(
obj
);

54 ià(
»s
 &&„es->
ä_»q
)

55 
	`Æ_objeù_put
(
	`OBJ_CAST
(
»s
->
ä_»q
));

56 
	}
}

58 
	$»suÉ_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

60 
æÆ_»suÉ
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

61 
æÆ_»suÉ
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

63 ià(
¤c
->
ä_»q
)

64 ià(!(
d¡
->
ä_»q
 = (
æÆ_»que¡
 *)

65 
	`Æ_objeù_şÚe
(
	`OBJ_CAST
(
¤c
->
ä_»q
))))

66  -
NLE_NOMEM
;

69 
	}
}

71 
	$»suÉ_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

72 
Æmsghdr
 *
n
, 
Æ_·r£r_·¿m
 *
µ
)

74 
æÆ_»suÉ
 *
»s
;

75 
fib_»suÉ_Æ
 *
ä
;

76 
Æ_addr
 *
addr
;

77 
”r
 = -
NLE_INVAL
;

79 
»s
 = 
	`æÆ_»suÉ_®loc
();

80 ià(!
»s
)

81 
”rout
;

83 
»s
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

85 
»s
->
ä_»q
 = 
	`æÆ_»que¡_®loc
();

86 ià(!
»s
->
ä_»q
)

87 
”rout
;

89 
ä
 = 
	`Æmsg_d©a
(
n
);

90 
addr
 = 
	`Æ_addr_bud
(
AF_INET
, &
ä
->
æ_addr
, 4);

91 ià(!
addr
)

92 
”rout
;

93 
”r
 = 
	`æÆ_»que¡_£t_addr
(
»s
->
ä_»q
, 
addr
);

94 
	`Æ_addr_put
(
addr
);

95 ià(
”r
 < 0)

96 
”rout
;

98 
	`æÆ_»que¡_£t_fwm¬k
(
»s
->
ä_»q
, 
ä
->
æ_fwm¬k
);

99 
	`æÆ_»que¡_£t_tos
(
»s
->
ä_»q
, 
ä
->
æ_tos
);

100 
	`æÆ_»que¡_£t_scİe
(
»s
->
ä_»q
, 
ä
->
æ_scİe
);

101 
	`æÆ_»que¡_£t_bË
(
»s
->
ä_»q
, 
ä
->
tb_id_š
);

103 
»s
->
ä_bË_id
 = 
ä
->
tb_id
;

104 
»s
->
ä_´efixËn
 = 
ä
->
´efixËn
;

105 
»s
->
ä_nh_£l
 = 
ä
->
nh_£l
;

106 
»s
->
ä_ty³
 = 
ä
->
ty³
;

107 
»s
->
ä_scİe
 = 
ä
->
scİe
;

108 
»s
->
ä_”rÜ
 = 
ä
->
”r
;

110 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
»s
,…p);

111 ià(
”r
 < 0)

112 
”rout
;

117 
”r
 = 
NL_STOP
;

119 
”rout
:

120 
	`æÆ_»suÉ_put
(
»s
);

121  
”r
;

122 
	}
}

124 
	$»suÉ_dump_lše
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

126 
æÆ_»suÉ
 *
»s
 = (æÆ_»suÉ *è
obj
;

127 
buf
[256];

129 
	`Æ_dump_lše
(
p
, "table %s…refixlen %u‚ext-hop-selector %u\n",

130 
	`¹Æ_rou‹_bË2¡r
(
»s
->
ä_bË_id
, 
buf
, (buf)),

131 
»s
->
ä_´efixËn
,„es->
ä_nh_£l
);

132 
	`Æ_dump_lše
(
p
, "type %s ",

133 
	`Æ_¹Áy³2¡r
(
»s
->
ä_ty³
, 
buf
, (buf)));

134 
	`Æ_dump
(
p
, "scope %sƒrror %s (%d)\n",

135 
	`¹Æ_scİe2¡r
(
»s
->
ä_scİe
, 
buf
, (buf)),

136 
	`¡»¼Ü_r
(-
»s
->
ä_”rÜ
, 
buf
, (buf)),„es->fr_error);

137 
	}
}

139 
	$»suÉ_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

141 
	`»suÉ_dump_lše
(
obj
, 
p
);

142 
	}
}

144 
	$»suÉ_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

145 
ušt32_t
 
©Œs
, 
æags
)

148 
	}
}

155 
æÆ_»suÉ
 *
	$æÆ_»suÉ_®loc
()

157  (
æÆ_»suÉ
 *è
	`Æ_objeù_®loc
(&
»suÉ_obj_İs
);

158 
	}
}

160 
	$æÆ_»suÉ_put
(
æÆ_»suÉ
 *
»s
)

162 
	`Æ_objeù_put
((
Æ_objeù
 *è
»s
);

163 
	}
}

180 
Æ_ÿche
 *
	$æÆ_»suÉ_®loc_ÿche
()

182  
	`Æ_ÿche_®loc
(&
fib_lookup_İs
);

183 
	}
}

208 
	$æÆ_lookup_bud_»que¡
(
æÆ_»que¡
 *
»q
, 
æags
,

209 
Æ_msg
 **
»suÉ
)

211 
Æ_msg
 *
msg
;

212 
Æ_addr
 *
addr
;

213 
ušt64_t
 
fwm¬k
;

214 
tos
, 
scİe
, 
bË
;

215 
fib_»suÉ_Æ
 
ä
 = {0};

217 
fwm¬k
 = 
	`æÆ_»que¡_g‘_fwm¬k
(
»q
);

218 
tos
 = 
	`æÆ_»que¡_g‘_tos
(
»q
);

219 
scİe
 = 
	`æÆ_»que¡_g‘_scİe
(
»q
);

220 
bË
 = 
	`æÆ_»que¡_g‘_bË
(
»q
);

222 
ä
.
æ_fwm¬k
 = 
fwm¬k
 !ğ
UINT_LEAST64_MAX
 ? fwmark : 0;

223 
ä
.
æ_tos
 = 
tos
 >= 0 ?os : 0;

224 
ä
.
æ_scİe
 = 
scİe
 >ğ0 ? scİ: 
RT_SCOPE_UNIVERSE
;

225 
ä
.
tb_id_š
 = 
bË
 >ğ0 ?abË : 
RT_TABLE_UNSPEC
;

227 
addr
 = 
	`æÆ_»que¡_g‘_addr
(
»q
);

228 ià(!
addr
)

229  -
NLE_MISSING_ATTR
;

231 
ä
.
æ_addr
 = *(
ušt32_t
 *è
	`Æ_addr_g‘_bš¬y_addr
(
addr
);

233 
msg
 = 
	`Æmsg_®loc_sim¶e
(0, 
æags
);

234 ià(!
msg
)

235  -
NLE_NOMEM
;

237 ià(
	`Æmsg_­³nd
(
msg
, &
ä
, (ä), 
NLMSG_ALIGNTO
) < 0)

238 
”rout
;

240 *
»suÉ
 = 
msg
;

243 
”rout
:

244 
	`Æmsg_ä“
(
msg
);

245  -
NLE_MSGSIZE
;

246 
	}
}

259 
	$æÆ_lookup
(
Æ_sock
 *
sk
, 
æÆ_»que¡
 *
»q
,

260 
Æ_ÿche
 *
ÿche
)

262 
Æ_msg
 *
msg
;

263 
”r
;

265 ià((
”r
 = 
	`æÆ_lookup_bud_»que¡
(
»q
, 0, &
msg
)) < 0)

266  
”r
;

268 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

269 
	`Æmsg_ä“
(
msg
);

270 ià(
”r
 < 0)

271  
”r
;

273  
	`Æ_ÿche_pickup
(
sk
, 
ÿche
);

274 
	}
}

283 
	$æÆ_»suÉ_g‘_bË_id
(
æÆ_»suÉ
 *
»s
)

285  
»s
->
ä_bË_id
;

286 
	}
}

288 
	$æÆ_»suÉ_g‘_´efixËn
(
æÆ_»suÉ
 *
»s
)

290  
»s
->
ä_´efixËn
;

291 
	}
}

293 
	$æÆ_»suÉ_g‘_Ãxthİ_£l
(
æÆ_»suÉ
 *
»s
)

295  
»s
->
ä_nh_£l
;

296 
	}
}

298 
	$æÆ_»suÉ_g‘_ty³
(
æÆ_»suÉ
 *
»s
)

300  
»s
->
ä_ty³
;

301 
	}
}

303 
	$æÆ_»suÉ_g‘_scİe
(
æÆ_»suÉ
 *
»s
)

305  
»s
->
ä_scİe
;

306 
	}
}

308 
	$æÆ_»suÉ_g‘_”rÜ
(
æÆ_»suÉ
 *
»s
)

310  
»s
->
ä_”rÜ
;

311 
	}
}

315 
Æ_objeù_İs
 
	g»suÉ_obj_İs
 = {

316 .
oo_Çme
 = "fib_lookup/result",

317 .
	goo_size
 = (
æÆ_»suÉ
),

318 .
	goo_ä“_d©a
 = 
»suÉ_ä“_d©a
,

319 .
	goo_şÚe
 = 
»suÉ_şÚe
,

320 .
	goo_dump
 = {

321 [
NL_DUMP_LINE
] = 
»suÉ_dump_lše
,

322 [
NL_DUMP_DETAILS
] = 
»suÉ_dump_d‘as
,

324 .
	goo_com·»
 = 
»suÉ_com·»
,

327 
Æ_ÿche_İs
 
	gfib_lookup_İs
 = {

328 .
co_Çme
 = "fib_lookup/fib_lookup",

329 .
	gco_hdrsize
 = (
fib_»suÉ_Æ
),

330 .
	gco_msgty³s
 = {

331 { 0, 
NL_ACT_UNSPEC
, "any" },

332 
END_OF_MSGTYPES_LIST
,

334 .
	gco_´ÙocŞ
 = 
NETLINK_FIB_LOOKUP
,

335 .
	gco_msg_·r£r
 = 
»suÉ_msg_·r£r
,

336 .
	gco_obj_İs
 = &
»suÉ_obj_İs
,

339 
__š™
 
	$fib_lookup_š™
()

341 
	`Æ_ÿche_mngt_»gi¡”
(&
fib_lookup_İs
);

342 
	}
}

344 
__ex™
 
	$fib_lookup_ex™
()

346 
	`Æ_ÿche_mngt_uÄegi¡”
(&
fib_lookup_İs
);

347 
	}
}

	@mylibnl/libnl-3.2.25/lib/fib_lookup/request.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/©Œ.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk/objeù.h
>

24 
	~<Ãšk/fib_lookup/»que¡.h
>

26 
Æ_objeù_İs
 
	g»que¡_obj_İs
;

29 
	#REQUEST_ATTR_ADDR
 0x01

	)

30 
	#REQUEST_ATTR_FWMARK
 0x02

	)

31 
	#REQUEST_ATTR_TOS
 0x04

	)

32 
	#REQUEST_ATTR_SCOPE
 0x08

	)

33 
	#REQUEST_ATTR_TABLE
 0x10

	)

36 
	$»que¡_ä“_d©a
(
Æ_objeù
 *
obj
)

38 
æÆ_»que¡
 *
»q
 = 
	`REQUEST_CAST
(
obj
);

40 ià(
»q
)

41 
	`Æ_addr_put
(
»q
->
Ì_addr
);

42 
	}
}

44 
	$»que¡_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

46 
æÆ_»que¡
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

47 
æÆ_»que¡
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

49 ià(
¤c
->
Ì_addr
)

50 ià(!(
d¡
->
Ì_addr
 = 
	`Æ_addr_şÚe
(
¤c
->lr_addr)))

51  -
NLE_NOMEM
;

54 
	}
}

56 
	$»que¡_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

57 
ušt32_t
 
©Œs
, 
æags
)

59 
æÆ_»que¡
 *
a
 = (æÆ_»que¡ *è
_a
;

60 
æÆ_»que¡
 *
b
 = (æÆ_»que¡ *è
_b
;

61 
diff
 = 0;

63 
	#REQ_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
REQUEST_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

65 
diff
 |ğ
	`REQ_DIFF
(
FWMARK
, 
a
->
Ì_fwm¬k
 !ğ
b
->lr_fwmark);

66 
diff
 |ğ
	`REQ_DIFF
(
TOS
, 
a
->
Ì_tos
 !ğ
b
->lr_tos);

67 
diff
 |ğ
	`REQ_DIFF
(
SCOPE
, 
a
->
Ì_scİe
 !ğ
b
->lr_scope);

68 
diff
 |ğ
	`REQ_DIFF
(
TABLE
, 
a
->
Ì_bË
 !ğ
b
->lr_table);

69 
diff
 |ğ
	`REQ_DIFF
(
ADDR
, 
	`Æ_addr_cmp
(
a
->
Ì_addr
, 
b
->lr_addr));

71 #undeà
REQ_DIFF


73  
diff
;

74 
	}
}

82 
æÆ_»que¡
 *
	$æÆ_»que¡_®loc
()

84  
	`REQUEST_CAST
(
	`Æ_objeù_®loc
(&
»que¡_obj_İs
));

85 
	}
}

94 
	$æÆ_»que¡_£t_fwm¬k
(
æÆ_»que¡
 *
»q
, 
ušt64_t
 
fwm¬k
)

96 
»q
->
Ì_fwm¬k
 = 
fwm¬k
;

97 
»q
->
û_mask
 |ğ
REQUEST_ATTR_FWMARK
;

98 
	}
}

100 
ušt64_t
 
	$æÆ_»que¡_g‘_fwm¬k
(
æÆ_»que¡
 *
»q
)

102 ià(
»q
->
û_mask
 & 
REQUEST_ATTR_FWMARK
)

103  
»q
->
Ì_fwm¬k
;

105  
UINT_LEAST64_MAX
;

106 
	}
}

108 
	$æÆ_»que¡_£t_tos
(
æÆ_»que¡
 *
»q
, 
tos
)

110 
»q
->
Ì_tos
 = 
tos
;

111 
»q
->
û_mask
 |ğ
REQUEST_ATTR_TOS
;

112 
	}
}

114 
	$æÆ_»que¡_g‘_tos
(
æÆ_»que¡
 *
»q
)

116 ià(
»q
->
û_mask
 & 
REQUEST_ATTR_TOS
)

117  
»q
->
Ì_tos
;

120 
	}
}

122 
	$æÆ_»que¡_£t_scİe
(
æÆ_»que¡
 *
»q
, 
scİe
)

124 
»q
->
Ì_scİe
 = 
scİe
;

125 
»q
->
û_mask
 |ğ
REQUEST_ATTR_SCOPE
;

126 
	}
}

128 
	$æÆ_»que¡_g‘_scİe
(
æÆ_»que¡
 *
»q
)

130 ià(
»q
->
û_mask
 & 
REQUEST_ATTR_SCOPE
)

131  
»q
->
Ì_scİe
;

134 
	}
}

136 
	$æÆ_»que¡_£t_bË
(
æÆ_»que¡
 *
»q
, 
bË
)

138 
»q
->
Ì_bË
 = 
bË
;

139 
»q
->
û_mask
 |ğ
REQUEST_ATTR_TABLE
;

140 
	}
}

142 
	$æÆ_»que¡_g‘_bË
(
æÆ_»que¡
 *
»q
)

144 ià(
»q
->
û_mask
 & 
REQUEST_ATTR_TABLE
)

145  
»q
->
Ì_bË
;

148 
	}
}

150 
	$æÆ_»que¡_£t_addr
(
æÆ_»que¡
 *
»q
, 
Æ_addr
 *
addr
)

152 ià(
addr
->
a_çmy
 !ğ
AF_INET
)

153  -
NLE_AF_NOSUPPORT
;

155 ià(
»q
->
Ì_addr
)

156 
	`Æ_addr_put
(
»q
->
Ì_addr
);

158 
	`Æ_addr_g‘
(
addr
);

159 
»q
->
Ì_addr
 = 
addr
;

161 
»q
->
û_mask
 |ğ
REQUEST_ATTR_ADDR
;

164 
	}
}

166 
Æ_addr
 *
	$æÆ_»que¡_g‘_addr
(
æÆ_»que¡
 *
»q
)

168 ià(
»q
->
û_mask
 & 
REQUEST_ATTR_ADDR
)

169  
»q
->
Ì_addr
;

171  
NULL
;

172 
	}
}

176 
Æ_objeù_İs
 
	g»que¡_obj_İs
 = {

177 .
oo_Çme
 = "fib_lookup/request",

178 .
	goo_size
 = (
æÆ_»que¡
),

179 .
	goo_ä“_d©a
 = 
»que¡_ä“_d©a
,

180 .
	goo_şÚe
 = 
»que¡_şÚe
,

181 .
	goo_com·»
 = 
»que¡_com·»
,

182 .
	goo_id_©Œs
 = ~0,

	@mylibnl/libnl-3.2.25/lib/genl/ctrl.c

24 
	~<Ãšk-´iv©e/g’l.h
>

25 
	~<Ãšk/Ãšk.h
>

26 
	~<Ãšk/g’l/g’l.h
>

27 
	~<Ãšk/g’l/çmy.h
>

28 
	~<Ãšk/g’l/mngt.h
>

29 
	~<Ãšk/g’l/ù¾.h
>

30 
	~<Ãšk/uts.h
>

33 
	#CTRL_VERSION
 0x0001

	)

35 
Æ_ÿche_İs
 
	gg’l_ù¾_İs
;

37 
	$ù¾_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
h
)

39  
	`g’l_£nd_sim¶e
(
h
, 
GENL_ID_CTRL
, 
CTRL_CMD_GETFAMILY
,

40 
CTRL_VERSION
, 
NLM_F_DUMP
);

41 
	}
}

43 
Æa_pŞicy
 
	gù¾_pŞicy
[
CTRL_ATTR_MAX
+1] = {

44 [
CTRL_ATTR_FAMILY_ID
] = { .
ty³
 = 
NLA_U16
 },

45 [
CTRL_ATTR_FAMILY_NAME
] = { .
ty³
 = 
NLA_STRING
,

46 .
	gmaxËn
 = 
GENL_NAMSIZ
 },

47 [
CTRL_ATTR_VERSION
] = { .
ty³
 = 
NLA_U32
 },

48 [
CTRL_ATTR_HDRSIZE
] = { .
ty³
 = 
NLA_U32
 },

49 [
CTRL_ATTR_MAXATTR
] = { .
ty³
 = 
NLA_U32
 },

50 [
CTRL_ATTR_OPS
] = { .
ty³
 = 
NLA_NESTED
 },

51 [
CTRL_ATTR_MCAST_GROUPS
] = { .
ty³
 = 
NLA_NESTED
 },

54 
Æa_pŞicy
 
	gçmy_İ_pŞicy
[
CTRL_ATTR_OP_MAX
+1] = {

55 [
CTRL_ATTR_OP_ID
] = { .
ty³
 = 
NLA_U32
 },

56 [
CTRL_ATTR_OP_FLAGS
] = { .
ty³
 = 
NLA_U32
 },

59 
Æa_pŞicy
 
	gçmy_g½_pŞicy
[
CTRL_ATTR_MCAST_GRP_MAX
+1] = {

60 [
CTRL_ATTR_MCAST_GRP_NAME
] = { .
ty³
 = 
NLA_STRING
 },

61 [
CTRL_ATTR_MCAST_GRP_ID
] = { .
ty³
 = 
NLA_U32
 },

64 
	$·r£_mÿ¡_g½s
(
g’l_çmy
 *
çmy
, 
Æ©Œ
 *
g½_©Œ
)

66 
Æ©Œ
 *
Æa
;

67 
»maššg
, 
”r
;

69 ià(!
g½_©Œ
)

70 
	`BUG
();

72 
	`Æa_fÜ_—ch_Ã¡ed
(
Æa
, 
g½_©Œ
, 
»maššg
) {

73 
Æ©Œ
 *
tb
[
CTRL_ATTR_MCAST_GRP_MAX
+1];

74 
id
;

75 cÚ¡ * 
Çme
;

77 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTRL_ATTR_MCAST_GRP_MAX
, 
Æa
,

78 
çmy_g½_pŞicy
);

79 ià(
”r
 < 0)

80 
”rout
;

82 ià(
tb
[
CTRL_ATTR_MCAST_GRP_ID
] =ğ
NULL
) {

83 
”r
 = -
NLE_MISSING_ATTR
;

84 
”rout
;

86 
id
 = 
	`Æa_g‘_u32
(
tb
[
CTRL_ATTR_MCAST_GRP_ID
]);

88 ià(
tb
[
CTRL_ATTR_MCAST_GRP_NAME
] =ğ
NULL
) {

89 
”r
 = -
NLE_MISSING_ATTR
;

90 
”rout
;

92 
Çme
 = 
	`Æa_g‘_¡ršg
(
tb
[
CTRL_ATTR_MCAST_GRP_NAME
]);

94 
”r
 = 
	`g’l_çmy_add_g½
(
çmy
, 
id
, 
Çme
);

95 ià(
”r
 < 0)

96 
”rout
;

99 
”r
 = 0;

101 
”rout
:

102  
”r
;

103 
	}
}

105 
	$ù¾_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
g’l_cmd
 *
cmd
,

106 
g’l_šfo
 *
šfo
, *
¬g
)

108 
g’l_çmy
 *
çmy
;

109 
Æ_·r£r_·¿m
 *
µ
 = 
¬g
;

110 
”r
;

112 
çmy
 = 
	`g’l_çmy_®loc
();

113 ià(
çmy
 =ğ
NULL
) {

114 
”r
 = -
NLE_NOMEM
;

115 
”rout
;

118 ià(
šfo
->
©Œs
[
CTRL_ATTR_FAMILY_NAME
] =ğ
NULL
) {

119 
”r
 = -
NLE_MISSING_ATTR
;

120 
”rout
;

123 ià(
šfo
->
©Œs
[
CTRL_ATTR_FAMILY_ID
] =ğ
NULL
) {

124 
”r
 = -
NLE_MISSING_ATTR
;

125 
”rout
;

128 
çmy
->
û_msgty³
 = 
šfo
->
Æh
->
Æmsg_ty³
;

129 
	`g’l_çmy_£t_id
(
çmy
,

130 
	`Æa_g‘_u16
(
šfo
->
©Œs
[
CTRL_ATTR_FAMILY_ID
]));

131 
	`g’l_çmy_£t_Çme
(
çmy
,

132 
	`Æa_g‘_¡ršg
(
šfo
->
©Œs
[
CTRL_ATTR_FAMILY_NAME
]));

134 ià(
šfo
->
©Œs
[
CTRL_ATTR_VERSION
]) {

135 
ušt32_t
 
v”siÚ
 = 
	`Æa_g‘_u32
(
šfo
->
©Œs
[
CTRL_ATTR_VERSION
]);

136 
	`g’l_çmy_£t_v”siÚ
(
çmy
, 
v”siÚ
);

139 ià(
šfo
->
©Œs
[
CTRL_ATTR_HDRSIZE
]) {

140 
ušt32_t
 
hdrsize
 = 
	`Æa_g‘_u32
(
šfo
->
©Œs
[
CTRL_ATTR_HDRSIZE
]);

141 
	`g’l_çmy_£t_hdrsize
(
çmy
, 
hdrsize
);

144 ià(
šfo
->
©Œs
[
CTRL_ATTR_MAXATTR
]) {

145 
ušt32_t
 
max©Œ
 = 
	`Æa_g‘_u32
(
šfo
->
©Œs
[
CTRL_ATTR_MAXATTR
]);

146 
	`g’l_çmy_£t_max©Œ
(
çmy
, 
max©Œ
);

149 ià(
šfo
->
©Œs
[
CTRL_ATTR_OPS
]) {

150 
Æ©Œ
 *
Æa
, *
Æa_İs
;

151 
»maššg
;

153 
Æa_İs
 = 
šfo
->
©Œs
[
CTRL_ATTR_OPS
];

154 
	`Æa_fÜ_—ch_Ã¡ed
(
Æa
, 
Æa_İs
, 
»maššg
) {

155 
Æ©Œ
 *
tb
[
CTRL_ATTR_OP_MAX
+1];

156 
æags
 = 0, 
id
;

158 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTRL_ATTR_OP_MAX
, 
Æa
,

159 
çmy_İ_pŞicy
);

160 ià(
”r
 < 0)

161 
”rout
;

163 ià(
tb
[
CTRL_ATTR_OP_ID
] =ğ
NULL
) {

164 
”r
 = -
NLE_MISSING_ATTR
;

165 
”rout
;

168 
id
 = 
	`Æa_g‘_u32
(
tb
[
CTRL_ATTR_OP_ID
]);

170 ià(
tb
[
CTRL_ATTR_OP_FLAGS
])

171 
æags
 = 
	`Æa_g‘_u32
(
tb
[
CTRL_ATTR_OP_FLAGS
]);

173 
”r
 = 
	`g’l_çmy_add_İ
(
çmy
, 
id
, 
æags
);

174 ià(
”r
 < 0)

175 
”rout
;

180 ià(
šfo
->
©Œs
[
CTRL_ATTR_MCAST_GROUPS
]) {

181 
”r
 = 
	`·r£_mÿ¡_g½s
(
çmy
, 
šfo
->
©Œs
[
CTRL_ATTR_MCAST_GROUPS
]);

182 ià(
”r
 < 0)

183 
”rout
;

186 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
çmy
,…p);

187 
”rout
:

188 
	`g’l_çmy_put
(
çmy
);

189  
”r
;

190 
	}
}

203 
	$´obe_»¥Ú£
(
Æ_msg
 *
msg
, *
¬g
)

205 
Æ©Œ
 *
tb
[
CTRL_ATTR_MAX
+1];

206 
Æmsghdr
 *
Æh
 = 
	`Æmsg_hdr
(
msg
);

207 
g’l_çmy
 *
»t
 = (g’l_çmy *)
¬g
;

209 ià(
	`g’lmsg_·r£
(
Æh
, 0, 
tb
, 
CTRL_ATTR_MAX
, 
ù¾_pŞicy
))

210  
NL_SKIP
;

212 ià(
tb
[
CTRL_ATTR_FAMILY_ID
])

213 
	`g’l_çmy_£t_id
(
»t
, 
	`Æa_g‘_u16
(
tb
[
CTRL_ATTR_FAMILY_ID
]));

215 ià(
tb
[
CTRL_ATTR_MCAST_GROUPS
])

216 ià(
	`·r£_mÿ¡_g½s
(
»t
, 
tb
[
CTRL_ATTR_MCAST_GROUPS
]) < 0)

217  
NL_SKIP
;

219  
NL_STOP
;

220 
	}
}

237 
g’l_çmy
 *
	$g’l_ù¾_´obe_by_Çme
(
Æ_sock
 *
sk
,

238 cÚ¡ *
Çme
)

240 
Æ_msg
 *
msg
;

241 
g’l_çmy
 *
»t
;

242 
Æ_cb
 *
cb
, *
Üig
;

243 
rc
;

245 
»t
 = 
	`g’l_çmy_®loc
();

246 ià(!
»t
)

247 
out
;

249 
	`g’l_çmy_£t_Çme
(
»t
, 
Çme
);

251 
msg
 = 
	`Æmsg_®loc
();

252 ià(!
msg
)

253 
out_çm_ä“
;

255 ià(!(
Üig
 = 
	`Æ_sock‘_g‘_cb
(
sk
)))

256 
out_msg_ä“
;

258 
cb
 = 
	`Æ_cb_şÚe
(
Üig
);

259 
	`Æ_cb_put
(
Üig
);

260 ià(!
cb
)

261 
out_msg_ä“
;

263 ià(!
	`g’lmsg_put
(
msg
, 
NL_AUTO_PORT
, 
NL_AUTO_SEQ
, 
GENL_ID_CTRL
,

264 0, 0, 
CTRL_CMD_GETFAMILY
, 1)) {

265 
	`BUG
();

266 
out_cb_ä“
;

269 ià(
	`Æa_put_¡ršg
(
msg
, 
CTRL_ATTR_FAMILY_NAME
, 
Çme
) < 0)

270 
out_cb_ä“
;

272 
rc
 = 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
´obe_»¥Ú£
,

273 (*è
»t
);

274 ià(
rc
 < 0)

275 
out_cb_ä“
;

277 
rc
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

278 ià(
rc
 < 0)

279 
out_cb_ä“
;

281 
rc
 = 
	`Æ_»cvmsgs
(
sk
, 
cb
);

282 ià(
rc
 < 0)

283 
out_cb_ä“
;

286 
rc
 = 
	`wa™_fÜ_ack
(
sk
);

287 ià(
rc
 < 0)

288 
out_cb_ä“
;

290 ià(
	`g’l_çmy_g‘_id
(
»t
) != 0) {

291 
	`Æmsg_ä“
(
msg
);

292 
	`Æ_cb_put
(
cb
);

293  
»t
;

296 
out_cb_ä“
:

297 
	`Æ_cb_put
(
cb
);

298 
out_msg_ä“
:

299 
	`Æmsg_ä“
(
msg
);

300 
out_çm_ä“
:

301 
	`g’l_çmy_put
(
»t
);

302 
»t
 = 
NULL
;

303 
out
:

304  
»t
;

305 
	}
}

333 
	$g’l_ù¾_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

335  
	`Æ_ÿche_®loc_ªd_fl
(&
g’l_ù¾_İs
, 
sk
, 
»suÉ
);

336 
	}
}

354 
g’l_çmy
 *
	$g’l_ù¾_£¬ch
(
Æ_ÿche
 *
ÿche
, 
id
)

356 
g’l_çmy
 *
çm
;

358 ià(
ÿche
->
c_İs
 !ğ&
g’l_ù¾_İs
)

359 
	`BUG
();

361 
	`Æ_li¡_fÜ_—ch_’Œy
(
çm
, &
ÿche
->
c_™ems
, 
û_li¡
) {

362 ià(
çm
->
gf_id
 =ğ
id
) {

363 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
çm
);

364  
çm
;

368  
NULL
;

369 
	}
}

387 
g’l_çmy
 *
	$g’l_ù¾_£¬ch_by_Çme
(
Æ_ÿche
 *
ÿche
,

388 cÚ¡ *
Çme
)

390 
g’l_çmy
 *
çm
;

392 ià(
ÿche
->
c_İs
 !ğ&
g’l_ù¾_İs
)

393 
	`BUG
();

395 
	`Æ_li¡_fÜ_—ch_’Œy
(
çm
, &
ÿche
->
c_™ems
, 
û_li¡
) {

396 ià(!
	`¡rcmp
(
Çme
, 
çm
->
gf_Çme
)) {

397 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
çm
);

398  
çm
;

402  
NULL
;

403 
	}
}

429 
	$g’l_ù¾_»sŞve
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

431 
g’l_çmy
 *
çmy
;

432 
”r
;

434 
çmy
 = 
	`g’l_ù¾_´obe_by_Çme
(
sk
, 
Çme
);

435 ià(
çmy
 =ğ
NULL
) {

436 
”r
 = -
NLE_OBJ_NOTFOUND
;

437 
”rout
;

440 
”r
 = 
	`g’l_çmy_g‘_id
(
çmy
);

441 
	`g’l_çmy_put
(
çmy
);

442 
”rout
:

443  
”r
;

444 
	}
}

446 
	$g’l_ù¾_g½_by_Çme
(cÚ¡ 
g’l_çmy
 *
çmy
,

447 cÚ¡ *
g½_Çme
)

449 
g’l_çmy_g½
 *
g½
;

451 
	`Æ_li¡_fÜ_—ch_’Œy
(
g½
, &
çmy
->
gf_mc_g½s
, 
li¡
) {

452 ià(!
	`¡rcmp
(
g½
->
Çme
, 
g½_Çme
)) {

453  
g½
->
id
;

457  -
NLE_OBJ_NOTFOUND
;

458 
	}
}

471 
	$g’l_ù¾_»sŞve_g½
(
Æ_sock
 *
sk
, cÚ¡ *
çmy_Çme
,

472 cÚ¡ *
g½_Çme
)

475 
g’l_çmy
 *
çmy
;

476 
”r
;

478 
çmy
 = 
	`g’l_ù¾_´obe_by_Çme
(
sk
, 
çmy_Çme
);

479 ià(
çmy
 =ğ
NULL
) {

480 
”r
 = -
NLE_OBJ_NOTFOUND
;

481 
”rout
;

484 
”r
 = 
	`g’l_ù¾_g½_by_Çme
(
çmy
, 
g½_Çme
);

485 
	`g’l_çmy_put
(
çmy
);

486 
”rout
:

487  
”r
;

488 
	}
}

493 
g’l_cmd
 
	gg’l_cmds
[] = {

495 .
c_id
 = 
CTRL_CMD_NEWFAMILY
,

496 .
	gc_Çme
 = "NEWFAMILY" ,

497 .
	gc_max©Œ
 = 
CTRL_ATTR_MAX
,

498 .
	gc_©Œ_pŞicy
 = 
ù¾_pŞicy
,

499 .
	gc_msg_·r£r
 = 
ù¾_msg_·r£r
,

502 .
	gc_id
 = 
CTRL_CMD_DELFAMILY
,

503 .
	gc_Çme
 = "DELFAMILY" ,

506 .
	gc_id
 = 
CTRL_CMD_GETFAMILY
,

507 .
	gc_Çme
 = "GETFAMILY" ,

510 .
	gc_id
 = 
CTRL_CMD_NEWOPS
,

511 .
	gc_Çme
 = "NEWOPS" ,

514 .
	gc_id
 = 
CTRL_CMD_DELOPS
,

515 .
	gc_Çme
 = "DELOPS" ,

519 
g’l_İs
 
	gg’l_İs
 = {

520 .
o_cmds
 = 
g’l_cmds
,

521 .
	go_ncmds
 = 
ARRAY_SIZE
(
g’l_cmds
),

524 
Æ_objeù_İs
 
g’l_çmy_İs
;

526 
Æ_ÿche_İs
 
	gg’l_ù¾_İs
 = {

527 .
co_Çme
 = "genl/family",

528 .
	gco_hdrsize
 = 
GENL_HDRSIZE
(0),

529 .
	gco_msgty³s
 = 
GENL_FAMILY
(
GENL_ID_CTRL
, "nlctrl"),

530 .
	gco_g’l
 = &
g’l_İs
,

531 .
	gco_´ÙocŞ
 = 
NETLINK_GENERIC
,

532 .
	gco_»que¡_upd©e
 = 
ù¾_»que¡_upd©e
,

533 .
	gco_obj_İs
 = &
g’l_çmy_İs
,

536 
__š™
 
	$ù¾_š™
()

538 
	`g’l_»gi¡”
(&
g’l_ù¾_İs
);

539 
	}
}

541 
__ex™
 
	$ù¾_ex™
()

543 
	`g’l_uÄegi¡”
(&
g’l_ù¾_İs
);

544 
	}
}

	@mylibnl/libnl-3.2.25/lib/genl/family.c

21 
	~<Ãšk-´iv©e/g’l.h
>

22 
	~<Ãšk/Ãšk.h
>

23 
	~<Ãšk/g’l/g’l.h
>

24 
	~<Ãšk/g’l/çmy.h
>

25 
	~<Ãšk/uts.h
>

28 
	#FAMILY_ATTR_ID
 0x01

	)

29 
	#FAMILY_ATTR_NAME
 0x02

	)

30 
	#FAMILY_ATTR_VERSION
 0x04

	)

31 
	#FAMILY_ATTR_HDRSIZE
 0x08

	)

32 
	#FAMILY_ATTR_MAXATTR
 0x10

	)

33 
	#FAMILY_ATTR_OPS
 0x20

	)

35 
Æ_objeù_İs
 
	gg’l_çmy_İs
;

37 
	$çmy_cÚ¡ruùÜ
(
Æ_objeù
 *
c
)

39 
g’l_çmy
 *
çmy
 = (g’l_çmy *è
c
;

41 
	`Æ_š™_li¡_h—d
(&
çmy
->
gf_İs
);

42 
	`Æ_š™_li¡_h—d
(&
çmy
->
gf_mc_g½s
);

43 
	}
}

45 
	$çmy_ä“_d©a
(
Æ_objeù
 *
c
)

47 
g’l_çmy
 *
çmy
 = (g’l_çmy *è
c
;

48 
g’l_çmy_İ
 *
İs
, *
tmp
;

49 
g’l_çmy_g½
 *
g½
, *
t_g½
;

51 ià(
çmy
 =ğ
NULL
)

54 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
İs
, 
tmp
, &
çmy
->
gf_İs
, 
o_li¡
) {

55 
	`Æ_li¡_d–
(&
İs
->
o_li¡
);

56 
	`ä“
(
İs
);

59 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
g½
, 
t_g½
, &
çmy
->
gf_mc_g½s
, 
li¡
) {

60 
	`Æ_li¡_d–
(&
g½
->
li¡
);

61 
	`ä“
(
g½
);

64 
	}
}

66 
	$çmy_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

68 
g’l_çmy
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

69 
g’l_çmy
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

70 
g’l_çmy_İ
 *
İs
;

71 
g’l_çmy_g½
 *
g½
;

72 
”r
;

74 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
¤c
->
gf_İs
, 
o_li¡
) {

75 
”r
 = 
	`g’l_çmy_add_İ
(
d¡
, 
İs
->
o_id
, ops->
o_æags
);

76 ià(
”r
 < 0)

77  
”r
;

80 
	`Æ_li¡_fÜ_—ch_’Œy
(
g½
, &
¤c
->
gf_mc_g½s
, 
li¡
) {

81 
”r
 = 
	`g’l_çmy_add_g½
(
d¡
, 
g½
->
id
, g½->
Çme
);

82 ià(
”r
 < 0)

83  
”r
;

88 
	}
}

90 
	$çmy_dump_lše
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

92 
g’l_çmy
 *
çmy
 = (g’l_çmy *è
obj
;

94 
	`Æ_dump
(
p
, "0x%04x %s version %u\n",

95 
çmy
->
gf_id
, famy->
gf_Çme
, famy->
gf_v”siÚ
);

96 
	}
}

98 cÚ¡ 
Œªs_tbl
 
	gİs_æags
[] = {

99 
__ADD
(
GENL_ADMIN_PERM
, 
admš_³rm
)

100 
__ADD
(
GENL_CMD_CAP_DO
, 
has_do™
)

101 
__ADD
(
GENL_CMD_CAP_DUMP
, 
has_dump
)

102 
__ADD
(
GENL_CMD_CAP_HASPOL
, 
has_pŞicy
)

105 *
	$İs_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

107  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
İs_æags
, 
	`ARRAY_SIZE
(ops_flags));

108 
	}
}

110 
	$çmy_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

112 
g’l_çmy_g½
 *
g½
;

113 
g’l_çmy
 *
çmy
 = (g’l_çmy *è
obj
;

115 
	`çmy_dump_lše
(
obj
, 
p
);

116 
	`Æ_dump_lše
(
p
, " hdrsize %u maxattr %u\n",

117 
çmy
->
gf_hdrsize
, famy->
gf_max©Œ
);

119 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_OPS
) {

120 
g’l_çmy_İ
 *
İ
;

121 
buf
[64];

123 
	`Æ_li¡_fÜ_—ch_’Œy
(
İ
, &
çmy
->
gf_İs
, 
o_li¡
) {

124 
	`İs_æags2¡r
(
İ
->
o_æags
, 
buf
, (buf));

126 
	`g’l_İ2Çme
(
çmy
->
gf_id
, 
İ
->
o_id
, 
buf
, (buf));

128 
	`Æ_dump_lše
(
p
, " o°% (0x%02x)", 
buf
, 
İ
->
o_id
);

130 ià(
İ
->
o_æags
)

131 
	`Æ_dump
(
p
, " <%s>",

132 
	`İs_æags2¡r
(
İ
->
o_æags
, 
buf
,

133 (
buf
)));

135 
	`Æ_dump
(
p
, "\n");

139 
	`Æ_li¡_fÜ_—ch_’Œy
(
g½
, &
çmy
->
gf_mc_g½s
, 
li¡
) {

140 
	`Æ_dump_lše
(
p
, " g½ % (0x%02x)\n", 
g½
->
Çme
, g½->
id
);

143 
	}
}

145 
	$çmy_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

147 
	`çmy_dump_d‘as
(
obj
, 
p
);

148 
	}
}

150 
	$çmy_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

151 
ušt32_t
 
©Œs
, 
æags
)

153 
g’l_çmy
 *
a
 = (g’l_çmy *è
_a
;

154 
g’l_çmy
 *
b
 = (g’l_çmy *è
_b
;

155 
diff
 = 0;

157 
	#FAM_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
FAMILY_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

159 
diff
 |ğ
	`FAM_DIFF
(
ID
, 
a
->
gf_id
 !ğ
b
->gf_id);

160 
diff
 |ğ
	`FAM_DIFF
(
VERSION
, 
a
->
gf_v”siÚ
 !ğ
b
->gf_version);

161 
diff
 |ğ
	`FAM_DIFF
(
HDRSIZE
, 
a
->
gf_hdrsize
 !ğ
b
->gf_hdrsize);

162 
diff
 |ğ
	`FAM_DIFF
(
MAXATTR
, 
a
->
gf_max©Œ
 !ğ
b
->gf_maxattr);

163 
diff
 |ğ
	`FAM_DIFF
(
NAME
, 
	`¡rcmp
(
a
->
gf_Çme
, 
b
->gf_name));

165 #undeà
FAM_DIFF


167  
diff
;

168 
	}
}

181 
g’l_çmy
 *
	$g’l_çmy_®loc
()

183  (
g’l_çmy
 *è
	`Æ_objeù_®loc
(&
g’l_çmy_İs
);

184 
	}
}

195 
	$g’l_çmy_put
(
g’l_çmy
 *
çmy
)

197 
	`Æ_objeù_put
((
Æ_objeù
 *è
çmy
);

198 
	}
}

213 
	$g’l_çmy_g‘_id
(
g’l_çmy
 *
çmy
)

215 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_ID
)

216  
çmy
->
gf_id
;

218  
GENL_ID_GENERATE
;

219 
	}
}

226 
	$g’l_çmy_£t_id
(
g’l_çmy
 *
çmy
, 
id
)

228 
çmy
->
gf_id
 = 
id
;

229 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_ID
;

230 
	}
}

245 *
	$g’l_çmy_g‘_Çme
(
g’l_çmy
 *
çmy
)

247 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_NAME
)

248  
çmy
->
gf_Çme
;

250  
NULL
;

251 
	}
}

258 
	$g’l_çmy_£t_Çme
(
g’l_çmy
 *
çmy
, cÚ¡ *
Çme
)

260 
	`¡ºıy
(
çmy
->
gf_Çme
, 
Çme
, 
GENL_NAMSIZ
-1);

261 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_NAME
;

262 
	}
}

275 
ušt8_t
 
	$g’l_çmy_g‘_v”siÚ
(
g’l_çmy
 *
çmy
)

277 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_VERSION
)

278  
çmy
->
gf_v”siÚ
;

281 
	}
}

288 
	$g’l_çmy_£t_v”siÚ
(
g’l_çmy
 *
çmy
, 
ušt8_t
 
v”siÚ
)

290 
çmy
->
gf_v”siÚ
 = 
v”siÚ
;

291 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_VERSION
;

292 
	}
}

307 
ušt32_t
 
	$g’l_çmy_g‘_hdrsize
(
g’l_çmy
 *
çmy
)

309 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_HDRSIZE
)

310  
çmy
->
gf_hdrsize
;

313 
	}
}

315 
	$g’l_çmy_£t_hdrsize
(
g’l_çmy
 *
çmy
, 
ušt32_t
 
hdrsize
)

317 
çmy
->
gf_hdrsize
 = 
hdrsize
;

318 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_HDRSIZE
;

319 
	}
}

328 
ušt32_t
 
	$g’l_çmy_g‘_max©Œ
(
g’l_çmy
 *
çmy
)

330 ià(
çmy
->
û_mask
 & 
FAMILY_ATTR_MAXATTR
)

331  
çmy
->
gf_max©Œ
;

333  
çmy
->
gf_max©Œ
;

334 
	}
}

336 
	$g’l_çmy_£t_max©Œ
(
g’l_çmy
 *
çmy
, 
ušt32_t
 
max©Œ
)

338 
çmy
->
gf_max©Œ
 = 
max©Œ
;

339 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_MAXATTR
;

340 
	}
}

349 
	$g’l_çmy_add_İ
(
g’l_çmy
 *
çmy
, 
id
, 
æags
)

351 
g’l_çmy_İ
 *
İ
;

353 
İ
 = 
	`ÿÎoc
(1, (*op));

354 ià(
İ
 =ğ
NULL
)

355  -
NLE_NOMEM
;

357 
İ
->
o_id
 = 
id
;

358 
İ
->
o_æags
 = 
æags
;

360 
	`Æ_li¡_add_
(&
İ
->
o_li¡
, &
çmy
->
gf_İs
);

361 
çmy
->
û_mask
 |ğ
FAMILY_ATTR_OPS
;

364 
	}
}

366 
	$g’l_çmy_add_g½
(
g’l_çmy
 *
çmy
, 
ušt32_t
 
id
,

367 cÚ¡ *
Çme
)

369 
g’l_çmy_g½
 *
g½
;

371 
g½
 = 
	`ÿÎoc
(1, (*grp));

372 ià(
g½
 =ğ
NULL
)

373  -
NLE_NOMEM
;

375 
g½
->
id
 = id;

376 
	`¡ºıy
(
g½
->
Çme
,‚ame, 
GENL_NAMSIZ
 - 1);

378 
	`Æ_li¡_add_
(&
g½
->
li¡
, &
çmy
->
gf_mc_g½s
);

381 
	}
}

386 
Æ_objeù_İs
 
	gg’l_çmy_İs
 = {

387 .
oo_Çme
 = "genl/family",

388 .
	goo_size
 = (
g’l_çmy
),

389 .
	goo_cÚ¡ruùÜ
 = 
çmy_cÚ¡ruùÜ
,

390 .
	goo_ä“_d©a
 = 
çmy_ä“_d©a
,

391 .
	goo_şÚe
 = 
çmy_şÚe
,

392 .
	goo_dump
 = {

393 [
NL_DUMP_LINE
] = 
çmy_dump_lše
,

394 [
NL_DUMP_DETAILS
] = 
çmy_dump_d‘as
,

395 [
NL_DUMP_STATS
] = 
çmy_dump_¡©s
,

397 .
	goo_com·»
 = 
çmy_com·»
,

398 .
	goo_id_©Œs
 = 
FAMILY_ATTR_ID
,

	@mylibnl/libnl-3.2.25/lib/genl/genl.c

18 
	~<Ãšk-´iv©e/g’l.h
>

19 
	~<Ãšk/Ãšk.h
>

20 
	~<Ãšk/g’l/g’l.h
>

21 
	~<Ãšk/uts.h
>

45 
	$g’l_cÚÃù
(
Æ_sock
 *
sk
)

47  
	`Æ_cÚÃù
(
sk
, 
NETLINK_GENERIC
);

48 
	}
}

84 
	$g’l_£nd_sim¶e
(
Æ_sock
 *
sk
, 
çmy
, 
cmd
,

85 
v”siÚ
, 
æags
)

87 
g’lmsghdr
 
hdr
 = {

88 .
cmd
 = cmd,

89 .
v”siÚ
 = version,

92  
	`Æ_£nd_sim¶e
(
sk
, 
çmy
, 
æags
, &
hdr
, (hdr));

93 
	}
}

117 
	$g’lmsg_v®id_hdr
(
Æmsghdr
 *
Æh
, 
hd¾’
)

119 
g’lmsghdr
 *
ghdr
;

121 ià(!
	`Æmsg_v®id_hdr
(
Æh
, 
GENL_HDRLEN
))

124 
ghdr
 = 
	`Æmsg_d©a
(
Æh
);

125 ià(
	`g’lmsg_Ën
(
ghdr
è< 
	`NLMSG_ALIGN
(
hd¾’
))

129 
	}
}

151 
	$g’lmsg_v®id©e
(
Æmsghdr
 *
Æh
, 
hd¾’
, 
maxty³
,

152 
Æa_pŞicy
 *
pŞicy
)

154 
g’lmsghdr
 *
ghdr
;

156 ià(!
	`g’lmsg_v®id_hdr
(
Æh
, 
hd¾’
))

157  -
NLE_MSG_TOOSHORT
;

159 
ghdr
 = 
	`Æmsg_d©a
(
Æh
);

160  
	`Æa_v®id©e
(
	`g’lmsg_©Œd©a
(
ghdr
, 
hd¾’
),

161 
	`g’lmsg_©ŒËn
(
ghdr
, 
hd¾’
), 
maxty³
, 
pŞicy
);

162 
	}
}

191 
	$g’lmsg_·r£
(
Æmsghdr
 *
Æh
, 
hd¾’
, 
Æ©Œ
 *
tb
[],

192 
maxty³
, 
Æa_pŞicy
 *
pŞicy
)

194 
g’lmsghdr
 *
ghdr
;

196 ià(!
	`g’lmsg_v®id_hdr
(
Æh
, 
hd¾’
))

197  -
NLE_MSG_TOOSHORT
;

199 
ghdr
 = 
	`Æmsg_d©a
(
Æh
);

200  
	`Æa_·r£
(
tb
, 
maxty³
, 
	`g’lmsg_©Œd©a
(
ghdr
, 
hd¾’
),

201 
	`g’lmsg_©ŒËn
(
ghdr
, 
hd¾’
), 
pŞicy
);

202 
	}
}

210 
g’lmsghdr
 *
	$g’lmsg_hdr
(
Æmsghdr
 *
Æh
)

212  
	`Æmsg_d©a
(
Æh
);

213 
	}
}

224 
	$g’lmsg_Ën
(cÚ¡ 
g’lmsghdr
 *
gÆh
)

226 cÚ¡ 
Æmsghdr
 *
Æh
;

228 
Æh
 = (cÚ¡ 
Æmsghdr
 *)((cÚ¡ *è
gÆh
 - 
NLMSG_HDRLEN
);

229  (
Æh
->
Æmsg_Ën
 - 
GENL_HDRLEN
 - 
NLMSG_HDRLEN
);

230 
	}
}

242 *
	$g’lmsg_u£r_hdr
(cÚ¡ 
g’lmsghdr
 *
gÆh
)

244  
	`g’lmsg_d©a
(
gÆh
);

245 
	}
}

259 *
	$g’lmsg_u£r_d©a
(cÚ¡ 
g’lmsghdr
 *
gÆh
, cÚ¡ 
hd¾’
)

261  
	`g’lmsg_u£r_hdr
(
gÆh
è+ 
	`NLMSG_ALIGN
(
hd¾’
);

262 
	}
}

273 
	$g’lmsg_u£r_d©®’
(cÚ¡ 
g’lmsghdr
 *
gÆh
, cÚ¡ 
hd¾’
)

275  
	`g’lmsg_Ën
(
gÆh
è- 
	`NLMSG_ALIGN
(
hd¾’
);

276 
	}
}

287 
Æ©Œ
 *
	$g’lmsg_©Œd©a
(cÚ¡ 
g’lmsghdr
 *
gÆh
, 
hd¾’
)

289  
	`g’lmsg_u£r_d©a
(
gÆh
, 
hd¾’
);

290 
	}
}

302 
	$g’lmsg_©ŒËn
(cÚ¡ 
g’lmsghdr
 *
gÆh
, 
hd¾’
)

304  
	`g’lmsg_Ën
(
gÆh
è- 
	`NLMSG_ALIGN
(
hd¾’
);

305 
	}
}

348 *
	$g’lmsg_put
(
Æ_msg
 *
msg
, 
ušt32_t
 
pÜt
, ušt32_ˆ
£q
, 
çmy
,

349 
hd¾’
, 
æags
, 
ušt8_t
 
cmd
, ušt8_ˆ
v”siÚ
)

351 
Æmsghdr
 *
Æh
;

352 
g’lmsghdr
 
hdr
 = {

353 .
cmd
 = cmd,

354 .
v”siÚ
 = version,

357 
Æh
 = 
	`Æmsg_put
(
msg
, 
pÜt
, 
£q
, 
çmy
, 
GENL_HDRLEN
 + 
hd¾’
, 
æags
);

358 ià(
Æh
 =ğ
NULL
)

359  
NULL
;

361 
	`memıy
(
	`Æmsg_d©a
(
Æh
), &
hdr
, (hdr));

362 
	`NL_DBG
(2, "msg %p: Added generic‚etlink header cmd=%d version=%d\n",

363 
msg
, 
cmd
, 
v”siÚ
);

365  
	`Æmsg_d©a
(
Æh
è+ 
GENL_HDRLEN
;

366 
	}
}

385 *
	$g’lmsg_d©a
(cÚ¡ 
g’lmsghdr
 *
gÆh
)

387  ((*è
gÆh
 + 
GENL_HDRLEN
);

388 
	}
}

	@mylibnl/libnl-3.2.25/lib/genl/mngt.c

21 
	~<Ãšk-´iv©e/g’l.h
>

22 
	~<Ãšk/Ãšk.h
>

23 
	~<Ãšk/g’l/g’l.h
>

24 
	~<Ãšk/g’l/mngt.h
>

25 
	~<Ãšk/g’l/çmy.h
>

26 
	~<Ãšk/g’l/ù¾.h
>

27 
	~<Ãšk/uts.h
>

31 
NL_LIST_HEAD
(
g’l_İs_li¡
);

33 
g’l_cmd
 *
	$lookup_cmd
(
g’l_İs
 *
İs
, 
cmd_id
)

35 
g’l_cmd
 *
cmd
;

36 
i
;

38 
i
 = 0; i < 
İs
->
o_ncmds
; i++) {

39 
cmd
 = &
İs
->
o_cmds
[
i
];

40 ià(
cmd
->
c_id
 =ğ
cmd_id
)

41  
cmd
;

44  
NULL
;

45 
	}
}

47 
	$cmd_msg_·r£r
(
sockaddr_Æ
 *
who
, 
Æmsghdr
 *
Æh
,

48 
g’l_İs
 *
İs
, 
Æ_ÿche_İs
 *
ÿche_İs
, *
¬g
)

50 
”r
;

51 
g’lmsghdr
 *
ghdr
;

52 
g’l_cmd
 *
cmd
;

54 
ghdr
 = 
	`g’lmsg_hdr
(
Æh
);

56 ià(!(
cmd
 = 
	`lookup_cmd
(
İs
, 
ghdr
->cmd))) {

57 
”r
 = -
NLE_MSGTYPE_NOSUPPORT
;

58 
”rout
;

61 ià(
cmd
->
c_msg_·r£r
 =ğ
NULL
)

62 
”r
 = -
NLE_OPNOTSUPP
;

64 
Æ©Œ
 *
tb
[
cmd
->
c_max©Œ
 + 1];

65 
g’l_šfo
 
šfo
 = {

66 .
who
 = who,

67 .
Æh
 =‚lh,

68 .
g’lhdr
 = 
ghdr
,

69 .
u£rhdr
 = 
	`g’lmsg_u£r_hdr
(
ghdr
),

70 .
©Œs
 = 
tb
,

73 
”r
 = 
	`Æmsg_·r£
(
Æh
, 
	`GENL_HDRSIZE
(
İs
->
o_hdrsize
), 
tb
, 
cmd
->
c_max©Œ
,

74 
cmd
->
c_©Œ_pŞicy
);

75 ià(
”r
 < 0)

76 
”rout
;

78 
”r
 = 
cmd
->
	`c_msg_·r£r
(
ÿche_İs
, cmd, &
šfo
, 
¬g
);

80 
”rout
:

81  
”r
;

83 
	}
}

85 
	$g’l_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

86 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

88 ià(
İs
->
co_g’l
 =ğ
NULL
)

89 
	`BUG
();

91  
	`cmd_msg_·r£r
(
who
, 
Æh
, 
İs
->
co_g’l
, ops, 
µ
);

92 
	}
}

94 
g’l_İs
 *
	$lookup_çmy
(
çmy
)

96 
g’l_İs
 *
İs
;

98 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
g’l_İs_li¡
, 
o_li¡
) {

99 ià(
İs
->
o_id
 =ğ
çmy
)

100  
İs
;

103  
NULL
;

104 
	}
}

106 
g’l_İs
 *
	$lookup_çmy_by_Çme
(cÚ¡ *
Çme
)

108 
g’l_İs
 *
İs
;

110 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
g’l_İs_li¡
, 
o_li¡
) {

111 ià(!
	`¡rcmp
(
İs
->
o_Çme
, 
Çme
))

112  
İs
;

115  
NULL
;

116 
	}
}

118 *
	$g’l_İ2Çme
(
çmy
, 
İ
, *
buf
, 
size_t
 
Ën
)

120 
g’l_İs
 *
İs
;

121 
i
;

123 ià((
İs
 = 
	`lookup_çmy
(
çmy
))) {

124 
i
 = 0; i < 
İs
->
o_ncmds
; i++) {

125 
g’l_cmd
 *
cmd
;

126 
cmd
 = &
İs
->
o_cmds
[
i
];

128 ià(
cmd
->
c_id
 =ğ
İ
) {

129 
	`¡ºıy
(
buf
, 
cmd
->
c_Çme
, 
Ën
 - 1);

130  
buf
;

135 
	`¡ºıy
(
buf
, "unknown", 
Ën
 - 1);

136  
NULL
;

137 
	}
}

164 
	$g’l_»gi¡”_çmy
(
g’l_İs
 *
İs
)

166 ià(!
İs
->
o_Çme
)

167  -
NLE_INVAL
;

169 ià(
İs
->
o_cmds
 && ops->
o_ncmds
 <= 0)

170  -
NLE_INVAL
;

172 ià(
İs
->
o_id
 && 
	`lookup_çmy
(ops->o_id))

173  -
NLE_EXIST
;

175 ià(
	`lookup_çmy_by_Çme
(
İs
->
o_Çme
))

176  -
NLE_EXIST
;

178 
	`Æ_li¡_add_
(&
İs
->
o_li¡
, &
g’l_İs_li¡
);

181 
	}
}

194 
	$g’l_uÄegi¡”_çmy
(
g’l_İs
 *
İs
)

196 
	`Æ_li¡_d–
(&
İs
->
o_li¡
);

199 
	}
}

208 
	$g’l_hªdË_msg
(
Æ_msg
 *
msg
, *
¬g
)

210 
Æmsghdr
 *
Æh
 = 
	`Æmsg_hdr
(
msg
);

211 
g’l_İs
 *
İs
;

213 ià(!
	`g’lmsg_v®id_hdr
(
Æh
, 0))

214  -
NLE_INVAL
;

216 ià(!(
İs
 = 
	`lookup_çmy
(
Æh
->
Æmsg_ty³
)))

217  -
NLE_MSGTYPE_NOSUPPORT
;

219  
	`cmd_msg_·r£r
(
	`Æmsg_g‘_¤c
(
msg
), 
Æh
, 
İs
, 
NULL
, 
¬g
);

220 
	}
}

241 
	$g’l_»gi¡”
(
Æ_ÿche_İs
 *
İs
)

243 
”r
;

245 ià(
İs
->
co_´ÙocŞ
 !ğ
NETLINK_GENERIC
) {

246 
”r
 = -
NLE_PROTO_MISMATCH
;

247 
”rout
;

250 ià(
İs
->
co_hdrsize
 < 
	`GENL_HDRSIZE
(0)) {

251 
”r
 = -
NLE_INVAL
;

252 
”rout
;

255 ià(
İs
->
co_g’l
 =ğ
NULL
) {

256 
”r
 = -
NLE_INVAL
;

257 
”rout
;

260 
İs
->
co_g’l
->
o_ÿche_İs
 = ops;

261 
İs
->
co_g’l
->
o_hdrsize
 = ops->
co_hdrsize
 - 
GENL_HDRLEN
;

262 
İs
->
co_g’l
->
o_Çme
 = ops->
co_msgty³s
[0].
mt_Çme
;

263 
İs
->
co_g’l
->
o_id
 = ops->
co_msgty³s
[0].
mt_id
;

264 
İs
->
co_msg_·r£r
 = 
g’l_msg_·r£r
;

266 ià((
”r
 = 
	`g’l_»gi¡”_çmy
(
İs
->
co_g’l
)) < 0)

267 
”rout
;

269 
”r
 = 
	`Æ_ÿche_mngt_»gi¡”
(
İs
);

270 
”rout
:

271  
”r
;

272 
	}
}

278 
	$g’l_uÄegi¡”
(
Æ_ÿche_İs
 *
İs
)

280 ià(!
İs
)

283 
	`Æ_ÿche_mngt_uÄegi¡”
(
İs
);

285 
	`g’l_uÄegi¡”_çmy
(
İs
->
co_g’l
);

286 
	}
}

291 
	$__g’l_İs_»sŞve
(
Æ_ÿche
 *
ù¾
, 
g’l_İs
 *
İs
)

293 
g’l_çmy
 *
çmy
;

295 
çmy
 = 
	`g’l_ù¾_£¬ch_by_Çme
(
ù¾
, 
İs
->
o_Çme
);

296 ià(
çmy
 !ğ
NULL
) {

297 
İs
->
o_id
 = 
	`g’l_çmy_g‘_id
(
çmy
);

299 ià(
İs
->
o_ÿche_İs
)

300 
İs
->
o_ÿche_İs
->
co_msgty³s
[0].
mt_id
 = ops->
o_id
;

302 
	`g’l_çmy_put
(
çmy
);

307  -
NLE_OBJ_NOTFOUND
;

308 
	}
}

310 
	$g’l_»sŞve_id
(
g’l_İs
 *
İs
)

312 
Æ_sock
 *
sk
;

313 
”r
 = 0;

316 ià(
İs
->
o_id
 !ğ
GENL_ID_GENERATE
)

319 ià(!
İs
->
o_Çme
)

320  -
NLE_INVAL
;

322 ià(!(
sk
 = 
	`Æ_sock‘_®loc
()))

323  -
NLE_NOMEM
;

325 ià((
”r
 = 
	`g’l_cÚÃù
(
sk
)) < 0)

326 
”rout_ä“
;

328 
”r
 = 
	`g’l_İs_»sŞve
(
sk
, 
İs
);

330 
”rout_ä“
:

331 
	`Æ_sock‘_ä“
(
sk
);

333  
”r
;

334 
	}
}

351 
	$g’l_İs_»sŞve
(
Æ_sock
 *
sk
, 
g’l_İs
 *
İs
)

353 
Æ_ÿche
 *
ù¾
;

354 
”r
;

356 ià((
”r
 = 
	`g’l_ù¾_®loc_ÿche
(
sk
, &
ù¾
)) < 0)

357 
”rout
;

359 
”r
 = 
	`__g’l_İs_»sŞve
(
ù¾
, 
İs
);

361 
	`Æ_ÿche_ä“
(
ù¾
);

362 
”rout
:

363  
”r
;

364 
	}
}

379 
	$g’l_mngt_»sŞve
(
Æ_sock
 *
sk
)

381 
Æ_ÿche
 *
ù¾
;

382 
g’l_İs
 *
İs
;

383 
”r
 = 0;

385 ià((
”r
 = 
	`g’l_ù¾_®loc_ÿche
(
sk
, &
ù¾
)) < 0)

386 
”rout
;

388 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
g’l_İs_li¡
, 
o_li¡
) {

389 
”r
 = 
	`__g’l_İs_»sŞve
(
ù¾
, 
İs
);

392 
	`Æ_ÿche_ä“
(
ù¾
);

393 
”rout
:

394  
”r
;

395 
	}
}

	@mylibnl/libnl-3.2.25/lib/handlers.c

28 
	~<Ãšk-´iv©e/Ãšk.h
>

29 
	~<Ãšk/Ãšk.h
>

30 
	~<Ãšk/uts.h
>

31 
	~<Ãšk/msg.h
>

32 
	~<Ãšk/hªdËrs.h
>

34 
	$´št_h—d”_cÚ‹Á
(
FILE
 *
ofd
, 
Æmsghdr
 *
n
)

36 
æags
[128];

37 
ty³
[32];

39 
	`årštf
(
ofd
, "type=%s†ength=%u flags=<%s> sequence-nr=%u…id=%u",

40 
	`Æ_Æmsgty³2¡r
(
n
->
Æmsg_ty³
, 
ty³
, (type)),

41 
n
->
Æmsg_Ën
, 
	`Æ_Æmsg_æags2¡r
Ò->
Æmsg_æags
, 
æags
,

42 (
æags
)), 
n
->
Æmsg_£q
,‚->
Æmsg_pid
);

43 
	}
}

45 
	$Æ_v®id_hªdËr_v”bo£
(
Æ_msg
 *
msg
, *
¬g
)

47 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡dout
;

49 
	`årštf
(
ofd
, "-- Warning: unhandled valid message: ");

50 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

51 
	`årštf
(
ofd
, "\n");

53  
NL_OK
;

54 
	}
}

56 
	$Æ_šv®id_hªdËr_v”bo£
(
Æ_msg
 *
msg
, *
¬g
)

58 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

60 
	`årštf
(
ofd
, "-- Error: Invalid message: ");

61 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

62 
	`årštf
(
ofd
, "\n");

64  
NL_STOP
;

65 
	}
}

67 
	$Æ_ov”run_hªdËr_v”bo£
(
Æ_msg
 *
msg
, *
¬g
)

69 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

71 
	`årštf
(
ofd
, "-- Error: Netlink Overrun: ");

72 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

73 
	`årštf
(
ofd
, "\n");

75  
NL_STOP
;

76 
	}
}

78 
	$Æ_”rÜ_hªdËr_v”bo£
(
sockaddr_Æ
 *
who
,

79 
Æmsg”r
 *
e
, *
¬g
)

81 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

82 
buf
[256];

84 
	`årštf
(
ofd
, "-- Error„eceived: %s\n-- Original message: ",

85 
	`¡»¼Ü_r
(-
e
->
”rÜ
, 
buf
, (buf)));

86 
	`´št_h—d”_cÚ‹Á
(
ofd
, &
e
->
msg
);

87 
	`årštf
(
ofd
, "\n");

89  -
	`Æ_sy£¼2Æ”r
(
e
->
”rÜ
);

90 
	}
}

92 
	$Æ_v®id_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

94 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

96 
	`årštf
(
ofd
, "-- Debug: Unhandled Valid message: ");

97 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

98 
	`årštf
(
ofd
, "\n");

100  
NL_OK
;

101 
	}
}

103 
	$Æ_fšish_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

105 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

107 
	`årštf
(
ofd
, "-- Debug: End of multipart message block: ");

108 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

109 
	`årštf
(
ofd
, "\n");

111  
NL_STOP
;

112 
	}
}

114 
	$Æ_msg_š_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

116 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

118 
	`årštf
(
ofd
, "-- Debug: Received Message:\n");

119 
	`Æ_msg_dump
(
msg
, 
ofd
);

121  
NL_OK
;

122 
	}
}

124 
	$Æ_msg_out_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

126 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

128 
	`årštf
(
ofd
, "-- Debug: Sent Message:\n");

129 
	`Æ_msg_dump
(
msg
, 
ofd
);

131  
NL_OK
;

132 
	}
}

134 
	$Æ_sk³d_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

136 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

138 
	`årštf
(
ofd
, "-- Debug: Skipped message: ");

139 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

140 
	`årštf
(
ofd
, "\n");

142  
NL_SKIP
;

143 
	}
}

145 
	$Æ_ack_hªdËr_debug
(
Æ_msg
 *
msg
, *
¬g
)

147 
FILE
 *
ofd
 = 
¬g
 ?‡rg : 
¡d”r
;

149 
	`årštf
(
ofd
, "-- Debug: ACK: ");

150 
	`´št_h—d”_cÚ‹Á
(
ofd
, 
	`Æmsg_hdr
(
msg
));

151 
	`årštf
(
ofd
, "\n");

153  
NL_STOP
;

154 
	}
}

156 
Æ_»cvmsg_msg_cb_t
 
	gcb_def
[
NL_CB_TYPE_MAX
+1][
NL_CB_KIND_MAX
+1] = {

157 [
NL_CB_VALID
] = {

158 [
NL_CB_VERBOSE
] = 
Æ_v®id_hªdËr_v”bo£
,

159 [
NL_CB_DEBUG
] = 
Æ_v®id_hªdËr_debug
,

161 [
NL_CB_FINISH
] = {

162 [
NL_CB_DEBUG
] = 
Æ_fšish_hªdËr_debug
,

164 [
NL_CB_INVALID
] = {

165 [
NL_CB_VERBOSE
] = 
Æ_šv®id_hªdËr_v”bo£
,

166 [
NL_CB_DEBUG
] = 
Æ_šv®id_hªdËr_v”bo£
,

168 [
NL_CB_MSG_IN
] = {

169 [
NL_CB_DEBUG
] = 
Æ_msg_š_hªdËr_debug
,

171 [
NL_CB_MSG_OUT
] = {

172 [
NL_CB_DEBUG
] = 
Æ_msg_out_hªdËr_debug
,

174 [
NL_CB_OVERRUN
] = {

175 [
NL_CB_VERBOSE
] = 
Æ_ov”run_hªdËr_v”bo£
,

176 [
NL_CB_DEBUG
] = 
Æ_ov”run_hªdËr_v”bo£
,

178 [
NL_CB_SKIPPED
] = {

179 [
NL_CB_DEBUG
] = 
Æ_sk³d_hªdËr_debug
,

181 [
NL_CB_ACK
] = {

182 [
NL_CB_DEBUG
] = 
Æ_ack_hªdËr_debug
,

186 
Æ_»cvmsg_”r_cb_t
 
	gcb_”r_def
[
NL_CB_KIND_MAX
+1] = {

187 [
NL_CB_VERBOSE
] = 
Æ_”rÜ_hªdËr_v”bo£
,

188 [
NL_CB_DEBUG
] = 
Æ_”rÜ_hªdËr_v”bo£
,

201 
Æ_cb
 *
	$Æ_cb_®loc
(
Æ_cb_kšd
 
kšd
)

203 
i
;

204 
Æ_cb
 *
cb
;

206 ià(
kšd
 < 0 || kšd > 
NL_CB_KIND_MAX
)

207  
NULL
;

209 
cb
 = 
	`ÿÎoc
(1, (*cb));

210 ià(!
cb
)

211  
NULL
;

213 
cb
->
cb_»fút
 = 1;

214 
cb
->
cb_aùive
 = 
NL_CB_TYPE_MAX
 + 1;

216 
i
 = 0; i <ğ
NL_CB_TYPE_MAX
; i++)

217 
	`Æ_cb_£t
(
cb
, 
i
, 
kšd
, 
NULL
, NULL);

219 
	`Æ_cb_”r
(
cb
, 
kšd
, 
NULL
, NULL);

221  
cb
;

222 
	}
}

230 
Æ_cb
 *
	$Æ_cb_şÚe
(
Æ_cb
 *
Üig
)

232 
Æ_cb
 *
cb
;

234 
cb
 = 
	`Æ_cb_®loc
(
NL_CB_DEFAULT
);

235 ià(!
cb
)

236  
NULL
;

238 
	`memıy
(
cb
, 
Üig
, (*orig));

239 
cb
->
cb_»fút
 = 1;

241  
cb
;

242 
	}
}

244 
Æ_cb
 *
	$Æ_cb_g‘
(
Æ_cb
 *
cb
)

246 
cb
->
cb_»fút
++;

248  
cb
;

249 
	}
}

251 
	$Æ_cb_put
(
Æ_cb
 *
cb
)

253 ià(!
cb
)

256 
cb
->
cb_»fút
--;

258 ià(
cb
->
cb_»fút
 < 0)

259 
	`BUG
();

261 ià(
cb
->
cb_»fút
 <= 0)

262 
	`ä“
(
cb
);

263 
	}
}

271 
Æ_cb_ty³
 
	$Æ_cb_aùive_ty³
(
Æ_cb
 *
cb
)

273  
cb
->
cb_aùive
;

274 
	}
}

293 
	$Æ_cb_£t
(
Æ_cb
 *
cb
, 
Æ_cb_ty³
 
ty³
, 
Æ_cb_kšd
 
kšd
,

294 
Æ_»cvmsg_msg_cb_t
 
func
, *
¬g
)

296 ià(
ty³
 < 0 ||y³ > 
NL_CB_TYPE_MAX
)

297  -
NLE_RANGE
;

299 ià(
kšd
 < 0 || kšd > 
NL_CB_KIND_MAX
)

300  -
NLE_RANGE
;

302 ià(
kšd
 =ğ
NL_CB_CUSTOM
) {

303 
cb
->
cb_£t
[
ty³
] = 
func
;

304 
cb
->
cb_¬gs
[
ty³
] = 
¬g
;

306 
cb
->
cb_£t
[
ty³
] = 
cb_def
[ty³][
kšd
];

307 
cb
->
cb_¬gs
[
ty³
] = 
¬g
;

311 
	}
}

322 
	$Æ_cb_£t_®l
(
Æ_cb
 *
cb
, 
Æ_cb_kšd
 
kšd
,

323 
Æ_»cvmsg_msg_cb_t
 
func
, *
¬g
)

325 
i
, 
”r
;

327 
i
 = 0; i <ğ
NL_CB_TYPE_MAX
; i++) {

328 
”r
 = 
	`Æ_cb_£t
(
cb
, 
i
, 
kšd
, 
func
, 
¬g
);

329 ià(
”r
 < 0)

330  
”r
;

334 
	}
}

343 
	$Æ_cb_”r
(
Æ_cb
 *
cb
, 
Æ_cb_kšd
 
kšd
,

344 
Æ_»cvmsg_”r_cb_t
 
func
, *
¬g
)

346 ià(
kšd
 < 0 || kšd > 
NL_CB_KIND_MAX
)

347  -
NLE_RANGE
;

349 ià(
kšd
 =ğ
NL_CB_CUSTOM
) {

350 
cb
->
cb_”r
 = 
func
;

351 
cb
->
cb_”r_¬g
 = 
¬g
;

353 
cb
->
cb_”r
 = 
cb_”r_def
[
kšd
];

354 
cb
->
cb_”r_¬g
 = 
¬g
;

358 
	}
}

372 
Æ_cb_ov”wr™e_»cvmsgs
(
Æ_cb
 *
cb
,

373 (*
func
)(
Æ_sock
 *, 
Æ_cb
 *))

375 
cb
->
cb_»cvmsgs_ow
 = 
func
;

376 
	}
}

383 
Æ_cb_ov”wr™e_»cv
(
Æ_cb
 *
cb
,

384 (*
func
)(
Æ_sock
 *, 
sockaddr_Æ
 *,

385 **, 
uüed
 **))

387 
cb
->
cb_»cv_ow
 = 
func
;

388 
	}
}

395 
Æ_cb_ov”wr™e_£nd
(
Æ_cb
 *
cb
,

396 (*
func
)(
Æ_sock
 *, 
Æ_msg
 *))

398 
cb
->
cb_£nd_ow
 = 
func
;

399 
	}
}

	@mylibnl/libnl-3.2.25/lib/hash.c

41 
	~<Ãšk/hash.h
>

43 #ià
HAVE_LITTLE_ENDIAN


44 
	#HASH_LITTLE_ENDIAN
 1

	)

45 
	#HASH_BIG_ENDIAN
 0

	)

46 #–ià
HAVE_BIG_ENDIAN


47 
	#HASH_LITTLE_ENDIAN
 0

	)

48 
	#HASH_BIG_ENDIAN
 1

	)

50 #”rÜ 
Unknown
 
’dŸn


53 
	#hashsize
(
n
è((
ušt32_t
)1<<Ò))

	)

54 
	#hashmask
(
n
è(
	`hashsize
Ò)-1)

	)

55 
	#rÙ
(
x
,
k
è(((x)<<(k)è| ((x)>>(32-(k))))

	)

101 
	#mix
(
a
,
b
,
c
) \

103 
a
 -ğ
c
;‡ ^ğ
	`rÙ
(c, 4); c +ğ
b
; \

104 
b
 -ğ
a
; b ^ğ
	`rÙ
×, 6);‡ +ğ
c
; \

105 
c
 -ğ
b
; c ^ğ
	`rÙ
(b, 8); b +ğ
a
; \

106 
a
 -ğ
c
;‡ ^ğ
	`rÙ
(c,16); c +ğ
b
; \

107 
b
 -ğ
a
; b ^ğ
	`rÙ
×,19);‡ +ğ
c
; \

108 
c
 -ğ
b
; c ^ğ
	`rÙ
(b, 4); b +ğ
a
; \

109 }

	)

136 
	#fš®
(
a
,
b
,
c
) \

138 
c
 ^ğ
b
; c -ğ
	`rÙ
(b,14); \

139 
a
 ^ğ
c
;‡ -ğ
	`rÙ
(c,11); \

140 
b
 ^ğ
a
; b -ğ
	`rÙ
(a,25); \

141 
c
 ^ğ
b
; c -ğ
	`rÙ
(b,16); \

142 
a
 ^ğ
c
;‡ -ğ
	`rÙ
(c,4); \

143 
b
 ^ğ
a
; b -ğ
	`rÙ
(a,14); \

144 
c
 ^ğ
b
; c -ğ
	`rÙ
(b,24); \

145 }

	)

175 
ušt32_t
 
	$hashl™e
ĞcÚ¡ *
key
, 
size_t
 
Ëngth
, 
ušt32_t
 *
v®2
 )

177 
ušt32_t
 
a
,
b
,
c
;

178 uniÚ { cÚ¡ *
±r
; 
size_t
 
i
; } 
u
;

181 
a
 = 
b
 = 
c
 = 0xd—db“à+ ((
ušt32_t
)
Ëngth
è+ *
v®2
;

183 
u
.
±r
 = 
key
;

184 ià(
HASH_LITTLE_ENDIAN
 && ((
u
.
i
 & 0x3) == 0)) {

185 cÚ¡ 
ušt32_t
 *
k
 = (cÚ¡ ušt32_ˆ*)
key
;

186 cÚ¡ 
ušt8_t
 *
k8
;

189 
Ëngth
 > 12)

191 
a
 +ğ
k
[0];

192 
b
 +ğ
k
[1];

193 
c
 +ğ
k
[2];

194 
	`mix
(
a
,
b
,
c
);

195 
Ëngth
 -= 12;

196 
k
 += 3;

212 
Ëngth
)

214 12: 
c
+=
k
[2]; 
b
+=k[1]; 
a
+=k[0]; ;

215 11: 
c
+=
k
[2]&0xffffff; 
b
+=k[1]; 
a
+=k[0]; ;

216 10: 
c
+=
k
[2]&0xffff; 
b
+=k[1]; 
a
+=k[0]; ;

217 9 : 
c
+=
k
[2]&0xff; 
b
+=k[1]; 
a
+=k[0]; ;

218 8 : 
b
+=
k
[1]; 
a
+=k[0]; ;

219 7 : 
b
+=
k
[1]&0xffffff; 
a
+=k[0]; ;

220 6 : 
b
+=
k
[1]&0xffff; 
a
+=k[0]; ;

221 5 : 
b
+=
k
[1]&0xff; 
a
+=k[0]; ;

222 4 : 
a
+=
k
[0]; ;

223 3 : 
a
+=
k
[0]&0xffffff; ;

224 2 : 
a
+=
k
[0]&0xffff; ;

225 1 : 
a
+=
k
[0]&0xff; ;

226 0 :  
c
;

231 
k8
 = (cÚ¡ 
ušt8_t
 *)
k
;

232 
Ëngth
)

234 12: 
c
+=
k
[2]; 
b
+=k[1]; 
a
+=k[0]; ;

235 11: 
c
+=((
ušt32_t
)
k8
[10])<<16;

236 10: 
c
+=((
ušt32_t
)
k8
[9])<<8;

237 9 : 
c
+=
k8
[8];

238 8 : 
b
+=
k
[1]; 
a
+=k[0]; ;

239 7 : 
b
+=((
ušt32_t
)
k8
[6])<<16;

240 6 : 
b
+=((
ušt32_t
)
k8
[5])<<8;

241 5 : 
b
+=
k8
[4];

242 4 : 
a
+=
k
[0]; ;

243 3 : 
a
+=((
ušt32_t
)
k8
[2])<<16;

244 2 : 
a
+=((
ušt32_t
)
k8
[1])<<8;

245 1 : 
a
+=
k8
[0]; ;

246 0 :  
c
;

251 } ià(
HASH_LITTLE_ENDIAN
 && ((
u
.
i
 & 0x1) == 0)) {

252 cÚ¡ 
ušt16_t
 *
k
 = (cÚ¡ ušt16_ˆ*)
key
;

253 cÚ¡ 
ušt8_t
 *
k8
;

256 
Ëngth
 > 12)

258 
a
 +ğ
k
[0] + (((
ušt32_t
)k[1])<<16);

259 
b
 +ğ
k
[2] + (((
ušt32_t
)k[3])<<16);

260 
c
 +ğ
k
[4] + (((
ušt32_t
)k[5])<<16);

261 
	`mix
(
a
,
b
,
c
);

262 
Ëngth
 -= 12;

263 
k
 += 6;

267 
k8
 = (cÚ¡ 
ušt8_t
 *)
k
;

268 
Ëngth
)

270 12: 
c
+=
k
[4]+(((
ušt32_t
)k[5])<<16);

271 
b
+=
k
[2]+(((
ušt32_t
)k[3])<<16);

272 
a
+=
k
[0]+(((
ušt32_t
)k[1])<<16);

274 11: 
c
+=((
ušt32_t
)
k8
[10])<<16;

275 10: 
c
+=
k
[4];

276 
b
+=
k
[2]+(((
ušt32_t
)k[3])<<16);

277 
a
+=
k
[0]+(((
ušt32_t
)k[1])<<16);

279 9 : 
c
+=
k8
[8];

280 8 : 
b
+=
k
[2]+(((
ušt32_t
)k[3])<<16);

281 
a
+=
k
[0]+(((
ušt32_t
)k[1])<<16);

283 7 : 
b
+=((
ušt32_t
)
k8
[6])<<16;

284 6 : 
b
+=
k
[2];

285 
a
+=
k
[0]+(((
ušt32_t
)k[1])<<16);

287 5 : 
b
+=
k8
[4];

288 4 : 
a
+=
k
[0]+(((
ušt32_t
)k[1])<<16);

290 3 : 
a
+=((
ušt32_t
)
k8
[2])<<16;

291 2 : 
a
+=
k
[0];

293 1 : 
a
+=
k8
[0];

295 0 :  
c
;

299 cÚ¡ 
ušt8_t
 *
k
 = (cÚ¡ ušt8_ˆ*)
key
;

302 
Ëngth
 > 12)

304 
a
 +ğ
k
[0];

305 
a
 +ğ((
ušt32_t
)
k
[1])<<8;

306 
a
 +ğ((
ušt32_t
)
k
[2])<<16;

307 
a
 +ğ((
ušt32_t
)
k
[3])<<24;

308 
b
 +ğ
k
[4];

309 
b
 +ğ((
ušt32_t
)
k
[5])<<8;

310 
b
 +ğ((
ušt32_t
)
k
[6])<<16;

311 
b
 +ğ((
ušt32_t
)
k
[7])<<24;

312 
c
 +ğ
k
[8];

313 
c
 +ğ((
ušt32_t
)
k
[9])<<8;

314 
c
 +ğ((
ušt32_t
)
k
[10])<<16;

315 
c
 +ğ((
ušt32_t
)
k
[11])<<24;

316 
	`mix
(
a
,
b
,
c
);

317 
Ëngth
 -= 12;

318 
k
 += 12;

322 
Ëngth
)

324 12: 
c
+=((
ušt32_t
)
k
[11])<<24;

325 11: 
c
+=((
ušt32_t
)
k
[10])<<16;

326 10: 
c
+=((
ušt32_t
)
k
[9])<<8;

327 9 : 
c
+=
k
[8];

328 8 : 
b
+=((
ušt32_t
)
k
[7])<<24;

329 7 : 
b
+=((
ušt32_t
)
k
[6])<<16;

330 6 : 
b
+=((
ušt32_t
)
k
[5])<<8;

331 5 : 
b
+=
k
[4];

332 4 : 
a
+=((
ušt32_t
)
k
[3])<<24;

333 3 : 
a
+=((
ušt32_t
)
k
[2])<<16;

334 2 : 
a
+=((
ušt32_t
)
k
[1])<<8;

335 1 : 
a
+=
k
[0];

337 0 :  
c
;

341 
	`fš®
(
a
,
b
,
c
);

342 *
v®2
 = 
b
;

343  
c
;

344 
	}
}

352 
ušt32_t
 
	$hashbig
ĞcÚ¡ *
key
, 
size_t
 
Ëngth
, 
ušt32_t
 *
v®2
)

354 
ušt32_t
 
a
,
b
,
c
;

355 uniÚ { cÚ¡ *
±r
; 
size_t
 
i
; } 
u
;

358 
a
 = 
b
 = 
c
 = 0xd—db“à+ ((
ušt32_t
)
Ëngth
è+ *
v®2
;

360 
u
.
±r
 = 
key
;

361 ià(
HASH_BIG_ENDIAN
 && ((
u
.
i
 & 0x3) == 0)) {

362 cÚ¡ 
ušt32_t
 *
k
 = (cÚ¡ ušt32_ˆ*)
key
;

363 cÚ¡ 
ušt8_t
 *
k8
;

366 
Ëngth
 > 12)

368 
a
 +ğ
k
[0];

369 
b
 +ğ
k
[1];

370 
c
 +ğ
k
[2];

371 
	`mix
(
a
,
b
,
c
);

372 
Ëngth
 -= 12;

373 
k
 += 3;

389 
Ëngth
)

391 12: 
c
+=
k
[2]; 
b
+=k[1]; 
a
+=k[0]; ;

392 11: 
c
+=
k
[2]&0xffffff00; 
b
+=k[1]; 
a
+=k[0]; ;

393 10: 
c
+=
k
[2]&0xffff0000; 
b
+=k[1]; 
a
+=k[0]; ;

394 9 : 
c
+=
k
[2]&0xff000000; 
b
+=k[1]; 
a
+=k[0]; ;

395 8 : 
b
+=
k
[1]; 
a
+=k[0]; ;

396 7 : 
b
+=
k
[1]&0xffffff00; 
a
+=k[0]; ;

397 6 : 
b
+=
k
[1]&0xffff0000; 
a
+=k[0]; ;

398 5 : 
b
+=
k
[1]&0xff000000; 
a
+=k[0]; ;

399 4 : 
a
+=
k
[0]; ;

400 3 : 
a
+=
k
[0]&0xffffff00; ;

401 2 : 
a
+=
k
[0]&0xffff0000; ;

402 1 : 
a
+=
k
[0]&0xff000000; ;

403 0 :  
c
;

408 
k8
 = (cÚ¡ 
ušt8_t
 *)
k
;

409 
Ëngth
)

411 12: 
c
+=
k
[2]; 
b
+=k[1]; 
a
+=k[0]; ;

412 11: 
c
+=((
ušt32_t
)
k8
[10])<<8;

413 10: 
c
+=((
ušt32_t
)
k8
[9])<<16;

414 9 : 
c
+=((
ušt32_t
)
k8
[8])<<24;

415 8 : 
b
+=
k
[1]; 
a
+=k[0]; ;

416 7 : 
b
+=((
ušt32_t
)
k8
[6])<<8;

417 6 : 
b
+=((
ušt32_t
)
k8
[5])<<16;

418 5 : 
b
+=((
ušt32_t
)
k8
[4])<<24;

419 4 : 
a
+=
k
[0]; ;

420 3 : 
a
+=((
ušt32_t
)
k8
[2])<<8;

421 2 : 
a
+=((
ušt32_t
)
k8
[1])<<16;

422 1 : 
a
+=((
ušt32_t
)
k8
[0])<<24; ;

423 0 :  
c
;

429 cÚ¡ 
ušt8_t
 *
k
 = (cÚ¡ ušt8_ˆ*)
key
;

432 
Ëngth
 > 12)

434 
a
 +ğ((
ušt32_t
)
k
[0])<<24;

435 
a
 +ğ((
ušt32_t
)
k
[1])<<16;

436 
a
 +ğ((
ušt32_t
)
k
[2])<<8;

437 
a
 +ğ((
ušt32_t
)
k
[3]);

438 
b
 +ğ((
ušt32_t
)
k
[4])<<24;

439 
b
 +ğ((
ušt32_t
)
k
[5])<<16;

440 
b
 +ğ((
ušt32_t
)
k
[6])<<8;

441 
b
 +ğ((
ušt32_t
)
k
[7]);

442 
c
 +ğ((
ušt32_t
)
k
[8])<<24;

443 
c
 +ğ((
ušt32_t
)
k
[9])<<16;

444 
c
 +ğ((
ušt32_t
)
k
[10])<<8;

445 
c
 +ğ((
ušt32_t
)
k
[11]);

446 
	`mix
(
a
,
b
,
c
);

447 
Ëngth
 -= 12;

448 
k
 += 12;

452 
Ëngth
)

454 12: 
c
+=
k
[11];

455 11: 
c
+=((
ušt32_t
)
k
[10])<<8;

456 10: 
c
+=((
ušt32_t
)
k
[9])<<16;

457 9 : 
c
+=((
ušt32_t
)
k
[8])<<24;

458 8 : 
b
+=
k
[7];

459 7 : 
b
+=((
ušt32_t
)
k
[6])<<8;

460 6 : 
b
+=((
ušt32_t
)
k
[5])<<16;

461 5 : 
b
+=((
ušt32_t
)
k
[4])<<24;

462 4 : 
a
+=
k
[3];

463 3 : 
a
+=((
ušt32_t
)
k
[2])<<8;

464 2 : 
a
+=((
ušt32_t
)
k
[1])<<16;

465 1 : 
a
+=((
ušt32_t
)
k
[0])<<24;

467 0 :  
c
;

471 
	`fš®
(
a
,
b
,
c
);

472 *
v®2
 = 
b
;

473  
c
;

474 
	}
}

476 
ušt32_t
 
	$Æ_hash_ªy
(cÚ¡ *
key
, 
size_t
 
Ëngth
, 
ušt32_t
 
ba£
)

478 ià(
HASH_BIG_ENDIAN
)

479  
	`hashbig
(
key
, 
Ëngth
, &
ba£
);

481  
	`hashl™e
(
key
, 
Ëngth
, &
ba£
);

482 
	}
}

	@mylibnl/libnl-3.2.25/lib/hashtable.c

11 
	~<¡ršg.h
>

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/objeù.h
>

14 
	~<Ãšk/hash.h
>

15 
	~<Ãšk/hashbË.h
>

29 
Æ_hash_bË_t
 *
	$Æ_hash_bË_®loc
(
size
)

31 
Æ_hash_bË_t
 *
ht
;

33 
ht
 = 
	`ÿÎoc
(1,  (*ht));

34 ià(!
ht
)

35 
”rout
;

37 
ht
->
nodes
 = 
	`ÿÎoc
(
size
,  (*ht->nodes));

38 ià(!
ht
->
nodes
) {

39 
	`ä“
(
ht
);

40 
”rout
;

43 
ht
->
size
 = size;

45  
ht
;

46 
”rout
:

47  
NULL
;

48 
	}
}

56 
	$Æ_hash_bË_ä“
(
Æ_hash_bË_t
 *
ht
)

58 
i
;

60 
i
 = 0; i < 
ht
->
size
; i++) {

61 
Æ_hash_node_t
 *
node
 = 
ht
->
nodes
[
i
];

62 
Æ_hash_node_t
 *
§ved_node
;

64 
node
) {

65 
§ved_node
 = 
node
;

66 
node
 =‚ode->
Ãxt
;

67 
	`Æ_objeù_put
(
§ved_node
->
obj
);

68 
	`ä“
(
§ved_node
);

72 
	`ä“
(
ht
->
nodes
);

73 
	`ä“
(
ht
);

74 
	}
}

86 
Æ_objeù
* 
	$Æ_hash_bË_lookup
(
Æ_hash_bË_t
 *
ht
,

87 
Æ_objeù
 *
obj
)

89 
Æ_hash_node_t
 *
node
;

90 
ušt32_t
 
key_hash
;

92 
	`Æ_objeù_keyg’
(
obj
, &
key_hash
, 
ht
->
size
);

93 
node
 = 
ht
->
nodes
[
key_hash
];

95 
node
) {

96 ià(
	`Æ_objeù_id’tiÿl
(
node
->
obj
, obj))

97  
node
->
obj
;

98 
node
 =‚ode->
Ãxt
;

101  
NULL
;

102 
	}
}

117 
	$Æ_hash_bË_add
(
Æ_hash_bË_t
 *
ht
, 
Æ_objeù
 *
obj
)

119 
Æ_hash_node_t
 *
node
;

120 
ušt32_t
 
key_hash
;

122 
	`Æ_objeù_keyg’
(
obj
, &
key_hash
, 
ht
->
size
);

123 
node
 = 
ht
->
nodes
[
key_hash
];

125 
node
) {

126 ià(
	`Æ_objeù_id’tiÿl
(
node
->
obj
, obj)) {

127 
	`NL_DBG
(2, "Warning: Addo hashtable found duplicate...\n");

128  -
NLE_EXIST
;

130 
node
 =‚ode->
Ãxt
;

133 
	`NL_DBG
 (5, "adding cacheƒntry of obj %p inable %p, with hash 0x%x\n",

134 
obj
, 
ht
, 
key_hash
);

136 
node
 = 
	`m®loc
((
Æ_hash_node_t
));

137 ià(!
node
)

138  -
NLE_NOMEM
;

139 
	`Æ_objeù_g‘
(
obj
);

140 
node
->
obj
 = obj;

141 
node
->
key
 = 
key_hash
;

142 
node
->
key_size
 = (
ušt32_t
);

143 
node
->
Ãxt
 = 
ht
->
nodes
[
key_hash
];

144 
ht
->
nodes
[
key_hash
] = 
node
;

147 
	}
}

161 
	$Æ_hash_bË_d–
(
Æ_hash_bË_t
 *
ht
, 
Æ_objeù
 *
obj
)

163 
Æ_hash_node_t
 *
node
, *
´ev
;

164 
ušt32_t
 
key_hash
;

166 
	`Æ_objeù_keyg’
(
obj
, &
key_hash
, 
ht
->
size
);

167 
´ev
 = 
node
 = 
ht
->
nodes
[
key_hash
];

169 
node
) {

170 ià(
	`Æ_objeù_id’tiÿl
(
node
->
obj
, obj)) {

171 
	`Æ_objeù_put
(
obj
);

173 
	`NL_DBG
 (5, "deleting cacheƒntry of obj %p inable %p, with"

174 " hash 0x%x\n", 
obj
, 
ht
, 
key_hash
);

176 ià(
node
 =ğ
ht
->
nodes
[
key_hash
])

177 
ht
->
nodes
[
key_hash
] = 
node
->
Ãxt
;

179 
´ev
->
Ãxt
 = 
node
->next;

181 
	`ä“
(
node
);

185 
´ev
 = 
node
;

186 
node
 =‚ode->
Ãxt
;

189  -
NLE_OBJ_NOTFOUND
;

190 
	}
}

192 
ušt32_t
 
	$Æ_hash
(*
k
, 
size_t
 
Ëngth
, 
ušt32_t
 
š™v®
)

194 (
	`__Æ_hash
(
k
, 
Ëngth
, 
š™v®
));

195 
	}
}

	@mylibnl/libnl-3.2.25/lib/idiag/idiag.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk/Ãšk.h
>

20 
	~<Ãšk/ÿche.h
>

21 
	~<Ãšk/idŸg/idŸgÆ.h
>

22 
	~<lšux/š‘_dŸg.h
>

40 
	$idŸgÆ_cÚÃù
(
Æ_sock
 *
sk
)

42  
	`Æ_cÚÃù
(
sk
, 
NETLINK_INET_DIAG
);

43 
	}
}

62 
	$idŸgÆ_£nd_sim¶e
(
Æ_sock
 *
sk
, 
æags
, 
ušt8_t
 
çmy
,

63 
ušt16_t
 
¡©es
, ušt16_ˆ
ext
)

65 
š‘_dŸg_»q
 
»q
;

66 
	`mem£t
(&
»q
, 0, (req));

68 
æags
 |ğ
NLM_F_ROOT
;

70 
»q
.
idŸg_çmy
 = 
çmy
;

71 
»q
.
idŸg_¡©es
 = 
¡©es
;

72 
»q
.
idŸg_ext
 = 
ext
;

74  
	`Æ_£nd_sim¶e
(
sk
, 
TCPDIAG_GETSOCK
, 
æags
, &
»q
, (req));

75 
	}
}

84 cÚ¡ 
Œªs_tbl
 
	gidŸg_¡©es
[] = {

85 
__ADD
(
IDIAG_SS_UNKNOWN
, 
unknown
)

86 
__ADD
(
IDIAG_SS_ESTABLISHED
, 
e¡ablished
)

87 
__ADD
(
IDIAG_SS_SYN_SENT
, 
syn_£Á
)

88 
__ADD
(
IDIAG_SS_SYN_RECV
, 
syn_»cv
)

89 
__ADD
(
IDIAG_SS_FIN_WAIT1
, 
fš_wa™
)

90 
__ADD
(
IDIAG_SS_FIN_WAIT2
, 
fš_wa™2
)

91 
__ADD
(
IDIAG_SS_TIME_WAIT
, 
time_wa™
)

92 
__ADD
(
IDIAG_SS_CLOSE
, 
şo£
)

93 
__ADD
(
IDIAG_SS_CLOSE_WAIT
, 
şo£_wa™
)

94 
__ADD
(
IDIAG_SS_LAST_ACK
, 
Ï¡_ack
)

95 
__ADD
(
IDIAG_SS_LISTEN
, 
li¡’
)

96 
__ADD
(
IDIAG_SS_CLOSING
, 
şosšg
)

97 
__ADD
(
IDIAG_SS_MAX
, 
max
)

98 { ((1<<
IDIAG_SS_MAX
)-1), "all" }

110 * 
	$idŸgÆ_¡©e2¡r
(
¡©e
, *
buf
, 
size_t
 
Ën
)

112  
	`__ty³2¡r
(
¡©e
, 
buf
, 
Ën
, 
idŸg_¡©es
,

113 
	`ARRAY_SIZE
(
idŸg_¡©es
));

114 
	}
}

123 
	$idŸgÆ_¡r2¡©e
(cÚ¡ *
Çme
)

125  
	`__¡r2ty³
(
Çme
, 
idŸg_¡©es
, 
	`ARRAY_SIZE
(idiag_states));

126 
	}
}

128 cÚ¡ 
Œªs_tbl
 
	gidŸg_tim”s
[] = {

129 
__ADD
(
IDIAG_TIMER_OFF
, 
off
)

130 
__ADD
(
IDIAG_TIMER_ON
, 
Ú
)

131 
__ADD
(
IDIAG_TIMER_KEEPALIVE
, 
k“·live
)

132 
__ADD
(
IDIAG_TIMER_TIMEWAIT
, 
timewa™
)

133 
__ADD
(
IDIAG_TIMER_PERSIST
, 
³rsi¡
)

134 
__ADD
(
IDIAG_TIMER_UNKNOWN
, 
unknown
)

145 * 
	$idŸgÆ_tim”2¡r
(
tim”
, *
buf
, 
size_t
 
Ën
)

147  
	`__ty³2¡r
(
tim”
, 
buf
, 
Ën
, 
idŸg_tim”s
,

148 
	`ARRAY_SIZE
(
idŸg_tim”s
));

149 
	}
}

157 
	$idŸgÆ_¡r2tim”
(cÚ¡ *
Çme
)

159  
	`__¡r2ty³
(
Çme
, 
idŸg_tim”s
, 
	`ARRAY_SIZE
(idiag_timers));

160 
	}
}

162 cÚ¡ 
Œªs_tbl
 
	gidŸg_©Œs
[] = {

163 
__ADD
(
IDIAG_ATTR_NONE
, 
nÚe
)

164 
__ADD
(
IDIAG_ATTR_MEMINFO
, 
memšfo
)

165 
__ADD
(
IDIAG_ATTR_INFO
, 
šfo
)

166 
__ADD
(
IDIAG_ATTR_VEGASINFO
, 
vegasšfo
)

167 
__ADD
(
IDIAG_ATTR_CONG
, 
cÚge¡iÚ
)

168 
__ADD
(
IDIAG_ATTR_TOS
, 
tos
)

169 
__ADD
(
IDIAG_ATTR_TCLASS
, 
tşass
)

180 *
	$idŸgÆ_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

182  
	`__ty³2¡r
(
©Œs
, 
buf
, 
Ën
, 
idŸg_©Œs
, 
	`ARRAY_SIZE
(idiag_attrs));

183 
	}
}

185 cÚ¡ 
Œªs_tbl
 
	gidŸgÆ_tı¡©es
[] = {

186 
__ADD
(
TCP_CA_O³n
, 
İ’
)

187 
__ADD
(
TCP_CA_DisÜd”
, 
disÜd”
)

188 
__ADD
(
TCP_CA_CWR
, 
cwr
)

189 
__ADD
(
TCP_CA_Recov”y
, 
»cov”y
)

190 
__ADD
(
TCP_CA_Loss
, 
loss
)

199 *
	$idŸgÆ_tı¡©e2¡r
(
ušt8_t
 
¡©e
, *
buf
, 
size_t
 
Ën
)

201  
	`__ty³2¡r
(
¡©e
, 
buf
, 
Ën
, 
idŸgÆ_tı¡©es
,

202 
	`ARRAY_SIZE
(
idŸgÆ_tı¡©es
));

203 
	}
}

205 cÚ¡ 
Œªs_tbl
 
	gidŸgÆ_tıİt_©Œs
[] = {

206 
__ADD
(
TCPI_OPT_TIMESTAMPS
, 
time¡amps
)

207 
__ADD
(
TCPI_OPT_SACK
, 
sACK
)

208 
__ADD
(
TCPI_OPT_WSCALE
, 
wsÿË
)

209 
__ADD
(
TCPI_OPT_ECN
, 
eú
)

221 *
	$idŸgÆ_tıİts2¡r
(
ušt8_t
 
©Œs
, *
buf
, 
size_t
 
Ën
)

223  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
idŸgÆ_tıİt_©Œs
,

224 
	`ARRAY_SIZE
(
idŸgÆ_tıİt_©Œs
));

225 
	}
}

235 * 
	$idŸgÆ_shutdown2¡r
(
ušt8_t
 
shutdown
, *
buf
, 
size_t
 
Ën
)

237 ià(
shutdown
 == 0) {

238 
	`¢´štf
(
buf
, 
Ën
, " ");

239  
buf
;

240 } ià(
shutdown
 == 1) {

241 
	`¢´štf
(
buf
, 
Ën
, "receive shutdown");

242  
buf
;

243 } ià(
shutdown
 == 2) {

244 
	`¢´štf
(
buf
, 
Ën
, "send shutdown");

245  
buf
;

248  
NULL
;

249 
	}
}

251 cÚ¡ 
Œªs_tbl
 
	gidŸg_exts
[] = {

252 
__ADD
(
IDIAG_ATTR_NONE
, 
nÚe
)

253 
__ADD
(
IDIAG_ATTR_MEMINFO
, 
memšfo
)

254 
__ADD
(
IDIAG_ATTR_INFO
, 
šfo
)

255 
__ADD
(
IDIAG_ATTR_VEGASINFO
, 
vegasšfo
)

256 
__ADD
(
IDIAG_ATTR_CONG
, 
cÚge¡iÚ
)

257 
__ADD
(
IDIAG_ATTR_TOS
, 
tos
)

258 
__ADD
(
IDIAG_ATTR_TCLASS
, 
tşass
)

268 *
	$idŸgÆ_exts2¡r
(
ušt8_t
 
©Œs
, *
buf
, 
size_t
 
Ën
)

270  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
idŸg_exts
, 
	`ARRAY_SIZE
(idiag_exts));

271 
	}
}

	@mylibnl/libnl-3.2.25/lib/idiag/idiag_meminfo_obj.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/idŸg/memšfo.h
>

23 
idŸgÆ_memšfo
 *
	$idŸgÆ_memšfo_®loc
()

25  (
idŸgÆ_memšfo
 *è
	`Æ_objeù_®loc
(&
idŸgÆ_memšfo_obj_İs
);

26 
	}
}

28 
	$idŸgÆ_memšfo_g‘
(
idŸgÆ_memšfo
 *
mšfo
)

30 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
mšfo
);

31 
	}
}

33 
	$idŸgÆ_memšfo_put
(
idŸgÆ_memšfo
 *
mšfo
)

35 
	`Æ_objeù_put
((
Æ_objeù
 *è
mšfo
);

36 
	}
}

42 
ušt32_t
 
	$idŸgÆ_memšfo_g‘_rmem
(cÚ¡ 
idŸgÆ_memšfo
 *
mšfo
)

44  
mšfo
->
idŸg_rmem
;

45 
	}
}

47 
	$idŸgÆ_memšfo_£t_rmem
(
idŸgÆ_memšfo
 *
mšfo
, 
ušt32_t
 
rmem
)

49 
mšfo
->
idŸg_rmem
 = 
rmem
;

50 
	}
}

52 
ušt32_t
 
	$idŸgÆ_memšfo_g‘_wmem
(cÚ¡ 
idŸgÆ_memšfo
 *
mšfo
)

54  
mšfo
->
idŸg_wmem
;

55 
	}
}

57 
	$idŸgÆ_memšfo_£t_wmem
(
idŸgÆ_memšfo
 *
mšfo
, 
ušt32_t
 
wmem
)

59 
mšfo
->
idŸg_wmem
 = 
wmem
;

60 
	}
}

62 
ušt32_t
 
	$idŸgÆ_memšfo_g‘_fmem
(cÚ¡ 
idŸgÆ_memšfo
 *
mšfo
)

64  
mšfo
->
idŸg_fmem
;

65 
	}
}

67 
	$idŸgÆ_memšfo_£t_fmem
(
idŸgÆ_memšfo
 *
mšfo
, 
ušt32_t
 
fmem
)

69 
mšfo
->
idŸg_fmem
 = 
fmem
;

70 
	}
}

72 
ušt32_t
 
	$idŸgÆ_memšfo_g‘_tmem
(cÚ¡ 
idŸgÆ_memšfo
 *
mšfo
)

74  
mšfo
->
idŸg_tmem
;

75 
	}
}

77 
	$idŸgÆ_memšfo_£t_tmem
(
idŸgÆ_memšfo
 *
mšfo
, 
ušt32_t
 
tmem
)

79 
mšfo
->
idŸg_tmem
 = 
tmem
;

80 
	}
}

83 
	$idŸgÆ_memšfo_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

85 
idŸgÆ_memšfo
 *
d¡
 = (idŸgÆ_memšfØ*è
_d¡
;

86 
idŸgÆ_memšfo
 *
¤c
 = (idŸgÆ_memšfØ*è
_¤c
;

88 
	`memıy
(
d¡
, 
¤c
, (
idŸgÆ_memšfo
));

91 
	}
}

94 
Æ_objeù_İs
 
	gidŸgÆ_memšfo_obj_İs
 = {

95 .
oo_Çme
 = "idiag/idiag_meminfo",

96 .
	goo_size
 = (
idŸgÆ_memšfo
),

97 .
	goo_şÚe
 = 
idŸgÆ_memšfo_şÚe
,

	@mylibnl/libnl-3.2.25/lib/idiag/idiag_msg_obj.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/idŸg/msg.h
>

14 
	~<Ãšk/idŸg/memšfo.h
>

15 
	~<Ãšk/idŸg/vegasšfo.h
>

16 
	~<lšux/š‘_dŸg.h
>

26 
idŸgÆ_msg
 *
	$idŸgÆ_msg_®loc
()

28  (
idŸgÆ_msg
 *è
	`Æ_objeù_®loc
(&
idŸgÆ_msg_obj_İs
);

29 
	}
}

31 
	$idŸgÆ_msg_g‘
(
idŸgÆ_msg
 *
msg
)

33 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
msg
);

34 
	}
}

36 
	$idŸgÆ_msg_put
(
idŸgÆ_msg
 *
msg
)

38 
	`Æ_objeù_put
((
Æ_objeù
 *è
msg
);

39 
	}
}

41 
Æ_ÿche_İs
 
	gidŸgÆ_msg_İs
;

43 
	$idŸgÆ_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

44 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

46 
idŸgÆ_msg
 *
msg
 = 
NULL
;

47 
”r
 = 0;

49 ià((
”r
 = 
	`idŸgÆ_msg_·r£
(
Æh
, &
msg
)) < 0)

50  
”r
;

52 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
msg
,…p);

53 
	`idŸgÆ_msg_put
(
msg
);

55  
”r
;

56 
	}
}

58 
	$idŸgÆ_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

60 
çmy
 = 
ÿche
->
c_Ÿrg1
;

61 
¡©es
 = 
ÿche
->
c_Ÿrg2
;

63  
	`idŸgÆ_£nd_sim¶e
(
sk
, 0, 
çmy
, 
¡©es
, 
IDIAG_ATTR_ALL
);

64 
	}
}

66 
Æ_ÿche_İs
 
	gidŸgÆ_msg_İs
 = {

67 .
co_Çme
 = "idiag/idiag",

68 .
	gco_hdrsize
 = (
š‘_dŸg_msg
),

69 .
	gco_msgty³s
 = {

70 { 
IDIAG_TCPDIAG_GETSOCK
, 
NL_ACT_NEW
, "new" },

71 { 
IDIAG_DCCPDIAG_GETSOCK
, 
NL_ACT_NEW
, "new" },

72 
END_OF_MSGTYPES_LIST
,

74 .
	gco_´ÙocŞ
 = 
NETLINK_INET_DIAG
,

75 .
	gco_»que¡_upd©e
 = 
idŸgÆ_»que¡_upd©e
,

76 .
	gco_msg_·r£r
 = 
idŸgÆ_msg_·r£r
,

77 .
	gco_obj_İs
 = &
idŸgÆ_msg_obj_İs
,

80 
__š™
 
	$idŸgÆ_š™
()

82 
	`Æ_ÿche_mngt_»gi¡”
(&
idŸgÆ_msg_İs
);

83 
	}
}

85 
__ex™
 
	$idŸgÆ_ex™
()

87 
	`Æ_ÿche_mngt_uÄegi¡”
(&
idŸgÆ_msg_İs
);

88 
	}
}

106 
	$idŸgÆ_msg_®loc_ÿche
(
Æ_sock
 *
sk
, 
çmy
, 
¡©es
,

107 
Æ_ÿche
 **
»suÉ
)

109 
Æ_ÿche
 *
ÿche
 = 
NULL
;

110 
”r
;

112 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(&
idŸgÆ_msg_İs
)))

113  -
NLE_NOMEM
;

115 
ÿche
->
c_Ÿrg1
 = 
çmy
;

116 
ÿche
->
c_Ÿrg2
 = 
¡©es
;

118 ià(
sk
 && (
”r
 = 
	`Æ_ÿche_»fl
(sk, 
ÿche
)) < 0) {

119 
	`ä“
(
ÿche
);

120  
”r
;

123 *
»suÉ
 = 
ÿche
;

125 
	}
}

134 
ušt8_t
 
	$idŸgÆ_msg_g‘_çmy
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

136  
msg
->
idŸg_çmy
;

137 
	}
}

139 
	$idŸgÆ_msg_£t_çmy
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
çmy
)

141 
msg
->
idŸg_çmy
 = 
çmy
;

142 
	}
}

144 
ušt8_t
 
	$idŸgÆ_msg_g‘_¡©e
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

146  
msg
->
idŸg_¡©e
;

147 
	}
}

149 
	$idŸgÆ_msg_£t_¡©e
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
¡©e
)

151 
msg
->
idŸg_¡©e
 = 
¡©e
;

152 
	}
}

154 
ušt8_t
 
	$idŸgÆ_msg_g‘_tim”
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

156  
msg
->
idŸg_tim”
;

157 
	}
}

159 
	$idŸgÆ_msg_£t_tim”
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
tim”
)

161 
msg
->
idŸg_tim”
 = 
tim”
;

162 
	}
}

164 
ušt8_t
 
	$idŸgÆ_msg_g‘_»Œªs
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

166  
msg
->
idŸg_»Œªs
;

167 
	}
}

169 
	$idŸgÆ_msg_£t_»Œªs
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
»Œªs
)

171 
msg
->
idŸg_»Œªs
 = 
»Œªs
;

172 
	}
}

174 
ušt16_t
 
	$idŸgÆ_msg_g‘_¥Üt
(
idŸgÆ_msg
 *
msg
)

176  
msg
->
idŸg_¥Üt
;

177 
	}
}

179 
	$idŸgÆ_msg_£t_¥Üt
(
idŸgÆ_msg
 *
msg
, 
ušt16_t
 
pÜt
)

181 
msg
->
idŸg_¥Üt
 = 
pÜt
;

182 
	}
}

184 
ušt16_t
 
	$idŸgÆ_msg_g‘_dpÜt
(
idŸgÆ_msg
 *
msg
)

186  
msg
->
idŸg_dpÜt
;

187 
	}
}

189 
	$idŸgÆ_msg_£t_dpÜt
(
idŸgÆ_msg
 *
msg
, 
ušt16_t
 
pÜt
)

191 
msg
->
idŸg_dpÜt
 = 
pÜt
;

192 
	}
}

194 
Æ_addr
 *
	$idŸgÆ_msg_g‘_¤c
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

196  
msg
->
idŸg_¤c
;

197 
	}
}

199 
	$idŸgÆ_msg_£t_¤c
(
idŸgÆ_msg
 *
msg
, 
Æ_addr
 *
addr
)

201 ià(
msg
->
idŸg_¤c
)

202 
	`Æ_addr_put
(
msg
->
idŸg_¤c
);

204 
	`Æ_addr_g‘
(
addr
);

205 
msg
->
idŸg_¤c
 = 
addr
;

208 
	}
}

210 
Æ_addr
 *
	$idŸgÆ_msg_g‘_d¡
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

212  
msg
->
idŸg_d¡
;

213 
	}
}

215 
	$idŸgÆ_msg_£t_d¡
(
idŸgÆ_msg
 *
msg
, 
Æ_addr
 *
addr
)

217 ià(
msg
->
idŸg_d¡
)

218 
	`Æ_addr_put
(
msg
->
idŸg_d¡
);

220 
	`Æ_addr_g‘
(
addr
);

221 
msg
->
idŸg_d¡
 = 
addr
;

224 
	}
}

226 
ušt32_t
 
	$idŸgÆ_msg_g‘_ifšdex
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

228  
msg
->
idŸg_ifšdex
;

229 
	}
}

231 
	$idŸgÆ_msg_£t_ifšdex
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
ifšdex
)

233 
msg
->
idŸg_ifšdex
 = 
ifšdex
;

234 
	}
}

236 
ušt32_t
 
	$idŸgÆ_msg_g‘_expœes
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

238  
msg
->
idŸg_expœes
;

239 
	}
}

241 
	$idŸgÆ_msg_£t_expœes
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
expœes
)

243 
msg
->
idŸg_expœes
 = 
expœes
;

244 
	}
}

246 
ušt32_t
 
	$idŸgÆ_msg_g‘_rqueue
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

248  
msg
->
idŸg_rqueue
;

249 
	}
}

251 
	$idŸgÆ_msg_£t_rqueue
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
rqueue
)

253 
msg
->
idŸg_rqueue
 = 
rqueue
;

254 
	}
}

256 
ušt32_t
 
	$idŸgÆ_msg_g‘_wqueue
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

258  
msg
->
idŸg_wqueue
;

259 
	}
}

261 
	$idŸgÆ_msg_£t_wqueue
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
wqueue
)

263 
msg
->
idŸg_wqueue
 = 
wqueue
;

264 
	}
}

266 
ušt32_t
 
	$idŸgÆ_msg_g‘_uid
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

268  
msg
->
idŸg_uid
;

269 
	}
}

271 
	$idŸgÆ_msg_£t_uid
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
uid
)

273 
msg
->
idŸg_uid
 = 
uid
;

274 
	}
}

276 
ušt32_t
 
	$idŸgÆ_msg_g‘_šode
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

278  
msg
->
idŸg_šode
;

279 
	}
}

281 
	$idŸgÆ_msg_£t_šode
(
idŸgÆ_msg
 *
msg
, 
ušt32_t
 
šode
)

283 
msg
->
idŸg_šode
 = 
šode
;

284 
	}
}

286 
ušt8_t
 
	$idŸgÆ_msg_g‘_tos
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

288  
msg
->
idŸg_tos
;

289 
	}
}

291 
	$idŸgÆ_msg_£t_tos
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
tos
)

293 
msg
->
idŸg_tos
 = 
tos
;

294 
	}
}

296 
ušt8_t
 
	$idŸgÆ_msg_g‘_tşass
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

298  
msg
->
idŸg_tşass
;

299 
	}
}

301 
	$idŸgÆ_msg_£t_tşass
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
tşass
)

303 
msg
->
idŸg_tşass
 = 
tşass
;

304 
	}
}

306 
ušt8_t
 
	$idŸgÆ_msg_g‘_shutdown
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

308  
msg
->
idŸg_shutdown
;

309 
	}
}

311 
	$idŸgÆ_msg_£t_shutdown
(
idŸgÆ_msg
 *
msg
, 
ušt8_t
 
shutdown
)

313 
msg
->
idŸg_shutdown
 = 
shutdown
;

314 
	}
}

316 *
	$idŸgÆ_msg_g‘_cÚg
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

318  
msg
->
idŸg_cÚg
;

319 
	}
}

321 
	$idŸgÆ_msg_£t_cÚg
(
idŸgÆ_msg
 *
msg
, *
cÚg
)

323 
msg
->
idŸg_cÚg
 = 
	`¡rdup
(
cÚg
);

324 
	}
}

326 
idŸgÆ_memšfo
 *
	$idŸgÆ_msg_g‘_memšfo
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

328  
msg
->
idŸg_memšfo
;

329 
	}
}

331 
	$idŸgÆ_msg_£t_memšfo
(
idŸgÆ_msg
 *
msg
, 
idŸgÆ_memšfo


332 *
mšfo
)

334 ià(
msg
->
idŸg_memšfo
)

335 
	`idŸgÆ_memšfo_put
(
msg
->
idŸg_memšfo
);

337 
	`idŸgÆ_memšfo_g‘
(
mšfo
);

338 
msg
->
idŸg_memšfo
 = 
mšfo
;

339 
	}
}

341 
idŸgÆ_vegasšfo
 *
	$idŸgÆ_msg_g‘_vegasšfo
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

343  
msg
->
idŸg_vegasšfo
;

344 
	}
}

346 
	$idŸgÆ_msg_£t_vegasšfo
(
idŸgÆ_msg
 *
msg
, 
idŸgÆ_vegasšfo


347 *
všfo
)

349 ià(
msg
->
idŸg_vegasšfo
)

350 
	`idŸgÆ_vegasšfo_put
(
msg
->
idŸg_vegasšfo
);

352 
	`idŸgÆ_vegasšfo_g‘
(
všfo
);

353 
msg
->
idŸg_vegasšfo
 = 
všfo
;

354 
	}
}

356 
tı_šfo
 
	$idŸgÆ_msg_g‘_tıšfo
(cÚ¡ 
idŸgÆ_msg
 *
msg
)

358  
msg
->
idŸg_tıšfo
;

359 
	}
}

361 
	$idŸgÆ_msg_£t_tıšfo
(
idŸgÆ_msg
 *
msg
, 
tı_šfo
 *
tšfo
)

363 
	`memıy
(&
msg
->
idŸg_tıšfo
, 
tšfo
, (
tı_šfo
));

364 
	}
}

368 
	$idŸg_msg_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

370 
idŸgÆ_msg
 *
msg
 = (idŸgÆ_msg *è
a
;

371 
buf
[64] = { 0 };

373 
	`Æ_dump_lše
(
p
, "çmy: % ", 
	`Æ_af2¡r
(
msg
->
idŸg_çmy
, 
buf
, (buf)));

374 
	`Æ_dump
(
p
, "¤c: %s:%d ", 
	`Æ_addr2¡r
(
msg
->
idŸg_¤c
, 
buf
, (buf)),

375 
	`Áohs
(
msg
->
idŸg_¥Üt
));

376 
	`Æ_dump
(
p
, "d¡: %s:%d ", 
	`Æ_addr2¡r
(
msg
->
idŸg_d¡
, 
buf
, (buf)),

377 
	`Áohs
(
msg
->
idŸg_dpÜt
));

378 
	`Æ_dump
(
p
, "iif: %d ", 
msg
->
idŸg_ifšdex
);

379 
	`Æ_dump
(
p
, "\n");

380 
	}
}

382 
	$idŸg_msg_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

384 
idŸgÆ_msg
 *
msg
 = (idŸgÆ_msg *è
a
;

385 
buf
[64], 
buf2
[64];

387 
	`Æ_dump
(
p
, "\nçmy: %s\n", 
	`Æ_af2¡r
(
msg
->
idŸg_çmy
, 
buf
, (buf)));

388 
	`Æ_dump
(
p
, "state: %s\n",

389 
	`idŸgÆ_¡©e2¡r
(
msg
->
idŸg_¡©e
, 
buf
, (buf)));

390 
	`Æ_dump
(
p
, "timer (%s, %s,„etransmits: %d)\n",

391 
	`idŸgÆ_tim”2¡r
(
msg
->
idŸg_tim”
, 
buf
, (buf)),

392 
	`Æ_m£c2¡r
(
msg
->
idŸg_expœes
, 
buf2
, (buf2)),

393 
msg
->
idŸg_»Œªs
);

395 
	`Æ_dump
(
p
, "sourû: %s:%d\n", 
	`Æ_addr2¡r
(
msg
->
idŸg_¤c
, 
buf
, (buf)),

396 
	`Áohs
(
msg
->
idŸg_¥Üt
));

397 
	`Æ_dump
(
p
, "de¡š©iÚ: %s:%d\n", 
	`Æ_addr2¡r
(
msg
->
idŸg_d¡
, 
buf
, (buf)),

398 
	`Áohs
(
msg
->
idŸg_dpÜt
));

400 
	`Æ_dump
(
p
, "ifšdex: %d\n", 
msg
->
idŸg_ifšdex
);

401 
	`Æ_dump
(
p
, "rqueue: %-6d wqueue: %-6d\n", 
msg
->
idŸg_rqueue
, msg->
idŸg_wqueue
);

402 
	`Æ_dump
(
p
, "uid %d\n", 
msg
->
idŸg_uid
);

403 
	`Æ_dump
(
p
, "šod%d\n", 
msg
->
idŸg_šode
);

404 ià(
msg
->
idŸg_shutdown
) {

405 
	`Æ_dump
(
p
, "socket shutdown: %s\n",

406 
	`idŸgÆ_shutdown2¡r
(
msg
->
idŸg_shutdown
,

407 
buf
, (buf)));

410 
	`Æ_dump
(
p
, "tos: 0x%x\n", 
msg
->
idŸg_tos
);

411 
	`Æ_dump
(
p
, "Œaffiøşass: %d\n", 
msg
->
idŸg_tşass
);

412 
	`Æ_dump
(
p
, "cÚge¡iÚ‡lgÜ™hm: %s\n", 
msg
->
idŸg_cÚg
);

413 
	}
}

415 
	$idŸg_msg_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

417 
idŸgÆ_msg
 *
msg
 = (idŸgÆ_msg *è
obj
;

418 
buf
[64];

420 
	`idŸg_msg_dump_d‘as
(
obj
, 
p
);

422 
	`Æ_dump
(
p
, "tcp info: [\n");

423 
	`Æ_dump
(
p
, "\tsocket state: %s\n",

424 
	`idŸgÆ_¡©e2¡r
(
msg
->
idŸg_tıšfo
.
tıi_¡©e
,

425 
buf
, (buf)));

426 
	`Æ_dump
(
p
, "\ttcp state: %s\n",

427 
	`idŸgÆ_tı¡©e2¡r
(
msg
->
idŸg_tıšfo
.
tıi_ÿ_¡©e
,

428 
buf
, (buf)));

429 
	`Æ_dump
(
p
, "\tretransmits: %d\n",

430 
msg
->
idŸg_tıšfo
.
tıi_»Œªsm™s
);

431 
	`Æ_dump
(
p
, "\tprobes: %d\n",

432 
msg
->
idŸg_tıšfo
.
tıi_´obes
);

433 
	`Æ_dump
(
p
, "\tbackoff: %d\n",

434 
msg
->
idŸg_tıšfo
.
tıi_backoff
);

435 
	`Æ_dump
(
p
, "\toptions: %s\n",

436 
	`idŸgÆ_tıİts2¡r
(
msg
->
idŸg_tıšfo
.
tıi_İtiÚs
,

437 
buf
, (buf)));

438 
	`Æ_dump
(
p
, "\t¢d_wsÿË: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_¢d_wsÿË
);

439 
	`Æ_dump
(
p
, "\Œcv_wsÿË: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_rcv_wsÿË
);

440 
	`Æ_dump
(
p
, "\Œto: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_¹o
);

441 
	`Æ_dump
(
p
, "\to: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_©o
);

442 
	`Æ_dump
(
p
, "\t¢d_mss: %s\n", 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_¢d_mss
,

443 
buf
, (buf)));

444 
	`Æ_dump
(
p
, "\Œcv_mss: %s\n", 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_rcv_mss
,

445 
buf
, (buf)));

446 
	`Æ_dump
(
p
, "\tuÇcked: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_uÇcked
);

447 
	`Æ_dump
(
p
, "\t§cked: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_§cked
);

449 
	`Æ_dump
(
p
, "\o¡: %d\n", 
msg
->
idŸg_tıšfo
.
tıi_lo¡
);

450 
	`Æ_dump
(
p
, "\tretransmit segments: %d\n",

451 
msg
->
idŸg_tıšfo
.
tıi_»Œªs
);

452 
	`Æ_dump
(
p
, "\tfackets: %d\n",

453 
msg
->
idŸg_tıšfo
.
tıi_çck‘s
);

454 
	`Æ_dump
(
p
, "\tlast data sent: %s\n",

455 
	`Æ_m£c2¡r
(
msg
->
idŸg_tıšfo
.
tıi_Ï¡_d©a_£Á
, 
buf
,

456 (
buf
)));

457 
	`Æ_dump
(
p
, "\tlast‡ck sent: %s\n",

458 
	`Æ_m£c2¡r
(
msg
->
idŸg_tıšfo
.
tıi_Ï¡_ack_£Á
, 
buf
, (buf)));

459 
	`Æ_dump
(
p
, "\tlast data„ecv: %s\n",

460 
	`Æ_m£c2¡r
(
msg
->
idŸg_tıšfo
.
tıi_Ï¡_d©a_»cv
, 
buf
,

461 (
buf
)));

462 
	`Æ_dump
(
p
, "\tlast‡ck„ecv: %s\n",

463 
	`Æ_m£c2¡r
(
msg
->
idŸg_tıšfo
.
tıi_Ï¡_ack_»cv
, 
buf
,

464 (
buf
)));

465 
	`Æ_dump
(
p
, "\tpath mtu: %s\n",

466 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_pmtu
, 
buf
,

467 (
buf
)));

468 
	`Æ_dump
(
p
, "\trcv sshreshold: %d\n",

469 
msg
->
idŸg_tıšfo
.
tıi_rcv_s¡h»sh
);

470 
	`Æ_dump
(
p
, "\tsmoothed„oundripime: %d\n",

471 
msg
->
idŸg_tıšfo
.
tıi_¹t
);

472 
	`Æ_dump
(
p
, "\troundripime variation: %d\n",

473 
msg
->
idŸg_tıšfo
.
tıi_¹tv¬
);

474 
	`Æ_dump
(
p
, "\tsnd sshreshold: %s\n",

475 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_¢d_s¡h»sh
, 
buf
,

476 (
buf
)));

477 
	`Æ_dump
(
p
, "\tsend congestion window: %d\n",

478 
msg
->
idŸg_tıšfo
.
tıi_¢d_cwnd
);

479 
	`Æ_dump
(
p
, "\tadvertised mss: %s\n",

480 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_advmss
, 
buf
,

481 (
buf
)));

482 
	`Æ_dump
(
p
, "\treordering: %d\n",

483 
msg
->
idŸg_tıšfo
.
tıi_»Üd”šg
);

484 
	`Æ_dump
(
p
, "\trcv„roundripime: %d\n",

485 
msg
->
idŸg_tıšfo
.
tıi_rcv_¹t
);

486 
	`Æ_dump
(
p
, "\treceive queue space: %s\n",

487 
	`Æ_size2¡r
(
msg
->
idŸg_tıšfo
.
tıi_rcv_¥aû
, 
buf
,

488 (
buf
)));

489 
	`Æ_dump
(
p
, "\ttotal„etransmits: %d\n",

490 
msg
->
idŸg_tıšfo
.
tıi_tÙ®_»Œªs
);

491 
	`Æ_dump
(
p
, "]\n");

493 ià(
msg
->
idŸg_memšfo
) {

494 
	`Æ_dump
(
p
, "meminfo: [\n");

495 
	`Æ_dump
(
p
, "\trmem: %s\n",

496 
	`Æ_size2¡r
(
msg
->
idŸg_memšfo
->
idŸg_rmem
,

497 
buf
,

498 (
buf
)));

499 
	`Æ_dump
(
p
, "\twmem: %s\n",

500 
	`Æ_size2¡r
(
msg
->
idŸg_memšfo
->
idŸg_wmem
,

501 
buf
,

502 (
buf
)));

503 
	`Æ_dump
(
p
, "\tfmem: %s\n",

504 
	`Æ_size2¡r
(
msg
->
idŸg_memšfo
->
idŸg_fmem
,

505 
buf
,

506 (
buf
)));

507 
	`Æ_dump
(
p
, "\ttmem: %s\n",

508 
	`Æ_size2¡r
(
msg
->
idŸg_memšfo
->
idŸg_tmem
,

509 
buf
,

510 (
buf
)));

511 
	`Æ_dump
(
p
, "]\n");

514 ià(
msg
->
idŸg_vegasšfo
) {

515 
	`Æ_dump
(
p
, "vegasinfo: [\n");

516 
	`Æ_dump
(
p
, "\tvegasƒnabled: %d\n",

517 
msg
->
idŸg_vegasšfo
->
tıv_’abËd
);

518 ià(
msg
->
idŸg_vegasšfo
->
tıv_’abËd
) {

519 
	`Æ_dump
(
p
, "\trtt cnt: %d",

520 
msg
->
idŸg_vegasšfo
->
tıv_¹tút
);

521 
	`Æ_dump
(
p
, "\trtt (propagation delay): %d",

522 
msg
->
idŸg_vegasšfo
->
tıv_¹t
);

523 
	`Æ_dump
(
p
, "\tmin„tt: %d",

524 
msg
->
idŸg_vegasšfo
->
tıv_mš¹t
);

526 
	`Æ_dump
(
p
, "]\n");

529 
	`Æ_dump
(
p
, "skmeminfo: [\n");

530 
	`Æ_dump
(
p
, "\trmem‡lloc: %d\n",

531 
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_RMEM_ALLOC
]);

532 
	`Æ_dump
(
p
, "\trcv buf: %s\n",

533 
	`Æ_size2¡r
(
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_RCVBUF
],

534 
buf
, (buf)));

535 
	`Æ_dump
(
p
, "\twmem‡lloc: %d\n",

536 
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_WMEM_ALLOC
]);

537 
	`Æ_dump
(
p
, "\tsnd buf: %s\n",

538 
	`Æ_size2¡r
(
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_SNDBUF
],

539 
buf
, (buf)));

540 
	`Æ_dump
(
p
, "\tfwd‡lloc: %d\n",

541 
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_FWD_ALLOC
]);

542 
	`Æ_dump
(
p
, "\twmem queued: %s\n",

543 
	`Æ_size2¡r
(
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_WMEM_QUEUED
],

544 
buf
, (buf)));

545 
	`Æ_dump
(
p
, "\topt mem: %d\n",

546 
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_OPTMEM
]);

547 
	`Æ_dump
(
p
, "\tbacklog: %d\n",

548 
msg
->
idŸg_skmemšfo
[
IDIAG_SK_MEMINFO_BACKLOG
]);

549 
	`Æ_dump
(
p
, "]\n\n");

550 
	}
}

552 
	$idŸgÆ_msg_ä“
(
Æ_objeù
 *
a
)

554 
idŸgÆ_msg
 *
msg
 = (idŸgÆ_msg *è
a
;

555 ià(
a
 =ğ
NULL
)

558 
	`ä“
(
msg
->
idŸg_cÚg
);

559 
	`Æ_addr_put
(
msg
->
idŸg_¤c
);

560 
	`Æ_addr_put
(
msg
->
idŸg_d¡
);

561 
	`idŸgÆ_memšfo_put
(
msg
->
idŸg_memšfo
);

562 
	`idŸgÆ_vegasšfo_put
(
msg
->
idŸg_vegasšfo
);

563 
	}
}

565 
	$idŸgÆ_msg_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

567 
idŸgÆ_msg
 *
d¡
 = (idŸgÆ_msg *è
_d¡
;

568 
idŸgÆ_msg
 *
¤c
 = (idŸgÆ_msg *è
_¤c
;

570 ià(
¤c
->
idŸg_¤c
)

571 ià(!(
d¡
->
idŸg_¤c
 = 
	`Æ_addr_şÚe
(
¤c
->idiag_src)))

572  -
NLE_NOMEM
;

574 ià(
¤c
->
idŸg_d¡
)

575 ià(!(
d¡
->
idŸg_d¡
 = 
	`Æ_addr_şÚe
(
¤c
->idiag_dst)))

576  -
NLE_NOMEM
;

579 
	}
}

581 
Æa_pŞicy
 
	gext_pŞicy
[
IDIAG_ATTR_MAX
] = {

582 [
IDIAG_ATTR_MEMINFO
] = { .
mšËn
 = (
š‘_dŸg_memšfo
) },

583 [
IDIAG_ATTR_INFO
] = { .
mšËn
 = (
tı_šfo
) },

584 [
IDIAG_ATTR_VEGASINFO
] = { .
mšËn
 = (
tıvegas_šfo
) },

585 [
IDIAG_ATTR_CONG
] = { .
ty³
 = 
NLA_STRING
 },

586 [
IDIAG_ATTR_TOS
] = { .
ty³
 = 
NLA_U8
 },

587 [
IDIAG_ATTR_TCLASS
] = { .
ty³
 = 
NLA_U8
 },

588 [
IDIAG_ATTR_SKMEMINFO
] = { .
mšËn
 = ((
ušt32_t
è* 
IDIAG_SK_MEMINFO_VARS
) },

589 [
IDIAG_ATTR_SHUTDOWN
] = { .
ty³
 = 
NLA_U8
 },

592 
	$idŸgÆ_msg_·r£
(
Æmsghdr
 *
Æh
, 
idŸgÆ_msg
 **
»suÉ
)

594 
idŸgÆ_msg
 *
msg
 = 
NULL
;

595 
š‘_dŸg_msg
 *
¿w_msg
 = 
NULL
;

596 
Æ_addr
 *
¤c
 = 
NULL
, *
d¡
 = NULL;

597 
Æ©Œ
 *
tb
[
IDIAG_ATTR_MAX
];

598 
”r
 = 0;

600 
msg
 = 
	`idŸgÆ_msg_®loc
();

601 ià(!
msg
)

602 
”rout_nomem
;

604 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
š‘_dŸg_msg
), 
tb
, 
IDIAG_ATTR_MAX
,

605 
ext_pŞicy
);

606 ià(
”r
 < 0)

607 
”rout
;

609 
¿w_msg
 = 
	`Æmsg_d©a
(
Æh
);

610 
msg
->
idŸg_çmy
 = 
¿w_msg
->idiag_family;

611 
msg
->
idŸg_¡©e
 = 
¿w_msg
->idiag_state;

612 
msg
->
idŸg_tim”
 = 
¿w_msg
->idiag_timer;

613 
msg
->
idŸg_»Œªs
 = 
¿w_msg
->idiag_retrans;

614 
msg
->
idŸg_expœes
 = 
¿w_msg
->idiag_expires;

615 
msg
->
idŸg_rqueue
 = 
¿w_msg
->idiag_rqueue;

616 
msg
->
idŸg_wqueue
 = 
¿w_msg
->idiag_wqueue;

617 
msg
->
idŸg_uid
 = 
¿w_msg
->idiag_uid;

618 
msg
->
idŸg_šode
 = 
¿w_msg
->idiag_inode;

619 
msg
->
idŸg_¥Üt
 = 
¿w_msg
->
id
.idiag_sport;

620 
msg
->
idŸg_dpÜt
 = 
¿w_msg
->
id
.idiag_dport;

621 
msg
->
idŸg_ifšdex
 = 
¿w_msg
->
id
.
idŸg_if
;

623 
d¡
 = 
	`Æ_addr_bud
(
¿w_msg
->
idŸg_çmy
,„aw_msg->
id
.
idŸg_d¡
,

624 (
¿w_msg
->
id
.
idŸg_d¡
));

625 ià(!
d¡
)

626 
”rout_nomem
;

628 
”r
 = 
	`idŸgÆ_msg_£t_d¡
(
msg
, 
d¡
);

629 ià(
”r
 < 0)

630 
”rout
;

632 
	`Æ_addr_put
(
d¡
);

634 
¤c
 = 
	`Æ_addr_bud
(
¿w_msg
->
idŸg_çmy
,„aw_msg->
id
.
idŸg_¤c
,

635 (
¿w_msg
->
id
.
idŸg_¤c
));

636 ià(!
¤c
)

637 
”rout_nomem
;

639 
”r
 = 
	`idŸgÆ_msg_£t_¤c
(
msg
, 
¤c
);

640 ià(
”r
 < 0)

641 
”rout
;

643 
	`Æ_addr_put
(
¤c
);

645 ià(
tb
[
IDIAG_ATTR_TOS
])

646 
msg
->
idŸg_tos
 = 
	`Æa_g‘_u8
(
tb
[
IDIAG_ATTR_TOS
]);

648 ià(
tb
[
IDIAG_ATTR_TCLASS
])

649 
msg
->
idŸg_tşass
 = 
	`Æa_g‘_u8
(
tb
[
IDIAG_ATTR_TCLASS
]);

651 ià(
tb
[
IDIAG_ATTR_SHUTDOWN
])

652 
msg
->
idŸg_shutdown
 = 
	`Æa_g‘_u8
(
tb
[
IDIAG_ATTR_SHUTDOWN
]);

654 ià(
tb
[
IDIAG_ATTR_CONG
])

655 
msg
->
idŸg_cÚg
 = 
	`Æa_¡rdup
(
tb
[
IDIAG_ATTR_CONG
]);

657 ià(
tb
[
IDIAG_ATTR_INFO
])

658 
	`Æa_memıy
(&
msg
->
idŸg_tıšfo
, 
tb
[
IDIAG_ATTR_INFO
],

659 (
msg
->
idŸg_tıšfo
));

661 ià(
tb
[
IDIAG_ATTR_MEMINFO
]) {

662 
idŸgÆ_memšfo
 *
mšfo
 = 
	`idŸgÆ_memšfo_®loc
();

663 
š‘_dŸg_memšfo
 *
¿w_mšfo
 = 
NULL
;

665 ià(!
mšfo
)

666 
”rout_nomem
;

668 
¿w_mšfo
 = (
š‘_dŸg_memšfo
 *)

669 
	`Æa_d©a
(
tb
[
IDIAG_ATTR_MEMINFO
]);

671 
	`idŸgÆ_memšfo_£t_rmem
(
mšfo
, 
¿w_mšfo
->
idŸg_rmem
);

672 
	`idŸgÆ_memšfo_£t_wmem
(
mšfo
, 
¿w_mšfo
->
idŸg_wmem
);

673 
	`idŸgÆ_memšfo_£t_fmem
(
mšfo
, 
¿w_mšfo
->
idŸg_fmem
);

674 
	`idŸgÆ_memšfo_£t_tmem
(
mšfo
, 
¿w_mšfo
->
idŸg_tmem
);

676 
msg
->
idŸg_memšfo
 = 
mšfo
;

679 ià(
tb
[
IDIAG_ATTR_VEGASINFO
]) {

680 
idŸgÆ_vegasšfo
 *
všfo
 = 
	`idŸgÆ_vegasšfo_®loc
();

681 
tıvegas_šfo
 *
¿w_všfo
 = 
NULL
;

683 ià(!
všfo
)

684 
”rout_nomem
;

686 
¿w_všfo
 = (
tıvegas_šfo
 *)

687 
	`Æa_d©a
(
tb
[
IDIAG_ATTR_VEGASINFO
]);

689 
	`idŸgÆ_vegasšfo_£t_’abËd
(
všfo
, 
¿w_všfo
->
tıv_’abËd
);

690 
	`idŸgÆ_vegasšfo_£t_¹tút
(
všfo
, 
¿w_všfo
->
tıv_¹tút
);

691 
	`idŸgÆ_vegasšfo_£t_¹t
(
všfo
, 
¿w_všfo
->
tıv_¹t
);

692 
	`idŸgÆ_vegasšfo_£t_mš¹t
(
všfo
, 
¿w_všfo
->
tıv_mš¹t
);

694 
msg
->
idŸg_vegasšfo
 = 
všfo
;

697 ià(
tb
[
IDIAG_ATTR_SKMEMINFO
])

698 
	`Æa_memıy
(&
msg
->
idŸg_skmemšfo
, 
tb
[
IDIAG_ATTR_SKMEMINFO
],

699 (
msg
->
idŸg_skmemšfo
));

701 *
»suÉ
 = 
msg
;

704 
”rout
:

705 
	`idŸgÆ_msg_put
(
msg
);

706  
”r
;

708 
”rout_nomem
:

709 
”r
 = -
NLE_NOMEM
;

710 
”rout
;

711 
	}
}

714 
Æ_objeù_İs
 
	gidŸgÆ_msg_obj_İs
 = {

715 .
oo_Çme
 = "idiag/idiag_msg",

716 .
	goo_size
 = (
idŸgÆ_msg
),

717 .
	goo_ä“_d©a
 = 
idŸgÆ_msg_ä“
,

718 .
	goo_şÚe
 = 
idŸgÆ_msg_şÚe
,

719 .
	goo_dump
 = {

720 [
NL_DUMP_LINE
] = 
idŸg_msg_dump_lše
,

721 [
NL_DUMP_DETAILS
] = 
idŸg_msg_dump_d‘as
,

722 [
NL_DUMP_STATS
] = 
idŸg_msg_dump_¡©s
,

724 .
	goo_©Œs2¡r
 = 
idŸgÆ_©Œs2¡r
,

725 .
	goo_id_©Œs
 = (
IDIAG_ATTR_INFO
)

	@mylibnl/libnl-3.2.25/lib/idiag/idiag_req_obj.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/idŸg/»q.h
>

14 
	~<lšux/š‘_dŸg.h
>

24 
idŸgÆ_»q
 *
	$idŸgÆ_»q_®loc
()

26  (
idŸgÆ_»q
 *è
	`Æ_objeù_®loc
(&
idŸgÆ_»q_obj_İs
);

27 
	}
}

29 
	$idŸgÆ_»q_g‘
(
idŸgÆ_»q
 *
»q
)

31 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
»q
);

32 
	}
}

34 
	$idŸgÆ_»q_put
(
idŸgÆ_»q
 *
»q
)

36 
	`Æ_objeù_put
((
Æ_objeù
 *è
»q
);

37 
	}
}

44 
ušt8_t
 
	$idŸgÆ_»q_g‘_çmy
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

46  
»q
->
idŸg_çmy
;

47 
	}
}

49 
	$idŸgÆ_»q_£t_çmy
(
idŸgÆ_»q
 *
»q
, 
ušt8_t
 
çmy
)

51 
»q
->
idŸg_çmy
 = 
çmy
;

52 
	}
}

54 
ušt8_t
 
	$idŸgÆ_»q_g‘_ext
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

56  
»q
->
idŸg_ext
;

57 
	}
}

59 
	$idŸgÆ_»q_£t_ext
(
idŸgÆ_»q
 *
»q
, 
ušt8_t
 
ext
)

61 
»q
->
idŸg_ext
 = 
ext
;

62 
	}
}

64 
ušt32_t
 
	$idŸgÆ_»q_g‘_ifšdex
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

66  
»q
->
idŸg_ifšdex
;

67 
	}
}

69 
	$idŸgÆ_»q_£t_ifšdex
(
idŸgÆ_»q
 *
»q
, 
ušt32_t
 
ifšdex
)

71 
»q
->
idŸg_¡©es
 = 
ifšdex
;

72 
	}
}

74 
ušt32_t
 
	$idŸgÆ_»q_g‘_¡©es
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

76  
»q
->
idŸg_¡©es
;

77 
	}
}

79 
	$idŸgÆ_»q_£t_¡©es
(
idŸgÆ_»q
 *
»q
, 
ušt32_t
 
¡©es
)

81 
»q
->
idŸg_¡©es
 = 
¡©es
;

82 
	}
}

84 
ušt32_t
 
	$idŸgÆ_»q_g‘_dbs
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

86  
»q
->
idŸg_dbs
;

87 
	}
}

89 
	$idŸgÆ_»q_£t_dbs
(
idŸgÆ_»q
 *
»q
, 
ušt32_t
 
dbs
)

91 
»q
->
idŸg_dbs
 = 
dbs
;

92 
	}
}

94 
Æ_addr
 *
	$idŸgÆ_»q_g‘_¤c
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

96  
»q
->
idŸg_¤c
;

97 
	}
}

99 
	$idŸgÆ_»q_£t_¤c
(
idŸgÆ_»q
 *
»q
, 
Æ_addr
 *
addr
)

101 ià(
»q
->
idŸg_¤c
)

102 
	`Æ_addr_put
(
»q
->
idŸg_¤c
);

104 
	`Æ_addr_g‘
(
addr
);

105 
»q
->
idŸg_¤c
 = 
addr
;

108 
	}
}

110 
Æ_addr
 *
	$idŸgÆ_»q_g‘_d¡
(cÚ¡ 
idŸgÆ_»q
 *
»q
)

112  
»q
->
idŸg_d¡
;

113 
	}
}

115 
	$idŸgÆ_»q_£t_d¡
(
idŸgÆ_»q
 *
»q
, 
Æ_addr
 *
addr
)

117 ià(
»q
->
idŸg_d¡
)

118 
	`Æ_addr_put
(
»q
->
idŸg_d¡
);

120 
	`Æ_addr_g‘
(
addr
);

121 
»q
->
idŸg_d¡
 = 
addr
;

124 
	}
}

128 
	$idŸg_»q_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

130 
idŸgÆ_»q
 *
»q
 = (idŸgÆ_»q *è
a
;

131 
buf
[64] = { 0 };

133 
	`Æ_dump_lše
(
p
, "% ", 
	`Æ_af2¡r
(
»q
->
idŸg_çmy
, 
buf
, (buf)));

134 
	`Æ_dump
(
p
, "¤ø% ", 
	`Æ_addr2¡r
(
»q
->
idŸg_¤c
, 
buf
, (buf)));

135 
	`Æ_dump
(
p
, "d¡ % ", 
	`Æ_addr2¡r
(
»q
->
idŸg_d¡
, 
buf
, (buf)));

136 
	`Æ_dump
(
p
, "iià%d ", 
»q
->
idŸg_ifšdex
);

137 
	`Æ_dump
(
p
, "\n");

138 
	}
}

140 
	$idŸg_»q_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

142 
idŸgÆ_»q
 *
»q
 = (idŸgÆ_»q *è
a
;

143 
buf
[64];

145 
	`Æ_dump_lše
(
p
, " ");

146 
	`Æ_dump
(
p
, "% ", 
	`Æ_af2¡r
(
»q
->
idŸg_çmy
, 
buf
, (buf)));

147 
	`Æ_dump
(
p
, "exts %s ",

148 
	`idŸgÆ_exts2¡r
(
»q
->
idŸg_ext
, 
buf
, (buf)));

149 
	`Æ_dump
(
p
, "¤ø% ", 
	`Æ_addr2¡r
(
»q
->
idŸg_¤c
, 
buf
, (buf)));

150 
	`Æ_dump
(
p
, "d¡ % ", 
	`Æ_addr2¡r
(
»q
->
idŸg_d¡
, 
buf
, (buf)));

151 
	`Æ_dump
(
p
, "iià%d ", 
»q
->
idŸg_ifšdex
);

152 
	`Æ_dump
(
p
, "¡©e % ", 
	`idŸgÆ_¡©e2¡r
(
»q
->
idŸg_¡©es
, 
buf
,

153 (
buf
)));

154 
	`Æ_dump
(
p
, "db %d", 
»q
->
idŸg_dbs
);

155 
	`Æ_dump
(
p
, "\n");

156 
	}
}

158 
	$idŸg_»q_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

160 
	`idŸg_»q_dump_d‘as
(
obj
, 
p
);

161 
	}
}

163 
	$idŸgÆ_»q_ä“
(
Æ_objeù
 *
a
)

165 
idŸgÆ_»q
 *
»q
 = (idŸgÆ_»q *è
a
;

166 ià(
a
 =ğ
NULL
)

169 
	`Æ_addr_put
(
»q
->
idŸg_¤c
);

170 
	`Æ_addr_put
(
»q
->
idŸg_d¡
);

171 
	}
}

173 
	$idŸgÆ_»q_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

175 
idŸgÆ_»q
 *
d¡
 = (idŸgÆ_»q *è
_d¡
;

176 
idŸgÆ_»q
 *
¤c
 = (idŸgÆ_»q *è
_¤c
;

178 ià(
¤c
->
idŸg_¤c
)

179 ià(!(
d¡
->
idŸg_¤c
 = 
	`Æ_addr_şÚe
(
¤c
->idiag_src)))

180  -
NLE_NOMEM
;

182 ià(
¤c
->
idŸg_d¡
)

183 ià(!(
d¡
->
idŸg_d¡
 = 
	`Æ_addr_şÚe
(
¤c
->idiag_dst)))

184  -
NLE_NOMEM
;

187 
	}
}

189 
	$idŸgÆ_»q_·r£
(
Æmsghdr
 *
Æh
, 
idŸgÆ_»q
 **
»suÉ
)

191 
idŸgÆ_»q
 *
»q
 = 
NULL
;

192 
š‘_dŸg_»q
 *
¿w_»q
 = 
NULL
;

193 
Æ_addr
 *
¤c
 = 
NULL
, *
d¡
 = NULL;

194 
”r
 = 0;

196 
»q
 = 
	`idŸgÆ_»q_®loc
();

197 ià(!
»q
)

198 
”rout_nomem
;

200 
¿w_»q
 = 
	`Æmsg_d©a
(
Æh
);

201 
»q
->
idŸg_çmy
 = 
¿w_»q
->idiag_family;

202 
»q
->
idŸg_ext
 = 
¿w_»q
->idiag_ext;

203 
»q
->
idŸg_¡©es
 = 
¿w_»q
->idiag_states;

204 
»q
->
idŸg_dbs
 = 
¿w_»q
->idiag_dbs;

205 
»q
->
idŸg_ifšdex
 = 
¿w_»q
->
id
.
idŸg_if
;

207 
d¡
 = 
	`Æ_addr_bud
(
¿w_»q
->
idŸg_çmy
,„aw_»q->
id
.
idŸg_d¡
,

208 (
¿w_»q
->
id
.
idŸg_d¡
));

209 ià(!
d¡
)

210 
”rout_nomem
;

212 
”r
 = 
	`idŸgÆ_»q_£t_d¡
(
»q
, 
d¡
);

213 ià(
”r
 < 0)

214 
”rout
;

216 
	`Æ_addr_put
(
d¡
);

218 
¤c
 = 
	`Æ_addr_bud
(
¿w_»q
->
idŸg_çmy
,„aw_»q->
id
.
idŸg_¤c
,

219 (
¿w_»q
->
id
.
idŸg_¤c
));

220 ià(!
¤c
)

221 
”rout_nomem
;

223 
”r
 = 
	`idŸgÆ_»q_£t_¤c
(
»q
, 
¤c
);

224 ià(
”r
 < 0)

225 
”rout
;

227 
	`Æ_addr_put
(
¤c
);

229 *
»suÉ
 = 
»q
;

232 
”rout
:

233 
	`idŸgÆ_»q_put
(
»q
);

234  
”r
;

236 
”rout_nomem
:

237 
”r
 = -
NLE_NOMEM
;

238 
”rout
;

239 
	}
}

242 
Æ_objeù_İs
 
	gidŸgÆ_»q_obj_İs
 = {

243 .
oo_Çme
 = "idiag/idiag_req",

244 .
	goo_size
 = (
idŸgÆ_»q
),

245 .
	goo_ä“_d©a
 = 
idŸgÆ_»q_ä“
,

246 .
	goo_şÚe
 = 
idŸgÆ_»q_şÚe
,

247 .
	goo_dump
 = {

248 [
NL_DUMP_LINE
] = 
idŸg_»q_dump_lše
,

249 [
NL_DUMP_DETAILS
] = 
idŸg_»q_dump_d‘as
,

250 [
NL_DUMP_STATS
] = 
idŸg_»q_dump_¡©s
,

	@mylibnl/libnl-3.2.25/lib/idiag/idiag_vegasinfo_obj.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/idŸg/vegasšfo.h
>

23 
idŸgÆ_vegasšfo
 *
	$idŸgÆ_vegasšfo_®loc
()

25  (
idŸgÆ_vegasšfo
 *è
	`Æ_objeù_®loc
(&
idŸgÆ_vegasšfo_obj_İs
);

26 
	}
}

28 
	$idŸgÆ_vegasšfo_g‘
(
idŸgÆ_vegasšfo
 *
všfo
)

30 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
všfo
);

31 
	}
}

33 
	$idŸgÆ_vegasšfo_put
(
idŸgÆ_vegasšfo
 *
všfo
)

35 
	`Æ_objeù_put
((
Æ_objeù
 *è
všfo
);

36 
	}
}

42 
ušt32_t
 
	$idŸgÆ_vegasšfo_g‘_’abËd
(cÚ¡ 
idŸgÆ_vegasšfo
 *
všfo
)

44  
všfo
->
tıv_’abËd
;

45 
	}
}

47 
	$idŸgÆ_vegasšfo_£t_’abËd
(
idŸgÆ_vegasšfo
 *
všfo
, 
ušt32_t


48 
’abËd
)

50 
všfo
->
tıv_’abËd
 = 
’abËd
;

51 
	}
}

53 
ušt32_t
 
	$idŸgÆ_vegasšfo_g‘_¹tút
(cÚ¡ 
idŸgÆ_vegasšfo
 *
všfo
)

55  
všfo
->
tıv_¹tút
;

56 
	}
}

58 
	$idŸgÆ_vegasšfo_£t_¹tút
(
idŸgÆ_vegasšfo
 *
všfo
, 
ušt32_t


59 
¹tút
)

61 
všfo
->
tıv_¹tút
 = 
¹tút
;

62 
	}
}

64 
ušt32_t
 
	$idŸgÆ_vegasšfo_g‘_¹t
(cÚ¡ 
idŸgÆ_vegasšfo
 *
všfo
)

66  
všfo
->
tıv_¹t
;

67 
	}
}

69 
	$idŸgÆ_vegasšfo_£t_¹t
(
idŸgÆ_vegasšfo
 *
všfo
, 
ušt32_t
 
¹t
)

71 
všfo
->
tıv_¹t
 = 
¹t
;

72 
	}
}

74 
ušt32_t
 
	$idŸgÆ_vegasšfo_g‘_mš¹t
(cÚ¡ 
idŸgÆ_vegasšfo
 *
všfo
)

76  
všfo
->
tıv_mš¹t
;

77 
	}
}

79 
	$idŸgÆ_vegasšfo_£t_mš¹t
(
idŸgÆ_vegasšfo
 *
všfo
, 
ušt32_t


80 
mš¹t
)

82 
všfo
->
tıv_mš¹t
 = 
mš¹t
;

83 
	}
}

86 
	$idŸgÆ_vegasšfo_şÚe
(
Æ_objeù
 *
_d¡
,

87 
Æ_objeù
 *
_¤c
)

89 
idŸgÆ_vegasšfo
 *
d¡
 = (idŸgÆ_vegasšfØ*è
_d¡
;

90 
idŸgÆ_vegasšfo
 *
¤c
 = (idŸgÆ_vegasšfØ*è
_¤c
;

92 
	`memıy
(
d¡
, 
¤c
, (
idŸgÆ_vegasšfo
));

95 
	}
}

98 
Æ_objeù_İs
 
	gidŸgÆ_vegasšfo_obj_İs
 = {

99 .
oo_Çme
 = "idiag/idiag_vegasinfo",

100 .
	goo_size
 = (
idŸgÆ_vegasšfo
),

101 .
	goo_şÚe
 = 
idŸgÆ_vegasšfo_şÚe
,

	@mylibnl/libnl-3.2.25/lib/msg.c

29 
	~<Ãšk-´iv©e/Ãšk.h
>

30 
	~<Ãšk/Ãšk.h
>

31 
	~<Ãšk/uts.h
>

32 
	~<Ãšk/ÿche.h
>

33 
	~<Ãšk/©Œ.h
>

34 
	~<lšux/sock‘.h
>

36 
size_t
 
	gdeçuÉ_msg_size
;

38 
__š™
 
	$š™_msg_size
()

40 
deçuÉ_msg_size
 = 
	`g‘·gesize
();

41 
	}
}

54 
	$Æmsg_size
(
·ylßd
)

56  
NLMSG_HDRLEN
 + 
·ylßd
;

57 
	}
}

59 
	$Æmsg_msg_size
(
·ylßd
)

61  
	`Æmsg_size
(
·ylßd
);

62 
	}
}

72 
	$Æmsg_tÙ®_size
(
·ylßd
)

74  
	`NLMSG_ALIGN
(
	`Æmsg_msg_size
(
·ylßd
));

75 
	}
}

87 
	$Æmsg_·dËn
(
·ylßd
)

89  
	`Æmsg_tÙ®_size
(
·ylßd
è- 
	`Æmsg_msg_size
(payload);

90 
	}
}

105 *
	$Æmsg_d©a
(cÚ¡ 
Æmsghdr
 *
Æh
)

107  (*è
Æh
 + 
NLMSG_HDRLEN
;

108 
	}
}

110 *
	$Æmsg_
(cÚ¡ 
Æmsghdr
 *
Æh
)

112  (*è
Æh
 + 
	`NLMSG_ALIGN
Òlh->
Æmsg_Ën
);

113 
	}
}

121 
	$Æmsg_d©®’
(cÚ¡ 
Æmsghdr
 *
Æh
)

123  
Æh
->
Æmsg_Ën
 - 
NLMSG_HDRLEN
;

124 
	}
}

126 
	$Æmsg_Ën
(cÚ¡ 
Æmsghdr
 *
Æh
)

128  
	`Æmsg_d©®’
(
Æh
);

129 
	}
}

143 
Æ©Œ
 *
	$Æmsg_©Œd©a
(cÚ¡ 
Æmsghdr
 *
Æh
, 
hd¾’
)

145 *
d©a
 = 
	`Æmsg_d©a
(
Æh
);

146  (
Æ©Œ
 *è(
d©a
 + 
	`NLMSG_ALIGN
(
hd¾’
));

147 
	}
}

154 
	$Æmsg_©ŒËn
(cÚ¡ 
Æmsghdr
 *
Æh
, 
hd¾’
)

156  
	`max_t
(, 
	`Æmsg_Ën
(
Æh
è- 
	`NLMSG_ALIGN
(
hd¾’
), 0);

157 
	}
}

166 
	$Æmsg_v®id_hdr
(cÚ¡ 
Æmsghdr
 *
Æh
, 
hd¾’
)

168 ià(
Æh
->
Æmsg_Ën
 < 
	`Æmsg_msg_size
(
hd¾’
))

172 
	}
}

179 
	$Æmsg_ok
(cÚ¡ 
Æmsghdr
 *
Æh
, 
»maššg
)

181  (
»maššg
 >ğ()(
Æmsghdr
) &&

182 
Æh
->
Æmsg_Ën
 >ğ(
Æmsghdr
) &&

183 
Æh
->
Æmsg_Ën
 <ğ
»maššg
);

184 
	}
}

194 
Æmsghdr
 *
	$Æmsg_Ãxt
(
Æmsghdr
 *
Æh
, *
»maššg
)

196 
tÙËn
 = 
	`NLMSG_ALIGN
(
Æh
->
Æmsg_Ën
);

198 *
»maššg
 -ğ
tÙËn
;

200  (
Æmsghdr
 *è((*è
Æh
 + 
tÙËn
);

201 
	}
}

213 
	$Æmsg_·r£
(
Æmsghdr
 *
Æh
, 
hd¾’
, 
Æ©Œ
 *
tb
[],

214 
maxty³
, 
Æa_pŞicy
 *
pŞicy
)

216 ià(!
	`Æmsg_v®id_hdr
(
Æh
, 
hd¾’
))

217  -
NLE_MSG_TOOSHORT
;

219  
	`Æa_·r£
(
tb
, 
maxty³
, 
	`Æmsg_©Œd©a
(
Æh
, 
hd¾’
),

220 
	`Æmsg_©ŒËn
(
Æh
, 
hd¾’
), 
pŞicy
);

221 
	}
}

231 
Æ©Œ
 *
	$Æmsg_fšd_©Œ
(
Æmsghdr
 *
Æh
, 
hd¾’
, 
©Œty³
)

233  
	`Æa_fšd
(
	`Æmsg_©Œd©a
(
Æh
, 
hd¾’
),

234 
	`Æmsg_©ŒËn
(
Æh
, 
hd¾’
), 
©Œty³
);

235 
	}
}

244 
	$Æmsg_v®id©e
(
Æmsghdr
 *
Æh
, 
hd¾’
, 
maxty³
,

245 
Æa_pŞicy
 *
pŞicy
)

247 ià(!
	`Æmsg_v®id_hdr
(
Æh
, 
hd¾’
))

248  -
NLE_MSG_TOOSHORT
;

250  
	`Æa_v®id©e
(
	`Æmsg_©Œd©a
(
Æh
, 
hd¾’
),

251 
	`Æmsg_©ŒËn
(
Æh
, 
hd¾’
), 
maxty³
, 
pŞicy
);

252 
	}
}

261 
Æ_msg
 *
	$__Æmsg_®loc
(
size_t
 
Ën
)

263 
Æ_msg
 *
nm
;

265 ià(
Ën
 < (
Æmsghdr
))

266 
Ën
 = (
Æmsghdr
);

268 
nm
 = 
	`ÿÎoc
(1, (*nm));

269 ià(!
nm
)

270 
”rout
;

272 
nm
->
nm_»fút
 = 1;

274 
nm
->
nm_Æh
 = 
	`ÿÎoc
(1, 
Ën
);

275 ià(!
nm
->
nm_Æh
)

276 
”rout
;

278 
nm
->
nm_´ÙocŞ
 = -1;

279 
nm
->
nm_size
 = 
Ën
;

280 
nm
->
nm_Æh
->
Æmsg_Ën
 = 
	`Æmsg_tÙ®_size
(0);

282 
	`NL_DBG
(2, "msg %p: AÎoÿ‹d‚ew mes§ge, maxËn=%zu\n", 
nm
, 
Ën
);

284  
nm
;

285 
”rout
:

286 
	`ä“
(
nm
);

287  
NULL
;

288 
	}
}

299 
Æ_msg
 *
	$Æmsg_®loc
()

301  
	`__Æmsg_®loc
(
deçuÉ_msg_size
);

302 
	}
}

307 
Æ_msg
 *
	$Æmsg_®loc_size
(
size_t
 
max
)

309  
	`__Æmsg_®loc
(
max
);

310 
	}
}

322 
Æ_msg
 *
	$Æmsg_šh”™
(
Æmsghdr
 *
hdr
)

324 
Æ_msg
 *
nm
;

326 
nm
 = 
	`Æmsg_®loc
();

327 ià(
nm
 && 
hdr
) {

328 
Æmsghdr
 *
Ãw
 = 
nm
->
nm_Æh
;

330 
Ãw
->
Æmsg_ty³
 = 
hdr
->nlmsg_type;

331 
Ãw
->
Æmsg_æags
 = 
hdr
->nlmsg_flags;

332 
Ãw
->
Æmsg_£q
 = 
hdr
->nlmsg_seq;

333 
Ãw
->
Æmsg_pid
 = 
hdr
->nlmsg_pid;

336  
nm
;

337 
	}
}

346 
Æ_msg
 *
	$Æmsg_®loc_sim¶e
(
Æmsgty³
, 
æags
)

348 
Æ_msg
 *
msg
;

349 
Æmsghdr
 
Æh
 = {

350 .
Æmsg_ty³
 = 
Æmsgty³
,

351 .
Æmsg_æags
 = 
æags
,

354 
msg
 = 
	`Æmsg_šh”™
(&
Æh
);

355 ià(
msg
)

356 
	`NL_DBG
(2, "msg %p: AÎoÿ‹d‚ew sim¶mes§ge\n", 
msg
);

358  
msg
;

359 
	}
}

365 
	$Æmsg_£t_deçuÉ_size
(
size_t
 
max
)

367 ià(
max
 < 
	`Æmsg_tÙ®_size
(0))

368 
max
 = 
	`Æmsg_tÙ®_size
(0);

370 
deçuÉ_msg_size
 = 
max
;

371 
	}
}

382 
Æ_msg
 *
	$Æmsg_cÚv”t
(
Æmsghdr
 *
hdr
)

384 
Æ_msg
 *
nm
;

386 
nm
 = 
	`__Æmsg_®loc
(
	`NLMSG_ALIGN
(
hdr
->
Æmsg_Ën
));

387 ià(!
nm
)

388  
NULL
;

390 
	`memıy
(
nm
->
nm_Æh
, 
hdr
, hdr->
Æmsg_Ën
);

392  
nm
;

393 
	}
}

407 *
	$Æmsg_»£rve
(
Æ_msg
 *
n
, 
size_t
 
Ën
, 
·d
)

409 *
buf
 = 
n
->
nm_Æh
;

410 
size_t
 
Æmsg_Ën
 = 
n
->
nm_Æh
->nlmsg_len;

411 
size_t
 
’
;

413 
’
 = 
·d
 ? ((
Ën
 + (pad - 1)) & ~(pad - 1)) :†en;

415 ià((
’
 + 
Æmsg_Ën
è> 
n
->
nm_size
)

416  
NULL
;

418 
buf
 +ğ
Æmsg_Ën
;

419 
n
->
nm_Æh
->
Æmsg_Ën
 +ğ
’
;

421 ià(
’
 > 
Ën
)

422 
	`mem£t
(
buf
 + 
Ën
, 0, 
’
 -†en);

424 
	`NL_DBG
(2, "msg %p: Reserved %zu (%zu) bytes,…ad=%d,‚lmsg_len=%d\n",

425 
n
, 
’
, 
Ën
, 
·d
,‚->
nm_Æh
->
Æmsg_Ën
);

427  
buf
;

428 
	}
}

442 
	$Æmsg_­³nd
(
Æ_msg
 *
n
, *
d©a
, 
size_t
 
Ën
, 
·d
)

444 *
tmp
;

446 
tmp
 = 
	`Æmsg_»£rve
(
n
, 
Ën
, 
·d
);

447 ià(
tmp
 =ğ
NULL
)

448  -
NLE_NOMEM
;

450 
	`memıy
(
tmp
, 
d©a
, 
Ën
);

451 
	`NL_DBG
(2, "msg %p: Aµ’ded %zu by‹ w™h…addšg %d\n", 
n
, 
Ën
, 
·d
);

454 
	}
}

470 
	$Æmsg_ex·nd
(
Æ_msg
 *
n
, 
size_t
 
ÃwËn
)

472 *
tmp
;

474 ià(
ÃwËn
 <ğ
n
->
nm_size
)

475  -
NLE_INVAL
;

477 
tmp
 = 
	`»®loc
(
n
->
nm_Æh
, 
ÃwËn
);

478 ià(
tmp
 =ğ
NULL
)

479  -
NLE_NOMEM
;

481 
n
->
nm_Æh
 = 
tmp
;

482 
n
->
nm_size
 = 
ÃwËn
;

485 
	}
}

503 
Æmsghdr
 *
	$Æmsg_put
(
Æ_msg
 *
n
, 
ušt32_t
 
pid
, ušt32_ˆ
£q
,

504 
ty³
, 
·ylßd
, 
æags
)

506 
Æmsghdr
 *
Æh
;

508 ià(
n
->
nm_Æh
->
Æmsg_Ën
 < 
NLMSG_HDRLEN
)

509 
	`BUG
();

511 
Æh
 = (
Æmsghdr
 *è
n
->
nm_Æh
;

512 
Æh
->
Æmsg_ty³
 = 
ty³
;

513 
Æh
->
Æmsg_æags
 = 
æags
;

514 
Æh
->
Æmsg_pid
 = 
pid
;

515 
Æh
->
Æmsg_£q
 = 
£q
;

517 
	`NL_DBG
(2, "msg %p: Added‚etlink headerype=%d, flags=%d,…id=%d, "

518 "£q=%d\n", 
n
, 
ty³
, 
æags
, 
pid
, 
£q
);

520 ià(
·ylßd
 > 0 &&

521 
	`Æmsg_»£rve
(
n
, 
·ylßd
, 
NLMSG_ALIGNTO
è=ğ
NULL
)

522  
NULL
;

524  
Æh
;

525 
	}
}

536 
Æmsghdr
 *
	$Æmsg_hdr
(
Æ_msg
 *
n
)

538  
n
->
nm_Æh
;

539 
	}
}

545 
	$Æmsg_g‘
(
Æ_msg
 *
msg
)

547 
msg
->
nm_»fút
++;

548 
	`NL_DBG
(4, "New„eferenceo message %p,otal %d\n",

549 
msg
, msg->
nm_»fút
);

550 
	}
}

558 
	$Æmsg_ä“
(
Æ_msg
 *
msg
)

560 ià(!
msg
)

563 
msg
->
nm_»fút
--;

564 
	`NL_DBG
(4, "Returned message„eference %p, %d„emaining\n",

565 
msg
, msg->
nm_»fút
);

567 ià(
msg
->
nm_»fút
 < 0)

568 
	`BUG
();

570 ià(
msg
->
nm_»fút
 <= 0) {

571 
	`ä“
(
msg
->
nm_Æh
);

572 
	`NL_DBG
(2, "msg %p: F»ed\n", 
msg
);

573 
	`ä“
(
msg
);

575 
	}
}

584 
	$Æmsg_£t_´Ùo
(
Æ_msg
 *
msg
, 
´ÙocŞ
)

586 
msg
->
nm_´ÙocŞ
 = 
´ÙocŞ
;

587 
	}
}

589 
	$Æmsg_g‘_´Ùo
(
Æ_msg
 *
msg
)

591  
msg
->
nm_´ÙocŞ
;

592 
	}
}

594 
size_t
 
	$Æmsg_g‘_max_size
(
Æ_msg
 *
msg
)

596  
msg
->
nm_size
;

597 
	}
}

599 
	$Æmsg_£t_¤c
(
Æ_msg
 *
msg
, 
sockaddr_Æ
 *
addr
)

601 
	`memıy
(&
msg
->
nm_¤c
, 
addr
, (*addr));

602 
	}
}

604 
sockaddr_Æ
 *
	$Æmsg_g‘_¤c
(
Æ_msg
 *
msg
)

606  &
msg
->
nm_¤c
;

607 
	}
}

609 
	$Æmsg_£t_d¡
(
Æ_msg
 *
msg
, 
sockaddr_Æ
 *
addr
)

611 
	`memıy
(&
msg
->
nm_d¡
, 
addr
, (*addr));

612 
	}
}

614 
sockaddr_Æ
 *
	$Æmsg_g‘_d¡
(
Æ_msg
 *
msg
)

616  &
msg
->
nm_d¡
;

617 
	}
}

619 
	$Æmsg_£t_üeds
(
Æ_msg
 *
msg
, 
uüed
 *
üeds
)

621 
	`memıy
(&
msg
->
nm_üeds
, 
üeds
, (*creds));

622 
msg
->
nm_æags
 |ğ
NL_MSG_CRED_PRESENT
;

623 
	}
}

625 
uüed
 *
	$Æmsg_g‘_üeds
(
Æ_msg
 *
msg
)

627 ià(
msg
->
nm_æags
 & 
NL_MSG_CRED_PRESENT
)

628  &
msg
->
nm_üeds
;

629  
NULL
;

630 
	}
}

639 cÚ¡ 
Œªs_tbl
 
	gÆ_msgty³s
[] = {

640 
__ADD
(
NLMSG_NOOP
,
NOOP
)

641 
__ADD
(
NLMSG_ERROR
,
ERROR
)

642 
__ADD
(
NLMSG_DONE
,
DONE
)

643 
__ADD
(
NLMSG_OVERRUN
,
OVERRUN
)

646 *
	$Æ_Æmsgty³2¡r
(
ty³
, *
buf
, 
size_t
 
size
)

648  
	`__ty³2¡r
(
ty³
, 
buf
, 
size
, 
Æ_msgty³s
,

649 
	`ARRAY_SIZE
(
Æ_msgty³s
));

650 
	}
}

652 
	$Æ_¡r2Æmsgty³
(cÚ¡ *
Çme
)

654  
	`__¡r2ty³
(
Çme
, 
Æ_msgty³s
, 
	`ARRAY_SIZE
(nl_msgtypes));

655 
	}
}

664 *
	$Æ_Æmsg_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

666 
	`mem£t
(
buf
, 0, 
Ën
);

668 
	#PRINT_FLAG
(
f
) \

669 ià(
æags
 & 
NLM_F_
##
f
) { \

670 
æags
 &ğ~
NLM_F_
##
f
; \

671 
	`¡ºÿt
(
buf
, #f, 
Ën
 - 
	`¡¾’
(buf) - 1); \

672 ià(
æags
) \

673 
	`¡ºÿt
(
buf
, ",", 
Ën
 - 
	`¡¾’
(buf) - 1); \

674 }

	)

676 
	`PRINT_FLAG
(
REQUEST
);

677 
	`PRINT_FLAG
(
MULTI
);

678 
	`PRINT_FLAG
(
ACK
);

679 
	`PRINT_FLAG
(
ECHO
);

680 
	`PRINT_FLAG
(
ROOT
);

681 
	`PRINT_FLAG
(
MATCH
);

682 
	`PRINT_FLAG
(
ATOMIC
);

683 
	`PRINT_FLAG
(
REPLACE
);

684 
	`PRINT_FLAG
(
EXCL
);

685 
	`PRINT_FLAG
(
CREATE
);

686 
	`PRINT_FLAG
(
APPEND
);

688 ià(
æags
) {

689 
s
[32];

690 
	`¢´štf
(
s
, (s), "0x%x", 
æags
);

691 
	`¡ºÿt
(
buf
, 
s
, 
Ën
 - 
	`¡¾’
(buf) - 1);

693 #undeà
PRINT_FLAG


695  
buf
;

696 
	}
}

706 
	sdp_xd©a
 {

707 (*
	mcb
)(
	mÆ_objeù
 *, *);

708 *
	m¬g
;

712 
	$·r£_cb
(
Æ_objeù
 *
obj
, 
Æ_·r£r_·¿m
 *
p
)

714 
dp_xd©a
 *
x
 = 
p
->
µ_¬g
;

716 
x
->
	`cb
(
obj
, x->
¬g
);

718 
	}
}

720 
Æ_msg_·r£
(
Æ_msg
 *
msg
, (*
cb
)(
Æ_objeù
 *, *),

721 *
¬g
)

723 
Æ_ÿche_İs
 *
İs
;

724 
Æ_·r£r_·¿m
 
p
 = {

725 .
µ_cb
 = 
·r£_cb


727 
dp_xd©a
 
x
 = {

728 .
cb
 = cb,

729 .
¬g
 =‡rg,

731 
”r
;

733 
İs
 = 
	`Æ_ÿche_İs_assocŸ‹_§ã
(
	`Æmsg_g‘_´Ùo
(
msg
),

734 
	`Æmsg_hdr
(
msg
)->
Æmsg_ty³
);

735 ià(
İs
 =ğ
NULL
)

736  -
NLE_MSGTYPE_NOSUPPORT
;

737 
p
.
µ_¬g
 = &
x
;

739 
”r
 = 
	`Æ_ÿche_·r£
(
İs
, 
NULL
, 
	`Æmsg_hdr
(
msg
), &
p
);

740 
	`Æ_ÿche_İs_put
(
İs
);

742  
”r
;

743 
	}
}

752 
	$´efix_lše
(
FILE
 *
ofd
, 
´efix
)

754 
i
;

756 
i
 = 0; i < 
´efix
; i++)

757 
	`årštf
(
ofd
, " ");

758 
	}
}

760 
šlše
 
	$dump_hex
(
FILE
 *
ofd
, *
¡¬t
, 
Ën
, 
´efix
)

762 
i
, 
a
, 
c
, 
lim™
;

763 
ascii
[21] = {0};

765 
lim™
 = 16 - (
´efix
 * 2);

766 
	`´efix_lše
(
ofd
, 
´efix
);

767 
	`årštf
(
ofd
, " ");

769 
i
 = 0, 
a
 = 0, 
c
 = 0; i < 
Ën
; i++) {

770 
v
 = *(
ušt8_t
 *è(
¡¬t
 + 
i
);

772 
	`årštf
(
ofd
, "%02x ", 
v
);

773 
ascii
[
a
++] = 
	`i¥ršt
(
v
) ? v : '.';

775 ià(++
c
 >ğ
lim™
) {

776 
	`årštf
(
ofd
, "%s\n", 
ascii
);

777 ià(
i
 < (
Ën
 - 1)) {

778 
	`´efix_lše
(
ofd
, 
´efix
);

779 
	`årštf
(
ofd
, " ");

781 
a
 = 
c
 = 0;

782 
	`mem£t
(
ascii
, 0, (ascii));

786 ià(
c
 != 0) {

787 
i
 = 0; i < (
lim™
 - 
c
); i++)

788 
	`årštf
(
ofd
, " ");

789 
	`årštf
(
ofd
, "%s\n", 
ascii
);

791 
	}
}

793 
	$´št_hdr
(
FILE
 *
ofd
, 
Æ_msg
 *
msg
)

795 
Æmsghdr
 *
Æh
 = 
	`Æmsg_hdr
(
msg
);

796 
Æ_ÿche_İs
 *
İs
;

797 
Æ_msgty³
 *
mt
;

798 
buf
[128];

800 
	`årštf
(
ofd
, " .Æmsg_ËÀğ%d\n", 
Æh
->
Æmsg_Ën
);

802 
İs
 = 
	`Æ_ÿche_İs_assocŸ‹_§ã
(
	`Æmsg_g‘_´Ùo
(
msg
), 
Æh
->
Æmsg_ty³
);

803 ià(
İs
) {

804 
mt
 = 
	`Æ_msgty³_lookup
(
İs
, 
Æh
->
Æmsg_ty³
);

805 ià(!
mt
)

806 
	`BUG
();

808 
	`¢´štf
(
buf
, (buf), "%s::%s", 
İs
->
co_Çme
, 
mt
->
mt_Çme
);

809 
	`Æ_ÿche_İs_put
(
İs
);

811 
	`Æ_Æmsgty³2¡r
(
Æh
->
Æmsg_ty³
, 
buf
, (buf));

813 
	`årštf
(
ofd
, " .ty³ = %d <%s>\n", 
Æh
->
Æmsg_ty³
, 
buf
);

814 
	`årštf
(
ofd
, " .æag ğ%d <%s>\n", 
Æh
->
Æmsg_æags
,

815 
	`Æ_Æmsg_æags2¡r
(
Æh
->
Æmsg_æags
, 
buf
, (buf)));

816 
	`årštf
(
ofd
, " .£q = %d\n", 
Æh
->
Æmsg_£q
);

817 
	`årštf
(
ofd
, " .pÜˆğ%d\n", 
Æh
->
Æmsg_pid
);

819 
	}
}

821 
	$´št_g’l_hdr
(
FILE
 *
ofd
, *
¡¬t
)

823 
g’lmsghdr
 *
ghdr
 = 
¡¬t
;

825 
	`årštf
(
ofd
, " [GENERIC NETLINK HEADER] %zu où‘s\n", 
GENL_HDRLEN
);

826 
	`årštf
(
ofd
, " .cmd = %u\n", 
ghdr
->
cmd
);

827 
	`årštf
(
ofd
, " .v”siÚ = %u\n", 
ghdr
->
v”siÚ
);

828 
	`årštf
(
ofd
, " .unu£d = %#x\n", 
ghdr
->
»£rved
);

829 
	}
}

831 *
	$´št_g’l_msg
(
Æ_msg
 *
msg
, 
FILE
 *
ofd
, 
Æmsghdr
 *
hdr
,

832 
Æ_ÿche_İs
 *
İs
, *
·ylßdËn
)

834 *
d©a
 = 
	`Æmsg_d©a
(
hdr
);

836 ià(*
·ylßdËn
 < 
GENL_HDRLEN
)

837  
d©a
;

839 
	`´št_g’l_hdr
(
ofd
, 
d©a
);

841 *
·ylßdËn
 -ğ
GENL_HDRLEN
;

842 
d©a
 +ğ
GENL_HDRLEN
;

844 ià(
İs
) {

845 
hdrsize
 = 
İs
->
co_hdrsize
 - 
GENL_HDRLEN
;

847 ià(
hdrsize
 > 0) {

848 ià(*
·ylßdËn
 < 
hdrsize
)

849  
d©a
;

851 
	`årštf
(
ofd
, " [HEADER] %d où‘s\n", 
hdrsize
);

852 
	`dump_hex
(
ofd
, 
d©a
, 
hdrsize
, 0);

854 *
·ylßdËn
 -ğ
hdrsize
;

855 
d©a
 +ğ
hdrsize
;

859  
d©a
;

860 
	}
}

862 
	$dump_©Œ
(
FILE
 *
ofd
, 
Æ©Œ
 *
©Œ
, 
´efix
)

864 
Ën
 = 
	`Æa_Ën
(
©Œ
);

866 
	`dump_hex
(
ofd
, 
	`Æa_d©a
(
©Œ
), 
Ën
, 
´efix
);

867 
	}
}

869 
	$dump_©Œs
(
FILE
 *
ofd
, 
Æ©Œ
 *
©Œs
, 
©ŒËn
,

870 
´efix
)

872 
»m
;

873 
Æ©Œ
 *
Æa
;

875 
	`Æa_fÜ_—ch_©Œ
(
Æa
, 
©Œs
, 
©ŒËn
, 
»m
) {

876 
·dËn
, 
®’
 = 
	`Æa_Ën
(
Æa
);

878 
	`´efix_lše
(
ofd
, 
´efix
);

880 ià(
Æa
->
Æa_ty³
 == 0)

881 
	`årštf
(
ofd
, " [ATTR PADDING] %d où‘s\n", 
®’
);

883 
	`årštf
(
ofd
, " [ATTR %02d%s] %d où‘s\n", 
	`Æa_ty³
(
Æa
),

884 
	`Æa_is_Ã¡ed
(
Æa
) ? " NESTED" : "",

885 
®’
);

887 ià(
	`Æa_is_Ã¡ed
(
Æa
))

888 
	`dump_©Œs
(
ofd
, 
	`Æa_d©a
(
Æa
), 
®’
, 
´efix
+1);

890 
	`dump_©Œ
(
ofd
, 
Æa
, 
´efix
);

892 
·dËn
 = 
	`Æa_·dËn
(
®’
);

893 ià(
·dËn
 > 0) {

894 
	`´efix_lše
(
ofd
, 
´efix
);

895 
	`årštf
(
ofd
, " [PADDING] %d octets\n",

896 
·dËn
);

897 
	`dump_hex
(
ofd
, 
	`Æa_d©a
(
Æa
è+ 
®’
,

898 
·dËn
, 
´efix
);

902 ià(
»m
) {

903 
	`´efix_lše
(
ofd
, 
´efix
);

904 
	`årštf
(
ofd
, " [LEFTOVER] %d où‘s\n", 
»m
);

906 
	}
}

908 
	$dump_”rÜ_msg
(
Æ_msg
 *
msg
, 
FILE
 *
ofd
)

910 
Æmsghdr
 *
hdr
 = 
	`Æmsg_hdr
(
msg
);

911 
Æmsg”r
 *
”r
 = 
	`Æmsg_d©a
(
hdr
);

913 
	`årštf
(
ofd
, " [ERRORMSG] %zu où‘s\n", (*
”r
));

915 ià(
	`Æmsg_Ën
(
hdr
è>ğ(*
”r
)) {

916 
buf
[256];

917 
Æ_msg
 *
”rmsg
;

919 
	`årštf
(
ofd
, " .”rÜ = %d \"%s\"\n", 
”r
->
”rÜ
,

920 
	`¡»¼Ü_r
(-
”r
->
”rÜ
, 
buf
, (buf)));

921 
	`årštf
(
ofd
, " [ORIGINAL MESSAGE] %zu où‘s\n", (*
hdr
));

923 
”rmsg
 = 
	`Æmsg_šh”™
(&
”r
->
msg
);

924 
	`´št_hdr
(
ofd
, 
”rmsg
);

925 
	`Æmsg_ä“
(
”rmsg
);

927 
	}
}

929 
	$´št_msg
(
Æ_msg
 *
msg
, 
FILE
 *
ofd
, 
Æmsghdr
 *
hdr
)

931 
Æ_ÿche_İs
 *
İs
;

932 
·ylßdËn
 = 
	`Æmsg_Ën
(
hdr
);

933 
©ŒËn
 = 0;

934 *
d©a
;

936 
d©a
 = 
	`Æmsg_d©a
(
hdr
);

937 
İs
 = 
	`Æ_ÿche_İs_assocŸ‹_§ã
(
	`Æmsg_g‘_´Ùo
(
msg
),

938 
hdr
->
Æmsg_ty³
);

939 ià(
İs
) {

940 
©ŒËn
 = 
	`Æmsg_©ŒËn
(
hdr
, 
İs
->
co_hdrsize
);

941 
·ylßdËn
 -ğ
©ŒËn
;

944 ià(
msg
->
nm_´ÙocŞ
 =ğ
NETLINK_GENERIC
)

945 
d©a
 = 
	`´št_g’l_msg
(
msg
, 
ofd
, 
hdr
, 
İs
, &
·ylßdËn
);

947 ià(
·ylßdËn
) {

948 
	`årštf
(
ofd
, " [PAYLOAD] %d où‘s\n", 
·ylßdËn
);

949 
	`dump_hex
(
ofd
, 
d©a
, 
·ylßdËn
, 0);

952 ià(
©ŒËn
) {

953 
Æ©Œ
 *
©Œs
;

954 
©ŒËn
;

956 
©Œs
 = 
	`Æmsg_©Œd©a
(
hdr
, 
İs
->
co_hdrsize
);

957 
©ŒËn
 = 
	`Æmsg_©ŒËn
(
hdr
, 
İs
->
co_hdrsize
);

958 
	`dump_©Œs
(
ofd
, 
©Œs
, 
©ŒËn
, 0);

961 ià(
İs
)

962 
	`Æ_ÿche_İs_put
(
İs
);

963 
	}
}

970 
	$Æ_msg_dump
(
Æ_msg
 *
msg
, 
FILE
 *
ofd
)

972 
Æmsghdr
 *
hdr
 = 
	`Æmsg_hdr
(
msg
);

974 
	`årštf
(
ofd
,

977 
	`årštf
(
ofd
, " [NETLINK HEADER] %zu où‘s\n", (
Æmsghdr
));

978 
	`´št_hdr
(
ofd
, 
msg
);

980 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
)

981 
	`dump_”rÜ_msg
(
msg
, 
ofd
);

982 ià(
	`Æmsg_Ën
(
hdr
) > 0)

983 
	`´št_msg
(
msg
, 
ofd
, 
hdr
);

985 
	`årštf
(
ofd
,

987 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/ct.c

22 
	~<by‹sw­.h
>

23 
	~<sys/ty³s.h
>

24 
	~<lšux/Ãtf‹r/nâ‘lšk_cÚÁ¿ck.h
>

26 
	~<Ãšk-´iv©e/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/Ãtf‹r/nâl.h
>

29 
	~<Ãšk/Ãtf‹r/ù.h
>

31 
Æ_ÿche_İs
 
	gnâl_ù_İs
;

33 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


34 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

36  
x
;

37 
	}
}

38 
ušt64_t
 
	$htÚÎ
(
ušt64_t
 
x
)

40  
x
;

41 
	}
}

42 #–ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


43 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

45  
	`bsw­_64
(
x
);

46 
	}
}

47 
ušt64_t
 
	$htÚÎ
(
ušt64_t
 
x
)

49  
	`bsw­_64
(
x
);

50 
	}
}

53 
Æa_pŞicy
 
	gù_pŞicy
[
CTA_MAX
+1] = {

54 [
CTA_TUPLE_ORIG
] = { .
ty³
 = 
NLA_NESTED
 },

55 [
CTA_TUPLE_REPLY
] = { .
ty³
 = 
NLA_NESTED
 },

56 [
CTA_STATUS
] = { .
ty³
 = 
NLA_U32
 },

57 [
CTA_PROTOINFO
] = { .
ty³
 = 
NLA_NESTED
 },

60 [
CTA_TIMEOUT
] = { .
ty³
 = 
NLA_U32
 },

61 [
CTA_MARK
] = { .
ty³
 = 
NLA_U32
 },

62 [
CTA_COUNTERS_ORIG
] = { .
ty³
 = 
NLA_NESTED
 },

63 [
CTA_COUNTERS_REPLY
] = { .
ty³
 = 
NLA_NESTED
 },

64 [
CTA_USE
] = { .
ty³
 = 
NLA_U32
 },

65 [
CTA_ID
] = { .
ty³
 = 
NLA_U32
 },

66 [
CTA_ZONE
] = { .
ty³
 = 
NLA_U16
 },

70 
Æa_pŞicy
 
	gù_tu¶e_pŞicy
[
CTA_TUPLE_MAX
+1] = {

71 [
CTA_TUPLE_IP
] = { .
ty³
 = 
NLA_NESTED
 },

72 [
CTA_TUPLE_PROTO
] = { .
ty³
 = 
NLA_NESTED
 },

75 
Æa_pŞicy
 
	gù__pŞicy
[
CTA_IP_MAX
+1] = {

76 [
CTA_IP_V4_SRC
] = { .
ty³
 = 
NLA_U32
 },

77 [
CTA_IP_V4_DST
] = { .
ty³
 = 
NLA_U32
 },

78 [
CTA_IP_V6_SRC
] = { .
mšËn
 = 16 },

79 [
CTA_IP_V6_DST
] = { .
mšËn
 = 16 },

82 
Æa_pŞicy
 
	gù_´Ùo_pŞicy
[
CTA_PROTO_MAX
+1] = {

83 [
CTA_PROTO_NUM
] = { .
ty³
 = 
NLA_U8
 },

84 [
CTA_PROTO_SRC_PORT
] = { .
ty³
 = 
NLA_U16
 },

85 [
CTA_PROTO_DST_PORT
] = { .
ty³
 = 
NLA_U16
 },

86 [
CTA_PROTO_ICMP_ID
] = { .
ty³
 = 
NLA_U16
 },

87 [
CTA_PROTO_ICMP_TYPE
] = { .
ty³
 = 
NLA_U8
 },

88 [
CTA_PROTO_ICMP_CODE
] = { .
ty³
 = 
NLA_U8
 },

89 [
CTA_PROTO_ICMPV6_ID
] = { .
ty³
 = 
NLA_U16
 },

90 [
CTA_PROTO_ICMPV6_TYPE
] = { .
ty³
 = 
NLA_U8
 },

91 [
CTA_PROTO_ICMPV6_CODE
] = { .
ty³
 = 
NLA_U8
 },

94 
Æa_pŞicy
 
	gù_´Ùošfo_pŞicy
[
CTA_PROTOINFO_MAX
+1] = {

95 [
CTA_PROTOINFO_TCP
] = { .
ty³
 = 
NLA_NESTED
 },

98 
Æa_pŞicy
 
	gù_´Ùošfo_tı_pŞicy
[
CTA_PROTOINFO_TCP_MAX
+1] = {

99 [
CTA_PROTOINFO_TCP_STATE
] = { .
ty³
 = 
NLA_U8
 },

100 [
CTA_PROTOINFO_TCP_WSCALE_ORIGINAL
] = { .
ty³
 = 
NLA_U8
 },

101 [
CTA_PROTOINFO_TCP_WSCALE_REPLY
] = { .
ty³
 = 
NLA_U8
 },

102 [
CTA_PROTOINFO_TCP_FLAGS_ORIGINAL
] = { .
mšËn
 = 2 },

103 [
CTA_PROTOINFO_TCP_FLAGS_REPLY
] = { .
mšËn
 = 2 },

107 
Æa_pŞicy
 
	gù_couÁ”s_pŞicy
[
CTA_COUNTERS_MAX
+1] = {

108 [
CTA_COUNTERS_PACKETS
] = { .
ty³
 = 
NLA_U64
 },

109 [
CTA_COUNTERS_BYTES
] = { .
ty³
 = 
NLA_U64
 },

110 [
CTA_COUNTERS32_PACKETS
]ğ{ .
ty³
 = 
NLA_U32
 },

111 [
CTA_COUNTERS32_BYTES
] = { .
ty³
 = 
NLA_U32
 },

114 
Æa_pŞicy
 
	gù_time¡amp_pŞicy
[
CTA_TIMESTAMP_MAX
 + 1] = {

115 [
CTA_TIMESTAMP_START
] = { .
ty³
 = 
NLA_U64
 },

116 [
CTA_TIMESTAMP_STOP
] = { .
ty³
 = 
NLA_U64
 },

119 
	$ù_·r£_
(
nâl_ù
 *
ù
, 
»¶
, 
Æ©Œ
 *
©Œ
)

121 
Æ©Œ
 *
tb
[
CTA_IP_MAX
+1];

122 
Æ_addr
 *
addr
;

123 
”r
;

125 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_IP_MAX
, 
©Œ
, 
ù__pŞicy
);

126 ià(
”r
 < 0)

127 
”rout
;

129 ià(
tb
[
CTA_IP_V4_SRC
]) {

130 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V4_SRC
], 
AF_INET
);

131 ià(
addr
 =ğ
NULL
)

132 
”rout_’omem
;

133 
”r
 = 
	`nâl_ù_£t_¤c
(
ù
, 
»¶
, 
addr
);

134 
	`Æ_addr_put
(
addr
);

135 ià(
”r
 < 0)

136 
”rout
;

138 ià(
tb
[
CTA_IP_V4_DST
]) {

139 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V4_DST
], 
AF_INET
);

140 ià(
addr
 =ğ
NULL
)

141 
”rout_’omem
;

142 
”r
 = 
	`nâl_ù_£t_d¡
(
ù
, 
»¶
, 
addr
);

143 
	`Æ_addr_put
(
addr
);

144 ià(
”r
 < 0)

145 
”rout
;

147 ià(
tb
[
CTA_IP_V6_SRC
]) {

148 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V6_SRC
], 
AF_INET6
);

149 ià(
addr
 =ğ
NULL
)

150 
”rout_’omem
;

151 
”r
 = 
	`nâl_ù_£t_¤c
(
ù
, 
»¶
, 
addr
);

152 
	`Æ_addr_put
(
addr
);

153 ià(
”r
 < 0)

154 
”rout
;

156 ià(
tb
[
CTA_IP_V6_DST
]) {

157 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V6_DST
], 
AF_INET6
);

158 ià(
addr
 =ğ
NULL
)

159 
”rout_’omem
;

160 
”r
 = 
	`nâl_ù_£t_d¡
(
ù
, 
»¶
, 
addr
);

161 
	`Æ_addr_put
(
addr
);

162 ià(
”r
 < 0)

163 
”rout
;

168 
”rout_’omem
:

169 
”r
 = -
NLE_NOMEM
;

170 
”rout
:

171  
”r
;

172 
	}
}

174 
	$ù_·r£_´Ùo
(
nâl_ù
 *
ù
, 
»¶
, 
Æ©Œ
 *
©Œ
)

176 
Æ©Œ
 *
tb
[
CTA_PROTO_MAX
+1];

177 
”r
;

179 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_PROTO_MAX
, 
©Œ
, 
ù_´Ùo_pŞicy
);

180 ià(
”r
 < 0)

181  
”r
;

183 ià(!
»¶
 && 
tb
[
CTA_PROTO_NUM
])

184 
	`nâl_ù_£t_´Ùo
(
ù
, 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_NUM
]));

185 ià(
tb
[
CTA_PROTO_SRC_PORT
])

186 
	`nâl_ù_£t_¤c_pÜt
(
ù
, 
»¶
,

187 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_SRC_PORT
])));

188 ià(
tb
[
CTA_PROTO_DST_PORT
])

189 
	`nâl_ù_£t_d¡_pÜt
(
ù
, 
»¶
,

190 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_DST_PORT
])));

192 ià(
ù
->
ù_çmy
 =ğ
AF_INET
) {

193 ià(
tb
[
CTA_PROTO_ICMP_ID
])

194 
	`nâl_ù_£t_icmp_id
(
ù
, 
»¶
,

195 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_ICMP_ID
])));

196 ià(
tb
[
CTA_PROTO_ICMP_TYPE
])

197 
	`nâl_ù_£t_icmp_ty³
(
ù
, 
»¶
,

198 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMP_TYPE
]));

199 ià(
tb
[
CTA_PROTO_ICMP_CODE
])

200 
	`nâl_ù_£t_icmp_code
(
ù
, 
»¶
,

201 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMP_CODE
]));

202 } ià(
ù
->
ù_çmy
 =ğ
AF_INET6
) {

203 ià(
tb
[
CTA_PROTO_ICMPV6_ID
])

204 
	`nâl_ù_£t_icmp_id
(
ù
, 
»¶
,

205 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_ICMPV6_ID
])));

206 ià(
tb
[
CTA_PROTO_ICMPV6_TYPE
])

207 
	`nâl_ù_£t_icmp_ty³
(
ù
, 
»¶
,

208 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMPV6_TYPE
]));

209 ià(
tb
[
CTA_PROTO_ICMPV6_CODE
])

210 
	`nâl_ù_£t_icmp_code
(
ù
, 
»¶
,

211 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMPV6_CODE
]));

215 
	}
}

217 
	$ù_·r£_tu¶e
(
nâl_ù
 *
ù
, 
»¶
, 
Æ©Œ
 *
©Œ
)

219 
Æ©Œ
 *
tb
[
CTA_TUPLE_MAX
+1];

220 
”r
;

222 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_TUPLE_MAX
, 
©Œ
, 
ù_tu¶e_pŞicy
);

223 ià(
”r
 < 0)

224  
”r
;

226 ià(
tb
[
CTA_TUPLE_IP
]) {

227 
”r
 = 
	`ù_·r£_
(
ù
, 
»¶
, 
tb
[
CTA_TUPLE_IP
]);

228 ià(
”r
 < 0)

229  
”r
;

232 ià(
tb
[
CTA_TUPLE_PROTO
]) {

233 
”r
 = 
	`ù_·r£_´Ùo
(
ù
, 
»¶
, 
tb
[
CTA_TUPLE_PROTO
]);

234 ià(
”r
 < 0)

235  
”r
;

239 
	}
}

241 
	$ù_·r£_´Ùošfo_tı
(
nâl_ù
 *
ù
, 
Æ©Œ
 *
©Œ
)

243 
Æ©Œ
 *
tb
[
CTA_PROTOINFO_TCP_MAX
+1];

244 
”r
;

246 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_PROTOINFO_TCP_MAX
, 
©Œ
,

247 
ù_´Ùošfo_tı_pŞicy
);

248 ià(
”r
 < 0)

249  
”r
;

251 ià(
tb
[
CTA_PROTOINFO_TCP_STATE
])

252 
	`nâl_ù_£t_tı_¡©e
(
ù
,

253 
	`Æa_g‘_u8
(
tb
[
CTA_PROTOINFO_TCP_STATE
]));

256 
	}
}

258 
	$ù_·r£_´Ùošfo
(
nâl_ù
 *
ù
, 
Æ©Œ
 *
©Œ
)

260 
Æ©Œ
 *
tb
[
CTA_PROTOINFO_MAX
+1];

261 
”r
;

263 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_PROTOINFO_MAX
, 
©Œ
,

264 
ù_´Ùošfo_pŞicy
);

265 ià(
”r
 < 0)

266  
”r
;

268 ià(
tb
[
CTA_PROTOINFO_TCP
]) {

269 
”r
 = 
	`ù_·r£_´Ùošfo_tı
(
ù
, 
tb
[
CTA_PROTOINFO_TCP
]);

270 ià(
”r
 < 0)

271  
”r
;

275 
	}
}

277 
	$ù_·r£_couÁ”s
(
nâl_ù
 *
ù
, 
»¶
, 
Æ©Œ
 *
©Œ
)

279 
Æ©Œ
 *
tb
[
CTA_COUNTERS_MAX
+1];

280 
”r
;

282 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_COUNTERS_MAX
, 
©Œ
, 
ù_couÁ”s_pŞicy
);

283 ià(
”r
 < 0)

284  
”r
;

286 ià(
tb
[
CTA_COUNTERS_PACKETS
])

287 
	`nâl_ù_£t_·ck‘s
(
ù
, 
»¶
,

288 
	`ÁohÎ
(
	`Æa_g‘_u64
(
tb
[
CTA_COUNTERS_PACKETS
])));

289 ià(
tb
[
CTA_COUNTERS32_PACKETS
])

290 
	`nâl_ù_£t_·ck‘s
(
ù
, 
»¶
,

291 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_COUNTERS32_PACKETS
])));

292 ià(
tb
[
CTA_COUNTERS_BYTES
])

293 
	`nâl_ù_£t_by‹s
(
ù
, 
»¶
,

294 
	`ÁohÎ
(
	`Æa_g‘_u64
(
tb
[
CTA_COUNTERS_BYTES
])));

295 ià(
tb
[
CTA_COUNTERS32_BYTES
])

296 
	`nâl_ù_£t_by‹s
(
ù
, 
»¶
,

297 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_COUNTERS32_BYTES
])));

300 
	}
}

302 
	$nâlmsg_ù_group
(
Æmsghdr
 *
Æh
)

304 
	`nâlmsg_subty³
(
Æh
)) {

305 
IPCTNL_MSG_CT_NEW
:

306 ià(
Æh
->
Æmsg_æags
 & (
NLM_F_CREATE
|
NLM_F_EXCL
))

307  
NFNLGRP_CONNTRACK_NEW
;

309  
NFNLGRP_CONNTRACK_UPDATE
;

310 
IPCTNL_MSG_CT_DELETE
:

311  
NFNLGRP_CONNTRACK_DESTROY
;

313  
NFNLGRP_NONE
;

315 
	}
}

317 
	$ù_·r£_time¡amp
(
nâl_ù
 *
ù
, 
Æ©Œ
 *
©Œ
)

319 
Æ©Œ
 *
tb
[
CTA_TIMESTAMP_MAX
 + 1];

320 
”r
;

322 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_TIMESTAMP_MAX
, 
©Œ
,

323 
ù_time¡amp_pŞicy
);

324 ià(
”r
 < 0)

325  
”r
;

327 ià(
tb
[
CTA_TIMESTAMP_START
] &&b[
CTA_TIMESTAMP_STOP
])

328 
	`nâl_ù_£t_time¡amp
(
ù
,

329 
	`ÁohÎ
(
	`Æa_g‘_u64
(
tb
[
CTA_TIMESTAMP_START
])),

330 
	`ÁohÎ
(
	`Æa_g‘_u64
(
tb
[
CTA_TIMESTAMP_STOP
])));

333 
	}
}

335 
	$nâlmsg_ù_·r£
(
Æmsghdr
 *
Æh
, 
nâl_ù
 **
»suÉ
)

337 
nâl_ù
 *
ù
;

338 
Æ©Œ
 *
tb
[
CTA_MAX
+1];

339 
”r
;

341 
ù
 = 
	`nâl_ù_®loc
();

342 ià(!
ù
)

343  -
NLE_NOMEM
;

345 
ù
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

347 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
nfg’msg
), 
tb
, 
CTA_MAX
,

348 
ù_pŞicy
);

349 ià(
”r
 < 0)

350 
”rout
;

352 
	`nâl_ù_£t_çmy
(
ù
, 
	`nâlmsg_çmy
(
Æh
));

354 ià(
tb
[
CTA_TUPLE_ORIG
]) {

355 
”r
 = 
	`ù_·r£_tu¶e
(
ù
, 0, 
tb
[
CTA_TUPLE_ORIG
]);

356 ià(
”r
 < 0)

357 
”rout
;

359 ià(
tb
[
CTA_TUPLE_REPLY
]) {

360 
”r
 = 
	`ù_·r£_tu¶e
(
ù
, 1, 
tb
[
CTA_TUPLE_REPLY
]);

361 ià(
”r
 < 0)

362 
”rout
;

365 ià(
tb
[
CTA_PROTOINFO
]) {

366 
”r
 = 
	`ù_·r£_´Ùošfo
(
ù
, 
tb
[
CTA_PROTOINFO
]);

367 ià(
”r
 < 0)

368 
”rout
;

371 ià(
tb
[
CTA_STATUS
])

372 
	`nâl_ù_£t_¡©us
(
ù
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_STATUS
])));

373 ià(
tb
[
CTA_TIMEOUT
])

374 
	`nâl_ù_£t_timeout
(
ù
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_TIMEOUT
])));

375 ià(
tb
[
CTA_MARK
])

376 
	`nâl_ù_£t_m¬k
(
ù
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_MARK
])));

377 ià(
tb
[
CTA_USE
])

378 
	`nâl_ù_£t_u£
(
ù
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_USE
])));

379 ià(
tb
[
CTA_ID
])

380 
	`nâl_ù_£t_id
(
ù
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_ID
])));

381 ià(
tb
[
CTA_ZONE
])

382 
	`nâl_ù_£t_zÚe
(
ù
, 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_ZONE
])));

384 ià(
tb
[
CTA_COUNTERS_ORIG
]) {

385 
”r
 = 
	`ù_·r£_couÁ”s
(
ù
, 0, 
tb
[
CTA_COUNTERS_ORIG
]);

386 ià(
”r
 < 0)

387 
”rout
;

390 ià(
tb
[
CTA_COUNTERS_REPLY
]) {

391 
”r
 = 
	`ù_·r£_couÁ”s
(
ù
, 1, 
tb
[
CTA_COUNTERS_REPLY
]);

392 ià(
”r
 < 0)

393 
”rout
;

396 ià(
tb
[
CTA_TIMESTAMP
]) {

397 
”r
 = 
	`ù_·r£_time¡amp
(
ù
, 
tb
[
CTA_TIMESTAMP
]);

398 ià(
”r
 < 0)

399 
”rout
;

402 *
»suÉ
 = 
ù
;

405 
”rout
:

406 
	`nâl_ù_put
(
ù
);

407  
”r
;

408 
	}
}

410 
	$ù_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

411 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

413 
nâl_ù
 *
ù
;

414 
”r
;

416 ià((
”r
 = 
	`nâlmsg_ù_·r£
(
Æh
, &
ù
)) < 0)

417  
”r
;

419 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
ù
,…p);

420 
	`nâl_ù_put
(
ù
);

421  
”r
;

422 
	}
}

424 
	$nâl_ù_dump_»que¡
(
Æ_sock
 *
sk
)

426  
	`nâl_£nd_sim¶e
(
sk
, 
NFNL_SUBSYS_CTNETLINK
, 
IPCTNL_MSG_CT_GET
,

427 
NLM_F_DUMP
, 
AF_UNSPEC
, 0);

428 
	}
}

430 
	$ù_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

432  
	`nâl_ù_dump_»que¡
(
sk
);

433 
	}
}

435 
	$nâl_ù_bud_tu¶e
(
Æ_msg
 *
msg
, cÚ¡ 
nâl_ù
 *
ù
,

436 
»¶
)

438 
Æ©Œ
 *
tu¶e
, *

, *
´Ùo
;

439 
Æ_addr
 *
addr
;

440 
çmy
;

442 
çmy
 = 
	`nâl_ù_g‘_çmy
(
ù
);

444 
tu¶e
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
»¶
 ? 
CTA_TUPLE_REPLY
 : 
CTA_TUPLE_ORIG
);

445 ià(!
tu¶e
)

446 
Æa_put_çu»
;

448 

 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_TUPLE_IP
);

449 ià(!

)

450 
Æa_put_çu»
;

452 
addr
 = 
	`nâl_ù_g‘_¤c
(
ù
, 
»¶
);

453 ià(
addr
)

454 
	`NLA_PUT_ADDR
(
msg
,

455 
çmy
 =ğ
AF_INET
 ? 
CTA_IP_V4_SRC
 : 
CTA_IP_V6_SRC
,

456 
addr
);

458 
addr
 = 
	`nâl_ù_g‘_d¡
(
ù
, 
»¶
);

459 ià(
addr
)

460 
	`NLA_PUT_ADDR
(
msg
,

461 
çmy
 =ğ
AF_INET
 ? 
CTA_IP_V4_DST
 : 
CTA_IP_V6_DST
,

462 
addr
);

464 
	`Æa_Ã¡_’d
(
msg
, 

);

466 
´Ùo
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_TUPLE_PROTO
);

467 ià(!
´Ùo
)

468 
Æa_put_çu»
;

470 ià(
	`nâl_ù_‹¡_´Ùo
(
ù
))

471 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_NUM
, 
	`nâl_ù_g‘_´Ùo
(
ù
));

473 ià(
	`nâl_ù_‹¡_¤c_pÜt
(
ù
, 
»¶
))

474 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_SRC_PORT
,

475 
	`htÚs
(
	`nâl_ù_g‘_¤c_pÜt
(
ù
, 
»¶
)));

477 ià(
	`nâl_ù_‹¡_d¡_pÜt
(
ù
, 
»¶
))

478 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_DST_PORT
,

479 
	`htÚs
(
	`nâl_ù_g‘_d¡_pÜt
(
ù
, 
»¶
)));

481 ià(
çmy
 =ğ
AF_INET
) {

482 ià(
	`nâl_ù_‹¡_icmp_id
(
ù
, 
»¶
))

483 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_ICMP_ID
,

484 
	`htÚs
(
	`nâl_ù_g‘_icmp_id
(
ù
, 
»¶
)));

486 ià(
	`nâl_ù_‹¡_icmp_ty³
(
ù
, 
»¶
))

487 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMP_TYPE
,

488 
	`nâl_ù_g‘_icmp_ty³
(
ù
, 
»¶
));

490 ià(
	`nâl_ù_‹¡_icmp_code
(
ù
, 
»¶
))

491 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMP_CODE
,

492 
	`nâl_ù_g‘_icmp_code
(
ù
, 
»¶
));

493 } ià(
çmy
 =ğ
AF_INET6
) {

494 ià(
	`nâl_ù_‹¡_icmp_id
(
ù
, 
»¶
))

495 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_ICMPV6_ID
,

496 
	`htÚs
(
	`nâl_ù_g‘_icmp_id
(
ù
, 
»¶
)));

498 ià(
	`nâl_ù_‹¡_icmp_ty³
(
ù
, 
»¶
))

499 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMPV6_TYPE
,

500 
	`nâl_ù_g‘_icmp_ty³
(
ù
, 
»¶
));

502 ià(
	`nâl_ù_‹¡_icmp_code
(
ù
, 
»¶
))

503 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMPV6_CODE
,

504 
	`nâl_ù_g‘_icmp_code
(
ù
, 
»¶
));

507 
	`Æa_Ã¡_’d
(
msg
, 
´Ùo
);

509 
	`Æa_Ã¡_’d
(
msg
, 
tu¶e
);

512 
Æa_put_çu»
:

513  -
NLE_MSGSIZE
;

514 
	}
}

516 
	$nâl_ù_bud_mes§ge
(cÚ¡ 
nâl_ù
 *
ù
, 
cmd
, 
æags
,

517 
Æ_msg
 **
»suÉ
)

519 
Æ_msg
 *
msg
;

520 
”r
;

522 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_CTNETLINK
, 
cmd
, 
æags
,

523 
	`nâl_ù_g‘_çmy
(
ù
), 0);

524 ià(
msg
 =ğ
NULL
)

525  -
NLE_NOMEM
;

527 ià((
”r
 = 
	`nâl_ù_bud_tu¶e
(
msg
, 
ù
, 0)) < 0)

528 
”r_out
;

532 iàĞ
	`nâl_ù_g‘_¤c
(
ù
, 1è&& 
	`nâl_ù_g‘_d¡
(ct, 1) )

533 ià((
”r
 = 
	`nâl_ù_bud_tu¶e
(
msg
, 
ù
, 1)) < 0)

534 
”r_out
;

536 ià(
	`nâl_ù_‹¡_¡©us
(
ù
))

537 
	`NLA_PUT_U32
(
msg
, 
CTA_STATUS
, 
	`htÚl
(
	`nâl_ù_g‘_¡©us
(
ù
)));

539 ià(
	`nâl_ù_‹¡_timeout
(
ù
))

540 
	`NLA_PUT_U32
(
msg
, 
CTA_TIMEOUT
, 
	`htÚl
(
	`nâl_ù_g‘_timeout
(
ù
)));

542 ià(
	`nâl_ù_‹¡_m¬k
(
ù
))

543 
	`NLA_PUT_U32
(
msg
, 
CTA_MARK
, 
	`htÚl
(
	`nâl_ù_g‘_m¬k
(
ù
)));

545 ià(
	`nâl_ù_‹¡_id
(
ù
))

546 
	`NLA_PUT_U32
(
msg
, 
CTA_ID
, 
	`htÚl
(
	`nâl_ù_g‘_id
(
ù
)));

548 ià(
	`nâl_ù_‹¡_zÚe
(
ù
))

549 
	`NLA_PUT_U16
(
msg
, 
CTA_ZONE
, 
	`htÚs
(
	`nâl_ù_g‘_zÚe
(
ù
)));

551 *
»suÉ
 = 
msg
;

554 
Æa_put_çu»
:

555 
”r_out
:

556 
	`Æmsg_ä“
(
msg
);

557  
”r
;

558 
	}
}

560 
	$nâl_ù_bud_add_»que¡
(cÚ¡ 
nâl_ù
 *
ù
, 
æags
,

561 
Æ_msg
 **
»suÉ
)

563  
	`nâl_ù_bud_mes§ge
(
ù
, 
IPCTNL_MSG_CT_NEW
, 
æags
, 
»suÉ
);

564 
	}
}

566 
	$nâl_ù_add
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_ù
 *
ù
, 
æags
)

568 
Æ_msg
 *
msg
;

569 
”r
;

571 ià((
”r
 = 
	`nâl_ù_bud_add_»que¡
(
ù
, 
æags
, &
msg
)) < 0)

572  
”r
;

574 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

575 
	`Æmsg_ä“
(
msg
);

576 ià(
”r
 < 0)

577  
”r
;

579  
	`wa™_fÜ_ack
(
sk
);

580 
	}
}

582 
	$nâl_ù_bud_d–‘e_»que¡
(cÚ¡ 
nâl_ù
 *
ù
, 
æags
,

583 
Æ_msg
 **
»suÉ
)

585  
	`nâl_ù_bud_mes§ge
(
ù
, 
IPCTNL_MSG_CT_DELETE
, 
æags
, 
»suÉ
);

586 
	}
}

588 
	$nâl_ù_d–
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_ù
 *
ù
, 
æags
)

590 
Æ_msg
 *
msg
;

591 
”r
;

593 ià((
”r
 = 
	`nâl_ù_bud_d–‘e_»que¡
(
ù
, 
æags
, &
msg
)) < 0)

594  
”r
;

596 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

597 
	`Æmsg_ä“
(
msg
);

598 ià(
”r
 < 0)

599  
”r
;

601  
	`wa™_fÜ_ack
(
sk
);

602 
	}
}

604 
	$nâl_ù_bud_qu”y_»que¡
(cÚ¡ 
nâl_ù
 *
ù
, 
æags
,

605 
Æ_msg
 **
»suÉ
)

607  
	`nâl_ù_bud_mes§ge
(
ù
, 
IPCTNL_MSG_CT_GET
, 
æags
, 
»suÉ
);

608 
	}
}

610 
	$nâl_ù_qu”y
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_ù
 *
ù
, 
æags
)

612 
Æ_msg
 *
msg
;

613 
”r
;

615 ià((
”r
 = 
	`nâl_ù_bud_qu”y_»que¡
(
ù
, 
æags
, &
msg
)) < 0)

616  
”r
;

618 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

619 
	`Æmsg_ä“
(
msg
);

620 ià(
”r
 < 0)

621  
”r
;

623  
	`wa™_fÜ_ack
(
sk
);

624 
	}
}

641 
	$nâl_ù_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

643  
	`Æ_ÿche_®loc_ªd_fl
(&
nâl_ù_İs
, 
sk
, 
»suÉ
);

644 
	}
}

655 
Æ_af_group
 
	gù_groups
[] = {

656 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_NEW
 },

657 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_UPDATE
 },

658 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_DESTROY
 },

659 { 
END_OF_GROUP_LIST
 },

662 
	#NFNLMSG_CT_TYPE
(
ty³
è
	`NFNLMSG_TYPE
(
NFNL_SUBSYS_CTNETLINK
, (ty³))

	)

663 
Æ_ÿche_İs
 
	gnâl_ù_İs
 = {

664 .
co_Çme
 = "netfilter/ct",

665 .
	gco_hdrsize
 = 
NFNL_HDRLEN
,

666 .
	gco_msgty³s
 = {

667 { 
NFNLMSG_CT_TYPE
(
IPCTNL_MSG_CT_NEW
), 
NL_ACT_NEW
, "new" },

668 { 
NFNLMSG_CT_TYPE
(
IPCTNL_MSG_CT_GET
), 
NL_ACT_GET
, "get" },

669 { 
NFNLMSG_CT_TYPE
(
IPCTNL_MSG_CT_DELETE
), 
NL_ACT_DEL
, "del" },

670 
END_OF_MSGTYPES_LIST
,

672 .
	gco_´ÙocŞ
 = 
NETLINK_NETFILTER
,

673 .
	gco_groups
 = 
ù_groups
,

674 .
	gco_»que¡_upd©e
 = 
ù_»que¡_upd©e
,

675 .
	gco_msg_·r£r
 = 
ù_msg_·r£r
,

676 .
	gco_obj_İs
 = &
ù_obj_İs
,

679 
__š™
 
	$ù_š™
()

681 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_ù_İs
);

682 
	}
}

684 
__ex™
 
	$ù_ex™
()

686 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_ù_İs
);

687 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/ct_obj.c

14 
	~<sys/ty³s.h
>

15 
	~<lšux/Ãtf‹r/nâ‘lšk_cÚÁ¿ck.h
>

16 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_commÚ.h
>

17 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_tı.h
>

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãtf‹r/nâl.h
>

21 
	~<Ãšk/Ãtf‹r/ù.h
>

24 
	#CT_ATTR_FAMILY
 (1UL << 0)

	)

25 
	#CT_ATTR_PROTO
 (1UL << 1)

	)

27 
	#CT_ATTR_TCP_STATE
 (1UL << 2)

	)

29 
	#CT_ATTR_STATUS
 (1UL << 3)

	)

30 
	#CT_ATTR_TIMEOUT
 (1UL << 4)

	)

31 
	#CT_ATTR_MARK
 (1UL << 5)

	)

32 
	#CT_ATTR_USE
 (1UL << 6)

	)

33 
	#CT_ATTR_ID
 (1UL << 7)

	)

35 
	#CT_ATTR_ORIG_SRC
 (1UL << 8)

	)

36 
	#CT_ATTR_ORIG_DST
 (1UL << 9)

	)

37 
	#CT_ATTR_ORIG_SRC_PORT
 (1UL << 10)

	)

38 
	#CT_ATTR_ORIG_DST_PORT
 (1UL << 11)

	)

39 
	#CT_ATTR_ORIG_ICMP_ID
 (1UL << 12)

	)

40 
	#CT_ATTR_ORIG_ICMP_TYPE
 (1UL << 13)

	)

41 
	#CT_ATTR_ORIG_ICMP_CODE
 (1UL << 14)

	)

42 
	#CT_ATTR_ORIG_PACKETS
 (1UL << 15)

	)

43 
	#CT_ATTR_ORIG_BYTES
 (1UL << 16)

	)

45 
	#CT_ATTR_REPL_SRC
 (1UL << 17)

	)

46 
	#CT_ATTR_REPL_DST
 (1UL << 18)

	)

47 
	#CT_ATTR_REPL_SRC_PORT
 (1UL << 19)

	)

48 
	#CT_ATTR_REPL_DST_PORT
 (1UL << 20)

	)

49 
	#CT_ATTR_REPL_ICMP_ID
 (1UL << 21)

	)

50 
	#CT_ATTR_REPL_ICMP_TYPE
 (1UL << 22)

	)

51 
	#CT_ATTR_REPL_ICMP_CODE
 (1UL << 23)

	)

52 
	#CT_ATTR_REPL_PACKETS
 (1UL << 24)

	)

53 
	#CT_ATTR_REPL_BYTES
 (1UL << 25)

	)

54 
	#CT_ATTR_TIMESTAMP
 (1UL << 26)

	)

55 
	#CT_ATTR_ZONE
 (1UL << 27)

	)

58 
	$ù_ä“_d©a
(
Æ_objeù
 *
c
)

60 
nâl_ù
 *
ù
 = (nâl_ù *è
c
;

62 ià(
ù
 =ğ
NULL
)

65 
	`Æ_addr_put
(
ù
->
ù_Üig
.
¤c
);

66 
	`Æ_addr_put
(
ù
->
ù_Üig
.
d¡
);

67 
	`Æ_addr_put
(
ù
->
ù_»¶
.
¤c
);

68 
	`Æ_addr_put
(
ù
->
ù_»¶
.
d¡
);

69 
	}
}

71 
	$ù_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

73 
nâl_ù
 *
d¡
 = (nâl_ù *è
_d¡
;

74 
nâl_ù
 *
¤c
 = (nâl_ù *è
_¤c
;

75 
Æ_addr
 *
addr
;

77 ià(
¤c
->
ù_Üig
.src) {

78 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
ù_Üig
.src);

79 ià(!
addr
)

80  -
NLE_NOMEM
;

81 
d¡
->
ù_Üig
.
¤c
 = 
addr
;

84 ià(
¤c
->
ù_Üig
.
d¡
) {

85 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
ù_Üig
.
d¡
);

86 ià(!
addr
)

87  -
NLE_NOMEM
;

88 
d¡
->
ù_Üig
.d¡ = 
addr
;

91 ià(
¤c
->
ù_»¶
.src) {

92 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
ù_»¶
.src);

93 ià(!
addr
)

94  -
NLE_NOMEM
;

95 
d¡
->
ù_»¶
.
¤c
 = 
addr
;

98 ià(
¤c
->
ù_»¶
.
d¡
) {

99 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
ù_»¶
.
d¡
);

100 ià(!
addr
)

101  -
NLE_NOMEM
;

102 
d¡
->
ù_»¶
.d¡ = 
addr
;

106 
	}
}

108 
	$dump_addr
(
Æ_dump_·¿ms
 *
p
, 
Æ_addr
 *
addr
, 
pÜt
)

110 
buf
[64];

112 ià(
addr
)

113 
	`Æ_dump
(
p
, "%s", 
	`Æ_addr2¡r
(
addr
, 
buf
, (buf)));

115 ià(
pÜt
)

116 
	`Æ_dump
(
p
, ":%u ", 
pÜt
);

117 ià(
addr
)

118 
	`Æ_dump
(
p
, " ");

119 
	}
}

121 
	$dump_icmp
(
Æ_dump_·¿ms
 *
p
, 
nâl_ù
 *
ù
, 
»¶y
)

123 ià(
	`nâl_ù_‹¡_icmp_ty³
(
ù
, 
»¶y
))

124 
	`Æ_dump
(
p
, "icm°ty³ %d ", 
	`nâl_ù_g‘_icmp_ty³
(
ù
, 
»¶y
));

126 ià(
	`nâl_ù_‹¡_icmp_code
(
ù
, 
»¶y
))

127 
	`Æ_dump
(
p
, "cod%d ", 
	`nâl_ù_g‘_icmp_code
(
ù
, 
»¶y
));

129 ià(
	`nâl_ù_‹¡_icmp_id
(
ù
, 
»¶y
))

130 
	`Æ_dump
(
p
, "id %d ", 
	`nâl_ù_g‘_icmp_id
(
ù
, 
»¶y
));

131 
	}
}

133 
	$ù_dump_tu¶es
(
nâl_ù
 *
ù
, 
Æ_dump_·¿ms
 *
p
)

135 
Æ_addr
 *
Üig_¤c
, *
Üig_d¡
, *
»¶y_¤c
, *
»¶y_d¡
;

136 
Üig_¥Üt
 = 0, 
Üig_dpÜt
 = 0, 
»¶y_¥Üt
 = 0, 
»¶y_dpÜt
 = 0;

137 
sync
 = 0;

139 
Üig_¤c
 = 
	`nâl_ù_g‘_¤c
(
ù
, 0);

140 
Üig_d¡
 = 
	`nâl_ù_g‘_d¡
(
ù
, 0);

141 
»¶y_¤c
 = 
	`nâl_ù_g‘_¤c
(
ù
, 1);

142 
»¶y_d¡
 = 
	`nâl_ù_g‘_d¡
(
ù
, 1);

144 ià(
	`nâl_ù_‹¡_¤c_pÜt
(
ù
, 0))

145 
Üig_¥Üt
 = 
	`nâl_ù_g‘_¤c_pÜt
(
ù
, 0);

147 ià(
	`nâl_ù_‹¡_d¡_pÜt
(
ù
, 0))

148 
Üig_dpÜt
 = 
	`nâl_ù_g‘_d¡_pÜt
(
ù
, 0);

150 ià(
	`nâl_ù_‹¡_¤c_pÜt
(
ù
, 1))

151 
»¶y_¥Üt
 = 
	`nâl_ù_g‘_¤c_pÜt
(
ù
, 1);

153 ià(
	`nâl_ù_‹¡_d¡_pÜt
(
ù
, 1))

154 
»¶y_dpÜt
 = 
	`nâl_ù_g‘_d¡_pÜt
(
ù
, 1);

156 ià(
Üig_¤c
 && 
Üig_d¡
 && 
»¶y_¤c
 && 
»¶y_d¡
 &&

157 
Üig_¥Üt
 =ğ
»¶y_dpÜt
 && 
Üig_dpÜt
 =ğ
»¶y_¥Üt
 &&

158 !
	`Æ_addr_cmp
(
Üig_¤c
, 
»¶y_d¡
) &&

159 !
	`Æ_addr_cmp
(
Üig_d¡
, 
»¶y_¤c
))

160 
sync
 = 1;

162 
	`dump_addr
(
p
, 
Üig_¤c
, 
Üig_¥Üt
);

163 
	`Æ_dump
(
p
, 
sync
 ? "<-> " : "-> ");

164 
	`dump_addr
(
p
, 
Üig_d¡
, 
Üig_dpÜt
);

165 
	`dump_icmp
(
p
, 
ù
, 0);

167 ià(!
sync
) {

168 
	`dump_addr
(
p
, 
»¶y_¤c
, 
»¶y_¥Üt
);

169 
	`Æ_dump
(
p
, "<- ");

170 
	`dump_addr
(
p
, 
»¶y_d¡
, 
»¶y_dpÜt
);

171 
	`dump_icmp
(
p
, 
ù
, 1);

173 
	}
}

176 
	$ù_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

178 
nâl_ù
 *
ù
 = (nâl_ù *è
a
;

179 
buf
[64];

181 
	`Æ_Ãw_lše
(
p
);

183 ià(
	`nâl_ù_‹¡_´Ùo
(
ù
))

184 
	`Æ_dump
(
p
, "%s ",

185 
	`Æ__´Ùo2¡r
(
	`nâl_ù_g‘_´Ùo
(
ù
), 
buf
, (buf)));

187 ià(
	`nâl_ù_‹¡_tı_¡©e
(
ù
))

188 
	`Æ_dump
(
p
, "%s ",

189 
	`nâl_ù_tı_¡©e2¡r
(
	`nâl_ù_g‘_tı_¡©e
(
ù
),

190 
buf
, (buf)));

192 
	`ù_dump_tu¶es
(
ù
, 
p
);

194 ià(
	`nâl_ù_‹¡_m¬k
(
ù
è&& 
	`nâl_ù_g‘_m¬k
(ct))

195 
	`Æ_dump
(
p
, "m¬k %u ", 
	`nâl_ù_g‘_m¬k
(
ù
));

197 ià(
	`nâl_ù_‹¡_zÚe
(
ù
))

198 
	`Æ_dump
(
p
, "zÚ%hu ", 
	`nâl_ù_g‘_zÚe
(
ù
));

200 ià(
	`nâl_ù_‹¡_time¡amp
(
ù
)) {

201 cÚ¡ 
nâl_ù_time¡amp
 *
t¡amp
 = 
	`nâl_ù_g‘_time¡amp
(
ù
);

202 
št64_t
 
d–_time
 = 
t¡amp
->
¡İ
 -¡amp->
¡¬t
;

204 ià(
d–_time
 > 0)

205 
d–_time
 /ğ
NSEC_PER_SEC
;

207 
d–_time
 = 0;

208 
	`Æ_dump
(
p
, "d–-tim%Îu ", 
d–_time
);

211 
	`Æ_dump
(
p
, "\n");

212 
	}
}

214 
	$ù_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

216 
nâl_ù
 *
ù
 = (nâl_ù *è
a
;

217 
buf
[64];

218 
å
 = 0;

220 
	`ù_dump_lše
(
a
, 
p
);

222 
	`Æ_dump
(
p
, " id 0x%x ", 
ù
->
ù_id
);

223 
	`Æ_dump_lše
(
p
, "family %s ",

224 
	`Æ_af2¡r
(
ù
->
ù_çmy
, 
buf
, (buf)));

226 ià(
	`nâl_ù_‹¡_u£
(
ù
))

227 
	`Æ_dump
(
p
, "»fúˆ%u ", 
	`nâl_ù_g‘_u£
(
ù
));

229 ià(
	`nâl_ù_‹¡_timeout
(
ù
)) {

230 
ušt64_t
 
timeout_ms
 = 
	`nâl_ù_g‘_timeout
(
ù
) * 1000UL;

231 
	`Æ_dump
(
p
, "timeout %s ",

232 
	`Æ_m£c2¡r
(
timeout_ms
, 
buf
, (buf)));

235 ià(
ù
->
ù_¡©us
)

236 
	`Æ_dump
(
p
, "<");

238 
	#PRINT_FLAG
(
¡r
) \

239 { 
	`Æ_dump
(
p
, "%s%s", 
å
++ ? "," : "", (
¡r
)); }

	)

241 ià(
ù
->
ù_¡©us
 & 
IPS_EXPECTED
)

242 
	`PRINT_FLAG
("EXPECTED");

243 ià(!(
ù
->
ù_¡©us
 & 
IPS_SEEN_REPLY
))

244 
	`PRINT_FLAG
("NOREPLY");

245 ià(
ù
->
ù_¡©us
 & 
IPS_ASSURED
)

246 
	`PRINT_FLAG
("ASSURED");

247 ià(!(
ù
->
ù_¡©us
 & 
IPS_CONFIRMED
))

248 
	`PRINT_FLAG
("NOTSENT");

249 ià(
ù
->
ù_¡©us
 & 
IPS_SRC_NAT
)

250 
	`PRINT_FLAG
("SNAT");

251 ià(
ù
->
ù_¡©us
 & 
IPS_DST_NAT
)

252 
	`PRINT_FLAG
("DNAT");

253 ià(
ù
->
ù_¡©us
 & 
IPS_SEQ_ADJUST
)

254 
	`PRINT_FLAG
("SEQADJUST");

255 ià(!(
ù
->
ù_¡©us
 & 
IPS_SRC_NAT_DONE
))

256 
	`PRINT_FLAG
("SNAT_INIT");

257 ià(!(
ù
->
ù_¡©us
 & 
IPS_DST_NAT_DONE
))

258 
	`PRINT_FLAG
("DNAT_INIT");

259 ià(
ù
->
ù_¡©us
 & 
IPS_DYING
)

260 
	`PRINT_FLAG
("DYING");

261 ià(
ù
->
ù_¡©us
 & 
IPS_FIXED_TIMEOUT
)

262 
	`PRINT_FLAG
("FIXED_TIMEOUT");

263 #undeà
PRINT_FLAG


265 ià(
ù
->
ù_¡©us
)

266 
	`Æ_dump
(
p
, ">");

267 
	`Æ_dump
(
p
, "\n");

268 
	}
}

270 
	$ù_dump_¡©s
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

272 
nâl_ù
 *
ù
 = (nâl_ù *è
a
;

273 
»s
;

274 *
un™
;

275 
ušt64_t
 
·ck‘s
;

276 cÚ¡ * cÚ¡ 
Çmes
[] = {"rx", "tx"};

277 
i
;

279 
	`ù_dump_d‘as
(
a
, 
p
);

281 ià(!
	`nâl_ù_‹¡_by‹s
(
ù
, 0) ||

282 !
	`nâl_ù_‹¡_·ck‘s
(
ù
, 0) ||

283 !
	`nâl_ù_‹¡_by‹s
(
ù
, 1) ||

284 !
	`nâl_ù_‹¡_·ck‘s
(
ù
, 1))

286 
	`Æ_dump_lše
(
p
, " Statistics‡re‚ot‡vailable.\n");

287 
	`Æ_dump_lše
(
p
, " Please set sysctl‚et.netfilter.nf_conntrack_acct=1\n");

288 
	`Æ_dump_lše
(
p
, " (Require kernel 2.6.27)\n");

292 
	`Æ_dump_lše
(
p
, " #…ackets volume\n");

293 
i
=0; i<=1; i++) {

294 
»s
 = 
	`Æ_ÿnûl_down_by‹s
(
	`nâl_ù_g‘_by‹s
(
ù
, 
i
), &
un™
);

295 
·ck‘s
 = 
	`nâl_ù_g‘_·ck‘s
(
ù
, 
i
);

296 
	`Æ_dump_lše
(
p
, " % %10" 
PRIu64
 " %7.2à%s\n", 
Çmes
[
i
], 
·ck‘s
, 
»s
, 
un™
);

298 
	}
}

300 
	$ù_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

301 
ušt32_t
 
©Œs
, 
æags
)

303 
nâl_ù
 *
a
 = (nâl_ù *è
_a
;

304 
nâl_ù
 *
b
 = (nâl_ù *è
_b
;

305 
diff
 = 0;

307 
	#CT_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
CT_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

308 
	#CT_DIFF_VAL
(
ATTR
, 
FIELD
è
	`CT_DIFF
(ATTR, 
a
->FIELD !ğ
b
->FIELD)

	)

309 
	#CT_DIFF_ADDR
(
ATTR
, 
FIELD
) \

310 ((
æags
 & 
LOOSE_COMPARISON
) \

311 ? 
	`CT_DIFF
(
ATTR
, 
	`Æ_addr_cmp_´efix
(
a
->
FIELD
, 
b
->FIELD)) \

312 : 
	`CT_DIFF
(
ATTR
, 
	`Æ_addr_cmp
(
a
->
FIELD
, 
b
->FIELD)))

	)

314 
diff
 |ğ
	`CT_DIFF_VAL
(
FAMILY
, 
ù_çmy
);

315 
diff
 |ğ
	`CT_DIFF_VAL
(
PROTO
, 
ù_´Ùo
);

316 
diff
 |ğ
	`CT_DIFF_VAL
(
TCP_STATE
, 
ù_´Ùošfo
.
tı
.
¡©e
);

317 
diff
 |ğ
	`CT_DIFF_VAL
(
TIMEOUT
, 
ù_timeout
);

318 
diff
 |ğ
	`CT_DIFF_VAL
(
MARK
, 
ù_m¬k
);

319 
diff
 |ğ
	`CT_DIFF_VAL
(
USE
, 
ù_u£
);

320 
diff
 |ğ
	`CT_DIFF_VAL
(
ID
, 
ù_id
);

321 
diff
 |ğ
	`CT_DIFF_ADDR
(
ORIG_SRC
, 
ù_Üig
.
¤c
);

322 
diff
 |ğ
	`CT_DIFF_ADDR
(
ORIG_DST
, 
ù_Üig
.
d¡
);

323 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_SRC_PORT
, 
ù_Üig
.
´Ùo
.
pÜt
.
¤c
);

324 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_DST_PORT
, 
ù_Üig
.
´Ùo
.
pÜt
.
d¡
);

325 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_ICMP_ID
, 
ù_Üig
.
´Ùo
.
icmp
.
id
);

326 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_ICMP_TYPE
, 
ù_Üig
.
´Ùo
.
icmp
.
ty³
);

327 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_ICMP_CODE
, 
ù_Üig
.
´Ùo
.
icmp
.
code
);

328 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_PACKETS
, 
ù_Üig
.
·ck‘s
);

329 
diff
 |ğ
	`CT_DIFF_VAL
(
ORIG_BYTES
, 
ù_Üig
.
by‹s
);

330 
diff
 |ğ
	`CT_DIFF_ADDR
(
REPL_SRC
, 
ù_»¶
.
¤c
);

331 
diff
 |ğ
	`CT_DIFF_ADDR
(
REPL_DST
, 
ù_»¶
.
d¡
);

332 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_SRC_PORT
, 
ù_»¶
.
´Ùo
.
pÜt
.
¤c
);

333 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_DST_PORT
, 
ù_»¶
.
´Ùo
.
pÜt
.
d¡
);

334 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_ICMP_ID
, 
ù_»¶
.
´Ùo
.
icmp
.
id
);

335 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_ICMP_TYPE
, 
ù_»¶
.
´Ùo
.
icmp
.
ty³
);

336 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_ICMP_CODE
, 
ù_»¶
.
´Ùo
.
icmp
.
code
);

337 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_PACKETS
, 
ù_»¶
.
·ck‘s
);

338 
diff
 |ğ
	`CT_DIFF_VAL
(
REPL_BYTES
, 
ù_»¶
.
by‹s
);

340 ià(
æags
 & 
LOOSE_COMPARISON
)

341 
diff
 |ğ
	`CT_DIFF
(
STATUS
, (
a
->
ù_¡©us
 ^ 
b
->ct_status) &

342 
b
->
ù_¡©us_mask
);

344 
diff
 |ğ
	`CT_DIFF
(
STATUS
, 
a
->
ù_¡©us
 !ğ
b
->ct_status);

346 #undeà
CT_DIFF


347 #undeà
CT_DIFF_VAL


348 #undeà
CT_DIFF_ADDR


350  
diff
;

351 
	}
}

353 cÚ¡ 
Œªs_tbl
 
	gù_©Œs
[] = {

354 
__ADD
(
CT_ATTR_FAMILY
, 
çmy
)

355 
__ADD
(
CT_ATTR_PROTO
, 
´Ùo
)

356 
__ADD
(
CT_ATTR_TCP_STATE
, 
tı¡©e
)

357 
__ADD
(
CT_ATTR_STATUS
, 
¡©us
)

358 
__ADD
(
CT_ATTR_TIMEOUT
, 
timeout
)

359 
__ADD
(
CT_ATTR_MARK
, 
m¬k
)

360 
__ADD
(
CT_ATTR_USE
, 
u£
)

361 
__ADD
(
CT_ATTR_ID
, 
id
)

362 
__ADD
(
CT_ATTR_ORIG_SRC
, 
Üig¤c
)

363 
__ADD
(
CT_ATTR_ORIG_DST
, 
Üigd¡
)

364 
__ADD
(
CT_ATTR_ORIG_SRC_PORT
, 
Üig¤ıÜt
)

365 
__ADD
(
CT_ATTR_ORIG_DST_PORT
, 
Üigd¡pÜt
)

366 
__ADD
(
CT_ATTR_ORIG_ICMP_ID
, 
Üigicmpid
)

367 
__ADD
(
CT_ATTR_ORIG_ICMP_TYPE
, 
Üigicm±y³
)

368 
__ADD
(
CT_ATTR_ORIG_ICMP_CODE
, 
Üigicmpcode
)

369 
__ADD
(
CT_ATTR_ORIG_PACKETS
, 
Üig·ck‘s
)

370 
__ADD
(
CT_ATTR_ORIG_BYTES
, 
Üigby‹s
)

371 
__ADD
(
CT_ATTR_REPL_SRC
, 
»¶y¤c
)

372 
__ADD
(
CT_ATTR_REPL_DST
, 
»¶yd¡
)

373 
__ADD
(
CT_ATTR_REPL_SRC_PORT
, 
»¶y¤ıÜt
)

374 
__ADD
(
CT_ATTR_REPL_DST_PORT
, 
»¶yd¡pÜt
)

375 
__ADD
(
CT_ATTR_REPL_ICMP_ID
, 
»¶yicmpid
)

376 
__ADD
(
CT_ATTR_REPL_ICMP_TYPE
, 
»¶yicm±y³
)

377 
__ADD
(
CT_ATTR_REPL_ICMP_CODE
, 
»¶yicmpcode
)

378 
__ADD
(
CT_ATTR_REPL_PACKETS
, 
»¶y·ck‘s
)

379 
__ADD
(
CT_ATTR_REPL_BYTES
, 
»¶yby‹s
)

382 *
	$ù_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

384  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
ù_©Œs
, 
	`ARRAY_SIZE
(ct_attrs));

385 
	}
}

392 
nâl_ù
 *
	$nâl_ù_®loc
()

394  (
nâl_ù
 *è
	`Æ_objeù_®loc
(&
ù_obj_İs
);

395 
	}
}

397 
	$nâl_ù_g‘
(
nâl_ù
 *
ù
)

399 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
ù
);

400 
	}
}

402 
	$nâl_ù_put
(
nâl_ù
 *
ù
)

404 
	`Æ_objeù_put
((
Æ_objeù
 *è
ù
);

405 
	}
}

414 
	$nâl_ù_£t_çmy
(
nâl_ù
 *
ù
, 
ušt8_t
 
çmy
)

416 
ù
->
ù_çmy
 = 
çmy
;

417 
ù
->
û_mask
 |ğ
CT_ATTR_FAMILY
;

418 
	}
}

420 
ušt8_t
 
	$nâl_ù_g‘_çmy
(cÚ¡ 
nâl_ù
 *
ù
)

422 ià(
ù
->
û_mask
 & 
CT_ATTR_FAMILY
)

423  
ù
->
ù_çmy
;

425  
AF_UNSPEC
;

426 
	}
}

428 
	$nâl_ù_£t_´Ùo
(
nâl_ù
 *
ù
, 
ušt8_t
 
´Ùo
)

430 
ù
->
ù_´Ùo
 = 
´Ùo
;

431 
ù
->
û_mask
 |ğ
CT_ATTR_PROTO
;

432 
	}
}

434 
	$nâl_ù_‹¡_´Ùo
(cÚ¡ 
nâl_ù
 *
ù
)

436  !!(
ù
->
û_mask
 & 
CT_ATTR_PROTO
);

437 
	}
}

439 
ušt8_t
 
	$nâl_ù_g‘_´Ùo
(cÚ¡ 
nâl_ù
 *
ù
)

441  
ù
->
ù_´Ùo
;

442 
	}
}

444 
	$nâl_ù_£t_tı_¡©e
(
nâl_ù
 *
ù
, 
ušt8_t
 
¡©e
)

446 
ù
->
ù_´Ùošfo
.
tı
.
¡©e
 = state;

447 
ù
->
û_mask
 |ğ
CT_ATTR_TCP_STATE
;

448 
	}
}

450 
	$nâl_ù_‹¡_tı_¡©e
(cÚ¡ 
nâl_ù
 *
ù
)

452  !!(
ù
->
û_mask
 & 
CT_ATTR_TCP_STATE
);

453 
	}
}

455 
ušt8_t
 
	$nâl_ù_g‘_tı_¡©e
(cÚ¡ 
nâl_ù
 *
ù
)

457  
ù
->
ù_´Ùošfo
.
tı
.
¡©e
;

458 
	}
}

460 cÚ¡ 
Œªs_tbl
 
	gtı_¡©es
[] = {

461 
__ADD
(
TCP_CONNTRACK_NONE
,
NONE
)

462 
__ADD
(
TCP_CONNTRACK_SYN_SENT
,
SYN_SENT
)

463 
__ADD
(
TCP_CONNTRACK_SYN_RECV
,
SYN_RECV
)

464 
__ADD
(
TCP_CONNTRACK_ESTABLISHED
,
ESTABLISHED
)

465 
__ADD
(
TCP_CONNTRACK_FIN_WAIT
,
FIN_WAIT
)

466 
__ADD
(
TCP_CONNTRACK_CLOSE_WAIT
,
CLOSE_WAIT
)

467 
__ADD
(
TCP_CONNTRACK_LAST_ACK
,
LAST_ACK
)

468 
__ADD
(
TCP_CONNTRACK_TIME_WAIT
,
TIME_WAIT
)

469 
__ADD
(
TCP_CONNTRACK_CLOSE
,
CLOSE
)

470 
__ADD
(
TCP_CONNTRACK_LISTEN
,
LISTEN
)

473 *
	$nâl_ù_tı_¡©e2¡r
(
ušt8_t
 
¡©e
, *
buf
, 
size_t
 
Ën
)

475  
	`__ty³2¡r
(
¡©e
, 
buf
, 
Ën
, 
tı_¡©es
, 
	`ARRAY_SIZE
(tcp_states));

476 
	}
}

478 
	$nâl_ù_¡r2tı_¡©e
(cÚ¡ *
Çme
)

480  
	`__¡r2ty³
(
Çme
, 
tı_¡©es
, 
	`ARRAY_SIZE
(tcp_states));

481 
	}
}

483 
	$nâl_ù_£t_¡©us
(
nâl_ù
 *
ù
, 
ušt32_t
 
¡©us
)

485 
ù
->
ù_¡©us_mask
 |ğ
¡©us
;

486 
ù
->
ù_¡©us
 |ğ
¡©us
;

487 
ù
->
û_mask
 |ğ
CT_ATTR_STATUS
;

488 
	}
}

490 
	$nâl_ù_un£t_¡©us
(
nâl_ù
 *
ù
, 
ušt32_t
 
¡©us
)

492 
ù
->
ù_¡©us_mask
 |ğ
¡©us
;

493 
ù
->
ù_¡©us
 &ğ~
¡©us
;

494 
ù
->
û_mask
 |ğ
CT_ATTR_STATUS
;

495 
	}
}

497 
	$nâl_ù_‹¡_¡©us
(cÚ¡ 
nâl_ù
 *
ù
)

499  !!(
ù
->
û_mask
 & 
CT_ATTR_STATUS
);

500 
	}
}

502 
ušt32_t
 
	$nâl_ù_g‘_¡©us
(cÚ¡ 
nâl_ù
 *
ù
)

504  
ù
->
ù_¡©us
;

505 
	}
}

507 cÚ¡ 
Œªs_tbl
 
	g¡©us_æags
[] = {

508 
__ADD
(
IPS_EXPECTED
, 
ex³ùed
)

509 
__ADD
(
IPS_SEEN_REPLY
, 
£’_»¶y
)

510 
__ADD
(
IPS_ASSURED
, 
assu»d
)

511 
__ADD
(
IPS_CONFIRMED
, 
cÚfœmed
)

512 
__ADD
(
IPS_SRC_NAT
, 
¢©
)

513 
__ADD
(
IPS_DST_NAT
, 
dÇt
)

514 
__ADD
(
IPS_SEQ_ADJUST
, 
£qadju¡
)

515 
__ADD
(
IPS_SRC_NAT_DONE
, 
¢©_dÚe
)

516 
__ADD
(
IPS_DST_NAT_DONE
, 
dÇt_dÚe
)

517 
__ADD
(
IPS_DYING
, 
dyšg
)

518 
__ADD
(
IPS_FIXED_TIMEOUT
, 
fixed_timeout
)

521 * 
	$nâl_ù_¡©us2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

523  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
¡©us_æags
,

524 
	`ARRAY_SIZE
(
¡©us_æags
));

525 
	}
}

527 
	$nâl_ù_¡r2¡©us
(cÚ¡ *
Çme
)

529  
	`__¡r2æags
(
Çme
, 
¡©us_æags
, 
	`ARRAY_SIZE
(status_flags));

530 
	}
}

532 
	$nâl_ù_£t_timeout
(
nâl_ù
 *
ù
, 
ušt32_t
 
timeout
)

534 
ù
->
ù_timeout
 = 
timeout
;

535 
ù
->
û_mask
 |ğ
CT_ATTR_TIMEOUT
;

536 
	}
}

538 
	$nâl_ù_‹¡_timeout
(cÚ¡ 
nâl_ù
 *
ù
)

540  !!(
ù
->
û_mask
 & 
CT_ATTR_TIMEOUT
);

541 
	}
}

543 
ušt32_t
 
	$nâl_ù_g‘_timeout
(cÚ¡ 
nâl_ù
 *
ù
)

545  
ù
->
ù_timeout
;

546 
	}
}

548 
	$nâl_ù_£t_m¬k
(
nâl_ù
 *
ù
, 
ušt32_t
 
m¬k
)

550 
ù
->
ù_m¬k
 = 
m¬k
;

551 
ù
->
û_mask
 |ğ
CT_ATTR_MARK
;

552 
	}
}

554 
	$nâl_ù_‹¡_m¬k
(cÚ¡ 
nâl_ù
 *
ù
)

556  !!(
ù
->
û_mask
 & 
CT_ATTR_MARK
);

557 
	}
}

559 
ušt32_t
 
	$nâl_ù_g‘_m¬k
(cÚ¡ 
nâl_ù
 *
ù
)

561  
ù
->
ù_m¬k
;

562 
	}
}

564 
	$nâl_ù_£t_u£
(
nâl_ù
 *
ù
, 
ušt32_t
 
u£
)

566 
ù
->
ù_u£
 = 
u£
;

567 
ù
->
û_mask
 |ğ
CT_ATTR_USE
;

568 
	}
}

570 
	$nâl_ù_‹¡_u£
(cÚ¡ 
nâl_ù
 *
ù
)

572  !!(
ù
->
û_mask
 & 
CT_ATTR_USE
);

573 
	}
}

575 
ušt32_t
 
	$nâl_ù_g‘_u£
(cÚ¡ 
nâl_ù
 *
ù
)

577  
ù
->
ù_u£
;

578 
	}
}

580 
	$nâl_ù_£t_id
(
nâl_ù
 *
ù
, 
ušt32_t
 
id
)

582 
ù
->
ù_id
 = 
id
;

583 
ù
->
û_mask
 |ğ
CT_ATTR_ID
;

584 
	}
}

586 
	$nâl_ù_‹¡_id
(cÚ¡ 
nâl_ù
 *
ù
)

588  !!(
ù
->
û_mask
 & 
CT_ATTR_ID
);

589 
	}
}

591 
ušt32_t
 
	$nâl_ù_g‘_id
(cÚ¡ 
nâl_ù
 *
ù
)

593  
ù
->
ù_id
;

594 
	}
}

596 
	$nâl_ù_£t_zÚe
(
nâl_ù
 *
ù
, 
ušt16_t
 
zÚe
)

598 
ù
->
ù_zÚe
 = 
zÚe
;

599 
ù
->
û_mask
 |ğ
CT_ATTR_ZONE
;

600 
	}
}

602 
	$nâl_ù_‹¡_zÚe
(cÚ¡ 
nâl_ù
 *
ù
)

604  !!(
ù
->
û_mask
 & 
CT_ATTR_ZONE
);

605 
	}
}

607 
ušt16_t
 
	$nâl_ù_g‘_zÚe
(cÚ¡ 
nâl_ù
 *
ù
)

609  
ù
->
ù_zÚe
;

610 
	}
}

612 
	$ù_£t_addr
(
nâl_ù
 *
ù
, 
Æ_addr
 *
addr
,

613 
©Œ
, 
Æ_addr
 ** 
ù_addr
)

615 ià(
ù
->
û_mask
 & 
CT_ATTR_FAMILY
) {

616 ià(
addr
->
a_çmy
 !ğ
ù
->
ù_çmy
)

617  -
NLE_AF_MISMATCH
;

619 
	`nâl_ù_£t_çmy
(
ù
, 
addr
->
a_çmy
);

621 ià(*
ù_addr
)

622 
	`Æ_addr_put
(*
ù_addr
);

624 
	`Æ_addr_g‘
(
addr
);

625 *
ù_addr
 = 
addr
;

626 
ù
->
û_mask
 |ğ
©Œ
;

629 
	}
}

631 
	$nâl_ù_£t_¤c
(
nâl_ù
 *
ù
, 
»¶
, 
Æ_addr
 *
addr
)

633 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

634 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_SRC
 : 
CT_ATTR_ORIG_SRC
;

635  
	`ù_£t_addr
(
ù
, 
addr
, 
©Œ
, &
dœ
->
¤c
);

636 
	}
}

638 
	$nâl_ù_£t_d¡
(
nâl_ù
 *
ù
, 
»¶
, 
Æ_addr
 *
addr
)

640 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

641 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_DST
 : 
CT_ATTR_ORIG_DST
;

642  
	`ù_£t_addr
(
ù
, 
addr
, 
©Œ
, &
dœ
->
d¡
);

643 
	}
}

645 
Æ_addr
 *
	$nâl_ù_g‘_¤c
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

647 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

648 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_SRC
 : 
CT_ATTR_ORIG_SRC
;

649 ià(!(
ù
->
û_mask
 & 
©Œ
))

650  
NULL
;

651  
dœ
->
¤c
;

652 
	}
}

654 
Æ_addr
 *
	$nâl_ù_g‘_d¡
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

656 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

657 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_DST
 : 
CT_ATTR_ORIG_DST
;

658 ià(!(
ù
->
û_mask
 & 
©Œ
))

659  
NULL
;

660  
dœ
->
d¡
;

661 
	}
}

663 
	$nâl_ù_£t_¤c_pÜt
(
nâl_ù
 *
ù
, 
»¶
, 
ušt16_t
 
pÜt
)

665 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

666 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_SRC_PORT
 : 
CT_ATTR_ORIG_SRC_PORT
;

668 
dœ
->
´Ùo
.
pÜt
.
¤c
 =…ort;

669 
ù
->
û_mask
 |ğ
©Œ
;

670 
	}
}

672 
	$nâl_ù_‹¡_¤c_pÜt
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

674 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_SRC_PORT
 : 
CT_ATTR_ORIG_SRC_PORT
;

675  !!(
ù
->
û_mask
 & 
©Œ
);

676 
	}
}

678 
ušt16_t
 
	$nâl_ù_g‘_¤c_pÜt
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

680 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

682  
dœ
->
´Ùo
.
pÜt
.
¤c
;

683 
	}
}

685 
	$nâl_ù_£t_d¡_pÜt
(
nâl_ù
 *
ù
, 
»¶
, 
ušt16_t
 
pÜt
)

687 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

688 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_DST_PORT
 : 
CT_ATTR_ORIG_DST_PORT
;

690 
dœ
->
´Ùo
.
pÜt
.
d¡
 =…ort;

691 
ù
->
û_mask
 |ğ
©Œ
;

692 
	}
}

694 
	$nâl_ù_‹¡_d¡_pÜt
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

696 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_DST_PORT
 : 
CT_ATTR_ORIG_DST_PORT
;

697  !!(
ù
->
û_mask
 & 
©Œ
);

698 
	}
}

700 
ušt16_t
 
	$nâl_ù_g‘_d¡_pÜt
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

702 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

704  
dœ
->
´Ùo
.
pÜt
.
d¡
;

705 
	}
}

707 
	$nâl_ù_£t_icmp_id
(
nâl_ù
 *
ù
, 
»¶
, 
ušt16_t
 
id
)

709 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

710 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_ID
 : 
CT_ATTR_ORIG_ICMP_ID
;

712 
dœ
->
´Ùo
.
icmp
.
id
 = id;

713 
ù
->
û_mask
 |ğ
©Œ
;

714 
	}
}

716 
	$nâl_ù_‹¡_icmp_id
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

718 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_ID
 : 
CT_ATTR_ORIG_ICMP_ID
;

719  !!(
ù
->
û_mask
 & 
©Œ
);

720 
	}
}

722 
ušt16_t
 
	$nâl_ù_g‘_icmp_id
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

724 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

726  
dœ
->
´Ùo
.
icmp
.
id
;

727 
	}
}

729 
	$nâl_ù_£t_icmp_ty³
(
nâl_ù
 *
ù
, 
»¶
, 
ušt8_t
 
ty³
)

731 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

732 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_TYPE
 : 
CT_ATTR_ORIG_ICMP_TYPE
;

734 
dœ
->
´Ùo
.
icmp
.
ty³
 =ype;

735 
ù
->
û_mask
 |ğ
©Œ
;

736 
	}
}

738 
	$nâl_ù_‹¡_icmp_ty³
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

740 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_TYPE
 : 
CT_ATTR_ORIG_ICMP_TYPE
;

741  !!(
ù
->
û_mask
 & 
©Œ
);

742 
	}
}

744 
ušt8_t
 
	$nâl_ù_g‘_icmp_ty³
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

746 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

748  
dœ
->
´Ùo
.
icmp
.
ty³
;

749 
	}
}

751 
	$nâl_ù_£t_icmp_code
(
nâl_ù
 *
ù
, 
»¶
, 
ušt8_t
 
code
)

753 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

754 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_CODE
 : 
CT_ATTR_ORIG_ICMP_CODE
;

756 
dœ
->
´Ùo
.
icmp
.
code
 = code;

757 
ù
->
û_mask
 |ğ
©Œ
;

758 
	}
}

760 
	$nâl_ù_‹¡_icmp_code
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

762 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_ICMP_CODE
 : 
CT_ATTR_ORIG_ICMP_CODE
;

763  !!(
ù
->
û_mask
 & 
©Œ
);

764 
	}
}

766 
ušt8_t
 
	$nâl_ù_g‘_icmp_code
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

768 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

770  
dœ
->
´Ùo
.
icmp
.
code
;

771 
	}
}

773 
	$nâl_ù_£t_·ck‘s
(
nâl_ù
 *
ù
, 
»¶
, 
ušt64_t
 
·ck‘s
)

775 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

776 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_PACKETS
 : 
CT_ATTR_ORIG_PACKETS
;

778 
dœ
->
·ck‘s
 =…ackets;

779 
ù
->
û_mask
 |ğ
©Œ
;

780 
	}
}

782 
	$nâl_ù_‹¡_·ck‘s
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

784 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_PACKETS
 : 
CT_ATTR_ORIG_PACKETS
;

785  !!(
ù
->
û_mask
 & 
©Œ
);

786 
	}
}

788 
ušt64_t
 
	$nâl_ù_g‘_·ck‘s
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

790 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

792  
dœ
->
·ck‘s
;

793 
	}
}

795 
	$nâl_ù_£t_by‹s
(
nâl_ù
 *
ù
, 
»¶
, 
ušt64_t
 
by‹s
)

797 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

798 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_BYTES
 : 
CT_ATTR_ORIG_BYTES
;

800 
dœ
->
by‹s
 = bytes;

801 
ù
->
û_mask
 |ğ
©Œ
;

802 
	}
}

804 
	$nâl_ù_‹¡_by‹s
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

806 
©Œ
 = 
»¶
 ? 
CT_ATTR_REPL_BYTES
 : 
CT_ATTR_ORIG_BYTES
;

807  !!(
ù
->
û_mask
 & 
©Œ
);

808 
	}
}

810 
ušt64_t
 
	$nâl_ù_g‘_by‹s
(cÚ¡ 
nâl_ù
 *
ù
, 
»¶
)

812 cÚ¡ 
nâl_ù_dœ
 *
dœ
 = 
»¶
 ? &
ù
->
ù_»¶
 : &ù->
ù_Üig
;

814  
dœ
->
by‹s
;

815 
	}
}

817 
	$nâl_ù_£t_time¡amp
(
nâl_ù
 *
ù
, 
ušt64_t
 
¡¬t
, ušt64_ˆ
¡İ
)

819 
ù
->
ù_t¡amp
.
¡¬t
 = start;

820 
ù
->
ù_t¡amp
.
¡İ
 = stop;

821 
ù
->
û_mask
 |ğ
CT_ATTR_TIMESTAMP
;

822 
	}
}

824 
	$nâl_ù_‹¡_time¡amp
(cÚ¡ 
nâl_ù
 *
ù
)

826  !!(
ù
->
û_mask
 & 
CT_ATTR_TIMESTAMP
);

827 
	}
}

829 cÚ¡ 
nâl_ù_time¡amp
 *
	$nâl_ù_g‘_time¡amp
(cÚ¡ 
nâl_ù
 *
ù
)

831  &
ù
->
ù_t¡amp
;

832 
	}
}

836 
Æ_objeù_İs
 
	gù_obj_İs
 = {

837 .
oo_Çme
 = "netfilter/ct",

838 .
	goo_size
 = (
nâl_ù
),

839 .
	goo_ä“_d©a
 = 
ù_ä“_d©a
,

840 .
	goo_şÚe
 = 
ù_şÚe
,

841 .
	goo_dump
 = {

842 [
NL_DUMP_LINE
] = 
ù_dump_lše
,

843 [
NL_DUMP_DETAILS
] = 
ù_dump_d‘as
,

844 [
NL_DUMP_STATS
] = 
ù_dump_¡©s
,

846 .
	goo_com·»
 = 
ù_com·»
,

847 .
	goo_©Œs2¡r
 = 
ù_©Œs2¡r
,

	@mylibnl/libnl-3.2.25/lib/netfilter/exp.c

23 
	~<by‹sw­.h
>

24 
	~<sys/ty³s.h
>

25 
	~<lšux/Ãtf‹r/nâ‘lšk_cÚÁ¿ck.h
>

27 
	~<Ãšk-´iv©e/Ãšk.h
>

28 
	~<Ãšk/©Œ.h
>

29 
	~<Ãšk/Ãtf‹r/nâl.h
>

30 
	~<Ãšk/Ãtf‹r/exp.h
>

32 
Æ_ÿche_İs
 
	gnâl_exp_İs
;

34 
Æa_pŞicy
 
	gexp_pŞicy
[
CTA_EXPECT_MAX
+1] = {

35 [
CTA_EXPECT_MASTER
] = { .
ty³
 = 
NLA_NESTED
 },

36 [
CTA_EXPECT_TUPLE
] = { .
ty³
 = 
NLA_NESTED
 },

37 [
CTA_EXPECT_MASK
] = { .
ty³
 = 
NLA_NESTED
 },

38 [
CTA_EXPECT_TIMEOUT
] = { .
ty³
 = 
NLA_U32
 },

39 [
CTA_EXPECT_ID
] = { .
ty³
 = 
NLA_U32
 },

40 [
CTA_EXPECT_HELP_NAME
] = { .
ty³
 = 
NLA_STRING
 },

41 [
CTA_EXPECT_ZONE
] = { .
ty³
 = 
NLA_U16
 },

42 [
CTA_EXPECT_FLAGS
] = { .
ty³
 = 
NLA_U32
 },

43 [
CTA_EXPECT_CLASS
] = { .
ty³
 = 
NLA_U32
 },

44 [
CTA_EXPECT_NAT
] = { .
ty³
 = 
NLA_NESTED
 },

45 [
CTA_EXPECT_FN
] = { .
ty³
 = 
NLA_STRING
 },

48 
Æa_pŞicy
 
	gexp_tu¶e_pŞicy
[
CTA_TUPLE_MAX
+1] = {

49 [
CTA_TUPLE_IP
] = { .
ty³
 = 
NLA_NESTED
 },

50 [
CTA_TUPLE_PROTO
] = { .
ty³
 = 
NLA_NESTED
 },

53 
Æa_pŞicy
 
	gexp__pŞicy
[
CTA_IP_MAX
+1] = {

54 [
CTA_IP_V4_SRC
] = { .
ty³
 = 
NLA_U32
 },

55 [
CTA_IP_V4_DST
] = { .
ty³
 = 
NLA_U32
 },

56 [
CTA_IP_V6_SRC
] = { .
mšËn
 = 16 },

57 [
CTA_IP_V6_DST
] = { .
mšËn
 = 16 },

60 
Æa_pŞicy
 
	gexp_´Ùo_pŞicy
[
CTA_PROTO_MAX
+1] = {

61 [
CTA_PROTO_NUM
] = { .
ty³
 = 
NLA_U8
 },

62 [
CTA_PROTO_SRC_PORT
] = { .
ty³
 = 
NLA_U16
 },

63 [
CTA_PROTO_DST_PORT
] = { .
ty³
 = 
NLA_U16
 },

64 [
CTA_PROTO_ICMP_ID
] = { .
ty³
 = 
NLA_U16
 },

65 [
CTA_PROTO_ICMP_TYPE
] = { .
ty³
 = 
NLA_U8
 },

66 [
CTA_PROTO_ICMP_CODE
] = { .
ty³
 = 
NLA_U8
 },

67 [
CTA_PROTO_ICMPV6_ID
] = { .
ty³
 = 
NLA_U16
 },

68 [
CTA_PROTO_ICMPV6_TYPE
] = { .
ty³
 = 
NLA_U8
 },

69 [
CTA_PROTO_ICMPV6_CODE
] = { .
ty³
 = 
NLA_U8
 },

72 
Æa_pŞicy
 
	gexp_Çt_pŞicy
[
CTA_EXPECT_NAT_MAX
+1] = {

73 [
CTA_EXPECT_NAT_DIR
] = { .
ty³
 = 
NLA_U32
 },

74 [
CTA_EXPECT_NAT_TUPLE
] = { .
ty³
 = 
NLA_NESTED
 },

77 
	$exp_·r£_
(
nâl_exp
 *
exp
, 
tu¶e
, 
Æ©Œ
 *
©Œ
)

79 
Æ©Œ
 *
tb
[
CTA_IP_MAX
+1];

80 
Æ_addr
 *
addr
;

81 
”r
;

83 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_IP_MAX
, 
©Œ
, 
exp__pŞicy
);

84 ià(
”r
 < 0)

85 
”rout
;

87 ià(
tb
[
CTA_IP_V4_SRC
]) {

88 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V4_SRC
], 
AF_INET
);

89 ià(
addr
 =ğ
NULL
)

90 
”rout_’omem
;

91 
”r
 = 
	`nâl_exp_£t_¤c
(
exp
, 
tu¶e
, 
addr
);

92 
	`Æ_addr_put
(
addr
);

93 ià(
”r
 < 0)

94 
”rout
;

96 ià(
tb
[
CTA_IP_V4_DST
]) {

97 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V4_DST
], 
AF_INET
);

98 ià(
addr
 =ğ
NULL
)

99 
”rout_’omem
;

100 
”r
 = 
	`nâl_exp_£t_d¡
(
exp
, 
tu¶e
, 
addr
);

101 
	`Æ_addr_put
(
addr
);

102 ià(
”r
 < 0)

103 
”rout
;

105 ià(
tb
[
CTA_IP_V6_SRC
]) {

106 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V6_SRC
], 
AF_INET6
);

107 ià(
addr
 =ğ
NULL
)

108 
”rout_’omem
;

109 
”r
 = 
	`nâl_exp_£t_¤c
(
exp
, 
tu¶e
, 
addr
);

110 
	`Æ_addr_put
(
addr
);

111 ià(
”r
 < 0)

112 
”rout
;

114 ià(
tb
[
CTA_IP_V6_DST
]) {

115 
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
CTA_IP_V6_DST
], 
AF_INET6
);

116 ià(
addr
 =ğ
NULL
)

117 
”rout_’omem
;

118 
”r
 = 
	`nâl_exp_£t_d¡
(
exp
, 
tu¶e
, 
addr
);

119 
	`Æ_addr_put
(
addr
);

120 ià(
”r
 < 0)

121 
”rout
;

126 
”rout_’omem
:

127 
”r
 = -
NLE_NOMEM
;

128 
”rout
:

129  
”r
;

130 
	}
}

132 
	$exp_·r£_´Ùo
(
nâl_exp
 *
exp
, 
tu¶e
, 
Æ©Œ
 *
©Œ
)

134 
Æ©Œ
 *
tb
[
CTA_PROTO_MAX
+1];

135 
”r
;

136 
ušt16_t
 
¤ıÜt
 = 0, 
d¡pÜt
 = 0, 
icmpid
 = 0;

137 
ušt8_t
 
icm±y³
 = 0, 
icmpcode
 = 0;

139 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_PROTO_MAX
, 
©Œ
, 
exp_´Ùo_pŞicy
);

140 ià(
”r
 < 0)

141  
”r
;

143 ià(
tb
[
CTA_PROTO_NUM
])

144 
	`nâl_exp_£t_l4´ÙÚum
(
exp
, 
tu¶e
, 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_NUM
]));

146 ià(
tb
[
CTA_PROTO_SRC_PORT
])

147 
¤ıÜt
 = 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_SRC_PORT
]));

148 ià(
tb
[
CTA_PROTO_DST_PORT
])

149 
d¡pÜt
 = 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_DST_PORT
]));

150 ià(
tb
[
CTA_PROTO_SRC_PORT
] ||b[
CTA_PROTO_DST_PORT
])

151 
	`nâl_exp_£t_pÜts
(
exp
, 
tu¶e
, 
¤ıÜt
, 
d¡pÜt
);

153 ià(
tb
[
CTA_PROTO_ICMP_ID
])

154 
icmpid
 = 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_PROTO_ICMP_ID
]));

155 ià(
tb
[
CTA_PROTO_ICMP_TYPE
])

156 
icm±y³
 = 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMP_TYPE
]);

157 ià(
tb
[
CTA_PROTO_ICMP_CODE
])

158 
icmpcode
 = 
	`Æa_g‘_u8
(
tb
[
CTA_PROTO_ICMP_CODE
]);

159 ià(
tb
[
CTA_PROTO_ICMP_ID
] ||b[
CTA_PROTO_ICMP_TYPE
] ||b[
CTA_PROTO_ICMP_CODE
])

160 
	`nâl_exp_£t_icmp
(
exp
, 
tu¶e
, 
icmpid
, 
icm±y³
, 
icmpcode
);

162 
	}
}

164 
	$exp_·r£_tu¶e
(
nâl_exp
 *
exp
, 
tu¶e
, 
Æ©Œ
 *
©Œ
)

166 
Æ©Œ
 *
tb
[
CTA_TUPLE_MAX
+1];

167 
”r
;

169 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_TUPLE_MAX
, 
©Œ
, 
exp_tu¶e_pŞicy
);

170 ià(
”r
 < 0)

171  
”r
;

173 ià(
tb
[
CTA_TUPLE_IP
]) {

174 
”r
 = 
	`exp_·r£_
(
exp
, 
tu¶e
, 
tb
[
CTA_TUPLE_IP
]);

175 ià(
”r
 < 0)

176  
”r
;

179 ià(
tb
[
CTA_TUPLE_PROTO
]) {

180 
”r
 = 
	`exp_·r£_´Ùo
(
exp
, 
tu¶e
, 
tb
[
CTA_TUPLE_PROTO
]);

181 ià(
”r
 < 0)

182  
”r
;

186 
	}
}

188 
	$exp_·r£_Çt
(
nâl_exp
 *
exp
, 
Æ©Œ
 *
©Œ
)

190 
Æ©Œ
 *
tb
[
CTA_EXPECT_NAT_MAX
+1];

191 
”r
;

193 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
CTA_EXPECT_NAT_MAX
, 
©Œ
, 
exp_Çt_pŞicy
);

194 ià(
”r
 < 0)

195  
”r
;

197 ià(
tb
[
CTA_EXPECT_NAT_DIR
])

198 
	`nâl_exp_£t_Çt_dœ
(
exp
, 
	`Æa_g‘_u32
(
tb
[
CTA_EXPECT_NAT_DIR
]));

200 ià(
tb
[
CTA_EXPECT_NAT_TUPLE
]) {

201 
”r
 = 
	`exp_·r£_tu¶e
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
tb
[
CTA_EXPECT_NAT_TUPLE
]);

202 ià(
”r
 < 0)

203  
”r
;

207 
	}
}

209 
	$nâlmsg_exp_group
(
Æmsghdr
 *
Æh
)

211 
	`nâlmsg_subty³
(
Æh
)) {

212 
IPCTNL_MSG_EXP_NEW
:

213 ià(
Æh
->
Æmsg_æags
 & (
NLM_F_CREATE
|
NLM_F_EXCL
))

214  
NFNLGRP_CONNTRACK_EXP_NEW
;

216  
NFNLGRP_CONNTRACK_EXP_UPDATE
;

217 
IPCTNL_MSG_EXP_DELETE
:

218  
NFNLGRP_CONNTRACK_EXP_DESTROY
;

220  
NFNLGRP_NONE
;

222 
	}
}

224 
	$nâlmsg_exp_·r£
(
Æmsghdr
 *
Æh
, 
nâl_exp
 **
»suÉ
)

226 
nâl_exp
 *
exp
;

227 
Æ©Œ
 *
tb
[
CTA_MAX
+1];

228 
”r
;

230 
exp
 = 
	`nâl_exp_®loc
();

231 ià(!
exp
)

232  -
NLE_NOMEM
;

234 
exp
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

236 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
nfg’msg
), 
tb
, 
CTA_EXPECT_MAX
,

237 
exp_pŞicy
);

238 ià(
”r
 < 0)

239 
”rout
;

241 
	`nâl_exp_£t_çmy
(
exp
, 
	`nâlmsg_çmy
(
Æh
));

243 ià(
tb
[
CTA_EXPECT_TUPLE
]) {

244 
”r
 = 
	`exp_·r£_tu¶e
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
tb
[
CTA_EXPECT_TUPLE
]);

245 ià(
”r
 < 0)

246 
”rout
;

248 ià(
tb
[
CTA_EXPECT_MASTER
]) {

249 
”r
 = 
	`exp_·r£_tu¶e
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
tb
[
CTA_EXPECT_MASTER
]);

250 ià(
”r
 < 0)

251 
”rout
;

253 ià(
tb
[
CTA_EXPECT_MASK
]) {

254 
”r
 = 
	`exp_·r£_tu¶e
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
tb
[
CTA_EXPECT_MASK
]);

255 ià(
”r
 < 0)

256 
”rout
;

259 ià(
tb
[
CTA_EXPECT_NAT
]) {

260 
”r
 = 
	`exp_·r£_Çt
(
exp
, 
tb
[
CTA_EXPECT_MASK
]);

261 ià(
”r
 < 0)

262 
”rout
;

265 ià(
tb
[
CTA_EXPECT_CLASS
])

266 
	`nâl_exp_£t_şass
(
exp
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_EXPECT_CLASS
])));

268 ià(
tb
[
CTA_EXPECT_FN
])

269 
	`nâl_exp_£t_â
(
exp
, 
	`Æa_d©a
(
tb
[
CTA_EXPECT_FN
]));

271 ià(
tb
[
CTA_EXPECT_TIMEOUT
])

272 
	`nâl_exp_£t_timeout
(
exp
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_EXPECT_TIMEOUT
])));

274 ià(
tb
[
CTA_EXPECT_ID
])

275 
	`nâl_exp_£t_id
(
exp
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_EXPECT_ID
])));

277 ià(
tb
[
CTA_EXPECT_HELP_NAME
])

278 
	`nâl_exp_£t_h–³r_Çme
(
exp
, 
	`Æa_d©a
(
tb
[
CTA_EXPECT_HELP_NAME
]));

280 ià(
tb
[
CTA_EXPECT_ZONE
])

281 
	`nâl_exp_£t_zÚe
(
exp
, 
	`Áohs
(
	`Æa_g‘_u16
(
tb
[
CTA_EXPECT_ZONE
])));

283 ià(
tb
[
CTA_EXPECT_FLAGS
])

284 
	`nâl_exp_£t_æags
(
exp
, 
	`Áohl
(
	`Æa_g‘_u32
(
tb
[
CTA_EXPECT_FLAGS
])));

286 *
»suÉ
 = 
exp
;

289 
”rout
:

290 
	`nâl_exp_put
(
exp
);

291  
”r
;

292 
	}
}

294 
	$exp_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

295 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

297 
nâl_exp
 *
exp
;

298 
”r
;

300 ià((
”r
 = 
	`nâlmsg_exp_·r£
(
Æh
, &
exp
)) < 0)

301  
”r
;

303 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
exp
,…p);

304 
	`nâl_exp_put
(
exp
);

305  
”r
;

306 
	}
}

308 
	$nâl_exp_dump_»que¡
(
Æ_sock
 *
sk
)

310  
	`nâl_£nd_sim¶e
(
sk
, 
NFNL_SUBSYS_CTNETLINK_EXP
, 
IPCTNL_MSG_EXP_GET
,

311 
NLM_F_DUMP
, 
AF_UNSPEC
, 0);

312 
	}
}

314 
	$exp_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

316  
	`nâl_exp_dump_»que¡
(
sk
);

317 
	}
}

319 
	$exp_g‘_tu¶e_©Œ
(
tu¶e
)

321 
©Œ
 = 0;

323 
tu¶e
) {

324 
CTA_EXPECT_MASTER
:

325 
©Œ
 = 
NFNL_EXP_TUPLE_MASTER
;

327 
CTA_EXPECT_MASK
:

328 
©Œ
 = 
NFNL_EXP_TUPLE_MASK
;

330 
CTA_EXPECT_NAT
:

331 
©Œ
 = 
NFNL_EXP_TUPLE_NAT
;

333 
CTA_EXPECT_TUPLE
:

335 
©Œ
 = 
NFNL_EXP_TUPLE_EXPECT
;

339  
©Œ
;

340 
	}
}

342 
	$nâl_exp_bud_tu¶e
(
Æ_msg
 *
msg
, cÚ¡ 
nâl_exp
 *
exp
,

343 
ùa
)

345 
Æ©Œ
 *
tu¶e
, *

, *
´Ùo
;

346 
Æ_addr
 *
addr
;

347 
çmy
;

349 
çmy
 = 
	`nâl_exp_g‘_çmy
(
exp
);

351 
ty³
 = 
	`exp_g‘_tu¶e_©Œ
(
ùa
);

353 ià(
ùa
 =ğ
CTA_EXPECT_NAT
)

354 
tu¶e
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_EXPECT_NAT_TUPLE
);

356 
tu¶e
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
ùa
);

358 ià(!
tu¶e
)

359 
Æa_put_çu»
;

361 

 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_TUPLE_IP
);

362 ià(!

)

363 
Æa_put_çu»
;

365 
addr
 = 
	`nâl_exp_g‘_¤c
(
exp
, 
ty³
);

366 ià(
addr
)

367 
	`NLA_PUT_ADDR
(
msg
,

368 
çmy
 =ğ
AF_INET
 ? 
CTA_IP_V4_SRC
 : 
CTA_IP_V6_SRC
,

369 
addr
);

371 
addr
 = 
	`nâl_exp_g‘_d¡
(
exp
, 
ty³
);

372 ià(
addr
)

373 
	`NLA_PUT_ADDR
(
msg
,

374 
çmy
 =ğ
AF_INET
 ? 
CTA_IP_V4_DST
 : 
CTA_IP_V6_DST
,

375 
addr
);

377 
	`Æa_Ã¡_’d
(
msg
, 

);

379 
´Ùo
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_TUPLE_PROTO
);

380 ià(!
´Ùo
)

381 
Æa_put_çu»
;

383 ià(
	`nâl_exp_‹¡_l4´ÙÚum
(
exp
, 
ty³
))

384 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_NUM
, 
	`nâl_exp_g‘_l4´ÙÚum
(
exp
, 
ty³
));

386 ià(
	`nâl_exp_‹¡_pÜts
(
exp
, 
ty³
)) {

387 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_SRC_PORT
,

388 
	`htÚs
(
	`nâl_exp_g‘_¤c_pÜt
(
exp
, 
ty³
)));

390 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_DST_PORT
,

391 
	`htÚs
(
	`nâl_exp_g‘_d¡_pÜt
(
exp
, 
ty³
)));

394 ià(
	`nâl_exp_‹¡_icmp
(
exp
, 
ty³
)) {

395 
	`NLA_PUT_U16
(
msg
, 
CTA_PROTO_ICMP_ID
,

396 
	`htÚs
(
	`nâl_exp_g‘_icmp_id
(
exp
, 
ty³
)));

398 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMP_TYPE
,

399 
	`nâl_exp_g‘_icmp_ty³
(
exp
, 
ty³
));

401 
	`NLA_PUT_U8
(
msg
, 
CTA_PROTO_ICMP_CODE
,

402 
	`nâl_exp_g‘_icmp_code
(
exp
, 
ty³
));

405 
	`Æa_Ã¡_’d
(
msg
, 
´Ùo
);

407 
	`Æa_Ã¡_’d
(
msg
, 
tu¶e
);

410 
Æa_put_çu»
:

411  -
NLE_MSGSIZE
;

412 
	}
}

414 
	$nâl_exp_bud_Çt
(
Æ_msg
 *
msg
, cÚ¡ 
nâl_exp
 *
exp
)

416 
Æ©Œ
 *
Çt
;

417 
”r
;

419 
Çt
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
CTA_EXPECT_NAT
);

421 ià(
	`nâl_exp_‹¡_Çt_dœ
(
exp
)) {

422 
	`NLA_PUT_U32
(
msg
, 
CTA_EXPECT_NAT_DIR
,

423 
	`nâl_exp_g‘_Çt_dœ
(
exp
));

426 ià((
”r
 = 
	`nâl_exp_bud_tu¶e
(
msg
, 
exp
, 
CTA_EXPECT_NAT
)) < 0)

427 
Æa_put_çu»
;

429 
	`Æa_Ã¡_’d
(
msg
, 
Çt
);

432 
Æa_put_çu»
:

433  -
NLE_MSGSIZE
;

434 
	}
}

436 
	$nâl_exp_bud_mes§ge
(cÚ¡ 
nâl_exp
 *
exp
, 
cmd
, 
æags
,

437 
Æ_msg
 **
»suÉ
)

439 
Æ_msg
 *
msg
;

440 
”r
;

442 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_CTNETLINK_EXP
, 
cmd
, 
æags
,

443 
	`nâl_exp_g‘_çmy
(
exp
), 0);

444 ià(
msg
 =ğ
NULL
)

445  -
NLE_NOMEM
;

447 ià((
”r
 = 
	`nâl_exp_bud_tu¶e
(
msg
, 
exp
, 
CTA_EXPECT_TUPLE
)) < 0)

448 
”r_out
;

450 ià((
”r
 = 
	`nâl_exp_bud_tu¶e
(
msg
, 
exp
, 
CTA_EXPECT_MASTER
)) < 0)

451 
”r_out
;

453 ià((
”r
 = 
	`nâl_exp_bud_tu¶e
(
msg
, 
exp
, 
CTA_EXPECT_MASK
)) < 0)

454 
”r_out
;

456 ià(
	`nâl_exp_‹¡_¤c
(
exp
, 
NFNL_EXP_TUPLE_NAT
)) {

457 ià((
”r
 = 
	`nâl_exp_bud_Çt
(
msg
, 
exp
)) < 0)

458 
”r_out
;

461 ià(
	`nâl_exp_‹¡_şass
(
exp
))

462 
	`NLA_PUT_U32
(
msg
, 
CTA_EXPECT_CLASS
, 
	`htÚl
(
	`nâl_exp_g‘_şass
(
exp
)));

464 ià(
	`nâl_exp_‹¡_â
(
exp
))

465 
	`NLA_PUT_STRING
(
msg
, 
CTA_EXPECT_FN
, 
	`nâl_exp_g‘_â
(
exp
));

467 ià(
	`nâl_exp_‹¡_id
(
exp
))

468 
	`NLA_PUT_U32
(
msg
, 
CTA_EXPECT_ID
, 
	`htÚl
(
	`nâl_exp_g‘_id
(
exp
)));

470 ià(
	`nâl_exp_‹¡_timeout
(
exp
))

471 
	`NLA_PUT_U32
(
msg
, 
CTA_EXPECT_TIMEOUT
, 
	`htÚl
(
	`nâl_exp_g‘_timeout
(
exp
)));

473 ià(
	`nâl_exp_‹¡_h–³r_Çme
(
exp
))

474 
	`NLA_PUT_STRING
(
msg
, 
CTA_EXPECT_HELP_NAME
, 
	`nâl_exp_g‘_h–³r_Çme
(
exp
));

476 ià(
	`nâl_exp_‹¡_zÚe
(
exp
))

477 
	`NLA_PUT_U16
(
msg
, 
CTA_EXPECT_ZONE
, 
	`htÚs
(
	`nâl_exp_g‘_zÚe
(
exp
)));

479 ià(
	`nâl_exp_‹¡_æags
(
exp
))

480 
	`NLA_PUT_U32
(
msg
, 
CTA_EXPECT_FLAGS
, 
	`htÚl
(
	`nâl_exp_g‘_æags
(
exp
)));

482 *
»suÉ
 = 
msg
;

485 
Æa_put_çu»
:

486 
”r_out
:

487 
	`Æmsg_ä“
(
msg
);

488  
”r
;

489 
	}
}

491 
	$nâl_exp_bud_add_»que¡
(cÚ¡ 
nâl_exp
 *
exp
, 
æags
,

492 
Æ_msg
 **
»suÉ
)

494  
	`nâl_exp_bud_mes§ge
(
exp
, 
IPCTNL_MSG_EXP_NEW
, 
æags
, 
»suÉ
);

495 
	}
}

497 
	$nâl_exp_add
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_exp
 *
exp
, 
æags
)

499 
Æ_msg
 *
msg
;

500 
”r
;

502 ià((
”r
 = 
	`nâl_exp_bud_add_»que¡
(
exp
, 
æags
, &
msg
)) < 0)

503  
”r
;

505 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

506 
	`Æmsg_ä“
(
msg
);

507 ià(
”r
 < 0)

508  
”r
;

510  
	`wa™_fÜ_ack
(
sk
);

511 
	}
}

513 
	$nâl_exp_bud_d–‘e_»que¡
(cÚ¡ 
nâl_exp
 *
exp
, 
æags
,

514 
Æ_msg
 **
»suÉ
)

516  
	`nâl_exp_bud_mes§ge
(
exp
, 
IPCTNL_MSG_EXP_DELETE
, 
æags
, 
»suÉ
);

517 
	}
}

519 
	$nâl_exp_d–
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_exp
 *
exp
, 
æags
)

521 
Æ_msg
 *
msg
;

522 
”r
;

524 ià((
”r
 = 
	`nâl_exp_bud_d–‘e_»que¡
(
exp
, 
æags
, &
msg
)) < 0)

525  
”r
;

527 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

528 
	`Æmsg_ä“
(
msg
);

529 ià(
”r
 < 0)

530  
”r
;

532  
	`wa™_fÜ_ack
(
sk
);

533 
	}
}

535 
	$nâl_exp_bud_qu”y_»que¡
(cÚ¡ 
nâl_exp
 *
exp
, 
æags
,

536 
Æ_msg
 **
»suÉ
)

538  
	`nâl_exp_bud_mes§ge
(
exp
, 
IPCTNL_MSG_EXP_GET
, 
æags
, 
»suÉ
);

539 
	}
}

541 
	$nâl_exp_qu”y
(
Æ_sock
 *
sk
, cÚ¡ 
nâl_exp
 *
exp
, 
æags
)

543 
Æ_msg
 *
msg
;

544 
”r
;

546 ià((
”r
 = 
	`nâl_exp_bud_qu”y_»que¡
(
exp
, 
æags
, &
msg
)) < 0)

547  
”r
;

549 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

550 
	`Æmsg_ä“
(
msg
);

551 ià(
”r
 < 0)

552  
”r
;

554  
	`wa™_fÜ_ack
(
sk
);

555 
	}
}

572 
	$nâl_exp_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

574  
	`Æ_ÿche_®loc_ªd_fl
(&
nâl_exp_İs
, 
sk
, 
»suÉ
);

575 
	}
}

586 
Æ_af_group
 
	gexp_groups
[] = {

587 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_EXP_NEW
 },

588 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_EXP_UPDATE
 },

589 { 
AF_UNSPEC
, 
NFNLGRP_CONNTRACK_EXP_DESTROY
 },

590 { 
END_OF_GROUP_LIST
 },

593 
	#NFNLMSG_EXP_TYPE
(
ty³
è
	`NFNLMSG_TYPE
(
NFNL_SUBSYS_CTNETLINK_EXP
, (ty³))

	)

594 
Æ_ÿche_İs
 
	gnâl_exp_İs
 = {

595 .
co_Çme
 = "netfilter/exp",

596 .
	gco_hdrsize
 = 
NFNL_HDRLEN
,

597 .
	gco_msgty³s
 = {

598 { 
NFNLMSG_EXP_TYPE
(
IPCTNL_MSG_EXP_NEW
), 
NL_ACT_NEW
, "new" },

599 { 
NFNLMSG_EXP_TYPE
(
IPCTNL_MSG_EXP_GET
), 
NL_ACT_GET
, "get" },

600 { 
NFNLMSG_EXP_TYPE
(
IPCTNL_MSG_EXP_DELETE
), 
NL_ACT_DEL
, "del" },

601 
END_OF_MSGTYPES_LIST
,

603 .
	gco_´ÙocŞ
 = 
NETLINK_NETFILTER
,

604 .
	gco_groups
 = 
exp_groups
,

605 .
	gco_»que¡_upd©e
 = 
exp_»que¡_upd©e
,

606 .
	gco_msg_·r£r
 = 
exp_msg_·r£r
,

607 .
	gco_obj_İs
 = &
exp_obj_İs
,

610 
__š™
 
	$exp_š™
()

612 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_exp_İs
);

613 
	}
}

615 
__ex™
 
	$exp_ex™
()

617 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_exp_İs
);

618 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/exp_obj.c

15 
	~<sys/ty³s.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<lšux/Ãtf‹r/nâ‘lšk_cÚÁ¿ck.h
>

18 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_commÚ.h
>

19 
	~<lšux/Ãtf‹r/nf_cÚÁ¿ck_tı.h
>

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk/Ãtf‹r/nâl.h
>

23 
	~<Ãšk/Ãtf‹r/exp.h
>

32 
	#EXP_ATTR_FAMILY
 (1UL << 0)

33 
	#EXP_ATTR_TIMEOUT
 (1UL << 1)

34 
	#EXP_ATTR_ID
 (1UL << 2)

35 
	#EXP_ATTR_HELPER_NAME
 (1UL << 3)

36 
	#EXP_ATTR_ZONE
 (1UL << 4)

37 
	#EXP_ATTR_FLAGS
 (1UL << 5)

38 
	#EXP_ATTR_CLASS
 (1UL << 6)

39 
	#EXP_ATTR_FN
 (1UL << 7)

41 
	#EXP_ATTR_EXPECT_IP_SRC
 (1UL << 8)

	)

42 
	#EXP_ATTR_EXPECT_IP_DST
 (1UL << 9)

	)

43 
	#EXP_ATTR_EXPECT_L4PROTO_NUM
 (1UL << 10)

	)

44 
	#EXP_ATTR_EXPECT_L4PROTO_PORTS
 (1UL << 11)

	)

45 
	#EXP_ATTR_EXPECT_L4PROTO_ICMP
 (1UL << 12)

	)

46 
	#EXP_ATTR_MASTER_IP_SRC
 (1UL << 13)

	)

47 
	#EXP_ATTR_MASTER_IP_DST
 (1UL << 14)

	)

48 
	#EXP_ATTR_MASTER_L4PROTO_NUM
 (1UL << 15)

	)

49 
	#EXP_ATTR_MASTER_L4PROTO_PORTS
 (1UL << 16)

	)

50 
	#EXP_ATTR_MASTER_L4PROTO_ICMP
 (1UL << 17)

	)

51 
	#EXP_ATTR_MASK_IP_SRC
 (1UL << 18)

	)

52 
	#EXP_ATTR_MASK_IP_DST
 (1UL << 19)

	)

53 
	#EXP_ATTR_MASK_L4PROTO_NUM
 (1UL << 20)

	)

54 
	#EXP_ATTR_MASK_L4PROTO_PORTS
 (1UL << 21)

	)

55 
	#EXP_ATTR_MASK_L4PROTO_ICMP
 (1UL << 22)

	)

56 
	#EXP_ATTR_NAT_IP_SRC
 (1UL << 23)

	)

57 
	#EXP_ATTR_NAT_IP_DST
 (1UL << 24)

	)

58 
	#EXP_ATTR_NAT_L4PROTO_NUM
 (1UL << 25)

	)

59 
	#EXP_ATTR_NAT_L4PROTO_PORTS
 (1UL << 26)

	)

60 
	#EXP_ATTR_NAT_L4PROTO_ICMP
 (1UL << 27)

	)

61 
	#EXP_ATTR_NAT_DIR
 (1UL << 28)

	)

64 
	$exp_ä“_d©a
(
Æ_objeù
 *
c
)

66 
nâl_exp
 *
exp
 = (nâl_ex°*è
c
;

68 ià(
exp
 =ğ
NULL
)

71 
	`Æ_addr_put
(
exp
->
exp_ex³ù
.
¤c
);

72 
	`Æ_addr_put
(
exp
->
exp_ex³ù
.
d¡
);

73 
	`Æ_addr_put
(
exp
->
exp_ma¡”
.
¤c
);

74 
	`Æ_addr_put
(
exp
->
exp_ma¡”
.
d¡
);

75 
	`Æ_addr_put
(
exp
->
exp_mask
.
¤c
);

76 
	`Æ_addr_put
(
exp
->
exp_mask
.
d¡
);

77 
	`Æ_addr_put
(
exp
->
exp_Çt
.
¤c
);

78 
	`Æ_addr_put
(
exp
->
exp_Çt
.
d¡
);

80 
	`ä“
(
exp
->
exp_â
);

81 
	`ä“
(
exp
->
exp_h–³r_Çme
);

82 
	}
}

84 
	$exp_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

86 
nâl_exp
 *
d¡
 = (nâl_ex°*è
_d¡
;

87 
nâl_exp
 *
¤c
 = (nâl_ex°*è
_¤c
;

88 
Æ_addr
 *
addr
;

91 ià(
¤c
->
exp_ex³ù
.src) {

92 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_ex³ù
.src);

93 ià(!
addr
)

94  -
NLE_NOMEM
;

95 
d¡
->
exp_ex³ù
.
¤c
 = 
addr
;

98 ià(
¤c
->
exp_ex³ù
.
d¡
) {

99 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_ex³ù
.
d¡
);

100 ià(!
addr
)

101  -
NLE_NOMEM
;

102 
d¡
->
exp_ex³ù
.d¡ = 
addr
;

106 ià(
¤c
->
exp_ma¡”
.src) {

107 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_ma¡”
.src);

108 ià(!
addr
)

109  -
NLE_NOMEM
;

110 
d¡
->
exp_ma¡”
.
¤c
 = 
addr
;

113 ià(
¤c
->
exp_ma¡”
.
d¡
) {

114 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_ma¡”
.
d¡
);

115 ià(!
addr
)

116  -
NLE_NOMEM
;

117 
d¡
->
exp_ma¡”
.d¡ = 
addr
;

121 ià(
¤c
->
exp_mask
.src) {

122 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_mask
.src);

123 ià(!
addr
)

124  -
NLE_NOMEM
;

125 
d¡
->
exp_mask
.
¤c
 = 
addr
;

128 ià(
¤c
->
exp_mask
.
d¡
) {

129 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_mask
.
d¡
);

130 ià(!
addr
)

131  -
NLE_NOMEM
;

132 
d¡
->
exp_mask
.d¡ = 
addr
;

136 ià(
¤c
->
exp_Çt
.src) {

137 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_Çt
.src);

138 ià(!
addr
)

139  -
NLE_NOMEM
;

140 
d¡
->
exp_Çt
.
¤c
 = 
addr
;

143 ià(
¤c
->
exp_Çt
.
d¡
) {

144 
addr
 = 
	`Æ_addr_şÚe
(
¤c
->
exp_Çt
.
d¡
);

145 ià(!
addr
)

146  -
NLE_NOMEM
;

147 
d¡
->
exp_Çt
.d¡ = 
addr
;

150 ià(
¤c
->
exp_â
)

151 
d¡
->
exp_â
 = 
	`¡rdup
(
¤c
->exp_fn);

153 ià(
¤c
->
exp_h–³r_Çme
)

154 
d¡
->
exp_h–³r_Çme
 = 
	`¡rdup
(
¤c
->exp_helper_name);

157 
	}
}

159 
	$dump_addr
(
Æ_dump_·¿ms
 *
p
, 
Æ_addr
 *
addr
, 
pÜt
)

161 
buf
[64];

163 ià(
addr
)

164 
	`Æ_dump
(
p
, "%s", 
	`Æ_addr2¡r
(
addr
, 
buf
, (buf)));

166 ià(
pÜt
)

167 
	`Æ_dump
(
p
, ":%u ", 
pÜt
);

168 ià(
addr
)

169 
	`Æ_dump
(
p
, " ");

170 
	}
}

172 
	$dump_icmp
(
Æ_dump_·¿ms
 *
p
, 
nâl_exp
 *
exp
, 
tu¶e
)

174 ià(
	`nâl_exp_‹¡_icmp
(
exp
, 
tu¶e
)) {

176 
	`Æ_dump
(
p
, "icm°ty³ %d ", 
	`nâl_exp_g‘_icmp_ty³
(
exp
, 
tu¶e
));

178 
	`Æ_dump
(
p
, "cod%d ", 
	`nâl_exp_g‘_icmp_code
(
exp
, 
tu¶e
));

180 
	`Æ_dump
(
p
, "id %d ", 
	`nâl_exp_g‘_icmp_id
(
exp
, 
tu¶e
));

182 
	}
}

184 
	$exp_dump_tu¶es
(
nâl_exp
 *
exp
, 
Æ_dump_·¿ms
 *
p
)

186 
Æ_addr
 *
tu¶e_¤c
, *
tu¶e_d¡
;

187 
tu¶e_¥Üt
, 
tu¶e_dpÜt
;

188 
i
 = 0;

189 
buf
[64];

191 
i
 = 
NFNL_EXP_TUPLE_EXPECT
; i < 
NFNL_EXP_TUPLE_MAX
; i++) {

192 
tu¶e_¤c
 = 
NULL
;

193 
tu¶e_d¡
 = 
NULL
;

194 
tu¶e_¥Üt
 = 0;

195 
tu¶e_dpÜt
 = 0;

198 ià(
	`nâl_exp_‹¡_¤c
(
exp
, 
i
))

199 
tu¶e_¤c
 = 
	`nâl_exp_g‘_¤c
(
exp
, 
i
);

200 ià(
	`nâl_exp_‹¡_d¡
(
exp
, 
i
))

201 
tu¶e_d¡
 = 
	`nâl_exp_g‘_d¡
(
exp
, 
i
);

204 ià(
	`nâl_exp_‹¡_l4´ÙÚum
(
exp
, 
i
)) {

205 
	`Æ_dump
(
p
, "%s ",

206 
	`Æ__´Ùo2¡r
(
	`nâl_exp_g‘_l4´ÙÚum
(
exp
, 
i
), 
buf
, (buf)));

209 ià(
	`nâl_exp_‹¡_pÜts
(
exp
, 
i
)) {

210 
tu¶e_¥Üt
 = 
	`nâl_exp_g‘_¤c_pÜt
(
exp
, 
i
);

211 
tu¶e_dpÜt
 = 
	`nâl_exp_g‘_d¡_pÜt
(
exp
, 
i
);

214 
	`dump_addr
(
p
, 
tu¶e_¤c
, 
tu¶e_¥Üt
);

215 
	`dump_addr
(
p
, 
tu¶e_d¡
, 
tu¶e_dpÜt
);

216 
	`dump_icmp
(
p
, 
exp
, 0);

219 ià(
	`nâl_exp_‹¡_Çt_dœ
(
exp
))

220 
	`Æ_dump
(
p
, "Çˆdœ % ", 
exp
->
exp_Çt_dœ
);

222 
	}
}

225 
	$exp_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

227 
nâl_exp
 *
exp
 = (nâl_ex°*è
a
;

229 
	`Æ_Ãw_lše
(
p
);

231 
	`exp_dump_tu¶es
(
exp
, 
p
);

233 
	`Æ_dump
(
p
, "\n");

234 
	}
}

236 
	$exp_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

238 
nâl_exp
 *
exp
 = (nâl_ex°*è
a
;

239 
buf
[64];

240 
å
 = 0;

242 
	`exp_dump_lše
(
a
, 
p
);

244 
	`Æ_dump
(
p
, " id 0x%x ", 
exp
->
exp_id
);

245 
	`Æ_dump_lše
(
p
, "family %s ",

246 
	`Æ_af2¡r
(
exp
->
exp_çmy
, 
buf
, (buf)));

248 ià(
	`nâl_exp_‹¡_timeout
(
exp
)) {

249 
ušt64_t
 
timeout_ms
 = 
	`nâl_exp_g‘_timeout
(
exp
) * 1000UL;

250 
	`Æ_dump
(
p
, "timeout %s ",

251 
	`Æ_m£c2¡r
(
timeout_ms
, 
buf
, (buf)));

254 ià(
	`nâl_exp_‹¡_h–³r_Çme
(
exp
))

255 
	`Æ_dump
(
p
, "h–³¸% ", 
exp
->
exp_h–³r_Çme
);

257 ià(
	`nâl_exp_‹¡_â
(
exp
))

258 
	`Æ_dump
(
p
, "â % ", 
exp
->
exp_â
);

260 ià(
	`nâl_exp_‹¡_şass
(
exp
))

261 
	`Æ_dump
(
p
, "şas %u ", 
	`nâl_exp_g‘_şass
(
exp
));

263 ià(
	`nâl_exp_‹¡_zÚe
(
exp
))

264 
	`Æ_dump
(
p
, "zÚ%u ", 
	`nâl_exp_g‘_zÚe
(
exp
));

266 ià(
	`nâl_exp_‹¡_æags
(
exp
))

267 
	`Æ_dump
(
p
, "<");

268 
	#PRINT_FLAG
(
¡r
) \

269 { 
	`Æ_dump
(
p
, "%s%s", 
å
++ ? "," : "", (
¡r
)); }

	)

271 ià(
exp
->
exp_æags
 & 
NF_CT_EXPECT_PERMANENT
)

272 
	`PRINT_FLAG
("PERMANENT");

273 ià(
exp
->
exp_æags
 & 
NF_CT_EXPECT_INACTIVE
)

274 
	`PRINT_FLAG
("INACTIVE");

275 ià(
exp
->
exp_æags
 & 
NF_CT_EXPECT_USERSPACE
)

276 
	`PRINT_FLAG
("USERSPACE");

277 #undeà
PRINT_FLAG


279 ià(
	`nâl_exp_‹¡_æags
(
exp
))

280 
	`Æ_dump
(
p
, ">");

282 
	`Æ_dump
(
p
, "\n");

283 
	}
}

285 
	$exp_cmp_l4´Ùo_pÜts
 (
nâl_exp_´Ùod©a
 *
a
, nâl_exp_´Ùod©¨*
b
) {

287 
d
 = 0;

288 
d
 = ( (
a
->
pÜt
.
¤c
 !ğ
b
->port.src) ||

289 (
a
->
pÜt
.
d¡
 !ğ
b
->port.dst) );

291  
d
;

292 
	}
}

294 
	$exp_cmp_l4´Ùo_icmp
 (
nâl_exp_´Ùod©a
 *
a
, nâl_exp_´Ùod©¨*
b
) {

296 
d
 = 0;

297 
d
 = ( (
a
->
icmp
.
code
 !ğ
b
->icmp.code) ||

298 (
a
->
icmp
.
ty³
 !ğ
b
->icmp.type) ||

299 (
a
->
icmp
.
id
 !ğ
b
->icmp.id) );

301  
d
;

302 
	}
}

304 
	$exp_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

305 
ušt32_t
 
©Œs
, 
æags
)

307 
nâl_exp
 *
a
 = (nâl_ex°*è
_a
;

308 
nâl_exp
 *
b
 = (nâl_ex°*è
_b
;

309 
diff
 = 0;

311 
	#EXP_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
EXP_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

312 
	#EXP_DIFF_VAL
(
ATTR
, 
FIELD
è
	`EXP_DIFF
(ATTR, 
a
->FIELD !ğ
b
->FIELD)

	)

313 
	#EXP_DIFF_STRING
(
ATTR
, 
FIELD
è
	`EXP_DIFF
(ATTR, (
	`¡rcmp
(
a
->FIELD, 
b
->FIELDè!ğ0))

	)

314 
	#EXP_DIFF_ADDR
(
ATTR
, 
FIELD
) \

315 ((
æags
 & 
LOOSE_COMPARISON
) \

316 ? 
	`EXP_DIFF
(
ATTR
, 
	`Æ_addr_cmp_´efix
(
a
->
FIELD
, 
b
->FIELD)) \

317 : 
	`EXP_DIFF
(
ATTR
, 
	`Æ_addr_cmp
(
a
->
FIELD
, 
b
->FIELD)))

	)

318 
	#EXP_DIFF_L4PROTO_PORTS
(
ATTR
, 
FIELD
) \

319 
	`EXP_DIFF
(
ATTR
, 
	`exp_cmp_l4´Ùo_pÜts
(&(
a
->
FIELD
), &(
b
->FIELD)))

	)

320 
	#EXP_DIFF_L4PROTO_ICMP
(
ATTR
, 
FIELD
) \

321 
	`EXP_DIFF
(
ATTR
, 
	`exp_cmp_l4´Ùo_icmp
(&(
a
->
FIELD
), &(
b
->FIELD)))

	)

323 
diff
 |ğ
	`EXP_DIFF_VAL
(
FAMILY
, 
exp_çmy
);

324 
diff
 |ğ
	`EXP_DIFF_VAL
(
TIMEOUT
, 
exp_timeout
);

325 
diff
 |ğ
	`EXP_DIFF_VAL
(
ID
, 
exp_id
);

326 
diff
 |ğ
	`EXP_DIFF_VAL
(
ZONE
, 
exp_zÚe
);

327 
diff
 |ğ
	`EXP_DIFF_VAL
(
CLASS
, 
exp_şass
);

328 
diff
 |ğ
	`EXP_DIFF_VAL
(
FLAGS
, 
exp_æags
);

329 
diff
 |ğ
	`EXP_DIFF_VAL
(
NAT_DIR
, 
exp_Çt_dœ
);

331 
diff
 |ğ
	`EXP_DIFF_STRING
(
FN
, 
exp_â
);

332 
diff
 |ğ
	`EXP_DIFF_STRING
(
HELPER_NAME
, 
exp_h–³r_Çme
);

334 
diff
 |ğ
	`EXP_DIFF_ADDR
(
EXPECT_IP_SRC
, 
exp_ex³ù
.
¤c
);

335 
diff
 |ğ
	`EXP_DIFF_ADDR
(
EXPECT_IP_DST
, 
exp_ex³ù
.
d¡
);

336 
diff
 |ğ
	`EXP_DIFF_VAL
(
EXPECT_L4PROTO_NUM
, 
exp_ex³ù
.
´Ùo
.
l4´ÙÚum
);

337 
diff
 |ğ
	`EXP_DIFF_L4PROTO_PORTS
(
EXPECT_L4PROTO_PORTS
, 
exp_ex³ù
.
´Ùo
.
l4´Ùod©a
);

338 
diff
 |ğ
	`EXP_DIFF_L4PROTO_ICMP
(
EXPECT_L4PROTO_ICMP
, 
exp_ex³ù
.
´Ùo
.
l4´Ùod©a
);

340 
diff
 |ğ
	`EXP_DIFF_ADDR
(
MASTER_IP_SRC
, 
exp_ma¡”
.
¤c
);

341 
diff
 |ğ
	`EXP_DIFF_ADDR
(
MASTER_IP_DST
, 
exp_ma¡”
.
d¡
);

342 
diff
 |ğ
	`EXP_DIFF_VAL
(
MASTER_L4PROTO_NUM
, 
exp_ma¡”
.
´Ùo
.
l4´ÙÚum
);

343 
diff
 |ğ
	`EXP_DIFF_L4PROTO_PORTS
(
MASTER_L4PROTO_PORTS
, 
exp_ma¡”
.
´Ùo
.
l4´Ùod©a
);

344 
diff
 |ğ
	`EXP_DIFF_L4PROTO_ICMP
(
MASTER_L4PROTO_ICMP
, 
exp_ma¡”
.
´Ùo
.
l4´Ùod©a
);

346 
diff
 |ğ
	`EXP_DIFF_ADDR
(
MASK_IP_SRC
, 
exp_mask
.
¤c
);

347 
diff
 |ğ
	`EXP_DIFF_ADDR
(
MASK_IP_DST
, 
exp_mask
.
d¡
);

348 
diff
 |ğ
	`EXP_DIFF_VAL
(
MASK_L4PROTO_NUM
, 
exp_mask
.
´Ùo
.
l4´ÙÚum
);

349 
diff
 |ğ
	`EXP_DIFF_L4PROTO_PORTS
(
MASK_L4PROTO_PORTS
, 
exp_mask
.
´Ùo
.
l4´Ùod©a
);

350 
diff
 |ğ
	`EXP_DIFF_L4PROTO_ICMP
(
MASK_L4PROTO_ICMP
, 
exp_mask
.
´Ùo
.
l4´Ùod©a
);

352 
diff
 |ğ
	`EXP_DIFF_ADDR
(
NAT_IP_SRC
, 
exp_Çt
.
¤c
);

353 
diff
 |ğ
	`EXP_DIFF_ADDR
(
NAT_IP_DST
, 
exp_Çt
.
d¡
);

354 
diff
 |ğ
	`EXP_DIFF_VAL
(
NAT_L4PROTO_NUM
, 
exp_Çt
.
´Ùo
.
l4´ÙÚum
);

355 
diff
 |ğ
	`EXP_DIFF_L4PROTO_PORTS
(
NAT_L4PROTO_PORTS
, 
exp_Çt
.
´Ùo
.
l4´Ùod©a
);

356 
diff
 |ğ
	`EXP_DIFF_L4PROTO_ICMP
(
NAT_L4PROTO_ICMP
, 
exp_Çt
.
´Ùo
.
l4´Ùod©a
);

358 #undeà
EXP_DIFF


359 #undeà
EXP_DIFF_VAL


360 #undeà
EXP_DIFF_STRING


361 #undeà
EXP_DIFF_ADDR


362 #undeà
EXP_DIFF_L4PROTO_PORTS


363 #undeà
EXP_DIFF_L4PROTO_ICMP


365  
diff
;

366 
	}
}

369 cÚ¡ 
Œªs_tbl
 
	gexp_©Œs
[] = {

370 
__ADD
(
EXP_ATTR_FAMILY
, 
çmy
)

371 
__ADD
(
EXP_ATTR_TIMEOUT
, 
timeout
)

372 
__ADD
(
EXP_ATTR_ID
, 
id
)

373 
__ADD
(
EXP_ATTR_HELPER_NAME
, 
h–³ºame
)

374 
__ADD
(
EXP_ATTR_ZONE
, 
zÚe
)

375 
__ADD
(
EXP_ATTR_CLASS
, 
şass
)

376 
__ADD
(
EXP_ATTR_FLAGS
, 
æags
)

377 
__ADD
(
EXP_ATTR_FN
, 
funùiÚ
)

378 
__ADD
(
EXP_ATTR_EXPECT_IP_SRC
, 
ex³ù¤c
)

379 
__ADD
(
EXP_ATTR_EXPECT_IP_DST
, 
ex³ùd¡
)

380 
__ADD
(
EXP_ATTR_EXPECT_L4PROTO_NUM
, 
ex³ù´ÙÚum
)

381 
__ADD
(
EXP_ATTR_EXPECT_L4PROTO_PORTS
, 
ex³ùpÜts
)

382 
__ADD
(
EXP_ATTR_EXPECT_L4PROTO_ICMP
, 
ex³ùicmp
)

383 
__ADD
(
EXP_ATTR_MASTER_IP_SRC
, 
ma¡”¤c
)

384 
__ADD
(
EXP_ATTR_MASTER_IP_DST
, 
ma¡”d¡
)

385 
__ADD
(
EXP_ATTR_MASTER_L4PROTO_NUM
, 
ma¡”´ÙÚum
)

386 
__ADD
(
EXP_ATTR_MASTER_L4PROTO_PORTS
, 
ma¡”pÜts
)

387 
__ADD
(
EXP_ATTR_MASTER_L4PROTO_ICMP
, 
ma¡”icmp
)

388 
__ADD
(
EXP_ATTR_MASK_IP_SRC
, 
mask¤c
)

389 
__ADD
(
EXP_ATTR_MASK_IP_DST
, 
maskd¡
)

390 
__ADD
(
EXP_ATTR_MASK_L4PROTO_NUM
, 
mask´ÙÚum
)

391 
__ADD
(
EXP_ATTR_MASK_L4PROTO_PORTS
, 
maskpÜts
)

392 
__ADD
(
EXP_ATTR_MASK_L4PROTO_ICMP
, 
maskicmp
)

393 
__ADD
(
EXP_ATTR_NAT_IP_SRC
, 
Çt¤c
)

394 
__ADD
(
EXP_ATTR_NAT_IP_DST
, 
Çtd¡
)

395 
__ADD
(
EXP_ATTR_NAT_L4PROTO_NUM
, 
ÇrÙÚum
)

396 
__ADD
(
EXP_ATTR_NAT_L4PROTO_PORTS
, 
ÇÜts
)

397 
__ADD
(
EXP_ATTR_NAT_L4PROTO_ICMP
, 
Çticmp
)

398 
__ADD
(
EXP_ATTR_NAT_DIR
, 
Çtdœ
)

401 *
	$exp_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

403  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
exp_©Œs
, 
	`ARRAY_SIZE
(exp_attrs));

404 
	}
}

411 
nâl_exp
 *
	$nâl_exp_®loc
()

413  (
nâl_exp
 *è
	`Æ_objeù_®loc
(&
exp_obj_İs
);

414 
	}
}

416 
	$nâl_exp_g‘
(
nâl_exp
 *
exp
)

418 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
exp
);

419 
	}
}

421 
	$nâl_exp_put
(
nâl_exp
 *
exp
)

423 
	`Æ_objeù_put
((
Æ_objeù
 *è
exp
);

424 
	}
}

433 
	$nâl_exp_£t_çmy
(
nâl_exp
 *
exp
, 
ušt8_t
 
çmy
)

435 
exp
->
exp_çmy
 = 
çmy
;

436 
exp
->
û_mask
 |ğ
EXP_ATTR_FAMILY
;

437 
	}
}

439 
ušt8_t
 
	$nâl_exp_g‘_çmy
(cÚ¡ 
nâl_exp
 *
exp
)

441 ià(
exp
->
û_mask
 & 
EXP_ATTR_FAMILY
)

442  
exp
->
exp_çmy
;

444  
AF_UNSPEC
;

445 
	}
}

447 
	$nâl_exp_£t_æags
(
nâl_exp
 *
exp
, 
ušt32_t
 
æags
)

449 
exp
->
exp_æags
 |ğ
æags
;

450 
exp
->
û_mask
 |ğ
EXP_ATTR_FLAGS
;

451 
	}
}

453 
	$nâl_exp_‹¡_æags
(cÚ¡ 
nâl_exp
 *
exp
)

455  !!(
exp
->
û_mask
 & 
EXP_ATTR_FLAGS
);

456 
	}
}

458 
	$nâl_exp_un£t_æags
(
nâl_exp
 *
exp
, 
ušt32_t
 
æags
)

460 
exp
->
exp_æags
 &ğ~
æags
;

461 
exp
->
û_mask
 |ğ
EXP_ATTR_FLAGS
;

462 
	}
}

464 
ušt32_t
 
	$nâl_exp_g‘_æags
(cÚ¡ 
nâl_exp
 *
exp
)

466  
exp
->
exp_æags
;

467 
	}
}

469 cÚ¡ 
Œªs_tbl
 
	gæag_bË
[] = {

470 
__ADD
(
IPS_EXPECTED
, 
ex³ùed
)

471 
__ADD
(
IPS_SEEN_REPLY
, 
£’_»¶y
)

472 
__ADD
(
IPS_ASSURED
, 
assu»d
)

475 * 
	$nâl_exp_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

477  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
æag_bË
,

478 
	`ARRAY_SIZE
(
æag_bË
));

479 
	}
}

481 
	$nâl_exp_¡r2æags
(cÚ¡ *
Çme
)

483  
	`__¡r2æags
(
Çme
, 
æag_bË
, 
	`ARRAY_SIZE
(flag_table));

484 
	}
}

486 
	$nâl_exp_£t_timeout
(
nâl_exp
 *
exp
, 
ušt32_t
 
timeout
)

488 
exp
->
exp_timeout
 = 
timeout
;

489 
exp
->
û_mask
 |ğ
EXP_ATTR_TIMEOUT
;

490 
	}
}

492 
	$nâl_exp_‹¡_timeout
(cÚ¡ 
nâl_exp
 *
exp
)

494  !!(
exp
->
û_mask
 & 
EXP_ATTR_TIMEOUT
);

495 
	}
}

497 
ušt32_t
 
	$nâl_exp_g‘_timeout
(cÚ¡ 
nâl_exp
 *
exp
)

499  
exp
->
exp_timeout
;

500 
	}
}

502 
	$nâl_exp_£t_id
(
nâl_exp
 *
exp
, 
ušt32_t
 
id
)

504 
exp
->
exp_id
 = 
id
;

505 
exp
->
û_mask
 |ğ
EXP_ATTR_ID
;

506 
	}
}

508 
	$nâl_exp_‹¡_id
(cÚ¡ 
nâl_exp
 *
exp
)

510  !!(
exp
->
û_mask
 & 
EXP_ATTR_ID
);

511 
	}
}

513 
ušt32_t
 
	$nâl_exp_g‘_id
(cÚ¡ 
nâl_exp
 *
exp
)

515  
exp
->
exp_id
;

516 
	}
}

518 
	$nâl_exp_£t_h–³r_Çme
(
nâl_exp
 *
exp
, *
Çme
)

520 
	`ä“
(
exp
->
exp_h–³r_Çme
);

521 
exp
->
exp_h–³r_Çme
 = 
	`¡rdup
(
Çme
);

522 ià(!
exp
->
exp_h–³r_Çme
)

523  -
NLE_NOMEM
;

525 
exp
->
û_mask
 |ğ
EXP_ATTR_HELPER_NAME
;

527 
	}
}

529 
	$nâl_exp_‹¡_h–³r_Çme
(cÚ¡ 
nâl_exp
 *
exp
)

531  !!(
exp
->
û_mask
 & 
EXP_ATTR_HELPER_NAME
);

532 
	}
}

534 cÚ¡ * 
	$nâl_exp_g‘_h–³r_Çme
(cÚ¡ 
nâl_exp
 *
exp
)

536  
exp
->
exp_h–³r_Çme
;

537 
	}
}

539 
	$nâl_exp_£t_zÚe
(
nâl_exp
 *
exp
, 
ušt16_t
 
zÚe
)

541 
exp
->
exp_zÚe
 = 
zÚe
;

542 
exp
->
û_mask
 |ğ
EXP_ATTR_ZONE
;

543 
	}
}

545 
	$nâl_exp_‹¡_zÚe
(cÚ¡ 
nâl_exp
 *
exp
)

547  !!(
exp
->
û_mask
 & 
EXP_ATTR_ZONE
);

548 
	}
}

550 
ušt16_t
 
	$nâl_exp_g‘_zÚe
(cÚ¡ 
nâl_exp
 *
exp
)

552  
exp
->
exp_zÚe
;

553 
	}
}

555 
	$nâl_exp_£t_şass
(
nâl_exp
 *
exp
, 
ušt32_t
 
şass
)

557 
exp
->
exp_şass
 = 
şass
;

558 
exp
->
û_mask
 |ğ
EXP_ATTR_CLASS
;

559 
	}
}

561 
	$nâl_exp_‹¡_şass
(cÚ¡ 
nâl_exp
 *
exp
)

563  !!(
exp
->
û_mask
 & 
EXP_ATTR_CLASS
);

564 
	}
}

566 
ušt32_t
 
	$nâl_exp_g‘_şass
(cÚ¡ 
nâl_exp
 *
exp
)

568  
exp
->
exp_şass
;

569 
	}
}

571 
	$nâl_exp_£t_â
(
nâl_exp
 *
exp
, *
â
)

573 
	`ä“
(
exp
->
exp_â
);

574 
exp
->
exp_â
 = 
	`¡rdup
(
â
);

575 ià(!
exp
->
exp_â
)

576  -
NLE_NOMEM
;

578 
exp
->
û_mask
 |ğ
EXP_ATTR_FN
;

580 
	}
}

582 
	$nâl_exp_‹¡_â
(cÚ¡ 
nâl_exp
 *
exp
)

584  !!(
exp
->
û_mask
 & 
EXP_ATTR_FN
);

585 
	}
}

587 cÚ¡ * 
	$nâl_exp_g‘_â
(cÚ¡ 
nâl_exp
 *
exp
)

589  
exp
->
exp_â
;

590 
	}
}

592 
	$nâl_exp_£t_Çt_dœ
(
nâl_exp
 *
exp
, 
ušt8_t
 
Çt_dœ
)

594 
exp
->
exp_Çt_dœ
 = 
Çt_dœ
;

595 
exp
->
û_mask
 |ğ
EXP_ATTR_NAT_DIR
;

596 
	}
}

598 
	$nâl_exp_‹¡_Çt_dœ
(cÚ¡ 
nâl_exp
 *
exp
)

600  !!(
exp
->
û_mask
 & 
EXP_ATTR_NAT_DIR
);

601 
	}
}

603 
ušt8_t
 
	$nâl_exp_g‘_Çt_dœ
(cÚ¡ 
nâl_exp
 *
exp
)

605  
exp
->
exp_Çt_dœ
;

606 
	}
}

608 
	#EXP_GET_TUPLE
(
e
, 
t
) \

609 (
t
 =ğ
NFNL_EXP_TUPLE_MASTER
) ? \

610 &(
e
->
exp_ma¡”
) : \

611 (
t
 =ğ
NFNL_EXP_TUPLE_MASK
) ? \

612 &(
e
->
exp_mask
) : \

613 (
t
 =ğ
NFNL_EXP_TUPLE_NAT
) ? \

614 &(
e
->
exp_Çt
è: &(
exp
->
exp_ex³ù
)

	)

616 
	$exp_g‘_¤c_©Œ
(
tu¶e
)

618 
©Œ
 = 0;

620 
tu¶e
) {

621 
NFNL_EXP_TUPLE_MASTER
:

622 
©Œ
 = 
EXP_ATTR_MASTER_IP_SRC
;

624 
NFNL_EXP_TUPLE_MASK
:

625 
©Œ
 = 
EXP_ATTR_MASK_IP_SRC
;

627 
NFNL_EXP_TUPLE_NAT
:

628 
©Œ
 = 
EXP_ATTR_NAT_IP_SRC
;

630 
NFNL_EXP_TUPLE_EXPECT
:

632 
©Œ
 = 
EXP_ATTR_EXPECT_IP_SRC
;

635  
©Œ
;

636 
	}
}

638 
	$exp_g‘_d¡_©Œ
(
tu¶e
)

640 
©Œ
 = 0;

642 
tu¶e
) {

643 
NFNL_EXP_TUPLE_MASTER
:

644 
©Œ
 = 
EXP_ATTR_MASTER_IP_DST
;

646 
NFNL_EXP_TUPLE_MASK
:

647 
©Œ
 = 
EXP_ATTR_MASK_IP_DST
;

649 
NFNL_EXP_TUPLE_NAT
:

650 
©Œ
 = 
EXP_ATTR_NAT_IP_DST
;

652 
NFNL_EXP_TUPLE_EXPECT
:

654 
©Œ
 = 
EXP_ATTR_EXPECT_IP_DST
;

657  
©Œ
;

658 
	}
}

661 
	$exp_£t_addr
(
nâl_exp
 *
exp
, 
Æ_addr
 *
addr
,

662 
©Œ
, 
Æ_addr
 ** 
exp_addr
)

664 ià(
exp
->
û_mask
 & 
EXP_ATTR_FAMILY
) {

665 ià(
addr
->
a_çmy
 !ğ
exp
->
exp_çmy
)

666  -
NLE_AF_MISMATCH
;

668 
	`nâl_exp_£t_çmy
(
exp
, 
addr
->
a_çmy
);

670 ià(*
exp_addr
)

671 
	`Æ_addr_put
(*
exp_addr
);

673 
	`Æ_addr_g‘
(
addr
);

674 *
exp_addr
 = 
addr
;

675 
exp
->
û_mask
 |ğ
©Œ
;

678 
	}
}

680 
	$nâl_exp_£t_¤c
(
nâl_exp
 *
exp
, 
tu¶e
, 
Æ_addr
 *
addr
)

682 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

684  
	`exp_£t_addr
(
exp
, 
addr
, 
	`exp_g‘_¤c_©Œ
(
tu¶e
), &
dœ
->
¤c
);

685 
	}
}

687 
	$nâl_exp_£t_d¡
(
nâl_exp
 *
exp
, 
tu¶e
, 
Æ_addr
 *
addr
)

689 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

691  
	`exp_£t_addr
(
exp
, 
addr
, 
	`exp_g‘_d¡_©Œ
(
tu¶e
), &
dœ
->
d¡
);

692 
	}
}

694 
	$nâl_exp_‹¡_¤c
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

696  !!(
exp
->
û_mask
 & 
	`exp_g‘_¤c_©Œ
(
tu¶e
));

697 
	}
}

699 
	$nâl_exp_‹¡_d¡
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

701  !!(
exp
->
û_mask
 & 
	`exp_g‘_d¡_©Œ
(
tu¶e
));

702 
	}
}

704 
Æ_addr
 *
	$nâl_exp_g‘_¤c
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

706 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

708 ià(!(
exp
->
û_mask
 & 
	`exp_g‘_¤c_©Œ
(
tu¶e
)))

709  
NULL
;

710  
dœ
->
¤c
;

711 
	}
}

713 
Æ_addr
 *
	$nâl_exp_g‘_d¡
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

715 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

717 ià(!(
exp
->
û_mask
 & 
	`exp_g‘_d¡_©Œ
(
tu¶e
)))

718  
NULL
;

719  
dœ
->
d¡
;

720 
	}
}

722 
	$exp_g‘_l4´ÙÚum_©Œ
(
tu¶e
)

724 
©Œ
 = 0;

726 
tu¶e
) {

727 
NFNL_EXP_TUPLE_MASTER
:

728 
©Œ
 = 
EXP_ATTR_MASTER_L4PROTO_NUM
;

730 
NFNL_EXP_TUPLE_MASK
:

731 
©Œ
 = 
EXP_ATTR_MASK_L4PROTO_NUM
;

733 
NFNL_EXP_TUPLE_NAT
:

734 
©Œ
 = 
EXP_ATTR_NAT_L4PROTO_NUM
;

736 
NFNL_EXP_TUPLE_EXPECT
:

738 
©Œ
 = 
EXP_ATTR_EXPECT_L4PROTO_NUM
;

741  
©Œ
;

742 
	}
}

744 
	$nâl_exp_£t_l4´ÙÚum
(
nâl_exp
 *
exp
, 
tu¶e
, 
ušt8_t
 
l4´ÙÚum
)

746 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

748 
dœ
->
´Ùo
.
l4´ÙÚum
 =†4protonum;

749 
exp
->
û_mask
 |ğ
	`exp_g‘_l4´ÙÚum_©Œ
(
tu¶e
);

750 
	}
}

752 
	$nâl_exp_‹¡_l4´ÙÚum
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

754  !!(
exp
->
û_mask
 & 
	`exp_g‘_l4´ÙÚum_©Œ
(
tu¶e
));

755 
	}
}

757 
ušt8_t
 
	$nâl_exp_g‘_l4´ÙÚum
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

759 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

760  
dœ
->
´Ùo
.
l4´ÙÚum
;

761 
	}
}

763 
	$exp_g‘_l4pÜts_©Œ
(
tu¶e
)

765 
©Œ
 = 0;

767 
tu¶e
) {

768 
NFNL_EXP_TUPLE_MASTER
:

769 
©Œ
 = 
EXP_ATTR_MASTER_L4PROTO_PORTS
;

771 
NFNL_EXP_TUPLE_MASK
:

772 
©Œ
 = 
EXP_ATTR_MASK_L4PROTO_PORTS
;

774 
NFNL_EXP_TUPLE_NAT
:

775 
©Œ
 = 
EXP_ATTR_NAT_L4PROTO_PORTS
;

777 
NFNL_EXP_TUPLE_EXPECT
:

779 
©Œ
 = 
EXP_ATTR_EXPECT_L4PROTO_PORTS
;

782  
©Œ
;

783 
	}
}

785 
	$nâl_exp_£t_pÜts
(
nâl_exp
 *
exp
, 
tu¶e
, 
ušt16_t
 
¤ıÜt
, ušt16_ˆ
d¡pÜt
)

787 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

789 
dœ
->
´Ùo
.
l4´Ùod©a
.
pÜt
.
¤c
 = 
¤ıÜt
;

790 
dœ
->
´Ùo
.
l4´Ùod©a
.
pÜt
.
d¡
 = 
d¡pÜt
;

792 
exp
->
û_mask
 |ğ
	`exp_g‘_l4pÜts_©Œ
(
tu¶e
);

793 
	}
}

795 
	$nâl_exp_‹¡_pÜts
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

797  !!(
exp
->
û_mask
 & 
	`exp_g‘_l4pÜts_©Œ
(
tu¶e
));

798 
	}
}

800 
ušt16_t
 
	$nâl_exp_g‘_¤c_pÜt
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

802 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

803  
dœ
->
´Ùo
.
l4´Ùod©a
.
pÜt
.
¤c
;

804 
	}
}

806 
ušt16_t
 
	$nâl_exp_g‘_d¡_pÜt
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

808 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

810  
dœ
->
´Ùo
.
l4´Ùod©a
.
pÜt
.
d¡
;

811 
	}
}

813 
	$exp_g‘_l4icmp_©Œ
(
tu¶e
)

815 
©Œ
 = 0;

817 
tu¶e
) {

818 
NFNL_EXP_TUPLE_MASTER
:

819 
©Œ
 = 
EXP_ATTR_MASTER_L4PROTO_ICMP
;

821 
NFNL_EXP_TUPLE_MASK
:

822 
©Œ
 = 
EXP_ATTR_MASK_L4PROTO_ICMP
;

824 
NFNL_EXP_TUPLE_NAT
:

825 
©Œ
 = 
EXP_ATTR_NAT_L4PROTO_ICMP
;

827 
NFNL_EXP_TUPLE_EXPECT
:

829 
©Œ
 = 
EXP_ATTR_EXPECT_L4PROTO_ICMP
;

832  
©Œ
;

833 
	}
}

835 
	$nâl_exp_£t_icmp
(
nâl_exp
 *
exp
, 
tu¶e
, 
ušt16_t
 
id
, 
ušt8_t
 
ty³
, ušt8_ˆ
code
)

837 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

839 
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
id
 = id;

840 
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
ty³
 =ype;

841 
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
code
 = code;

843 
exp
->
û_mask
 |ğ
	`exp_g‘_l4icmp_©Œ
(
tu¶e
);

844 
	}
}

846 
	$nâl_exp_‹¡_icmp
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

848 
©Œ
 = 
	`exp_g‘_l4icmp_©Œ
(
tu¶e
);

849  !!(
exp
->
û_mask
 & 
©Œ
);

850 
	}
}

852 
ušt16_t
 
	$nâl_exp_g‘_icmp_id
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

854 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

856  
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
id
;

857 
	}
}

859 
ušt8_t
 
	$nâl_exp_g‘_icmp_ty³
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

861 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

863  
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
ty³
;

864 
	}
}

866 
ušt8_t
 
	$nâl_exp_g‘_icmp_code
(cÚ¡ 
nâl_exp
 *
exp
, 
tu¶e
)

868 cÚ¡ 
nâl_exp_dœ
 *
dœ
 = 
	`EXP_GET_TUPLE
(
exp
, 
tu¶e
);

870  
dœ
->
´Ùo
.
l4´Ùod©a
.
icmp
.
code
;

871 
	}
}

875 
Æ_objeù_İs
 
	gexp_obj_İs
 = {

876 .
oo_Çme
 = "netfilter/exp",

877 .
	goo_size
 = (
nâl_exp
),

878 .
	goo_ä“_d©a
 = 
exp_ä“_d©a
,

879 .
	goo_şÚe
 = 
exp_şÚe
,

880 .
	goo_dump
 = {

881 [
NL_DUMP_LINE
] = 
exp_dump_lše
,

882 [
NL_DUMP_DETAILS
] = 
exp_dump_d‘as
,

884 .
	goo_com·»
 = 
exp_com·»
,

885 .
	goo_©Œs2¡r
 = 
exp_©Œs2¡r
,

	@mylibnl/libnl-3.2.25/lib/netfilter/log.c

21 
	~<sys/ty³s.h
>

22 
	~<lšux/Ãtf‹r/nâ‘lšk_log.h
>

24 
	~<Ãšk-´iv©e/Ãšk.h
>

25 
	~<Ãšk/©Œ.h
>

26 
	~<Ãšk/Ãtf‹r/nâl.h
>

27 
	~<Ãšk/Ãtf‹r/log.h
>

34 
	$bud_log_cmd_»que¡
(
ušt8_t
 
çmy
, 
ušt16_t
 
queu’um
,

35 
ušt8_t
 
commªd
, 
Æ_msg
 **
»suÉ
)

37 
Æ_msg
 *
msg
;

38 
nfuÊl_msg_cÚfig_cmd
 
cmd
;

40 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_ULOG
, 
NFULNL_MSG_CONFIG
, 0,

41 
çmy
, 
queu’um
);

42 ià(
msg
 =ğ
NULL
)

43  -
NLE_NOMEM
;

45 
cmd
.
commªd
 = command;

46 ià(
	`Æa_put
(
msg
, 
NFULA_CFG_CMD
, (
cmd
), &cmd) < 0)

47 
Æa_put_çu»
;

49 *
»suÉ
 = 
msg
;

52 
Æa_put_çu»
:

53 
	`Æmsg_ä“
(
msg
);

54  -
NLE_MSGSIZE
;

55 
	}
}

57 
	$£nd_log_»que¡
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

59 
”r
;

61 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

62 
	`Æmsg_ä“
(
msg
);

63 ià(
”r
 < 0)

64  
”r
;

66  
	`wa™_fÜ_ack
(
sk
);

67 
	}
}

69 
	$nâl_log_bud_pf_bšd
(
ušt8_t
 
pf
, 
Æ_msg
 **
»suÉ
)

71  
	`bud_log_cmd_»que¡
(
pf
, 0, 
NFULNL_CFG_CMD_PF_BIND
, 
»suÉ
);

72 
	}
}

74 
	$nâl_log_pf_bšd
(
Æ_sock
 *
Æh
, 
ušt8_t
 
pf
)

76 
Æ_msg
 *
msg
;

77 
”r
;

79 ià((
”r
 = 
	`nâl_log_bud_pf_bšd
(
pf
, &
msg
)) < 0)

80  
”r
;

82  
	`£nd_log_»que¡
(
Æh
, 
msg
);

83 
	}
}

85 
	$nâl_log_bud_pf_unbšd
(
ušt8_t
 
pf
, 
Æ_msg
 **
»suÉ
)

87  
	`bud_log_cmd_»que¡
(
pf
, 0, 
NFULNL_CFG_CMD_PF_UNBIND
, 
»suÉ
);

88 
	}
}

90 
	$nâl_log_pf_unbšd
(
Æ_sock
 *
Æh
, 
ušt8_t
 
pf
)

92 
Æ_msg
 *
msg
;

93 
”r
;

95 ià((
”r
 = 
	`nâl_log_bud_pf_unbšd
(
pf
, &
msg
)) < 0)

96  
”r
;

98  
	`£nd_log_»que¡
(
Æh
, 
msg
);

99 
	}
}

101 
	$nâl_log_bud_»que¡
(cÚ¡ 
nâl_log
 *
log
,

102 
Æ_msg
 **
»suÉ
)

104 
Æ_msg
 *
msg
;

106 ià(!
	`nâl_log_‹¡_group
(
log
))

107  -
NLE_MISSING_ATTR
;

109 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_ULOG
, 
NFULNL_MSG_CONFIG
, 0,

110 0, 
	`nâl_log_g‘_group
(
log
));

111 ià(
msg
 =ğ
NULL
)

112  -
NLE_NOMEM
;

117 ià(
	`nâl_log_‹¡_cİy_mode
(
log
)) {

118 
nfuÊl_msg_cÚfig_mode
 
mode
;

120 
	`nâl_log_g‘_cİy_mode
(
log
)) {

121 
NFNL_LOG_COPY_NONE
:

122 
mode
.
cİy_mode
 = 
NFULNL_COPY_NONE
;

124 
NFNL_LOG_COPY_META
:

125 
mode
.
cİy_mode
 = 
NFULNL_COPY_META
;

127 
NFNL_LOG_COPY_PACKET
:

128 
mode
.
cİy_mode
 = 
NFULNL_COPY_PACKET
;

131 
mode
.
cİy_¿nge
 = 
	`htÚl
(
	`nâl_log_g‘_cİy_¿nge
(
log
));

132 
mode
.
_·d
 = 0;

134 ià(
	`Æa_put
(
msg
, 
NFULA_CFG_MODE
, (
mode
), &mode) < 0)

135 
Æa_put_çu»
;

138 ià(
	`nâl_log_‹¡_æush_timeout
(
log
) &&

139 
	`Æa_put_u32
(
msg
, 
NFULA_CFG_TIMEOUT
,

140 
	`htÚl
(
	`nâl_log_g‘_æush_timeout
(
log
))) < 0)

141 
Æa_put_çu»
;

143 ià(
	`nâl_log_‹¡_®loc_size
(
log
) &&

144 
	`Æa_put_u32
(
msg
, 
NFULA_CFG_NLBUFSIZ
,

145 
	`htÚl
(
	`nâl_log_g‘_®loc_size
(
log
))) < 0)

146 
Æa_put_çu»
;

148 ià(
	`nâl_log_‹¡_queue_th»shŞd
(
log
) &&

149 
	`Æa_put_u32
(
msg
, 
NFULA_CFG_QTHRESH
,

150 
	`htÚl
(
	`nâl_log_g‘_queue_th»shŞd
(
log
))) < 0)

151 
Æa_put_çu»
;

153 *
»suÉ
 = 
msg
;

156 
Æa_put_çu»
:

157 
	`Æmsg_ä“
(
msg
);

158  -
NLE_MSGSIZE
;

159 
	}
}

161 
	$nâl_log_bud_ü—‹_»que¡
(cÚ¡ 
nâl_log
 *
log
,

162 
Æ_msg
 **
»suÉ
)

164 
nfuÊl_msg_cÚfig_cmd
 
cmd
;

165 
”r
;

167 ià((
”r
 = 
	`nâl_log_bud_»que¡
(
log
, 
»suÉ
)) < 0)

168  
”r
;

170 
cmd
.
commªd
 = 
NFULNL_CFG_CMD_BIND
;

172 ià(
	`Æa_put
(*
»suÉ
, 
NFULA_CFG_CMD
, (
cmd
), &cmd) < 0)

173 
Æa_put_çu»
;

177 
Æa_put_çu»
:

178 
	`Æmsg_ä“
(*
»suÉ
);

179  -
NLE_MSGSIZE
;

180 
	}
}

182 
	$nâl_log_ü—‹
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_log
 *
log
)

184 
Æ_msg
 *
msg
;

185 
”r
;

187 ià((
”r
 = 
	`nâl_log_bud_ü—‹_»que¡
(
log
, &
msg
)) < 0)

188  
”r
;

190  
	`£nd_log_»que¡
(
Æh
, 
msg
);

191 
	}
}

193 
	$nâl_log_bud_chªge_»que¡
(cÚ¡ 
nâl_log
 *
log
,

194 
Æ_msg
 **
»suÉ
)

196  
	`nâl_log_bud_»que¡
(
log
, 
»suÉ
);

197 
	}
}

199 
	$nâl_log_chªge
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_log
 *
log
)

201 
Æ_msg
 *
msg
;

202 
”r
;

204 ià((
”r
 = 
	`nâl_log_bud_chªge_»que¡
(
log
, &
msg
)) < 0)

205  
”r
;

207  
	`£nd_log_»que¡
(
Æh
, 
msg
);

208 
	}
}

210 
	$nâl_log_bud_d–‘e_»que¡
(cÚ¡ 
nâl_log
 *
log
,

211 
Æ_msg
 **
»suÉ
)

213 ià(!
	`nâl_log_‹¡_group
(
log
))

214  -
NLE_MISSING_ATTR
;

216  
	`bud_log_cmd_»que¡
(0, 
	`nâl_log_g‘_group
(
log
),

217 
NFULNL_CFG_CMD_UNBIND
, 
»suÉ
);

218 
	}
}

220 
	$nâl_log_d–‘e
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_log
 *
log
)

222 
Æ_msg
 *
msg
;

223 
”r
;

225 ià((
”r
 = 
	`nâl_log_bud_d–‘e_»que¡
(
log
, &
msg
)) < 0)

226  
”r
;

228  
	`£nd_log_»que¡
(
Æh
, 
msg
);

229 
	}
}

233 
Æ_ÿche_İs
 
	gnâl_log_İs
 = {

234 .
co_Çme
 = "netfilter/log",

235 .
	gco_obj_İs
 = &
log_obj_İs
,

236 .
	gco_msgty³s
 = {

237 
END_OF_MSGTYPES_LIST
,

241 
__š™
 
	$log_š™
()

243 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_log_İs
);

244 
	}
}

246 
__ex™
 
	$log_ex™
()

248 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_log_İs
);

249 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/log_msg.c

22 
	~<sys/ty³s.h
>

23 
	~<lšux/Ãtf‹r/nâ‘lšk_log.h
>

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/©Œ.h
>

27 
	~<Ãšk/Ãtf‹r/nâl.h
>

28 
	~<Ãšk/Ãtf‹r/log_msg.h
>

29 
	~<by‹sw­.h
>

31 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


32 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

34  
x
;

35 
	}
}

36 #–ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


37 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

39  
	`bsw­_64
(
x
);

40 
	}
}

43 
Æa_pŞicy
 
	glog_msg_pŞicy
[
NFULA_MAX
+1] = {

44 [
NFULA_PACKET_HDR
] = {

45 .
mšËn
 = (
nfuÊl_msg_·ck‘_hdr
)

47 [
NFULA_MARK
] = { .
ty³
 = 
NLA_U32
 },

48 [
NFULA_TIMESTAMP
] = {

49 .
mšËn
 = (
nfuÊl_msg_·ck‘_time¡amp
)

51 [
NFULA_IFINDEX_INDEV
] = { .
ty³
 = 
NLA_U32
 },

52 [
NFULA_IFINDEX_OUTDEV
] = { .
ty³
 = 
NLA_U32
 },

53 [
NFULA_IFINDEX_PHYSINDEV
] = { .
ty³
 = 
NLA_U32
 },

54 [
NFULA_IFINDEX_PHYSOUTDEV
] = { .
ty³
 = 
NLA_U32
 },

55 [
NFULA_HWADDR
] = {

56 .
mšËn
 = (
nfuÊl_msg_·ck‘_hw
)

59 [
NFULA_PREFIX
] = { .
ty³
 = 
NLA_STRING
, },

60 [
NFULA_UID
] = { .
ty³
 = 
NLA_U32
 },

61 [
NFULA_GID
] = { .
ty³
 = 
NLA_U32
 },

62 [
NFULA_SEQ
] = { .
ty³
 = 
NLA_U32
 },

63 [
NFULA_SEQ_GLOBAL
] = { .
ty³
 = 
NLA_U32
 },

66 
	$nâlmsg_log_msg_·r£
(
Æmsghdr
 *
Æh
, 
nâl_log_msg
 **
»suÉ
)

68 
nâl_log_msg
 *
msg
;

69 
Æ©Œ
 *
tb
[
NFULA_MAX
+1];

70 
Æ©Œ
 *
©Œ
;

71 
”r
;

73 
msg
 = 
	`nâl_log_msg_®loc
();

74 ià(!
msg
)

75  -
NLE_NOMEM
;

77 
msg
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

79 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
nfg’msg
), 
tb
, 
NFULA_MAX
,

80 
log_msg_pŞicy
);

81 ià(
”r
 < 0)

82 
”rout
;

84 
	`nâl_log_msg_£t_çmy
(
msg
, 
	`nâlmsg_çmy
(
Æh
));

86 
©Œ
 = 
tb
[
NFULA_PACKET_HDR
];

87 ià(
©Œ
) {

88 
nfuÊl_msg_·ck‘_hdr
 *
hdr
 = 
	`Æa_d©a
(
©Œ
);

90 ià(
hdr
->
hw_´ÙocŞ
)

91 
	`nâl_log_msg_£t_hw´Ùo
(
msg
, 
hdr
->
hw_´ÙocŞ
);

92 
	`nâl_log_msg_£t_hook
(
msg
, 
hdr
->
hook
);

95 
©Œ
 = 
tb
[
NFULA_MARK
];

96 ià(
©Œ
)

97 
	`nâl_log_msg_£t_m¬k
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

99 
©Œ
 = 
tb
[
NFULA_TIMESTAMP
];

100 ià(
©Œ
) {

101 
nfuÊl_msg_·ck‘_time¡amp
 *
time¡amp
 = 
	`Æa_d©a
(
©Œ
);

102 
timev®
 
tv
;

104 
tv
.
tv_£c
 = 
	`ÁohÎ
(
time¡amp
->
£c
);

105 
tv
.
tv_u£c
 = 
	`ÁohÎ
(
time¡amp
->
u£c
);

106 
	`nâl_log_msg_£t_time¡amp
(
msg
, &
tv
);

109 
©Œ
 = 
tb
[
NFULA_IFINDEX_INDEV
];

110 ià(
©Œ
)

111 
	`nâl_log_msg_£t_šdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

113 
©Œ
 = 
tb
[
NFULA_IFINDEX_OUTDEV
];

114 ià(
©Œ
)

115 
	`nâl_log_msg_£t_outdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

117 
©Œ
 = 
tb
[
NFULA_IFINDEX_PHYSINDEV
];

118 ià(
©Œ
)

119 
	`nâl_log_msg_£t_physšdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

121 
©Œ
 = 
tb
[
NFULA_IFINDEX_PHYSOUTDEV
];

122 ià(
©Œ
)

123 
	`nâl_log_msg_£t_physoutdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

125 
©Œ
 = 
tb
[
NFULA_HWADDR
];

126 ià(
©Œ
) {

127 
nfuÊl_msg_·ck‘_hw
 *
hw
 = 
	`Æa_d©a
(
©Œ
);

129 
	`nâl_log_msg_£t_hwaddr
(
msg
, 
hw
->
hw_addr
, 
	`Áohs
(hw->
hw_add¾’
));

132 
©Œ
 = 
tb
[
NFULA_PAYLOAD
];

133 ià(
©Œ
) {

134 
”r
 = 
	`nâl_log_msg_£t_·ylßd
(
msg
, 
	`Æa_d©a
(
©Œ
), 
	`Æa_Ën
(attr));

135 ià(
”r
 < 0)

136 
”rout
;

139 
©Œ
 = 
tb
[
NFULA_PREFIX
];

140 ià(
©Œ
) {

141 
”r
 = 
	`nâl_log_msg_£t_´efix
(
msg
, 
	`Æa_d©a
(
©Œ
));

142 ià(
”r
 < 0)

143 
”rout
;

146 
©Œ
 = 
tb
[
NFULA_UID
];

147 ià(
©Œ
)

148 
	`nâl_log_msg_£t_uid
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

150 
©Œ
 = 
tb
[
NFULA_GID
];

151 ià(
©Œ
)

152 
	`nâl_log_msg_£t_gid
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

154 
©Œ
 = 
tb
[
NFULA_SEQ
];

155 ià(
©Œ
)

156 
	`nâl_log_msg_£t_£q
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

158 
©Œ
 = 
tb
[
NFULA_SEQ_GLOBAL
];

159 ià(
©Œ
)

160 
	`nâl_log_msg_£t_£q_glob®
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

162 *
»suÉ
 = 
msg
;

165 
”rout
:

166 
	`nâl_log_msg_put
(
msg
);

167  
”r
;

168 
	}
}

170 
	$log_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

171 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

173 
nâl_log_msg
 *
msg
;

174 
”r
;

176 ià((
”r
 = 
	`nâlmsg_log_msg_·r£
(
Æh
, &
msg
)) < 0)

177  
”r
;

179 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
msg
,…p);

180 
	`nâl_log_msg_put
(
msg
);

181  
”r
;

182 
	}
}

186 
	#NFNLMSG_LOG_TYPE
(
ty³
è
	`NFNLMSG_TYPE
(
NFNL_SUBSYS_ULOG
, (ty³))

	)

187 
Æ_ÿche_İs
 
	gnâl_log_msg_İs
 = {

188 .
co_Çme
 = "netfilter/log_msg",

189 .
	gco_hdrsize
 = 
NFNL_HDRLEN
,

190 .
	gco_msgty³s
 = {

191 { 
NFNLMSG_LOG_TYPE
(
NFULNL_MSG_PACKET
), 
NL_ACT_NEW
, "new" },

192 
END_OF_MSGTYPES_LIST
,

194 .
	gco_´ÙocŞ
 = 
NETLINK_NETFILTER
,

195 .
	gco_msg_·r£r
 = 
log_msg_·r£r
,

196 .
	gco_obj_İs
 = &
log_msg_obj_İs
,

199 
__š™
 
	$log_msg_š™
()

201 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_log_msg_İs
);

202 
	}
}

204 
__ex™
 
	$log_msg_ex™
()

206 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_log_msg_İs
);

207 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/log_msg_obj.c

14 
	~<Ãšk-´iv©e/Ãšk.h
>

15 
	~<Ãšk/Ãtf‹r/nâl.h
>

16 
	~<Ãšk/Ãtf‹r/Ãtf‹r.h
>

17 
	~<Ãšk/Ãtf‹r/log_msg.h
>

20 
	#LOG_MSG_ATTR_FAMILY
 (1UL << 0)

	)

21 
	#LOG_MSG_ATTR_HWPROTO
 (1UL << 1)

	)

22 
	#LOG_MSG_ATTR_HOOK
 (1UL << 2)

	)

23 
	#LOG_MSG_ATTR_MARK
 (1UL << 3)

	)

24 
	#LOG_MSG_ATTR_TIMESTAMP
 (1UL << 4)

	)

25 
	#LOG_MSG_ATTR_INDEV
 (1UL << 5)

	)

26 
	#LOG_MSG_ATTR_OUTDEV
 (1UL << 6)

	)

27 
	#LOG_MSG_ATTR_PHYSINDEV
 (1UL << 7)

	)

28 
	#LOG_MSG_ATTR_PHYSOUTDEV
 (1UL << 8)

	)

29 
	#LOG_MSG_ATTR_HWADDR
 (1UL << 9)

	)

30 
	#LOG_MSG_ATTR_PAYLOAD
 (1UL << 10)

	)

31 
	#LOG_MSG_ATTR_PREFIX
 (1UL << 11)

	)

32 
	#LOG_MSG_ATTR_UID
 (1UL << 12)

	)

33 
	#LOG_MSG_ATTR_GID
 (1UL << 13)

	)

34 
	#LOG_MSG_ATTR_SEQ
 (1UL << 14)

	)

35 
	#LOG_MSG_ATTR_SEQ_GLOBAL
 (1UL << 15)

	)

38 
	$log_msg_ä“_d©a
(
Æ_objeù
 *
c
)

40 
nâl_log_msg
 *
msg
 = (nâl_log_msg *è
c
;

42 ià(
msg
 =ğ
NULL
)

45 
	`ä“
(
msg
->
log_msg_·ylßd
);

46 
	`ä“
(
msg
->
log_msg_´efix
);

47 
	}
}

49 
	$log_msg_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

51 
nâl_log_msg
 *
d¡
 = (nâl_log_msg *è
_d¡
;

52 
nâl_log_msg
 *
¤c
 = (nâl_log_msg *è
_¤c
;

53 
”r
;

55 ià(
¤c
->
log_msg_·ylßd
) {

56 
”r
 = 
	`nâl_log_msg_£t_·ylßd
(
d¡
, 
¤c
->
log_msg_·ylßd
,

57 
¤c
->
log_msg_·ylßd_Ën
);

58 ià(
”r
 < 0)

59 
”rout
;

62 ià(
¤c
->
log_msg_´efix
) {

63 
”r
 = 
	`nâl_log_msg_£t_´efix
(
d¡
, 
¤c
->
log_msg_´efix
);

64 ià(
”r
 < 0)

65 
”rout
;

69 
”rout
:

70  
”r
;

71 
	}
}

73 
	$log_msg_dump
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

75 
nâl_log_msg
 *
msg
 = (nâl_log_msg *è
a
;

76 
Æ_ÿche
 *
lšk_ÿche
;

77 
buf
[64];

79 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

81 
	`Æ_Ãw_lše
(
p
);

83 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_PREFIX
)

84 
	`Æ_dump
(
p
, "%s", 
msg
->
log_msg_´efix
);

86 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_INDEV
) {

87 ià(
lšk_ÿche
)

88 
	`Æ_dump
(
p
, "IN=%s ",

89 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

90 
msg
->
log_msg_šdev
,

91 
buf
, (buf)));

93 
	`Æ_dump
(
p
, "IN=%d ", 
msg
->
log_msg_šdev
);

96 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_PHYSINDEV
) {

97 ià(
lšk_ÿche
)

98 
	`Æ_dump
(
p
, "PHYSIN=%s ",

99 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

100 
msg
->
log_msg_physšdev
,

101 
buf
, (buf)));

103 
	`Æ_dump
(
p
, "IN=%d ", 
msg
->
log_msg_physšdev
);

106 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_OUTDEV
) {

107 ià(
lšk_ÿche
)

108 
	`Æ_dump
(
p
, "OUT=%s ",

109 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

110 
msg
->
log_msg_outdev
,

111 
buf
, (buf)));

113 
	`Æ_dump
(
p
, "OUT=%d ", 
msg
->
log_msg_outdev
);

116 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_PHYSOUTDEV
) {

117 ià(
lšk_ÿche
)

118 
	`Æ_dump
(
p
, "PHYSOUT=%s ",

119 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

120 
msg
->
log_msg_physoutdev
,

121 
buf
, (buf)));

123 
	`Æ_dump
(
p
, "PHYSOUT=%d ", 
msg
->
log_msg_physoutdev
);

126 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HWADDR
) {

127 
i
;

129 
	`Æ_dump
(
p
, "MAC");

130 
i
 = 0; i < 
msg
->
log_msg_hwaddr_Ën
; i++)

131 
	`Æ_dump
(
p
, "%c%02x", 
i
?':':'=', 
msg
->
log_msg_hwaddr
[i]);

132 
	`Æ_dump
(
p
, " ");

137 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_FAMILY
)

138 
	`Æ_dump
(
p
, "FAMILY=%s ",

139 
	`Æ_af2¡r
(
msg
->
log_msg_çmy
, 
buf
, (buf)));

141 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HWPROTO
)

142 
	`Æ_dump
(
p
, "HWPROTO=%s ",

143 
	`Æ_‘h”_´Ùo2¡r
(
	`Áohs
(
msg
->
log_msg_hw´Ùo
),

144 
buf
, (buf)));

146 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HOOK
)

147 
	`Æ_dump
(
p
, "HOOK=%s ",

148 
	`nâl_š‘_hook2¡r
(
msg
->
log_msg_hook
,

149 
buf
, (buf)));

151 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_MARK
)

152 
	`Æ_dump
(
p
, "MARK=%u ", 
msg
->
log_msg_m¬k
);

154 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_PAYLOAD
)

155 
	`Æ_dump
(
p
, "PAYLOADLEN=%d ", 
msg
->
log_msg_·ylßd_Ën
);

157 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_UID
)

158 
	`Æ_dump
(
p
, "UID=%u ", 
msg
->
log_msg_uid
);

160 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_GID
)

161 
	`Æ_dump
(
p
, "GID=%u ", 
msg
->
log_msg_gid
);

163 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_SEQ
)

164 
	`Æ_dump
(
p
, "SEQ=%d ", 
msg
->
log_msg_£q
);

166 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_SEQ_GLOBAL
)

167 
	`Æ_dump
(
p
, "SEQGLOBAL=%d ", 
msg
->
log_msg_£q_glob®
);

169 
	`Æ_dump
(
p
, "\n");

171 ià(
lšk_ÿche
)

172 
	`Æ_ÿche_put
(
lšk_ÿche
);

173 
	}
}

180 
nâl_log_msg
 *
	$nâl_log_msg_®loc
()

182  (
nâl_log_msg
 *è
	`Æ_objeù_®loc
(&
log_msg_obj_İs
);

183 
	}
}

185 
	$nâl_log_msg_g‘
(
nâl_log_msg
 *
msg
)

187 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
msg
);

188 
	}
}

190 
	$nâl_log_msg_put
(
nâl_log_msg
 *
msg
)

192 
	`Æ_objeù_put
((
Æ_objeù
 *è
msg
);

193 
	}
}

202 
	$nâl_log_msg_£t_çmy
(
nâl_log_msg
 *
msg
, 
ušt8_t
 
çmy
)

204 
msg
->
log_msg_çmy
 = 
çmy
;

205 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_FAMILY
;

206 
	}
}

208 
ušt8_t
 
	$nâl_log_msg_g‘_çmy
(cÚ¡ 
nâl_log_msg
 *
msg
)

210 ià(
msg
->
û_mask
 & 
LOG_MSG_ATTR_FAMILY
)

211  
msg
->
log_msg_çmy
;

213  
AF_UNSPEC
;

214 
	}
}

216 
	$nâl_log_msg_£t_hw´Ùo
(
nâl_log_msg
 *
msg
, 
ušt16_t
 
hw´Ùo
)

218 
msg
->
log_msg_hw´Ùo
 = 
hw´Ùo
;

219 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_HWPROTO
;

220 
	}
}

222 
	$nâl_log_msg_‹¡_hw´Ùo
(cÚ¡ 
nâl_log_msg
 *
msg
)

224  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HWPROTO
);

225 
	}
}

227 
ušt16_t
 
	$nâl_log_msg_g‘_hw´Ùo
(cÚ¡ 
nâl_log_msg
 *
msg
)

229  
msg
->
log_msg_hw´Ùo
;

230 
	}
}

232 
	$nâl_log_msg_£t_hook
(
nâl_log_msg
 *
msg
, 
ušt8_t
 
hook
)

234 
msg
->
log_msg_hook
 = 
hook
;

235 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_HOOK
;

236 
	}
}

238 
	$nâl_log_msg_‹¡_hook
(cÚ¡ 
nâl_log_msg
 *
msg
)

240  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HOOK
);

241 
	}
}

243 
ušt8_t
 
	$nâl_log_msg_g‘_hook
(cÚ¡ 
nâl_log_msg
 *
msg
)

245  
msg
->
log_msg_hook
;

246 
	}
}

248 
	$nâl_log_msg_£t_m¬k
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
m¬k
)

250 
msg
->
log_msg_m¬k
 = 
m¬k
;

251 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_MARK
;

252 
	}
}

254 
	$nâl_log_msg_‹¡_m¬k
(cÚ¡ 
nâl_log_msg
 *
msg
)

256  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_MARK
);

257 
	}
}

259 
ušt32_t
 
	$nâl_log_msg_g‘_m¬k
(cÚ¡ 
nâl_log_msg
 *
msg
)

261  
msg
->
log_msg_m¬k
;

262 
	}
}

264 
	$nâl_log_msg_£t_time¡amp
(
nâl_log_msg
 *
msg
, 
timev®
 *
tv
)

266 
msg
->
log_msg_time¡amp
.
tv_£c
 = 
tv
->tv_sec;

267 
msg
->
log_msg_time¡amp
.
tv_u£c
 = 
tv
->tv_usec;

268 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_TIMESTAMP
;

269 
	}
}

271 cÚ¡ 
timev®
 *
	$nâl_log_msg_g‘_time¡amp
(cÚ¡ 
nâl_log_msg
 *
msg
)

273 ià(!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_TIMESTAMP
))

274  
NULL
;

275  &
msg
->
log_msg_time¡amp
;

276 
	}
}

278 
	$nâl_log_msg_£t_šdev
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
šdev
)

280 
msg
->
log_msg_šdev
 = 
šdev
;

281 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_INDEV
;

282 
	}
}

284 
ušt32_t
 
	$nâl_log_msg_g‘_šdev
(cÚ¡ 
nâl_log_msg
 *
msg
)

286  
msg
->
log_msg_šdev
;

287 
	}
}

289 
	$nâl_log_msg_£t_outdev
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
outdev
)

291 
msg
->
log_msg_outdev
 = 
outdev
;

292 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_OUTDEV
;

293 
	}
}

295 
ušt32_t
 
	$nâl_log_msg_g‘_outdev
(cÚ¡ 
nâl_log_msg
 *
msg
)

297  
msg
->
log_msg_outdev
;

298 
	}
}

300 
	$nâl_log_msg_£t_physšdev
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
physšdev
)

302 
msg
->
log_msg_physšdev
 = 
physšdev
;

303 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_PHYSINDEV
;

304 
	}
}

306 
ušt32_t
 
	$nâl_log_msg_g‘_physšdev
(cÚ¡ 
nâl_log_msg
 *
msg
)

308  
msg
->
log_msg_physšdev
;

309 
	}
}

311 
	$nâl_log_msg_£t_physoutdev
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
physoutdev
)

313 
msg
->
log_msg_physoutdev
 = 
physoutdev
;

314 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_PHYSOUTDEV
;

315 
	}
}

317 
ušt32_t
 
	$nâl_log_msg_g‘_physoutdev
(cÚ¡ 
nâl_log_msg
 *
msg
)

319  
msg
->
log_msg_physoutdev
;

320 
	}
}

322 
	$nâl_log_msg_£t_hwaddr
(
nâl_log_msg
 *
msg
, 
ušt8_t
 *
hwaddr
, 
Ën
)

324 ià(
Ën
 > (
msg
->
log_msg_hwaddr
))

325 
Ën
 = (
msg
->
log_msg_hwaddr
);

326 
msg
->
log_msg_hwaddr_Ën
 = 
Ën
;

327 
	`memıy
(
msg
->
log_msg_hwaddr
, 
hwaddr
, 
Ën
);

328 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_HWADDR
;

329 
	}
}

331 cÚ¡ 
ušt8_t
 *
	$nâl_log_msg_g‘_hwaddr
(cÚ¡ 
nâl_log_msg
 *
msg
, *
Ën
)

333 ià(!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_HWADDR
)) {

334 *
Ën
 = 0;

335  
NULL
;

338 *
Ën
 = 
msg
->
log_msg_hwaddr_Ën
;

339  
msg
->
log_msg_hwaddr
;

340 
	}
}

342 
	$nâl_log_msg_£t_·ylßd
(
nâl_log_msg
 *
msg
, 
ušt8_t
 *
·ylßd
, 
Ën
)

344 
	`ä“
(
msg
->
log_msg_·ylßd
);

345 
msg
->
log_msg_·ylßd
 = 
	`m®loc
(
Ën
);

346 ià(!
msg
->
log_msg_·ylßd
)

347  -
NLE_NOMEM
;

349 
	`memıy
(
msg
->
log_msg_·ylßd
, 
·ylßd
, 
Ën
);

350 
msg
->
log_msg_·ylßd_Ën
 = 
Ën
;

351 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_PAYLOAD
;

353 
	}
}

355 cÚ¡ *
	$nâl_log_msg_g‘_·ylßd
(cÚ¡ 
nâl_log_msg
 *
msg
, *
Ën
)

357 ià(!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_PAYLOAD
)) {

358 *
Ën
 = 0;

359  
NULL
;

362 *
Ën
 = 
msg
->
log_msg_·ylßd_Ën
;

363  
msg
->
log_msg_·ylßd
;

364 
	}
}

366 
	$nâl_log_msg_£t_´efix
(
nâl_log_msg
 *
msg
, *
´efix
)

368 
	`ä“
(
msg
->
log_msg_´efix
);

369 
msg
->
log_msg_´efix
 = 
	`¡rdup
(
´efix
);

370 ià(!
msg
->
log_msg_´efix
)

371  -
NLE_NOMEM
;

373 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_PREFIX
;

375 
	}
}

377 cÚ¡ *
	$nâl_log_msg_g‘_´efix
(cÚ¡ 
nâl_log_msg
 *
msg
)

379  
msg
->
log_msg_´efix
;

380 
	}
}

382 
	$nâl_log_msg_£t_uid
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
uid
)

384 
msg
->
log_msg_uid
 = 
uid
;

385 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_UID
;

386 
	}
}

388 
	$nâl_log_msg_‹¡_uid
(cÚ¡ 
nâl_log_msg
 *
msg
)

390  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_UID
);

391 
	}
}

393 
ušt32_t
 
	$nâl_log_msg_g‘_uid
(cÚ¡ 
nâl_log_msg
 *
msg
)

395  
msg
->
log_msg_uid
;

396 
	}
}

398 
	$nâl_log_msg_£t_gid
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
gid
)

400 
msg
->
log_msg_gid
 = 
gid
;

401 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_GID
;

402 
	}
}

404 
	$nâl_log_msg_‹¡_gid
(cÚ¡ 
nâl_log_msg
 *
msg
)

406  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_GID
);

407 
	}
}

409 
ušt32_t
 
	$nâl_log_msg_g‘_gid
(cÚ¡ 
nâl_log_msg
 *
msg
)

411  
msg
->
log_msg_gid
;

412 
	}
}

415 
	$nâl_log_msg_£t_£q
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
£q
)

417 
msg
->
log_msg_£q
 = 
£q
;

418 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_SEQ
;

419 
	}
}

421 
	$nâl_log_msg_‹¡_£q
(cÚ¡ 
nâl_log_msg
 *
msg
)

423  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_SEQ
);

424 
	}
}

426 
ušt32_t
 
	$nâl_log_msg_g‘_£q
(cÚ¡ 
nâl_log_msg
 *
msg
)

428  
msg
->
log_msg_£q
;

429 
	}
}

431 
	$nâl_log_msg_£t_£q_glob®
(
nâl_log_msg
 *
msg
, 
ušt32_t
 
£q_glob®
)

433 
msg
->
log_msg_£q_glob®
 = 
£q_glob®
;

434 
msg
->
û_mask
 |ğ
LOG_MSG_ATTR_SEQ_GLOBAL
;

435 
	}
}

437 
	$nâl_log_msg_‹¡_£q_glob®
(cÚ¡ 
nâl_log_msg
 *
msg
)

439  !!(
msg
->
û_mask
 & 
LOG_MSG_ATTR_SEQ_GLOBAL
);

440 
	}
}

442 
ušt32_t
 
	$nâl_log_msg_g‘_£q_glob®
(cÚ¡ 
nâl_log_msg
 *
msg
)

444  
msg
->
log_msg_£q_glob®
;

445 
	}
}

449 
Æ_objeù_İs
 
	glog_msg_obj_İs
 = {

450 .
oo_Çme
 = "netfilter/log_msg",

451 .
	goo_size
 = (
nâl_log_msg
),

452 .
	goo_ä“_d©a
 = 
log_msg_ä“_d©a
,

453 .
	goo_şÚe
 = 
log_msg_şÚe
,

454 .
	goo_dump
 = {

455 [
NL_DUMP_LINE
] = 
log_msg_dump
,

456 [
NL_DUMP_DETAILS
] = 
log_msg_dump
,

457 [
NL_DUMP_STATS
] = 
log_msg_dump
,

	@mylibnl/libnl-3.2.25/lib/netfilter/log_obj.c

15 
	~<Ãšk-´iv©e/Ãšk.h
>

16 
	~<Ãšk/Ãtf‹r/nâl.h
>

17 
	~<Ãšk/Ãtf‹r/log.h
>

20 
	#LOG_ATTR_GROUP
 (1UL << 0)

	)

21 
	#LOG_ATTR_COPY_MODE
 (1UL << 1)

	)

22 
	#LOG_ATTR_COPY_RANGE
 (1UL << 3)

	)

23 
	#LOG_ATTR_FLUSH_TIMEOUT
 (1UL << 4)

	)

24 
	#LOG_ATTR_ALLOC_SIZE
 (1UL << 5)

	)

25 
	#LOG_ATTR_QUEUE_THRESHOLD
 (1UL << 6)

	)

29 
	$nâl_log_dump
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

31 
nâl_log
 *
log
 = (nâl_log *è
a
;

32 
buf
[64];

34 
	`Æ_Ãw_lše
(
p
);

36 ià(
log
->
û_mask
 & 
LOG_ATTR_GROUP
)

37 
	`Æ_dump
(
p
, "group=%u ", 
log
->
log_group
);

39 ià(
log
->
û_mask
 & 
LOG_ATTR_COPY_MODE
)

40 
	`Æ_dump
(
p
, "copy_mode=%s ",

41 
	`nâl_log_cİy_mode2¡r
(
log
->
log_cİy_mode
,

42 
buf
, (buf)));

44 ià(
log
->
û_mask
 & 
LOG_ATTR_COPY_RANGE
)

45 
	`Æ_dump
(
p
, "cİy_¿nge=%u ", 
log
->
log_cİy_¿nge
);

47 ià(
log
->
û_mask
 & 
LOG_ATTR_FLUSH_TIMEOUT
)

48 
	`Æ_dump
(
p
, "æush_timeout=%u ", 
log
->
log_æush_timeout
);

50 ià(
log
->
û_mask
 & 
LOG_ATTR_ALLOC_SIZE
)

51 
	`Æ_dump
(
p
, "®loc_size=%u ", 
log
->
log_®loc_size
);

53 ià(
log
->
û_mask
 & 
LOG_ATTR_QUEUE_THRESHOLD
)

54 
	`Æ_dump
(
p
, "queue_th»shŞd=%u ", 
log
->
log_queue_th»shŞd
);

56 
	`Æ_dump
(
p
, "\n");

57 
	}
}

59 cÚ¡ 
Œªs_tbl
 
	gcİy_modes
[] = {

60 
__ADD
(
NFNL_LOG_COPY_NONE
, 
nÚe
)

61 
__ADD
(
NFNL_LOG_COPY_META
, 
m‘a
)

62 
__ADD
(
NFNL_LOG_COPY_PACKET
, 
·ck‘
)

65 *
	$nâl_log_cİy_mode2¡r
(
nâl_log_cİy_mode
 
cİy_mode
, *
buf
,

66 
size_t
 
Ën
)

68  
	`__ty³2¡r
(
cİy_mode
, 
buf
, 
Ën
, 
cİy_modes
,

69 
	`ARRAY_SIZE
(
cİy_modes
));

70 
	}
}

72 
nâl_log_cİy_mode
 
	$nâl_log_¡r2cİy_mode
(cÚ¡ *
Çme
)

74  
	`__¡r2ty³
(
Çme
, 
cİy_modes
, 
	`ARRAY_SIZE
(copy_modes));

75 
	}
}

82 
nâl_log
 *
	$nâl_log_®loc
()

84  (
nâl_log
 *è
	`Æ_objeù_®loc
(&
log_obj_İs
);

85 
	}
}

87 
	$nâl_log_g‘
(
nâl_log
 *
log
)

89 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
log
);

90 
	}
}

92 
	$nâl_log_put
(
nâl_log
 *
log
)

94 
	`Æ_objeù_put
((
Æ_objeù
 *è
log
);

95 
	}
}

104 
	$nâl_log_£t_group
(
nâl_log
 *
log
, 
ušt16_t
 
group
)

106 
log
->
log_group
 = 
group
;

107 
log
->
û_mask
 |ğ
LOG_ATTR_GROUP
;

108 
	}
}

110 
	$nâl_log_‹¡_group
(cÚ¡ 
nâl_log
 *
log
)

112  !!(
log
->
û_mask
 & 
LOG_ATTR_GROUP
);

113 
	}
}

115 
ušt16_t
 
	$nâl_log_g‘_group
(cÚ¡ 
nâl_log
 *
log
)

117  
log
->
log_group
;

118 
	}
}

120 
	$nâl_log_£t_cİy_mode
(
nâl_log
 *
log
, 
nâl_log_cİy_mode
 
mode
)

122 
log
->
log_cİy_mode
 = 
mode
;

123 
log
->
û_mask
 |ğ
LOG_ATTR_COPY_MODE
;

124 
	}
}

126 
	$nâl_log_‹¡_cİy_mode
(cÚ¡ 
nâl_log
 *
log
)

128  !!(
log
->
û_mask
 & 
LOG_ATTR_COPY_MODE
);

129 
	}
}

131 
nâl_log_cİy_mode
 
	$nâl_log_g‘_cİy_mode
(cÚ¡ 
nâl_log
 *
log
)

133  
log
->
log_cİy_mode
;

134 
	}
}

136 
	$nâl_log_£t_cİy_¿nge
(
nâl_log
 *
log
, 
ušt32_t
 
cİy_¿nge
)

138 
log
->
log_cİy_¿nge
 = 
cİy_¿nge
;

139 
log
->
û_mask
 |ğ
LOG_ATTR_COPY_RANGE
;

140 
	}
}

142 
	$nâl_log_‹¡_cİy_¿nge
(cÚ¡ 
nâl_log
 *
log
)

144  !!(
log
->
û_mask
 & 
LOG_ATTR_COPY_RANGE
);

145 
	}
}

147 
ušt32_t
 
	$nâl_log_g‘_cİy_¿nge
(cÚ¡ 
nâl_log
 *
log
)

149  
log
->
log_cİy_¿nge
;

150 
	}
}

152 
	$nâl_log_£t_æush_timeout
(
nâl_log
 *
log
, 
ušt32_t
 
timeout
)

154 
log
->
log_æush_timeout
 = 
timeout
;

155 
log
->
û_mask
 |ğ
LOG_ATTR_FLUSH_TIMEOUT
;

156 
	}
}

158 
	$nâl_log_‹¡_æush_timeout
(cÚ¡ 
nâl_log
 *
log
)

160  !!(
log
->
û_mask
 & 
LOG_ATTR_FLUSH_TIMEOUT
);

161 
	}
}

163 
ušt32_t
 
	$nâl_log_g‘_æush_timeout
(cÚ¡ 
nâl_log
 *
log
)

165  
log
->
log_æush_timeout
;

166 
	}
}

168 
	$nâl_log_£t_®loc_size
(
nâl_log
 *
log
, 
ušt32_t
 
®loc_size
)

170 
log
->
log_®loc_size
 = 
®loc_size
;

171 
log
->
û_mask
 |ğ
LOG_ATTR_ALLOC_SIZE
;

172 
	}
}

174 
	$nâl_log_‹¡_®loc_size
(cÚ¡ 
nâl_log
 *
log
)

176  !!(
log
->
û_mask
 & 
LOG_ATTR_ALLOC_SIZE
);

177 
	}
}

179 
ušt32_t
 
	$nâl_log_g‘_®loc_size
(cÚ¡ 
nâl_log
 *
log
)

181  
log
->
log_®loc_size
;

182 
	}
}

184 
	$nâl_log_£t_queue_th»shŞd
(
nâl_log
 *
log
, 
ušt32_t
 
th»shŞd
)

186 
log
->
log_queue_th»shŞd
 = 
th»shŞd
;

187 
log
->
û_mask
 |ğ
LOG_ATTR_QUEUE_THRESHOLD
;

188 
	}
}

190 
	$nâl_log_‹¡_queue_th»shŞd
(cÚ¡ 
nâl_log
 *
log
)

192  !!(
log
->
û_mask
 & 
LOG_ATTR_QUEUE_THRESHOLD
);

193 
	}
}

195 
ušt32_t
 
	$nâl_log_g‘_queue_th»shŞd
(cÚ¡ 
nâl_log
 *
log
)

197  
log
->
log_queue_th»shŞd
;

198 
	}
}

205 
	$nâl_log_£t_æags
(
nâl_log
 *
log
, 
æags
)

207 
log
->
log_æags
 |ğ
æags
;

208 
log
->
log_æag_mask
 |ğ
æags
;

209 
	}
}

211 
	$nâl_log_un£t_æags
(
nâl_log
 *
log
, 
æags
)

213 
log
->
log_æags
 &ğ~
æags
;

214 
log
->
log_æag_mask
 |ğ
æags
;

215 
	}
}

217 cÚ¡ 
Œªs_tbl
 
	glog_æags
[] = {

218 
__ADD
(
NFNL_LOG_FLAG_SEQ
, 
£q
)

219 
__ADD
(
NFNL_LOG_FLAG_SEQ_GLOBAL
, 
£q_glob®
)

222 *
	$nâl_log_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

224  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
log_æags
, 
	`ARRAY_SIZE
(log_flags));

225 
	}
}

227 
	$nâl_log_¡r2æags
(cÚ¡ *
Çme
)

229  
	`__¡r2æags
(
Çme
, 
log_æags
, 
	`ARRAY_SIZE
(log_flags));

230 
	}
}

232 
	$nâl_log_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

233 
ušt32_t
 
©Œs
, 
æags
)

235 
nâl_log
 *
a
 = (nâl_log *è
_a
;

236 
nâl_log
 *
b
 = (nâl_log *è
_b
;

237 
diff
 = 0;

239 
	#NFNL_LOG_DIFF
(
ATTR
, 
EXPR
) \

240 
	`ATTR_DIFF
(
©Œs
, 
LOG_ATTR_
##
ATTR
, 
a
, 
b
, 
EXPR
)

	)

241 
	#NFNL_LOG_DIFF_VAL
(
ATTR
, 
FIELD
) \

242 
	`NFNL_LOG_DIFF
(
ATTR
, 
a
->
FIELD
 !ğ
b
->FIELD)

	)

244 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
GROUP
, 
log_group
);

245 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
COPY_MODE
, 
log_cİy_mode
);

246 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
COPY_RANGE
, 
log_cİy_¿nge
);

247 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
FLUSH_TIMEOUT
, 
log_æush_timeout
);

248 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
ALLOC_SIZE
, 
log_®loc_size
);

249 
diff
 |ğ
	`NFNL_LOG_DIFF_VAL
(
QUEUE_THRESHOLD
, 
log_queue_th»shŞd
);

251 #undeà
NFNL_LOG_DIFF


252 #undeà
NFNL_LOG_DIFF_VAL


254  
diff
;

255 
	}
}

257 cÚ¡ 
Œªs_tbl
 
	gnâl_log_©Œs
[] = {

258 
__ADD
(
LOG_ATTR_GROUP
, 
group
)

259 
__ADD
(
LOG_ATTR_COPY_MODE
, 
cİy_mode
)

260 
__ADD
(
LOG_ATTR_COPY_RANGE
, 
cİy_¿nge
)

261 
__ADD
(
LOG_ATTR_FLUSH_TIMEOUT
, 
æush_timeout
)

262 
__ADD
(
LOG_ATTR_ALLOC_SIZE
, 
®loc_size
)

263 
__ADD
(
LOG_ATTR_QUEUE_THRESHOLD
, 
queue_th»shŞd
)

266 *
	$nâl_log_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

268  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
nâl_log_©Œs
,

269 
	`ARRAY_SIZE
(
nâl_log_©Œs
));

270 
	}
}

274 
Æ_objeù_İs
 
	glog_obj_İs
 = {

275 .
oo_Çme
 = "netfilter/log",

276 .
	goo_size
 = (
nâl_log
),

277 .
	goo_dump
 = {

278 [
NL_DUMP_LINE
] = 
nâl_log_dump
,

279 [
NL_DUMP_DETAILS
] = 
nâl_log_dump
,

280 [
NL_DUMP_STATS
] = 
nâl_log_dump
,

282 .
	goo_com·»
 = 
nâl_log_com·»
,

283 .
	goo_©Œs2¡r
 = 
nâl_log_©Œs2¡r
,

284 .
	goo_id_©Œs
 = 
LOG_ATTR_GROUP
,

	@mylibnl/libnl-3.2.25/lib/netfilter/netfilter.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/Ãtf‹r/Ãtf‹r.h
>

14 
	~<lšux/Ãtf‹r.h
>

16 cÚ¡ 
Œªs_tbl
 
	gnâl_v”diùs
[] = {

17 
__ADD
(
NF_DROP
, NF_DROP)

18 
__ADD
(
NF_ACCEPT
, NF_ACCEPT)

19 
__ADD
(
NF_STOLEN
, NF_STOLEN)

20 
__ADD
(
NF_QUEUE
, NF_QUEUE)

21 
__ADD
(
NF_REPEAT
, NF_REPEAT)

22 
__ADD
(
NF_STOP
, NF_STOP)

25 *
	$nâl_v”diù2¡r
(
v”diù
, *
buf
, 
size_t
 
Ën
)

27  
	`__ty³2¡r
(
v”diù
, 
buf
, 
Ën
, 
nâl_v”diùs
,

28 
	`ARRAY_SIZE
(
nâl_v”diùs
));

29 
	}
}

31 
	$nâl_¡r2v”diù
(cÚ¡ *
Çme
)

33  
	`__¡r2ty³
(
Çme
, 
nâl_v”diùs
, 
	`ARRAY_SIZE
(nfnl_verdicts));

34 
	}
}

36 cÚ¡ 
Œªs_tbl
 
	gnâl_š‘_hooks
[] = {

37 
__ADD
(
NF_INET_PRE_ROUTING
, 
NF_INET_PREROUTING
)

38 
__ADD
(
NF_INET_LOCAL_IN
, NF_INET_LOCAL_IN)

39 
__ADD
(
NF_INET_FORWARD
, NF_INET_FORWARD)

40 
__ADD
(
NF_INET_LOCAL_OUT
, NF_INET_LOCAL_OUT)

41 
__ADD
(
NF_INET_POST_ROUTING
, NF_INET_POST_ROUTING)

44 *
	$nâl_š‘_hook2¡r
(
hook
, *
buf
, 
size_t
 
Ën
)

46  
	`__ty³2¡r
(
hook
, 
buf
, 
Ën
, 
nâl_š‘_hooks
,

47 
	`ARRAY_SIZE
(
nâl_š‘_hooks
));

48 
	}
}

50 
	$nâl_¡r2š‘_hook
(cÚ¡ *
Çme
)

52  
	`__¡r2ty³
(
Çme
, 
nâl_š‘_hooks
, 
	`ARRAY_SIZE
(nfnl_inet_hooks));

53 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/nfnl.c

64 
	~<Ãšk-´iv©e/Ãšk.h
>

65 
	~<Ãšk/Ãšk.h
>

66 
	~<Ãšk/Ãtf‹r/nâl.h
>

84 
	$nâl_cÚÃù
(
Æ_sock
 *
sk
)

86  
	`Æ_cÚÃù
(
sk
, 
NETLINK_NETFILTER
);

87 
	}
}

107 
	$nâl_£nd_sim¶e
(
Æ_sock
 *
sk
, 
ušt8_t
 
subsys_id
, ušt8_ˆ
ty³
,

108 
æags
, 
ušt8_t
 
çmy
, 
ušt16_t
 
»s_id
)

110 
nfg’msg
 
hdr
 = {

111 .
nfg’_çmy
 = 
çmy
,

112 .
v”siÚ
 = 
NFNETLINK_V0
,

113 .
»s_id
 = 
	`htÚs
(res_id),

116  
	`Æ_£nd_sim¶e
(
sk
, 
	`NFNLMSG_TYPE
(
subsys_id
, 
ty³
), 
æags
,

117 &
hdr
, (hdr));

118 
	}
}

131 
ušt8_t
 
	$nâlmsg_subsys
(
Æmsghdr
 *
Æh
)

133  
	`NFNL_SUBSYS_ID
(
Æh
->
Æmsg_ty³
);

134 
	}
}

140 
ušt8_t
 
	$nâlmsg_subty³
(
Æmsghdr
 *
Æh
)

142  
	`NFNL_MSG_TYPE
(
Æh
->
Æmsg_ty³
);

143 
	}
}

149 
ušt8_t
 
	$nâlmsg_çmy
(
Æmsghdr
 *
Æh
)

151 
nfg’msg
 *
nfg
 = 
	`Æmsg_d©a
(
Æh
);

153  
nfg
->
nfg’_çmy
;

154 
	}
}

160 
ušt16_t
 
	$nâlmsg_»s_id
(
Æmsghdr
 *
Æh
)

162 
nfg’msg
 *
nfg
 = 
	`Æmsg_d©a
(
Æh
);

164  
	`Áohs
(
nfg
->
»s_id
);

165 
	}
}

174 
	$nâlmsg_­³nd
(
Æ_msg
 *
msg
, 
ušt8_t
 
çmy
, 
ušt16_t
 
»s_id
)

176 
nfg’msg
 *
nfg
;

178 
nfg
 = 
	`Æmsg_»£rve
(
msg
, (*nfg), 
NLMSG_ALIGNTO
);

179 ià(
nfg
 =ğ
NULL
)

180  -
NLE_NOMEM
;

182 
nfg
->
nfg’_çmy
 = 
çmy
;

183 
nfg
->
v”siÚ
 = 
NFNETLINK_V0
;

184 
nfg
->
»s_id
 = 
	`htÚs
(res_id);

185 
	`NL_DBG
(2, "msg %p: Added‚fnetlink header family=%d„es_id=%d\n",

186 
msg
, 
çmy
, 
»s_id
);

188 
	}
}

200 
Æ_msg
 *
	$nâlmsg_®loc_sim¶e
(
ušt8_t
 
subsys_id
, ušt8_ˆ
ty³
, 
æags
,

201 
ušt8_t
 
çmy
, 
ušt16_t
 
»s_id
)

203 
Æ_msg
 *
msg
;

205 
msg
 = 
	`Æmsg_®loc_sim¶e
(
	`NFNLMSG_TYPE
(
subsys_id
, 
ty³
), 
æags
);

206 ià(
msg
 =ğ
NULL
)

207  
NULL
;

209 ià(
	`nâlmsg_­³nd
(
msg
, 
çmy
, 
»s_id
) < 0)

210 
Æa_put_çu»
;

212  
msg
;

214 
Æa_put_çu»
:

215 
	`Æmsg_ä“
(
msg
);

216  
NULL
;

217 
	}
}

230 
	$nâlmsg_put
(
Æ_msg
 *
msg
, 
ušt32_t
 
pid
, ušt32_ˆ
£q
,

231 
ušt8_t
 
subsys_id
, ušt8_ˆ
ty³
, 
æags
, ušt8_ˆ
çmy
,

232 
ušt16_t
 
»s_id
)

234 
Æmsghdr
 *
Æh
;

236 
Æh
 = 
	`Æmsg_put
(
msg
, 
pid
, 
£q
, 
	`NFNLMSG_TYPE
(
subsys_id
, 
ty³
), 0, 
æags
);

237 ià(
Æh
 =ğ
NULL
)

238  -
NLE_MSGSIZE
;

240  
	`nâlmsg_­³nd
(
msg
, 
çmy
, 
»s_id
);

241 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/queue.c

19 
	~<sys/ty³s.h
>

20 
	~<lšux/Ãtf‹r/nâ‘lšk_queue.h
>

22 
	~<Ãšk-´iv©e/Ãšk.h
>

23 
	~<Ãšk/©Œ.h
>

24 
	~<Ãšk/Ãtf‹r/nâl.h
>

25 
	~<Ãšk/Ãtf‹r/queue.h
>

27 
Æ_sock
 *
	$nâl_queue_sock‘_®loc
()

29 
Æ_sock
 *
Æsk
;

31 
Æsk
 = 
	`Æ_sock‘_®loc
();

32 ià(
Æsk
)

33 
	`Æ_sock‘_di§bË_auto_ack
(
Æsk
);

34  
Æsk
;

35 
	}
}

37 
	$£nd_queue_»que¡
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

39 
”r
;

41 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

42 
	`Æmsg_ä“
(
msg
);

43 ià(
”r
 < 0)

44  
”r
;

46  
	`wa™_fÜ_ack
(
sk
);

47 
	}
}

54 
	$bud_queue_cmd_»que¡
(
ušt8_t
 
çmy
, 
ušt16_t
 
queu’um
,

55 
ušt8_t
 
commªd
, 
Æ_msg
 **
»suÉ
)

57 
Æ_msg
 *
msg
;

58 
nfqÆ_msg_cÚfig_cmd
 
cmd
;

60 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_QUEUE
, 
NFQNL_MSG_CONFIG
, 0,

61 
çmy
, 
queu’um
);

62 ià(
msg
 =ğ
NULL
)

63  -
NLE_NOMEM
;

65 
cmd
.
pf
 = 
	`htÚs
(
çmy
);

66 
cmd
.
_·d
 = 0;

67 
cmd
.
commªd
 = command;

68 ià(
	`Æa_put
(
msg
, 
NFQA_CFG_CMD
, (
cmd
), &cmd) < 0)

69 
Æa_put_çu»
;

71 *
»suÉ
 = 
msg
;

74 
Æa_put_çu»
:

75 
	`Æmsg_ä“
(
msg
);

76  -
NLE_MSGSIZE
;

77 
	}
}

79 
	$nâl_queue_bud_pf_bšd
(
ušt8_t
 
pf
, 
Æ_msg
 **
»suÉ
)

81  
	`bud_queue_cmd_»que¡
(
pf
, 0, 
NFQNL_CFG_CMD_PF_BIND
, 
»suÉ
);

82 
	}
}

84 
	$nâl_queue_pf_bšd
(
Æ_sock
 *
Æh
, 
ušt8_t
 
pf
)

86 
Æ_msg
 *
msg
;

87 
”r
;

89 ià((
”r
 = 
	`nâl_queue_bud_pf_bšd
(
pf
, &
msg
)) < 0)

90  
”r
;

92  
	`£nd_queue_»que¡
(
Æh
, 
msg
);

93 
	}
}

95 
	$nâl_queue_bud_pf_unbšd
(
ušt8_t
 
pf
, 
Æ_msg
 **
»suÉ
)

97  
	`bud_queue_cmd_»que¡
(
pf
, 0, 
NFQNL_CFG_CMD_PF_UNBIND
, 
»suÉ
);

98 
	}
}

100 
	$nâl_queue_pf_unbšd
(
Æ_sock
 *
Æh
, 
ušt8_t
 
pf
)

102 
Æ_msg
 *
msg
;

103 
”r
;

105 ià((
”r
 = 
	`nâl_queue_bud_pf_unbšd
(
pf
, &
msg
)) < 0)

106  
”r
;

108  
	`£nd_queue_»que¡
(
Æh
, 
msg
);

109 
	}
}

111 
	$nâl_queue_bud_»que¡
(cÚ¡ 
nâl_queue
 *
queue
,

112 
Æ_msg
 **
»suÉ
)

114 
Æ_msg
 *
msg
;

116 ià(!
	`nâl_queue_‹¡_group
(
queue
))

117  -
NLE_MISSING_ATTR
;

119 
msg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_QUEUE
, 
NFQNL_MSG_CONFIG
, 0,

120 0, 
	`nâl_queue_g‘_group
(
queue
));

121 ià(
msg
 =ğ
NULL
)

122  -
NLE_NOMEM
;

124 ià(
	`nâl_queue_‹¡_maxËn
(
queue
) &&

125 
	`Æa_put_u32
(
msg
, 
NFQA_CFG_QUEUE_MAXLEN
,

126 
	`htÚl
(
	`nâl_queue_g‘_maxËn
(
queue
))) < 0)

127 
Æa_put_çu»
;

132 ià(
	`nâl_queue_‹¡_cİy_mode
(
queue
)) {

133 
nfqÆ_msg_cÚfig_·¿ms
 
·¿ms
;

135 
	`nâl_queue_g‘_cİy_mode
(
queue
)) {

136 
NFNL_QUEUE_COPY_NONE
:

137 
·¿ms
.
cİy_mode
 = 
NFQNL_COPY_NONE
;

139 
NFNL_QUEUE_COPY_META
:

140 
·¿ms
.
cİy_mode
 = 
NFQNL_COPY_META
;

142 
NFNL_QUEUE_COPY_PACKET
:

143 
·¿ms
.
cİy_mode
 = 
NFQNL_COPY_PACKET
;

146 
·¿ms
.
cİy_¿nge
 = 
	`htÚl
(
	`nâl_queue_g‘_cİy_¿nge
(
queue
));

148 ià(
	`Æa_put
(
msg
, 
NFQA_CFG_PARAMS
, (
·¿ms
), &params) < 0)

149 
Æa_put_çu»
;

152 *
»suÉ
 = 
msg
;

155 
Æa_put_çu»
:

156 
	`Æmsg_ä“
(
msg
);

157  -
NLE_MSGSIZE
;

158 
	}
}

160 
	$nâl_queue_bud_ü—‹_»que¡
(cÚ¡ 
nâl_queue
 *
queue
,

161 
Æ_msg
 **
»suÉ
)

163 
nfqÆ_msg_cÚfig_cmd
 
cmd
;

164 
”r
;

166 ià((
”r
 = 
	`nâl_queue_bud_»que¡
(
queue
, 
»suÉ
)) < 0)

167  
”r
;

169 
cmd
.
pf
 = 0;

170 
cmd
.
_·d
 = 0;

171 
cmd
.
commªd
 = 
NFQNL_CFG_CMD_BIND
;

173 
	`NLA_PUT
(*
»suÉ
, 
NFQA_CFG_CMD
, (
cmd
), &cmd);

177 
Æa_put_çu»
:

178 
	`Æmsg_ä“
(*
»suÉ
);

179  -
NLE_MSGSIZE
;

180 
	}
}

182 
	$nâl_queue_ü—‹
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_queue
 *
queue
)

184 
Æ_msg
 *
msg
;

185 
”r
;

187 ià((
”r
 = 
	`nâl_queue_bud_ü—‹_»que¡
(
queue
, &
msg
)) < 0)

188  
”r
;

190  
	`£nd_queue_»que¡
(
Æh
, 
msg
);

191 
	}
}

193 
	$nâl_queue_bud_chªge_»que¡
(cÚ¡ 
nâl_queue
 *
queue
,

194 
Æ_msg
 **
»suÉ
)

196  
	`nâl_queue_bud_»que¡
(
queue
, 
»suÉ
);

197 
	}
}

199 
	$nâl_queue_chªge
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_queue
 *
queue
)

201 
Æ_msg
 *
msg
;

202 
”r
;

204 ià((
”r
 = 
	`nâl_queue_bud_chªge_»que¡
(
queue
, &
msg
)) < 0)

205  
”r
;

207  
	`£nd_queue_»que¡
(
Æh
, 
msg
);

208 
	}
}

210 
	$nâl_queue_bud_d–‘e_»que¡
(cÚ¡ 
nâl_queue
 *
queue
,

211 
Æ_msg
 **
»suÉ
)

213 ià(!
	`nâl_queue_‹¡_group
(
queue
))

214  -
NLE_MISSING_ATTR
;

216  
	`bud_queue_cmd_»que¡
(0, 
	`nâl_queue_g‘_group
(
queue
),

217 
NFQNL_CFG_CMD_UNBIND
, 
»suÉ
);

218 
	}
}

220 
	$nâl_queue_d–‘e
(
Æ_sock
 *
Æh
, cÚ¡ 
nâl_queue
 *
queue
)

222 
Æ_msg
 *
msg
;

223 
”r
;

225 ià((
”r
 = 
	`nâl_queue_bud_d–‘e_»que¡
(
queue
, &
msg
)) < 0)

226  
”r
;

228  
	`£nd_queue_»que¡
(
Æh
, 
msg
);

229 
	}
}

233 
Æ_ÿche_İs
 
	gnâl_queue_İs
 = {

234 .
co_Çme
 = "netfilter/queue",

235 .
	gco_obj_İs
 = &
queue_obj_İs
,

236 .
	gco_msgty³s
 = {

237 
END_OF_MSGTYPES_LIST
,

241 
__š™
 
	$nâl_queue_š™
()

243 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_queue_İs
);

244 
	}
}

246 
__ex™
 
	$nâl_queue_ex™
()

248 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_queue_İs
);

249 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/queue_msg.c

20 
	~<sys/ty³s.h
>

21 
	~<lšux/Ãtf‹r/nâ‘lšk_queue.h
>

23 
	~<Ãšk-´iv©e/Ãšk.h
>

24 
	~<Ãšk/©Œ.h
>

25 
	~<Ãšk/Ãtf‹r/nâl.h
>

26 
	~<Ãšk/Ãtf‹r/queue_msg.h
>

27 
	~<by‹sw­.h
>

29 
Æ_ÿche_İs
 
	gnâl_queue_msg_İs
;

31 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


32 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

34  
x
;

35 
	}
}

36 #–ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


37 
ušt64_t
 
	$ÁohÎ
(
ušt64_t
 
x
)

39  
	`bsw­_64
(
x
);

40 
	}
}

43 
Æa_pŞicy
 
	gqueue_pŞicy
[
NFQA_MAX
+1] = {

44 [
NFQA_PACKET_HDR
] = {

45 .
mšËn
 = (
nfqÆ_msg_·ck‘_hdr
),

47 [
NFQA_VERDICT_HDR
] = {

48 .
mšËn
 = (
nfqÆ_msg_v”diù_hdr
),

50 [
NFQA_MARK
] = { .
ty³
 = 
NLA_U32
 },

51 [
NFQA_TIMESTAMP
] = {

52 .
mšËn
 = (
nfqÆ_msg_·ck‘_time¡amp
),

54 [
NFQA_IFINDEX_INDEV
] = { .
ty³
 = 
NLA_U32
 },

55 [
NFQA_IFINDEX_OUTDEV
] = { .
ty³
 = 
NLA_U32
 },

56 [
NFQA_IFINDEX_PHYSINDEV
] = { .
ty³
 = 
NLA_U32
 },

57 [
NFQA_IFINDEX_PHYSOUTDEV
] = { .
ty³
 = 
NLA_U32
 },

58 [
NFQA_HWADDR
] = {

59 .
mšËn
 = (
nfqÆ_msg_·ck‘_hw
),

63 
	$nâlmsg_queue_msg_·r£
(
Æmsghdr
 *
Æh
,

64 
nâl_queue_msg
 **
»suÉ
)

66 
nâl_queue_msg
 *
msg
;

67 
Æ©Œ
 *
tb
[
NFQA_MAX
+1];

68 
Æ©Œ
 *
©Œ
;

69 
”r
;

71 
msg
 = 
	`nâl_queue_msg_®loc
();

72 ià(!
msg
)

73  -
NLE_NOMEM
;

75 
msg
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

77 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
nfg’msg
), 
tb
, 
NFQA_MAX
,

78 
queue_pŞicy
);

79 ià(
”r
 < 0)

80 
”rout
;

82 
	`nâl_queue_msg_£t_group
(
msg
, 
	`nâlmsg_»s_id
(
Æh
));

83 
	`nâl_queue_msg_£t_çmy
(
msg
, 
	`nâlmsg_çmy
(
Æh
));

85 
©Œ
 = 
tb
[
NFQA_PACKET_HDR
];

86 ià(
©Œ
) {

87 
nfqÆ_msg_·ck‘_hdr
 *
hdr
 = 
	`Æa_d©a
(
©Œ
);

89 
	`nâl_queue_msg_£t_·ck‘id
(
msg
, 
	`Áohl
(
hdr
->
·ck‘_id
));

90 ià(
hdr
->
hw_´ÙocŞ
)

91 
	`nâl_queue_msg_£t_hw´Ùo
(
msg
, 
hdr
->
hw_´ÙocŞ
);

92 
	`nâl_queue_msg_£t_hook
(
msg
, 
hdr
->
hook
);

95 
©Œ
 = 
tb
[
NFQA_MARK
];

96 ià(
©Œ
)

97 
	`nâl_queue_msg_£t_m¬k
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

99 
©Œ
 = 
tb
[
NFQA_TIMESTAMP
];

100 ià(
©Œ
) {

101 
nfqÆ_msg_·ck‘_time¡amp
 *
time¡amp
 = 
	`Æa_d©a
(
©Œ
);

102 
timev®
 
tv
;

104 
tv
.
tv_£c
 = 
	`ÁohÎ
(
time¡amp
->
£c
);

105 
tv
.
tv_u£c
 = 
	`ÁohÎ
(
time¡amp
->
u£c
);

106 
	`nâl_queue_msg_£t_time¡amp
(
msg
, &
tv
);

109 
©Œ
 = 
tb
[
NFQA_IFINDEX_INDEV
];

110 ià(
©Œ
)

111 
	`nâl_queue_msg_£t_šdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

113 
©Œ
 = 
tb
[
NFQA_IFINDEX_OUTDEV
];

114 ià(
©Œ
)

115 
	`nâl_queue_msg_£t_outdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

117 
©Œ
 = 
tb
[
NFQA_IFINDEX_PHYSINDEV
];

118 ià(
©Œ
)

119 
	`nâl_queue_msg_£t_physšdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

121 
©Œ
 = 
tb
[
NFQA_IFINDEX_PHYSOUTDEV
];

122 ià(
©Œ
)

123 
	`nâl_queue_msg_£t_physoutdev
(
msg
, 
	`Áohl
(
	`Æa_g‘_u32
(
©Œ
)));

125 
©Œ
 = 
tb
[
NFQA_HWADDR
];

126 ià(
©Œ
) {

127 
nfqÆ_msg_·ck‘_hw
 *
hw
 = 
	`Æa_d©a
(
©Œ
);

129 
	`nâl_queue_msg_£t_hwaddr
(
msg
, 
hw
->
hw_addr
,

130 
	`Áohs
(
hw
->
hw_add¾’
));

133 
©Œ
 = 
tb
[
NFQA_PAYLOAD
];

134 ià(
©Œ
) {

135 
”r
 = 
	`nâl_queue_msg_£t_·ylßd
(
msg
, 
	`Æa_d©a
(
©Œ
),

136 
	`Æa_Ën
(
©Œ
));

137 ià(
”r
 < 0)

138 
”rout
;

141 *
»suÉ
 = 
msg
;

144 
”rout
:

145 
	`nâl_queue_msg_put
(
msg
);

146  
”r
;

147 
	}
}

149 
	$queue_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

150 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

152 
nâl_queue_msg
 *
msg
;

153 
”r
;

155 ià((
”r
 = 
	`nâlmsg_queue_msg_·r£
(
Æh
, &
msg
)) < 0)

156  
”r
;

158 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
msg
,…p);

159 
	`nâl_queue_msg_put
(
msg
);

160  
”r
;

161 
	}
}

165 
Æ_msg
 *

166 
	$__nâl_queue_msg_bud_v”diù
(cÚ¡ 
nâl_queue_msg
 *
msg
,

167 
ušt8_t
 
ty³
)

169 
Æ_msg
 *
Æmsg
;

170 
nfqÆ_msg_v”diù_hdr
 
v”diù
;

172 
Æmsg
 = 
	`nâlmsg_®loc_sim¶e
(
NFNL_SUBSYS_QUEUE
, 
ty³
, 0,

173 
	`nâl_queue_msg_g‘_çmy
(
msg
),

174 
	`nâl_queue_msg_g‘_group
(
msg
));

175 ià(
Æmsg
 =ğ
NULL
)

176  
NULL
;

178 
v”diù
.
id
 = 
	`htÚl
(
	`nâl_queue_msg_g‘_·ck‘id
(
msg
));

179 
v”diù
.v”diù = 
	`htÚl
(
	`nâl_queue_msg_g‘_v”diù
(
msg
));

180 ià(
	`Æa_put
(
Æmsg
, 
NFQA_VERDICT_HDR
, (
v”diù
), &verdict) < 0)

181 
Æa_put_çu»
;

183 ià(
	`nâl_queue_msg_‹¡_m¬k
(
msg
) &&

184 
	`Æa_put_u32
(
Æmsg
, 
NFQA_MARK
,

185 
	`Áohl
(
	`nâl_queue_msg_g‘_m¬k
(
msg
))) < 0)

186 
Æa_put_çu»
;

188  
Æmsg
;

190 
Æa_put_çu»
:

191 
	`Æmsg_ä“
(
Æmsg
);

192  
NULL
;

193 
	}
}

195 
Æ_msg
 *

196 
	$nâl_queue_msg_bud_v”diù
(cÚ¡ 
nâl_queue_msg
 *
msg
)

198  
	`__nâl_queue_msg_bud_v”diù
(
msg
, 
NFQNL_MSG_VERDICT
);

199 
	}
}

201 
Æ_msg
 *

202 
	$nâl_queue_msg_bud_v”diù_b©ch
(cÚ¡ 
nâl_queue_msg
 *
msg
)

204  
	`__nâl_queue_msg_bud_v”diù
(
msg
, 
NFQNL_MSG_VERDICT_BATCH
);

205 
	}
}

213 
	$nâl_queue_msg_£nd_v”diù
(
Æ_sock
 *
Æh
,

214 cÚ¡ 
nâl_queue_msg
 *
msg
)

216 
Æ_msg
 *
Æmsg
;

217 
”r
;

219 
Æmsg
 = 
	`nâl_queue_msg_bud_v”diù
(
msg
);

220 ià(
Æmsg
 =ğ
NULL
)

221  -
NLE_NOMEM
;

223 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
Æh
, 
Æmsg
);

224 
	`Æmsg_ä“
(
Æmsg
);

225 ià(
”r
 < 0)

226  
”r
;

227  
	`wa™_fÜ_ack
(
Æh
);

228 
	}
}

236 
	$nâl_queue_msg_£nd_v”diù_b©ch
(
Æ_sock
 *
Æh
,

237 cÚ¡ 
nâl_queue_msg
 *
msg
)

239 
Æ_msg
 *
Æmsg
;

240 
”r
;

242 
Æmsg
 = 
	`nâl_queue_msg_bud_v”diù_b©ch
(
msg
);

243 ià(
Æmsg
 =ğ
NULL
)

244  -
NLE_NOMEM
;

246 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
Æh
, 
Æmsg
);

247 
	`Æmsg_ä“
(
Æmsg
);

248 ià(
”r
 < 0)

249  
”r
;

250  
	`wa™_fÜ_ack
(
Æh
);

251 
	}
}

261 
	$nâl_queue_msg_£nd_v”diù_·ylßd
(
Æ_sock
 *
Æh
,

262 cÚ¡ 
nâl_queue_msg
 *
msg
,

263 cÚ¡ *
·ylßd_d©a
, 
·ylßd_Ën
)

265 
Æ_msg
 *
Æmsg
;

266 
”r
;

267 
iovec
 
iov
[3];

268 
Æ©Œ
 
Æa
;

270 
Æmsg
 = 
	`nâl_queue_msg_bud_v”diù
(
msg
);

271 ià(
Æmsg
 =ğ
NULL
)

272  -
NLE_NOMEM
;

274 
	`mem£t
(
iov
, 0, (iov));

276 
iov
[0].
iov_ba£
 = (*è
	`Æmsg_hdr
(
Æmsg
);

277 
iov
[0].
iov_Ën
 = 
	`Æmsg_hdr
(
Æmsg
)->
Æmsg_Ën
;

279 
Æa
.
Æa_ty³
 = 
NFQA_PAYLOAD
;

280 
Æa
.
Æa_Ën
 = 
·ylßd_Ën
 + (nla);

281 
	`Æmsg_hdr
(
Æmsg
)->
Æmsg_Ën
 +ğ
Æa
.
Æa_Ën
;

283 
iov
[1].
iov_ba£
 = (*è&
Æa
;

284 
iov
[1].
iov_Ën
 = (
Æa
);

286 
iov
[2].
iov_ba£
 = (*è
·ylßd_d©a
;

287 
iov
[2].
iov_Ën
 = 
	`NLA_ALIGN
(
·ylßd_Ën
);

289 
	`Æ_com¶‘e_msg
(
Æh
, 
Æmsg
);

290 
”r
 = 
	`Æ_£nd_iovec
(
Æh
, 
Æmsg
, 
iov
, 3);

292 
	`Æmsg_ä“
(
Æmsg
);

293 ià(
”r
 < 0)

294  
”r
;

295  
	`wa™_fÜ_ack
(
Æh
);

296 
	}
}

298 
	#NFNLMSG_QUEUE_TYPE
(
ty³
è
	`NFNLMSG_TYPE
(
NFNL_SUBSYS_QUEUE
, (ty³))

	)

299 
Æ_ÿche_İs
 
	gnâl_queue_msg_İs
 = {

300 .
co_Çme
 = "netfilter/queue_msg",

301 .
	gco_hdrsize
 = 
NFNL_HDRLEN
,

302 .
	gco_msgty³s
 = {

303 { 
NFNLMSG_QUEUE_TYPE
(
NFQNL_MSG_PACKET
), 
NL_ACT_NEW
, "new" },

304 
END_OF_MSGTYPES_LIST
,

306 .
	gco_´ÙocŞ
 = 
NETLINK_NETFILTER
,

307 .
	gco_msg_·r£r
 = 
queue_msg_·r£r
,

308 .
	gco_obj_İs
 = &
queue_msg_obj_İs
,

311 
__š™
 
	$nâl_msg_queue_š™
()

313 
	`Æ_ÿche_mngt_»gi¡”
(&
nâl_queue_msg_İs
);

314 
	}
}

316 
__ex™
 
	$nâl_queue_msg_ex™
()

318 
	`Æ_ÿche_mngt_uÄegi¡”
(&
nâl_queue_msg_İs
);

319 
	}
}

	@mylibnl/libnl-3.2.25/lib/netfilter/queue_msg_obj.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/Ãtf‹r/nâl.h
>

14 
	~<Ãšk/Ãtf‹r/Ãtf‹r.h
>

15 
	~<Ãšk/Ãtf‹r/queue_msg.h
>

16 
	~<lšux/Ãtf‹r.h
>

19 
	#QUEUE_MSG_ATTR_GROUP
 (1UL << 0)

	)

20 
	#QUEUE_MSG_ATTR_FAMILY
 (1UL << 1)

	)

21 
	#QUEUE_MSG_ATTR_PACKETID
 (1UL << 2)

	)

22 
	#QUEUE_MSG_ATTR_HWPROTO
 (1UL << 3)

	)

23 
	#QUEUE_MSG_ATTR_HOOK
 (1UL << 4)

	)

24 
	#QUEUE_MSG_ATTR_MARK
 (1UL << 5)

	)

25 
	#QUEUE_MSG_ATTR_TIMESTAMP
 (1UL << 6)

	)

26 
	#QUEUE_MSG_ATTR_INDEV
 (1UL << 7)

	)

27 
	#QUEUE_MSG_ATTR_OUTDEV
 (1UL << 8)

	)

28 
	#QUEUE_MSG_ATTR_PHYSINDEV
 (1UL << 9)

	)

29 
	#QUEUE_MSG_ATTR_PHYSOUTDEV
 (1UL << 10)

	)

30 
	#QUEUE_MSG_ATTR_HWADDR
 (1UL << 11)

	)

31 
	#QUEUE_MSG_ATTR_PAYLOAD
 (1UL << 12)

	)

32 
	#QUEUE_MSG_ATTR_VERDICT
 (1UL << 13)

	)

35 
	$nâl_queue_msg_ä“_d©a
(
Æ_objeù
 *
c
)

37 
nâl_queue_msg
 *
msg
 = (nâl_queue_msg *è
c
;

39 ià(
msg
 =ğ
NULL
)

42 
	`ä“
(
msg
->
queue_msg_·ylßd
);

43 
	}
}

45 
	$nâl_queue_msg_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

47 
nâl_queue_msg
 *
d¡
 = (nâl_queue_msg *è
_d¡
;

48 
nâl_queue_msg
 *
¤c
 = (nâl_queue_msg *è
_¤c
;

49 
”r
;

51 ià(
¤c
->
queue_msg_·ylßd
) {

52 
”r
 = 
	`nâl_queue_msg_£t_·ylßd
(
d¡
, 
¤c
->
queue_msg_·ylßd
,

53 
¤c
->
queue_msg_·ylßd_Ën
);

54 ià(
”r
 < 0)

55 
”rout
;

59 
”rout
:

60  
”r
;

61 
	}
}

63 
	$nâl_queue_msg_dump
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

65 
nâl_queue_msg
 *
msg
 = (nâl_queue_msg *è
a
;

66 
Æ_ÿche
 *
lšk_ÿche
;

67 
buf
[64];

69 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

71 
	`Æ_Ãw_lše
(
p
);

73 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_GROUP
)

74 
	`Æ_dump
(
p
, "GROUP=%u ", 
msg
->
queue_msg_group
);

76 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_INDEV
) {

77 ià(
lšk_ÿche
)

78 
	`Æ_dump
(
p
, "IN=%s ",

79 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

80 
msg
->
queue_msg_šdev
,

81 
buf
, (buf)));

83 
	`Æ_dump
(
p
, "IN=%d ", 
msg
->
queue_msg_šdev
);

86 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PHYSINDEV
) {

87 ià(
lšk_ÿche
)

88 
	`Æ_dump
(
p
, "PHYSIN=%s ",

89 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

90 
msg
->
queue_msg_physšdev
,

91 
buf
, (buf)));

93 
	`Æ_dump
(
p
, "IN=%d ", 
msg
->
queue_msg_physšdev
);

96 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_OUTDEV
) {

97 ià(
lšk_ÿche
)

98 
	`Æ_dump
(
p
, "OUT=%s ",

99 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

100 
msg
->
queue_msg_outdev
,

101 
buf
, (buf)));

103 
	`Æ_dump
(
p
, "OUT=%d ", 
msg
->
queue_msg_outdev
);

106 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PHYSOUTDEV
) {

107 ià(
lšk_ÿche
)

108 
	`Æ_dump
(
p
, "PHYSOUT=%s ",

109 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

110 
msg
->
queue_msg_physoutdev
,

111 
buf
, (buf)));

113 
	`Æ_dump
(
p
, "PHYSOUT=%d ", 
msg
->
queue_msg_physoutdev
);

116 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HWADDR
) {

117 
i
;

119 
	`Æ_dump
(
p
, "MAC");

120 
i
 = 0; i < 
msg
->
queue_msg_hwaddr_Ën
; i++)

121 
	`Æ_dump
(
p
, "%c%02x", 
i
?':':'=',

122 
msg
->
queue_msg_hwaddr
[
i
]);

123 
	`Æ_dump
(
p
, " ");

126 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_FAMILY
)

127 
	`Æ_dump
(
p
, "FAMILY=%s ",

128 
	`Æ_af2¡r
(
msg
->
queue_msg_çmy
, 
buf
, (buf)));

130 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HWPROTO
)

131 
	`Æ_dump
(
p
, "HWPROTO=%s ",

132 
	`Æ_‘h”_´Ùo2¡r
(
	`Áohs
(
msg
->
queue_msg_hw´Ùo
),

133 
buf
, (buf)));

135 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HOOK
)

136 
	`Æ_dump
(
p
, "HOOK=%s ",

137 
	`nâl_š‘_hook2¡r
(
msg
->
queue_msg_hook
,

138 
buf
, (buf)));

140 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_MARK
)

141 
	`Æ_dump
(
p
, "MARK=%d ", 
msg
->
queue_msg_m¬k
);

143 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PAYLOAD
)

144 
	`Æ_dump
(
p
, "PAYLOADLEN=%d ", 
msg
->
queue_msg_·ylßd_Ën
);

146 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PACKETID
)

147 
	`Æ_dump
(
p
, "PACKETID=%u ", 
msg
->
queue_msg_·ck‘id
);

149 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_VERDICT
)

150 
	`Æ_dump
(
p
, "VERDICT=%s ",

151 
	`nâl_v”diù2¡r
(
msg
->
queue_msg_v”diù
,

152 
buf
, (buf)));

154 
	`Æ_dump
(
p
, "\n");

156 ià(
lšk_ÿche
)

157 
	`Æ_ÿche_put
(
lšk_ÿche
);

158 
	}
}

165 
nâl_queue_msg
 *
	$nâl_queue_msg_®loc
()

167  (
nâl_queue_msg
 *è
	`Æ_objeù_®loc
(&
queue_msg_obj_İs
);

168 
	}
}

170 
	$nâl_queue_msg_g‘
(
nâl_queue_msg
 *
msg
)

172 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
msg
);

173 
	}
}

175 
	$nâl_queue_msg_put
(
nâl_queue_msg
 *
msg
)

177 
	`Æ_objeù_put
((
Æ_objeù
 *è
msg
);

178 
	}
}

187 
	$nâl_queue_msg_£t_group
(
nâl_queue_msg
 *
msg
, 
ušt16_t
 
group
)

189 
msg
->
queue_msg_group
 = 
group
;

190 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_GROUP
;

191 
	}
}

193 
	$nâl_queue_msg_‹¡_group
(cÚ¡ 
nâl_queue_msg
 *
msg
)

195  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_GROUP
);

196 
	}
}

198 
ušt16_t
 
	$nâl_queue_msg_g‘_group
(cÚ¡ 
nâl_queue_msg
 *
msg
)

200  
msg
->
queue_msg_group
;

201 
	}
}

208 
	$nâl_queue_msg_£t_çmy
(
nâl_queue_msg
 *
msg
, 
ušt8_t
 
çmy
)

210 
msg
->
queue_msg_çmy
 = 
çmy
;

211 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_FAMILY
;

212 
	}
}

214 
	$nâl_queue_msg_‹¡_çmy
(cÚ¡ 
nâl_queue_msg
 *
msg
)

216  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_FAMILY
);

217 
	}
}

219 
ušt8_t
 
	$nâl_queue_msg_g‘_çmy
(cÚ¡ 
nâl_queue_msg
 *
msg
)

221 ià(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_FAMILY
)

222  
msg
->
queue_msg_çmy
;

224  
AF_UNSPEC
;

225 
	}
}

227 
	$nâl_queue_msg_£t_·ck‘id
(
nâl_queue_msg
 *
msg
, 
ušt32_t
 
·ck‘id
)

229 
msg
->
queue_msg_·ck‘id
 = 
·ck‘id
;

230 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_PACKETID
;

231 
	}
}

233 
	$nâl_queue_msg_‹¡_·ck‘id
(cÚ¡ 
nâl_queue_msg
 *
msg
)

235  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PACKETID
);

236 
	}
}

238 
ušt32_t
 
	$nâl_queue_msg_g‘_·ck‘id
(cÚ¡ 
nâl_queue_msg
 *
msg
)

240  
msg
->
queue_msg_·ck‘id
;

241 
	}
}

243 
	$nâl_queue_msg_£t_hw´Ùo
(
nâl_queue_msg
 *
msg
, 
ušt16_t
 
hw´Ùo
)

245 
msg
->
queue_msg_hw´Ùo
 = 
hw´Ùo
;

246 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_HWPROTO
;

247 
	}
}

249 
	$nâl_queue_msg_‹¡_hw´Ùo
(cÚ¡ 
nâl_queue_msg
 *
msg
)

251  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HWPROTO
);

252 
	}
}

254 
ušt16_t
 
	$nâl_queue_msg_g‘_hw´Ùo
(cÚ¡ 
nâl_queue_msg
 *
msg
)

256  
msg
->
queue_msg_hw´Ùo
;

257 
	}
}

259 
	$nâl_queue_msg_£t_hook
(
nâl_queue_msg
 *
msg
, 
ušt8_t
 
hook
)

261 
msg
->
queue_msg_hook
 = 
hook
;

262 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_HOOK
;

263 
	}
}

265 
	$nâl_queue_msg_‹¡_hook
(cÚ¡ 
nâl_queue_msg
 *
msg
)

267  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HOOK
);

268 
	}
}

270 
ušt8_t
 
	$nâl_queue_msg_g‘_hook
(cÚ¡ 
nâl_queue_msg
 *
msg
)

272  
msg
->
queue_msg_hook
;

273 
	}
}

275 
	$nâl_queue_msg_£t_m¬k
(
nâl_queue_msg
 *
msg
, 
ušt32_t
 
m¬k
)

277 
msg
->
queue_msg_m¬k
 = 
m¬k
;

278 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_MARK
;

279 
	}
}

281 
	$nâl_queue_msg_‹¡_m¬k
(cÚ¡ 
nâl_queue_msg
 *
msg
)

283  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_MARK
);

284 
	}
}

286 
ušt32_t
 
	$nâl_queue_msg_g‘_m¬k
(cÚ¡ 
nâl_queue_msg
 *
msg
)

288  
msg
->
queue_msg_m¬k
;

289 
	}
}

291 
	$nâl_queue_msg_£t_time¡amp
(
nâl_queue_msg
 *
msg
,

292 
timev®
 *
tv
)

294 
msg
->
queue_msg_time¡amp
.
tv_£c
 = 
tv
->tv_sec;

295 
msg
->
queue_msg_time¡amp
.
tv_u£c
 = 
tv
->tv_usec;

296 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_TIMESTAMP
;

297 
	}
}

299 
	$nâl_queue_msg_‹¡_time¡amp
(cÚ¡ 
nâl_queue_msg
 *
msg
)

301  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_TIMESTAMP
);

302 
	}
}

304 cÚ¡ 
timev®
 *
	$nâl_queue_msg_g‘_time¡amp
(cÚ¡ 
nâl_queue_msg
 *
msg
)

306 ià(!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_TIMESTAMP
))

307  
NULL
;

308  &
msg
->
queue_msg_time¡amp
;

309 
	}
}

311 
	$nâl_queue_msg_£t_šdev
(
nâl_queue_msg
 *
msg
, 
ušt32_t
 
šdev
)

313 
msg
->
queue_msg_šdev
 = 
šdev
;

314 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_INDEV
;

315 
	}
}

317 
	$nâl_queue_msg_‹¡_šdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

319  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_INDEV
);

320 
	}
}

322 
ušt32_t
 
	$nâl_queue_msg_g‘_šdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

324  
msg
->
queue_msg_šdev
;

325 
	}
}

327 
	$nâl_queue_msg_£t_outdev
(
nâl_queue_msg
 *
msg
, 
ušt32_t
 
outdev
)

329 
msg
->
queue_msg_outdev
 = 
outdev
;

330 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_OUTDEV
;

331 
	}
}

333 
	$nâl_queue_msg_‹¡_outdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

335  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_OUTDEV
);

336 
	}
}

338 
ušt32_t
 
	$nâl_queue_msg_g‘_outdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

340  
msg
->
queue_msg_outdev
;

341 
	}
}

343 
	$nâl_queue_msg_£t_physšdev
(
nâl_queue_msg
 *
msg
,

344 
ušt32_t
 
physšdev
)

346 
msg
->
queue_msg_physšdev
 = 
physšdev
;

347 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_PHYSINDEV
;

348 
	}
}

350 
	$nâl_queue_msg_‹¡_physšdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

352  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PHYSINDEV
);

353 
	}
}

355 
ušt32_t
 
	$nâl_queue_msg_g‘_physšdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

357  
msg
->
queue_msg_physšdev
;

358 
	}
}

360 
	$nâl_queue_msg_£t_physoutdev
(
nâl_queue_msg
 *
msg
,

361 
ušt32_t
 
physoutdev
)

363 
msg
->
queue_msg_physoutdev
 = 
physoutdev
;

364 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_PHYSOUTDEV
;

365 
	}
}

367 
	$nâl_queue_msg_‹¡_physoutdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

369  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PHYSOUTDEV
);

370 
	}
}

372 
ušt32_t
 
	$nâl_queue_msg_g‘_physoutdev
(cÚ¡ 
nâl_queue_msg
 *
msg
)

374  
msg
->
queue_msg_physoutdev
;

375 
	}
}

377 
	$nâl_queue_msg_£t_hwaddr
(
nâl_queue_msg
 *
msg
, 
ušt8_t
 *
hwaddr
,

378 
Ën
)

380 ià(
Ën
 > (
msg
->
queue_msg_hwaddr
))

381 
Ën
 = (
msg
->
queue_msg_hwaddr
);

383 
msg
->
queue_msg_hwaddr_Ën
 = 
Ën
;

384 
	`memıy
(
msg
->
queue_msg_hwaddr
, 
hwaddr
, 
Ën
);

385 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_HWADDR
;

386 
	}
}

388 
	$nâl_queue_msg_‹¡_hwaddr
(cÚ¡ 
nâl_queue_msg
 *
msg
)

390  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HWADDR
);

391 
	}
}

393 cÚ¡ 
ušt8_t
 *
	$nâl_queue_msg_g‘_hwaddr
(cÚ¡ 
nâl_queue_msg
 *
msg
,

394 *
Ën
)

396 ià(!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_HWADDR
)) {

397 *
Ën
 = 0;

398  
NULL
;

401 *
Ën
 = 
msg
->
queue_msg_hwaddr_Ën
;

402  
msg
->
queue_msg_hwaddr
;

403 
	}
}

405 
	$nâl_queue_msg_£t_·ylßd
(
nâl_queue_msg
 *
msg
, 
ušt8_t
 *
·ylßd
,

406 
Ën
)

408 
	`ä“
(
msg
->
queue_msg_·ylßd
);

409 
msg
->
queue_msg_·ylßd
 = 
	`m®loc
(
Ën
);

410 ià(!
msg
->
queue_msg_·ylßd
)

411  -
NLE_NOMEM
;

413 
	`memıy
(
msg
->
queue_msg_·ylßd
, 
·ylßd
, 
Ën
);

414 
msg
->
queue_msg_·ylßd_Ën
 = 
Ën
;

415 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_PAYLOAD
;

417 
	}
}

419 
	$nâl_queue_msg_‹¡_·ylßd
(cÚ¡ 
nâl_queue_msg
 *
msg
)

421  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PAYLOAD
);

422 
	}
}

424 cÚ¡ *
	$nâl_queue_msg_g‘_·ylßd
(cÚ¡ 
nâl_queue_msg
 *
msg
, *
Ën
)

426 ià(!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_PAYLOAD
)) {

427 *
Ën
 = 0;

428  
NULL
;

431 *
Ën
 = 
msg
->
queue_msg_·ylßd_Ën
;

432  
msg
->
queue_msg_·ylßd
;

433 
	}
}

440 
	$nâl_queue_msg_£t_v”diù
(
nâl_queue_msg
 *
msg
,

441 
v”diù
)

443 
msg
->
queue_msg_v”diù
 = 
v”diù
;

444 
msg
->
û_mask
 |ğ
QUEUE_MSG_ATTR_VERDICT
;

445 
	}
}

447 
	$nâl_queue_msg_‹¡_v”diù
(cÚ¡ 
nâl_queue_msg
 *
msg
)

449  !!(
msg
->
û_mask
 & 
QUEUE_MSG_ATTR_VERDICT
);

450 
	}
}

452 
	$nâl_queue_msg_g‘_v”diù
(cÚ¡ 
nâl_queue_msg
 *
msg
)

454  
msg
->
queue_msg_v”diù
;

455 
	}
}

457 cÚ¡ 
Œªs_tbl
 
	gnâl_queue_msg_©Œs
[] = {

458 
__ADD
(
QUEUE_MSG_ATTR_GROUP
, 
group
)

459 
__ADD
(
QUEUE_MSG_ATTR_FAMILY
, 
çmy
)

460 
__ADD
(
QUEUE_MSG_ATTR_PACKETID
, 
·ck‘id
)

461 
__ADD
(
QUEUE_MSG_ATTR_HWPROTO
, 
hw´Ùo
)

462 
__ADD
(
QUEUE_MSG_ATTR_HOOK
, 
hook
)

463 
__ADD
(
QUEUE_MSG_ATTR_MARK
, 
m¬k
)

464 
__ADD
(
QUEUE_MSG_ATTR_TIMESTAMP
, 
time¡amp
)

465 
__ADD
(
QUEUE_MSG_ATTR_INDEV
, 
šdev
)

466 
__ADD
(
QUEUE_MSG_ATTR_OUTDEV
, 
outdev
)

467 
__ADD
(
QUEUE_MSG_ATTR_PHYSINDEV
, 
physšdev
)

468 
__ADD
(
QUEUE_MSG_ATTR_PHYSOUTDEV
, 
physoutdev
)

469 
__ADD
(
QUEUE_MSG_ATTR_HWADDR
, 
hwaddr
)

470 
__ADD
(
QUEUE_MSG_ATTR_PAYLOAD
, 
·ylßd
)

471 
__ADD
(
QUEUE_MSG_ATTR_VERDICT
, 
v”diù
)

474 *
	$nâl_queue_msg_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

476  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
nâl_queue_msg_©Œs
,

477 
	`ARRAY_SIZE
(
nâl_queue_msg_©Œs
));

478 
	}
}

482 
Æ_objeù_İs
 
	gqueue_msg_obj_İs
 = {

483 .
oo_Çme
 = "netfilter/queuemsg",

484 .
	goo_size
 = (
nâl_queue_msg
),

485 .
	goo_ä“_d©a
 = 
nâl_queue_msg_ä“_d©a
,

486 .
	goo_şÚe
 = 
nâl_queue_msg_şÚe
,

487 .
	goo_dump
 = {

488 [
NL_DUMP_LINE
] = 
nâl_queue_msg_dump
,

489 [
NL_DUMP_DETAILS
] = 
nâl_queue_msg_dump
,

490 [
NL_DUMP_STATS
] = 
nâl_queue_msg_dump
,

492 .
	goo_©Œs2¡r
 = 
nâl_queue_msg_©Œs2¡r
,

	@mylibnl/libnl-3.2.25/lib/netfilter/queue_obj.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãtf‹r/nâl.h
>

21 
	~<Ãšk/Ãtf‹r/queue.h
>

24 
	#QUEUE_ATTR_GROUP
 (1UL << 0)

	)

25 
	#QUEUE_ATTR_MAXLEN
 (1UL << 1)

	)

26 
	#QUEUE_ATTR_COPY_MODE
 (1UL << 2)

	)

27 
	#QUEUE_ATTR_COPY_RANGE
 (1UL << 3)

	)

31 
	$nâl_queue_dump
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

33 
nâl_queue
 *
queue
 = (nâl_queu*è
a
;

34 
buf
[64];

36 
	`Æ_Ãw_lše
(
p
);

38 ià(
queue
->
û_mask
 & 
QUEUE_ATTR_GROUP
)

39 
	`Æ_dump
(
p
, "group=%u ", 
queue
->
queue_group
);

41 ià(
queue
->
û_mask
 & 
QUEUE_ATTR_MAXLEN
)

42 
	`Æ_dump
(
p
, "maxËn=%u ", 
queue
->
queue_maxËn
);

44 ià(
queue
->
û_mask
 & 
QUEUE_ATTR_COPY_MODE
)

45 
	`Æ_dump
(
p
, "copy_mode=%s ",

46 
	`nâl_queue_cİy_mode2¡r
(
queue
->
queue_cİy_mode
,

47 
buf
, (buf)));

49 ià(
queue
->
û_mask
 & 
QUEUE_ATTR_COPY_RANGE
)

50 
	`Æ_dump
(
p
, "cİy_¿nge=%u ", 
queue
->
queue_cİy_¿nge
);

52 
	`Æ_dump
(
p
, "\n");

53 
	}
}

55 cÚ¡ 
Œªs_tbl
 
	gcİy_modes
[] = {

56 
__ADD
(
NFNL_QUEUE_COPY_NONE
, 
nÚe
)

57 
__ADD
(
NFNL_QUEUE_COPY_META
, 
m‘a
)

58 
__ADD
(
NFNL_QUEUE_COPY_PACKET
, 
·ck‘
)

61 *
	$nâl_queue_cİy_mode2¡r
(
nâl_queue_cİy_mode
 
cİy_mode
, *
buf
,

62 
size_t
 
Ën
)

64  
	`__ty³2¡r
(
cİy_mode
, 
buf
, 
Ën
, 
cİy_modes
,

65 
	`ARRAY_SIZE
(
cİy_modes
));

66 
	}
}

68 
nâl_queue_cİy_mode
 
	$nâl_queue_¡r2cİy_mode
(cÚ¡ *
Çme
)

70  
	`__¡r2ty³
(
Çme
, 
cİy_modes
, 
	`ARRAY_SIZE
(copy_modes));

71 
	}
}

78 
nâl_queue
 *
	$nâl_queue_®loc
()

80  (
nâl_queue
 *è
	`Æ_objeù_®loc
(&
queue_obj_İs
);

81 
	}
}

83 
	$nâl_queue_g‘
(
nâl_queue
 *
queue
)

85 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
queue
);

86 
	}
}

88 
	$nâl_queue_put
(
nâl_queue
 *
queue
)

90 
	`Æ_objeù_put
((
Æ_objeù
 *è
queue
);

91 
	}
}

100 
	$nâl_queue_£t_group
(
nâl_queue
 *
queue
, 
ušt16_t
 
group
)

102 
queue
->
queue_group
 = 
group
;

103 
queue
->
û_mask
 |ğ
QUEUE_ATTR_GROUP
;

104 
	}
}

106 
	$nâl_queue_‹¡_group
(cÚ¡ 
nâl_queue
 *
queue
)

108  !!(
queue
->
û_mask
 & 
QUEUE_ATTR_GROUP
);

109 
	}
}

111 
ušt16_t
 
	$nâl_queue_g‘_group
(cÚ¡ 
nâl_queue
 *
queue
)

113  
queue
->
queue_group
;

114 
	}
}

116 
	$nâl_queue_£t_maxËn
(
nâl_queue
 *
queue
, 
ušt32_t
 
maxËn
)

118 
queue
->
queue_maxËn
 = 
maxËn
;

119 
queue
->
û_mask
 |ğ
QUEUE_ATTR_MAXLEN
;

120 
	}
}

122 
	$nâl_queue_‹¡_maxËn
(cÚ¡ 
nâl_queue
 *
queue
)

124  !!(
queue
->
û_mask
 & 
QUEUE_ATTR_MAXLEN
);

125 
	}
}

127 
ušt32_t
 
	$nâl_queue_g‘_maxËn
(cÚ¡ 
nâl_queue
 *
queue
)

129  
queue
->
queue_maxËn
;

130 
	}
}

132 
	$nâl_queue_£t_cİy_mode
(
nâl_queue
 *
queue
, 
nâl_queue_cİy_mode
 
mode
)

134 
queue
->
queue_cİy_mode
 = 
mode
;

135 
queue
->
û_mask
 |ğ
QUEUE_ATTR_COPY_MODE
;

136 
	}
}

138 
	$nâl_queue_‹¡_cİy_mode
(cÚ¡ 
nâl_queue
 *
queue
)

140  !!(
queue
->
û_mask
 & 
QUEUE_ATTR_COPY_MODE
);

141 
	}
}

143 
nâl_queue_cİy_mode
 
	$nâl_queue_g‘_cİy_mode
(cÚ¡ 
nâl_queue
 *
queue
)

145  
queue
->
queue_cİy_mode
;

146 
	}
}

148 
	$nâl_queue_£t_cİy_¿nge
(
nâl_queue
 *
queue
, 
ušt32_t
 
cİy_¿nge
)

150 
queue
->
queue_cİy_¿nge
 = 
cİy_¿nge
;

151 
queue
->
û_mask
 |ğ
QUEUE_ATTR_COPY_RANGE
;

152 
	}
}

154 
	$nâl_queue_‹¡_cİy_¿nge
(cÚ¡ 
nâl_queue
 *
queue
)

156  !!(
queue
->
û_mask
 & 
QUEUE_ATTR_COPY_RANGE
);

157 
	}
}

159 
ušt32_t
 
	$nâl_queue_g‘_cİy_¿nge
(cÚ¡ 
nâl_queue
 *
queue
)

161  
queue
->
queue_cİy_¿nge
;

162 
	}
}

164 
	$nâl_queue_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

165 
ušt32_t
 
©Œs
, 
æags
)

167 
nâl_queue
 *
a
 = (nâl_queu*è
_a
;

168 
nâl_queue
 *
b
 = (nâl_queu*è
_b
;

169 
diff
 = 0;

171 
	#NFNL_QUEUE_DIFF
(
ATTR
, 
EXPR
) \

172 
	`ATTR_DIFF
(
©Œs
, 
QUEUE_ATTR_
##
ATTR
, 
a
, 
b
, 
EXPR
)

	)

173 
	#NFNL_QUEUE_DIFF_VAL
(
ATTR
, 
FIELD
) \

174 
	`NFNL_QUEUE_DIFF
(
ATTR
, 
a
->
FIELD
 !ğ
b
->FIELD)

	)

176 
diff
 |ğ
	`NFNL_QUEUE_DIFF_VAL
(
GROUP
, 
queue_group
);

177 
diff
 |ğ
	`NFNL_QUEUE_DIFF_VAL
(
MAXLEN
, 
queue_maxËn
);

178 
diff
 |ğ
	`NFNL_QUEUE_DIFF_VAL
(
COPY_MODE
, 
queue_cİy_mode
);

179 
diff
 |ğ
	`NFNL_QUEUE_DIFF_VAL
(
COPY_RANGE
, 
queue_cİy_¿nge
);

181 #undeà
NFNL_QUEUE_DIFF


182 #undeà
NFNL_QUEUE_DIFF_VAL


184  
diff
;

185 
	}
}

187 cÚ¡ 
Œªs_tbl
 
	gnâl_queue_©Œs
[] = {

188 
__ADD
(
QUEUE_ATTR_GROUP
, 
group
)

189 
__ADD
(
QUEUE_ATTR_MAXLEN
, 
maxËn
)

190 
__ADD
(
QUEUE_ATTR_COPY_MODE
, 
cİy_mode
)

191 
__ADD
(
QUEUE_ATTR_COPY_RANGE
, 
cİy_¿nge
)

194 *
	$nâl_queue_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

196  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
nâl_queue_©Œs
,

197 
	`ARRAY_SIZE
(
nâl_queue_©Œs
));

198 
	}
}

202 
Æ_objeù_İs
 
	gqueue_obj_İs
 = {

203 .
oo_Çme
 = "netfilter/queue",

204 .
	goo_size
 = (
nâl_queue
),

205 .
	goo_dump
 = {

206 [
NL_DUMP_LINE
] = 
nâl_queue_dump
,

207 [
NL_DUMP_DETAILS
] = 
nâl_queue_dump
,

208 [
NL_DUMP_STATS
] = 
nâl_queue_dump
,

210 .
	goo_com·»
 = 
nâl_queue_com·»
,

211 .
	goo_©Œs2¡r
 = 
nâl_queue_©Œs2¡r
,

212 .
	goo_id_©Œs
 = 
QUEUE_ATTR_GROUP
,

	@mylibnl/libnl-3.2.25/lib/nl.c

28 
	~<Ãšk-´iv©e/Ãšk.h
>

29 
	~<Ãšk-´iv©e/sock‘.h
>

30 
	~<Ãšk/Ãšk.h
>

31 
	~<Ãšk/uts.h
>

32 
	~<Ãšk/hªdËrs.h
>

33 
	~<Ãšk/msg.h
>

34 
	~<Ãšk/©Œ.h
>

96 
	$Æ_cÚÃù
(
Æ_sock
 *
sk
, 
´ÙocŞ
)

98 
”r
, 
æags
 = 0;

99 
”rsv
;

100 
sockËn_t
 
add¾’
;

102 #ifdeà
SOCK_CLOEXEC


103 
æags
 |ğ
SOCK_CLOEXEC
;

106 ià(
sk
->
s_fd
 != -1)

107  -
NLE_BAD_SOCK
;

109 
sk
->
s_fd
 = 
	`sock‘
(
AF_NETLINK
, 
SOCK_RAW
 | 
æags
, 
´ÙocŞ
);

110 ià(
sk
->
s_fd
 < 0) {

111 
”rsv
 = 
”ºo
;

112 
	`NL_DBG
(4, "Æ_cÚÃù(%p): sock‘(èçed w™h %d\n", 
sk
, 
”rsv
);

113 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”rsv
);

114 
”rout
;

117 ià(!(
sk
->
s_æags
 & 
NL_SOCK_BUFSIZE_SET
)) {

118 
”r
 = 
	`Æ_sock‘_£t_bufãr_size
(
sk
, 0, 0);

119 ià(
”r
 < 0)

120 
”rout
;

123 ià(
	`_Æ_sock‘_is_loÿl_pÜt_un¥ecif›d
 (
sk
)) {

124 
ušt32_t
 
pÜt
;

125 
ušt32_t
 
u£d_pÜts
[32] = { 0 };

128 
pÜt
 = 
	`_Æ_sock‘_g’”©e_loÿl_pÜt_no_»Ëa£
(
sk
);

130 ià(
pÜt
 =ğ
UINT32_MAX
) {

131 
	`NL_DBG
(4, "Æ_cÚÃù(%p):‚ØmÜunu£d†oÿÈpÜts.\n", 
sk
);

132 
	`_Æ_sock‘_u£d_pÜts_»Ëa£_®l
(
u£d_pÜts
);

133 
”r
 = -
NLE_EXIST
;

134 
”rout
;

136 
”r
 = 
	`bšd
(
sk
->
s_fd
, (
sockaddr
*è&sk->
s_loÿl
,

137 (
sk
->
s_loÿl
));

138 ià(
”r
 == 0)

141 
”rsv
 = 
”ºo
;

142 ià(
”rsv
 =ğ
EADDRINUSE
) {

143 
	`NL_DBG
(4, "Æ_cÚÃù(%p):†oÿÈpÜˆ%u‡Ì—dy iÀu£. R‘ry.\n", 
sk
, (è
pÜt
);

144 
	`_Æ_sock‘_u£d_pÜts_£t
(
u£d_pÜts
, 
pÜt
);

146 
	`NL_DBG
(4, "Æ_cÚÃù(%p): bšd(èfÜ…Üˆ%u faed w™h %d\n", 
sk
, (è
pÜt
, 
”rsv
);

147 
	`_Æ_sock‘_u£d_pÜts_»Ëa£_®l
(
u£d_pÜts
);

148 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”rsv
);

149 
”rout
;

152 
	`_Æ_sock‘_u£d_pÜts_»Ëa£_®l
(
u£d_pÜts
);

154 
”r
 = 
	`bšd
(
sk
->
s_fd
, (
sockaddr
*è&sk->
s_loÿl
,

155 (
sk
->
s_loÿl
));

156 ià(
”r
 != 0) {

157 
”rsv
 = 
”ºo
;

158 
	`NL_DBG
(4, "Æ_cÚÃù(%p): bšd(èçed w™h %d\n", 
sk
, 
”rsv
);

159 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”rsv
);

160 
”rout
;

164 
add¾’
 = (
sk
->
s_loÿl
);

165 
”r
 = 
	`g‘sockÇme
(
sk
->
s_fd
, (
sockaddr
 *è&sk->
s_loÿl
,

166 &
add¾’
);

167 ià(
”r
 < 0) {

168 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”ºo
);

169 
”rout
;

172 ià(
add¾’
 !ğ(
sk
->
s_loÿl
)) {

173 
”r
 = -
NLE_NOADDR
;

174 
”rout
;

177 ià(
sk
->
s_loÿl
.
Æ_çmy
 !ğ
AF_NETLINK
) {

178 
”r
 = -
NLE_AF_NOSUPPORT
;

179 
”rout
;

182 
sk
->
s_´Ùo
 = 
´ÙocŞ
;

185 
”rout
:

186 ià(
sk
->
s_fd
 != -1) {

187 
	`şo£
(
sk
->
s_fd
);

188 
sk
->
s_fd
 = -1;

191  
”r
;

192 
	}
}

205 
	$Æ_şo£
(
Æ_sock
 *
sk
)

207 ià(
sk
->
s_fd
 >= 0) {

208 
	`şo£
(
sk
->
s_fd
);

209 
sk
->
s_fd
 = -1;

212 
sk
->
s_´Ùo
 = 0;

213 
	}
}

245 
	$Æ_£ndto
(
Æ_sock
 *
sk
, *
buf
, 
size_t
 
size
)

247 
»t
;

249 ià(!
buf
)

250  -
NLE_INVAL
;

252 ià(
sk
->
s_fd
 < 0)

253  -
NLE_BAD_SOCK
;

255 
»t
 = 
	`£ndto
(
sk
->
s_fd
, 
buf
, 
size
, 0, (
sockaddr
 *)

256 &
sk
->
s_³”
, (sk->s_peer));

257 ià(
»t
 < 0)

258  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

260  
»t
;

261 
	}
}

299 
	$Æ_£ndmsg
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
, 
msghdr
 *
hdr
)

301 
Æ_cb
 *
cb
;

302 
»t
;

304 ià(
sk
->
s_fd
 < 0)

305  -
NLE_BAD_SOCK
;

307 
	`Æmsg_£t_¤c
(
msg
, &
sk
->
s_loÿl
);

309 
cb
 = 
sk
->
s_cb
;

310 ià(
cb
->
cb_£t
[
NL_CB_MSG_OUT
])

311 ià((
»t
 = 
	`Æ_cb_ÿÎ
(
cb
, 
NL_CB_MSG_OUT
, 
msg
)è!ğ
NL_OK
)

312  
»t
;

314 
»t
 = 
	`£ndmsg
(
sk
->
s_fd
, 
hdr
, 0);

315 ià(
»t
 < 0)

316  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

318 
	`NL_DBG
(4, "£Á %d by‹s\n", 
»t
);

319  
»t
;

320 
	}
}

342 
	$Æ_£nd_iovec
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
, 
iovec
 *
iov
, 
iovËn
)

344 
sockaddr_Æ
 *
d¡
;

345 
uüed
 *
üeds
;

346 
msghdr
 
hdr
 = {

347 .
msg_Çme
 = (*è&
sk
->
s_³”
,

348 .
msg_Çm–’
 = (
sockaddr_Æ
),

349 .
msg_iov
 = 
iov
,

350 .
msg_iovËn
 = 
iovËn
,

356 
d¡
 = 
	`Æmsg_g‘_d¡
(
msg
);

357 ià(
d¡
->
Æ_çmy
 =ğ
AF_NETLINK
)

358 
hdr
.
msg_Çme
 = 
d¡
;

361 
üeds
 = 
	`Æmsg_g‘_üeds
(
msg
);

362 ià(
üeds
 !ğ
NULL
) {

363 
buf
[
	`CMSG_SPACE
((
uüed
))];

364 
cmsghdr
 *
cmsg
;

366 
hdr
.
msg_cÚŒŞ
 = 
buf
;

367 
hdr
.
msg_cÚŒŞËn
 = (
buf
);

369 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
hdr
);

370 
cmsg
->
cmsg_Ëv–
 = 
SOL_SOCKET
;

371 
cmsg
->
cmsg_ty³
 = 
SCM_CREDENTIALS
;

372 
cmsg
->
cmsg_Ën
 = 
	`CMSG_LEN
((
uüed
));

373 
	`memıy
(
	`CMSG_DATA
(
cmsg
), 
üeds
, (
uüed
));

376  
	`Æ_£ndmsg
(
sk
, 
msg
, &
hdr
);

377 
	}
}

416 
	$Æ_£nd
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

418 
Æ_cb
 *
cb
 = 
sk
->
s_cb
;

420 ià(
cb
->
cb_£nd_ow
)

421  
cb
->
	`cb_£nd_ow
(
sk
, 
msg
);

423 
iovec
 
iov
 = {

424 .
iov_ba£
 = (*è
	`Æmsg_hdr
(
msg
),

425 .
iov_Ën
 = 
	`Æmsg_hdr
(
msg
)->
Æmsg_Ën
,

428  
	`Æ_£nd_iovec
(
sk
, 
msg
, &
iov
, 1);

430 
	}
}

450 
	$Æ_com¶‘e_msg
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

452 
Æmsghdr
 *
Æh
;

454 
Æh
 = 
	`Æmsg_hdr
(
msg
);

455 ià(
Æh
->
Æmsg_pid
 =ğ
NL_AUTO_PORT
)

456 
Æh
->
Æmsg_pid
 = 
	`Æ_sock‘_g‘_loÿl_pÜt
(
sk
);

458 ià(
Æh
->
Æmsg_£q
 =ğ
NL_AUTO_SEQ
)

459 
Æh
->
Æmsg_£q
 = 
sk
->
s_£q_Ãxt
++;

461 ià(
msg
->
nm_´ÙocŞ
 == -1)

462 
msg
->
nm_´ÙocŞ
 = 
sk
->
s_´Ùo
;

464 
Æh
->
Æmsg_æags
 |ğ
NLM_F_REQUEST
;

466 ià(!(
sk
->
s_æags
 & 
NL_NO_AUTO_ACK
))

467 
Æh
->
Æmsg_æags
 |ğ
NLM_F_ACK
;

468 
	}
}

485 
	$Æ_£nd_auto
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

487 
	`Æ_com¶‘e_msg
(
sk
, 
msg
);

489  
	`Æ_£nd
(
sk
, 
msg
);

490 
	}
}

517 
	$Æ_£nd_sync
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

519 
”r
;

521 
”r
 = 
	`Æ_£nd_auto
(
sk
, 
msg
);

522 
	`Æmsg_ä“
(
msg
);

523 ià(
”r
 < 0)

524  
”r
;

526  
	`wa™_fÜ_ack
(
sk
);

527 
	}
}

549 
	$Æ_£nd_sim¶e
(
Æ_sock
 *
sk
, 
ty³
, 
æags
, *
buf
,

550 
size_t
 
size
)

552 
”r
;

553 
Æ_msg
 *
msg
;

555 
msg
 = 
	`Æmsg_®loc_sim¶e
(
ty³
, 
æags
);

556 ià(!
msg
)

557  -
NLE_NOMEM
;

559 ià(
buf
 && 
size
) {

560 
”r
 = 
	`Æmsg_­³nd
(
msg
, 
buf
, 
size
, 
NLMSG_ALIGNTO
);

561 ià(
”r
 < 0)

562 
”rout
;

565 
”r
 = 
	`Æ_£nd_auto
(
sk
, 
msg
);

566 
”rout
:

567 
	`Æmsg_ä“
(
msg
);

569  
”r
;

570 
	}
}

625 
	$Æ_»cv
(
Æ_sock
 *
sk
, 
sockaddr_Æ
 *
Æa
,

626 **
buf
, 
uüed
 **
üeds
)

628 
ssize_t
 
n
;

629 
æags
 = 0;

630 
·ge_size
 = 0;

631 
iovec
 
iov
;

632 
msghdr
 
msg
 = {

633 .
msg_Çme
 = (*è
Æa
,

634 .
msg_Çm–’
 = (
sockaddr_Æ
),

635 .
msg_iov
 = &
iov
,

636 .
msg_iovËn
 = 1,

638 
uüed
* 
tmpüeds
 = 
NULL
;

639 
»tv®
 = 0;

641 ià(!
buf
 || !
Æa
)

642  -
NLE_INVAL
;

644 ià(
sk
->
s_æags
 & 
NL_MSG_PEEK
)

645 
æags
 |ğ
MSG_PEEK
 | 
MSG_TRUNC
;

647 ià(
·ge_size
 == 0)

648 
·ge_size
 = 
	`g‘·gesize
() * 4;

650 
iov
.
iov_Ën
 = 
sk
->
s_bufsize
 ? : 
·ge_size
;

651 
iov
.
iov_ba£
 = 
	`m®loc
(iov.
iov_Ën
);

653 ià(!
iov
.
iov_ba£
) {

654 
»tv®
 = -
NLE_NOMEM
;

655 
abÜt
;

658 ià(
üeds
 && (
sk
->
s_æags
 & 
NL_SOCK_PASSCRED
)) {

659 
msg
.
msg_cÚŒŞËn
 = 
	`CMSG_SPACE
((
uüed
));

660 
msg
.
msg_cÚŒŞ
 = 
	`m®loc
(msg.
msg_cÚŒŞËn
);

661 ià(!
msg
.
msg_cÚŒŞ
) {

662 
»tv®
 = -
NLE_NOMEM
;

663 
abÜt
;

666 
»Œy
:

668 
n
 = 
	`»cvmsg
(
sk
->
s_fd
, &
msg
, 
æags
);

669 ià(!
n
) {

670 
»tv®
 = 0;

671 
abÜt
;

673 ià(
n
 < 0) {

674 ià(
”ºo
 =ğ
EINTR
) {

675 
	`NL_DBG
(3, "recvmsg()„eturned EINTR,„etrying\n");

676 
»Œy
;

678 
»tv®
 = -
	`Æ_sy£¼2Æ”r
(
”ºo
);

679 
abÜt
;

682 ià(
msg
.
msg_æags
 & 
MSG_CTRUNC
) {

683 *
tmp
;

684 
msg
.
msg_cÚŒŞËn
 *= 2;

685 
tmp
 = 
	`»®loc
(
msg
.
msg_cÚŒŞ
, msg.
msg_cÚŒŞËn
);

686 ià(!
tmp
) {

687 
»tv®
 = -
NLE_NOMEM
;

688 
abÜt
;

690 
msg
.
msg_cÚŒŞ
 = 
tmp
;

691 
»Œy
;

694 ià(
iov
.
iov_Ën
 < 
n
 || (
msg
.
msg_æags
 & 
MSG_TRUNC
)) {

695 *
tmp
;

699 
iov
.
iov_Ën
 = 
n
;

700 
tmp
 = 
	`»®loc
(
iov
.
iov_ba£
, iov.
iov_Ën
);

701 ià(!
tmp
) {

702 
»tv®
 = -
NLE_NOMEM
;

703 
abÜt
;

705 
iov
.
iov_ba£
 = 
tmp
;

706 
æags
 = 0;

707 
»Œy
;

710 ià(
æags
 != 0) {

712 
æags
 = 0;

713 
»Œy
;

716 ià(
msg
.
msg_Çm–’
 !ğ(
sockaddr_Æ
)) {

717 
»tv®
 = -
NLE_NOADDR
;

718 
abÜt
;

721 ià(
üeds
 && (
sk
->
s_æags
 & 
NL_SOCK_PASSCRED
)) {

722 
cmsghdr
 *
cmsg
;

724 
cmsg
 = 
	`CMSG_FIRSTHDR
(&
msg
); cmsg; cmsg = 
	`CMSG_NXTHDR
(&msg, cmsg)) {

725 ià(
cmsg
->
cmsg_Ëv–
 !ğ
SOL_SOCKET
)

727 ià(
cmsg
->
cmsg_ty³
 !ğ
SCM_CREDENTIALS
)

729 
tmpüeds
 = 
	`m®loc
((*tmpcreds));

730 ià(!
tmpüeds
) {

731 
»tv®
 = -
NLE_NOMEM
;

732 
abÜt
;

734 
	`memıy
(
tmpüeds
, 
	`CMSG_DATA
(
cmsg
), (*tmpcreds));

739 
»tv®
 = 
n
;

740 
abÜt
:

741 
	`ä“
(
msg
.
msg_cÚŒŞ
);

743 ià(
»tv®
 <= 0) {

744 
	`ä“
(
iov
.
iov_ba£
);

745 
iov
.
iov_ba£
 = 
NULL
;

746 
	`ä“
(
tmpüeds
);

747 
tmpüeds
 = 
NULL
;

749 *
buf
 = 
iov
.
iov_ba£
;

751 ià(
üeds
)

752 *
üeds
 = 
tmpüeds
;

754  
»tv®
;

755 
	}
}

758 
	#NL_CB_CALL
(
cb
, 
ty³
, 
msg
) \

760 
”r
 = 
	`Æ_cb_ÿÎ
(
cb
, 
ty³
, 
msg
); \

761 
”r
) { \

762 
NL_OK
: \

763 
”r
 = 0; \

765 
NL_SKIP
: \

766 
sk
; \

767 
NL_STOP
: \

768 
¡İ
; \

770 
out
; \

772 } 0)

	)

775 
	$»cvmsgs
(
Æ_sock
 *
sk
, 
Æ_cb
 *
cb
)

777 
n
, 
”r
 = 0, 
muÉ¬t
 = 0, 
š‹¼u±ed
 = 0, 
Äecv
 = 0;

778 *
buf
 = 
NULL
;

779 
Æmsghdr
 *
hdr
;

786 
sockaddr_Æ
 
Æa
 = {0};

787 
Æ_msg
 *
msg
 = 
NULL
;

788 
uüed
 *
üeds
 = 
NULL
;

790 
cÚtšue_»adšg
:

791 
	`NL_DBG
(3, "A‰em±šgØ»ad from %p\n", 
sk
);

792 ià(
cb
->
cb_»cv_ow
)

793 
n
 = 
cb
->
	`cb_»cv_ow
(
sk
, &
Æa
, &
buf
, &
üeds
);

795 
n
 = 
	`Æ_»cv
(
sk
, &
Æa
, &
buf
, &
üeds
);

797 ià(
n
 <= 0)

798  
n
;

800 
	`NL_DBG
(3, "»cvmsgs(%p): R—d %d by‹s\n", 
sk
, 
n
);

802 
hdr
 = (
Æmsghdr
 *è
buf
;

803 
	`Æmsg_ok
(
hdr
, 
n
)) {

804 
	`NL_DBG
(3, "»cvmsgs(%p): Proûssšg v®id mes§ge...\n", 
sk
);

806 
	`Æmsg_ä“
(
msg
);

807 
msg
 = 
	`Æmsg_cÚv”t
(
hdr
);

808 ià(!
msg
) {

809 
”r
 = -
NLE_NOMEM
;

810 
out
;

813 
	`Æmsg_£t_´Ùo
(
msg
, 
sk
->
s_´Ùo
);

814 
	`Æmsg_£t_¤c
(
msg
, &
Æa
);

815 ià(
üeds
)

816 
	`Æmsg_£t_üeds
(
msg
, 
üeds
);

818 
Äecv
++;

822 ià(
cb
->
cb_£t
[
NL_CB_MSG_IN
])

823 
	`NL_CB_CALL
(
cb
, 
NL_CB_MSG_IN
, 
msg
);

828 ià(
cb
->
cb_£t
[
NL_CB_SEQ_CHECK
]) {

829 
	`NL_CB_CALL
(
cb
, 
NL_CB_SEQ_CHECK
, 
msg
);

832 } ià(!(
sk
->
s_æags
 & 
NL_NO_AUTO_ACK
)) {

833 ià(
hdr
->
Æmsg_£q
 !ğ
sk
->
s_£q_ex³ù
) {

834 ià(
cb
->
cb_£t
[
NL_CB_INVALID
])

835 
	`NL_CB_CALL
(
cb
, 
NL_CB_INVALID
, 
msg
);

837 
”r
 = -
NLE_SEQ_MISMATCH
;

838 
out
;

843 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_DONE
 ||

844 
hdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
 ||

845 
hdr
->
Æmsg_ty³
 =ğ
NLMSG_NOOP
 ||

846 
hdr
->
Æmsg_ty³
 =ğ
NLMSG_OVERRUN
) {

849 
sk
->
s_£q_ex³ù
++;

850 
	`NL_DBG
(3, "recvmsgs(%p): Increasedƒxpected " \

852 
sk
, sk->
s_£q_ex³ù
);

855 ià(
hdr
->
Æmsg_æags
 & 
NLM_F_MULTI
)

856 
muÉ¬t
 = 1;

858 ià(
hdr
->
Æmsg_æags
 & 
NLM_F_DUMP_INTR
) {

859 ià(
cb
->
cb_£t
[
NL_CB_DUMP_INTR
])

860 
	`NL_CB_CALL
(
cb
, 
NL_CB_DUMP_INTR
, 
msg
);

867 
š‹¼u±ed
 = 1;

872 ià(
hdr
->
Æmsg_æags
 & 
NLM_F_ACK
) {

873 ià(
cb
->
cb_£t
[
NL_CB_SEND_ACK
])

874 
	`NL_CB_CALL
(
cb
, 
NL_CB_SEND_ACK
, 
msg
);

884 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_DONE
) {

885 
muÉ¬t
 = 0;

886 ià(
cb
->
cb_£t
[
NL_CB_FINISH
])

887 
	`NL_CB_CALL
(
cb
, 
NL_CB_FINISH
, 
msg
);

894 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_NOOP
) {

895 ià(
cb
->
cb_£t
[
NL_CB_SKIPPED
])

896 
	`NL_CB_CALL
(
cb
, 
NL_CB_SKIPPED
, 
msg
);

898 
sk
;

904 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_OVERRUN
) {

905 ià(
cb
->
cb_£t
[
NL_CB_OVERRUN
])

906 
	`NL_CB_CALL
(
cb
, 
NL_CB_OVERRUN
, 
msg
);

908 
”r
 = -
NLE_MSG_OVERFLOW
;

909 
out
;

914 ià(
hdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

915 
Æmsg”r
 *
e
 = 
	`Æmsg_d©a
(
hdr
);

917 ià(
hdr
->
Æmsg_Ën
 < 
	`Æmsg_size
((*
e
))) {

922 ià(
cb
->
cb_£t
[
NL_CB_INVALID
])

923 
	`NL_CB_CALL
(
cb
, 
NL_CB_INVALID
, 
msg
);

925 
”r
 = -
NLE_MSG_TRUNC
;

926 
out
;

928 } ià(
e
->
”rÜ
) {

930 ià(
cb
->
cb_”r
) {

931 
”r
 = 
cb
->
	`cb_”r
(&
Æa
, 
e
,

932 
cb
->
cb_”r_¬g
);

933 ià(
”r
 < 0)

934 
out
;

935 ià(
”r
 =ğ
NL_SKIP
)

936 
sk
;

937 ià(
”r
 =ğ
NL_STOP
) {

938 
”r
 = -
	`Æ_sy£¼2Æ”r
(
e
->
”rÜ
);

939 
out
;

942 
”r
 = -
	`Æ_sy£¼2Æ”r
(
e
->
”rÜ
);

943 
out
;

945 } ià(
cb
->
cb_£t
[
NL_CB_ACK
])

946 
	`NL_CB_CALL
(
cb
, 
NL_CB_ACK
, 
msg
);

951 ià(
cb
->
cb_£t
[
NL_CB_VALID
])

952 
	`NL_CB_CALL
(
cb
, 
NL_CB_VALID
, 
msg
);

954 
sk
:

955 
”r
 = 0;

956 
hdr
 = 
	`Æmsg_Ãxt
(hdr, &
n
);

959 
	`Æmsg_ä“
(
msg
);

960 
	`ä“
(
buf
);

961 
	`ä“
(
üeds
);

962 
buf
 = 
NULL
;

963 
msg
 = 
NULL
;

964 
üeds
 = 
NULL
;

966 ià(
muÉ¬t
) {

968 
cÚtšue_»adšg
;

970 
¡İ
:

971 
”r
 = 0;

972 
out
:

973 
	`Æmsg_ä“
(
msg
);

974 
	`ä“
(
buf
);

975 
	`ä“
(
üeds
);

977 ià(
š‹¼u±ed
)

978 
”r
 = -
NLE_DUMP_INTR
;

980 ià(!
”r
)

981 
”r
 = 
Äecv
;

983  
”r
;

984 
	}
}

998 
	$Æ_»cvmsgs_»pÜt
(
Æ_sock
 *
sk
, 
Æ_cb
 *
cb
)

1000 ià(
cb
->
cb_»cvmsgs_ow
)

1001  
cb
->
	`cb_»cvmsgs_ow
(
sk
, cb);

1003  
	`»cvmsgs
(
sk
, 
cb
);

1004 
	}
}

1023 
	$Æ_»cvmsgs
(
Æ_sock
 *
sk
, 
Æ_cb
 *
cb
)

1025 
”r
;

1027 ià((
”r
 = 
	`Æ_»cvmsgs_»pÜt
(
sk
, 
cb
)) > 0)

1028 
”r
 = 0;

1030  
”r
;

1031 
	}
}

1039 
	$Æ_»cvmsgs_deçuÉ
(
Æ_sock
 *
sk
)

1041  
	`Æ_»cvmsgs
(
sk
, sk->
s_cb
);

1043 
	}
}

1045 
	$ack_wa™_hªdËr
(
Æ_msg
 *
msg
, *
¬g
)

1047  
NL_STOP
;

1048 
	}
}

1058 
	$Æ_wa™_fÜ_ack
(
Æ_sock
 *
sk
)

1060 
”r
;

1061 
Æ_cb
 *
cb
;

1063 
cb
 = 
	`Æ_cb_şÚe
(
sk
->
s_cb
);

1064 ià(
cb
 =ğ
NULL
)

1065  -
NLE_NOMEM
;

1067 
	`Æ_cb_£t
(
cb
, 
NL_CB_ACK
, 
NL_CB_CUSTOM
, 
ack_wa™_hªdËr
, 
NULL
);

1068 
”r
 = 
	`Æ_»cvmsgs
(
sk
, 
cb
);

1069 
	`Æ_cb_put
(
cb
);

1071  
”r
;

1072 
	}
}

1075 
	spickup_·¿m


1077 (*
	m·r£r
)(
	mÆ_ÿche_İs
 *, 
	msockaddr_Æ
 *,

1078 
	mÆmsghdr
 *, 
	mÆ_·r£r_·¿m
 *);

1079 
Æ_objeù
 *
	m»suÉ
;

1082 
	$__¡Üe_ªsw”
(
Æ_objeù
 *
obj
, 
Æ_·r£r_·¿m
 *
p
)

1084 
pickup_·¿m
 *
µ
 = 
p
->
µ_¬g
;

1089 
	`Æ_objeù_g‘
(
obj
);

1090 
µ
->
»suÉ
 = 
obj
;

1093 
	}
}

1095 
	$__pickup_ªsw”
(
Æ_msg
 *
msg
, *
¬g
)

1097 
pickup_·¿m
 *
µ
 = 
¬g
;

1098 
Æ_·r£r_·¿m
 
·r£_¬g
 = {

1099 .
µ_cb
 = 
__¡Üe_ªsw”
,

1100 .
µ_¬g
 = 
µ
,

1103  
µ
->
	`·r£r
(
NULL
, &
msg
->
nm_¤c
, msg->
nm_Æh
, &
·r£_¬g
);

1104 
	}
}

1116 
Æ_pickup
(
Æ_sock
 *
sk
,

1117 (*
·r£r
)(
Æ_ÿche_İs
 *, 
sockaddr_Æ
 *,

1118 
Æmsghdr
 *, 
Æ_·r£r_·¿m
 *),

1119 
Æ_objeù
 **
»suÉ
)

1121 
Æ_cb
 *
cb
;

1122 
”r
;

1123 
pickup_·¿m
 
µ
 = {

1124 .
·r£r
 =…arser,

1127 
cb
 = 
	`Æ_cb_şÚe
(
sk
->
s_cb
);

1128 ià(
cb
 =ğ
NULL
)

1129  -
NLE_NOMEM
;

1131 
	`Æ_cb_£t
(
cb
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
__pickup_ªsw”
, &
µ
);

1133 
”r
 = 
	`Æ_»cvmsgs
(
sk
, 
cb
);

1134 ià(
”r
 < 0)

1135 
”rout
;

1137 *
»suÉ
 = 
µ
.result;

1138 
”rout
:

1139 
	`Æ_cb_put
(
cb
);

1141  
”r
;

1142 
	}
}

1154 
	$Æ_auto_com¶‘e
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

1156 
	`Æ_com¶‘e_msg
(
sk
, 
msg
);

1157 
	}
}

1162 
	$Æ_£nd_auto_com¶‘e
(
Æ_sock
 *
sk
, 
Æ_msg
 *
msg
)

1164  
	`Æ_£nd_auto
(
sk
, 
msg
);

1165 
	}
}

	@mylibnl/libnl-3.2.25/lib/object.c

30 
	~<Ãšk-´iv©e/Ãšk.h
>

31 
	~<Ãšk/Ãšk.h
>

32 
	~<Ãšk/ÿche.h
>

33 
	~<Ãšk/objeù.h
>

34 
	~<Ãšk/uts.h
>

36 
šlše
 
Æ_objeù_İs
 *
	$obj_İs
(
Æ_objeù
 *
obj
)

38 ià(!
obj
->
û_İs
)

39 
	`BUG
();

41  
obj
->
û_İs
;

42 
	}
}

54 
Æ_objeù
 *
	$Æ_objeù_®loc
(
Æ_objeù_İs
 *
İs
)

56 
Æ_objeù
 *
Ãw
;

58 ià(
İs
->
oo_size
 < (*
Ãw
))

59 
	`BUG
();

61 
Ãw
 = 
	`ÿÎoc
(1, 
İs
->
oo_size
);

62 ià(!
Ãw
)

63  
NULL
;

65 
Ãw
->
û_»fút
 = 1;

66 
	`Æ_š™_li¡_h—d
(&
Ãw
->
û_li¡
);

68 
Ãw
->
û_İs
 = 
İs
;

69 ià(
İs
->
oo_cÚ¡ruùÜ
)

70 
İs
->
	`oo_cÚ¡ruùÜ
(
Ãw
);

72 
	`NL_DBG
(4, "AÎoÿ‹d‚ew objeù %p\n", 
Ãw
);

74  
Ãw
;

75 
	}
}

84 
	$Æ_objeù_®loc_Çme
(cÚ¡ *
kšd
, 
Æ_objeù
 **
»suÉ
)

86 
Æ_ÿche_İs
 *
İs
;

88 
İs
 = 
	`Æ_ÿche_İs_lookup_§ã
(
kšd
);

89 ià(!
İs
)

90  -
NLE_OPNOTSUPP
;

92 *
»suÉ
 = 
	`Æ_objeù_®loc
(
İs
->
co_obj_İs
);

93 
	`Æ_ÿche_İs_put
(
İs
);

94 ià(!*
»suÉ
)

95  -
NLE_NOMEM
;

98 
	}
}

100 
	sÆ_d”ived_objeù
 {

101 
NLHDR_COMMON


102 
	md©a
;

110 
Æ_objeù
 *
	$Æ_objeù_şÚe
(
Æ_objeù
 *
obj
)

112 
Æ_objeù
 *
Ãw
;

113 
Æ_objeù_İs
 *
İs
;

114 
doff
 = 
	`off£tof
(
Æ_d”ived_objeù
, 
d©a
);

115 
size
;

117 ià(!
obj
)

118  
NULL
;

120 
İs
 = 
	`obj_İs
(
obj
);

121 
Ãw
 = 
	`Æ_objeù_®loc
(
İs
);

122 ià(!
Ãw
)

123  
NULL
;

125 
size
 = 
İs
->
oo_size
 - 
doff
;

126 ià(
size
 < 0)

127 
	`BUG
();

129 
Ãw
->
û_İs
 = 
obj
->ce_ops;

130 
Ãw
->
û_msgty³
 = 
obj
->ce_msgtype;

131 
Ãw
->
û_mask
 = 
obj
->ce_mask;

133 ià(
size
)

134 
	`memıy
((*)
Ãw
 + 
doff
, (*)
obj
 + doff, 
size
);

136 ià(
İs
->
oo_şÚe
) {

137 ià(
İs
->
	`oo_şÚe
(
Ãw
, 
obj
) < 0) {

138 
	`Æ_objeù_ä“
(
Ãw
);

139  
NULL
;

141 } ià(
size
 && 
İs
->
oo_ä“_d©a
)

142 
	`BUG
();

144  
Ãw
;

145 
	}
}

154 
	$Æ_objeù_upd©e
(
Æ_objeù
 *
d¡
, Æ_objeù *
¤c
)

156 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
d¡
);

158 ià(
İs
->
oo_upd©e
)

159  
İs
->
	`oo_upd©e
(
d¡
, 
¤c
);

161  -
NLE_OPNOTSUPP
;

162 
	}
}

170 
	$Æ_objeù_ä“
(
Æ_objeù
 *
obj
)

172 
Æ_objeù_İs
 *
İs
;

174 ià(!
obj
)

177 
İs
 = 
	`obj_İs
(
obj
);

179 ià(
obj
->
û_»fút
 > 0)

180 
	`NL_DBG
(1, "Warning: Freeing object in use...\n");

182 ià(
obj
->
û_ÿche
)

183 
	`Æ_ÿche_»move
(
obj
);

185 ià(
İs
->
oo_ä“_d©a
)

186 
İs
->
	`oo_ä“_d©a
(
obj
);

188 
	`NL_DBG
(4, "F»ed objeù %p\n", 
obj
);

190 
	`ä“
(
obj
);

191 
	}
}

204 
	$Æ_objeù_g‘
(
Æ_objeù
 *
obj
)

206 
obj
->
û_»fút
++;

207 
	`NL_DBG
(4, "New„eferenceo object %p,otal %d\n",

208 
obj
, obj->
û_»fút
);

209 
	}
}

215 
	$Æ_objeù_put
(
Æ_objeù
 *
obj
)

217 ià(!
obj
)

220 
obj
->
û_»fút
--;

221 
	`NL_DBG
(4, "Returned object„eference %p, %d„emaining\n",

222 
obj
, obj->
û_»fút
);

224 ià(
obj
->
û_»fút
 < 0)

225 
	`BUG
();

227 ià(
obj
->
û_»fút
 <= 0)

228 
	`Æ_objeù_ä“
(
obj
);

229 
	}
}

236 
	$Æ_objeù_sh¬ed
(
Æ_objeù
 *
obj
)

238  
obj
->
û_»fút
 > 1;

239 
	}
}

252 
	$Æ_objeù_m¬k
(
Æ_objeù
 *
obj
)

254 
obj
->
û_æags
 |ğ
NL_OBJ_MARK
;

255 
	}
}

261 
	$Æ_objeù_unm¬k
(
Æ_objeù
 *
obj
)

263 
obj
->
û_æags
 &ğ~
NL_OBJ_MARK
;

264 
	}
}

271 
	$Æ_objeù_is_m¬ked
(
Æ_objeù
 *
obj
)

273  (
obj
->
û_æags
 & 
NL_OBJ_MARK
);

274 
	}
}

288 
	$Æ_objeù_dump
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
·¿ms
)

290 ià(
·¿ms
->
dp_buf
)

291 
	`mem£t
(
·¿ms
->
dp_buf
, 0,…¬ams->
dp_buæ’
);

293 
	`dump_äom_İs
(
obj
, 
·¿ms
);

294 
	}
}

296 
	$Æ_objeù_dump_buf
(
Æ_objeù
 *
obj
, *
buf
, 
size_t
 
Ën
)

298 
Æ_dump_·¿ms
 
dp
 = {

299 .
dp_buf
 = 
buf
,

300 .
dp_buæ’
 = 
Ën
,

303  
	`Æ_objeù_dump
(
obj
, &
dp
);

304 
	}
}

313 
	$Æ_objeù_id’tiÿl
(
Æ_objeù
 *
a
, Æ_objeù *
b
)

315 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
a
);

316 
ušt32_t
 
»q_©Œs
;

319 ià(
İs
 !ğ
	`obj_İs
(
b
))

322 ià(
İs
->
oo_id_©Œs_g‘
) {

323 
»q_©Œs_a
 = 
İs
->
	`oo_id_©Œs_g‘
(
a
);

324 
»q_©Œs_b
 = 
İs
->
	`oo_id_©Œs_g‘
(
b
);

325 ià(
»q_©Œs_a
 !ğ
»q_©Œs_b
)

327 
»q_©Œs
 = 
»q_©Œs_a
;

328 } ià(
İs
->
oo_id_©Œs
) {

329 
»q_©Œs
 = 
İs
->
oo_id_©Œs
;

331 
»q_©Œs
 = 0xFFFFFFFF;

333 ià(
»q_©Œs
 == 0xFFFFFFFF)

334 
»q_©Œs
 = 
a
->
û_mask
 & 
b
->ce_mask;

338 ià((
a
->
û_mask
 & 
»q_©Œs
) !=„eq_attrs ||

339 (
b
->
û_mask
 & 
»q_©Œs
) !=„eq_attrs)

343 ià(
İs
->
oo_com·»
 =ğ
NULL
)

346  !(
İs
->
	`oo_com·»
(
a
, 
b
, 
»q_©Œs
, 0));

347 
	}
}

361 
ušt32_t
 
	$Æ_objeù_diff
(
Æ_objeù
 *
a
, Æ_objeù *
b
)

363 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
a
);

365 ià(
İs
 !ğ
	`obj_İs
(
b
è|| ops->
oo_com·»
 =ğ
NULL
)

366  
UINT_MAX
;

368  
İs
->
	`oo_com·»
(
a
, 
b
, ~0, 0);

369 
	}
}

380 
	$Æ_objeù_m©ch_f‹r
(
Æ_objeù
 *
obj
, Æ_objeù *
f‹r
)

382 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
obj
);

384 ià(
İs
 !ğ
	`obj_İs
(
f‹r
è|| ops->
oo_com·»
 =ğ
NULL
)

387  !(
İs
->
	`oo_com·»
(
obj
, 
f‹r
, f‹r->
û_mask
,

388 
LOOSE_COMPARISON
));

389 
	}
}

403 *
	$Æ_objeù_©Œs2¡r
(
Æ_objeù
 *
obj
, 
ušt32_t
 
©Œs
,

404 *
buf
, 
size_t
 
Ën
)

406 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
obj
);

408 ià(
İs
->
oo_©Œs2¡r
 !ğ
NULL
)

409  
İs
->
	`oo_©Œs2¡r
(
©Œs
, 
buf
, 
Ën
);

411 
	`mem£t
(
buf
, 0, 
Ën
);

412  
buf
;

414 
	}
}

424 *
	$Æ_objeù_©Œ_li¡
(
Æ_objeù
 *
obj
, *
buf
, 
size_t
 
Ën
)

426  
	`Æ_objeù_©Œs2¡r
(
obj
, obj->
û_mask
, 
buf
, 
Ën
);

427 
	}
}

437 
	$Æ_objeù_keyg’
(
Æ_objeù
 *
obj
, 
ušt32_t
 *
hashkey
,

438 
ušt32_t
 
hashtbl_sz
)

440 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
obj
);

442 ià(
İs
->
oo_keyg’
)

443 
İs
->
	`oo_keyg’
(
obj
, 
hashkey
, 
hashtbl_sz
);

445 *
hashkey
 = 0;

448 
	}
}

463 
	$Æ_objeù_g‘_»fút
(
Æ_objeù
 *
obj
)

465  
obj
->
û_»fút
;

466 
	}
}

477 
Æ_ÿche
 *
	$Æ_objeù_g‘_ÿche
(
Æ_objeù
 *
obj
)

479  
obj
->
û_ÿche
;

480 
	}
}

490 cÚ¡ *
	$Æ_objeù_g‘_ty³
(cÚ¡ 
Æ_objeù
 *
obj
)

492 ià(!
obj
->
û_İs
)

493 
	`BUG
();

495  
obj
->
û_İs
->
oo_Çme
;

496 
	}
}

504 
	$Æ_objeù_g‘_msgty³
(cÚ¡ 
Æ_objeù
 *
obj
)

506  
obj
->
û_msgty³
;

507 
	}
}

515 
Æ_objeù_İs
 *
	$Æ_objeù_g‘_İs
(cÚ¡ 
Æ_objeù
 *
obj
)

517  
obj
->
û_İs
;

518 
	}
}

526 
ušt32_t
 
	$Æ_objeù_g‘_id_©Œs
(
Æ_objeù
 *
obj
)

528 
Æ_objeù_İs
 *
İs
 = 
	`obj_İs
(
obj
);

529 
ušt32_t
 
id_©Œs
;

531 ià(!
İs
)

534 ià(
İs
->
oo_id_©Œs_g‘
)

535 
id_©Œs
 = 
İs
->
	`oo_id_©Œs_g‘
(
obj
);

537 
id_©Œs
 = 
İs
->
oo_id_©Œs
;

539  
id_©Œs
;

540 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/act.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

23 
	~<Ãšk/rou‹/lšk.h
>

26 
Æ_objeù_İs
 
	gaù_obj_İs
;

27 
Æ_ÿche_İs
 
	g¹Æ_aù_İs
;

29 
	$¹Æ_aù_­³nd
(
¹Æ_aù
 **
h—d
, ¹Æ_aù *
Ãw
)

31 
¹Æ_aù
 *
p_aù
;

32 
couÁ
 = 1;

34 ià(*
h—d
 =ğ
NULL
) {

35 *
h—d
 = 
Ãw
;

39 
p_aù
 = *
h—d
;

40 
p_aù
->
a_Ãxt
) {

41 ++
couÁ
;

42 
p_aù
 =…_aù->
a_Ãxt
;

45 ià(
couÁ
 > 
TCA_ACT_MAX_PRIO
)

46  -
NLE_RANGE
;

48 
p_aù
->
a_Ãxt
 = 
Ãw
;

50 
	}
}

52 
	$¹Æ_aù_»move
(
¹Æ_aù
 **
h—d
, ¹Æ_aù *
aù
)

54 
¹Æ_aù
 *
a
, **
­
;

56 
­
 = 
h—d
; (
a
 = *­è!ğ
NULL
;‡°ğ&a->
a_Ãxt
)

57 ià(
a
 =ğ
aù
)

59 ià(
a
) {

60 *
­
 = 
a
->
a_Ãxt
;

61 
a
->
a_Ãxt
 = 
NULL
;

65  -
NLE_OBJ_NOTFOUND
;

66 
	}
}

68 
	$¹Æ_aù_fl_Úe
(
Æ_msg
 *
msg
, 
¹Æ_aù
 *
aù
, 
Üd”
)

70 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(
aù
);

71 
¹Æ_tc_İs
 *
İs
;

72 
Æ©Œ
 *
Ã¡
;

73 
”r
 = -
NLE_NOMEM
;

75 
Ã¡
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
Üd”
);

76 ià(!
Ã¡
)

77 
Æa_put_çu»
;

79 ià(
tc
->
û_mask
 & 
TCA_ATTR_KIND
)

80 
	`NLA_PUT_STRING
(
msg
, 
TCA_ACT_KIND
, 
tc
->
tc_kšd
);

82 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

83 ià(
İs
 && (İs->
to_msg_fl
 || ops->
to_msg_fl_¿w
)) {

84 
Æ©Œ
 *
İts
;

85 *
d©a
 = 
	`¹Æ_tc_d©a
(
tc
);

87 ià(
İs
->
to_msg_fl
) {

88 ià(!(
İts
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
TCA_ACT_OPTIONS
)))

89 
Æa_put_çu»
;

91 ià((
”r
 = 
İs
->
	`to_msg_fl
(
tc
, 
d©a
, 
msg
)) < 0)

92 
Æa_put_çu»
;

94 
	`Æa_Ã¡_’d
(
msg
, 
İts
);

95 } ià((
”r
 = 
İs
->
	`to_msg_fl_¿w
(
tc
, 
d©a
, 
msg
)) < 0)

96 
Æa_put_çu»
;

98 
	`Æa_Ã¡_’d
(
msg
, 
Ã¡
);

101 
Æa_put_çu»
:

102  
”r
;

103 
	}
}

105 
	$¹Æ_aù_fl
(
Æ_msg
 *
msg
, 
©Œty³
, 
¹Æ_aù
 *
aù
)

107 
¹Æ_aù
 *
p_aù
 = 
aù
;

108 
Æ©Œ
 *
Ã¡
;

109 
”r
, 
Üd”
 = 0;

111 
Ã¡
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
©Œty³
);

112 ià(!
Ã¡
)

113  -
NLE_MSGSIZE
;

115 
p_aù
) {

116 
”r
 = 
	`¹Æ_aù_fl_Úe
(
msg
, 
p_aù
, ++
Üd”
);

117 ià(
”r
)

118  
”r
;

119 
p_aù
 =…_aù->
a_Ãxt
;

122 
	`Æa_Ã¡_’d
(
msg
, 
Ã¡
);

124 
	}
}

126 
	$¹Æ_aù_msg_bud
(
¹Æ_aù
 *
aù
, 
ty³
, 
æags
,

127 
Æ_msg
 **
»suÉ
)

129 
Æ_msg
 *
msg
;

130 
tÿmsg
 
tÿhdr
 = {

131 .
tÿ_çmy
 = 
AF_UNSPEC
,

133 
”r
 = -
NLE_MSGSIZE
;

135 
msg
 = 
	`Æmsg_®loc_sim¶e
(
ty³
, 
æags
);

136 ià(!
msg
)

137  -
NLE_NOMEM
;

139 ià(
	`Æmsg_­³nd
(
msg
, &
tÿhdr
, Ñÿhdr), 
NLMSG_ALIGNTO
) < 0)

140 
Æa_put_çu»
;

142 
”r
 = 
	`¹Æ_aù_fl
(
msg
, 
TCA_ACT_TAB
, 
aù
);

143 ià(
”r
 < 0)

144 
Æa_put_çu»
;

146 *
»suÉ
 = 
msg
;

149 
Æa_put_çu»
:

150 
	`Æmsg_ä“
(
msg
);

151  
”r
;

152 
	}
}

154 
	$aù_bud
(
¹Æ_aù
 *
aù
, 
ty³
, 
æags
,

155 
Æ_msg
 **
»suÉ
)

157 
”r
;

159 
”r
 = 
	`¹Æ_aù_msg_bud
(
aù
, 
ty³
, 
æags
, 
»suÉ
);

160 ià(
”r
 < 0)

161  
”r
;

163 
	}
}

170 
¹Æ_aù
 *
	$¹Æ_aù_®loc
()

172 
¹Æ_tc
 *
tc
;

174 
tc
 = 
	`TC_CAST
(
	`Æ_objeù_®loc
(&
aù_obj_İs
));

175 ià(
tc
)

176 
tc
->
tc_ty³
 = 
RTNL_TC_TYPE_ACT
;

178  (
¹Æ_aù
 *è
tc
;

179 
	}
}

181 
	$¹Æ_aù_g‘
(
¹Æ_aù
 *
aù
)

183 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
aù
));

184 
	}
}

186 
	$¹Æ_aù_put
(
¹Æ_aù
 *
aù
)

188 
	`Æ_objeù_put
((
Æ_objeù
 *è
aù
);

189 
	}
}

212 
	$¹Æ_aù_bud_add_»que¡
(
¹Æ_aù
 *
aù
, 
æags
,

213 
Æ_msg
 **
»suÉ
)

215  
	`aù_bud
(
aù
, 
RTM_NEWACTION
, 
æags
, 
»suÉ
);

216 
	}
}

251 
	$¹Æ_aù_add
(
Æ_sock
 *
sk
, 
¹Æ_aù
 *
aù
, 
æags
)

253 
Æ_msg
 *
msg
;

254 
”r
;

256 ià((
”r
 = 
	`¹Æ_aù_bud_add_»que¡
(
aù
, 
æags
, &
msg
)) < 0)

257  
”r
;

259  
	`Æ_£nd_sync
(
sk
, 
msg
);

260 
	}
}

275 
	$¹Æ_aù_bud_chªge_»que¡
(
¹Æ_aù
 *
aù
, 
æags
,

276 
Æ_msg
 **
»suÉ
)

278  
	`aù_bud
(
aù
, 
RTM_NEWACTION
, 
NLM_F_REPLACE
 | 
æags
, 
»suÉ
);

279 
	}
}

293 
	$¹Æ_aù_chªge
(
Æ_sock
 *
sk
, 
¹Æ_aù
 *
aù
, 
æags
)

295 
Æ_msg
 *
msg
;

296 
”r
;

298 ià((
”r
 = 
	`¹Æ_aù_bud_chªge_»que¡
(
aù
, 
æags
, &
msg
)) < 0)

299  
”r
;

301  
	`Æ_£nd_sync
(
sk
, 
msg
);

302 
	}
}

318 
	$¹Æ_aù_bud_d–‘e_»que¡
(
¹Æ_aù
 *
aù
, 
æags
,

319 
Æ_msg
 **
»suÉ
)

321  
	`aù_bud
(
aù
, 
RTM_DELACTION
, 
æags
, 
»suÉ
);

322 
	}
}

355 
	$¹Æ_aù_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_aù
 *
aù
, 
æags
)

357 
Æ_msg
 *
msg
;

358 
”r
;

360 ià((
”r
 = 
	`¹Æ_aù_bud_d–‘e_»que¡
(
aù
, 
æags
, &
msg
)) < 0)

361  
”r
;

363  
	`Æ_£nd_sync
(
sk
, 
msg
);

364 
	}
}

368 
	$aù_dump_lše
(
¹Æ_tc
 *
tc
, 
Æ_dump_·¿ms
 *
p
)

370 
	}
}

372 
	$¹Æ_aù_put_®l
(
¹Æ_aù
 **
h—d
)

374 
¹Æ_aù
 *
cu¼
, *
Ãxt
;

376 
cu¼
 = *
h—d
;

377 
cu¼
) {

378 
Ãxt
 = 
cu¼
->
a_Ãxt
;

379 
	`¹Æ_aù_put
(
cu¼
);

380 
cu¼
 = 
Ãxt
;

382 *
h—d
 = 
NULL
;

383 
	}
}

385 
	$¹Æ_aù_·r£
(
¹Æ_aù
 **
h—d
, 
Æ©Œ
 *
tb
)

387 
¹Æ_aù
 *
aù
;

388 
¹Æ_tc_İs
 *
İs
;

389 
Æ©Œ
 *
tb2
[
TCA_ACT_MAX
 + 1];

390 
Æ©Œ
 *
Æa
[
TCA_ACT_MAX_PRIO
 + 1];

391 
kšd
[
TCKINDSIZ
];

392 
”r
, 
i
;

394 
”r
 = 
	`Æa_·r£
(
Æa
, 
TCA_ACT_MAX_PRIO
, 
	`Æa_d©a
(
tb
),

395 
	`NLMSG_ALIGN
(
	`Æa_Ën
(
tb
)), 
NULL
);

396 ià(
”r
 < 0)

397  
”r
;

399 
i
 = 0; i < 
TCA_ACT_MAX_PRIO
; i++) {

400 
¹Æ_tc
 *
tc
;

402 ià(
Æa
[
i
] =ğ
NULL
)

405 
aù
 = 
	`¹Æ_aù_®loc
();

406 ià(!
aù
) {

407 
”r
 = -
NLE_NOMEM
;

408 
”r_ä“
;

410 
tc
 = 
	`TC_CAST
(
aù
);

411 
”r
 = 
	`Æa_·r£
(
tb2
, 
TCA_ACT_MAX
, 
	`Æa_d©a
(
Æa
[
i
]),

412 
	`Æa_Ën
(
Æa
[
i
]), 
NULL
);

413 ià(
”r
 < 0)

414 
”r_ä“
;

416 ià(
tb2
[
TCA_ACT_KIND
] =ğ
NULL
) {

417 
”r
 = -
NLE_MISSING_ATTR
;

418 
”r_ä“
;

421 
	`Æa_¡¾ıy
(
kšd
, 
tb2
[
TCA_ACT_KIND
], (kind));

422 
	`¹Æ_tc_£t_kšd
(
tc
, 
kšd
);

424 ià(
tb2
[
TCA_ACT_OPTIONS
]) {

425 
tc
->
tc_İts
 = 
	`Æ_d©a_®loc_©Œ
(
tb2
[
TCA_ACT_OPTIONS
]);

426 ià(!
tc
->
tc_İts
) {

427 
”r
 = -
NLE_NOMEM
;

428 
”r_ä“
;

430 
tc
->
û_mask
 |ğ
TCA_ATTR_OPTS
;

433 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

434 ià(
İs
 && ops->
to_msg_·r£r
) {

435 *
d©a
 = 
	`¹Æ_tc_d©a
(
tc
);

437 ià(!
d©a
) {

438 
”r
 = -
NLE_NOMEM
;

439 
”r_ä“
;

442 
”r
 = 
İs
->
	`to_msg_·r£r
(
tc
, 
d©a
);

443 ià(
”r
 < 0)

444 
”r_ä“
;

446 
”r
 = 
	`¹Æ_aù_­³nd
(
h—d
, 
aù
);

447 ià(
”r
 < 0)

448 
”r_ä“
;

452 
”r_ä“
:

453 
	`¹Æ_aù_put
 (
aù
);

454 
	`¹Æ_aù_put_®l
(
h—d
);

456  
”r
;

457 
	}
}

459 
	$¹Æ_aù_msg_·r£
(
Æmsghdr
 *
n
, 
¹Æ_aù
 **
aù
)

461 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(*
aù
);

462 
Æ_ÿche
 *
lšk_ÿche
;

463 
Æ©Œ
 *
tb
[
TCAA_MAX
 + 1];

464 
tÿmsg
 *
tm
;

465 
”r
;

467 
tc
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

469 
”r
 = 
	`Æmsg_·r£
(
n
, (*
tm
), 
tb
, 
TCAA_MAX
, 
NULL
);

470 ià(
”r
 < 0)

471  
”r
;

473 
tm
 = 
	`Æmsg_d©a
(
n
);

474 
tc
->
tc_çmy
 = 
tm
->
tÿ_çmy
;

476 ià(
tb
[
TCA_ACT_TAB
] =ğ
NULL
)

477  -
NLE_MISSING_ATTR
;

479 
”r
 = 
	`¹Æ_aù_·r£
(
aù
, 
tb
[
TCA_ACT_TAB
]);

480 ià(
”r
 < 0)

481  
”r
;

483 ià((
lšk_ÿche
 = 
	`__Æ_ÿche_mngt_»quœe
("route/link"))) {

484 
¹Æ_lšk
 *
lšk
;

486 ià((
lšk
 = 
	`¹Æ_lšk_g‘
(
lšk_ÿche
, 
tc
->
tc_ifšdex
))) {

487 
	`¹Æ_tc_£t_lšk
(
tc
, 
lšk
);

490 
	`¹Æ_lšk_put
(
lšk
);

495 
	}
}

496 
	$aù_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

497 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

499 
¹Æ_aù
 *
aù
, *
p_aù
;

500 
”r
;

502 ià(!(
aù
 = 
	`¹Æ_aù_®loc
()))

503  -
NLE_NOMEM
;

505 ià((
”r
 = 
	`¹Æ_aù_msg_·r£
(
Æh
, &
aù
)) < 0)

506 
”rout
;

508 
p_aù
 = 
aù
;

509 
p_aù
) {

510 
”r
 = 
µ
->
	`µ_cb
(
	`OBJ_CAST
(
aù
),…p);

511 ià(
”r
)

513 
p_aù
 =…_aù->
a_Ãxt
;

515 
”rout
:

516 
	`¹Æ_aù_put
(
aù
);

518  
”r
;

519 
	}
}

521 
	$aù_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

523 
tÿmsg
 
tÿhdr
 = {

524 .
tÿ_çmy
 = 
AF_UNSPEC
,

527  
	`Æ_£nd_sim¶e
(
sk
, 
RTM_GETACTION
, 
NLM_F_DUMP
, &
tÿhdr
,

528 (
tÿhdr
));

529 
	}
}

531 
¹Æ_tc_ty³_İs
 
	gaù_İs
 = {

532 .
‰_ty³
 = 
RTNL_TC_TYPE_ACT
,

533 .
	g‰_dump_´efix
 = "act",

534 .
	g‰_dump
 = {

535 [
NL_DUMP_LINE
] = 
aù_dump_lše
,

539 
Æ_ÿche_İs
 
	g¹Æ_aù_İs
 = {

540 .
co_Çme
 = "route/act",

541 .
	gco_hdrsize
 = (
tcmsg
),

542 .
	gco_msgty³s
 = {

543 { 
RTM_NEWACTION
, 
NL_ACT_NEW
, "new" },

544 { 
RTM_DELACTION
, 
NL_ACT_DEL
, "del" },

545 { 
RTM_GETACTION
, 
NL_ACT_GET
, "get" },

546 
END_OF_MSGTYPES_LIST
,

548 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

549 .
	gco_»que¡_upd©e
 = 
aù_»que¡_upd©e
,

550 .
	gco_msg_·r£r
 = 
aù_msg_·r£r
,

551 .
	gco_obj_İs
 = &
aù_obj_İs
,

554 
Æ_objeù_İs
 
	gaù_obj_İs
 = {

555 .
oo_Çme
 = "route/act",

556 .
	goo_size
 = (
¹Æ_aù
),

557 .
	goo_ä“_d©a
 = 
¹Æ_tc_ä“_d©a
,

558 .
	goo_şÚe
 = 
¹Æ_tc_şÚe
,

559 .
	goo_dump
 = {

560 [
NL_DUMP_LINE
] = 
¹Æ_tc_dump_lše
,

561 [
NL_DUMP_DETAILS
] = 
¹Æ_tc_dump_d‘as
,

562 [
NL_DUMP_STATS
] = 
¹Æ_tc_dump_¡©s
,

564 .
	goo_com·»
 = 
¹Æ_tc_com·»
,

565 .
	goo_id_©Œs
 = (
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
),

568 
__š™
 
	$aù_š™
()

570 
	`¹Æ_tc_ty³_»gi¡”
(&
aù_İs
);

571 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_aù_İs
);

572 
	}
}

574 
__ex™
 
	$aù_ex™
()

576 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_aù_İs
);

577 
	`¹Æ_tc_ty³_uÄegi¡”
(&
aù_İs
);

578 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/act/mirred.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/©Œ.h
>

23 
	~<Ãšk/uts.h
>

24 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

25 
	~<Ãšk/rou‹/aù/mœ»d.h
>

27 
Æa_pŞicy
 
	gmœ»d_pŞicy
[
TCA_MIRRED_MAX
 + 1] = {

28 [
TCA_MIRRED_PARMS
] = { .
mšËn
 = (
tc_mœ»d
) },

31 
	$mœ»d_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

33 
¹Æ_mœ»d
 *
u
 = 
d©a
;

34 
Æ©Œ
 *
tb
[
TCA_MIRRED_MAX
 + 1];

35 
”r
;

37 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_MIRRED_MAX
, 
tc
, 
mœ»d_pŞicy
);

38 ià(
”r
 < 0)

39  
”r
;

41 ià(!
tb
[
TCA_MIRRED_PARMS
])

42  -
NLE_MISSING_ATTR
;

44 
	`Æa_memıy
(&
u
->
m_·rm
, 
tb
[
TCA_MIRRED_PARMS
], (u->m_parm));

46 
	}
}

48 
	$mœ»d_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

50 
	}
}

52 
	$mœ»d_şÚe
(*
_d¡
, *
_¤c
)

54 
¹Æ_mœ»d
 *
d¡
 = 
_d¡
, *
¤c
 = 
_¤c
;

56 
	`memıy
(&
d¡
->
m_·rm
, &
¤c
->m_parm, (src->m_parm));

58 
	}
}

60 
	$mœ»d_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

61 
Æ_dump_·¿ms
 *
p
)

63 
¹Æ_mœ»d
 *
u
 = 
d©a
;

64 ià(!
u
)

67 
	`Æ_dump
(
p
, " index %u", 
u
->
m_·rm
.
ifšdex
);

69 ià(
u
->
m_·rm
.
—ùiÚ
 =ğ
TCA_EGRESS_MIRROR
)

70 
	`Æ_dump
(
p
, "ƒgress mirror");

71 ià(
u
->
m_·rm
.
—ùiÚ
 =ğ
TCA_EGRESS_REDIR
)

72 
	`Æ_dump
(
p
, "ƒgress„edirect");

74 
u
->
m_·rm
.
aùiÚ
) {

75 
TC_ACT_UNSPEC
:

76 
	`Æ_dump
(
p
, " unspecified");

78 
TC_ACT_PIPE
:

79 
	`Æ_dump
(
p
, "…ipe");

81 
TC_ACT_STOLEN
:

82 
	`Æ_dump
(
p
, " stolen");

84 
TC_ACT_SHOT
:

85 
	`Æ_dump
(
p
, " shot");

87 
TC_ACT_QUEUED
:

88 
	`Æ_dump
(
p
, " queued");

90 
TC_ACT_REPEAT
:

91 
	`Æ_dump
(
p
, "„epeat");

94 
	}
}

96 
	$mœ»d_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

97 
Æ_dump_·¿ms
 *
p
)

99 
	}
}

101 
	$mœ»d_dump_¡©s
(
¹Æ_tc
 *
tc
, *
d©a
,

102 
Æ_dump_·¿ms
 *
p
)

104 
¹Æ_mœ»d
 *
u
 = 
d©a
;

106 ià(!
u
)

109 
	}
}

112 
	$mœ»d_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

114 
¹Æ_mœ»d
 *
u
 = 
d©a
;

116 ià(!
u
)

119 
	`NLA_PUT
(
msg
, 
TCA_MIRRED_PARMS
, (
u
->
m_·rm
), &u->m_parm);

122 
Æa_put_çu»
:

123  -
NLE_NOMEM
;

124 
	}
}

131 
	$¹Æ_mœ»d_£t_aùiÚ
(
¹Æ_aù
 *
aù
, 
aùiÚ
)

133 
¹Æ_mœ»d
 *
u
;

135 ià(!(
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

136  -
NLE_NOMEM
;

138 ià(
aùiÚ
 > 
TCA_INGRESS_MIRROR
 ||‡ùiÚ < 
TCA_EGRESS_REDIR
)

139  -
NLE_INVAL
;

141 
aùiÚ
) {

142 
TCA_EGRESS_MIRROR
:

143 
TCA_EGRESS_REDIR
:

144 
u
->
m_·rm
.
—ùiÚ
 = 
aùiÚ
;

146 
TCA_INGRESS_REDIR
:

147 
TCA_INGRESS_MIRROR
:

149  
NLE_OPNOTSUPP
;

152 
	}
}

154 
	$¹Æ_mœ»d_g‘_aùiÚ
(
¹Æ_aù
 *
aù
)

156 
¹Æ_mœ»d
 *
u
;

158 ià(!(
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

159  -
NLE_NOMEM
;

160  
u
->
m_·rm
.
—ùiÚ
;

161 
	}
}

163 
	$¹Æ_mœ»d_£t_ifšdex
(
¹Æ_aù
 *
aù
, 
ušt32_t
 
ifšdex
)

165 
¹Æ_mœ»d
 *
u
;

167 ià(!(
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

168  -
NLE_NOMEM
;

170 
u
->
m_·rm
.
ifšdex
 = ifindex;

172 
	}
}

174 
ušt32_t
 
	$¹Æ_mœ»d_g‘_ifšdex
(
¹Æ_aù
 *
aù
)

176 
¹Æ_mœ»d
 *
u
;

178 ià((
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

179  
u
->
m_·rm
.
ifšdex
;

181 
	}
}

183 
	$¹Æ_mœ»d_£t_pŞicy
(
¹Æ_aù
 *
aù
, 
pŞicy
)

185 
¹Æ_mœ»d
 *
u
;

187 ià(!(
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

188  -
NLE_NOMEM
;

190 ià(
pŞicy
 > 
TC_ACT_REPEAT
 ||…Şicy < 
TC_ACT_OK
)

191  -
NLE_INVAL
;

193 
u
->
m_·rm
.
—ùiÚ
) {

194 
TCA_EGRESS_MIRROR
:

195 
TCA_EGRESS_REDIR
:

196 
u
->
m_·rm
.
aùiÚ
 = 
pŞicy
;

198 
TCA_INGRESS_REDIR
:

199 
TCA_INGRESS_MIRROR
:

201  
NLE_OPNOTSUPP
;

204 
	}
}

206 
	$¹Æ_mœ»d_g‘_pŞicy
(
¹Æ_aù
 *
aù
)

208 
¹Æ_mœ»d
 *
u
;

210 ià(!(
u
 = (
¹Æ_mœ»d
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
aù
))))

211  -
NLE_NOMEM
;

212  
u
->
m_·rm
.
aùiÚ
;

213 
	}
}

217 
¹Æ_tc_İs
 
	gmœ»d_İs
 = {

218 .
to_kšd
 = "mirred",

219 .
	gto_ty³
 = 
RTNL_TC_TYPE_ACT
,

220 .
	gto_size
 = (
¹Æ_mœ»d
),

221 .
	gto_msg_·r£r
 = 
mœ»d_msg_·r£r
,

222 .
	gto_ä“_d©a
 = 
mœ»d_ä“_d©a
,

223 .
	gto_şÚe
 = 
mœ»d_şÚe
,

224 .
	gto_msg_fl
 = 
mœ»d_msg_fl
,

225 .
	gto_dump
 = {

226 [
NL_DUMP_LINE
] = 
mœ»d_dump_lše
,

227 [
NL_DUMP_DETAILS
] = 
mœ»d_dump_d‘as
,

228 [
NL_DUMP_STATS
] = 
mœ»d_dump_¡©s
,

232 
__š™
 
	$mœ»d_š™
()

234 
	`¹Æ_tc_»gi¡”
(&
mœ»d_İs
);

235 
	}
}

237 
__ex™
 
	$mœ»d_ex™
()

239 
	`¹Æ_tc_uÄegi¡”
(&
mœ»d_İs
);

240 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/addr.c

109 
	~<Ãšk-´iv©e/Ãšk.h
>

110 
	~<Ãšk/Ãšk.h
>

111 
	~<Ãšk/rou‹/¹Æ.h
>

112 
	~<Ãšk/rou‹/addr.h
>

113 
	~<Ãšk/rou‹/rou‹.h
>

114 
	~<Ãšk/rou‹/lšk.h
>

115 
	~<Ãšk/uts.h
>

118 
	#ADDR_ATTR_FAMILY
 0x0001

	)

119 
	#ADDR_ATTR_PREFIXLEN
 0x0002

	)

120 
	#ADDR_ATTR_FLAGS
 0x0004

	)

121 
	#ADDR_ATTR_SCOPE
 0x0008

	)

122 
	#ADDR_ATTR_IFINDEX
 0x0010

	)

123 
	#ADDR_ATTR_LABEL
 0x0020

	)

124 
	#ADDR_ATTR_CACHEINFO
 0x0040

	)

125 
	#ADDR_ATTR_PEER
 0x0080

	)

126 
	#ADDR_ATTR_LOCAL
 0x0100

	)

127 
	#ADDR_ATTR_BROADCAST
 0x0200

	)

128 
	#ADDR_ATTR_MULTICAST
 0x0400

	)

129 
	#ADDR_ATTR_ANYCAST
 0x0800

	)

131 
Æ_ÿche_İs
 
	g¹Æ_addr_İs
;

132 
Æ_objeù_İs
 
	gaddr_obj_İs
;

135 
	$addr_cÚ¡ruùÜ
(
Æ_objeù
 *
obj
)

137 
¹Æ_addr
 *
addr
 = 
	`Æ_objeù_´iv
(
obj
);

139 
addr
->
a_scİe
 = 
RT_SCOPE_NOWHERE
;

140 
	}
}

142 
	$addr_ä“_d©a
(
Æ_objeù
 *
obj
)

144 
¹Æ_addr
 *
addr
 = 
	`Æ_objeù_´iv
(
obj
);

146 ià(!
addr
)

149 
	`Æ_addr_put
(
addr
->
a_³”
);

150 
	`Æ_addr_put
(
addr
->
a_loÿl
);

151 
	`Æ_addr_put
(
addr
->
a_bÿ¡
);

152 
	`Æ_addr_put
(
addr
->
a_muÉiÿ¡
);

153 
	`Æ_addr_put
(
addr
->
a_ªyÿ¡
);

154 
	`¹Æ_lšk_put
(
addr
->
a_lšk
);

155 
	}
}

157 
	$addr_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

159 
¹Æ_addr
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

160 
¹Æ_addr
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

162 ià(
¤c
->
a_lšk
) {

163 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
¤c
->
a_lšk
));

164 
d¡
->
a_lšk
 = 
¤c
->a_link;

167 ià(
¤c
->
a_³”
)

168 ià(!(
d¡
->
a_³”
 = 
	`Æ_addr_şÚe
(
¤c
->a_peer)))

169  -
NLE_NOMEM
;

171 ià(
¤c
->
a_loÿl
)

172 ià(!(
d¡
->
a_loÿl
 = 
	`Æ_addr_şÚe
(
¤c
->a_local)))

173  -
NLE_NOMEM
;

175 ià(
¤c
->
a_bÿ¡
)

176 ià(!(
d¡
->
a_bÿ¡
 = 
	`Æ_addr_şÚe
(
¤c
->a_bcast)))

177  -
NLE_NOMEM
;

179 ià(
¤c
->
a_muÉiÿ¡
)

180 ià(!(
d¡
->
a_muÉiÿ¡
 = 
	`Æ_addr_şÚe
(
¤c
->a_multicast)))

181  -
NLE_NOMEM
;

183 ià(
¤c
->
a_ªyÿ¡
)

184 ià(!(
d¡
->
a_ªyÿ¡
 = 
	`Æ_addr_şÚe
(
¤c
->a_anycast)))

185  -
NLE_NOMEM
;

188 
	}
}

190 
Æa_pŞicy
 
	gaddr_pŞicy
[
IFA_MAX
+1] = {

191 [
IFA_LABEL
] = { .
ty³
 = 
NLA_STRING
,

192 .
	gmaxËn
 = 
IFNAMSIZ
 },

193 [
IFA_CACHEINFO
] = { .
mšËn
 = (
iç_ÿchešfo
) },

196 
	$addr_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

197 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

199 
¹Æ_addr
 *
addr
;

200 
içddrmsg
 *
iç
;

201 
Æ©Œ
 *
tb
[
IFA_MAX
+1];

202 
”r
, 
çmy
;

203 
Æ_ÿche
 *
lšk_ÿche
;

204 
Æ_addr
 *
¶’_addr
 = 
NULL
;

206 
addr
 = 
	`¹Æ_addr_®loc
();

207 ià(!
addr
)

208  -
NLE_NOMEM
;

210 
addr
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

212 
”r
 = 
	`Æmsg_·r£
(
Æh
, (*
iç
), 
tb
, 
IFA_MAX
, 
addr_pŞicy
);

213 ià(
”r
 < 0)

214 
”rout
;

216 
iç
 = 
	`Æmsg_d©a
(
Æh
);

217 
addr
->
a_çmy
 = 
çmy
 = 
iç
->
iç_çmy
;

218 
addr
->
a_´efixËn
 = 
iç
->
iç_´efixËn
;

219 
addr
->
a_scİe
 = 
iç
->
iç_scİe
;

220 
addr
->
a_æags
 = 
tb
[
IFA_FLAGS
] ? 
	`Æa_g‘_u32
(tb[IFA_FLAGS]) :

221 
iç
->
iç_æags
;

222 
addr
->
a_ifšdex
 = 
iç
->
iç_šdex
;

224 
addr
->
û_mask
 = (
ADDR_ATTR_FAMILY
 | 
ADDR_ATTR_PREFIXLEN
 |

225 
ADDR_ATTR_FLAGS
 | 
ADDR_ATTR_SCOPE
 | 
ADDR_ATTR_IFINDEX
);

227 ià(
tb
[
IFA_LABEL
]) {

228 
	`Æa_¡¾ıy
(
addr
->
a_Ïb–
, 
tb
[
IFA_LABEL
], 
IFNAMSIZ
);

229 
addr
->
û_mask
 |ğ
ADDR_ATTR_LABEL
;

233 ià(
tb
[
IFA_CACHEINFO
]) {

234 
iç_ÿchešfo
 *
ÿ
;

236 
ÿ
 = 
	`Æa_d©a
(
tb
[
IFA_CACHEINFO
]);

237 
addr
->
a_ÿchešfo
.
aci_´eã»d
 = 
ÿ
->
iç_´eã»d
;

238 
addr
->
a_ÿchešfo
.
aci_v®id
 = 
ÿ
->
iç_v®id
;

239 
addr
->
a_ÿchešfo
.
aci_c¡amp
 = 
ÿ
->
c¡amp
;

240 
addr
->
a_ÿchešfo
.
aci_t¡amp
 = 
ÿ
->
t¡amp
;

241 
addr
->
û_mask
 |ğ
ADDR_ATTR_CACHEINFO
;

244 ià(
tb
[
IFA_LOCAL
]) {

245 
addr
->
a_loÿl
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFA_LOCAL
], 
çmy
);

246 ià(!
addr
->
a_loÿl
)

247 
”rout_nomem
;

248 
addr
->
û_mask
 |ğ
ADDR_ATTR_LOCAL
;

249 
¶’_addr
 = 
addr
->
a_loÿl
;

252 ià(
tb
[
IFA_ADDRESS
]) {

253 
Æ_addr
 *
a
;

255 
a
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFA_ADDRESS
], 
çmy
);

256 ià(!
a
)

257 
”rout_nomem
;

262 ià(!
tb
[
IFA_LOCAL
] || !
	`Æ_addr_cmp
(
a
, 
addr
->
a_loÿl
)) {

263 
	`Æ_addr_put
(
addr
->
a_loÿl
);

264 
addr
->
a_loÿl
 = 
a
;

265 
addr
->
û_mask
 |ğ
ADDR_ATTR_LOCAL
;

267 
addr
->
a_³”
 = 
a
;

268 
addr
->
û_mask
 |ğ
ADDR_ATTR_PEER
;

271 
¶’_addr
 = 
a
;

274 ià(
¶’_addr
)

275 
	`Æ_addr_£t_´efixËn
(
¶’_addr
, 
addr
->
a_´efixËn
);

278 ià(
tb
[
IFA_BROADCAST
]) {

279 
addr
->
a_bÿ¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFA_BROADCAST
], 
çmy
);

280 ià(!
addr
->
a_bÿ¡
)

281 
”rout_nomem
;

283 
addr
->
û_mask
 |ğ
ADDR_ATTR_BROADCAST
;

287 ià(
tb
[
IFA_MULTICAST
]) {

288 
addr
->
a_muÉiÿ¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFA_MULTICAST
],

289 
çmy
);

290 ià(!
addr
->
a_muÉiÿ¡
)

291 
”rout_nomem
;

293 
addr
->
û_mask
 |ğ
ADDR_ATTR_MULTICAST
;

297 ià(
tb
[
IFA_ANYCAST
]) {

298 
addr
->
a_ªyÿ¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFA_ANYCAST
],

299 
çmy
);

300 ià(!
addr
->
a_ªyÿ¡
)

301 
”rout_nomem
;

303 
addr
->
û_mask
 |ğ
ADDR_ATTR_ANYCAST
;

306 ià((
lšk_ÿche
 = 
	`__Æ_ÿche_mngt_»quœe
("route/link"))) {

307 
¹Æ_lšk
 *
lšk
;

309 ià((
lšk
 = 
	`¹Æ_lšk_g‘
(
lšk_ÿche
, 
addr
->
a_ifšdex
))) {

310 
	`¹Æ_addr_£t_lšk
(
addr
, 
lšk
);

313 
	`¹Æ_lšk_put
(
lšk
);

317 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
addr
,…p);

318 
”rout
:

319 
	`¹Æ_addr_put
(
addr
);

321  
”r
;

323 
”rout_nomem
:

324 
”r
 = -
NLE_NOMEM
;

325 
”rout
;

326 
	}
}

328 
	$addr_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

330  
	`Æ_¹g’_»que¡
(
sk
, 
RTM_GETADDR
, 
AF_UNSPEC
, 
NLM_F_DUMP
);

331 
	}
}

333 
	$addr_dump_lše
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

335 
¹Æ_addr
 *
addr
 = (¹Æ_add¸*è
obj
;

336 
Æ_ÿche
 *
lšk_ÿche
;

337 
buf
[128];

339 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

341 ià(
addr
->
û_mask
 & 
ADDR_ATTR_LOCAL
)

342 
	`Æ_dump_lše
(
p
, "%s",

343 
	`Æ_addr2¡r
(
addr
->
a_loÿl
, 
buf
, (buf)));

345 
	`Æ_dump_lše
(
p
, "none");

347 ià(
addr
->
û_mask
 & 
ADDR_ATTR_PEER
)

348 
	`Æ_dump
(
p
, "…eer %s",

349 
	`Æ_addr2¡r
(
addr
->
a_³”
, 
buf
, (buf)));

351 
	`Æ_dump
(
p
, " % ", 
	`Æ_af2¡r
(
addr
->
a_çmy
, 
buf
, (buf)));

353 ià(
lšk_ÿche
)

354 
	`Æ_dump
(
p
, "dev %s ",

355 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
, 
addr
->
a_ifšdex
,

356 
buf
, (buf)));

358 
	`Æ_dump
(
p
, "dev %d ", 
addr
->
a_ifšdex
);

360 
	`Æ_dump
(
p
, "scope %s",

361 
	`¹Æ_scİe2¡r
(
addr
->
a_scİe
, 
buf
, (buf)));

363 
	`¹Æ_addr_æags2¡r
(
addr
->
a_æags
, 
buf
, (buf));

364 ià(
buf
[0])

365 
	`Æ_dump
(
p
, " <%s>", 
buf
);

367 
	`Æ_dump
(
p
, "\n");

369 ià(
lšk_ÿche
)

370 
	`Æ_ÿche_put
(
lšk_ÿche
);

371 
	}
}

373 
	$addr_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

375 
¹Æ_addr
 *
addr
 = (¹Æ_add¸*è
obj
;

376 
buf
[128];

378 
	`addr_dump_lše
(
obj
, 
p
);

380 ià(
addr
->
û_mask
 & (
ADDR_ATTR_LABEL
 | 
ADDR_ATTR_BROADCAST
 |

381 
ADDR_ATTR_MULTICAST
)) {

382 
	`Æ_dump_lše
(
p
, " ");

384 ià(
addr
->
û_mask
 & 
ADDR_ATTR_LABEL
)

385 
	`Æ_dump
(
p
, "†ab– %s", 
addr
->
a_Ïb–
);

387 ià(
addr
->
û_mask
 & 
ADDR_ATTR_BROADCAST
)

388 
	`Æ_dump
(
p
, " broadcast %s",

389 
	`Æ_addr2¡r
(
addr
->
a_bÿ¡
, 
buf
, (buf)));

391 ià(
addr
->
û_mask
 & 
ADDR_ATTR_MULTICAST
)

392 
	`Æ_dump
(
p
, " multicast %s",

393 
	`Æ_addr2¡r
(
addr
->
a_muÉiÿ¡
, 
buf
,

394 (
buf
)));

396 ià(
addr
->
û_mask
 & 
ADDR_ATTR_ANYCAST
)

397 
	`Æ_dump
(
p
, "‡nycast %s",

398 
	`Æ_addr2¡r
(
addr
->
a_ªyÿ¡
, 
buf
,

399 (
buf
)));

401 
	`Æ_dump
(
p
, "\n");

404 ià(
addr
->
û_mask
 & 
ADDR_ATTR_CACHEINFO
) {

405 
¹Æ_addr_ÿchešfo
 *
ci
 = &
addr
->
a_ÿchešfo
;

407 
	`Æ_dump_lše
(
p
, " valid-lifetime %s",

408 
ci
->
aci_v®id
 == 0xFFFFFFFFU ? "forever" :

409 
	`Æ_m£c2¡r
(
ci
->
aci_v®id
 * 1000,

410 
buf
, (buf)));

412 
	`Æ_dump
(
p
, "…referred-lifetime %s\n",

413 
ci
->
aci_´eã»d
 == 0xFFFFFFFFU ? "forever" :

414 
	`Æ_m£c2¡r
(
ci
->
aci_´eã»d
 * 1000,

415 
buf
, (buf)));

417 
	`Æ_dump_lše
(
p
, " created boot-time+%s ",

418 
	`Æ_m£c2¡r
(
addr
->
a_ÿchešfo
.
aci_c¡amp
 * 10,

419 
buf
, (buf)));

421 
	`Æ_dump
(
p
, "last-updated boot-time+%s\n",

422 
	`Æ_m£c2¡r
(
addr
->
a_ÿchešfo
.
aci_t¡amp
 * 10,

423 
buf
, (buf)));

425 
	}
}

427 
	$addr_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

429 
	`addr_dump_d‘as
(
obj
, 
p
);

430 
	}
}

432 
	$addr_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

433 
ušt32_t
 
©Œs
, 
æags
)

435 
¹Æ_addr
 *
a
 = (¹Æ_add¸*è
_a
;

436 
¹Æ_addr
 *
b
 = (¹Æ_add¸*è
_b
;

437 
diff
 = 0;

439 
	#ADDR_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
ADDR_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

441 
diff
 |ğ
	`ADDR_DIFF
(
IFINDEX
, 
a
->
a_ifšdex
 !ğ
b
->a_ifindex);

442 
diff
 |ğ
	`ADDR_DIFF
(
FAMILY
, 
a
->
a_çmy
 !ğ
b
->a_family);

443 
diff
 |ğ
	`ADDR_DIFF
(
SCOPE
, 
a
->
a_scİe
 !ğ
b
->a_scope);

444 
diff
 |ğ
	`ADDR_DIFF
(
LABEL
, 
	`¡rcmp
(
a
->
a_Ïb–
, 
b
->a_label));

445 
diff
 |ğ
	`ADDR_DIFF
(
PEER
, 
	`Æ_addr_cmp
(
a
->
a_³”
, 
b
->a_peer));

446 
diff
 |ğ
	`ADDR_DIFF
(
LOCAL
, 
	`Æ_addr_cmp
(
a
->
a_loÿl
, 
b
->a_local));

447 
diff
 |ğ
	`ADDR_DIFF
(
MULTICAST
, 
	`Æ_addr_cmp
(
a
->
a_muÉiÿ¡
,

448 
b
->
a_muÉiÿ¡
));

449 
diff
 |ğ
	`ADDR_DIFF
(
BROADCAST
, 
	`Æ_addr_cmp
(
a
->
a_bÿ¡
, 
b
->a_bcast));

450 
diff
 |ğ
	`ADDR_DIFF
(
ANYCAST
, 
	`Æ_addr_cmp
(
a
->
a_ªyÿ¡
, 
b
->a_anycast));

452 ià(
æags
 & 
LOOSE_COMPARISON
)

453 
diff
 |ğ
	`ADDR_DIFF
(
FLAGS
,

454 (
a
->
a_æags
 ^ 
b
->a_æagsè& b->
a_æag_mask
);

456 
diff
 |ğ
	`ADDR_DIFF
(
FLAGS
, 
a
->
a_æags
 !ğ
b
->a_flags);

458 #undeà
ADDR_DIFF


460  
diff
;

461 
	}
}

463 cÚ¡ 
Œªs_tbl
 
	gaddr_©Œs
[] = {

464 
__ADD
(
ADDR_ATTR_FAMILY
, 
çmy
)

465 
__ADD
(
ADDR_ATTR_PREFIXLEN
, 
´efixËn
)

466 
__ADD
(
ADDR_ATTR_FLAGS
, 
æags
)

467 
__ADD
(
ADDR_ATTR_SCOPE
, 
scİe
)

468 
__ADD
(
ADDR_ATTR_IFINDEX
, 
ifšdex
)

469 
__ADD
(
ADDR_ATTR_LABEL
, 
Ïb–
)

470 
__ADD
(
ADDR_ATTR_CACHEINFO
, 
ÿchešfo
)

471 
__ADD
(
ADDR_ATTR_PEER
, 
³”
)

472 
__ADD
(
ADDR_ATTR_LOCAL
, 
loÿl
)

473 
__ADD
(
ADDR_ATTR_BROADCAST
, 
brßdÿ¡
)

474 
__ADD
(
ADDR_ATTR_MULTICAST
, 
muÉiÿ¡
)

477 *
	$addr_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

479  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
addr_©Œs
,

480 
	`ARRAY_SIZE
(
addr_©Œs
));

481 
	}
}

488 
¹Æ_addr
 *
	$¹Æ_addr_®loc
()

490  (
¹Æ_addr
 *è
	`Æ_objeù_®loc
(&
addr_obj_İs
);

491 
	}
}

493 
	$¹Æ_addr_put
(
¹Æ_addr
 *
addr
)

495 
	`Æ_objeù_put
((
Æ_objeù
 *è
addr
);

496 
	}
}

505 
	$¹Æ_addr_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

507  
	`Æ_ÿche_®loc_ªd_fl
(&
¹Æ_addr_İs
, 
sk
, 
»suÉ
);

508 
	}
}

524 
¹Æ_addr
 *
	$¹Æ_addr_g‘
(
Æ_ÿche
 *
ÿche
, 
ifšdex
,

525 
Æ_addr
 *
addr
)

527 
¹Æ_addr
 *
a
;

529 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_addr_İs
)

530  
NULL
;

532 
	`Æ_li¡_fÜ_—ch_’Œy
(
a
, &
ÿche
->
c_™ems
, 
û_li¡
) {

533 ià(
ifšdex
 && 
a
->
a_ifšdex
 != ifindex)

536 ià(
a
->
û_mask
 & 
ADDR_ATTR_LOCAL
 &&

537 !
	`Æ_addr_cmp
(
a
->
a_loÿl
, 
addr
)) {

538 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
a
);

539  
a
;

543  
NULL
;

544 
	}
}

548 
	$bud_addr_msg
(
¹Æ_addr
 *
tm¶
, 
cmd
, 
æags
,

549 
Æ_msg
 **
»suÉ
)

551 
Æ_msg
 *
msg
;

552 
içddrmsg
 
am
 = {

553 .
iç_çmy
 = 
tm¶
->
a_çmy
,

554 .
iç_šdex
 = 
tm¶
->
a_ifšdex
,

555 .
iç_´efixËn
 = 
tm¶
->
a_´efixËn
,

556 .
iç_æags
 = 
tm¶
->
a_æags
,

559 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_SCOPE
)

560 
am
.
iç_scİe
 = 
tm¶
->
a_scİe
;

563 ià(
tm¶
->
a_çmy
 =ğ
AF_INET
 &&

564 
tm¶
->
û_mask
 & 
ADDR_ATTR_LOCAL
 &&

565 *((*è
	`Æ_addr_g‘_bš¬y_addr
(
tm¶
->
a_loÿl
)) == 127)

566 
am
.
iç_scİe
 = 
RT_SCOPE_HOST
;

568 
am
.
iç_scİe
 = 
RT_SCOPE_UNIVERSE
;

571 
msg
 = 
	`Æmsg_®loc_sim¶e
(
cmd
, 
æags
);

572 ià(!
msg
)

573  -
NLE_NOMEM
;

575 ià(
	`Æmsg_­³nd
(
msg
, &
am
, ×m), 
NLMSG_ALIGNTO
) < 0)

576 
Æa_put_çu»
;

578 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_LOCAL
)

579 
	`NLA_PUT_ADDR
(
msg
, 
IFA_LOCAL
, 
tm¶
->
a_loÿl
);

581 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_PEER
)

582 
	`NLA_PUT_ADDR
(
msg
, 
IFA_ADDRESS
, 
tm¶
->
a_³”
);

583 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_LOCAL
)

584 
	`NLA_PUT_ADDR
(
msg
, 
IFA_ADDRESS
, 
tm¶
->
a_loÿl
);

586 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_LABEL
)

587 
	`NLA_PUT_STRING
(
msg
, 
IFA_LABEL
, 
tm¶
->
a_Ïb–
);

589 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_BROADCAST
)

590 
	`NLA_PUT_ADDR
(
msg
, 
IFA_BROADCAST
, 
tm¶
->
a_bÿ¡
);

592 ià(
tm¶
->
û_mask
 & 
ADDR_ATTR_CACHEINFO
) {

593 
iç_ÿchešfo
 
ÿ
 = {

594 .
iç_v®id
 = 
tm¶
->
a_ÿchešfo
.
aci_v®id
,

595 .
iç_´eã»d
 = 
tm¶
->
a_ÿchešfo
.
aci_´eã»d
,

598 
	`NLA_PUT
(
msg
, 
IFA_CACHEINFO
, (
ÿ
), &ca);

601 ià(
tm¶
->
a_æags
 & ~0xFF) {

612 
	`NLA_PUT_U32
(
msg
, 
IFA_FLAGS
, 
tm¶
->
a_æags
);

615 *
»suÉ
 = 
msg
;

618 
Æa_put_çu»
:

619 
	`Æmsg_ä“
(
msg
);

620  -
NLE_MSGSIZE
;

621 
	}
}

650 
	$¹Æ_addr_bud_add_»que¡
(
¹Æ_addr
 *
addr
, 
æags
,

651 
Æ_msg
 **
»suÉ
)

653 
ušt32_t
 
»quœed
 = 
ADDR_ATTR_IFINDEX
 | 
ADDR_ATTR_FAMILY
 |

654 
ADDR_ATTR_PREFIXLEN
 | 
ADDR_ATTR_LOCAL
;

656 ià((
addr
->
û_mask
 & 
»quœed
) !=„equired)

657  -
NLE_MISSING_ATTR
;

659  
	`bud_addr_msg
(
addr
, 
RTM_NEWADDR
, 
NLM_F_CREATE
 | 
æags
, 
»suÉ
);

660 
	}
}

676 
	$¹Æ_addr_add
(
Æ_sock
 *
sk
, 
¹Æ_addr
 *
addr
, 
æags
)

678 
Æ_msg
 *
msg
;

679 
”r
;

681 ià((
”r
 = 
	`¹Æ_addr_bud_add_»que¡
(
addr
, 
æags
, &
msg
)) < 0)

682  
”r
;

684 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

685 
	`Æmsg_ä“
(
msg
);

686 ià(
”r
 < 0)

687  
”r
;

689  
	`wa™_fÜ_ack
(
sk
);

690 
	}
}

723 
	$¹Æ_addr_bud_d–‘e_»que¡
(
¹Æ_addr
 *
addr
, 
æags
,

724 
Æ_msg
 **
»suÉ
)

726 
ušt32_t
 
»quœed
 = 
ADDR_ATTR_IFINDEX
 | 
ADDR_ATTR_FAMILY
;

728 ià((
addr
->
û_mask
 & 
»quœed
) !=„equired)

729  -
NLE_MISSING_ATTR
;

731  
	`bud_addr_msg
(
addr
, 
RTM_DELADDR
, 
æags
, 
»suÉ
);

732 
	}
}

748 
	$¹Æ_addr_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_addr
 *
addr
, 
æags
)

750 
Æ_msg
 *
msg
;

751 
”r
;

753 ià((
”r
 = 
	`¹Æ_addr_bud_d–‘e_»que¡
(
addr
, 
æags
, &
msg
)) < 0)

754  
”r
;

756 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

757 
	`Æmsg_ä“
(
msg
);

758 ià(
”r
 < 0)

759  
”r
;

761  
	`wa™_fÜ_ack
(
sk
);

762 
	}
}

771 
	$¹Æ_addr_£t_Ïb–
(
¹Æ_addr
 *
addr
, cÚ¡ *
Ïb–
)

773 ià(
	`¡¾’
(
Ïb–
è> (
addr
->
a_Ïb–
) - 1)

774  -
NLE_RANGE
;

776 
	`¡rıy
(
addr
->
a_Ïb–
, 
Ïb–
);

777 
addr
->
û_mask
 |ğ
ADDR_ATTR_LABEL
;

780 
	}
}

782 *
	$¹Æ_addr_g‘_Ïb–
(
¹Æ_addr
 *
addr
)

784 ià(
addr
->
û_mask
 & 
ADDR_ATTR_LABEL
)

785  
addr
->
a_Ïb–
;

787  
NULL
;

788 
	}
}

790 
	$¹Æ_addr_£t_ifšdex
(
¹Æ_addr
 *
addr
, 
ifšdex
)

792 
addr
->
a_ifšdex
 = 
ifšdex
;

793 
addr
->
û_mask
 |ğ
ADDR_ATTR_IFINDEX
;

794 
	}
}

796 
	$¹Æ_addr_g‘_ifšdex
(
¹Æ_addr
 *
addr
)

798  
addr
->
a_ifšdex
;

799 
	}
}

801 
	$¹Æ_addr_£t_lšk
(
¹Æ_addr
 *
addr
, 
¹Æ_lšk
 *
lšk
)

803 
	`¹Æ_lšk_put
(
addr
->
a_lšk
);

805 ià(!
lšk
)

808 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
lšk
));

809 
addr
->
a_lšk
 = 
lšk
;

810 
addr
->
a_ifšdex
 = 
lšk
->
l_šdex
;

811 
addr
->
û_mask
 |ğ
ADDR_ATTR_IFINDEX
;

812 
	}
}

814 
¹Æ_lšk
 *
	$¹Æ_addr_g‘_lšk
(
¹Æ_addr
 *
addr
)

816 ià(
addr
->
a_lšk
) {

817 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
addr
->
a_lšk
));

818  
addr
->
a_lšk
;

821  
NULL
;

822 
	}
}

824 
	$¹Æ_addr_£t_çmy
(
¹Æ_addr
 *
addr
, 
çmy
)

826 
addr
->
a_çmy
 = 
çmy
;

827 
addr
->
û_mask
 |ğ
ADDR_ATTR_FAMILY
;

828 
	}
}

830 
	$¹Æ_addr_g‘_çmy
(
¹Æ_addr
 *
addr
)

832  
addr
->
a_çmy
;

833 
	}
}

851 
	$¹Æ_addr_£t_´efixËn
(
¹Æ_addr
 *
addr
, 
´efixËn
)

853 
addr
->
a_´efixËn
 = 
´efixËn
;

855 ià(
´efixËn
)

856 
addr
->
û_mask
 |ğ
ADDR_ATTR_PREFIXLEN
;

858 
addr
->
û_mask
 &ğ~
ADDR_ATTR_PREFIXLEN
;

864 ià(
addr
->
a_³”
)

865 
	`Æ_addr_£t_´efixËn
(
addr
->
a_³”
, 
´efixËn
);

866 ià(
addr
->
a_loÿl
)

867 
	`Æ_addr_£t_´efixËn
(
addr
->
a_loÿl
, 
´efixËn
);

868 
	}
}

870 
	$¹Æ_addr_g‘_´efixËn
(
¹Æ_addr
 *
addr
)

872  
addr
->
a_´efixËn
;

873 
	}
}

875 
	$¹Æ_addr_£t_scİe
(
¹Æ_addr
 *
addr
, 
scİe
)

877 
addr
->
a_scİe
 = 
scİe
;

878 
addr
->
û_mask
 |ğ
ADDR_ATTR_SCOPE
;

879 
	}
}

881 
	$¹Æ_addr_g‘_scİe
(
¹Æ_addr
 *
addr
)

883  
addr
->
a_scİe
;

884 
	}
}

886 
	$¹Æ_addr_£t_æags
(
¹Æ_addr
 *
addr
, 
æags
)

888 
addr
->
a_æag_mask
 |ğ
æags
;

889 
addr
->
a_æags
 |ğ
æags
;

890 
addr
->
û_mask
 |ğ
ADDR_ATTR_FLAGS
;

891 
	}
}

893 
	$¹Æ_addr_un£t_æags
(
¹Æ_addr
 *
addr
, 
æags
)

895 
addr
->
a_æag_mask
 |ğ
æags
;

896 
addr
->
a_æags
 &ğ~
æags
;

897 
addr
->
û_mask
 |ğ
ADDR_ATTR_FLAGS
;

898 
	}
}

900 
	$¹Æ_addr_g‘_æags
(
¹Æ_addr
 *
addr
)

902  
addr
->
a_æags
;

903 
	}
}

905 
šlše
 
	$__assign_addr
(
¹Æ_addr
 *
addr
, 
Æ_addr
 **
pos
,

906 
Æ_addr
 *
Ãw
, 
æag
)

908 ià(
Ãw
) {

909 ià(
addr
->
û_mask
 & 
ADDR_ATTR_FAMILY
) {

910 ià(
Ãw
->
a_çmy
 !ğ
addr
->a_family)

911  -
NLE_AF_MISMATCH
;

913 
addr
->
a_çmy
 = 
Ãw
->a_family;

915 ià(*
pos
)

916 
	`Æ_addr_put
(*
pos
);

918 *
pos
 = 
	`Æ_addr_g‘
(
Ãw
);

919 
addr
->
û_mask
 |ğ(
æag
 | 
ADDR_ATTR_FAMILY
);

921 ià(*
pos
)

922 
	`Æ_addr_put
(*
pos
);

924 *
pos
 = 
NULL
;

925 
addr
->
û_mask
 &ğ~
æag
;

929 
	}
}

931 
	$¹Æ_addr_£t_loÿl
(
¹Æ_addr
 *
addr
, 
Æ_addr
 *
loÿl
)

933 
”r
;

936 ià((
addr
->
û_mask
 & 
ADDR_ATTR_PEER
è&& 
loÿl
 &&

937 
	`Æ_addr_g‘_´efixËn
(
loÿl
))

938  -
NLE_INVAL
;

940 
”r
 = 
	`__assign_addr
(
addr
, &addr->
a_loÿl
, 
loÿl
, 
ADDR_ATTR_LOCAL
);

941 ià(
”r
 < 0)

942  
”r
;

945 ià(!(
addr
->
û_mask
 & 
ADDR_ATTR_PEER
))

946 
	`¹Æ_addr_£t_´efixËn
(
addr
, 
loÿl
 ? 
	`Æ_addr_g‘_´efixËn
(local) : 0);

949 
	}
}

951 
Æ_addr
 *
	$¹Æ_addr_g‘_loÿl
(
¹Æ_addr
 *
addr
)

953  
addr
->
a_loÿl
;

954 
	}
}

956 
	$¹Æ_addr_£t_³”
(
¹Æ_addr
 *
addr
, 
Æ_addr
 *
³”
)

958 
”r
;

960 ià(
³”
 &&…“r->
a_çmy
 !ğ
AF_INET
)

961  -
NLE_AF_NOSUPPORT
;

963 
”r
 = 
	`__assign_addr
(
addr
, &addr->
a_³”
, 
³”
, 
ADDR_ATTR_PEER
);

964 ià(
”r
 < 0)

965  
”r
;

967 
	`¹Æ_addr_£t_´efixËn
(
addr
, 
³”
 ? 
	`Æ_addr_g‘_´efixËn
(peer) : 0);

970 
	}
}

972 
Æ_addr
 *
	$¹Æ_addr_g‘_³”
(
¹Æ_addr
 *
addr
)

974  
addr
->
a_³”
;

975 
	}
}

977 
	$¹Æ_addr_£t_brßdÿ¡
(
¹Æ_addr
 *
addr
, 
Æ_addr
 *
bÿ¡
)

979 ià(
bÿ¡
 && bÿ¡->
a_çmy
 !ğ
AF_INET
)

980  -
NLE_AF_NOSUPPORT
;

982  
	`__assign_addr
(
addr
, &addr->
a_bÿ¡
, 
bÿ¡
, 
ADDR_ATTR_BROADCAST
);

983 
	}
}

985 
Æ_addr
 *
	$¹Æ_addr_g‘_brßdÿ¡
(
¹Æ_addr
 *
addr
)

987  
addr
->
a_bÿ¡
;

988 
	}
}

990 
	$¹Æ_addr_£t_muÉiÿ¡
(
¹Æ_addr
 *
addr
, 
Æ_addr
 *
muÉiÿ¡
)

992 ià(
muÉiÿ¡
 && muÉiÿ¡->
a_çmy
 !ğ
AF_INET6
)

993  -
NLE_AF_NOSUPPORT
;

995  
	`__assign_addr
(
addr
, &addr->
a_muÉiÿ¡
, 
muÉiÿ¡
,

996 
ADDR_ATTR_MULTICAST
);

997 
	}
}

999 
Æ_addr
 *
	$¹Æ_addr_g‘_muÉiÿ¡
(
¹Æ_addr
 *
addr
)

1001  
addr
->
a_muÉiÿ¡
;

1002 
	}
}

1004 
	$¹Æ_addr_£t_ªyÿ¡
(
¹Æ_addr
 *
addr
, 
Æ_addr
 *
ªyÿ¡
)

1006 ià(
ªyÿ¡
 &&‡nyÿ¡->
a_çmy
 !ğ
AF_INET6
)

1007  -
NLE_AF_NOSUPPORT
;

1009  
	`__assign_addr
(
addr
, &addr->
a_ªyÿ¡
, 
ªyÿ¡
,

1010 
ADDR_ATTR_ANYCAST
);

1011 
	}
}

1013 
Æ_addr
 *
	$¹Æ_addr_g‘_ªyÿ¡
(
¹Æ_addr
 *
addr
)

1015  
addr
->
a_ªyÿ¡
;

1016 
	}
}

1018 
ušt32_t
 
	$¹Æ_addr_g‘_v®id_liãtime
(
¹Æ_addr
 *
addr
)

1020 ià(
addr
->
û_mask
 & 
ADDR_ATTR_CACHEINFO
)

1021  
addr
->
a_ÿchešfo
.
aci_v®id
;

1024 
	}
}

1026 
	$¹Æ_addr_£t_v®id_liãtime
(
¹Æ_addr
 *
addr
, 
ušt32_t
 
liãtime
)

1028 
addr
->
a_ÿchešfo
.
aci_v®id
 = 
liãtime
;

1029 
addr
->
û_mask
 |ğ
ADDR_ATTR_CACHEINFO
;

1030 
	}
}

1032 
ušt32_t
 
	$¹Æ_addr_g‘_´eã¼ed_liãtime
(
¹Æ_addr
 *
addr
)

1034 ià(
addr
->
û_mask
 & 
ADDR_ATTR_CACHEINFO
)

1035  
addr
->
a_ÿchešfo
.
aci_´eã»d
;

1038 
	}
}

1040 
	$¹Æ_addr_£t_´eã¼ed_liãtime
(
¹Æ_addr
 *
addr
, 
ušt32_t
 
liãtime
)

1042 
addr
->
a_ÿchešfo
.
aci_´eã»d
 = 
liãtime
;

1043 
addr
->
û_mask
 |ğ
ADDR_ATTR_CACHEINFO
;

1044 
	}
}

1046 
ušt32_t
 
	$¹Æ_addr_g‘_ü—‹_time
(
¹Æ_addr
 *
addr
)

1048  
addr
->
a_ÿchešfo
.
aci_c¡amp
;

1049 
	}
}

1051 
ušt32_t
 
	$¹Æ_addr_g‘_Ï¡_upd©e_time
(
¹Æ_addr
 *
addr
)

1053  
addr
->
a_ÿchešfo
.
aci_t¡amp
;

1054 
	}
}

1063 cÚ¡ 
Œªs_tbl
 
	gaddr_æags
[] = {

1064 
__ADD
(
IFA_F_SECONDARY
, 
£cÚd¬y
)

1065 
__ADD
(
IFA_F_NODAD
, 
nodad
)

1066 
__ADD
(
IFA_F_OPTIMISTIC
, 
İtimi¡ic
)

1067 
__ADD
(
IFA_F_HOMEADDRESS
, 
hom—dd»ss
)

1068 
__ADD
(
IFA_F_DEPRECATED
, 
d•»ÿ‹d
)

1069 
__ADD
(
IFA_F_TENTATIVE
, 
‹Á©ive
)

1070 
__ADD
(
IFA_F_PERMANENT
, 
³rmª’t
)

1071 
__ADD
(
IFA_F_MANAGETEMPADDR
, 
mngtm·ddr
)

1072 
__ADD
(
IFA_F_NOPREFIXROUTE
, 
nİ»fixrou‹
)

1075 *
	$¹Æ_addr_æags2¡r
(
æags
, *
buf
, 
size_t
 
size
)

1077  
	`__æags2¡r
(
æags
, 
buf
, 
size
, 
addr_æags
,

1078 
	`ARRAY_SIZE
(
addr_æags
));

1079 
	}
}

1081 
	$¹Æ_addr_¡r2æags
(cÚ¡ *
Çme
)

1083  
	`__¡r2æags
(
Çme
, 
addr_æags
, 
	`ARRAY_SIZE
(addr_flags));

1084 
	}
}

1088 
Æ_objeù_İs
 
	gaddr_obj_İs
 = {

1089 .
oo_Çme
 = "route/addr",

1090 .
	goo_size
 = (
¹Æ_addr
),

1091 .
	goo_cÚ¡ruùÜ
 = 
addr_cÚ¡ruùÜ
,

1092 .
	goo_ä“_d©a
 = 
addr_ä“_d©a
,

1093 .
	goo_şÚe
 = 
addr_şÚe
,

1094 .
	goo_dump
 = {

1095 [
NL_DUMP_LINE
] = 
addr_dump_lše
,

1096 [
NL_DUMP_DETAILS
] = 
addr_dump_d‘as
,

1097 [
NL_DUMP_STATS
] = 
addr_dump_¡©s
,

1099 .
	goo_com·»
 = 
addr_com·»
,

1100 .
	goo_©Œs2¡r
 = 
addr_©Œs2¡r
,

1101 .
	goo_id_©Œs
 = (
ADDR_ATTR_FAMILY
 | 
ADDR_ATTR_IFINDEX
 |

1102 
ADDR_ATTR_LOCAL
 | 
ADDR_ATTR_PREFIXLEN
),

1105 
Æ_af_group
 
	gaddr_groups
[] = {

1106 { 
AF_INET
, 
RTNLGRP_IPV4_IFADDR
 },

1107 { 
AF_INET6
, 
RTNLGRP_IPV6_IFADDR
 },

1108 { 
END_OF_GROUP_LIST
 },

1111 
Æ_ÿche_İs
 
	g¹Æ_addr_İs
 = {

1112 .
co_Çme
 = "route/addr",

1113 .
	gco_hdrsize
 = (
içddrmsg
),

1114 .
	gco_msgty³s
 = {

1115 { 
RTM_NEWADDR
, 
NL_ACT_NEW
, "new" },

1116 { 
RTM_DELADDR
, 
NL_ACT_DEL
, "del" },

1117 { 
RTM_GETADDR
, 
NL_ACT_GET
, "get" },

1118 
END_OF_MSGTYPES_LIST
,

1120 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

1121 .
	gco_groups
 = 
addr_groups
,

1122 .
	gco_»que¡_upd©e
 = 
addr_»que¡_upd©e
,

1123 .
	gco_msg_·r£r
 = 
addr_msg_·r£r
,

1124 .
	gco_obj_İs
 = &
addr_obj_İs
,

1127 
__š™
 
	$addr_š™
()

1129 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_addr_İs
);

1130 
	}
}

1132 
__ex™
 
	$addr_ex™
()

1134 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_addr_İs
);

1135 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/class.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

22 
	~<Ãšk/rou‹/şass.h
>

23 
	~<Ãšk/rou‹/qdisc.h
>

24 
	~<Ãšk/rou‹/şassif›r.h
>

25 
	~<Ãšk/uts.h
>

27 
Æ_ÿche_İs
 
	g¹Æ_şass_İs
;

28 
Æ_objeù_İs
 
	gşass_obj_İs
;

30 
	$şass_dump_d‘as
(
¹Æ_tc
 *
tc
, 
Æ_dump_·¿ms
 *
p
)

32 
¹Æ_şass
 *
şass
 = (¹Æ_şas *è
tc
;

33 
buf
[32];

35 ià(
şass
->
c_šfo
)

36 
	`Æ_dump
(
p
, "child-qdisc %s ",

37 
	`¹Æ_tc_hªdË2¡r
(
şass
->
c_šfo
, 
buf
, (buf)));

38 
	}
}

41 
	$şass_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

42 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

44 
¹Æ_şass
 *
şass
;

45 
”r
;

47 ià(!(
şass
 = 
	`¹Æ_şass_®loc
()))

48  -
NLE_NOMEM
;

50 ià((
”r
 = 
	`¹Æ_tc_msg_·r£
(
Æh
, 
	`TC_CAST
(
şass
))) < 0)

51 
”rout
;

53 
”r
 = 
µ
->
	`µ_cb
(
	`OBJ_CAST
(
şass
),…p);

54 
”rout
:

55 
	`¹Æ_şass_put
(
şass
);

57  
”r
;

58 
	}
}

60 
	$şass_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

62 
tcmsg
 
tchdr
 = {

63 .
tcm_çmy
 = 
AF_UNSPEC
,

64 .
tcm_ifšdex
 = 
ÿche
->
c_Ÿrg1
,

67  
	`Æ_£nd_sim¶e
(
sk
, 
RTM_GETTCLASS
, 
NLM_F_DUMP
, &
tchdr
,

68 (
tchdr
));

69 
	}
}

76 
¹Æ_şass
 *
	$¹Æ_şass_®loc
()

78 
¹Æ_tc
 *
tc
;

80 
tc
 = 
	`TC_CAST
(
	`Æ_objeù_®loc
(&
şass_obj_İs
));

81 ià(
tc
)

82 
tc
->
tc_ty³
 = 
RTNL_TC_TYPE_CLASS
;

84  (
¹Æ_şass
 *è
tc
;

85 
	}
}

87 
	$¹Æ_şass_put
(
¹Æ_şass
 *
şass
)

89 
	`Æ_objeù_put
((
Æ_objeù
 *è
şass
);

90 
	}
}

100 
	$şass_bud
(
¹Æ_şass
 *
şass
, 
ty³
, 
æags
,

101 
Æ_msg
 **
»suÉ
)

103 
ušt32_t
 
Ãeded
 = 
TCA_ATTR_PARENT
 | 
TCA_ATTR_HANDLE
;

105 ià((
şass
->
û_mask
 & 
Ãeded
) ==‚eeded &&

106 
	`TC_H_MAJ
(
şass
->
c_·»Á
è&& TC_H_MAJ(şass->
c_hªdË
) &&

107 
	`TC_H_MAJ
(
şass
->
c_·»Á
è!ğTC_H_MAJ(şass->
c_hªdË
)) {

108 
	`APPBUG
("TC_H_MAJ(parent) must match TC_H_MAJ(handle)");

109  -
NLE_INVAL
;

112  
	`¹Æ_tc_msg_bud
(
	`TC_CAST
(
şass
), 
ty³
, 
æags
, 
»suÉ
);

113 
	}
}

129 
	$¹Æ_şass_bud_add_»que¡
(
¹Æ_şass
 *
şass
, 
æags
,

130 
Æ_msg
 **
»suÉ
)

132  
	`şass_bud
(
şass
, 
RTM_NEWTCLASS
, 
æags
, 
»suÉ
);

133 
	}
}

171 
	$¹Æ_şass_add
(
Æ_sock
 *
sk
, 
¹Æ_şass
 *
şass
, 
æags
)

173 
Æ_msg
 *
msg
;

174 
”r
;

176 ià((
”r
 = 
	`¹Æ_şass_bud_add_»que¡
(
şass
, 
æags
, &
msg
)) < 0)

177  
”r
;

179  
	`Æ_£nd_sync
(
sk
, 
msg
);

180 
	}
}

195 
	$¹Æ_şass_bud_d–‘e_»que¡
(
¹Æ_şass
 *
şass
, 
Æ_msg
 **
»suÉ
)

197 
Æ_msg
 *
msg
;

198 
tcmsg
 
tchdr
;

199 
ušt32_t
 
»quœed
 = 
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
;

201 ià((
şass
->
û_mask
 & 
»quœed
) !=„equired) {

202 
	`APPBUG
("ifindex‡nd handle must be specified");

203  -
NLE_MISSING_ATTR
;

206 ià(!(
msg
 = 
	`Æmsg_®loc_sim¶e
(
RTM_DELTCLASS
, 0)))

207  -
NLE_NOMEM
;

209 
	`mem£t
(&
tchdr
, 0, (tchdr));

210 
tchdr
.
tcm_çmy
 = 
AF_UNSPEC
;

211 
tchdr
.
tcm_ifšdex
 = 
şass
->
c_ifšdex
;

212 
tchdr
.
tcm_hªdË
 = 
şass
->
c_hªdË
;

214 ià(
şass
->
û_mask
 & 
TCA_ATTR_PARENT
)

215 
tchdr
.
tcm_·»Á
 = 
şass
->
c_·»Á
;

217 ià(
	`Æmsg_­³nd
(
msg
, &
tchdr
, Ñchdr), 
NLMSG_ALIGNTO
) < 0) {

218 
	`Æmsg_ä“
(
msg
);

219  -
NLE_MSGSIZE
;

222 *
»suÉ
 = 
msg
;

224 
	}
}

252 
	$¹Æ_şass_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_şass
 *
şass
)

254 
Æ_msg
 *
msg
;

255 
”r
;

257 ià((
”r
 = 
	`¹Æ_şass_bud_d–‘e_»que¡
(
şass
, &
msg
)) < 0)

258  
”r
;

260  
	`Æ_£nd_sync
(
sk
, 
msg
);

261 
	}
}

277 
¹Æ_qdisc
 *
	$¹Æ_şass_Ëaf_qdisc
(
¹Æ_şass
 *
şass
,

278 
Æ_ÿche
 *
ÿche
)

280 
¹Æ_qdisc
 *
Ëaf
;

282 ià(!
şass
->
c_šfo
)

283  
NULL
;

285 
Ëaf
 = 
	`¹Æ_qdisc_g‘_by_·»Á
(
ÿche
, 
şass
->
c_ifšdex
,

286 
şass
->
c_hªdË
);

287 ià(!
Ëaf
 ||†—f->
q_hªdË
 !ğ
şass
->
c_šfo
)

288  
NULL
;

290  
Ëaf
;

291 
	}
}

312 
	$¹Æ_şass_®loc_ÿche
(
Æ_sock
 *
sk
, 
ifšdex
,

313 
Æ_ÿche
 **
»suÉ
)

315 
Æ_ÿche
 * 
ÿche
;

316 
”r
;

318 ià(!
ifšdex
) {

319 
	`APPBUG
("ifindex must be specified");

320  -
NLE_INVAL
;

323 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(&
¹Æ_şass_İs
)))

324  -
NLE_NOMEM
;

326 
ÿche
->
c_Ÿrg1
 = 
ifšdex
;

328 ià(
sk
 && (
”r
 = 
	`Æ_ÿche_»fl
(sk, 
ÿche
)) < 0) {

329 
	`Æ_ÿche_ä“
(
ÿche
);

330  
”r
;

333 *
»suÉ
 = 
ÿche
;

335 
	}
}

353 
¹Æ_şass
 *
	$¹Æ_şass_g‘
(
Æ_ÿche
 *
ÿche
, 
ifšdex
,

354 
ušt32_t
 
hªdË
)

356 
¹Æ_şass
 *
şass
;

358 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_şass_İs
)

359  
NULL
;

361 
	`Æ_li¡_fÜ_—ch_’Œy
(
şass
, &
ÿche
->
c_™ems
, 
û_li¡
) {

362 ià(
şass
->
c_hªdË
 =ğ
hªdË
 && cÏss->
c_ifšdex
 =ğ
ifšdex
) {

363 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
şass
);

364  
şass
;

367  
NULL
;

368 
	}
}

383 
¹Æ_şass_fÜ—ch_chd
(
¹Æ_şass
 *
şass
, 
Æ_ÿche
 *
ÿche
,

384 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

386 
¹Æ_şass
 *
f‹r
;

388 
f‹r
 = 
	`¹Æ_şass_®loc
();

389 ià(!
f‹r
)

392 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
f‹r
), 
şass
->
c_hªdË
);

393 
	`¹Æ_tc_£t_ifšdex
(
	`TC_CAST
(
f‹r
), 
şass
->
c_ifšdex
);

394 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
f‹r
), 
şass
->
c_kšd
);

396 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, 
	`OBJ_CAST
(
f‹r
), 
cb
, 
¬g
);

397 
	`¹Æ_şass_put
(
f‹r
);

398 
	}
}

406 
¹Æ_şass_fÜ—ch_şs
(
¹Æ_şass
 *
şass
, 
Æ_ÿche
 *
ÿche
,

407 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

409 
¹Æ_şs
 *
f‹r
;

411 
f‹r
 = 
	`¹Æ_şs_®loc
();

412 ià(!
f‹r
)

415 
	`¹Æ_tc_£t_ifšdex
((
¹Æ_tc
 *è
f‹r
, 
şass
->
c_ifšdex
);

416 
	`¹Æ_tc_£t_·»Á
((
¹Æ_tc
 *è
f‹r
, 
şass
->
c_·»Á
);

418 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, (
Æ_objeù
 *è
f‹r
, 
cb
, 
¬g
);

419 
	`¹Æ_şs_put
(
f‹r
);

420 
	}
}

424 
¹Æ_tc_ty³_İs
 
	gşass_İs
 = {

425 .
‰_ty³
 = 
RTNL_TC_TYPE_CLASS
,

426 .
	g‰_dump_´efix
 = "class",

427 .
	g‰_dump
 = {

428 [
NL_DUMP_DETAILS
] = 
şass_dump_d‘as
,

432 
Æ_objeù_İs
 
	gşass_obj_İs
 = {

433 .
oo_Çme
 = "route/class",

434 .
	goo_size
 = (
¹Æ_şass
),

435 .
	goo_ä“_d©a
 = 
¹Æ_tc_ä“_d©a
,

436 .
	goo_şÚe
 = 
¹Æ_tc_şÚe
,

437 .
	goo_dump
 = {

438 [
NL_DUMP_LINE
] = 
¹Æ_tc_dump_lše
,

439 [
NL_DUMP_DETAILS
] = 
¹Æ_tc_dump_d‘as
,

440 [
NL_DUMP_STATS
] = 
¹Æ_tc_dump_¡©s
,

442 .
	goo_com·»
 = 
¹Æ_tc_com·»
,

443 .
	goo_id_©Œs
 = (
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
),

446 
Æ_ÿche_İs
 
	g¹Æ_şass_İs
 = {

447 .
co_Çme
 = "route/class",

448 .
	gco_hdrsize
 = (
tcmsg
),

449 .
	gco_msgty³s
 = {

450 { 
RTM_NEWTCLASS
, 
NL_ACT_NEW
, "new" },

451 { 
RTM_DELTCLASS
, 
NL_ACT_DEL
, "del" },

452 { 
RTM_GETTCLASS
, 
NL_ACT_GET
, "get" },

453 
END_OF_MSGTYPES_LIST
,

455 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

456 .
	gco_groups
 = 
tc_groups
,

457 .
	gco_»que¡_upd©e
 = &
şass_»que¡_upd©e
,

458 .
	gco_msg_·r£r
 = &
şass_msg_·r£r
,

459 .
	gco_obj_İs
 = &
şass_obj_İs
,

462 
__š™
 
	$şass_š™
()

464 
	`¹Æ_tc_ty³_»gi¡”
(&
şass_İs
);

465 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_şass_İs
);

466 
	}
}

468 
__ex™
 
	$şass_ex™
()

470 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_şass_İs
);

471 
	`¹Æ_tc_ty³_uÄegi¡”
(&
şass_İs
);

472 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/classid.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk/rou‹/tc.h
>

24 
	sşassid_m­


26 
ušt32_t
 
	mşassid
;

27 * 
	mÇme
;

28 
Æ_li¡_h—d
 
	mÇme_li¡
;

31 
	#CLASSID_NAME_HT_SIZ
 256

	)

33 
Æ_li¡_h—d
 
	gtbl_Çme
[
CLASSID_NAME_HT_SIZ
];

35 *
	gid_roÙ
 = 
NULL
;

37 
	$com·»_id
(cÚ¡ *
·
, cÚ¡ *
pb
)

39 cÚ¡ 
şassid_m­
 *
ma
 = 
·
;

40 cÚ¡ 
şassid_m­
 *
mb
 = 
pb
;

42 ià(
ma
->
şassid
 < 
mb
->classid)

45 ià(
ma
->
şassid
 > 
mb
->classid)

49 
	}
}

52 
	$şassid_tbl_hash
(cÚ¡ *
¡r
)

54 
hash
 = 5381;

55 
c
;

57 (
c
 = *
¡r
++))

58 
hash
 = ((hash << 5è+ hashè+ 
c
;

60  
hash
 % 
CLASSID_NAME_HT_SIZ
;

61 
	}
}

63 
	$şassid_lookup
(cÚ¡ *
Çme
, 
ušt32_t
 *
»suÉ
)

65 
şassid_m­
 *
m­
;

66 
n
 = 
	`şassid_tbl_hash
(
Çme
);

68 
	`Æ_li¡_fÜ_—ch_’Œy
(
m­
, &
tbl_Çme
[
n
], 
Çme_li¡
) {

69 ià(!
	`¡rÿ£cmp
(
m­
->
Çme
,‚ame)) {

70 *
»suÉ
 = 
m­
->
şassid
;

75  -
NLE_OBJ_NOTFOUND
;

76 
	}
}

78 *
	$Çme_lookup
(cÚ¡ 
ušt32_t
 
şassid
)

80 *
»s
;

81 
şassid_m­
 
cm
 = {

82 .
şassid
 = classid,

83 .
Çme
 = "searchƒntry",

86 ià((
»s
 = 
	`tfšd
(&
cm
, &
id_roÙ
, &
com·»_id
)))

87  (*(
şassid_m­
 **è
»s
)->
Çme
;

89  
NULL
;

90 
	}
}

109 *
	$¹Æ_tc_hªdË2¡r
(
ušt32_t
 
hªdË
, *
buf
, 
size_t
 
Ën
)

111 ià(
TC_H_ROOT
 =ğ
hªdË
)

112 
	`¢´štf
(
buf
, 
Ën
, "root");

113 ià(
TC_H_UNSPEC
 =ğ
hªdË
)

114 
	`¢´štf
(
buf
, 
Ën
, "none");

115 ià(
TC_H_INGRESS
 =ğ
hªdË
)

116 
	`¢´štf
(
buf
, 
Ën
, "ingress");

118 *
Çme
;

120 ià((
Çme
 = 
	`Çme_lookup
(
hªdË
)))

121 
	`¢´štf
(
buf
, 
Ën
, "%s", 
Çme
);

122 ià(0 =ğ
	`TC_H_MAJ
(
hªdË
))

123 
	`¢´štf
(
buf
, 
Ën
, ":%x", 
	`TC_H_MIN
(
hªdË
));

124 ià(0 =ğ
	`TC_H_MIN
(
hªdË
))

125 
	`¢´štf
(
buf
, 
Ën
, "%x:", 
	`TC_H_MAJ
(
hªdË
) >> 16);

127 
	`¢´štf
(
buf
, 
Ën
, "%x:%x",

128 
	`TC_H_MAJ
(
hªdË
è>> 16, 
	`TC_H_MIN
(handle));

131  
buf
;

132 
	}
}

154 
	$¹Æ_tc_¡r2hªdË
(cÚ¡ *
¡r
, 
ušt32_t
 *
»s
)

156 *
cŞÚ
, *
’d
;

157 
ušt32_t
 
h
;

158 
”r
;

160 ià(!
	`¡rÿ£cmp
(
¡r
, "root")) {

161 *
»s
 = 
TC_H_ROOT
;

165 ià(!
	`¡rÿ£cmp
(
¡r
, "none")) {

166 *
»s
 = 
TC_H_UNSPEC
;

170 ià(!
	`¡rÿ£cmp
(
¡r
, "ingress")) {

171 *
»s
 = 
TC_H_INGRESS
;

175 
h
 = 
	`¡¹oul
(
¡r
, &
cŞÚ
, 16);

178 ià(
cŞÚ
 =ğ
¡r
) {

179 
nÙ_a_numb”
:

180 ià(*
cŞÚ
 == ':') {

182 
h
 = 0;

184 
size_t
 
Ën
;

185 
Çme
[64] = { 0 };

187 ià(!(
cŞÚ
 = 
	`¡½brk
(
¡r
, ":"))) {

189  
	`şassid_lookup
(
¡r
, 
»s
);

192 
Ën
 = 
cŞÚ
 - 
¡r
;

193 ià(
Ën
 >ğ(
Çme
))

194  -
NLE_INVAL
;

196 
	`memıy
(
Çme
, 
¡r
, 
Ën
);

198 ià((
”r
 = 
	`şassid_lookup
(
Çme
, &
h
)) < 0)

199  
”r
;

202 ià(
	`TC_H_MIN
(
h
))

203  -
NLE_INVAL
;

206 ià(
cŞÚ
[1] == '\0')

207  -
NLE_INVAL
;

209 
upd©e
;

214 ià(':' =ğ*
cŞÚ
) {

216 ià(
	`TC_H_MAJ
(
h
))

217  -
NLE_RANGE
;

218 
h
 <<= 16;

220 ià('\0' =ğ
cŞÚ
[1]) {

222 *
»s
 = 
h
;

225 
ušt32_t
 
l
;

227 
upd©e
:

228 
l
 = 
	`¡¹oul
(
cŞÚ
+1, &
’d
, 16);

231 ià(
	`TC_H_MAJ
(
l
))

232  -
NLE_RANGE
;

234 ià('\0' !ğ*
’d
)

235  -
NLE_INVAL
;

237 *
»s
 = (
h
 | 
l
);

239 } ià('\0' =ğ*
cŞÚ
) {

241 *
»s
 = 
h
;

243 
nÙ_a_numb”
;

246 
	}
}

248 
	$ä“_nÙhšg
(*
¬g
)

250 
	}
}

252 
	$şassid_m­_ä“
(
şassid_m­
 *
m­
)

254 ià(!
m­
)

257 
	`ä“
(
m­
->
Çme
);

258 
	`ä“
(
m­
);

259 
	}
}

261 
	$ş—r_hashbË
()

263 
i
;

265 
i
 = 0; i < 
CLASSID_NAME_HT_SIZ
; i++) {

266 
şassid_m­
 *
m­
, *
n
;

268 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
m­
, 
n
, &
tbl_Çme
[
i
], 
Çme_li¡
)

269 
	`şassid_m­_ä“
(
m­
);

271 
	`Æ_š™_li¡_h—d
(&
tbl_Çme
[
i
]);

275 ià(
id_roÙ
) {

276 
	`tde¡roy
(&
id_roÙ
, &
ä“_nÙhšg
);

277 
id_roÙ
 = 
NULL
;

279 
	}
}

281 
	$şassid_m­_add
(
ušt32_t
 
şassid
, cÚ¡ *
Çme
)

283 
şassid_m­
 *
m­
;

284 
n
;

286 ià(!(
m­
 = 
	`ÿÎoc
(1, (*map))))

287  -
NLE_NOMEM
;

289 
m­
->
şassid
 = classid;

290 
m­
->
Çme
 = 
	`¡rdup
(name);

292 
n
 = 
	`şassid_tbl_hash
(
m­
->
Çme
);

293 
	`Æ_li¡_add_
(&
m­
->
Çme_li¡
, &
tbl_Çme
[
n
]);

295 ià(!
	`t£¬ch
((*è
m­
, &
id_roÙ
, &
com·»_id
)) {

296 
	`şassid_m­_ä“
(
m­
);

297  -
NLE_NOMEM
;

301 
	}
}

311 
	$¹Æ_tc_»ad_şassid_fe
()

313 
time_t
 
Ï¡_»ad
;

314 
¡©
 
¡
;

315 
buf
[256], *
·th
;

316 
FILE
 *
fd
;

317 
”r
;

319 ià(
	`bud_syscÚf_·th
(&
·th
, "classid") < 0)

320  -
NLE_NOMEM
;

323 ià(
	`¡©
(
·th
, &
¡
) == 0) {

325 ià(
Ï¡_»ad
 =ğ
¡
.
¡_mtime
) {

326 
”r
 = 0;

327 
”rout
;

331 ià(!(
fd
 = 
	`fİ’
(
·th
, "r"))) {

332 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”ºo
);

333 
”rout
;

336 
	`ş—r_hashbË
();

338 
	`fg‘s
(
buf
, (buf), 
fd
)) {

339 
ušt32_t
 
şassid
;

340 *
±r
, *
tok
;

343 ià(*
buf
 == '#' || *buf == '\n' || *buf == '\r')

347 ià(!(
tok
 = 
	`¡¹ok_r
(
buf
, " \t", &
±r
))) {

348 
”r
 = -
NLE_INVAL
;

349 
”rout_şo£
;

352 ià((
”r
 = 
	`¹Æ_tc_¡r2hªdË
(
tok
, &
şassid
)) < 0)

353 
”rout_şo£
;

355 ià(!(
tok
 = 
	`¡¹ok_r
(
NULL
, " \t\n\r#", &
±r
))) {

356 
”r
 = -
NLE_INVAL
;

357 
”rout_şo£
;

360 ià((
”r
 = 
	`şassid_m­_add
(
şassid
, 
tok
)) < 0)

361 
”rout_şo£
;

364 
”r
 = 0;

365 
Ï¡_»ad
 = 
¡
.
¡_mtime
;

367 
”rout_şo£
:

368 
	`fşo£
(
fd
);

369 
”rout
:

370 
	`ä“
(
·th
);

372  
”r
;

374 
	}
}

376 
	$¹Æ_şassid_g’”©e
(cÚ¡ *
Çme
, 
ušt32_t
 *
»suÉ
, ušt32_ˆ
·»Á
)

378 
ušt32_t
 
ba£
 = 0x4000 << 16;

379 
ušt32_t
 
şassid
;

380 *
·th
;

381 
FILE
 *
fd
;

382 
”r
 = 0;

384 ià(
·»Á
 =ğ
TC_H_ROOT
 ||…¬’ˆ=ğ
TC_H_INGRESS
) {

386 
ba£
 += (1 << 16);

387 ià(
ba£
 =ğ
	`TC_H_MAJ
(
TC_H_ROOT
))

388 
ba£
 = 0x4000 << 16;

389 } 
	`Çme_lookup
(
ba£
));

391 
şassid
 = 
ba£
;

393 
şassid
 = 
	`TC_H_MAJ
(
·»Á
);

395 ià(
	`TC_H_MIN
(++
şassid
è=ğTC_H_MIN(
TC_H_ROOT
))

396  -
NLE_RANGE
;

397 } 
	`Çme_lookup
(
şassid
));

400 
	`NL_DBG
(2, "G’”©ed‚ew cÏssid %#x\n", 
şassid
);

402 ià(
	`bud_syscÚf_·th
(&
·th
, "classid") < 0)

403  -
NLE_NOMEM
;

405 ià(!(
fd
 = 
	`fİ’
(
·th
, "a"))) {

406 
”r
 = -
	`Æ_sy£¼2Æ”r
(
”ºo
);

407 
”rout
;

410 
	`årštf
(
fd
, "%x:", 
	`TC_H_MAJ
(
şassid
) >> 16);

411 ià(
	`TC_H_MIN
(
şassid
))

412 
	`årštf
(
fd
, "%x", 
	`TC_H_MIN
(
şassid
));

413 
	`årštf
(
fd
, "\t\t\t%s\n", 
Çme
);

415 
	`fşo£
(
fd
);

417 ià((
”r
 = 
	`şassid_m­_add
(
şassid
, 
Çme
)) < 0) {

423 
	`¹Æ_tc_»ad_şassid_fe
();

426 *
»suÉ
 = 
şassid
;

427 
”r
 = 0;

428 
”rout
:

429 
	`ä“
(
·th
);

431  
”r
;

432 
	}
}

436 
__š™
 
	$şassid_š™
()

438 
”r
, 
i
;

440 
i
 = 0; i < 
CLASSID_NAME_HT_SIZ
; i++)

441 
	`Æ_š™_li¡_h—d
(&
tbl_Çme
[
i
]);

443 ià((
”r
 = 
	`¹Æ_tc_»ad_şassid_fe
()) < 0)

444 
	`NL_DBG
(1, "FaedØ»ad cÏssid fe: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

445 
	}
}

447 
	$ä“_m­
(*
m­
) {

448 
	`ä“
(((
şassid_m­
 *)
m­
)->
Çme
);

449 
	`ä“
(
m­
);

450 
	}
};

452 
__ex™
 
	$şassid_ex™
()

454 
	`tde¡roy
(
id_roÙ
, 
ä“_m­
);

455 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

23 
	~<Ãšk/rou‹/şassif›r.h
>

24 
	~<Ãšk/rou‹/lšk.h
>

27 
	#CLS_ATTR_PRIO
 (
TCA_ATTR_MAX
 << 1)

	)

28 
	#CLS_ATTR_PROTOCOL
 (
TCA_ATTR_MAX
 << 2)

	)

31 
Æ_objeù_İs
 
	gşs_obj_İs
;

32 
Æ_ÿche_İs
 
	g¹Æ_şs_İs
;

35 
	$şs_bud
(
¹Æ_şs
 *
şs
, 
ty³
, 
æags
,

36 
Æ_msg
 **
»suÉ
)

38 
”r
, 
´io
, 
´Ùo
;

39 
tcmsg
 *
tchdr
;

40 
ušt32_t
 
»quœed
 = 
TCA_ATTR_IFINDEX
;

42 ià((
şs
->
û_mask
 & 
»quœed
) !=„equired) {

43 
	`APPBUG
("ifindex must be specified");

44  -
NLE_MISSING_ATTR
;

47 
”r
 = 
	`¹Æ_tc_msg_bud
(
	`TC_CAST
(
şs
), 
ty³
, 
æags
, 
»suÉ
);

48 ià(
”r
 < 0)

49  
”r
;

51 
tchdr
 = 
	`Æmsg_d©a
(
	`Æmsg_hdr
(*
»suÉ
));

52 
´io
 = 
	`¹Æ_şs_g‘_´io
(
şs
);

53 
´Ùo
 = 
	`¹Æ_şs_g‘_´ÙocŞ
(
şs
);

54 
tchdr
->
tcm_šfo
 = 
	`TC_H_MAKE
(
´io
 << 16, 
	`htÚs
(
´Ùo
));

57 
	}
}

64 
¹Æ_şs
 *
	$¹Æ_şs_®loc
()

66 
¹Æ_tc
 *
tc
;

68 
tc
 = 
	`TC_CAST
(
	`Æ_objeù_®loc
(&
şs_obj_İs
));

69 ià(
tc
)

70 
tc
->
tc_ty³
 = 
RTNL_TC_TYPE_CLS
;

72  (
¹Æ_şs
 *è
tc
;

73 
	}
}

75 
	$¹Æ_şs_put
(
¹Æ_şs
 *
şs
)

77 
	`Æ_objeù_put
((
Æ_objeù
 *è
şs
);

78 
	}
}

87 
	$¹Æ_şs_£t_´io
(
¹Æ_şs
 *
şs
, 
ušt16_t
 
´io
)

89 
şs
->
c_´io
 = 
´io
;

90 
şs
->
û_mask
 |ğ
CLS_ATTR_PRIO
;

91 
	}
}

93 
ušt16_t
 
	$¹Æ_şs_g‘_´io
(
¹Æ_şs
 *
şs
)

95 ià(
şs
->
û_mask
 & 
CLS_ATTR_PRIO
)

96  
şs
->
c_´io
;

99 
	}
}

101 
	$¹Æ_şs_£t_´ÙocŞ
(
¹Æ_şs
 *
şs
, 
ušt16_t
 
´ÙocŞ
)

103 
şs
->
c_´ÙocŞ
 = 
´ÙocŞ
;

104 
şs
->
û_mask
 |ğ
CLS_ATTR_PROTOCOL
;

105 
	}
}

107 
ušt16_t
 
	$¹Æ_şs_g‘_´ÙocŞ
(
¹Æ_şs
 *
şs
)

109 ià(
şs
->
û_mask
 & 
CLS_ATTR_PROTOCOL
)

110  
şs
->
c_´ÙocŞ
;

112  
ETH_P_ALL
;

113 
	}
}

137 
	$¹Æ_şs_bud_add_»que¡
(
¹Æ_şs
 *
şs
, 
æags
,

138 
Æ_msg
 **
»suÉ
)

140 ià(!(
æags
 & 
NLM_F_CREATE
è&& !(
şs
->
û_mask
 & 
CLS_ATTR_PRIO
)) {

141 
	`APPBUG
("prio must be specified if‚ot‡‚ew classifier");

142  -
NLE_MISSING_ATTR
;

145  
	`şs_bud
(
şs
, 
RTM_NEWTFILTER
, 
æags
, 
»suÉ
);

146 
	}
}

184 
	$¹Æ_şs_add
(
Æ_sock
 *
sk
, 
¹Æ_şs
 *
şs
, 
æags
)

186 
Æ_msg
 *
msg
;

187 
”r
;

189 ià((
”r
 = 
	`¹Æ_şs_bud_add_»que¡
(
şs
, 
æags
, &
msg
)) < 0)

190  
”r
;

192  
	`Æ_£nd_sync
(
sk
, 
msg
);

193 
	}
}

208 
	$¹Æ_şs_bud_chªge_»que¡
(
¹Æ_şs
 *
şs
, 
æags
,

209 
Æ_msg
 **
»suÉ
)

211  
	`şs_bud
(
şs
, 
RTM_NEWTFILTER
, 
NLM_F_REPLACE
 | 
æags
, 
»suÉ
);

212 
	}
}

226 
	$¹Æ_şs_chªge
(
Æ_sock
 *
sk
, 
¹Æ_şs
 *
şs
, 
æags
)

228 
Æ_msg
 *
msg
;

229 
”r
;

231 ià((
”r
 = 
	`¹Æ_şs_bud_chªge_»que¡
(
şs
, 
æags
, &
msg
)) < 0)

232  
”r
;

234  
	`Æ_£nd_sync
(
sk
, 
msg
);

235 
	}
}

251 
	$¹Æ_şs_bud_d–‘e_»que¡
(
¹Æ_şs
 *
şs
, 
æags
,

252 
Æ_msg
 **
»suÉ
)

254 
ušt32_t
 
»quœed
 = 
CLS_ATTR_PRIO
;

256 ià((
şs
->
û_mask
 & 
»quœed
) !=„equired) {

257 
	`APPBUG
("prio must be specified");

258  -
NLE_MISSING_ATTR
;

261  
	`şs_bud
(
şs
, 
RTM_DELTFILTER
, 
æags
, 
»suÉ
);

262 
	}
}

295 
	$¹Æ_şs_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_şs
 *
şs
, 
æags
)

297 
Æ_msg
 *
msg
;

298 
”r
;

300 ià((
”r
 = 
	`¹Æ_şs_bud_d–‘e_»que¡
(
şs
, 
æags
, &
msg
)) < 0)

301  
”r
;

303  
	`Æ_£nd_sync
(
sk
, 
msg
);

304 
	}
}

327 
	$¹Æ_şs_®loc_ÿche
(
Æ_sock
 *
sk
, 
ifšdex
, 
ušt32_t
 
·»Á
, 
Æ_ÿche
 **
»suÉ
)

329 
Æ_ÿche
 * 
ÿche
;

330 
”r
;

332 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(&
¹Æ_şs_İs
)))

333  -
NLE_NOMEM
;

335 
ÿche
->
c_Ÿrg1
 = 
ifšdex
;

336 
ÿche
->
c_Ÿrg2
 = 
·»Á
;

338 ià(
sk
 && (
”r
 = 
	`Æ_ÿche_»fl
(sk, 
ÿche
)) < 0) {

339 
	`Æ_ÿche_ä“
(
ÿche
);

340  
”r
;

343 *
»suÉ
 = 
ÿche
;

345 
	}
}

349 
	$şs_dump_lše
(
¹Æ_tc
 *
tc
, 
Æ_dump_·¿ms
 *
p
)

351 
¹Æ_şs
 *
şs
 = (¹Æ_ş *è
tc
;

352 
buf
[32];

354 
	`Æ_dump
(
p
, "…riØ%u…rÙocŞ %s", 
şs
->
c_´io
,

355 
	`Æ_‘h”_´Ùo2¡r
(
şs
->
c_´ÙocŞ
, 
buf
, (buf)));

356 
	}
}

358 
	$şs_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

359 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

361 
¹Æ_şs
 *
şs
;

362 
”r
;

364 ià(!(
şs
 = 
	`¹Æ_şs_®loc
()))

365  -
NLE_NOMEM
;

367 ià((
”r
 = 
	`¹Æ_tc_msg_·r£
(
Æh
, 
	`TC_CAST
(
şs
))) < 0)

368 
”rout
;

370 
şs
->
c_´io
 = 
	`TC_H_MAJ
(şs->
c_šfo
) >> 16;

371 ià(
şs
->
c_´io
)

372 
şs
->
û_mask
 |ğ
CLS_ATTR_PRIO
;

373 
şs
->
c_´ÙocŞ
 = 
	`Áohs
(
	`TC_H_MIN
(şs->
c_šfo
));

374 ià(
şs
->
c_´ÙocŞ
)

375 
şs
->
û_mask
 |ğ
CLS_ATTR_PROTOCOL
;

377 
”r
 = 
µ
->
	`µ_cb
(
	`OBJ_CAST
(
şs
),…p);

378 
”rout
:

379 
	`¹Æ_şs_put
(
şs
);

381  
”r
;

382 
	}
}

384 
	$şs_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

386 
tcmsg
 
tchdr
 = {

387 .
tcm_çmy
 = 
AF_UNSPEC
,

388 .
tcm_ifšdex
 = 
ÿche
->
c_Ÿrg1
,

389 .
tcm_·»Á
 = 
ÿche
->
c_Ÿrg2
,

392  
	`Æ_£nd_sim¶e
(
sk
, 
RTM_GETTFILTER
, 
NLM_F_DUMP
, &
tchdr
,

393 (
tchdr
));

394 
	}
}

396 
¹Æ_tc_ty³_İs
 
	gşs_İs
 = {

397 .
‰_ty³
 = 
RTNL_TC_TYPE_CLS
,

398 .
	g‰_dump_´efix
 = "cls",

399 .
	g‰_dump
 = {

400 [
NL_DUMP_LINE
] = 
şs_dump_lše
,

404 
Æ_ÿche_İs
 
	g¹Æ_şs_İs
 = {

405 .
co_Çme
 = "route/cls",

406 .
	gco_hdrsize
 = (
tcmsg
),

407 .
	gco_msgty³s
 = {

408 { 
RTM_NEWTFILTER
, 
NL_ACT_NEW
, "new" },

409 { 
RTM_DELTFILTER
, 
NL_ACT_DEL
, "del" },

410 { 
RTM_GETTFILTER
, 
NL_ACT_GET
, "get" },

411 
END_OF_MSGTYPES_LIST
,

413 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

414 .
	gco_groups
 = 
tc_groups
,

415 .
	gco_»que¡_upd©e
 = 
şs_»que¡_upd©e
,

416 .
	gco_msg_·r£r
 = 
şs_msg_·r£r
,

417 .
	gco_obj_İs
 = &
şs_obj_İs
,

420 
Æ_objeù_İs
 
	gşs_obj_İs
 = {

421 .
oo_Çme
 = "route/cls",

422 .
	goo_size
 = (
¹Æ_şs
),

423 .
	goo_ä“_d©a
 = 
¹Æ_tc_ä“_d©a
,

424 .
	goo_şÚe
 = 
¹Æ_tc_şÚe
,

425 .
	goo_dump
 = {

426 [
NL_DUMP_LINE
] = 
¹Æ_tc_dump_lše
,

427 [
NL_DUMP_DETAILS
] = 
¹Æ_tc_dump_d‘as
,

428 [
NL_DUMP_STATS
] = 
¹Æ_tc_dump_¡©s
,

430 .
	goo_com·»
 = 
¹Æ_tc_com·»
,

431 .
	goo_id_©Œs
 = (
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
),

434 
__š™
 
	$şs_š™
()

436 
	`¹Æ_tc_ty³_»gi¡”
(&
şs_İs
);

437 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_şs_İs
);

438 
	}
}

440 
__ex™
 
	$şs_ex™
()

442 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_şs_İs
);

443 
	`¹Æ_tc_ty³_uÄegi¡”
(&
şs_İs
);

444 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/basic.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk-´iv©e/tc.h
>

27 
	~<Ãšk/Ãšk.h
>

28 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

29 
	~<Ãšk/rou‹/şassif›r.h
>

30 
	~<Ãšk/rou‹/aùiÚ.h
>

31 
	~<Ãšk/rou‹/şs/basic.h
>

32 
	~<Ãšk/rou‹/şs/em©ch.h
>

34 
	s¹Æ_basic


36 
ušt32_t
 
	mb_rg‘
;

37 
¹Æ_em©ch_Œ“
 * 
	mb_em©ch
;

38 
	mb_mask
;

39 
¹Æ_aù
 * 
	mb_aù
;

43 
	#BASIC_ATTR_TARGET
 0x001

	)

44 
	#BASIC_ATTR_EMATCH
 0x002

	)

45 
	#BASIC_ATTR_ACTION
 0x004

	)

48 
Æa_pŞicy
 
	gbasic_pŞicy
[
TCA_BASIC_MAX
+1] = {

49 [
TCA_BASIC_CLASSID
] = { .
ty³
 = 
NLA_U32
 },

50 [
TCA_BASIC_EMATCHES
] = { .
ty³
 = 
NLA_NESTED
 },

53 
	$basic_şÚe
(*
_d¡
, *
_¤c
)

55  -
NLE_OPNOTSUPP
;

56 
	}
}

58 
	$basic_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

60 
¹Æ_basic
 *
b
 = 
d©a
;

62 ià(!
b
)

65 ià(
b
->
b_aù
)

66 
	`¹Æ_aù_put_®l
(&
b
->
b_aù
);

67 
	`¹Æ_em©ch_Œ“_ä“
(
b
->
b_em©ch
);

68 
	}
}

70 
	$basic_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

72 
Æ©Œ
 *
tb
[
TCA_BASIC_MAX
 + 1];

73 
¹Æ_basic
 *
b
 = 
d©a
;

74 
”r
;

76 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_BASIC_MAX
, 
tc
, 
basic_pŞicy
);

77 ià(
”r
 < 0)

78  
”r
;

80 ià(
tb
[
TCA_BASIC_CLASSID
]) {

81 
b
->
b_rg‘
 = 
	`Æa_g‘_u32
(
tb
[
TCA_BASIC_CLASSID
]);

82 
b
->
b_mask
 |ğ
BASIC_ATTR_TARGET
;

85 ià(
tb
[
TCA_BASIC_EMATCHES
]) {

86 ià((
”r
 = 
	`¹Æ_em©ch_·r£_©Œ
(
tb
[
TCA_BASIC_EMATCHES
],

87 &
b
->
b_em©ch
)) < 0)

88  
”r
;

90 ià(
b
->
b_em©ch
)

91 
b
->
b_mask
 |ğ
BASIC_ATTR_EMATCH
;

93 ià(
tb
[
TCA_BASIC_ACT
]) {

94 
b
->
b_mask
 |ğ
BASIC_ATTR_ACTION
;

95 
”r
 = 
	`¹Æ_aù_·r£
(&
b
->
b_aù
, 
tb
[
TCA_BASIC_ACT
]);

96 ià(
”r
)

97  
”r
;

101 
	}
}

103 
	$basic_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

104 
Æ_dump_·¿ms
 *
p
)

106 
¹Æ_basic
 *
b
 = 
d©a
;

107 
buf
[32];

109 ià(!
b
)

112 ià(
b
->
b_mask
 & 
BASIC_ATTR_EMATCH
)

113 
	`Æ_dump
(
p
, "ƒmatch");

115 
	`Æ_dump
(
p
, " match-all");

117 ià(
b
->
b_mask
 & 
BASIC_ATTR_TARGET
)

118 
	`Æ_dump
(
p
, "arget %s",

119 
	`¹Æ_tc_hªdË2¡r
(
b
->
b_rg‘
, 
buf
, (buf)));

120 
	}
}

122 
	$basic_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

123 
Æ_dump_·¿ms
 *
p
)

125 
¹Æ_basic
 *
b
 = 
d©a
;

127 ià(!
b
)

130 ià(
b
->
b_mask
 & 
BASIC_ATTR_EMATCH
) {

131 
	`Æ_dump_lše
(
p
, "ƒmatch ");

132 
	`¹Æ_em©ch_Œ“_dump
(
b
->
b_em©ch
, 
p
);

134 
	`Æ_dump
(
p
, "no options.\n");

135 
	}
}

137 
	$basic_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
,

138 
Æ_msg
 *
msg
)

140 
¹Æ_basic
 *
b
 = 
d©a
;

142 ià(!
b
)

145 ià(
b
->
b_mask
 & 
BASIC_ATTR_TARGET
)

146 
	`NLA_PUT_U32
(
msg
, 
TCA_BASIC_CLASSID
, 
b
->
b_rg‘
);

148 ià(
b
->
b_mask
 & 
BASIC_ATTR_EMATCH
 &&

149 
	`¹Æ_em©ch_fl_©Œ
(
msg
, 
TCA_BASIC_EMATCHES
, 
b
->
b_em©ch
) < 0)

150 
Æa_put_çu»
;

152 ià(
b
->
b_mask
 & 
BASIC_ATTR_ACTION
) {

153 
”r
;

155 
”r
 = 
	`¹Æ_aù_fl
(
msg
, 
TCA_BASIC_ACT
, 
b
->
b_aù
);

156 ià(
”r
)

157  
”r
;

162 
Æa_put_çu»
:

163  -
NLE_NOMEM
;

164 
	}
}

171 
	$¹Æ_basic_£t_rg‘
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
rg‘
)

173 
¹Æ_basic
 *
b
;

175 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

178 
b
->
b_rg‘
 = 
rg‘
;

179 
b
->
b_mask
 |ğ
BASIC_ATTR_TARGET
;

180 
	}
}

182 
ušt32_t
 
	$¹Æ_basic_g‘_rg‘
(
¹Æ_şs
 *
şs
)

184 
¹Æ_basic
 *
b
;

186 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

189  
b
->
b_rg‘
;

190 
	}
}

192 
	$¹Æ_basic_£t_em©ch
(
¹Æ_şs
 *
şs
, 
¹Æ_em©ch_Œ“
 *
Œ“
)

194 
¹Æ_basic
 *
b
;

196 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

199 ià(
b
->
b_em©ch
) {

200 
	`¹Æ_em©ch_Œ“_ä“
(
b
->
b_em©ch
);

201 
b
->
b_mask
 &ğ~
BASIC_ATTR_EMATCH
;

204 
b
->
b_em©ch
 = 
Œ“
;

206 ià(
Œ“
)

207 
b
->
b_mask
 |ğ
BASIC_ATTR_EMATCH
;

208 
	}
}

210 
¹Æ_em©ch_Œ“
 *
	$¹Æ_basic_g‘_em©ch
(
¹Æ_şs
 *
şs
)

212 
¹Æ_basic
 *
b
;

214 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

215  
NULL
;

217  
b
->
b_em©ch
;

218 
	}
}

220 
	$¹Æ_basic_add_aùiÚ
(
¹Æ_şs
 *
şs
, 
¹Æ_aù
 *
aù
)

222 
¹Æ_basic
 *
b
;

224 ià(!
aù
)

227 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

228  -
NLE_NOMEM
;

230 
b
->
b_mask
 |ğ
BASIC_ATTR_ACTION
;

232 
	`¹Æ_aù_g‘
(
aù
);

233  
	`¹Æ_aù_­³nd
(&
b
->
b_aù
, 
aù
);

234 
	}
}

236 
	$¹Æ_basic_d–_aùiÚ
(
¹Æ_şs
 *
şs
, 
¹Æ_aù
 *
aù
)

238 
¹Æ_basic
 *
b
;

239 
»t
;

241 ià(!
aù
)

244 ià(!(
b
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

245  -
NLE_NOMEM
;

247 ià(!(
b
->
b_mask
 & 
BASIC_ATTR_ACTION
))

248  -
NLE_INVAL
;

249 
»t
 = 
	`¹Æ_aù_»move
(&
b
->
b_aù
, 
aù
);

250 ià(
»t
)

251  
»t
;

253 ià(!
b
->
b_aù
)

254 
b
->
b_mask
 &ğ~
BASIC_ATTR_ACTION
;

255 
	`¹Æ_aù_put
(
aù
);

257 
	}
}

260 
¹Æ_tc_İs
 
	gbasic_İs
 = {

261 .
to_kšd
 = "basic",

262 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLS
,

263 .
	gto_size
 = (
¹Æ_basic
),

264 .
	gto_msg_·r£r
 = 
basic_msg_·r£r
,

265 .
	gto_şÚe
 = 
basic_şÚe
,

266 .
	gto_ä“_d©a
 = 
basic_ä“_d©a
,

267 .
	gto_msg_fl
 = 
basic_msg_fl
,

268 .
	gto_dump
 = {

269 [
NL_DUMP_LINE
] = 
basic_dump_lše
,

270 [
NL_DUMP_DETAILS
] = 
basic_dump_d‘as
,

274 
__š™
 
	$basic_š™
()

276 
	`¹Æ_tc_»gi¡”
(&
basic_İs
);

277 
	}
}

279 
__ex™
 
	$basic_ex™
()

281 
	`¹Æ_tc_uÄegi¡”
(&
basic_İs
);

282 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/cgroup.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/©Œ.h
>

23 
	~<Ãšk/uts.h
>

24 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

25 
	~<Ãšk/rou‹/şassif›r.h
>

26 
	~<Ãšk/rou‹/şs/cgroup.h
>

27 
	~<Ãšk/rou‹/şs/em©ch.h
>

30 
	#CGROUP_ATTR_EMATCH
 0x001

	)

33 
Æa_pŞicy
 
	gcgroup_pŞicy
[
TCA_CGROUP_MAX
+1] = {

34 [
TCA_CGROUP_EMATCHES
] = { .
ty³
 = 
NLA_NESTED
 },

37 
	$cgroup_şÚe
(*
d¡
, *
¤c
)

39  -
NLE_OPNOTSUPP
;

40 
	}
}

42 
	$cgroup_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

44 
¹Æ_cgroup
 *
c
 = 
d©a
;

46 ià(!
c
)

49 
	`¹Æ_em©ch_Œ“_ä“
(
c
->
cg_em©ch
);

50 
	}
}

52 
	$cgroup_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

54 
Æ©Œ
 *
tb
[
TCA_CGROUP_MAX
 + 1];

55 
¹Æ_cgroup
 *
c
 = 
d©a
;

56 
”r
;

58 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_CGROUP_MAX
, 
tc
, 
cgroup_pŞicy
);

59 ià(
”r
 < 0)

60  
”r
;

62 ià(
tb
[
TCA_CGROUP_EMATCHES
]) {

63 ià((
”r
 = 
	`¹Æ_em©ch_·r£_©Œ
(
tb
[
TCA_CGROUP_EMATCHES
],

64 &
c
->
cg_em©ch
)) < 0)

65  
”r
;

66 
c
->
cg_mask
 |ğ
CGROUP_ATTR_EMATCH
;

70 
TODO
:

71 
TCA_CGROUP_ACT
,

72 
TCA_CGROUP_POLICE
,

76 
	}
}

78 
	$cgroup_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

79 
Æ_dump_·¿ms
 *
p
)

81 
¹Æ_cgroup
 *
c
 = 
d©a
;

83 ià(!
c
)

86 ià(
c
->
cg_mask
 & 
CGROUP_ATTR_EMATCH
)

87 
	`Æ_dump
(
p
, "ƒmatch");

89 
	`Æ_dump
(
p
, " match-all");

90 
	}
}

92 
	$cgroup_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

93 
Æ_dump_·¿ms
 *
p
)

95 
¹Æ_cgroup
 *
c
 = 
d©a
;

97 ià(!
c
)

100 ià(
c
->
cg_mask
 & 
CGROUP_ATTR_EMATCH
) {

101 
	`Æ_dump_lše
(
p
, "ƒmatch ");

103 ià(
c
->
cg_em©ch
)

104 
	`¹Æ_em©ch_Œ“_dump
(
c
->
cg_em©ch
, 
p
);

106 
	`Æ_dump
(
p
, "<noree>");

108 
	`Æ_dump
(
p
, "no options");

109 
	}
}

111 
	$cgroup_fl_msg
(
¹Æ_tc
 *
tc
, *
d©a
,

112 
Æ_msg
 *
msg
)

114 
¹Æ_cgroup
 *
c
 = 
d©a
;

116 ià(!
c
)

117 
	`BUG
();

119 ià(!(
tc
->
û_mask
 & 
TCA_ATTR_HANDLE
))

120  -
NLE_MISSING_ATTR
;

122 ià(
c
->
cg_mask
 & 
CGROUP_ATTR_EMATCH
)

123  
	`¹Æ_em©ch_fl_©Œ
(
msg
, 
TCA_CGROUP_EMATCHES
,

124 
c
->
cg_em©ch
);

127 
	}
}

135 
	$¹Æ_cgroup_£t_em©ch
(
¹Æ_şs
 *
şs
, 
¹Æ_em©ch_Œ“
 *
Œ“
)

137 
¹Æ_cgroup
 *
c
;

139 ià(!(
c
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

140 
	`BUG
();

142 ià(
c
->
cg_em©ch
) {

143 
	`¹Æ_em©ch_Œ“_ä“
(
c
->
cg_em©ch
);

144 
c
->
cg_mask
 &ğ~
CGROUP_ATTR_EMATCH
;

147 
c
->
cg_em©ch
 = 
Œ“
;

149 ià(
Œ“
)

150 
c
->
cg_mask
 |ğ
CGROUP_ATTR_EMATCH
;

151 
	}
}

153 
¹Æ_em©ch_Œ“
 *
	$¹Æ_cgroup_g‘_em©ch
(
¹Æ_şs
 *
şs
)

155 
¹Æ_cgroup
 *
c
;

157 ià(!(
c
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

158 
	`BUG
();

160  
c
->
cg_em©ch
;

161 
	}
}

165 
¹Æ_tc_İs
 
	gcgroup_İs
 = {

166 .
to_kšd
 = "cgroup",

167 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLS
,

168 .
	gto_size
 = (
¹Æ_cgroup
),

169 .
	gto_şÚe
 = 
cgroup_şÚe
,

170 .
	gto_msg_·r£r
 = 
cgroup_msg_·r£r
,

171 .
	gto_ä“_d©a
 = 
cgroup_ä“_d©a
,

172 .
	gto_msg_fl
 = 
cgroup_fl_msg
,

173 .
	gto_dump
 = {

174 [
NL_DUMP_LINE
] = 
cgroup_dump_lše
,

175 [
NL_DUMP_DETAILS
] = 
cgroup_dump_d‘as
,

179 
__š™
 
	$cgroup_š™
()

181 
	`¹Æ_tc_»gi¡”
(&
cgroup_İs
);

182 
	}
}

184 
__ex™
 
	$cgroup_ex™
()

186 
	`¹Æ_tc_uÄegi¡”
(&
cgroup_İs
);

187 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/rou‹/şassif›r.h
>

23 
	~<Ãšk/rou‹/şs/em©ch.h
>

24 
	~<Ãšk/rou‹/şs/em©ch/cmp.h
>

26 
	~"em©ch_syÁax.h
"

27 
	~"em©ch_g¿mm¬.h
"

34 
NL_LIST_HEAD
(
em©ch_İs_li¡
);

45 
	$¹Æ_em©ch_»gi¡”
(
¹Æ_em©ch_İs
 *
İs
)

47 ià(
	`¹Æ_em©ch_lookup_İs
(
İs
->
eo_kšd
))

48  -
NLE_EXIST
;

50 
	`NL_DBG
(1, "em©ch moduË \"%s\"„egi¡”ed\n", 
İs
->
eo_Çme
);

52 
	`Æ_li¡_add_
(&
İs
->
eo_li¡
, &
em©ch_İs_li¡
);

55 
	}
}

65 
¹Æ_em©ch_İs
 *
	$¹Æ_em©ch_lookup_İs
(
kšd
)

67 
¹Æ_em©ch_İs
 *
İs
;

69 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
em©ch_İs_li¡
, 
eo_li¡
)

70 ià(
İs
->
eo_kšd
 =ğ
kšd
)

71  
İs
;

73  
NULL
;

74 
	}
}

84 
¹Æ_em©ch_İs
 *
	$¹Æ_em©ch_lookup_İs_by_Çme
(cÚ¡ *
Çme
)

86 
¹Æ_em©ch_İs
 *
İs
;

88 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
em©ch_İs_li¡
, 
eo_li¡
)

89 ià(!
	`¡rÿ£cmp
(
İs
->
eo_Çme
, 
Çme
))

90  
İs
;

92  
NULL
;

93 
	}
}

108 
¹Æ_em©ch
 *
	$¹Æ_em©ch_®loc
()

110 
¹Æ_em©ch
 *
e
;

112 ià(!(
e
 = 
	`ÿÎoc
(1, (*e))))

113  
NULL
;

115 
	`NL_DBG
(2, "®loÿ‹dƒm©ch %p\n", 
e
);

117 
	`NL_INIT_LIST_HEAD
(&
e
->
e_li¡
);

118 
	`NL_INIT_LIST_HEAD
(&
e
->
e_chds
);

120  
e
;

121 
	}
}

130 
	$¹Æ_em©ch_add_chd
(
¹Æ_em©ch
 *
·»Á
,

131 
¹Æ_em©ch
 *
chd
)

133 ià(
·»Á
->
e_kšd
 !ğ
TCF_EM_CONTAINER
)

134  -
NLE_OPNOTSUPP
;

136 
	`NL_DBG
(2, "addedƒmatch %p \"%s\"o container %p\n",

137 
chd
, chd->
e_İs
->
eo_Çme
, 
·»Á
);

139 
	`Æ_li¡_add_
(&
chd
->
e_li¡
, &
·»Á
->
e_chds
);

142 
	}
}

148 
	$¹Æ_em©ch_uÆšk
(
¹Æ_em©ch
 *
em©ch
)

150 
	`NL_DBG
(2, "uÆškedƒm©ch %°äom‡ny†i¡s\n", 
em©ch
);

152 ià(!
	`Æ_li¡_em±y
(&
em©ch
->
e_chds
))

153 
	`NL_DBG
(1, "warning:ƒmatch %p with childs was unlinked\n",

154 
em©ch
);

156 
	`Æ_li¡_d–
(&
em©ch
->
e_li¡
);

157 
	`Æ_š™_li¡_h—d
(&
em©ch
->
e_li¡
);

158 
	}
}

160 
	$¹Æ_em©ch_ä“
(
¹Æ_em©ch
 *
em©ch
)

162 
	`NL_DBG
(2, "ä“dƒm©ch %p\n", 
em©ch
);

163 
	`¹Æ_em©ch_uÆšk
(
em©ch
);

164 
	`ä“
(
em©ch
->
e_d©a
);

165 
	`ä“
(
em©ch
);

166 
	}
}

168 
	$¹Æ_em©ch_£t_İs
(
¹Æ_em©ch
 *
em©ch
, 
¹Æ_em©ch_İs
 *
İs
)

170 ià(
em©ch
->
e_İs
)

171  -
NLE_EXIST
;

173 
em©ch
->
e_İs
 = 
İs
;

174 
em©ch
->
e_kšd
 = 
İs
->
eo_kšd
;

176 ià(
İs
->
eo_d©®’
) {

177 
em©ch
->
e_d©a
 = 
	`ÿÎoc
(1, 
İs
->
eo_d©®’
);

178 ià(!
em©ch
->
e_d©a
)

179  -
NLE_NOMEM
;

181 
em©ch
->
e_d©®’
 = 
İs
->
eo_d©®’
;

185 
	}
}

187 
	$¹Æ_em©ch_£t_kšd
(
¹Æ_em©ch
 *
em©ch
, 
ušt16_t
 
kšd
)

189 
¹Æ_em©ch_İs
 *
İs
;

191 ià(
em©ch
->
e_kšd
)

192  -
NLE_EXIST
;

194 
em©ch
->
e_kšd
 = 
kšd
;

196 ià((
İs
 = 
	`¹Æ_em©ch_lookup_İs
(
kšd
)))

197 
	`¹Æ_em©ch_£t_İs
(
em©ch
, 
İs
);

200 
	}
}

202 
	$¹Æ_em©ch_£t_Çme
(
¹Æ_em©ch
 *
em©ch
, cÚ¡ *
Çme
)

204 
¹Æ_em©ch_İs
 *
İs
;

206 ià(
em©ch
->
e_kšd
)

207  -
NLE_EXIST
;

209 ià(!(
İs
 = 
	`¹Æ_em©ch_lookup_İs_by_Çme
(
Çme
)))

210  -
NLE_OPNOTSUPP
;

212 
	`¹Æ_em©ch_£t_İs
(
em©ch
, 
İs
);

215 
	}
}

217 
	$¹Æ_em©ch_£t_æags
(
¹Æ_em©ch
 *
em©ch
, 
ušt16_t
 
æags
)

219 
em©ch
->
e_æags
 |ğ
æags
;

220 
	}
}

222 
	$¹Æ_em©ch_un£t_æags
(
¹Æ_em©ch
 *
em©ch
, 
ušt16_t
 
æags
)

224 
em©ch
->
e_æags
 &ğ~
æags
;

225 
	}
}

227 
ušt16_t
 
	$¹Æ_em©ch_g‘_æags
(
¹Æ_em©ch
 *
em©ch
)

229  
em©ch
->
e_æags
;

230 
	}
}

232 *
	$¹Æ_em©ch_d©a
(
¹Æ_em©ch
 *
em©ch
)

234  
em©ch
->
e_d©a
;

235 
	}
}

247 
¹Æ_em©ch_Œ“
 *
	$¹Æ_em©ch_Œ“_®loc
(
ušt16_t
 
´ogid
)

249 
¹Æ_em©ch_Œ“
 *
Œ“
;

251 ià(!(
Œ“
 = 
	`ÿÎoc
(1, (*tree))))

252  
NULL
;

254 
	`NL_INIT_LIST_HEAD
(&
Œ“
->
‘_li¡
);

255 
Œ“
->
‘_´ogid
 = 
´ogid
;

257 
	`NL_DBG
(2, "®loÿ‹d‚ewƒm©ch»%p,…rogid=%u\n", 
Œ“
, 
´ogid
);

259  
Œ“
;

260 
	}
}

262 
	$ä“_em©ch_li¡
(
Æ_li¡_h—d
 *
h—d
)

264 
¹Æ_em©ch
 *
pos
, *
Ãxt
;

266 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
pos
, 
Ãxt
, 
h—d
, 
e_li¡
) {

267 ià(!
	`Æ_li¡_em±y
(&
pos
->
e_chds
))

268 
	`ä“_em©ch_li¡
(&
pos
->
e_chds
);

269 
	`¹Æ_em©ch_ä“
(
pos
);

271 
	}
}

279 
	$¹Æ_em©ch_Œ“_ä“
(
¹Æ_em©ch_Œ“
 *
Œ“
)

281 ià(!
Œ“
)

284 
	`ä“_em©ch_li¡
(&
Œ“
->
‘_li¡
);

286 
	`NL_DBG
(2, "F»edƒm©ch»%p\n", 
Œ“
);

288 
	`ä“
(
Œ“
);

289 
	}
}

296 
	$¹Æ_em©ch_Œ“_add
(
¹Æ_em©ch_Œ“
 *
Œ“
,

297 
¹Æ_em©ch
 *
em©ch
)

299 
	`Æ_li¡_add_
(&
em©ch
->
e_li¡
, &
Œ“
->
‘_li¡
);

300 
	}
}

302 
šlše
 
ušt32_t
 
	$cÚš”_»f
(
¹Æ_em©ch
 *
em©ch
)

304  *((
ušt32_t
 *è
	`¹Æ_em©ch_d©a
(
em©ch
));

305 
	}
}

307 
	$lšk_Œ“
(
¹Æ_em©ch
 *
šdex
[], 
nm©ches
, 
pos
,

308 
Æ_li¡_h—d
 *
roÙ
)

310 
¹Æ_em©ch
 *
em©ch
;

311 
i
;

313 
i
 = 
pos
; i < 
nm©ches
; i++) {

314 
em©ch
 = 
šdex
[
i
];

316 
	`Æ_li¡_add_
(&
em©ch
->
e_li¡
, 
roÙ
);

318 ià(
em©ch
->
e_kšd
 =ğ
TCF_EM_CONTAINER
)

319 
	`lšk_Œ“
(
šdex
, 
nm©ches
, 
	`cÚš”_»f
(
em©ch
),

320 &
em©ch
->
e_chds
);

322 ià(!(
em©ch
->
e_æags
 & 
TCF_EM_REL_MASK
))

327  -
NLE_INVAL
;

328 
	}
}

330 
Æa_pŞicy
 
	gŒ“_pŞicy
[
TCA_EMATCH_TREE_MAX
+1] = {

331 [
TCA_EMATCH_TREE_HDR
] = { .
mšËn
=(
tcf_em©ch_Œ“_hdr
) },

332 [
TCA_EMATCH_TREE_LIST
] = { .
ty³
 = 
NLA_NESTED
 },

340 
	$¹Æ_em©ch_·r£_©Œ
(
Æ©Œ
 *
©Œ
, 
¹Æ_em©ch_Œ“
 **
»suÉ
)

342 
Æ©Œ
 *
a
, *
tb
[
TCA_EMATCH_TREE_MAX
+1];

343 
tcf_em©ch_Œ“_hdr
 *
thdr
;

344 
¹Æ_em©ch_Œ“
 *
Œ“
;

345 
¹Æ_em©ch
 **
šdex
;

346 
nm©ches
 = 0, 
”r
, 
»maššg
;

348 
	`NL_DBG
(2, "P¬sšg‡‰ribu‹ %°a em©ch»e\n", 
©Œ
);

350 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
TCA_EMATCH_TREE_MAX
, 
©Œ
, 
Œ“_pŞicy
);

351 ià(
”r
 < 0)

352  
”r
;

354 ià(!
tb
[
TCA_EMATCH_TREE_HDR
])

355  -
NLE_MISSING_ATTR
;

357 
thdr
 = 
	`Æa_d©a
(
tb
[
TCA_EMATCH_TREE_HDR
]);

360 ià(
thdr
->
nm©ches
 == 0) {

361 
	`NL_DBG
(2, "Ignoringƒmptyƒmatch configuration\n");

365 ià(!
tb
[
TCA_EMATCH_TREE_LIST
])

366  -
NLE_MISSING_ATTR
;

368 
	`NL_DBG
(2, "ematchree found with‚matches=%u,…rogid=%u\n",

369 
thdr
->
nm©ches
,hdr->
´ogid
);

376 ià(
thdr
->
nm©ches
 > (
	`Æa_Ën
(
tb
[
TCA_EMATCH_TREE_LIST
]) /

377 
	`Æa_tÙ®_size
((
tcf_em©ch_hdr
))))

378  -
NLE_INVAL
;

380 ià(!(
šdex
 = 
	`ÿÎoc
(
thdr
->
nm©ches
, (
¹Æ_em©ch
 *))))

381  -
NLE_NOMEM
;

383 ià(!(
Œ“
 = 
	`¹Æ_em©ch_Œ“_®loc
(
thdr
->
´ogid
))) {

384 
”r
 = -
NLE_NOMEM
;

385 
”rout
;

388 
	`Æa_fÜ_—ch_Ã¡ed
(
a
, 
tb
[
TCA_EMATCH_TREE_LIST
], 
»maššg
) {

389 
¹Æ_em©ch_İs
 *
İs
;

390 
tcf_em©ch_hdr
 *
hdr
;

391 
¹Æ_em©ch
 *
em©ch
;

392 *
d©a
;

393 
size_t
 
Ën
;

395 
	`NL_DBG
(3, "parsingƒmatch‡ttribute %d,†en=%u\n",

396 
nm©ches
+1, 
	`Æa_Ën
(
a
));

398 ià(
	`Æa_Ën
(
a
è< (*
hdr
)) {

399 
”r
 = -
NLE_INVAL
;

400 
”rout
;

404 ià(
nm©ches
 >ğ
thdr
->nmatches) {

405 
”r
 = -
NLE_RANGE
;

406 
”rout
;

409 
hdr
 = 
	`Æa_d©a
(
a
);

410 
d©a
 = 
	`Æa_d©a
(
a
è+ 
	`NLA_ALIGN
((*
hdr
));

411 
Ën
 = 
	`Æa_Ën
(
a
è- 
	`NLA_ALIGN
((*
hdr
));

413 
	`NL_DBG
(3, "ematch‡ttribute matchid=%u, kind=%u, flags=%u\n",

414 
hdr
->
m©chid
, hdr->
kšd
, hdr->
æags
);

420 ià(
hdr
->
kšd
 =ğ
TCF_EM_CONTAINER
 &&

421 *((
ušt32_t
 *è
d©a
è>ğ
thdr
->
nm©ches
) {

422 
”r
 = -
NLE_INVAL
;

423 
”rout
;

426 ià(!(
em©ch
 = 
	`¹Æ_em©ch_®loc
())) {

427 
”r
 = -
NLE_NOMEM
;

428 
”rout
;

431 
em©ch
->
e_id
 = 
hdr
->
m©chid
;

432 
em©ch
->
e_kšd
 = 
hdr
->
kšd
;

433 
em©ch
->
e_æags
 = 
hdr
->
æags
;

435 ià((
İs
 = 
	`¹Æ_em©ch_lookup_İs
(
hdr
->
kšd
))) {

436 ià(
İs
->
eo_mšËn
 && 
Ën
 < ops->eo_minlen) {

437 
	`¹Æ_em©ch_ä“
(
em©ch
);

438 
”r
 = -
NLE_INVAL
;

439 
”rout
;

442 
	`¹Æ_em©ch_£t_İs
(
em©ch
, 
İs
);

444 ià(
İs
->
eo_·r£
 &&

445 (
”r
 = 
İs
->
	`eo_·r£
(
em©ch
, 
d©a
, 
Ën
)) < 0) {

446 
	`¹Æ_em©ch_ä“
(
em©ch
);

447 
”rout
;

451 
	`NL_DBG
(3, "šdex[%d] = %p\n", 
nm©ches
, 
em©ch
);

452 
šdex
[
nm©ches
++] = 
em©ch
;

455 ià(
nm©ches
 !ğ
thdr
->nmatches) {

456 
”r
 = -
NLE_INVAL
;

457 
”rout
;

460 
”r
 = 
	`lšk_Œ“
(
šdex
, 
nm©ches
, 0, &
Œ“
->
‘_li¡
);

461 ià(
”r
 < 0)

462 
”rout
;

464 
	`ä“
(
šdex
);

465 *
»suÉ
 = 
Œ“
;

469 
”rout
:

470 
	`¹Æ_em©ch_Œ“_ä“
(
Œ“
);

471 
	`ä“
(
šdex
);

472  
”r
;

473 
	}
}

475 
	$dump_em©ch_£qu’û
(
Æ_li¡_h—d
 *
h—d
,

476 
Æ_dump_·¿ms
 *
p
)

478 
¹Æ_em©ch
 *
m©ch
;

480 
	`Æ_li¡_fÜ_—ch_’Œy
(
m©ch
, 
h—d
, 
e_li¡
) {

481 ià(
m©ch
->
e_æags
 & 
TCF_EM_INVERT
)

482 
	`Æ_dump
(
p
, "!");

484 ià(
m©ch
->
e_kšd
 =ğ
TCF_EM_CONTAINER
) {

485 
	`Æ_dump
(
p
, "(");

486 
	`dump_em©ch_£qu’û
(&
m©ch
->
e_chds
, 
p
);

487 
	`Æ_dump
(
p
, ")");

488 } ià(!
m©ch
->
e_İs
) {

489 
	`Æ_dump
(
p
, "[unknowÀem©ch %d]", 
m©ch
->
e_kšd
);

491 ià(
m©ch
->
e_İs
->
eo_dump
)

492 
m©ch
->
e_İs
->
	`eo_dump
(m©ch, 
p
);

494 
	`Æ_dump
(
p
, "[data]");

497 
m©ch
->
e_æags
 & 
TCF_EM_REL_MASK
) {

498 
TCF_EM_REL_AND
:

499 
	`Æ_dump
(
p
, " AND ");

501 
TCF_EM_REL_OR
:

502 
	`Æ_dump
(
p
, " OR ");

509 
	}
}

511 
	$¹Æ_em©ch_Œ“_dump
(
¹Æ_em©ch_Œ“
 *
Œ“
,

512 
Æ_dump_·¿ms
 *
p
)

514 ià(!
Œ“
)

515 
	`BUG
();

517 
	`dump_em©ch_£qu’û
(&
Œ“
->
‘_li¡
, 
p
);

518 
	`Æ_dump
(
p
, "\n");

519 
	}
}

521 
	$upd©e_cÚš”_šdex
(
Æ_li¡_h—d
 *
li¡
, *
šdex
)

523 
¹Æ_em©ch
 *
e
;

525 
	`Æ_li¡_fÜ_—ch_’Œy
(
e
, 
li¡
, 
e_li¡
)

526 
e
->
e_šdex
 = (*
šdex
)++;

528 
	`Æ_li¡_fÜ_—ch_’Œy
(
e
, 
li¡
, 
e_li¡
) {

529 ià(
e
->
e_kšd
 =ğ
TCF_EM_CONTAINER
) {

530 
”r
;

532 ià(
	`Æ_li¡_em±y
(&
e
->
e_chds
))

533  -
NLE_OBJ_NOTFOUND
;

535 *((
ušt32_t
 *è
e
->
e_d©a
èğ*
šdex
;

537 
”r
 = 
	`upd©e_cÚš”_šdex
(&
e
->
e_chds
, 
šdex
);

538 ià(
”r
 < 0)

539  
”r
;

544 
	}
}

546 
	$fl_em©ch_£qu’û
(
Æ_msg
 *
msg
, 
Æ_li¡_h—d
 *
li¡
)

548 
¹Æ_em©ch
 *
e
;

550 
	`Æ_li¡_fÜ_—ch_’Œy
(
e
, 
li¡
, 
e_li¡
) {

551 
tcf_em©ch_hdr
 
m©ch
 = {

552 .
m©chid
 = 
e
->
e_id
,

553 .
kšd
 = 
e
->
e_kšd
,

554 .
æags
 = 
e
->
e_æags
,

556 
Æ©Œ
 *
©Œ
;

557 
”r
 = 0;

559 ià(!(
©Œ
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
e
->
e_šdex
 + 1)))

560  -
NLE_NOMEM
;

562 ià(
	`Æmsg_­³nd
(
msg
, &
m©ch
, (match), 0) < 0)

563  -
NLE_NOMEM
;

565 ià(
e
->
e_İs
->
eo_fl
)

566 
”r
 = 
e
->
e_İs
->
	`eo_fl
Ó, 
msg
);

567 ià(
e
->
e_æags
 & 
TCF_EM_SIMPLE
)

568 
”r
 = 
	`Æmsg_­³nd
(
msg
, 
e
->
e_d©a
, 4, 0);

569 ià(
e
->
e_d©®’
 > 0)

570 
”r
 = 
	`Æmsg_­³nd
(
msg
, 
e
->
e_d©a
,ƒ->
e_d©®’
, 0);

572 
	`NL_DBG
(3, "msg %p:‡ddedƒmatch [%d] id=%d kind=%d flags=%d\n",

573 
msg
, 
e
->
e_šdex
, 
m©ch
.
m©chid
, m©ch.
kšd
, m©ch.
æags
);

575 ià(
”r
 < 0)

576  -
NLE_NOMEM
;

578 
	`Æa_Ã¡_’d
(
msg
, 
©Œ
);

581 
	`Æ_li¡_fÜ_—ch_’Œy
(
e
, 
li¡
, 
e_li¡
) {

582 ià(
e
->
e_kšd
 =ğ
TCF_EM_CONTAINER
 &&

583 
	`fl_em©ch_£qu’û
(
msg
, &
e
->
e_chds
) < 0)

584  -
NLE_NOMEM
;

588 
	}
}

590 
	$¹Æ_em©ch_fl_©Œ
(
Æ_msg
 *
msg
, 
©Œid
,

591 
¹Æ_em©ch_Œ“
 *
Œ“
)

593 
tcf_em©ch_Œ“_hdr
 
thdr
 = {

594 .
´ogid
 = 
Œ“
->
‘_´ogid
,

596 
Æ©Œ
 *
li¡
, *
tİ©Œ
;

597 
”r
, 
šdex
 = 0;

601 
”r
 = 
	`upd©e_cÚš”_šdex
(&
Œ“
->
‘_li¡
, &
šdex
);

602 ià(
”r
 < 0)

603  
”r
;

605 ià(!(
tİ©Œ
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
©Œid
)))

606 
Æa_put_çu»
;

608 
thdr
.
nm©ches
 = 
šdex
;

609 
	`NLA_PUT
(
msg
, 
TCA_EMATCH_TREE_HDR
, (
thdr
), &thdr);

611 ià(!(
li¡
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
TCA_EMATCH_TREE_LIST
)))

612 
Æa_put_çu»
;

614 ià(
	`fl_em©ch_£qu’û
(
msg
, &
Œ“
->
‘_li¡
) < 0)

615 
Æa_put_çu»
;

617 
	`Æa_Ã¡_’d
(
msg
, 
li¡
);

619 
	`Æa_Ã¡_’d
(
msg
, 
tİ©Œ
);

623 
Æa_put_çu»
:

624  -
NLE_NOMEM
;

625 
	}
}

629 
em©ch_·r£
(*, **, 
Æ_li¡_h—d
 *);

631 
	$¹Æ_em©ch_·r£_ex´
(cÚ¡ *
ex´
, **
”½
,

632 
¹Æ_em©ch_Œ“
 **
»suÉ
)

634 
¹Æ_em©ch_Œ“
 *
Œ“
;

635 
YY_BUFFER_STATE
 
buf
 = 
NULL
;

636 
yysÿn_t
 
sÿÂ”
 = 
NULL
;

637 
”r
;

639 
	`NL_DBG
(2, "P¬sšgƒm©chƒx´essiÚ \"%s\"\n", 
ex´
);

641 ià(!(
Œ“
 = 
	`¹Æ_em©ch_Œ“_®loc
(
RTNL_EMATCH_PROGID
)))

642  -
NLE_FAILURE
;

644 ià((
”r
 = 
	`em©ch_Ëx_š™
(&
sÿÂ”
)) < 0) {

645 
”r
 = -
NLE_FAILURE
;

646 
”rout
;

649 
buf
 = 
	`em©ch__sÿn_¡ršg
(
ex´
, 
sÿÂ”
);

651 ià((
”r
 = 
	`em©ch_·r£
(
sÿÂ”
, 
”½
, &
Œ“
->
‘_li¡
)) != 0) {

652 
	`em©ch__d–‘e_bufãr
(
buf
, 
sÿÂ”
);

653 
”r
 = -
NLE_PARSE_ERR
;

654 
”rout
;

657 
	`em©ch_Ëx_de¡roy
(
sÿÂ”
);

658 *
»suÉ
 = 
Œ“
;

662 
”rout
:

663 ià(
sÿÂ”
)

664 
	`em©ch_Ëx_de¡roy
(
sÿÂ”
);

666 
	`¹Æ_em©ch_Œ“_ä“
(
Œ“
);

668  
”r
;

669 
	}
}

671 cÚ¡ *
	gÏy”_txt
[] = {

672 [
TCF_LAYER_LINK
] = "eth",

673 [
TCF_LAYER_NETWORK
] = "ip",

674 [
TCF_LAYER_TRANSPORT
] = "tcp",

677 *
	$¹Æ_em©ch_off£t2txt
(
ušt8_t
 
Ïy”
, 
ušt16_t
 
off£t
, *
buf
, 
size_t
 
Ën
)

679 
	`¢´štf
(
buf
, 
Ën
, "%s+%u",

680 (
Ïy”
 <ğ
TCF_LAYER_MAX
è? 
Ïy”_txt
[layer] : "?",

681 
off£t
);

683  
buf
;

684 
	}
}

686 cÚ¡ *
	gİ”ªd_txt
[] = {

687 [
TCF_EM_OPND_EQ
] = "=",

688 [
TCF_EM_OPND_LT
] = "<",

689 [
TCF_EM_OPND_GT
] = ">",

692 *
	$¹Æ_em©ch_İnd2txt
(
ušt8_t
 
İnd
, *
buf
, 
size_t
 
Ën
)

694 
	`¢´štf
(
buf
, 
Ën
, "%s",

695 
İnd
 < 
	`ARRAY_SIZE
(
İ”ªd_txt
) ? operand_txt[opnd] : "?");

697  
buf
;

698 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch/cmp.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/rou‹/şs/em©ch.h
>

23 
	~<lšux/tc_em©ch/tc_em_cmp.h
>

25 
	$¹Æ_em©ch_cmp_£t
(
¹Æ_em©ch
 *
e
, 
tcf_em_cmp
 *
cfg
)

27 
	`memıy
(
	`¹Æ_em©ch_d©a
(
e
), 
cfg
, (*cfg));

28 
	}
}

30 
tcf_em_cmp
 *
	$¹Æ_em©ch_cmp_g‘
(
¹Æ_em©ch
 *
e
)

32  
	`¹Æ_em©ch_d©a
(
e
);

33 
	}
}

35 
	$cmp_·r£
(
¹Æ_em©ch
 *
e
, *
d©a
, 
size_t
 
Ën
)

37 
	`memıy
(
	`¹Æ_em©ch_d©a
(
e
), 
d©a
, 
Ën
);

40 
	}
}

42 cÚ¡ *
	g®ign_txt
[] = {

43 [
TCF_EM_ALIGN_U8
] = "u8",

44 [
TCF_EM_ALIGN_U16
] = "u16",

45 [
TCF_EM_ALIGN_U32
] = "u32"

48 cÚ¡ *
	gÏy”_txt
[] = {

49 [
TCF_LAYER_LINK
] = "eth",

50 [
TCF_LAYER_NETWORK
] = "ip",

51 [
TCF_LAYER_TRANSPORT
] = "tcp"

54 cÚ¡ *
	gİ”ªd_txt
[] = {

55 [
TCF_EM_OPND_EQ
] = "=",

56 [
TCF_EM_OPND_LT
] = "<",

57 [
TCF_EM_OPND_GT
] = ">",

60 
	$cmp_dump
(
¹Æ_em©ch
 *
e
, 
Æ_dump_·¿ms
 *
p
)

62 
tcf_em_cmp
 *
cmp
 = 
	`¹Æ_em©ch_d©a
(
e
);

64 ià(
cmp
->
æags
 & 
TCF_EM_CMP_TRANS
)

65 
	`Æ_dump
(
p
, "Áoh%c(", (
cmp
->
®ign
 =ğ
TCF_EM_ALIGN_U32
) ? 'l' : 's');

67 
	`Æ_dump
(
p
, "%s‡t %s+%u",

68 
®ign_txt
[
cmp
->
®ign
], 
Ïy”_txt
[cmp->
Ïy”
], cmp->
off
);

70 ià(
cmp
->
mask
)

71 
	`Æ_dump
(
p
, " & 0x%x", 
cmp
->
mask
);

73 ià(
cmp
->
æags
 & 
TCF_EM_CMP_TRANS
)

74 
	`Æ_dump
(
p
, ")");

76 
	`Æ_dump
(
p
, " % %u", 
İ”ªd_txt
[
cmp
->
İnd
], cmp->
v®
);

77 
	}
}

79 
¹Æ_em©ch_İs
 
	gcmp_İs
 = {

80 .
eo_kšd
 = 
TCF_EM_CMP
,

81 .
	geo_Çme
 = "cmp",

82 .
	geo_mšËn
 = (
tcf_em_cmp
),

83 .
	geo_d©®’
 = (
tcf_em_cmp
),

84 .
	geo_·r£
 = 
cmp_·r£
,

85 .
	geo_dump
 = 
cmp_dump
,

88 
__š™
 
	$cmp_š™
()

90 
	`¹Æ_em©ch_»gi¡”
(&
cmp_İs
);

91 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch/container.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk-´iv©e/tc.h
>

14 
	~<Ãšk/Ãšk.h
>

15 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
cÚš”_·r£
(
¹Æ_em©ch
 *
e
, *
d©a
, 
size_t
 
Ën
 
__©Œibu‹__
((
unu£d
)))

25 
memıy
(
e
->
e_d©a
, 
d©a
, (
ušt32_t
));

30 
	$cÚš”_fl
(
¹Æ_em©ch
 *
e
, 
Æ_msg
 *
msg
)

32  
	`Æmsg_­³nd
(
msg
, 
e
->
e_d©a
, (
ušt32_t
), 0);

33 
	}
}

35 
¹Æ_em©ch_İs
 
	gcÚš”_İs
 = {

36 .
eo_kšd
 = 
TCF_EM_CONTAINER
,

37 .
	geo_Çme
 = "container",

38 .
	geo_mšËn
 = (
ušt32_t
),

39 .
	geo_d©®’
 = (
ušt32_t
),

40 .
	geo_·r£
 = 
cÚš”_·r£
,

41 .
	geo_fl
 = 
cÚš”_fl
,

44 
__š™
 
	$cÚš”_š™
()

46 
	`¹Æ_em©ch_»gi¡”
(&
cÚš”_İs
);

47 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch/meta.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/rou‹/şs/em©ch.h
>

23 
	~<Ãšk/rou‹/şs/em©ch/m‘a.h
>

25 
	s¹Æ_m‘a_v®ue


27 
ušt8_t
 
	mmv_ty³
;

28 
ušt8_t
 
	mmv_shiá
;

29 
ušt16_t
 
	mmv_id
;

30 
size_t
 
	mmv_Ën
;

33 
	sm‘a_d©a


35 
¹Æ_m‘a_v®ue
 * 
	mËá
;

36 
¹Æ_m‘a_v®ue
 * 
	mright
;

37 
ušt8_t
 
	mİnd
;

40 
¹Æ_m‘a_v®ue
 *
	$m‘a_®loc
(
ušt8_t
 
ty³
, 
ušt16_t
 
id
,

41 
ušt8_t
 
shiá
, *
d©a
,

42 
size_t
 
Ën
)

44 
¹Æ_m‘a_v®ue
 *
v®ue
;

46 ià(!(
v®ue
 = 
	`ÿÎoc
(1, (*v®ueè+ 
Ën
)))

47  
NULL
;

49 
v®ue
->
mv_ty³
 = 
ty³
;

50 
v®ue
->
mv_id
 = 
id
;

51 
v®ue
->
mv_shiá
 = 
shiá
;

52 
v®ue
->
mv_Ën
 = 
Ën
;

54 
	`memıy
(
v®ue
 + 1, 
d©a
, 
Ën
);

56  
v®ue
;

57 
	}
}

59 
¹Æ_m‘a_v®ue
 *
	$¹Æ_m‘a_v®ue_®loc_št
(
ušt64_t
 
v®ue
)

61  
	`m‘a_®loc
(
TCF_META_TYPE_INT
, 
TCF_META_ID_VALUE
, 0, &
v®ue
, 8);

62 
	}
}

64 
¹Æ_m‘a_v®ue
 *
	$¹Æ_m‘a_v®ue_®loc_v¬
(*
d©a
, 
size_t
 
Ën
)

66  
	`m‘a_®loc
(
TCF_META_TYPE_VAR
, 
TCF_META_ID_VALUE
, 0, 
d©a
, 
Ën
);

67 
	}
}

69 
¹Æ_m‘a_v®ue
 *
	$¹Æ_m‘a_v®ue_®loc_id
(
ušt8_t
 
ty³
, 
ušt16_t
 
id
,

70 
ušt8_t
 
shiá
, 
ušt64_t
 
mask
)

72 
size_t
 
maskËn
 = 0;

74 ià(
id
 > 
TCF_META_ID_MAX
)

75  
NULL
;

77 ià(
mask
) {

78 ià(
ty³
 =ğ
TCF_META_TYPE_VAR
)

79  
NULL
;

81 
maskËn
 = 8;

84  
	`m‘a_®loc
(
ty³
, 
id
, 
shiá
, &
mask
, 
maskËn
);

85 
	}
}

87 
	$¹Æ_m‘a_v®ue_put
(
¹Æ_m‘a_v®ue
 *
mv
)

89 
	`ä“
(
mv
);

90 
	}
}

92 
	$¹Æ_em©ch_m‘a_£t_lv®ue
(
¹Æ_em©ch
 *
e
, 
¹Æ_m‘a_v®ue
 *
v
)

94 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

95 
m
->
Ëá
 = 
v
;

96 
	}
}

98 
	$¹Æ_em©ch_m‘a_£t_rv®ue
(
¹Æ_em©ch
 *
e
, 
¹Æ_m‘a_v®ue
 *
v
)

100 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

101 
m
->
right
 = 
v
;

102 
	}
}

104 
	$¹Æ_em©ch_m‘a_£t_İ”ªd
(
¹Æ_em©ch
 *
e
, 
ušt8_t
 
İnd
)

106 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

107 
m
->
İnd
 = opnd;

108 
	}
}

110 
Æa_pŞicy
 
	gm‘a_pŞicy
[
TCA_EM_META_MAX
+1] = {

111 [
TCA_EM_META_HDR
] = { .
mšËn
 = (
tcf_m‘a_hdr
) },

112 [
TCA_EM_META_LVALUE
] = { .
mšËn
 = 1, },

113 [
TCA_EM_META_RVALUE
] = { .
mšËn
 = 1, },

116 
	$m‘a_·r£
(
¹Æ_em©ch
 *
e
, *
d©a
, 
size_t
 
Ën
)

118 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

119 
Æ©Œ
 *
tb
[
TCA_EM_META_MAX
+1];

120 
¹Æ_m‘a_v®ue
 *
v
;

121 
tcf_m‘a_hdr
 *
hdr
;

122 *
vd©a
 = 
NULL
;

123 
size_t
 
vËn
 = 0;

124 
”r
;

126 ià((
”r
 = 
	`Æa_·r£
(
tb
, 
TCA_EM_META_MAX
, 
d©a
, 
Ën
, 
m‘a_pŞicy
)) < 0)

127  
”r
;

129 ià(!
tb
[
TCA_EM_META_HDR
])

130  -
NLE_MISSING_ATTR
;

132 
hdr
 = 
	`Æa_d©a
(
tb
[
TCA_EM_META_HDR
]);

134 ià(
tb
[
TCA_EM_META_LVALUE
]) {

135 
vd©a
 = 
	`Æa_d©a
(
tb
[
TCA_EM_META_LVALUE
]);

136 
vËn
 = 
	`Æa_Ën
(
tb
[
TCA_EM_META_LVALUE
]);

139 
v
 = 
	`m‘a_®loc
(
	`TCF_META_TYPE
(
hdr
->
Ëá
.
kšd
),

140 
	`TCF_META_ID
(
hdr
->
Ëá
.
kšd
),

141 
hdr
->
Ëá
.
shiá
, 
vd©a
, 
vËn
);

142 ià(!
v
)

143  -
NLE_NOMEM
;

145 
m
->
Ëá
 = 
v
;

147 
vËn
 = 0;

148 ià(
tb
[
TCA_EM_META_RVALUE
]) {

149 
vd©a
 = 
	`Æa_d©a
(
tb
[
TCA_EM_META_RVALUE
]);

150 
vËn
 = 
	`Æa_Ën
(
tb
[
TCA_EM_META_RVALUE
]);

153 
v
 = 
	`m‘a_®loc
(
	`TCF_META_TYPE
(
hdr
->
right
.
kšd
),

154 
	`TCF_META_ID
(
hdr
->
right
.
kšd
),

155 
hdr
->
right
.
shiá
, 
vd©a
, 
vËn
);

156 ià(!
v
) {

157 
	`¹Æ_m‘a_v®ue_put
(
m
->
Ëá
);

158  -
NLE_NOMEM
;

161 
m
->
right
 = 
v
;

162 
m
->
İnd
 = 
hdr
->
Ëá
.
İ
;

165 
	}
}

167 cÚ¡ 
Œªs_tbl
 
	gm‘a_št
[] = {

168 
__ADD
(
TCF_META_ID_RANDOM
, 
¿ndom
)

169 
__ADD
(
TCF_META_ID_LOADAVG_0
, 
lßdavg_0
)

170 
__ADD
(
TCF_META_ID_LOADAVG_1
, 
lßdavg_1
)

171 
__ADD
(
TCF_META_ID_LOADAVG_2
, 
lßdavg_2
)

172 
__ADD
(
TCF_META_ID_DEV
, 
dev
)

173 
__ADD
(
TCF_META_ID_PRIORITY
, 
´io
)

174 
__ADD
(
TCF_META_ID_PROTOCOL
, 
´Ùo
)

175 
__ADD
(
TCF_META_ID_PKTTYPE
, 
pk‰y³
)

176 
__ADD
(
TCF_META_ID_PKTLEN
, 
pk’
)

177 
__ADD
(
TCF_META_ID_DATALEN
, 
d©®’
)

178 
__ADD
(
TCF_META_ID_MACLEN
, 
maş’
)

179 
__ADD
(
TCF_META_ID_NFMARK
, 
m¬k
)

180 
__ADD
(
TCF_META_ID_TCINDEX
, 
tcšdex
)

181 
__ADD
(
TCF_META_ID_RTCLASSID
, 
¹şassid
)

182 
__ADD
(
TCF_META_ID_RTIIF
, 
¹iif
)

183 
__ADD
(
TCF_META_ID_SK_FAMILY
, 
sk_çmy
)

184 
__ADD
(
TCF_META_ID_SK_STATE
, 
sk_¡©e
)

185 
__ADD
(
TCF_META_ID_SK_REUSE
, 
sk_»u£
)

186 
__ADD
(
TCF_META_ID_SK_REFCNT
, 
sk_»fút
)

187 
__ADD
(
TCF_META_ID_SK_RCVBUF
, 
sk_rcvbuf
)

188 
__ADD
(
TCF_META_ID_SK_SNDBUF
, 
sk_¢dbuf
)

189 
__ADD
(
TCF_META_ID_SK_SHUTDOWN
, 
sk_sutdown
)

190 
__ADD
(
TCF_META_ID_SK_PROTO
, 
sk_´Ùo
)

191 
__ADD
(
TCF_META_ID_SK_TYPE
, 
sk_ty³
)

192 
__ADD
(
TCF_META_ID_SK_RMEM_ALLOC
, 
sk_rmem_®loc
)

193 
__ADD
(
TCF_META_ID_SK_WMEM_ALLOC
, 
sk_wmem_®loc
)

194 
__ADD
(
TCF_META_ID_SK_WMEM_QUEUED
, 
sk_wmem_queued
)

195 
__ADD
(
TCF_META_ID_SK_RCV_QLEN
, 
sk_rcv_qËn
)

196 
__ADD
(
TCF_META_ID_SK_SND_QLEN
, 
sk_¢d_qËn
)

197 
__ADD
(
TCF_META_ID_SK_ERR_QLEN
, 
sk_”r_qËn
)

198 
__ADD
(
TCF_META_ID_SK_FORWARD_ALLOCS
, 
sk_fÜw¬d_®locs
)

199 
__ADD
(
TCF_META_ID_SK_ALLOCS
, 
sk_®locs
)

200 
__ADD
(
TCF_META_ID_SK_ROUTE_CAPS
, 
sk_rou‹_ÿps
)

201 
__ADD
(
TCF_META_ID_SK_HASH
, 
sk_hash
)

202 
__ADD
(
TCF_META_ID_SK_LINGERTIME
, 
sk_lšg”time
)

203 
__ADD
(
TCF_META_ID_SK_ACK_BACKLOG
, 
sk_ack_backlog
)

204 
__ADD
(
TCF_META_ID_SK_MAX_ACK_BACKLOG
, 
sk_max_ack_backlog
)

205 
__ADD
(
TCF_META_ID_SK_PRIO
, 
sk_´io
)

206 
__ADD
(
TCF_META_ID_SK_RCVLOWAT
, 
sk_rcvlow©
)

207 
__ADD
(
TCF_META_ID_SK_RCVTIMEO
, 
sk_rcvtimeo
)

208 
__ADD
(
TCF_META_ID_SK_SNDTIMEO
, 
sk_¢dtimeo
)

209 
__ADD
(
TCF_META_ID_SK_SENDMSG_OFF
, 
sk_£ndmsg_off
)

210 
__ADD
(
TCF_META_ID_SK_WRITE_PENDING
, 
sk_wr™e_³ndšg
)

211 
__ADD
(
TCF_META_ID_VLAN_TAG
, 
vÏn
)

212 
__ADD
(
TCF_META_ID_RXHASH
, 
rxhash
)

215 *
	$št_id2¡r
(
id
, *
buf
, 
size_t
 
size
)

217  
	`__ty³2¡r
(
id
, 
buf
, 
size
, 
m‘a_št
, 
	`ARRAY_SIZE
(meta_int));

218 
	}
}

220 cÚ¡ 
Œªs_tbl
 
	gm‘a_v¬
[] = {

221 
__ADD
(
TCF_META_ID_DEV
,
devÇme
)

222 
__ADD
(
TCF_META_ID_SK_BOUND_IF
,
sk_bound_if
)

225 *
	$v¬_id2¡r
(
id
, *
buf
, 
size_t
 
size
)

227  
	`__ty³2¡r
(
id
, 
buf
, 
size
, 
m‘a_v¬
, 
	`ARRAY_SIZE
(meta_var));

228 
	}
}

230 
	$dump_v®ue
(
¹Æ_m‘a_v®ue
 *
v
, 
Æ_dump_·¿ms
 *
p
)

232 
buf
[32];

234 
v
->
mv_ty³
) {

235 
TCF_META_TYPE_INT
:

236 ià(
v
->
mv_id
 =ğ
TCF_META_ID_VALUE
) {

237 
	`Æ_dump
(
p
, "%u",

238 *(
ušt32_t
 *è(
v
 + 1));

240 
	`Æ_dump
(
p
, "%s",

241 
	`št_id2¡r
(
v
->
mv_id
, 
buf
, (buf)));

243 ià(
v
->
mv_shiá
)

244 
	`Æ_dump
(
p
, " >> %u", 
v
->
mv_shiá
);

246 ià(
v
->
mv_Ën
 == 4)

247 
	`Æ_dump
(
p
, " & %#x", *(
ušt32_t
 *è(
v
 + 1));

248 ià(
v
->
mv_Ën
 == 8)

249 
	`Æ_dump
(
p
, " & %#x", *(
ušt64_t
 *è(
v
 + 1));

253 
TCF_META_TYPE_VAR
:

254 ià(
v
->
mv_id
 =ğ
TCF_META_ID_VALUE
) {

255 
	`Æ_dump
(
p
, "%s", (*è(
v
 + 1));

257 
	`Æ_dump
(
p
, "%s",

258 
	`v¬_id2¡r
(
v
->
mv_id
, 
buf
, (buf)));

260 ià(
v
->
mv_shiá
)

261 
	`Æ_dump
(
p
, " >> %u", 
v
->
mv_shiá
);

265 
	}
}

267 
	$m‘a_dump
(
¹Æ_em©ch
 *
e
, 
Æ_dump_·¿ms
 *
p
)

269 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

270 
buf
[32];

272 
	`Æ_dump
(
p
, "meta(");

273 
	`dump_v®ue
(
m
->
Ëá
, 
p
);

275 
	`Æ_dump
(
p
, " % ", 
	`¹Æ_em©ch_İnd2txt
(
m
->
İnd
, 
buf
, (buf)));

277 
	`dump_v®ue
(
m
->
right
, 
p
);

278 
	`Æ_dump
(
p
, ")");

279 
	}
}

281 
	$m‘a_fl
(
¹Æ_em©ch
 *
e
, 
Æ_msg
 *
msg
)

283 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

284 
tcf_m‘a_hdr
 
hdr
;

286 ià(!(
m
->
Ëá
 && m->
right
))

287  -
NLE_MISSING_ATTR
;

289 
	`mem£t
(&
hdr
, 0, (hdr));

290 
hdr
.
Ëá
.
kšd
 = (
m
->Ëá->
mv_ty³
 << 12è& 
TCF_META_TYPE_MASK
;

291 
hdr
.
Ëá
.
kšd
 |ğ
m
->Ëá->
mv_id
 & 
TCF_META_ID_MASK
;

292 
hdr
.
Ëá
.
shiá
 = 
m
->Ëá->
mv_shiá
;

293 
hdr
.
Ëá
.
İ
 = 
m
->
İnd
;

294 
hdr
.
right
.
kšd
 = (
m
->right->
mv_ty³
 << 12è& 
TCF_META_TYPE_MASK
;

295 
hdr
.
right
.
kšd
 |ğ
m
->right->
mv_id
 & 
TCF_META_ID_MASK
;

297 
	`NLA_PUT
(
msg
, 
TCA_EM_META_HDR
, (
hdr
), &hdr);

299 ià(
m
->
Ëá
->
mv_Ën
)

300 
	`NLA_PUT
(
msg
, 
TCA_EM_META_LVALUE
, 
m
->
Ëá
->
mv_Ën
, (m->left + 1));

302 ià(
m
->
right
->
mv_Ën
)

303 
	`NLA_PUT
(
msg
, 
TCA_EM_META_RVALUE
, 
m
->
right
->
mv_Ën
, (m->right + 1));

307 
Æa_put_çu»
:

308  -
NLE_NOMEM
;

309 
	}
}

311 
	$m‘a_ä“
(
¹Æ_em©ch
 *
e
)

313 
m‘a_d©a
 *
m
 = 
	`¹Æ_em©ch_d©a
(
e
);

314 
	`ä“
(
m
->
Ëá
);

315 
	`ä“
(
m
->
right
);

316 
	}
}

318 
¹Æ_em©ch_İs
 
	gm‘a_İs
 = {

319 .
eo_kšd
 = 
TCF_EM_META
,

320 .
	geo_Çme
 = "meta",

321 .
	geo_mšËn
 = (
tcf_m‘a_hdr
),

322 .
	geo_d©®’
 = (
m‘a_d©a
),

323 .
	geo_·r£
 = 
m‘a_·r£
,

324 .
	geo_dump
 = 
m‘a_dump
,

325 .
	geo_fl
 = 
m‘a_fl
,

326 .
	geo_ä“
 = 
m‘a_ä“
,

329 
__š™
 
	$m‘a_š™
()

331 
	`¹Æ_em©ch_»gi¡”
(&
m‘a_İs
);

332 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch/nbyte.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/rou‹/şs/em©ch.h
>

23 
	~<Ãšk/rou‹/şs/em©ch/nby‹.h
>

25 
	snby‹_d©a


27 
tcf_em_nby‹
 
	mcfg
;

28 
ušt8_t
 * 
	m·‰”n
;

31 
	$¹Æ_em©ch_nby‹_£t_off£t
(
¹Æ_em©ch
 *
e
, 
ušt8_t
 
Ïy”
,

32 
ušt16_t
 
off£t
)

34 
nby‹_d©a
 *
n
 = 
	`¹Æ_em©ch_d©a
(
e
);

35 
n
->
cfg
.
off
 = 
off£t
;

36 
n
->
cfg
.
Ïy”
 =†ayer;

37 
	}
}

39 
ušt16_t
 
	$¹Æ_em©ch_nby‹_g‘_off£t
(
¹Æ_em©ch
 *
e
)

41  ((
nby‹_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
off
;

42 
	}
}

44 
ušt8_t
 
	$¹Æ_em©ch_nby‹_g‘_Ïy”
(
¹Æ_em©ch
 *
e
)

46  ((
nby‹_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
Ïy”
;

47 
	}
}

49 
	$¹Æ_em©ch_nby‹_£t_·‰”n
(
¹Æ_em©ch
 *
e
,

50 
ušt8_t
 *
·‰”n
, 
size_t
 
Ën
)

52 
nby‹_d©a
 *
n
 = 
	`¹Æ_em©ch_d©a
(
e
);

54 ià(
n
->
·‰”n
)

55 
	`ä“
(
n
->
·‰”n
);

57 
n
->
·‰”n
 =…attern;

58 
n
->
cfg
.
Ën
 =†en;

59 
	}
}

61 
ušt8_t
 *
	$¹Æ_em©ch_nby‹_g‘_·‰”n
(
¹Æ_em©ch
 *
e
)

63  ((
nby‹_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
·‰”n
;

64 
	}
}

66 
size_t
 
	$¹Æ_em©ch_nby‹_g‘_Ën
(
¹Æ_em©ch
 *
e
)

68  ((
nby‹_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
Ën
;

69 
	}
}

71 cÚ¡ *
	$Ïy”_txt
(
tcf_em_nby‹
 *
nby‹
)

73 
nby‹
->
Ïy”
) {

74 
TCF_LAYER_LINK
:

76 
TCF_LAYER_NETWORK
:

78 
TCF_LAYER_TRANSPORT
:

83 
	}
}

85 
	$nby‹_·r£
(
¹Æ_em©ch
 *
e
, *
d©a
, 
size_t
 
Ën
)

87 
nby‹_d©a
 *
n
 = 
	`¹Æ_em©ch_d©a
(
e
);

88 
size_t
 
hd¾’
 = (
tcf_em_nby‹
);

89 
size_t
 
¶’
 = 
Ën
 - 
hd¾’
;

91 
	`memıy
(&
n
->
cfg
, 
d©a
, 
hd¾’
);

92 ià(
¶’
 > 0) {

93 ià(!(
n
->
·‰”n
 = 
	`ÿÎoc
(1, 
¶’
)))

94  -
NLE_NOMEM
;

96 
	`memıy
(
n
->
·‰”n
, 
d©a
 + 
hd¾’
, 
¶’
);

100 
	}
}

102 
	$nby‹_dump
(
¹Æ_em©ch
 *
e
, 
Æ_dump_·¿ms
 *
p
)

104 
nby‹_d©a
 *
n
 = 
	`¹Æ_em©ch_d©a
(
e
);

105 
i
;

107 
	`Æ_dump
(
p
, "·‰”n(%u:[", 
n
->
cfg
.
Ën
);

109 
i
 = 0; i < 
n
->
cfg
.
Ën
; i++) {

110 
	`Æ_dump
(
p
, "%02x", 
n
->
·‰”n
[
i
]);

111 ià(
i
+1 < 
n
->
cfg
.
Ën
)

112 
	`Æ_dump
(
p
, " ");

115 
	`Æ_dump
(
p
, "]‡ˆ%s+%u)", 
	`Ïy”_txt
(&
n
->
cfg
),‚->cfg.
off
);

116 
	}
}

118 
	$nby‹_ä“
(
¹Æ_em©ch
 *
e
)

120 
nby‹_d©a
 *
n
 = 
	`¹Æ_em©ch_d©a
(
e
);

121 
	`ä“
(
n
->
·‰”n
);

122 
	}
}

124 
¹Æ_em©ch_İs
 
	gnby‹_İs
 = {

125 .
eo_kšd
 = 
TCF_EM_NBYTE
,

126 .
	geo_Çme
 = "nbyte",

127 .
	geo_mšËn
 = (
tcf_em_nby‹
),

128 .
	geo_d©®’
 = (
nby‹_d©a
),

129 .
	geo_·r£
 = 
nby‹_·r£
,

130 .
	geo_dump
 = 
nby‹_dump
,

131 .
	geo_ä“
 = 
nby‹_ä“
,

134 
__š™
 
	$nby‹_š™
()

136 
	`¹Æ_em©ch_»gi¡”
(&
nby‹_İs
);

137 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch/text.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/rou‹/şs/em©ch.h
>

23 
	~<Ãšk/rou‹/şs/em©ch/‹xt.h
>

25 
	s‹xt_d©a


27 
tcf_em_‹xt
 
	mcfg
;

28 * 
	m·‰”n
;

31 
	$¹Æ_em©ch_‹xt_£t_äom
(
¹Æ_em©ch
 *
e
, 
ušt8_t
 
Ïy”
,

32 
ušt16_t
 
off£t
)

34 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

35 
t
->
cfg
.
äom_off£t
 = 
off£t
;

36 
t
->
cfg
.
äom_Ïy”
 = 
Ïy”
;

37 
	}
}

39 
ušt16_t
 
	$¹Æ_em©ch_‹xt_g‘_äom_off£t
(
¹Æ_em©ch
 *
e
)

41  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
äom_off£t
;

42 
	}
}

44 
ušt8_t
 
	$¹Æ_em©ch_‹xt_g‘_äom_Ïy”
(
¹Æ_em©ch
 *
e
)

46  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
äom_Ïy”
;

47 
	}
}

49 
	$¹Æ_em©ch_‹xt_£t_to
(
¹Æ_em©ch
 *
e
, 
ušt8_t
 
Ïy”
,

50 
ušt16_t
 
off£t
)

52 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

53 
t
->
cfg
.
to_off£t
 = 
off£t
;

54 
t
->
cfg
.
to_Ïy”
 = 
Ïy”
;

55 
	}
}

57 
ušt16_t
 
	$¹Æ_em©ch_‹xt_g‘_to_off£t
(
¹Æ_em©ch
 *
e
)

59  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
to_off£t
;

60 
	}
}

62 
ušt8_t
 
	$¹Æ_em©ch_‹xt_g‘_to_Ïy”
(
¹Æ_em©ch
 *
e
)

64  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
to_Ïy”
;

65 
	}
}

67 
	$¹Æ_em©ch_‹xt_£t_·‰”n
(
¹Æ_em©ch
 *
e
,

68 *
·‰”n
, 
size_t
 
Ën
)

70 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

72 ià(
t
->
·‰”n
)

73 
	`ä“
(
t
->
·‰”n
);

75 
t
->
·‰”n
 =…attern;

76 
t
->
cfg
.
·‰”n_Ën
 = 
Ën
;

77 
	}
}

79 *
	$¹Æ_em©ch_‹xt_g‘_·‰”n
(
¹Æ_em©ch
 *
e
)

81  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
·‰”n
;

82 
	}
}

84 
size_t
 
	$¹Æ_em©ch_‹xt_g‘_Ën
(
¹Æ_em©ch
 *
e
)

86  ((
‹xt_d©a
 *è
	`¹Æ_em©ch_d©a
(
e
))->
cfg
.
·‰”n_Ën
;

87 
	}
}

89 
	$¹Æ_em©ch_‹xt_£t_®go
(
¹Æ_em©ch
 *
e
, cÚ¡ *
®go
)

91 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

93 
	`¡ºıy
(
t
->
cfg
.
®go
,‡lgo, (t->cfg.algo));

94 
	}
}

96 *
	$¹Æ_em©ch_‹xt_g‘_®go
(
¹Æ_em©ch
 *
e
)

98 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

100  
t
->
cfg
.
®go
[0] ?->cfg.®gØ: 
NULL
;

101 
	}
}

103 
	$‹xt_·r£
(
¹Æ_em©ch
 *
e
, *
d©a
, 
size_t
 
Ën
)

105 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

106 
size_t
 
hd¾’
 = (
tcf_em_‹xt
);

107 
size_t
 
¶’
 = 
Ën
 - 
hd¾’
;

109 
	`memıy
(&
t
->
cfg
, 
d©a
, 
hd¾’
);

111 ià(
t
->
cfg
.
·‰”n_Ën
 > 
¶’
)

112  -
NLE_INVAL
;

114 ià(
t
->
cfg
.
·‰”n_Ën
 > 0) {

115 ià(!(
t
->
·‰”n
 = 
	`ÿÎoc
(1,->
cfg
.
·‰”n_Ën
)))

116  -
NLE_NOMEM
;

118 
	`memıy
(
t
->
·‰”n
, 
d©a
 + 
hd¾’
,->
cfg
.
·‰”n_Ën
);

122 
	}
}

124 
	$‹xt_dump
(
¹Æ_em©ch
 *
e
, 
Æ_dump_·¿ms
 *
p
)

126 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

127 
buf
[64];

129 
	`Æ_dump
(
p
, "text(%s \"%s\"",

130 
t
->
cfg
.
®go
[0] ?->cfg.algo : "no-algo",

131 
t
->
·‰”n
 ? : "no-pattern");

133 ià(
t
->
cfg
.
äom_Ïy”
 ||->cfg.
äom_off£t
) {

134 
	`Æ_dump
(
p
, " from %s",

135 
	`¹Æ_em©ch_off£t2txt
(
t
->
cfg
.
äom_Ïy”
,

136 
t
->
cfg
.
äom_off£t
,

137 
buf
, (buf)));

140 ià(
t
->
cfg
.
to_Ïy”
 ||->cfg.
to_off£t
) {

141 
	`Æ_dump
(
p
, "o %s",

142 
	`¹Æ_em©ch_off£t2txt
(
t
->
cfg
.
to_Ïy”
,

143 
t
->
cfg
.
to_off£t
,

144 
buf
, (buf)));

147 
	`Æ_dump
(
p
, ")");

148 
	}
}

150 
	$‹xt_fl
(
¹Æ_em©ch
 *
e
, 
Æ_msg
 *
msg
)

152 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

153 
”r
;

155 ià((
”r
 = 
	`Æmsg_­³nd
(
msg
, &
t
->
cfg
, (t->cfg), 0)) < 0)

156  
”r
;

158  
	`Æmsg_­³nd
(
msg
, 
t
->
·‰”n
,->
cfg
.
·‰”n_Ën
, 0);

159 
	}
}

161 
	$‹xt_ä“
(
¹Æ_em©ch
 *
e
)

163 
‹xt_d©a
 *
t
 = 
	`¹Æ_em©ch_d©a
(
e
);

164 
	`ä“
(
t
->
·‰”n
);

165 
	}
}

167 
¹Æ_em©ch_İs
 
	g‹xt_İs
 = {

168 .
eo_kšd
 = 
TCF_EM_TEXT
,

169 .
	geo_Çme
 = "text",

170 .
	geo_mšËn
 = (
tcf_em_‹xt
),

171 .
	geo_d©®’
 = (
‹xt_d©a
),

172 .
	geo_·r£
 = 
‹xt_·r£
,

173 .
	geo_dump
 = 
‹xt_dump
,

174 .
	geo_fl
 = 
‹xt_fl
,

175 .
	geo_ä“
 = 
‹xt_ä“
,

178 
__š™
 
	$‹xt_š™
()

180 
	`¹Æ_em©ch_»gi¡”
(&
‹xt_İs
);

181 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.c

5 
	#YY_INT_ALIGNED
 

	)

9 
	#FLEX_SCANNER


	)

10 
	#YY_FLEX_MAJOR_VERSION
 2

	)

11 
	#YY_FLEX_MINOR_VERSION
 5

	)

12 
	#YY_FLEX_SUBMINOR_VERSION
 39

	)

13 #ià
YY_FLEX_SUBMINOR_VERSION
 > 0

14 
	#FLEX_BETA


	)

20 
	~<¡dio.h
>

21 
	~<¡ršg.h
>

22 
	~<”ºo.h
>

23 
	~<¡dlib.h
>

29 #iâdeà
FLEXINT_H


30 
	#FLEXINT_H


	)

34 #ià
defšed
 (
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

39 #iâdeà
__STDC_LIMIT_MACROS


40 
	#__STDC_LIMIT_MACROS
 1

	)

43 
	~<š‰y³s.h
>

44 
št8_t
 
	tæex_št8_t
;

45 
ušt8_t
 
	tæex_ušt8_t
;

46 
št16_t
 
	tæex_št16_t
;

47 
ušt16_t
 
	tæex_ušt16_t
;

48 
št32_t
 
	tæex_št32_t
;

49 
ušt32_t
 
	tæex_ušt32_t
;

51 sigÃd 
	tæex_št8_t
;

52 
	tæex_št16_t
;

53 
	tæex_št32_t
;

54 
	tæex_ušt8_t
;

55 
	tæex_ušt16_t
;

56 
	tæex_ušt32_t
;

59 #iâdeà
INT8_MIN


60 
	#INT8_MIN
 (-128)

	)

62 #iâdeà
INT16_MIN


63 
	#INT16_MIN
 (-32767-1)

	)

65 #iâdeà
INT32_MIN


66 
	#INT32_MIN
 (-2147483647-1)

	)

68 #iâdeà
INT8_MAX


69 
	#INT8_MAX
 (127)

	)

71 #iâdeà
INT16_MAX


72 
	#INT16_MAX
 (32767)

	)

74 #iâdeà
INT32_MAX


75 
	#INT32_MAX
 (2147483647)

	)

77 #iâdeà
UINT8_MAX


78 
	#UINT8_MAX
 (255U)

	)

80 #iâdeà
UINT16_MAX


81 
	#UINT16_MAX
 (65535U)

	)

83 #iâdeà
UINT32_MAX


84 
	#UINT32_MAX
 (4294967295U)

	)

91 #ifdeà
__ılu¥lus


94 
	#YY_USE_CONST


	)

99 #ià
defšed
 (
__STDC__
)

101 
	#YY_USE_CONST


	)

106 #ifdeà
YY_USE_CONST


107 
	#yycÚ¡
 cÚ¡

	)

109 
	#yycÚ¡


	)

113 
	#YY_NULL
 0

	)

120 
	#YY_SC_TO_UI
(
c
è((è(èc)

	)

123 #iâdeà
YY_TYPEDEF_YY_SCANNER_T


124 
	#YY_TYPEDEF_YY_SCANNER_T


	)

125 * 
	tyysÿn_t
;

130 
	#yyš
 
yyg
->
yyš_r


	)

131 
	#yyout
 
yyg
->
yyout_r


	)

132 
	#yyexŒa
 
yyg
->
yyexŒa_r


	)

133 
	#yyËng
 
yyg
->
yyËng_r


	)

134 
	#yy‹xt
 
yyg
->
yy‹xt_r


	)

135 
	#yylš’o
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_lš’o
)

	)

136 
	#yycŞumn
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_cŞumn
)

	)

137 
	#yy_æex_debug
 
yyg
->
yy_æex_debug_r


	)

143 
	#BEGIN
 
yyg
->
yy_¡¬t
 = 1 + 2 *

	)

149 
	#YY_START
 ((
yyg
->
yy_¡¬t
 - 1è/ 2)

	)

150 
	#YYSTATE
 
YY_START


	)

153 
	#YY_STATE_EOF
(
¡©e
è(
YY_END_OF_BUFFER
 + s‹ + 1)

	)

156 
	#YY_NEW_FILE
 
	`em©ch_»¡¬t
(
yyš
 ,
yysÿÂ”
 )

	)

158 
	#YY_END_OF_BUFFER_CHAR
 0

	)

161 #iâdeà
YY_BUF_SIZE


162 #ifdeà
__Ÿ64__


167 
	#YY_BUF_SIZE
 32768

	)

169 
	#YY_BUF_SIZE
 16384

	)

175 
	#YY_STATE_BUF_SIZE
 ((
YY_BUF_SIZE
 + 2è* (
yy_¡©e_ty³
))

	)

177 #iâdeà
YY_TYPEDEF_YY_BUFFER_STATE


178 
	#YY_TYPEDEF_YY_BUFFER_STATE


	)

179 
yy_bufãr_¡©e
 *
	tYY_BUFFER_STATE
;

182 #iâdeà
YY_TYPEDEF_YY_SIZE_T


183 
	#YY_TYPEDEF_YY_SIZE_T


	)

184 
size_t
 
	tyy_size_t
;

187 
	#EOB_ACT_CONTINUE_SCAN
 0

	)

188 
	#EOB_ACT_END_OF_FILE
 1

	)

189 
	#EOB_ACT_LAST_MATCH
 2

	)

191 
	#YY_LESS_LINENO
(
n
)

	)

192 
	#YY_LINENO_REWIND_TO
(
±r
)

	)

195 
	#yyËss
(
n
) \

199 
yyËss_maüo_¬g
 = (
n
); \

200 
	`YY_LESS_LINENO
(
yyËss_maüo_¬g
);\

201 *
yy_ı
 = 
yyg
->
yy_hŞd_ch¬
; \

202 
YY_RESTORE_YY_MORE_OFFSET
 \

203 
yyg
->
yy_c_buf_p
 = 
yy_ı
 = 
yy_bp
 + 
yyËss_maüo_¬g
 - 
YY_MORE_ADJ
; \

204 
YY_DO_BEFORE_ACTION
; \

206  0 )

	)

208 
	#uÅut
(
c
è
	`yyuÅut
Ğc, 
yyg
->
yy‹xt_±r
 , 
yysÿÂ”
 )

	)

210 #iâdeà
YY_STRUCT_YY_BUFFER_STATE


211 
	#YY_STRUCT_YY_BUFFER_STATE


	)

212 
	syy_bufãr_¡©e


214 
FILE
 *
	myy_šput_fe
;

216 *
	myy_ch_buf
;

217 *
	myy_buf_pos
;

222 
yy_size_t
 
	myy_buf_size
;

227 
yy_size_t
 
	myy_n_ch¬s
;

233 
	myy_is_our_bufãr
;

240 
	myy_is_š‹¿ùive
;

246 
	myy_©_bŞ
;

248 
	myy_bs_lš’o
;

249 
	myy_bs_cŞumn
;

254 
	myy_fl_bufãr
;

256 
	myy_bufãr_¡©us
;

258 
	#YY_BUFFER_NEW
 0

	)

259 
	#YY_BUFFER_NORMAL
 1

	)

270 
	#YY_BUFFER_EOF_PENDING
 2

	)

281 
	#YY_CURRENT_BUFFER
 ( 
yyg
->
yy_bufãr_¡ack
 \

282 ? 
yyg
->
yy_bufãr_¡ack
[yyg->
yy_bufãr_¡ack_tİ
] \

283 : 
NULL
)

	)

288 
	#YY_CURRENT_BUFFER_LVALUE
 
yyg
->
yy_bufãr_¡ack
[yyg->
yy_bufãr_¡ack_tİ
]

	)

290 
em©ch_»¡¬t
 (
FILE
 *
šput_fe
 ,
yysÿn_t
 
yysÿÂ”
 );

291 
em©ch__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

292 
YY_BUFFER_STATE
 
em©ch__ü—‹_bufãr
 (
FILE
 *
fe
,
size
 ,
yysÿn_t
 
yysÿÂ”
 );

293 
em©ch__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

294 
em©ch__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

295 
em©ch_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

296 
em©ch_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

298 
em©ch_’su»_bufãr_¡ack
 (
yysÿn_t
 
yysÿÂ”
 );

299 
em©ch__lßd_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

300 
em©ch__š™_bufãr
 (
YY_BUFFER_STATE
 
b
,
FILE
 *
fe
 ,
yysÿn_t
 
yysÿÂ”
 );

302 
	#YY_FLUSH_BUFFER
 
	`em©ch__æush_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
)

	)

304 
YY_BUFFER_STATE
 
em©ch__sÿn_bufãr
 (*
ba£
,
yy_size_t
 
size
 ,
yysÿn_t
 
yysÿÂ”
 );

305 
YY_BUFFER_STATE
 
em©ch__sÿn_¡ršg
 (
yycÚ¡
 *
yy_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

306 
YY_BUFFER_STATE
 
em©ch__sÿn_by‹s
 (
yycÚ¡
 *
by‹s
,
yy_size_t
 
Ën
 ,
yysÿn_t
 
yysÿÂ”
 );

308 *
em©ch_®loc
 (
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

309 *
em©ch_»®loc
 (*,
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

310 
em©ch_ä“
 (* ,
yysÿn_t
 
yysÿÂ”
 );

312 
	#yy_Ãw_bufãr
 
em©ch__ü—‹_bufãr


	)

314 
	#yy_£t_š‹¿ùive
(
is_š‹¿ùive
) \

316 iàĞ! 
YY_CURRENT_BUFFER
 ){ \

317 
	`em©ch_’su»_bufãr_¡ack
 (
yysÿÂ”
); \

318 
YY_CURRENT_BUFFER_LVALUE
 = \

319 
	`em©ch__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
); \

321 
YY_CURRENT_BUFFER_LVALUE
->
yy_is_š‹¿ùive
 = 
is_š‹¿ùive
; \

322 }

	)

324 
	#yy_£t_bŞ
(
©_bŞ
) \

326 iàĞ! 
YY_CURRENT_BUFFER
 ){\

327 
	`em©ch_’su»_bufãr_¡ack
 (
yysÿÂ”
); \

328 
YY_CURRENT_BUFFER_LVALUE
 = \

329 
	`em©ch__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
); \

331 
YY_CURRENT_BUFFER_LVALUE
->
yy_©_bŞ
 = 
©_bŞ
; \

332 }

	)

334 
	#YY_AT_BOL
(è(
YY_CURRENT_BUFFER_LVALUE
->
yy_©_bŞ
)

	)

336 
	#em©ch_w¿p
(
yysÿÂ”
è1

	)

337 
	#YY_SKIP_YYWRAP


	)

339 
	tYY_CHAR
;

341 
	tyy_¡©e_ty³
;

343 
	#yy‹xt_±r
 
yy‹xt_r


	)

345 
yy_¡©e_ty³
 
yy_g‘_´evious_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

346 
yy_¡©e_ty³
 
yy_Œy_NUL_Œªs
 (yy_¡©e_ty³ 
cu¼’t_¡©e
 ,
yysÿn_t
 
yysÿÂ”
);

347 
yy_g‘_Ãxt_bufãr
 (
yysÿn_t
 
yysÿÂ”
 );

348 
yy_çl_”rÜ
 (
yycÚ¡
 
msg
[] ,
yysÿn_t
 
yysÿÂ”
 );

353 
	#YY_DO_BEFORE_ACTION
 \

354 
yyg
->
yy‹xt_±r
 = 
yy_bp
; \

355 
yyËng
 = (
size_t
è(
yy_ı
 - 
yy_bp
); \

356 
yyg
->
yy_hŞd_ch¬
 = *
yy_ı
; \

357 *
yy_ı
 = '\0'; \

358 
yyg
->
yy_c_buf_p
 = 
yy_ı
;

	)

360 
	#YY_NUM_RULES
 91

	)

361 
	#YY_END_OF_BUFFER
 92

	)

364 
	syy_Œªs_šfo


366 
æex_št32_t
 
	myy_v”ify
;

367 
æex_št32_t
 
	myy_nxt
;

369 
yycÚ¡
 
æex_št16_t
 
	gyy_acû±
[393] =

417 
yycÚ¡
 
æex_št32_t
 
	gyy_ec
[256] =

449 
yycÚ¡
 
æex_št32_t
 
	gyy_m‘a
[66] =

460 
yycÚ¡
 
æex_št16_t
 
	gyy_ba£
[396] =

508 
yycÚ¡
 
æex_št16_t
 
	gyy_def
[396] =

556 
yycÚ¡
 
æex_št16_t
 
	gyy_nxt
[604] =

627 
yycÚ¡
 
æex_št16_t
 
	gyy_chk
[604] =

701 
	#REJECT
 
»jeù_u£d_but_nÙ_d‘eùed


	)

702 
	#yymÜe
(è
yymÜe_u£d_but_nÙ_d‘eùed


	)

703 
	#YY_MORE_ADJ
 0

	)

704 
	#YY_RESTORE_YY_MORE_OFFSET


	)

717 
	~<Ãšk-´iv©e/Ãšk.h
>

718 
	~<Ãšk-´iv©e/tc.h
>

719 
	~<Ãšk/Ãšk.h
>

720 
	~<Ãšk/rou‹/şs/em©ch.h
>

721 
	~<Ãšk/rou‹/şs/em©ch/cmp.h
>

722 
	~"em©ch_syÁax.h
"

723 
	#YY_NO_INPUT
 1

	)

727 
	#INITIAL
 0

	)

728 
	#QUOTE
 1

	)

730 #iâdeà
YY_NO_UNISTD_H


735 
	~<uni¡d.h
>

738 #iâdeà
YY_EXTRA_TYPE


739 
	#YY_EXTRA_TYPE
 *

	)

743 
	syyguts_t


747 
YY_EXTRA_TYPE
 
	myyexŒa_r
;

750 
FILE
 *
	myyš_r
, *
	myyout_r
;

751 
size_t
 
	myy_bufãr_¡ack_tİ
;

752 
size_t
 
	myy_bufãr_¡ack_max
;

753 
YY_BUFFER_STATE
 * 
	myy_bufãr_¡ack
;

754 
	myy_hŞd_ch¬
;

755 
yy_size_t
 
	myy_n_ch¬s
;

756 
yy_size_t
 
	myyËng_r
;

757 *
	myy_c_buf_p
;

758 
	myy_š™
;

759 
	myy_¡¬t
;

760 
	myy_did_bufãr_sw™ch_Ú_eof
;

761 
	myy_¡¬t_¡ack_±r
;

762 
	myy_¡¬t_¡ack_d•th
;

763 *
	myy_¡¬t_¡ack
;

764 
yy_¡©e_ty³
 
	myy_Ï¡_acû±šg_¡©e
;

765 * 
	myy_Ï¡_acû±šg_ıos
;

767 
	myylš’o_r
;

768 
	myy_æex_debug_r
;

770 *
	myy‹xt_r
;

771 
	myy_mÜe_æag
;

772 
	myy_mÜe_Ën
;

774 
YYSTYPE
 * 
	myylv®_r
;

778 
yy_š™_glob®s
 (
yysÿn_t
 
yysÿÂ”
 );

782 
	#yylv®
 
yyg
->
yylv®_r


	)

784 
em©ch_Ëx_š™
 (
yysÿn_t
* 
sÿÂ”
);

786 
em©ch_Ëx_š™_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
,
yysÿn_t
* 
sÿÂ”
);

791 
em©ch_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
 );

793 
em©ch_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
 );

795 
em©ch_£t_debug
 (
debug_æag
 ,
yysÿn_t
 
yysÿÂ”
 );

797 
YY_EXTRA_TYPE
 
em©ch_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
 );

799 
em©ch_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 ,
yysÿn_t
 
yysÿÂ”
 );

801 
FILE
 *
em©ch_g‘_š
 (
yysÿn_t
 
yysÿÂ”
 );

803 
em©ch_£t_š
 (
FILE
 * 
š_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

805 
FILE
 *
em©ch_g‘_out
 (
yysÿn_t
 
yysÿÂ”
 );

807 
em©ch_£t_out
 (
FILE
 * 
out_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

809 
yy_size_t
 
em©ch_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
 );

811 *
em©ch_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
 );

813 
em©ch_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
 );

815 
em©ch_£t_lš’o
 (
lše_numb”
 ,
yysÿn_t
 
yysÿÂ”
 );

817 
em©ch_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
 );

819 
em©ch_£t_cŞumn
 (
cŞumn_no
 ,
yysÿn_t
 
yysÿÂ”
 );

821 
YYSTYPE
 * 
em©ch_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
 );

823 
em©ch_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

829 #iâdeà
YY_SKIP_YYWRAP


830 #ifdeà
__ılu¥lus


831 "C" 
em©ch_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

833 
em©ch_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

837 #iâdeà
yy‹xt_±r


838 
yy_æex_¡ºıy
 (*,
yycÚ¡
 *,,
yysÿn_t
 
yysÿÂ”
);

841 #ifdeà
YY_NEED_STRLEN


842 
yy_æex_¡¾’
 (
yycÚ¡
 * ,
yysÿn_t
 
yysÿÂ”
);

845 #iâdeà
YY_NO_INPUT


847 #ifdeà
__ılu¥lus


848 
yyšput
 (
yysÿn_t
 
yysÿÂ”
 );

850 
šput
 (
yysÿn_t
 
yysÿÂ”
 );

856 #iâdeà
YY_READ_BUF_SIZE


857 #ifdeà
__Ÿ64__


859 
	#YY_READ_BUF_SIZE
 16384

	)

861 
	#YY_READ_BUF_SIZE
 8192

	)

866 #iâdeà
ECHO


870 
	#ECHO
 dØ{ ià(
	`fwr™e
Ğ
yy‹xt
, 
yyËng
, 1, 
yyout
 )è{} } 0)

	)

876 #iâdeà
YY_INPUT


877 
	#YY_INPUT
(
buf
,
»suÉ
,
max_size
) \

878 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_is_š‹¿ùive
 ) \

880 
c
 = '*'; \

881 
size_t
 
n
; \

882  
n
 = 0;‚ < 
max_size
 && \

883 (
c
 = 
	`g‘c
Ğ
yyš
 )è!ğ
EOF
 && c !ğ'\n'; ++
n
 ) \

884 
buf
[
n
] = (è
c
; \

885 iàĞ
c
 == '\n' ) \

886 
buf
[
n
++] = (è
c
; \

887 iàĞ
c
 =ğ
EOF
 && 
	`ã¼Ü
Ğ
yyš
 ) ) \

888 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

889 
»suÉ
 = 
n
; \

893 
”ºo
=0; \

894  (
»suÉ
 = 
	`ä—d
(
buf
, 1, 
max_size
, 
yyš
))==0 && 
	`ã¼Ü
(yyin)) \

896 ifĞ
”ºo
 !ğ
EINTR
) \

898 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

901 
”ºo
=0; \

902 
	`ş—»¼
(
yyš
); \

906 

	)

913 #iâdeà
yy‹rmš©e


914 
	#yy‹rmš©e
(è 
YY_NULL


	)

918 #iâdeà
YY_START_STACK_INCR


919 
	#YY_START_STACK_INCR
 25

	)

923 #iâdeà
YY_FATAL_ERROR


924 
	#YY_FATAL_ERROR
(
msg
è
	`yy_çl_”rÜ
Ğmsg , 
yysÿÂ”
)

	)

932 #iâdeà
YY_DECL


933 
	#YY_DECL_IS_OURS
 1

	)

935 
em©ch_Ëx
 \

936 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
);

938 
	#YY_DECL
 
em©ch_Ëx
 \

939 (
YYSTYPE
 * 
yylv®_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

	)

945 #iâdeà
YY_USER_ACTION


946 
	#YY_USER_ACTION


	)

950 #iâdeà
YY_BREAK


951 
	#YY_BREAK
 ;

	)

954 
	#YY_RULE_SETUP
 \

955 
YY_USER_ACTION


	)

959 
	gYY_DECL


961 
yy_¡©e_ty³
 
	gyy_cu¼’t_¡©e
;

962 *
	gyy_ı
, *
	gyy_bp
;

963 
	gyy_aù
;

964 
yyguts_t
 * 
	gyyg
 = (yyguts_t*)
yysÿÂ”
;

966 
	gyylv®
 = 
yylv®_·¿m
;

968 iàĞ!
	gyyg
->
	gyy_š™
 )

970 
	gyyg
->
	gyy_š™
 = 1;

972 #ifdeà
YY_USER_INIT


973 
	gYY_USER_INIT
;

976 iàĞ! 
	gyyg
->
	gyy_¡¬t
 )

977 
	gyyg
->
	gyy_¡¬t
 = 1;

979 iàĞ! 
	gyyš
 )

980 
	gyyš
 = 
¡dš
;

982 iàĞ! 
	gyyout
 )

983 
	gyyout
 = 
¡dout
;

985 iàĞ! 
	gYY_CURRENT_BUFFER
 ) {

986 
em©ch_’su»_bufãr_¡ack
 (
yysÿÂ”
);

987 
	gYY_CURRENT_BUFFER_LVALUE
 =

988 
em©ch__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
);

991 
em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1002 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1005 *
	gyy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

1010 
	gyy_bp
 = 
yy_ı
;

1012 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_¡¬t
;

1013 
	gyy_m©ch
:

1016 
YY_CHAR
 
yy_c
 = 
yy_ec
[
YY_SC_TO_UI
(*
yy_ı
)] ;

1017 iàĞ
	gyy_acû±
[
yy_cu¼’t_¡©e
] )

1019 
	gyyg
->
	gyy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

1020 
	gyyg
->
	gyy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

1022  
	gyy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
	gyy_c
] != yy_current_state )

1024 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1025 iàĞ
	gyy_cu¼’t_¡©e
 >= 393 )

1026 
yy_c
 = 
yy_m‘a
[() yy_c];

1028 
	gyy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[
yy_cu¼’t_¡©e
] + (è
yy_c
];

1029 ++
	gyy_ı
;

1031  
	gyy_ba£
[
yy_cu¼’t_¡©e
] != 538 );

1033 
	gyy_fšd_aùiÚ
:

1034 
yy_aù
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

1035 iàĞ
	gyy_aù
 == 0 )

1037 
yy_ı
 = 
yyg
->
yy_Ï¡_acû±šg_ıos
;

1038 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_Ï¡_acû±šg_¡©e
;

1039 
	gyy_aù
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

1042 
	gYY_DO_BEFORE_ACTION
;

1044 
	gdo_aùiÚ
:

1046  
yy_aù
 )

1050 *
yy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

1051 
	gyy_ı
 = 
yyg
->
yy_Ï¡_acû±šg_ıos
;

1052 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_Ï¡_acû±šg_¡©e
;

1053 
	gyy_fšd_aùiÚ
;

1057 
YY_RULE_SETUP


1060 
YY_BREAK


1062 
YY_RULE_SETUP


1065 
NL_DBG
(4, "Beginning of quote\n");

1066 
	gyylv®
->
	gq
.
	gËn
 = 32;

1067 ià(!(
	gyylv®
->
	gq
.
	gd©a
 = 
ÿÎoc
(1, 
yylv®
->
q
.
Ën
)))

1068  
	gERROR
;

1070 
	gyylv®
->
	gq
.
	gšdex
 = 0;

1071 
BEGIN
(
QUOTE
);

1073 
YY_BREAK


1075 
YY_RULE_SETUP


1078 
memıy
(
yylv®
->
q
.
d©a
 + yylv®->q.
šdex
, 
yy‹xt
,

1079 
¡¾’
(
yy‹xt
));

1080 
	gyylv®
->
	gq
.
	gšdex
 +ğ
¡¾’
(
yy‹xt
);

1082 
YY_BREAK


1084 
YY_RULE_SETUP


1087 
BEGIN
(0);

1088  
	gQUOTED
;

1090 
YY_BREAK


1094 
YY_RULE_SETUP


1097 
yylv®
->
i
 = 
¡¹oul
(
yy‹xt
, 
NULL
, 0);

1098  
	gNUMBER
;

1100 
YY_BREAK


1104 
YY_RULE_SETUP


1106  
KW_EQ
;

1107 
YY_BREAK


1111 
YY_RULE_SETUP


1113  
KW_GT
;

1114 
YY_BREAK


1118 
YY_RULE_SETUP


1120  
KW_LT
;

1121 
YY_BREAK


1125 
YY_RULE_SETUP


1127 { 
yylv®
->
i
 = 
TCF_EM_REL_AND
;  
	gLOGIC
; }

1128 
YY_BREAK


1132 
YY_RULE_SETUP


1134 { 
yylv®
->
i
 = 
TCF_EM_REL_OR
;  
	gLOGIC
; }

1135 
YY_BREAK


1139 
YY_RULE_SETUP


1141  
NOT
;

1142 
YY_BREAK


1144 
YY_RULE_SETUP


1146 { 
yylv®
->
i
 = 
TCF_EM_CMP
;  
	gEMATCH_CMP
; }

1147 
YY_BREAK


1149 
YY_RULE_SETUP


1151 { 
yylv®
->
i
 = 
TCF_EM_NBYTE
;  
	gEMATCH_NBYTE
; }

1152 
YY_BREAK


1154 
YY_RULE_SETUP


1156 { 
yylv®
->
i
 = 
TCF_EM_TEXT
;  
	gEMATCH_TEXT
; }

1157 
YY_BREAK


1159 
YY_RULE_SETUP


1161 { 
yylv®
->
i
 = 
TCF_EM_META
;  
	gEMATCH_META
; }

1162 
YY_BREAK


1164 
YY_RULE_SETUP


1166  
KW_OPEN
;

1167 
YY_BREAK


1169 
YY_RULE_SETUP


1171  
KW_CLOSE
;

1172 
YY_BREAK


1176 
YY_RULE_SETUP


1178  
KW_MASK
;

1179 
YY_BREAK


1183 
YY_RULE_SETUP


1185  
KW_SHIFT
;

1186 
YY_BREAK


1188 
YY_RULE_SETUP


1190  
KW_AT
;

1191 
YY_BREAK


1193 
YY_RULE_SETUP


1195  
KW_PLUS
;

1196 
YY_BREAK


1198 
YY_RULE_SETUP


1200  
KW_FROM
;

1201 
YY_BREAK


1203 
YY_RULE_SETUP


1205  
KW_TO
;

1206 
YY_BREAK


1208 
YY_RULE_SETUP


1210 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U8
;  
	gALIGN
; }

1211 
YY_BREAK


1213 
YY_RULE_SETUP


1215 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U16
;  
	gALIGN
; }

1216 
YY_BREAK


1218 
YY_RULE_SETUP


1220 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U32
;  
	gALIGN
; }

1221 
YY_BREAK


1225 
YY_RULE_SETUP


1227 { 
yylv®
->
i
 = 
TCF_LAYER_LINK
;  
	gLAYER
; }

1228 
YY_BREAK


1234 
YY_RULE_SETUP


1236 { 
yylv®
->
i
 = 
TCF_LAYER_NETWORK
;  
	gLAYER
; }

1237 
YY_BREAK


1241 
YY_RULE_SETUP


1243 { 
yylv®
->
i
 = 
TCF_LAYER_TRANSPORT
;  
	gLAYER
; }

1244 
YY_BREAK


1246 
YY_RULE_SETUP


1248  
META_RANDOM
;

1249 
YY_BREAK


1251 
YY_RULE_SETUP


1253  
META_LOADAVG_0
;

1254 
YY_BREAK


1256 
YY_RULE_SETUP


1258  
META_LOADAVG_1
;

1259 
YY_BREAK


1261 
YY_RULE_SETUP


1263  
META_LOADAVG_2
;

1264 
YY_BREAK


1266 
YY_RULE_SETUP


1268  
META_DEV
;

1269 
YY_BREAK


1271 
YY_RULE_SETUP


1273  
META_PRIO
;

1274 
YY_BREAK


1276 
YY_RULE_SETUP


1278  
META_PROTO
;

1279 
YY_BREAK


1281 
YY_RULE_SETUP


1283  
META_PKTTYPE
;

1284 
YY_BREAK


1286 
YY_RULE_SETUP


1288  
META_PKTLEN
;

1289 
YY_BREAK


1291 
YY_RULE_SETUP


1293  
META_DATALEN
;

1294 
YY_BREAK


1296 
YY_RULE_SETUP


1298  
META_MACLEN
;

1299 
YY_BREAK


1301 
YY_RULE_SETUP


1303  
META_MARK
;

1304 
YY_BREAK


1306 
YY_RULE_SETUP


1308  
META_TCINDEX
;

1309 
YY_BREAK


1311 
YY_RULE_SETUP


1313  
META_RTCLASSID
;

1314 
YY_BREAK


1316 
YY_RULE_SETUP


1318  
META_RTIIF
;

1319 
YY_BREAK


1321 
YY_RULE_SETUP


1323  
META_SK_FAMILY
;

1324 
YY_BREAK


1326 
YY_RULE_SETUP


1328  
META_SK_STATE
;

1329 
YY_BREAK


1331 
YY_RULE_SETUP


1333  
META_SK_REUSE
;

1334 
YY_BREAK


1336 
YY_RULE_SETUP


1338  
META_SK_REFCNT
;

1339 
YY_BREAK


1341 
YY_RULE_SETUP


1343  
META_SK_RCVBUF
;

1344 
YY_BREAK


1346 
YY_RULE_SETUP


1348  
META_SK_SNDBUF
;

1349 
YY_BREAK


1351 
YY_RULE_SETUP


1353  
META_SK_SHUTDOWN
;

1354 
YY_BREAK


1356 
YY_RULE_SETUP


1358  
META_SK_PROTO
;

1359 
YY_BREAK


1361 
YY_RULE_SETUP


1363  
META_SK_TYPE
;

1364 
YY_BREAK


1366 
YY_RULE_SETUP


1368  
META_SK_RMEM_ALLOC
;

1369 
YY_BREAK


1371 
YY_RULE_SETUP


1373  
META_SK_WMEM_ALLOC
;

1374 
YY_BREAK


1376 
YY_RULE_SETUP


1378  
META_SK_WMEM_QUEUED
;

1379 
YY_BREAK


1381 
YY_RULE_SETUP


1383  
META_SK_RCV_QLEN
;

1384 
YY_BREAK


1386 
YY_RULE_SETUP


1388  
META_SK_SND_QLEN
;

1389 
YY_BREAK


1391 
YY_RULE_SETUP


1393  
META_SK_ERR_QLEN
;

1394 
YY_BREAK


1396 
YY_RULE_SETUP


1398  
META_SK_FORWARD_ALLOCS
;

1399 
YY_BREAK


1401 
YY_RULE_SETUP


1403  
META_SK_ALLOCS
;

1404 
YY_BREAK


1406 
YY_RULE_SETUP


1408  
META_SK_ROUTE_CAPS
;

1409 
YY_BREAK


1411 
YY_RULE_SETUP


1413  
META_SK_HASH
;

1414 
YY_BREAK


1416 
YY_RULE_SETUP


1418  
META_SK_LINGERTIME
;

1419 
YY_BREAK


1421 
YY_RULE_SETUP


1423  
META_SK_ACK_BACKLOG
;

1424 
YY_BREAK


1426 
YY_RULE_SETUP


1428  
META_SK_MAX_ACK_BACKLOG
;

1429 
YY_BREAK


1431 
YY_RULE_SETUP


1433  
META_SK_PRIO
;

1434 
YY_BREAK


1436 
YY_RULE_SETUP


1438  
META_SK_RCVLOWAT
;

1439 
YY_BREAK


1441 
YY_RULE_SETUP


1443  
META_SK_RCVTIMEO
;

1444 
YY_BREAK


1446 
YY_RULE_SETUP


1448  
META_SK_SNDTIMEO
;

1449 
YY_BREAK


1451 
YY_RULE_SETUP


1453  
META_SK_SENDMSG_OFF
;

1454 
YY_BREAK


1456 
YY_RULE_SETUP


1458  
META_SK_WRITE_PENDING
;

1459 
YY_BREAK


1461 
YY_RULE_SETUP


1463  
META_VLAN
;

1464 
YY_BREAK


1466 
YY_RULE_SETUP


1468  
META_RXHASH
;

1469 
YY_BREAK


1471 
YY_RULE_SETUP


1473  
META_DEVNAME
;

1474 
YY_BREAK


1476 
YY_RULE_SETUP


1478  
META_SK_BOUND_IF
;

1479 
YY_BREAK


1481 
YY_RULE_SETUP


1484 
yylv®
->
s
 = 
¡rdup
(
yy‹xt
);

1485 ià(
	gyylv®
->
	gs
 =ğ
NULL
)

1486  
ERROR
;

1487 
NL_DBG
(4, "Ëx STR=%s\n", 
yylv®
->
s
);

1488  
	gSTR
;

1490 
YY_BREAK


1492 
YY_RULE_SETUP


1494 
ECHO
;

1495 
	gYY_BREAK


1497 
YY_STATE_EOF
(
INITIAL
):

1498 
YY_STATE_EOF
(
QUOTE
):

1499 
yy‹rmš©e
();

1501 
	gYY_END_OF_BUFFER
:

1504 
yy_amouÁ_of_m©ched_‹xt
 = (è(
yy_ı
 - 
yyg
->
yy‹xt_±r
) - 1;

1507 *
	gyy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

1508 
YY_RESTORE_YY_MORE_OFFSET


1510 iàĞ
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_bufãr_¡©us
 =ğ
YY_BUFFER_NEW
 )

1521 
yyg
->
yy_n_ch¬s
 = 
YY_CURRENT_BUFFER_LVALUE
->yy_n_chars;

1522 
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_šput_fe
 = 
yyš
;

1523 
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_bufãr_¡©us
 = 
YY_BUFFER_NORMAL
;

1533 iàĞ
	gyyg
->
	gyy_c_buf_p
 <ğ&
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
] )

1535 
yy_¡©e_ty³
 
yy_Ãxt_¡©e
;

1537 
	gyyg
->
	gyy_c_buf_p
 = 
yyg
->
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

1539 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

1550 
	gyy_Ãxt_¡©e
 = 
yy_Œy_NUL_Œªs
Ğ
yy_cu¼’t_¡©e
 , 
yysÿÂ”
);

1552 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1554 iàĞ
	gyy_Ãxt_¡©e
 )

1557 
	gyy_ı
 = ++
yyg
->
yy_c_buf_p
;

1558 
	gyy_cu¼’t_¡©e
 = 
yy_Ãxt_¡©e
;

1559 
	gyy_m©ch
;

1564 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1565 
	gyy_fšd_aùiÚ
;

1569  
yy_g‘_Ãxt_bufãr
Ğ
yysÿÂ”
 ) )

1571 
	gEOB_ACT_END_OF_FILE
:

1573 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 0;

1575 iàĞ
em©ch_w¿p
(
yysÿÂ”
 ) )

1586 
	gyyg
->
	gyy_c_buf_p
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1588 
	gyy_aù
 = 
YY_STATE_EOF
(
YY_START
);

1589 
	gdo_aùiÚ
;

1594 iàĞ! 
	gyyg
->
	gyy_did_bufãr_sw™ch_Ú_eof
 )

1595 
	gYY_NEW_FILE
;

1600 
	gEOB_ACT_CONTINUE_SCAN
:

1601 
yyg
->
yy_c_buf_p
 =

1602 
yyg
->
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

1604 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

1606 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1607 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1608 
	gyy_m©ch
;

1610 
	gEOB_ACT_LAST_MATCH
:

1611 
yyg
->
yy_c_buf_p
 =

1612 &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
];

1614 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

1616 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1617 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1618 
	gyy_fšd_aùiÚ
;

1624 
YY_FATAL_ERROR
(

1638 
	$yy_g‘_Ãxt_bufãr
 (
yysÿn_t
 
yysÿÂ”
)

1640 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1641 *
de¡
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
;

1642 *
sourû
 = 
yyg
->
yy‹xt_±r
;

1643 
numb”_to_move
, 
i
;

1644 
»t_v®
;

1646 iàĞ
yyg
->
yy_c_buf_p
 > &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[yyg->
yy_n_ch¬s
 + 1] )

1647 
	`YY_FATAL_ERROR
(

1650 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_fl_bufãr
 == 0 )

1652 iàĞ
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
 - 
YY_MORE_ADJ
 == 1 )

1657  
EOB_ACT_END_OF_FILE
;

1665  
EOB_ACT_LAST_MATCH
;

1672 
numb”_to_move
 = (è(
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
) - 1;

1674  
i
 = 0; i < 
numb”_to_move
; ++i )

1675 *(
de¡
++èğ*(
sourû
++);

1677 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_bufãr_¡©us
 =ğ
YY_BUFFER_EOF_PENDING
 )

1681 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars = 0;

1685 
yy_size_t
 
num_to_»ad
 =

1686 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
 - 
numb”_to_move
 - 1;

1688  
num_to_»ad
 <= 0 )

1692 
YY_BUFFER_STATE
 
b
 = 
YY_CURRENT_BUFFER_LVALUE
;

1694 
yy_c_buf_p_off£t
 =

1695 (è(
yyg
->
yy_c_buf_p
 - 
b
->
yy_ch_buf
);

1697 iàĞ
b
->
yy_is_our_bufãr
 )

1699 
yy_size_t
 
Ãw_size
 = 
b
->
yy_buf_size
 * 2;

1701 iàĞ
Ãw_size
 <= 0 )

1702 
b
->
yy_buf_size
 += b->yy_buf_size / 8;

1704 
b
->
yy_buf_size
 *= 2;

1706 
b
->
yy_ch_buf
 = (*)

1708 
	`em©ch_»®loc
((*è
b
->
yy_ch_buf
,b->
yy_buf_size
 + 2 ,
yysÿÂ”
 );

1712 
b
->
yy_ch_buf
 = 0;

1714 iàĞ! 
b
->
yy_ch_buf
 )

1715 
	`YY_FATAL_ERROR
(

1718 
yyg
->
yy_c_buf_p
 = &
b
->
yy_ch_buf
[
yy_c_buf_p_off£t
];

1720 
num_to_»ad
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
 -

1721 
numb”_to_move
 - 1;

1725 iàĞ
num_to_»ad
 > 
YY_READ_BUF_SIZE
 )

1726 
num_to_»ad
 = 
YY_READ_BUF_SIZE
;

1729 
	`YY_INPUT
Ğ(&
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
numb”_to_move
]),

1730 
yyg
->
yy_n_ch¬s
, 
num_to_»ad
 );

1732 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

1735 iàĞ
yyg
->
yy_n_ch¬s
 == 0 )

1737 iàĞ
numb”_to_move
 =ğ
YY_MORE_ADJ
 )

1739 
»t_v®
 = 
EOB_ACT_END_OF_FILE
;

1740 
	`em©ch_»¡¬t
(
yyš
 ,
yysÿÂ”
);

1745 
»t_v®
 = 
EOB_ACT_LAST_MATCH
;

1746 
YY_CURRENT_BUFFER_LVALUE
->
yy_bufãr_¡©us
 =

1747 
YY_BUFFER_EOF_PENDING
;

1752 
»t_v®
 = 
EOB_ACT_CONTINUE_SCAN
;

1754 ià((
yy_size_t
è(
yyg
->
yy_n_ch¬s
 + 
numb”_to_move
è> 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
) {

1756 
yy_size_t
 
Ãw_size
 = 
yyg
->
yy_n_ch¬s
 + 
numb”_to_move
 + (yyg->yy_n_chars >> 1);

1757 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
 = (*è
	`em©ch_»®loc
((*èYY_CURRENT_BUFFER_LVALUE->yy_ch_buf,
Ãw_size
 ,
yysÿÂ”
 );

1758 iàĞ! 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
 )

1759 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_get_next_buffer()" );

1762 
yyg
->
yy_n_ch¬s
 +ğ
numb”_to_move
;

1763 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
] = 
YY_END_OF_BUFFER_CHAR
;

1764 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
 + 1] = 
YY_END_OF_BUFFER_CHAR
;

1766 
yyg
->
yy‹xt_±r
 = &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[0];

1768  
»t_v®
;

1769 
	}
}

1773 
yy_¡©e_ty³
 
	$yy_g‘_´evious_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

1775 
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
;

1776 *
yy_ı
;

1777 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1779 
yy_cu¼’t_¡©e
 = 
yyg
->
yy_¡¬t
;

1781  
yy_ı
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
; yy_ı < yyg->
yy_c_buf_p
; ++yy_cp )

1783 
YY_CHAR
 
yy_c
 = (*
yy_ı
 ? 
yy_ec
[
	`YY_SC_TO_UI
(*yy_cp)] : 1);

1784 iàĞ
yy_acû±
[
yy_cu¼’t_¡©e
] )

1786 
yyg
->
yy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

1787 
yyg
->
yy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

1789  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1791 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1792 iàĞ
yy_cu¼’t_¡©e
 >= 393 )

1793 
yy_c
 = 
yy_m‘a
[() yy_c];

1795 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1798  
yy_cu¼’t_¡©e
;

1799 
	}
}

1806 
yy_¡©e_ty³
 
	$yy_Œy_NUL_Œªs
 (
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
 , 
yysÿn_t
 
yysÿÂ”
)

1808 
yy_is_jam
;

1809 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1810 *
yy_ı
 = 
yyg
->
yy_c_buf_p
;

1812 
YY_CHAR
 
yy_c
 = 1;

1813 iàĞ
yy_acû±
[
yy_cu¼’t_¡©e
] )

1815 
yyg
->
yy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

1816 
yyg
->
yy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

1818  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1820 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1821 iàĞ
yy_cu¼’t_¡©e
 >= 393 )

1822 
yy_c
 = 
yy_m‘a
[() yy_c];

1824 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1825 
yy_is_jam
 = (
yy_cu¼’t_¡©e
 == 392);

1827 ()
yyg
;

1828  
yy_is_jam
 ? 0 : 
yy_cu¼’t_¡©e
;

1829 
	}
}

1831 #iâdeà
YY_NO_INPUT


1832 #ifdeà
__ılu¥lus


1833 
	$yyšput
 (
yysÿn_t
 
yysÿÂ”
)

1835 
	$šput
 (
yysÿn_t
 
yysÿÂ”
)

1839 
c
;

1840 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1842 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

1844 iàĞ*
yyg
->
yy_c_buf_p
 =ğ
YY_END_OF_BUFFER_CHAR
 )

1850 iàĞ
yyg
->
yy_c_buf_p
 < &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[yyg->
yy_n_ch¬s
] )

1852 *
yyg
->
yy_c_buf_p
 = '\0';

1856 
yy_size_t
 
off£t
 = 
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
;

1857 ++
yyg
->
yy_c_buf_p
;

1859  
	`yy_g‘_Ãxt_bufãr
Ğ
yysÿÂ”
 ) )

1861 
EOB_ACT_LAST_MATCH
:

1873 
	`em©ch_»¡¬t
(
yyš
 ,
yysÿÂ”
);

1877 
EOB_ACT_END_OF_FILE
:

1879 iàĞ
	`em©ch_w¿p
(
yysÿÂ”
 ) )

1880  
EOF
;

1882 iàĞ! 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 )

1883 
YY_NEW_FILE
;

1884 #ifdeà
__ılu¥lus


1885  
	`yyšput
(
yysÿÂ”
);

1887  
	`šput
(
yysÿÂ”
);

1891 
EOB_ACT_CONTINUE_SCAN
:

1892 
yyg
->
yy_c_buf_p
 = yyg->
yy‹xt_±r
 + 
off£t
;

1898 
c
 = *(*è
yyg
->
yy_c_buf_p
;

1899 *
yyg
->
yy_c_buf_p
 = '\0';

1900 
yyg
->
yy_hŞd_ch¬
 = *++yyg->
yy_c_buf_p
;

1902  
c
;

1903 
	}
}

1911 
	$em©ch_»¡¬t
 (
FILE
 * 
šput_fe
 , 
yysÿn_t
 
yysÿÂ”
)

1913 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1915 iàĞ! 
YY_CURRENT_BUFFER
 ){

1916 
	`em©ch_’su»_bufãr_¡ack
 (
yysÿÂ”
);

1917 
YY_CURRENT_BUFFER_LVALUE
 =

1918 
	`em©ch__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
);

1921 
	`em©ch__š™_bufãr
(
YY_CURRENT_BUFFER
,
šput_fe
 ,
yysÿÂ”
);

1922 
	`em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1923 
	}
}

1929 
	$em©ch__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 , 
yysÿn_t
 
yysÿÂ”
)

1931 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1938 
	`em©ch_’su»_bufãr_¡ack
 (
yysÿÂ”
);

1939 iàĞ
YY_CURRENT_BUFFER
 =ğ
Ãw_bufãr
 )

1942 iàĞ
YY_CURRENT_BUFFER
 )

1945 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

1946 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
 = 
yyg
->
yy_c_buf_p
;

1947 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

1950 
YY_CURRENT_BUFFER_LVALUE
 = 
Ãw_bufãr
;

1951 
	`em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1958 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

1959 
	}
}

1961 
	$em©ch__lßd_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

1963 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1964 
yyg
->
yy_n_ch¬s
 = 
YY_CURRENT_BUFFER_LVALUE
->yy_n_chars;

1965 
yyg
->
yy‹xt_±r
 = yyg->
yy_c_buf_p
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
;

1966 
yyš
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_šput_fe
;

1967 
yyg
->
yy_hŞd_ch¬
 = *yyg->
yy_c_buf_p
;

1968 
	}
}

1976 
YY_BUFFER_STATE
 
	$em©ch__ü—‹_bufãr
 (
FILE
 * 
fe
, 
size
 , 
yysÿn_t
 
yysÿÂ”
)

1978 
YY_BUFFER_STATE
 
b
;

1980 
b
 = (
YY_BUFFER_STATE
è
	`em©ch_®loc
(Ğ
yy_bufãr_¡©e
 ) ,
yysÿÂ”
 );

1981 iàĞ! 
b
 )

1982 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch__create_buffer()" );

1984 
b
->
yy_buf_size
 = 
size
;

1989 
b
->
yy_ch_buf
 = (*è
	`em©ch_®loc
(b->
yy_buf_size
 + 2 ,
yysÿÂ”
 );

1990 iàĞ! 
b
->
yy_ch_buf
 )

1991 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch__create_buffer()" );

1993 
b
->
yy_is_our_bufãr
 = 1;

1995 
	`em©ch__š™_bufãr
(
b
,
fe
 ,
yysÿÂ”
);

1997  
b
;

1998 
	}
}

2004 
	$em©ch__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 , 
yysÿn_t
 
yysÿÂ”
)

2006 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2008 iàĞ! 
b
 )

2011 iàĞ
b
 =ğ
YY_CURRENT_BUFFER
 )

2012 
YY_CURRENT_BUFFER_LVALUE
 = (
YY_BUFFER_STATE
) 0;

2014 iàĞ
b
->
yy_is_our_bufãr
 )

2015 
	`em©ch_ä“
((*è
b
->
yy_ch_buf
 ,
yysÿÂ”
 );

2017 
	`em©ch_ä“
((*è
b
 ,
yysÿÂ”
 );

2018 
	}
}

2024 
	$em©ch__š™_bufãr
 (
YY_BUFFER_STATE
 
b
, 
FILE
 * 
fe
 , 
yysÿn_t
 
yysÿÂ”
)

2027 
Û¼no
 = 
”ºo
;

2028 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2030 
	`em©ch__æush_bufãr
(
b
 ,
yysÿÂ”
);

2032 
b
->
yy_šput_fe
 = 
fe
;

2033 
b
->
yy_fl_bufãr
 = 1;

2039 ià(
b
 !ğ
YY_CURRENT_BUFFER
){

2040 
b
->
yy_bs_lš’o
 = 1;

2041 
b
->
yy_bs_cŞumn
 = 0;

2044 
b
->
yy_is_š‹¿ùive
 = 
fe
 ? (
	`i§‰y
Ğ
	`f’o
(file) ) > 0) : 0;

2046 
”ºo
 = 
Û¼no
;

2047 
	}
}

2053 
	$em©ch__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 , 
yysÿn_t
 
yysÿÂ”
)

2055 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2056 iàĞ! 
b
 )

2059 
b
->
yy_n_ch¬s
 = 0;

2065 
b
->
yy_ch_buf
[0] = 
YY_END_OF_BUFFER_CHAR
;

2066 
b
->
yy_ch_buf
[1] = 
YY_END_OF_BUFFER_CHAR
;

2068 
b
->
yy_buf_pos
 = &b->
yy_ch_buf
[0];

2070 
b
->
yy_©_bŞ
 = 1;

2071 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

2073 iàĞ
b
 =ğ
YY_CURRENT_BUFFER
 )

2074 
	`em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

2075 
	}
}

2083 
	$em©ch_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 , 
yysÿn_t
 
yysÿÂ”
)

2085 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2086 ià(
Ãw_bufãr
 =ğ
NULL
)

2089 
	`em©ch_’su»_bufãr_¡ack
(
yysÿÂ”
);

2092 iàĞ
YY_CURRENT_BUFFER
 )

2095 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

2096 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
 = 
yyg
->
yy_c_buf_p
;

2097 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

2101 ià(
YY_CURRENT_BUFFER
)

2102 
yyg
->
yy_bufãr_¡ack_tİ
++;

2103 
YY_CURRENT_BUFFER_LVALUE
 = 
Ãw_bufãr
;

2106 
	`em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

2107 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

2108 
	}
}

2114 
	$em©ch_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

2116 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2117 ià(!
YY_CURRENT_BUFFER
)

2120 
	`em©ch__d–‘e_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
);

2121 
YY_CURRENT_BUFFER_LVALUE
 = 
NULL
;

2122 ià(
yyg
->
yy_bufãr_¡ack_tİ
 > 0)

2123 --
yyg
->
yy_bufãr_¡ack_tİ
;

2125 ià(
YY_CURRENT_BUFFER
) {

2126 
	`em©ch__lßd_bufãr_¡©e
(
yysÿÂ”
 );

2127 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

2129 
	}
}

2134 
	$em©ch_’su»_bufãr_¡ack
 (
yysÿn_t
 
yysÿÂ”
)

2136 
yy_size_t
 
num_to_®loc
;

2137 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2139 ià(!
yyg
->
yy_bufãr_¡ack
) {

2145 
num_to_®loc
 = 1;

2146 
yyg
->
yy_bufãr_¡ack
 = (
yy_bufãr_¡©e
**)
em©ch_®loc


2147 (
num_to_®loc
 * (
yy_bufãr_¡©e
*)

2148 , 
yysÿÂ”
);

2149 iàĞ! 
yyg
->
yy_bufãr_¡ack
 )

2150 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch_ensure_buffer_stack()" );

2152 
	`mem£t
(
yyg
->
yy_bufãr_¡ack
, 0, 
num_to_®loc
 * (
yy_bufãr_¡©e
*));

2154 
yyg
->
yy_bufãr_¡ack_max
 = 
num_to_®loc
;

2155 
yyg
->
yy_bufãr_¡ack_tİ
 = 0;

2159 ià(
yyg
->
yy_bufãr_¡ack_tİ
 >ğ(yyg->
yy_bufãr_¡ack_max
) - 1){

2162 
grow_size
 = 8 ;

2164 
num_to_®loc
 = 
yyg
->
yy_bufãr_¡ack_max
 + 
grow_size
;

2165 
yyg
->
yy_bufãr_¡ack
 = (
yy_bufãr_¡©e
**)
em©ch_»®loc


2166 (
yyg
->
yy_bufãr_¡ack
,

2167 
num_to_®loc
 * (
yy_bufãr_¡©e
*)

2168 , 
yysÿÂ”
);

2169 iàĞ! 
yyg
->
yy_bufãr_¡ack
 )

2170 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch_ensure_buffer_stack()" );

2173 
	`mem£t
(
yyg
->
yy_bufãr_¡ack
 + yyg->
yy_bufãr_¡ack_max
, 0, 
grow_size
 * (
yy_bufãr_¡©e
*));

2174 
yyg
->
yy_bufãr_¡ack_max
 = 
num_to_®loc
;

2176 
	}
}

2184 
YY_BUFFER_STATE
 
	$em©ch__sÿn_bufãr
 (* 
ba£
, 
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

2186 
YY_BUFFER_STATE
 
b
;

2188 iàĞ
size
 < 2 ||

2189 
ba£
[
size
-2] !ğ
YY_END_OF_BUFFER_CHAR
 ||

2190 
ba£
[
size
-1] !ğ
YY_END_OF_BUFFER_CHAR
 )

2194 
b
 = (
YY_BUFFER_STATE
è
	`em©ch_®loc
(Ğ
yy_bufãr_¡©e
 ) ,
yysÿÂ”
 );

2195 iàĞ! 
b
 )

2196 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch__scan_buffer()" );

2198 
b
->
yy_buf_size
 = 
size
 - 2;

2199 
b
->
yy_buf_pos
 = b->
yy_ch_buf
 = 
ba£
;

2200 
b
->
yy_is_our_bufãr
 = 0;

2201 
b
->
yy_šput_fe
 = 0;

2202 
b
->
yy_n_ch¬s
 = b->
yy_buf_size
;

2203 
b
->
yy_is_š‹¿ùive
 = 0;

2204 
b
->
yy_©_bŞ
 = 1;

2205 
b
->
yy_fl_bufãr
 = 0;

2206 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

2208 
	`em©ch__sw™ch_to_bufãr
(
b
 ,
yysÿÂ”
 );

2210  
b
;

2211 
	}
}

2221 
YY_BUFFER_STATE
 
	$em©ch__sÿn_¡ršg
 (
yycÚ¡
 * 
yy¡r
 , 
yysÿn_t
 
yysÿÂ”
)

2224  
	`em©ch__sÿn_by‹s
(
yy¡r
,
	`¡¾’
(yy¡rè,
yysÿÂ”
);

2225 
	}
}

2234 
YY_BUFFER_STATE
 
	$em©ch__sÿn_by‹s
 (
yycÚ¡
 * 
yyby‹s
, 
yy_size_t
 
_yyby‹s_Ën
 , 
yysÿn_t
 
yysÿÂ”
)

2236 
YY_BUFFER_STATE
 
b
;

2237 *
buf
;

2238 
yy_size_t
 
n
;

2239 
yy_size_t
 
i
;

2242 
n
 = 
_yyby‹s_Ën
 + 2;

2243 
buf
 = (*è
	`em©ch_®loc
(
n
 ,
yysÿÂ”
 );

2244 iàĞ! 
buf
 )

2245 
	`YY_FATAL_ERROR
( "out of dynamic memory inƒmatch__scan_bytes()" );

2247  
i
 = 0; i < 
_yyby‹s_Ën
; ++i )

2248 
buf
[
i
] = 
yyby‹s
[i];

2250 
buf
[
_yyby‹s_Ën
] = buf[_yyby‹s_Ën+1] = 
YY_END_OF_BUFFER_CHAR
;

2252 
b
 = 
	`em©ch__sÿn_bufãr
(
buf
,
n
 ,
yysÿÂ”
);

2253 iàĞ! 
b
 )

2254 
	`YY_FATAL_ERROR
( "bad buffer inƒmatch__scan_bytes()" );

2259 
b
->
yy_is_our_bufãr
 = 1;

2261  
b
;

2262 
	}
}

2264 #iâdeà
YY_EXIT_FAILURE


2265 
	#YY_EXIT_FAILURE
 2

	)

2268 
	$yy_çl_”rÜ
 (
yycÚ¡
 * 
msg
 , 
yysÿn_t
 
yysÿÂ”
)

2270 (è
	`årštf
Ğ
¡d”r
, "%s\n", 
msg
 );

2271 
	`ex™
Ğ
YY_EXIT_FAILURE
 );

2272 
	}
}

2276 #undeà
yyËss


2277 
	#yyËss
(
n
) \

2281 
yyËss_maüo_¬g
 = (
n
); \

2282 
	`YY_LESS_LINENO
(
yyËss_maüo_¬g
);\

2283 
yy‹xt
[
yyËng
] = 
yyg
->
yy_hŞd_ch¬
; \

2284 
yyg
->
yy_c_buf_p
 = 
yy‹xt
 + 
yyËss_maüo_¬g
; \

2285 
yyg
->
yy_hŞd_ch¬
 = *yyg->
yy_c_buf_p
; \

2286 *
yyg
->
yy_c_buf_p
 = '\0'; \

2287 
yyËng
 = 
yyËss_maüo_¬g
; \

2289  0 )

	)

2296 
YY_EXTRA_TYPE
 
	$em©ch_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
)

2298 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2299  
yyexŒa
;

2300 
	}
}

2305 
	$em©ch_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
)

2307 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2309 ià(! 
YY_CURRENT_BUFFER
)

2312  
yylš’o
;

2313 
	}
}

2318 
	$em©ch_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
)

2320 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2322 ià(! 
YY_CURRENT_BUFFER
)

2325  
yycŞumn
;

2326 
	}
}

2331 
FILE
 *
	$em©ch_g‘_š
 (
yysÿn_t
 
yysÿÂ”
)

2333 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2334  
yyš
;

2335 
	}
}

2340 
FILE
 *
	$em©ch_g‘_out
 (
yysÿn_t
 
yysÿÂ”
)

2342 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2343  
yyout
;

2344 
	}
}

2349 
yy_size_t
 
	$em©ch_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
)

2351 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2352  
yyËng
;

2353 
	}
}

2359 *
	$em©ch_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
)

2361 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2362  
yy‹xt
;

2363 
	}
}

2369 
	$em©ch_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 , 
yysÿn_t
 
yysÿÂ”
)

2371 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2372 
yyexŒa
 = 
u£r_defšed
 ;

2373 
	}
}

2379 
	$em©ch_£t_lš’o
 (
lše_numb”
 , 
yysÿn_t
 
yysÿÂ”
)

2381 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2384 ià(! 
YY_CURRENT_BUFFER
 )

2385 
	`YY_FATAL_ERROR
( "ematch_set_lineno called with‚o buffer" );

2387 
yylš’o
 = 
lše_numb”
;

2388 
	}
}

2394 
	$em©ch_£t_cŞumn
 (
cŞumn_no
 , 
yysÿn_t
 
yysÿÂ”
)

2396 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2399 ià(! 
YY_CURRENT_BUFFER
 )

2400 
	`YY_FATAL_ERROR
( "ematch_set_column called with‚o buffer" );

2402 
yycŞumn
 = 
cŞumn_no
;

2403 
	}
}

2411 
	$em©ch_£t_š
 (
FILE
 * 
š_¡r
 , 
yysÿn_t
 
yysÿÂ”
)

2413 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2414 
yyš
 = 
š_¡r
 ;

2415 
	}
}

2417 
	$em©ch_£t_out
 (
FILE
 * 
out_¡r
 , 
yysÿn_t
 
yysÿÂ”
)

2419 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2420 
yyout
 = 
out_¡r
 ;

2421 
	}
}

2423 
	$em©ch_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
)

2425 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2426  
yy_æex_debug
;

2427 
	}
}

2429 
	$em©ch_£t_debug
 (
bdebug
 , 
yysÿn_t
 
yysÿÂ”
)

2431 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2432 
yy_æex_debug
 = 
bdebug
 ;

2433 
	}
}

2437 
YYSTYPE
 * 
	$em©ch_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
)

2439 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2440  
yylv®
;

2441 
	}
}

2443 
	$em©ch_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

2445 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2446 
yylv®
 = 
yylv®_·¿m
;

2447 
	}
}

2456 
	$em©ch_Ëx_š™
(
yysÿn_t
* 
±r_yy_glob®s
)

2459 ià(
±r_yy_glob®s
 =ğ
NULL
){

2460 
”ºo
 = 
EINVAL
;

2464 *
±r_yy_glob®s
 = (
yysÿn_t
è
	`em©ch_®loc
 ( Ğ
yyguts_t
 ), 
NULL
 );

2466 ià(*
±r_yy_glob®s
 =ğ
NULL
){

2467 
”ºo
 = 
ENOMEM
;

2472 
	`mem£t
(*
±r_yy_glob®s
,0x00,(
yyguts_t
));

2474  
	`yy_š™_glob®s
 ( *
±r_yy_glob®s
 );

2475 
	}
}

2485 
	$em©ch_Ëx_š™_exŒa
(
YY_EXTRA_TYPE
 
yy_u£r_defšed
,
yysÿn_t
* 
±r_yy_glob®s
 )

2488 
yyguts_t
 
dummy_yyguts
;

2490 
	`em©ch_£t_exŒa
 (
yy_u£r_defšed
, &
dummy_yyguts
);

2492 ià(
±r_yy_glob®s
 =ğ
NULL
){

2493 
”ºo
 = 
EINVAL
;

2497 *
±r_yy_glob®s
 = (
yysÿn_t
è
	`em©ch_®loc
 ( Ğ
yyguts_t
 ), &
dummy_yyguts
 );

2499 ià(*
±r_yy_glob®s
 =ğ
NULL
){

2500 
”ºo
 = 
ENOMEM
;

2506 
	`mem£t
(*
±r_yy_glob®s
,0x00,(
yyguts_t
));

2508 
	`em©ch_£t_exŒa
 (
yy_u£r_defšed
, *
±r_yy_glob®s
);

2510  
	`yy_š™_glob®s
 ( *
±r_yy_glob®s
 );

2511 
	}
}

2513 
	$yy_š™_glob®s
 (
yysÿn_t
 
yysÿÂ”
)

2515 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2520 
yyg
->
yy_bufãr_¡ack
 = 0;

2521 
yyg
->
yy_bufãr_¡ack_tİ
 = 0;

2522 
yyg
->
yy_bufãr_¡ack_max
 = 0;

2523 
yyg
->
yy_c_buf_p
 = (*) 0;

2524 
yyg
->
yy_š™
 = 0;

2525 
yyg
->
yy_¡¬t
 = 0;

2527 
yyg
->
yy_¡¬t_¡ack_±r
 = 0;

2528 
yyg
->
yy_¡¬t_¡ack_d•th
 = 0;

2529 
yyg
->
yy_¡¬t_¡ack
 = 
NULL
;

2532 #ifdeà
YY_STDINIT


2533 
yyš
 = 
¡dš
;

2534 
yyout
 = 
¡dout
;

2536 
yyš
 = (
FILE
 *) 0;

2537 
yyout
 = (
FILE
 *) 0;

2544 
	}
}

2547 
	$em©ch_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
)

2549 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

2552 
YY_CURRENT_BUFFER
){

2553 
	`em©ch__d–‘e_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
 );

2554 
YY_CURRENT_BUFFER_LVALUE
 = 
NULL
;

2555 
	`em©ch_pİ_bufãr_¡©e
(
yysÿÂ”
);

2559 
	`em©ch_ä“
(
yyg
->
yy_bufãr_¡ack
 ,
yysÿÂ”
);

2560 
yyg
->
yy_bufãr_¡ack
 = 
NULL
;

2563 
	`em©ch_ä“
(
yyg
->
yy_¡¬t_¡ack
 ,
yysÿÂ”
 );

2564 
yyg
->
yy_¡¬t_¡ack
 = 
NULL
;

2568 
	`yy_š™_glob®s
Ğ
yysÿÂ”
);

2571 
	`em©ch_ä“
 ( 
yysÿÂ”
 , yyscanner );

2572 
yysÿÂ”
 = 
NULL
;

2574 
	}
}

2580 #iâdeà
yy‹xt_±r


2581 
	$yy_æex_¡ºıy
 (* 
s1
, 
yycÚ¡
 * 
s2
, 
n
 , 
yysÿn_t
 
yysÿÂ”
)

2583 
i
;

2584  
i
 = 0; i < 
n
; ++i )

2585 
s1
[
i
] = 
s2
[i];

2586 
	}
}

2589 #ifdeà
YY_NEED_STRLEN


2590 
	$yy_æex_¡¾’
 (
yycÚ¡
 * 
s
 , 
yysÿn_t
 
yysÿÂ”
)

2592 
n
;

2593  
n
 = 0; 
s
[n]; ++n )

2596  
n
;

2597 
	}
}

2600 *
	$em©ch_®loc
 (
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

2602  (*è
	`m®loc
Ğ
size
 );

2603 
	}
}

2605 *
	$em©ch_»®loc
 (* 
±r
, 
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

2614  (*è
	`»®loc
Ğ(*è
±r
, 
size
 );

2615 
	}
}

2617 
	$em©ch_ä“
 (* 
±r
 , 
yysÿn_t
 
yysÿÂ”
)

2619 
	`ä“
Ğ(*è
±r
 );

2620 
	}
}

2622 
	#YYTABLES_NAME
 "yybËs"

	)

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.h

1 #iâdeà
em©ch_HEADER_H


2 
	#em©ch_HEADER_H
 1

	)

3 
	#em©ch_IN_HEADER
 1

	)

9 
	#YY_INT_ALIGNED
 

	)

13 
	#FLEX_SCANNER


	)

14 
	#YY_FLEX_MAJOR_VERSION
 2

	)

15 
	#YY_FLEX_MINOR_VERSION
 5

	)

16 
	#YY_FLEX_SUBMINOR_VERSION
 39

	)

17 #ià
YY_FLEX_SUBMINOR_VERSION
 > 0

18 
	#FLEX_BETA


	)

24 
	~<¡dio.h
>

25 
	~<¡ršg.h
>

26 
	~<”ºo.h
>

27 
	~<¡dlib.h
>

33 #iâdeà
FLEXINT_H


34 
	#FLEXINT_H


	)

38 #ià
defšed
 (
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

43 #iâdeà
__STDC_LIMIT_MACROS


44 
	#__STDC_LIMIT_MACROS
 1

	)

47 
	~<š‰y³s.h
>

48 
št8_t
 
	tæex_št8_t
;

49 
ušt8_t
 
	tæex_ušt8_t
;

50 
št16_t
 
	tæex_št16_t
;

51 
ušt16_t
 
	tæex_ušt16_t
;

52 
št32_t
 
	tæex_št32_t
;

53 
ušt32_t
 
	tæex_ušt32_t
;

55 sigÃd 
	tæex_št8_t
;

56 
	tæex_št16_t
;

57 
	tæex_št32_t
;

58 
	tæex_ušt8_t
;

59 
	tæex_ušt16_t
;

60 
	tæex_ušt32_t
;

63 #iâdeà
INT8_MIN


64 
	#INT8_MIN
 (-128)

	)

66 #iâdeà
INT16_MIN


67 
	#INT16_MIN
 (-32767-1)

	)

69 #iâdeà
INT32_MIN


70 
	#INT32_MIN
 (-2147483647-1)

	)

72 #iâdeà
INT8_MAX


73 
	#INT8_MAX
 (127)

	)

75 #iâdeà
INT16_MAX


76 
	#INT16_MAX
 (32767)

	)

78 #iâdeà
INT32_MAX


79 
	#INT32_MAX
 (2147483647)

	)

81 #iâdeà
UINT8_MAX


82 
	#UINT8_MAX
 (255U)

	)

84 #iâdeà
UINT16_MAX


85 
	#UINT16_MAX
 (65535U)

	)

87 #iâdeà
UINT32_MAX


88 
	#UINT32_MAX
 (4294967295U)

	)

95 #ifdeà
__ılu¥lus


98 
	#YY_USE_CONST


	)

103 #ià
defšed
 (
__STDC__
)

105 
	#YY_USE_CONST


	)

110 #ifdeà
YY_USE_CONST


111 
	#yycÚ¡
 cÚ¡

	)

113 
	#yycÚ¡


	)

117 #iâdeà
YY_TYPEDEF_YY_SCANNER_T


118 
	#YY_TYPEDEF_YY_SCANNER_T


	)

119 * 
	tyysÿn_t
;

124 
	#yyš
 
yyg
->
yyš_r


	)

125 
	#yyout
 
yyg
->
yyout_r


	)

126 
	#yyexŒa
 
yyg
->
yyexŒa_r


	)

127 
	#yyËng
 
yyg
->
yyËng_r


	)

128 
	#yy‹xt
 
yyg
->
yy‹xt_r


	)

129 
	#yylš’o
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_lš’o
)

	)

130 
	#yycŞumn
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_cŞumn
)

	)

131 
	#yy_æex_debug
 
yyg
->
yy_æex_debug_r


	)

134 #iâdeà
YY_BUF_SIZE


135 #ifdeà
__Ÿ64__


140 
	#YY_BUF_SIZE
 32768

	)

142 
	#YY_BUF_SIZE
 16384

	)

146 #iâdeà
YY_TYPEDEF_YY_BUFFER_STATE


147 
	#YY_TYPEDEF_YY_BUFFER_STATE


	)

148 
yy_bufãr_¡©e
 *
	tYY_BUFFER_STATE
;

151 #iâdeà
YY_TYPEDEF_YY_SIZE_T


152 
	#YY_TYPEDEF_YY_SIZE_T


	)

153 
size_t
 
	tyy_size_t
;

156 #iâdeà
YY_STRUCT_YY_BUFFER_STATE


157 
	#YY_STRUCT_YY_BUFFER_STATE


	)

158 
	syy_bufãr_¡©e


160 
FILE
 *
	myy_šput_fe
;

162 *
	myy_ch_buf
;

163 *
	myy_buf_pos
;

168 
yy_size_t
 
	myy_buf_size
;

173 
yy_size_t
 
	myy_n_ch¬s
;

179 
	myy_is_our_bufãr
;

186 
	myy_is_š‹¿ùive
;

192 
	myy_©_bŞ
;

194 
	myy_bs_lš’o
;

195 
	myy_bs_cŞumn
;

200 
	myy_fl_bufãr
;

202 
	myy_bufãr_¡©us
;

207 
em©ch_»¡¬t
 (
FILE
 *
šput_fe
 ,
yysÿn_t
 
yysÿÂ”
 );

208 
em©ch__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

209 
YY_BUFFER_STATE
 
em©ch__ü—‹_bufãr
 (
FILE
 *
fe
,
size
 ,
yysÿn_t
 
yysÿÂ”
 );

210 
em©ch__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

211 
em©ch__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

212 
em©ch_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

213 
em©ch_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

215 
YY_BUFFER_STATE
 
em©ch__sÿn_bufãr
 (*
ba£
,
yy_size_t
 
size
 ,
yysÿn_t
 
yysÿÂ”
 );

216 
YY_BUFFER_STATE
 
em©ch__sÿn_¡ršg
 (
yycÚ¡
 *
yy_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

217 
YY_BUFFER_STATE
 
em©ch__sÿn_by‹s
 (
yycÚ¡
 *
by‹s
,
yy_size_t
 
Ën
 ,
yysÿn_t
 
yysÿÂ”
 );

219 *
em©ch_®loc
 (
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

220 *
em©ch_»®loc
 (*,
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

221 
em©ch_ä“
 (* ,
yysÿn_t
 
yysÿÂ”
 );

223 
	#em©ch_w¿p
(
yysÿÂ”
è1

	)

224 
	#YY_SKIP_YYWRAP


	)

226 
	#yy‹xt_±r
 
yy‹xt_r


	)

228 #ifdeà
YY_HEADER_EXPORT_START_CONDITIONS


229 
	#INITIAL
 0

	)

230 
	#QUOTE
 1

	)

234 #iâdeà
YY_NO_UNISTD_H


239 
	~<uni¡d.h
>

242 #iâdeà
YY_EXTRA_TYPE


243 
	#YY_EXTRA_TYPE
 *

	)

246 
em©ch_Ëx_š™
 (
yysÿn_t
* 
sÿÂ”
);

248 
em©ch_Ëx_š™_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
,
yysÿn_t
* 
sÿÂ”
);

253 
em©ch_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
 );

255 
em©ch_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
 );

257 
em©ch_£t_debug
 (
debug_æag
 ,
yysÿn_t
 
yysÿÂ”
 );

259 
YY_EXTRA_TYPE
 
em©ch_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
 );

261 
em©ch_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 ,
yysÿn_t
 
yysÿÂ”
 );

263 
FILE
 *
em©ch_g‘_š
 (
yysÿn_t
 
yysÿÂ”
 );

265 
em©ch_£t_š
 (
FILE
 * 
š_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

267 
FILE
 *
em©ch_g‘_out
 (
yysÿn_t
 
yysÿÂ”
 );

269 
em©ch_£t_out
 (
FILE
 * 
out_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

271 
yy_size_t
 
em©ch_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
 );

273 *
em©ch_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
 );

275 
em©ch_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
 );

277 
em©ch_£t_lš’o
 (
lše_numb”
 ,
yysÿn_t
 
yysÿÂ”
 );

279 
em©ch_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
 );

281 
em©ch_£t_cŞumn
 (
cŞumn_no
 ,
yysÿn_t
 
yysÿÂ”
 );

283 
YYSTYPE
 * 
em©ch_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
 );

285 
em©ch_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

291 #iâdeà
YY_SKIP_YYWRAP


292 #ifdeà
__ılu¥lus


293 "C" 
em©ch_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

295 
em©ch_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

299 #iâdeà
yy‹xt_±r


300 
yy_æex_¡ºıy
 (*,
yycÚ¡
 *,,
yysÿn_t
 
yysÿÂ”
);

303 #ifdeà
YY_NEED_STRLEN


304 
yy_æex_¡¾’
 (
yycÚ¡
 * ,
yysÿn_t
 
yysÿÂ”
);

307 #iâdeà
YY_NO_INPUT


312 #iâdeà
YY_READ_BUF_SIZE


313 #ifdeà
__Ÿ64__


315 
	#YY_READ_BUF_SIZE
 16384

	)

317 
	#YY_READ_BUF_SIZE
 8192

	)

322 #iâdeà
YY_START_STACK_INCR


323 
	#YY_START_STACK_INCR
 25

	)

329 #iâdeà
YY_DECL


330 
	#YY_DECL_IS_OURS
 1

	)

332 
em©ch_Ëx
 \

333 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
);

335 
	#YY_DECL
 
em©ch_Ëx
 \

336 (
YYSTYPE
 * 
yylv®_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

	)

341 #undeà
YY_NEW_FILE


342 #undeà
YY_FLUSH_BUFFER


343 #undeà
yy_£t_bŞ


344 #undeà
yy_Ãw_bufãr


345 #undeà
yy_£t_š‹¿ùive


346 #undeà
YY_DO_BEFORE_ACTION


348 #ifdeà
YY_DECL_IS_OURS


349 #undeà
YY_DECL_IS_OURS


350 #undeà
YY_DECL


356 #undeà
em©ch_IN_HEADER


	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.l

13 
	~<Ãšk-´iv©e/Ãšk.h
>

14 
	~<Ãšk-´iv©e/tc.h
>

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/rou‹/şs/em©ch.h
>

17 
	~<Ãšk/rou‹/şs/em©ch/cmp.h
>

18 
	~"em©ch_syÁax.h
"

21 %
İtiÚ
 8b
™


22 %
İtiÚ
 
»’Œªt


23 %
İtiÚ
 
w¬n


24 %
İtiÚ
 
noyyw¿p


25 %
İtiÚ
 
nošput


26 %
İtiÚ
 
nouÅut


27 %
İtiÚ
 
bisÚ
-
bridge


28 %
İtiÚ
 
´efix
="ematch_"

30 %
x
 
QUOTE


32 %% /* 
	$yyËx
 */

34 [ \
t
\
r
\
n
]+

37 
	`NL_DBG
(4, "Beginning of quote\n");

38 
yylv®
->
q
.
Ën
 = 32;

39 ià(!(
yylv®
->
q
.
d©a
 = 
	`ÿÎoc
(1, yylv®->q.
Ën
)))

40  
ERROR
;

42 
yylv®
->
q
.
šdex
 = 0;

43 
	`BEGIN
(
QUOTE
);

46 <
QUOTE
>[^\\\
n
\"]+ {

47 
	`memıy
(
yylv®
->
q
.
d©a
 + yylv®->q.
šdex
, 
yy‹xt
,

48 
	`¡¾’
(
yy‹xt
));

49 
yylv®
->
q
.
šdex
 +ğ
	`¡¾’
(
yy‹xt
);

52 <
QUOTE
>\" {

53 
	`BEGIN
(0);

54  
QUOTED
;

58 [[:
dig™
:]]+ |

59 0[
xX
][[:
xdig™
:]]+ {

60 
yylv®
->
i
 = 
	`¡¹oul
(
yy‹xt
, 
NULL
, 0);

61  
NUMBER
;

64 
eq
 |

65 "="  
KW_EQ
;

66 
gt
 |

67 ">"  
KW_GT
;

68 
É
 |

69 "<"  
KW_LT
;

71 [
aA
][
nN
][
dD
] |

72 "&&" { 
yylv®
->
i
 = 
TCF_EM_REL_AND
;  
LOGIC
; }

73 [
oO
][
rR
] |

74 "||" { 
yylv®
->
i
 = 
TCF_EM_REL_OR
;  
LOGIC
; }

75 [
nN
][
oO
][
tT
] |

76 "!"  
NOT
;

78 [
cC
][
mM
][
pP
] { 
yylv®
->
i
 = 
TCF_EM_CMP
;  
EMATCH_CMP
; }

79 [
pP
][
aA
][
tT
][tT][
eE
][
rR
][
nN
] { 
yylv®
->
i
 = 
TCF_EM_NBYTE
;  
EMATCH_NBYTE
; }

80 [
tT
][
eE
][
xX
][tT] { 
yylv®
->
i
 = 
TCF_EM_TEXT
;  
EMATCH_TEXT
; }

81 [
mM
][
eE
][
tT
][
aA
] { 
yylv®
->
i
 = 
TCF_EM_META
;  
EMATCH_META
; }

83 "("  
KW_OPEN
;

84 ")"  
KW_CLOSE
;

85 [
mM
][
aA
][
sS
][
kK
] |

86 "&"  
KW_MASK
;

87 [
sS
][
hH
][
iI
][
fF
][
tT
] |

88 ">>"  
KW_SHIFT
;

89 [
aA
][
tT
]  
KW_AT
;

90 "+"  
KW_PLUS
;

91 [
fF
][
rR
][
oO
][
mM
]  
KW_FROM
;

92 [
tT
][
oO
]  
KW_TO
;

94 [
uU
]8 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U8
;  
ALIGN
; }

95 [
uU
]16 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U16
;  
ALIGN
; }

96 [
uU
]32 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U32
;  
ALIGN
; }

98 [
lL
][
iI
][
nN
][
kK
] |

99 [
eE
][
tT
][
hH
] { 
yylv®
->
i
 = 
TCF_LAYER_LINK
;  
LAYER
; }

100 [
nN
][
eE
][
tT
] |

101 [
iI
][
pP
]6 |

102 [
iI
][
pP
] { 
yylv®
->
i
 = 
TCF_LAYER_NETWORK
;  
LAYER
; }

103 [
tT
][
rR
][
aA
][
nN
][
sS
][
pP
][
oO
][rR][tT] |

104 [
tT
][
cC
][
pP
] { 
yylv®
->
i
 = 
TCF_LAYER_TRANSPORT
;  
LAYER
; }

106 
¿ndom
  
META_RANDOM
;

107 
lßdavg_0
  
META_LOADAVG_0
;

108 
lßdavg_1
  
META_LOADAVG_1
;

109 
lßdavg_2
  
META_LOADAVG_2
;

110 
dev
  
META_DEV
;

111 
´io
  
META_PRIO
;

112 
´Ùo
  
META_PROTO
;

113 
pk‰y³
  
META_PKTTYPE
;

114 
pk’
  
META_PKTLEN
;

115 
d©®’
  
META_DATALEN
;

116 
maş’
  
META_MACLEN
;

117 
m¬k
  
META_MARK
;

118 
tcšdex
  
META_TCINDEX
;

119 
¹şassid
  
META_RTCLASSID
;

120 
¹iif
  
META_RTIIF
;

121 
sk_çmy
  
META_SK_FAMILY
;

122 
sk_¡©e
  
META_SK_STATE
;

123 
sk_»u£
  
META_SK_REUSE
;

124 
sk_»fút
  
META_SK_REFCNT
;

125 
sk_rcvbuf
  
META_SK_RCVBUF
;

126 
sk_¢dbuf
  
META_SK_SNDBUF
;

127 
sk_shutdown
  
META_SK_SHUTDOWN
;

128 
sk_´Ùo
  
META_SK_PROTO
;

129 
sk_ty³
  
META_SK_TYPE
;

130 
sk_rmem_®loc
  
META_SK_RMEM_ALLOC
;

131 
sk_wmem_®loc
  
META_SK_WMEM_ALLOC
;

132 
sk_wmem_queued
  
META_SK_WMEM_QUEUED
;

133 
sk_rcv_qËn
  
META_SK_RCV_QLEN
;

134 
sk_¢d_qËn
  
META_SK_SND_QLEN
;

135 
sk_”r_qËn
  
META_SK_ERR_QLEN
;

136 
sk_fÜw¬d_®locs
  
META_SK_FORWARD_ALLOCS
;

137 
sk_®locs
  
META_SK_ALLOCS
;

138 
sk_rou‹_ÿps
  
META_SK_ROUTE_CAPS
;

139 
sk_hash
  
META_SK_HASH
;

140 
sk_lšg”time
  
META_SK_LINGERTIME
;

141 
sk_ack_backlog
  
META_SK_ACK_BACKLOG
;

142 
sk_max_ack_backlog
  
META_SK_MAX_ACK_BACKLOG
;

143 
sk_´io
  
META_SK_PRIO
;

144 
sk_rcvlow©
  
META_SK_RCVLOWAT
;

145 
sk_rcvtimeo
  
META_SK_RCVTIMEO
;

146 
sk_¢dtimeo
  
META_SK_SNDTIMEO
;

147 
sk_£ndmsg_off
  
META_SK_SENDMSG_OFF
;

148 
sk_wr™e_³ndšg
  
META_SK_WRITE_PENDING
;

149 
vÏn
  
META_VLAN
;

150 
rxhash
  
META_RXHASH
;

152 
devÇme
  
META_DEVNAME
;

153 
sk_bound_if
  
META_SK_BOUND_IF
;

156 [^ \
t
\
r
\
n
+()=<>&|\"]+ {

157 
yylv®
->
s
 = 
	`¡rdup
(
yy‹xt
);

158 ià(
yylv®
->
s
 =ğ
NULL
)

159  
ERROR
;

160 
	`NL_DBG
(4, "Ëx STR=%s\n", 
yylv®
->
s
);

161  
STR
;

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.c

44 
	#YYBISON
 1

	)

47 
	#YYBISON_VERSION
 "3.0.2"

	)

50 
	#YYSKELETON_NAME
 "yacc.c"

	)

53 
	#YYPURE
 1

	)

56 
	#YYPUSH
 0

	)

59 
	#YYPULL
 1

	)

63 
	#yy·r£
 
em©ch_·r£


	)

64 
	#yyËx
 
em©ch_Ëx


	)

65 
	#yy”rÜ
 
em©ch_”rÜ


	)

66 
	#yydebug
 
em©ch_debug


	)

67 
	#yyÃ¼s
 
em©ch_Ã¼s


	)

73 
	~<Ãšk-´iv©e/Ãšk.h
>

74 
	~<Ãšk-´iv©e/tc.h
>

75 
	~<Ãšk/Ãšk.h
>

76 
	~<Ãšk/uts.h
>

77 
	~<Ãšk/rou‹/pkoc.h
>

78 
	~<Ãšk/rou‹/şs/em©ch.h
>

79 
	~<Ãšk/rou‹/şs/em©ch/cmp.h
>

80 
	~<Ãšk/rou‹/şs/em©ch/nby‹.h
>

81 
	~<Ãšk/rou‹/şs/em©ch/‹xt.h
>

82 
	~<Ãšk/rou‹/şs/em©ch/m‘a.h
>

84 
	#META_ALLOC
 
¹Æ_m‘a_v®ue_®loc_id


	)

85 
	#META_ID
(
Çme
è
TCF_META_ID_
##
	)
Çme

86 
	#META_INT
 
TCF_META_TYPE_INT


	)

87 
	#META_VAR
 
TCF_META_TYPE_VAR


	)

91 #iâdeà
YY_NULLPTR


92 #ià
defšed
 
__ılu¥lus
 && 201103L <= __cplusplus

93 
	#YY_NULLPTR
 
nuÎ±r


	)

95 
	#YY_NULLPTR
 0

	)

100 #ifdeà
YYERROR_VERBOSE


101 #undeà
YYERROR_VERBOSE


102 
	#YYERROR_VERBOSE
 1

	)

104 
	#YYERROR_VERBOSE
 1

	)

109 #iâdeà
YY_EMATCH_ROUTE_CLS_EMATCH_SYNTAX_H_INCLUDED


110 
	#YY_EMATCH_ROUTE_CLS_EMATCH_SYNTAX_H_INCLUDED


	)

112 #iâdeà
YYDEBUG


113 
	#YYDEBUG
 0

	)

115 #ià
YYDEBUG


116 
em©ch_debug
;

120 #iâdeà
YYTOKENTYPE


121 
	#YYTOKENTYPE


	)

122 
	eyytok’ty³


124 
	mERROR
 = 258,

125 
	mLOGIC
 = 259,

126 
	mNOT
 = 260,

127 
	mOPERAND
 = 261,

128 
	mNUMBER
 = 262,

129 
	mALIGN
 = 263,

130 
	mLAYER
 = 264,

131 
	mKW_OPEN
 = 265,

132 
	mKW_CLOSE
 = 266,

133 
	mKW_PLUS
 = 267,

134 
	mKW_MASK
 = 268,

135 
	mKW_SHIFT
 = 269,

136 
	mKW_AT
 = 270,

137 
	mEMATCH_CMP
 = 271,

138 
	mEMATCH_NBYTE
 = 272,

139 
	mEMATCH_TEXT
 = 273,

140 
	mEMATCH_META
 = 274,

141 
	mKW_EQ
 = 275,

142 
	mKW_GT
 = 276,

143 
	mKW_LT
 = 277,

144 
	mKW_FROM
 = 278,

145 
	mKW_TO
 = 279,

146 
	mMETA_RANDOM
 = 280,

147 
	mMETA_LOADAVG_0
 = 281,

148 
	mMETA_LOADAVG_1
 = 282,

149 
	mMETA_LOADAVG_2
 = 283,

150 
	mMETA_DEV
 = 284,

151 
	mMETA_PRIO
 = 285,

152 
	mMETA_PROTO
 = 286,

153 
	mMETA_PKTTYPE
 = 287,

154 
	mMETA_PKTLEN
 = 288,

155 
	mMETA_DATALEN
 = 289,

156 
	mMETA_MACLEN
 = 290,

157 
	mMETA_MARK
 = 291,

158 
	mMETA_TCINDEX
 = 292,

159 
	mMETA_RTCLASSID
 = 293,

160 
	mMETA_RTIIF
 = 294,

161 
	mMETA_SK_FAMILY
 = 295,

162 
	mMETA_SK_STATE
 = 296,

163 
	mMETA_SK_REUSE
 = 297,

164 
	mMETA_SK_REFCNT
 = 298,

165 
	mMETA_SK_RCVBUF
 = 299,

166 
	mMETA_SK_SNDBUF
 = 300,

167 
	mMETA_SK_SHUTDOWN
 = 301,

168 
	mMETA_SK_PROTO
 = 302,

169 
	mMETA_SK_TYPE
 = 303,

170 
	mMETA_SK_RMEM_ALLOC
 = 304,

171 
	mMETA_SK_WMEM_ALLOC
 = 305,

172 
	mMETA_SK_WMEM_QUEUED
 = 306,

173 
	mMETA_SK_RCV_QLEN
 = 307,

174 
	mMETA_SK_SND_QLEN
 = 308,

175 
	mMETA_SK_ERR_QLEN
 = 309,

176 
	mMETA_SK_FORWARD_ALLOCS
 = 310,

177 
	mMETA_SK_ALLOCS
 = 311,

178 
	mMETA_SK_ROUTE_CAPS
 = 312,

179 
	mMETA_SK_HASH
 = 313,

180 
	mMETA_SK_LINGERTIME
 = 314,

181 
	mMETA_SK_ACK_BACKLOG
 = 315,

182 
	mMETA_SK_MAX_ACK_BACKLOG
 = 316,

183 
	mMETA_SK_PRIO
 = 317,

184 
	mMETA_SK_RCVLOWAT
 = 318,

185 
	mMETA_SK_RCVTIMEO
 = 319,

186 
	mMETA_SK_SNDTIMEO
 = 320,

187 
	mMETA_SK_SENDMSG_OFF
 = 321,

188 
	mMETA_SK_WRITE_PENDING
 = 322,

189 
	mMETA_VLAN
 = 323,

190 
	mMETA_RXHASH
 = 324,

191 
	mMETA_DEVNAME
 = 325,

192 
	mMETA_SK_BOUND_IF
 = 326,

193 
	mSTR
 = 327,

194 
	mQUOTED
 = 328

198 
	#ERROR
 258

	)

199 
	#LOGIC
 259

	)

200 
	#NOT
 260

	)

201 
	#OPERAND
 261

	)

202 
	#NUMBER
 262

	)

203 
	#ALIGN
 263

	)

204 
	#LAYER
 264

	)

205 
	#KW_OPEN
 265

	)

206 
	#KW_CLOSE
 266

	)

207 
	#KW_PLUS
 267

	)

208 
	#KW_MASK
 268

	)

209 
	#KW_SHIFT
 269

	)

210 
	#KW_AT
 270

	)

211 
	#EMATCH_CMP
 271

	)

212 
	#EMATCH_NBYTE
 272

	)

213 
	#EMATCH_TEXT
 273

	)

214 
	#EMATCH_META
 274

	)

215 
	#KW_EQ
 275

	)

216 
	#KW_GT
 276

	)

217 
	#KW_LT
 277

	)

218 
	#KW_FROM
 278

	)

219 
	#KW_TO
 279

	)

220 
	#META_RANDOM
 280

	)

221 
	#META_LOADAVG_0
 281

	)

222 
	#META_LOADAVG_1
 282

	)

223 
	#META_LOADAVG_2
 283

	)

224 
	#META_DEV
 284

	)

225 
	#META_PRIO
 285

	)

226 
	#META_PROTO
 286

	)

227 
	#META_PKTTYPE
 287

	)

228 
	#META_PKTLEN
 288

	)

229 
	#META_DATALEN
 289

	)

230 
	#META_MACLEN
 290

	)

231 
	#META_MARK
 291

	)

232 
	#META_TCINDEX
 292

	)

233 
	#META_RTCLASSID
 293

	)

234 
	#META_RTIIF
 294

	)

235 
	#META_SK_FAMILY
 295

	)

236 
	#META_SK_STATE
 296

	)

237 
	#META_SK_REUSE
 297

	)

238 
	#META_SK_REFCNT
 298

	)

239 
	#META_SK_RCVBUF
 299

	)

240 
	#META_SK_SNDBUF
 300

	)

241 
	#META_SK_SHUTDOWN
 301

	)

242 
	#META_SK_PROTO
 302

	)

243 
	#META_SK_TYPE
 303

	)

244 
	#META_SK_RMEM_ALLOC
 304

	)

245 
	#META_SK_WMEM_ALLOC
 305

	)

246 
	#META_SK_WMEM_QUEUED
 306

	)

247 
	#META_SK_RCV_QLEN
 307

	)

248 
	#META_SK_SND_QLEN
 308

	)

249 
	#META_SK_ERR_QLEN
 309

	)

250 
	#META_SK_FORWARD_ALLOCS
 310

	)

251 
	#META_SK_ALLOCS
 311

	)

252 
	#META_SK_ROUTE_CAPS
 312

	)

253 
	#META_SK_HASH
 313

	)

254 
	#META_SK_LINGERTIME
 314

	)

255 
	#META_SK_ACK_BACKLOG
 315

	)

256 
	#META_SK_MAX_ACK_BACKLOG
 316

	)

257 
	#META_SK_PRIO
 317

	)

258 
	#META_SK_RCVLOWAT
 318

	)

259 
	#META_SK_RCVTIMEO
 319

	)

260 
	#META_SK_SNDTIMEO
 320

	)

261 
	#META_SK_SENDMSG_OFF
 321

	)

262 
	#META_SK_WRITE_PENDING
 322

	)

263 
	#META_VLAN
 323

	)

264 
	#META_RXHASH
 324

	)

265 
	#META_DEVNAME
 325

	)

266 
	#META_SK_BOUND_IF
 326

	)

267 
	#STR
 327

	)

268 
	#QUOTED
 328

	)

271 #ià! 
defšed
 
YYSTYPE
 && ! defšed 
YYSTYPE_IS_DECLARED


272 
YYSTYPE
 
	tYYSTYPE
;

273 
	uYYSTYPE


277 
tcf_em_cmp
 
	mcmp
;

278 
em©ch_quÙed
 
	mq
;

279 
¹Æ_em©ch
 * 
	me
;

280 
¹Æ_pkoc
 * 
	mloc
;

281 
¹Æ_m‘a_v®ue
 *
	mmv
;

282 
ušt32_t
 
	mi
;

283 
ušt64_t
 
	mi64
;

284 * 
	ms
;

288 
	#YYSTYPE_IS_TRIVIAL
 1

	)

289 
	#YYSTYPE_IS_DECLARED
 1

	)

294 
em©ch_·r£
 (*
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
);

301 
em©ch_Ëx
(
YYSTYPE
 *, *);

303 
	$yy”rÜ
(*
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
, cÚ¡ *
msg
)

305 ià(
msg
)

306 *
”½
 = 
	`¡rdup
(
msg
);

308 *
”½
 = 
NULL
;

309 
	}
}

317 #ifdeà
YYTYPE_UINT8


318 
YYTYPE_UINT8
 
	tyyty³_ušt8
;

320 
	tyyty³_ušt8
;

323 #ifdeà
YYTYPE_INT8


324 
YYTYPE_INT8
 
	tyyty³_št8
;

326 sigÃd 
	tyyty³_št8
;

329 #ifdeà
YYTYPE_UINT16


330 
YYTYPE_UINT16
 
	tyyty³_ušt16
;

332 
	tyyty³_ušt16
;

335 #ifdeà
YYTYPE_INT16


336 
YYTYPE_INT16
 
	tyyty³_št16
;

338 
	tyyty³_št16
;

341 #iâdeà
YYSIZE_T


342 #ifdeà
__SIZE_TYPE__


343 
	#YYSIZE_T
 
__SIZE_TYPE__


	)

344 #–ià
defšed
 
size_t


345 
	#YYSIZE_T
 
size_t


	)

346 #–ià! 
defšed
 
YYSIZE_T


347 
	~<¡ddef.h
>

348 
	#YYSIZE_T
 
size_t


	)

350 
	#YYSIZE_T
 

	)

354 
	#YYSIZE_MAXIMUM
 ((
YYSIZE_T
è-1)

	)

356 #iâdeà
YY_


357 #ià
defšed
 
YYENABLE_NLS
 && YYENABLE_NLS

358 #ià
ENABLE_NLS


359 
	~<libš.h
>

360 
	#YY_
(
Msgid
è
	`dg‘‹xt
 ("bisÚ-ruÁime", Msgid)

	)

363 #iâdeà
YY_


364 
	#YY_
(
Msgid
è
	)
Msgid

368 #iâdeà
YY_ATTRIBUTE


369 #ià(
defšed
 
__GNUC__
 \

370 && (2 < 
	g__GNUC__
 || (__GNUC__ =ğ2 && 96 <ğ
__GNUC_MINOR__
))) \

371 || 
defšed
 
__SUNPRO_C
 && 0x5110 <= __SUNPRO_C

372 
	#YY_ATTRIBUTE
(
S³c
è
	`__©Œibu‹__
(S³c)

	)

374 
	#YY_ATTRIBUTE
(
S³c
è

	)

378 #iâdeà
YY_ATTRIBUTE_PURE


379 
	#YY_ATTRIBUTE_PURE
 
	`YY_ATTRIBUTE
 ((
__pu»__
))

	)

382 #iâdeà
YY_ATTRIBUTE_UNUSED


383 
	#YY_ATTRIBUTE_UNUSED
 
	`YY_ATTRIBUTE
 ((
__unu£d__
))

	)

386 #ià!
defšed
 
_NÜ‘uº
 \

387 && (!
defšed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 201112)

388 #ià
defšed
 
_MSC_VER
 && 1200 <= _MSC_VER

389 
	#_NÜ‘uº
 
	`__deş¥ec
 (
nÜ‘uº
)

	)

391 
	#_NÜ‘uº
 
	`YY_ATTRIBUTE
 ((
__nÜ‘uº__
))

	)

396 #ià! 
defšed
 
lšt
 || defšed 
__GNUC__


397 
	#YYUSE
(
E
è((è(E))

	)

399 
	#YYUSE
(
E
è

	)

402 #ià
defšed
 
__GNUC__
 && 407 <ğ__GNUC__ * 100 + 
__GNUC_MINOR__


404 
	#YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN
 \

405 
	`_P¿gma
 ("GCC diagnostic…ush") \

406 
	`_P¿gma
 ("GCC diagnostic ignored \"-Wuninitialized\"")\

407 
	`_P¿gma
 ("GCC dŸgno¡iøignÜed \"-Wmaybe-unš™Ÿlized\"")

	)

408 
	#YY_IGNORE_MAYBE_UNINITIALIZED_END
 \

409 
	`_P¿gma
 ("GCC dŸgno¡iøpİ")

	)

411 
	#YY_INITIAL_VALUE
(
V®ue
è
	)
V®ue

413 #iâdeà
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


414 
	#YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


	)

415 
	#YY_IGNORE_MAYBE_UNINITIALIZED_END


	)

417 #iâdeà
YY_INITIAL_VALUE


418 
	#YY_INITIAL_VALUE
(
V®ue
è

	)

422 #ià! 
defšed
 
yyov”æow
 || 
YYERROR_VERBOSE


426 #ifdeà
YYSTACK_USE_ALLOCA


427 #ià
YYSTACK_USE_ALLOCA


428 #ifdeà
__GNUC__


429 
	#YYSTACK_ALLOC
 
__butš_®loÿ


	)

430 #–ià
defšed
 
__BUILTIN_VA_ARG_INCR


431 
	~<®loÿ.h
>

432 #–ià
defšed
 
_AIX


433 
	#YYSTACK_ALLOC
 
__®loÿ


	)

434 #–ià
defšed
 
_MSC_VER


435 
	~<m®loc.h
>

436 
	#®loÿ
 
_®loÿ


	)

438 
	#YYSTACK_ALLOC
 
®loÿ


	)

439 #ià! 
defšed
 
_ALLOCA_H
 && ! defšed 
EXIT_SUCCESS


440 
	~<¡dlib.h
>

442 #iâdeà
EXIT_SUCCESS


443 
	#EXIT_SUCCESS
 0

	)

450 #ifdeà
YYSTACK_ALLOC


452 
	#YYSTACK_FREE
(
PŒ
èdØ{ ; } 0)

	)

453 #iâdeà
YYSTACK_ALLOC_MAXIMUM


458 
	#YYSTACK_ALLOC_MAXIMUM
 4032

	)

461 
	#YYSTACK_ALLOC
 
YYMALLOC


	)

462 
	#YYSTACK_FREE
 
YYFREE


	)

463 #iâdeà
YYSTACK_ALLOC_MAXIMUM


464 
	#YYSTACK_ALLOC_MAXIMUM
 
YYSIZE_MAXIMUM


	)

466 #ià(
defšed
 
__ılu¥lus
 && ! defšed 
EXIT_SUCCESS
 \

467 && ! ((
defšed
 
	gYYMALLOC
 || defšed 
	gm®loc
) \

468 && (
defšed
 
	gYYFREE
 || defšed 
	gä“
)))

469 
	~<¡dlib.h
>

470 #iâdeà
EXIT_SUCCESS


471 
	#EXIT_SUCCESS
 0

	)

474 #iâdeà
YYMALLOC


475 
	#YYMALLOC
 
m®loc


	)

476 #ià! 
defšed
 
m®loc
 && ! defšed 
EXIT_SUCCESS


477 *
m®loc
 (
YYSIZE_T
);

480 #iâdeà
YYFREE


481 
	#YYFREE
 
ä“


	)

482 #ià! 
defšed
 
ä“
 && ! defšed 
EXIT_SUCCESS


483 
ä“
 (*);

490 #ià(! 
defšed
 
yyov”æow
 \

491 && (! 
defšed
 
	g__ılu¥lus
 \

492 || (
defšed
 
	gYYSTYPE_IS_TRIVIAL
 && YYSTYPE_IS_TRIVIAL)))

495 
	uyy®loc


497 
yyty³_št16
 
	myyss_®loc
;

498 
YYSTYPE
 
	myyvs_®loc
;

502 
	#YYSTACK_GAP_MAXIMUM
 ( (
yy®loc
è- 1)

	)

506 
	#YYSTACK_BYTES
(
N
) \

507 ((
N
è* ( (
yyty³_št16
è+  (
YYSTYPE
)) \

508 + 
YYSTACK_GAP_MAXIMUM
)

	)

510 
	#YYCOPY_NEEDED
 1

	)

517 
	#YYSTACK_RELOCATE
(
Sck_®loc
, 
Sck
) \

520 
YYSIZE_T
 
yyÃwby‹s
; \

521 
	`YYCOPY
 (&
yy±r
->
Sck_®loc
, 
Sck
, 
yysize
); \

522 
Sck
 = &
yy±r
->
Sck_®loc
; \

523 
yyÃwby‹s
 = 
yy¡acksize
 *  (*
Sck
è+ 
YYSTACK_GAP_MAXIMUM
; \

524 
yy±r
 +ğ
yyÃwby‹s
 /  (*yyptr); \

526 0)

	)

530 #ià
defšed
 
YYCOPY_NEEDED
 && YYCOPY_NEEDED

533 #iâdeà
YYCOPY


534 #ià
defšed
 
__GNUC__
 && 1 < __GNUC__

535 
	#YYCOPY
(
D¡
, 
Src
, 
CouÁ
) \

536 
	`__butš_memıy
 (
D¡
, 
Src
, (
CouÁ
è*  (*(Src)))

	)

538 
	#YYCOPY
(
D¡
, 
Src
, 
CouÁ
) \

541 
YYSIZE_T
 
yyi
; \

542 
yyi
 = 0; yy˜< (
CouÁ
); yyi++) \

543 (
D¡
)[
yyi
] = (
Src
)[yyi]; \

545 0)

	)

551 
	#YYFINAL
 26

	)

553 
	#YYLAST
 138

	)

556 
	#YYNTOKENS
 74

	)

558 
	#YYNNTS
 18

	)

560 
	#YYNRULES
 84

	)

562 
	#YYNSTATES
 118

	)

566 
	#YYUNDEFTOK
 2

	)

567 
	#YYMAXUTOK
 328

	)

569 
	#YYTRANSLATE
(
YYX
) \

570 ((è(
YYX
è<ğ
YYMAXUTOK
 ? 
yyŒª¦©e
[YYX] : 
YYUNDEFTOK
)

	)

574 cÚ¡ 
yyty³_ušt8
 
	gyyŒª¦©e
[] =

611 #ià
YYDEBUG


613 cÚ¡ 
yyty³_ušt16
 
	gyy¾še
[] =

627 #ià
YYDEBUG
 || 
YYERROR_VERBOSE
 || 1

630 cÚ¡ *cÚ¡ 
	gyyŠame
[] =

651 "shiá", "İ”ªd", 
YY_NULLPTR


655 #ifdeà
YYPRINT


658 cÚ¡ 
yyty³_ušt16
 
	gyytoknum
[] =

671 
	#YYPACT_NINF
 -63

	)

673 
	#yy·ù_v®ue_is_deçuÉ
(
Yy¡©e
) \

674 (!!((
Yy¡©e
è=ğ(-63)))

	)

676 
	#YYTABLE_NINF
 -76

	)

678 
	#yybË_v®ue_is_”rÜ
(
YybË_v®ue
) \

679 0

	)

683 cÚ¡ 
yyty³_št8
 
	gyy·ù
[] =

702 cÚ¡ 
yyty³_ušt8
 
	gyydeçù
[] =

719 cÚ¡ 
yyty³_št8
 
	gyypgÙo
[] =

726 cÚ¡ 
yyty³_št8
 
	gyydefgÙo
[] =

735 cÚ¡ 
yyty³_št8
 
	gyybË
[] =

753 cÚ¡ 
yyty³_št8
 
	gyycheck
[] =

773 cÚ¡ 
yyty³_ušt8
 
	gyy¡os
[] =

790 cÚ¡ 
yyty³_ušt8
 
	gyyr1
[] =

804 cÚ¡ 
yyty³_ušt8
 
	gyyr2
[] =

818 
	#yy”rok
 (
yy”r¡©us
 = 0)

	)

819 
	#yyş—rš
 (
yych¬
 = 
YYEMPTY
)

	)

820 
	#YYEMPTY
 (-2)

	)

821 
	#YYEOF
 0

	)

823 
	#YYACCEPT
 
yyacû±Ïb


	)

824 
	#YYABORT
 
yyabÜab


	)

825 
	#YYERROR
 
yy”rÜÏb


	)

828 
	#YYRECOVERING
(è(!!
yy”r¡©us
)

	)

830 
	#YYBACKUP
(
Tok’
, 
V®ue
) \

832 ià(
yych¬
 =ğ
YYEMPTY
) \

834 
yych¬
 = (
Tok’
); \

835 
yylv®
 = (
V®ue
); \

836 
	`YYPOPSTACK
 (
yyËn
); \

837 
yy¡©e
 = *
yys¥
; \

838 
yybackup
; \

842 
	`yy”rÜ
 (
sÿÂ”
, 
”½
, 
roÙ
, 
	`YY_
("syntaxƒrror: cannot back up")); \

843 
YYERROR
; \

845 0)

	)

848 
	#YYTERROR
 1

	)

849 
	#YYERRCODE
 256

	)

854 #ià
YYDEBUG


856 #iâdeà
YYFPRINTF


857 
	~<¡dio.h
>

858 
	#YYFPRINTF
 
årštf


	)

861 
	#YYDPRINTF
(
Args
) \

863 ià(
yydebug
) \

864 
YYFPRINTF
 
Args
; \

865 } 0)

	)

868 #iâdeà
YY_LOCATION_PRINT


869 
	#YY_LOCATION_PRINT
(
Fe
, 
Loc
è((è0)

	)

873 
	#YY_SYMBOL_PRINT
(
T™Ë
, 
Ty³
, 
V®ue
, 
LoÿtiÚ
) \

875 ià(
yydebug
) \

877 
	`YYFPRINTF
 (
¡d”r
, "% ", 
T™Ë
); \

878 
	`yy_symbŞ_´št
 (
¡d”r
, \

879 
Ty³
, 
V®ue
, 
sÿÂ”
, 
”½
, 
roÙ
); \

880 
	`YYFPRINTF
 (
¡d”r
, "\n"); \

882 } 0)

	)

890 
	$yy_symbŞ_v®ue_´št
 (
FILE
 *
yyouut
, 
yyty³
, 
YYSTYPE
 cÚ¡ * cÚ¡ 
yyv®u•
, *
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
)

892 
FILE
 *
yyo
 = 
yyouut
;

893 
	`YYUSE
 (
yyo
);

894 
	`YYUSE
 (
sÿÂ”
);

895 
	`YYUSE
 (
”½
);

896 
	`YYUSE
 (
roÙ
);

897 ià(!
yyv®u•
)

899 #ifdeà
YYPRINT


900 ià(
yyty³
 < 
YYNTOKENS
)

901 
	`YYPRINT
 (
yyouut
, 
yytoknum
[
yyty³
], *
yyv®u•
);

903 
	`YYUSE
 (
yyty³
);

904 
	}
}

912 
	$yy_symbŞ_´št
 (
FILE
 *
yyouut
, 
yyty³
, 
YYSTYPE
 cÚ¡ * cÚ¡ 
yyv®u•
, *
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
)

914 
	`YYFPRINTF
 (
yyouut
, "%s %s (",

915 
yyty³
 < 
YYNTOKENS
 ? "tok’" : "Á”m", 
yyŠame
[yytype]);

917 
	`yy_symbŞ_v®ue_´št
 (
yyouut
, 
yyty³
, 
yyv®u•
, 
sÿÂ”
, 
”½
, 
roÙ
);

918 
	`YYFPRINTF
 (
yyouut
, ")");

919 
	}
}

927 
	$yy_¡ack_´št
 (
yyty³_št16
 *
yybÙtom
, yyty³_št16 *
yytİ
)

929 
	`YYFPRINTF
 (
¡d”r
, "Stack‚ow");

930 ; 
yybÙtom
 <ğ
yytİ
; yybottom++)

932 
yybÙ
 = *
yybÙtom
;

933 
	`YYFPRINTF
 (
¡d”r
, " %d", 
yybÙ
);

935 
	`YYFPRINTF
 (
¡d”r
, "\n");

936 
	}
}

938 
	#YY_STACK_PRINT
(
BÙtom
, 
Tİ
) \

940 ià(
yydebug
) \

941 
	`yy_¡ack_´št
 ((
BÙtom
), (
Tİ
)); \

942 } 0)

	)

950 
	$yy_»duû_´št
 (
yyty³_št16
 *
yys¥
, 
YYSTYPE
 *
yyv¥
, 
yyruË
, *
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
)

952 
yyÊo
 = 
yy¾še
[
yyruË
];

953 
yyÄhs
 = 
yyr2
[
yyruË
];

954 
yyi
;

955 
	`YYFPRINTF
 (
¡d”r
, "Reducing stack by„ule %d (line %lu):\n",

956 
yyruË
 - 1, 
yyÊo
);

958 
yyi
 = 0; yy˜< 
yyÄhs
; yyi++)

960 
	`YYFPRINTF
 (
¡d”r
, " $%d = ", 
yyi
 + 1);

961 
	`yy_symbŞ_´št
 (
¡d”r
,

962 
yy¡os
[
yys¥
[
yyi
 + 1 - 
yyÄhs
]],

963 &(
yyv¥
[(
yyi
 + 1è- (
yyÄhs
)])

964 , 
sÿÂ”
, 
”½
, 
roÙ
);

965 
	`YYFPRINTF
 (
¡d”r
, "\n");

967 
	}
}

969 
	#YY_REDUCE_PRINT
(
RuË
) \

971 ià(
yydebug
) \

972 
	`yy_»duû_´št
 (
yys¥
, 
yyv¥
, 
RuË
, 
sÿÂ”
, 
”½
, 
roÙ
); \

973 } 0)

	)

977 
	gyydebug
;

979 
	#YYDPRINTF
(
Args
)

	)

980 
	#YY_SYMBOL_PRINT
(
T™Ë
, 
Ty³
, 
V®ue
, 
LoÿtiÚ
)

	)

981 
	#YY_STACK_PRINT
(
BÙtom
, 
Tİ
)

	)

982 
	#YY_REDUCE_PRINT
(
RuË
)

	)

987 #iâdeà
YYINITDEPTH


988 
	#YYINITDEPTH
 200

	)

998 #iâdeà
YYMAXDEPTH


999 
	#YYMAXDEPTH
 10000

	)

1003 #ià
YYERROR_VERBOSE


1005 #iâdeà
yy¡¾’


1006 #ià
defšed
 
__GLIBC__
 && defšed 
_STRING_H


1007 
	#yy¡¾’
 
¡¾’


	)

1010 
YYSIZE_T


1011 
	$yy¡¾’
 (cÚ¡ *
yy¡r
)

1013 
YYSIZE_T
 
yyËn
;

1014 
yyËn
 = 0; 
yy¡r
[yylen]; yylen++)

1016  
yyËn
;

1017 
	}
}

1021 #iâdeà
yy¡pıy


1022 #ià
defšed
 
__GLIBC__
 && defšed 
_STRING_H
 && defšed 
_GNU_SOURCE


1023 
	#yy¡pıy
 
¡pıy


	)

1028 
	$yy¡pıy
 (*
yyde¡
, cÚ¡ *
yy¤c
)

1030 *
yyd
 = 
yyde¡
;

1031 cÚ¡ *
yys
 = 
yy¤c
;

1033 (*
yyd
++ = *
yys
++) != '\0')

1036  
yyd
 - 1;

1037 
	}
}

1041 #iâdeà
yyŠam”r


1049 
YYSIZE_T


1050 
	$yyŠam”r
 (*
yy»s
, cÚ¡ *
yy¡r
)

1052 ià(*
yy¡r
 == '"')

1054 
YYSIZE_T
 
yyn
 = 0;

1055 cÚ¡ *
yyp
 = 
yy¡r
;

1058 *++
yyp
)

1062 
do_nÙ_¡r_quÙes
;

1065 ià(*++
yyp
 != '\\')

1066 
do_nÙ_¡r_quÙes
;

1069 ià(
yy»s
)

1070 
yy»s
[
yyn
] = *
yyp
;

1071 
yyn
++;

1075 ià(
yy»s
)

1076 
yy»s
[
yyn
] = '\0';

1077  
yyn
;

1079 
do_nÙ_¡r_quÙes
: ;

1082 ià(! 
yy»s
)

1083  
	`yy¡¾’
 (
yy¡r
);

1085  
	`yy¡pıy
 (
yy»s
, 
yy¡r
) - yyres;

1086 
	}
}

1098 
	$yysyÁax_”rÜ
 (
YYSIZE_T
 *
yymsg_®loc
, **
yymsg
,

1099 
yyty³_št16
 *
yys¥
, 
yytok’
)

1101 
YYSIZE_T
 
yysize0
 = 
	`yyŠam”r
 (
YY_NULLPTR
, 
yyŠame
[
yytok’
]);

1102 
YYSIZE_T
 
yysize
 = 
yysize0
;

1103 ’um { 
YYERROR_VERBOSE_ARGS_MAXIMUM
 = 5 };

1105 cÚ¡ *
yyfÜm©
 = 
YY_NULLPTR
;

1107 cÚ¡ *
yy¬g
[
YYERROR_VERBOSE_ARGS_MAXIMUM
];

1110 
yycouÁ
 = 0;

1135 ià(
yytok’
 !ğ
YYEMPTY
)

1137 
yyn
 = 
yy·ù
[*
yys¥
];

1138 
yy¬g
[
yycouÁ
++] = 
yyŠame
[
yytok’
];

1139 ià(!
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

1144 
yyxbegš
 = 
yyn
 < 0 ? -yyn : 0;

1146 
yychecklim
 = 
YYLAST
 - 
yyn
 + 1;

1147 
yyx’d
 = 
yychecklim
 < 
YYNTOKENS
 ? yychecklim : YYNTOKENS;

1148 
yyx
;

1150 
yyx
 = 
yyxbegš
; yyx < 
yyx’d
; ++yyx)

1151 ià(
yycheck
[
yyx
 + 
yyn
] =ğyyx && yyx !ğ
YYTERROR


1152 && !
	`yybË_v®ue_is_”rÜ
 (
yybË
[
yyx
 + 
yyn
]))

1154 ià(
yycouÁ
 =ğ
YYERROR_VERBOSE_ARGS_MAXIMUM
)

1156 
yycouÁ
 = 1;

1157 
yysize
 = 
yysize0
;

1160 
yy¬g
[
yycouÁ
++] = 
yyŠame
[
yyx
];

1162 
YYSIZE_T
 
yysize1
 = 
yysize
 + 
	`yyŠam”r
 (
YY_NULLPTR
, 
yyŠame
[
yyx
]);

1163 ià(! (
yysize
 <ğ
yysize1


1164 && 
yysize1
 <ğ
YYSTACK_ALLOC_MAXIMUM
))

1166 
yysize
 = 
yysize1
;

1172 
yycouÁ
)

1174 
	#YYCASE_
(
N
, 
S
) \

1175 
N
: \

1176 
yyfÜm©
 = 
S
; \

1177 

	)

1178 
	`YYCASE_
(0, 
	`YY_
("syntaxƒrror"));

1179 
	`YYCASE_
(1, 
	`YY_
("syntaxƒrror, unexpected %s"));

1180 
	`YYCASE_
(2, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s"));

1181 
	`YYCASE_
(3, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s"));

1182 
	`YYCASE_
(4, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s or %s"));

1183 
	`YYCASE_
(5, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s or %s or %s"));

1184 #undeà
YYCASE_


1188 
YYSIZE_T
 
yysize1
 = 
yysize
 + 
	`yy¡¾’
 (
yyfÜm©
);

1189 ià(! (
yysize
 <ğ
yysize1
 && yysize1 <ğ
YYSTACK_ALLOC_MAXIMUM
))

1191 
yysize
 = 
yysize1
;

1194 ià(*
yymsg_®loc
 < 
yysize
)

1196 *
yymsg_®loc
 = 2 * 
yysize
;

1197 ià(! (
yysize
 <ğ*
yymsg_®loc


1198 && *
yymsg_®loc
 <ğ
YYSTACK_ALLOC_MAXIMUM
))

1199 *
yymsg_®loc
 = 
YYSTACK_ALLOC_MAXIMUM
;

1207 *
yyp
 = *
yymsg
;

1208 
yyi
 = 0;

1209 (*
yyp
 = *
yyfÜm©
) != '\0')

1210 ià(*
yyp
 =ğ'%' && 
yyfÜm©
[1] =ğ's' && 
yyi
 < 
yycouÁ
)

1212 
yyp
 +ğ
	`yyŠam”r
 (yyp, 
yy¬g
[
yyi
++]);

1213 
yyfÜm©
 += 2;

1217 
yyp
++;

1218 
yyfÜm©
++;

1222 
	}
}

1230 
	$yyde¡ruù
 (cÚ¡ *
yymsg
, 
yyty³
, 
YYSTYPE
 *
yyv®u•
, *
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
)

1232 
	`YYUSE
 (
yyv®u•
);

1233 
	`YYUSE
 (
sÿÂ”
);

1234 
	`YYUSE
 (
”½
);

1235 
	`YYUSE
 (
roÙ
);

1236 ià(!
yymsg
)

1237 
yymsg
 = "Deleting";

1238 
	`YY_SYMBOL_PRINT
 (
yymsg
, 
yyty³
, 
yyv®u•
, 
yyloÿtiÚp
);

1240 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


1241 
yyty³
)

1245 { 
	`ä“
(((*
yyv®u•
).
s
)); 
	`NL_DBG
(2, "string destructor\n"); }

1251 { 
	`ä“
(((*
yyv®u•
).
q
).
d©a
); 
	`NL_DBG
(2, "quoted destructor\n"); }

1257 { 
	`¹Æ_pkoc_put
(((*
yyv®u•
).
loc
)); 
	`NL_DBG
(2, "pktloc destructor\n"); }

1263 { 
	`¹Æ_pkoc_put
(((*
yyv®u•
).
loc
)); 
	`NL_DBG
(2, "pktloc destructor\n"); }

1269 { 
	`¹Æ_m‘a_v®ue_put
(((*
yyv®u•
).
mv
)); 
	`NL_DBG
(2, "meta value destructor\n"); }

1275 { 
	`ä“
(((*
yyv®u•
).
q
).
d©a
); 
	`NL_DBG
(2, "quoted destructor\n"); }

1281 { 
	`¹Æ_pkoc_put
(((*
yyv®u•
).
loc
)); 
	`NL_DBG
(2, "pktloc destructor\n"); }

1289 
YY_IGNORE_MAYBE_UNINITIALIZED_END


1290 
	}
}

1300 
	$yy·r£
 (*
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
)

1303 
yych¬
;

1309 
	`YY_INITIAL_VALUE
 (
YYSTYPE
 
yyv®_deçuÉ
;)

1310 
YYSTYPE
 
yylv®
 
	`YY_INITIAL_VALUE
 (ğ
yyv®_deçuÉ
);

1313 
yyÃ¼s
;

1315 
yy¡©e
;

1317 
yy”r¡©us
;

1327 
yyty³_št16
 
yys§
[
YYINITDEPTH
];

1328 
yyty³_št16
 *
yyss
;

1329 
yyty³_št16
 *
yys¥
;

1332 
YYSTYPE
 
yyv§
[
YYINITDEPTH
];

1333 
YYSTYPE
 *
yyvs
;

1334 
YYSTYPE
 *
yyv¥
;

1336 
YYSIZE_T
 
yy¡acksize
;

1338 
yyn
;

1339 
yy»suÉ
;

1341 
yytok’
 = 0;

1344 
YYSTYPE
 
yyv®
;

1346 #ià
YYERROR_VERBOSE


1348 
yymsgbuf
[128];

1349 *
yymsg
 = 
yymsgbuf
;

1350 
YYSIZE_T
 
yymsg_®loc
 =  
yymsgbuf
;

1353 
	#YYPOPSTACK
(
N
è(
yyv¥
 -ğ(N), 
yys¥
 -ğ(N))

	)

1357 
yyËn
 = 0;

1359 
yys¥
 = 
yyss
 = 
yys§
;

1360 
yyv¥
 = 
yyvs
 = 
yyv§
;

1361 
yy¡acksize
 = 
YYINITDEPTH
;

1363 
	`YYDPRINTF
 ((
¡d”r
, "Starting…arse\n"));

1365 
yy¡©e
 = 0;

1366 
yy”r¡©us
 = 0;

1367 
yyÃ¼s
 = 0;

1368 
yych¬
 = 
YYEMPTY
;

1369 
yy£t¡©e
;

1374 
yyÃw¡©e
:

1377 
yys¥
++;

1379 
yy£t¡©e
:

1380 *
yys¥
 = 
yy¡©e
;

1382 ià(
yyss
 + 
yy¡acksize
 - 1 <ğ
yys¥
)

1385 
YYSIZE_T
 
yysize
 = 
yys¥
 - 
yyss
 + 1;

1387 #ifdeà
yyov”æow


1392 
YYSTYPE
 *
yyvs1
 = 
yyvs
;

1393 
yyty³_št16
 *
yyss1
 = 
yyss
;

1399 
	`yyov”æow
 (
	`YY_
("memoryƒxhausted"),

1400 &
yyss1
, 
yysize
 *  (*
yys¥
),

1401 &
yyvs1
, 
yysize
 *  (*
yyv¥
),

1402 &
yy¡acksize
);

1404 
yyss
 = 
yyss1
;

1405 
yyvs
 = 
yyvs1
;

1408 #iâdeà
YYSTACK_RELOCATE


1409 
yyexhau¡edÏb
;

1412 ià(
YYMAXDEPTH
 <ğ
yy¡acksize
)

1413 
yyexhau¡edÏb
;

1414 
yy¡acksize
 *= 2;

1415 ià(
YYMAXDEPTH
 < 
yy¡acksize
)

1416 
yy¡acksize
 = 
YYMAXDEPTH
;

1419 
yyty³_št16
 *
yyss1
 = 
yyss
;

1420 
yy®loc
 *
yy±r
 =

1421 (
yy®loc
 *è
	`YYSTACK_ALLOC
 (
	`YYSTACK_BYTES
 (
yy¡acksize
));

1422 ià(! 
yy±r
)

1423 
yyexhau¡edÏb
;

1424 
	`YYSTACK_RELOCATE
 (
yyss_®loc
, 
yyss
);

1425 
	`YYSTACK_RELOCATE
 (
yyvs_®loc
, 
yyvs
);

1426 #undeà
YYSTACK_RELOCATE


1427 ià(
yyss1
 !ğ
yys§
)

1428 
	`YYSTACK_FREE
 (
yyss1
);

1433 
yys¥
 = 
yyss
 + 
yysize
 - 1;

1434 
yyv¥
 = 
yyvs
 + 
yysize
 - 1;

1436 
	`YYDPRINTF
 ((
¡d”r
, "Stack size increasedo %lu\n",

1437 (è
yy¡acksize
));

1439 ià(
yyss
 + 
yy¡acksize
 - 1 <ğ
yys¥
)

1440 
YYABORT
;

1443 
	`YYDPRINTF
 ((
¡d”r
, "EÁ”šg s‹ %d\n", 
yy¡©e
));

1445 ià(
yy¡©e
 =ğ
YYFINAL
)

1446 
YYACCEPT
;

1448 
yybackup
;

1453 
yybackup
:

1459 
yyn
 = 
yy·ù
[
yy¡©e
];

1460 ià(
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

1461 
yydeçuÉ
;

1466 ià(
yych¬
 =ğ
YYEMPTY
)

1468 
	`YYDPRINTF
 ((
¡d”r
, "Reading‡oken: "));

1469 
yych¬
 = 
	`yyËx
 (&
yylv®
, 
sÿÂ”
);

1472 ià(
yych¬
 <ğ
YYEOF
)

1474 
yych¬
 = 
yytok’
 = 
YYEOF
;

1475 
	`YYDPRINTF
 ((
¡d”r
, "Now‡tƒnd of input.\n"));

1479 
yytok’
 = 
	`YYTRANSLATE
 (
yych¬
);

1480 
	`YY_SYMBOL_PRINT
 ("Nexˆtok’ is", 
yytok’
, &
yylv®
, &
yyÎoc
);

1485 
yyn
 +ğ
yytok’
;

1486 ià(
yyn
 < 0 || 
YYLAST
 < yyÀ|| 
yycheck
[yyn] !ğ
yytok’
)

1487 
yydeçuÉ
;

1488 
yyn
 = 
yybË
[yyn];

1489 ià(
yyn
 <= 0)

1491 ià(
	`yybË_v®ue_is_”rÜ
 (
yyn
))

1492 
yy”¾ab
;

1493 
yyn
 = -yyn;

1494 
yy»duû
;

1499 ià(
yy”r¡©us
)

1500 
yy”r¡©us
--;

1503 
	`YY_SYMBOL_PRINT
 ("Shiášg", 
yytok’
, &
yylv®
, &
yyÎoc
);

1506 
yych¬
 = 
YYEMPTY
;

1508 
yy¡©e
 = 
yyn
;

1509 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


1510 *++
yyv¥
 = 
yylv®
;

1511 
YY_IGNORE_MAYBE_UNINITIALIZED_END


1513 
yyÃw¡©e
;

1519 
yydeçuÉ
:

1520 
yyn
 = 
yydeçù
[
yy¡©e
];

1521 ià(
yyn
 == 0)

1522 
yy”¾ab
;

1523 
yy»duû
;

1529 
yy»duû
:

1531 
yyËn
 = 
yyr2
[
yyn
];

1541 
yyv®
 = 
yyv¥
[1-
yyËn
];

1544 
	`YY_REDUCE_PRINT
 (
yyn
);

1545 
yyn
)

1550 
	`Æ_li¡_add_
(
roÙ
, &(
yyv¥
[0].
e
)->
e_li¡
);

1558 (
yyv®
.
e
èğ(
yyv¥
[0].e);

1566 
	`¹Æ_em©ch_£t_æags
((
yyv¥
[-2].
e
), (yyv¥[-1].
i
));

1569 
	`Æ_li¡_add_
(&(
yyv¥
[-2].
e
)->
e_li¡
, &(yyvsp[0].e)->e_list);

1571 (
yyv®
.
e
èğ(
yyv¥
[-2].e);

1579 
	`¹Æ_em©ch_£t_æags
((
yyv¥
[0].
e
), 
TCF_EM_INVERT
);

1580 (
yyv®
.
e
èğ(
yyv¥
[0].e);

1588 (
yyv®
.
e
èğ(
yyv¥
[0].e);

1596 
¹Æ_em©ch
 *
e
;

1598 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

1599 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

1600 
YYABORT
;

1603 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_CMP
) < 0)

1604 
	`BUG
();

1606 
	`¹Æ_em©ch_cmp_£t
(
e
, &(
yyv¥
[0].
cmp
));

1607 (
yyv®
.
e
) =ƒ;

1615 
¹Æ_em©ch
 *
e
;

1617 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

1618 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

1619 
YYABORT
;

1622 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_NBYTE
) < 0)

1623 
	`BUG
();

1625 
	`¹Æ_em©ch_nby‹_£t_off£t
(
e
, (
yyv¥
[-3].
loc
)->
Ïy”
, (yyv¥[-3].loc)->
off£t
);

1626 
	`¹Æ_pkoc_put
((
yyv¥
[-3].
loc
));

1627 
	`¹Æ_em©ch_nby‹_£t_·‰”n
(
e
, (
ušt8_t
 *è(
yyv¥
[-1].
q
).
d©a
, (yyv¥[-1].q).
šdex
);

1629 (
yyv®
.
e
) =ƒ;

1637 
¹Æ_em©ch
 *
e
;

1639 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

1640 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

1641 
YYABORT
;

1644 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_TEXT
) < 0)

1645 
	`BUG
();

1647 
	`¹Æ_em©ch_‹xt_£t_®go
(
e
, (
yyv¥
[-4].
s
));

1648 
	`¹Æ_em©ch_‹xt_£t_·‰”n
(
e
, (
yyv¥
[-3].
q
).
d©a
, (yyv¥[-3].q).
šdex
);

1650 ià((
yyv¥
[-2].
loc
)) {

1651 
	`¹Æ_em©ch_‹xt_£t_äom
(
e
, (
yyv¥
[-2].
loc
)->
Ïy”
, (yyv¥[-2].loc)->
off£t
);

1652 
	`¹Æ_pkoc_put
((
yyv¥
[-2].
loc
));

1655 ià((
yyv¥
[-1].
loc
)) {

1656 
	`¹Æ_em©ch_‹xt_£t_to
(
e
, (
yyv¥
[-1].
loc
)->
Ïy”
, (yyv¥[-1].loc)->
off£t
);

1657 
	`¹Æ_pkoc_put
((
yyv¥
[-1].
loc
));

1660 (
yyv®
.
e
) =ƒ;

1668 
¹Æ_em©ch
 *
e
;

1670 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

1671 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

1672 
YYABORT
;

1675 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_META
) < 0)

1676 
	`BUG
();

1678 
	`¹Æ_em©ch_m‘a_£t_lv®ue
(
e
, (
yyv¥
[-3].
mv
));

1679 
	`¹Æ_em©ch_m‘a_£t_rv®ue
(
e
, (
yyv¥
[-1].
mv
));

1680 
	`¹Æ_em©ch_m‘a_£t_İ”ªd
(
e
, (
yyv¥
[-2].
i
));

1682 (
yyv®
.
e
) =ƒ;

1690 
¹Æ_em©ch
 *
e
;

1692 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

1693 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

1694 
YYABORT
;

1697 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_CONTAINER
) < 0)

1698 
	`BUG
();

1701 
	`Æ_li¡_add_
(&
e
->
e_chds
, &(
yyv¥
[-1].e)->
e_li¡
);

1703 (
yyv®
.
e
) =ƒ;

1710 { (
yyv®
.
cmp
èğ(
yyv¥
[-1].cmp); }

1716 { (
yyv®
.
cmp
èğ(
yyv¥
[0].cmp); }

1723 ià((
yyv¥
[-2].
loc
)->
®ign
 =ğ
TCF_EM_ALIGN_U16
 ||

1724 (
yyv¥
[-2].
loc
)->
®ign
 =ğ
TCF_EM_ALIGN_U32
)

1725 (
yyv®
.
cmp
).
æags
 = 
TCF_EM_CMP_TRANS
;

1727 
	`mem£t
(&(
yyv®
.
cmp
), 0, ((yyval.cmp)));

1729 (
yyv®
.
cmp
).
mask
 = (
yyv¥
[-2].
loc
)->mask;

1730 (
yyv®
.
cmp
).
off
 = (
yyv¥
[-2].
loc
)->
off£t
;

1731 (
yyv®
.
cmp
).
®ign
 = (
yyv¥
[-2].
loc
)->align;

1732 (
yyv®
.
cmp
).
Ïy”
 = (
yyv¥
[-2].
loc
)->layer;

1733 (
yyv®
.
cmp
).
İnd
 = (
yyv¥
[-1].
i
);

1734 (
yyv®
.
cmp
).
v®
 = (
yyv¥
[0].
i
);

1736 
	`¹Æ_pkoc_put
((
yyv¥
[-2].
loc
));

1743 { (
yyv®
.
loc
èğ
NULL
; }

1749 { (
yyv®
.
loc
èğ(
yyv¥
[0].loc); }

1755 { (
yyv®
.
loc
èğ
NULL
; }

1761 { (
yyv®
.
loc
èğ(
yyv¥
[0].loc); }

1767 { (
yyv®
.
mv
èğ
	`¹Æ_m‘a_v®ue_®loc_v¬
((
yyv¥
[0].
q
).
d©a
, (yyv¥[0].q).
Ën
); }

1773 { (
yyv®
.
mv
èğ
	`¹Æ_m‘a_v®ue_®loc_št
((
yyv¥
[0].
i
)); }

1779 { (
yyv®
.
mv
èğ
	`META_ALLOC
(
META_INT
, (
yyv¥
[-2].
i
), (yyv¥[-1].i), (yyv¥[0].
i64
)); }

1785 { (
yyv®
.
mv
èğ
	`META_ALLOC
(
META_VAR
, (
yyv¥
[-1].
i
), (yyvsp[0].i), 0); }

1791 { (
yyv®
.
i
èğ
	`META_ID
(
RANDOM
); }

1797 { (
yyv®
.
i
èğ
	`META_ID
(
LOADAVG_0
); }

1803 { (
yyv®
.
i
èğ
	`META_ID
(
LOADAVG_1
); }

1809 { (
yyv®
.
i
èğ
	`META_ID
(
LOADAVG_2
); }

1815 { (
yyv®
.
i
èğ
	`META_ID
(
DEV
); }

1821 { (
yyv®
.
i
èğ
	`META_ID
(
PRIORITY
); }

1827 { (
yyv®
.
i
èğ
	`META_ID
(
PROTOCOL
); }

1833 { (
yyv®
.
i
èğ
	`META_ID
(
PKTTYPE
); }

1839 { (
yyv®
.
i
èğ
	`META_ID
(
PKTLEN
); }

1845 { (
yyv®
.
i
èğ
	`META_ID
(
DATALEN
); }

1851 { (
yyv®
.
i
èğ
	`META_ID
(
MACLEN
); }

1857 { (
yyv®
.
i
èğ
	`META_ID
(
NFMARK
); }

1863 { (
yyv®
.
i
èğ
	`META_ID
(
TCINDEX
); }

1869 { (
yyv®
.
i
èğ
	`META_ID
(
RTCLASSID
); }

1875 { (
yyv®
.
i
èğ
	`META_ID
(
RTIIF
); }

1881 { (
yyv®
.
i
èğ
	`META_ID
(
SK_FAMILY
); }

1887 { (
yyv®
.
i
èğ
	`META_ID
(
SK_STATE
); }

1893 { (
yyv®
.
i
èğ
	`META_ID
(
SK_REUSE
); }

1899 { (
yyv®
.
i
èğ
	`META_ID
(
SK_REFCNT
); }

1905 { (
yyv®
.
i
èğ
	`META_ID
(
SK_RCVBUF
); }

1911 { (
yyv®
.
i
èğ
	`META_ID
(
SK_SNDBUF
); }

1917 { (
yyv®
.
i
èğ
	`META_ID
(
SK_SHUTDOWN
); }

1923 { (
yyv®
.
i
èğ
	`META_ID
(
SK_PROTO
); }

1929 { (
yyv®
.
i
èğ
	`META_ID
(
SK_TYPE
); }

1935 { (
yyv®
.
i
èğ
	`META_ID
(
SK_RMEM_ALLOC
); }

1941 { (
yyv®
.
i
èğ
	`META_ID
(
SK_WMEM_ALLOC
); }

1947 { (
yyv®
.
i
èğ
	`META_ID
(
SK_WMEM_QUEUED
); }

1953 { (
yyv®
.
i
èğ
	`META_ID
(
SK_RCV_QLEN
); }

1959 { (
yyv®
.
i
èğ
	`META_ID
(
SK_SND_QLEN
); }

1965 { (
yyv®
.
i
èğ
	`META_ID
(
SK_ERR_QLEN
); }

1971 { (
yyv®
.
i
èğ
	`META_ID
(
SK_FORWARD_ALLOCS
); }

1977 { (
yyv®
.
i
èğ
	`META_ID
(
SK_ALLOCS
); }

1983 { (
yyv®
.
i
èğ
	`META_ID
(
SK_ROUTE_CAPS
); }

1989 { (
yyv®
.
i
èğ
	`META_ID
(
SK_HASH
); }

1995 { (
yyv®
.
i
èğ
	`META_ID
(
SK_LINGERTIME
); }

2001 { (
yyv®
.
i
èğ
	`META_ID
(
SK_ACK_BACKLOG
); }

2007 { (
yyv®
.
i
èğ
	`META_ID
(
SK_MAX_ACK_BACKLOG
); }

2013 { (
yyv®
.
i
èğ
	`META_ID
(
SK_PRIO
); }

2019 { (
yyv®
.
i
èğ
	`META_ID
(
SK_RCVLOWAT
); }

2025 { (
yyv®
.
i
èğ
	`META_ID
(
SK_RCVTIMEO
); }

2031 { (
yyv®
.
i
èğ
	`META_ID
(
SK_SNDTIMEO
); }

2037 { (
yyv®
.
i
èğ
	`META_ID
(
SK_SENDMSG_OFF
); }

2043 { (
yyv®
.
i
èğ
	`META_ID
(
SK_WRITE_PENDING
); }

2049 { (
yyv®
.
i
èğ
	`META_ID
(
VLAN_TAG
); }

2055 { (
yyv®
.
i
èğ
	`META_ID
(
RXHASH
); }

2061 { (
yyv®
.
i
èğ
	`META_ID
(
DEV
); }

2067 { (
yyv®
.
i
èğ
	`META_ID
(
SK_BOUND_IF
); }

2074 (
yyv®
.
q
èğ(
yyv¥
[0].q);

2082 
Æ_addr
 *
addr
;

2084 ià(
	`Æ_addr_·r£
((
yyv¥
[0].
s
), 
AF_UNSPEC
, &
addr
) == 0) {

2085 (
yyv®
.
q
).
Ën
 = 
	`Æ_addr_g‘_Ën
(
addr
);

2087 (
yyv®
.
q
).
šdex
 = 
	`mš_t
(, (yyv®.q).
Ën
, 
	`Æ_addr_g‘_´efixËn
(
addr
)/8);

2089 ià(!((
yyv®
.
q
).
d©a
 = 
	`ÿÎoc
(1, (yyv®.q).
Ën
))) {

2090 
	`Æ_addr_put
(
addr
);

2091 
YYABORT
;

2094 
	`memıy
((
yyv®
.
q
).
d©a
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
), (yyv®.q).
Ën
);

2095 
	`Æ_addr_put
(
addr
);

2097 ià(
	`a¥rštf
(
”½
, "šv®id…©‹º \"%s\"", (
yyv¥
[0].
s
)) == -1)

2098 *
”½
 = 
NULL
;

2099 
YYABORT
;

2108 
¹Æ_pkoc
 *
loc
;

2110 ià(
	`¹Æ_pkoc_lookup
((
yyv¥
[0].
s
), &
loc
) < 0) {

2111 ià(
	`a¥rštf
(
”½
, "Pack‘†oÿtiÚ \"%s\"‚Ù found", (
yyv¥
[0].
s
)) == -1)

2112 *
”½
 = 
NULL
;

2113 
YYABORT
;

2116 (
yyv®
.
loc
) =†oc;

2124 
¹Æ_pkoc
 *
loc
;

2126 ià((
yyv¥
[0].
i64
è&& (!(yyv¥[-4].
i
è|| (yyv¥[-4].iè> 
TCF_EM_ALIGN_U32
)) {

2127 *
”½
 = 
	`¡rdup
("mask only‡llowed for‡lignments u8|u16|u32");

2128 
YYABORT
;

2131 ià(!(
loc
 = 
	`¹Æ_pkoc_®loc
())) {

2132 *
”½
 = 
	`¡rdup
("Unableo‡llocate…acket†ocation object");

2133 
YYABORT
;

2136 
loc
->
Çme
 = 
	`¡rdup
("<USER-DEFINED>");

2137 
loc
->
®ign
 = (
yyv¥
[-4].
i
);

2138 
loc
->
Ïy”
 = (
yyv¥
[-3].
i
);

2139 
loc
->
off£t
 = (
yyv¥
[-1].
i
);

2140 
loc
->
mask
 = (
yyv¥
[0].
i64
);

2142 (
yyv®
.
loc
) =†oc;

2149 { (
yyv®
.
i
) = 0; }

2155 { (
yyv®
.
i
èğ(
yyv¥
[-1].i); }

2161 { (
yyv®
.
i
èğ(
yyv¥
[-1].i); }

2167 { (
yyv®
.
i64
) = 0; }

2173 { (
yyv®
.
i64
èğ(
yyv¥
[0].
i
); }

2179 { (
yyv®
.
i
) = 0; }

2185 { (
yyv®
.
i
èğ(
yyv¥
[0].i); }

2191 { (
yyv®
.
i
èğ
TCF_EM_OPND_EQ
; }

2197 { (
yyv®
.
i
èğ
TCF_EM_OPND_GT
; }

2203 { (
yyv®
.
i
èğ
TCF_EM_OPND_LT
; }

2222 
	`YY_SYMBOL_PRINT
 ("-> $$ =", 
yyr1
[
yyn
], &
yyv®
, &
yyloc
);

2224 
	`YYPOPSTACK
 (
yyËn
);

2225 
yyËn
 = 0;

2226 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

2228 *++
yyv¥
 = 
yyv®
;

2234 
yyn
 = 
yyr1
[yyn];

2236 
yy¡©e
 = 
yypgÙo
[
yyn
 - 
YYNTOKENS
] + *
yys¥
;

2237 ià(0 <ğ
yy¡©e
 && yy¡©<ğ
YYLAST
 && 
yycheck
[yy¡©e] =ğ*
yys¥
)

2238 
yy¡©e
 = 
yybË
[yystate];

2240 
yy¡©e
 = 
yydefgÙo
[
yyn
 - 
YYNTOKENS
];

2242 
yyÃw¡©e
;

2248 
yy”¾ab
:

2251 
yytok’
 = 
yych¬
 =ğ
YYEMPTY
 ? YYEMPTY : 
	`YYTRANSLATE
 (yychar);

2254 ià(!
yy”r¡©us
)

2256 ++
yyÃ¼s
;

2257 #ià! 
YYERROR_VERBOSE


2258 
	`yy”rÜ
 (
sÿÂ”
, 
”½
, 
roÙ
, 
	`YY_
("syntaxƒrror"));

2260 
	#YYSYNTAX_ERROR
 
	`yysyÁax_”rÜ
 (&
yymsg_®loc
, &
yymsg
, \

2261 
yys¥
, 
yytok’
)

	)

2263 cÚ¡ *
yymsgp
 = 
	`YY_
("syntaxƒrror");

2264 
yysyÁax_”rÜ_¡©us
;

2265 
yysyÁax_”rÜ_¡©us
 = 
YYSYNTAX_ERROR
;

2266 ià(
yysyÁax_”rÜ_¡©us
 == 0)

2267 
yymsgp
 = 
yymsg
;

2268 ià(
yysyÁax_”rÜ_¡©us
 == 1)

2270 ià(
yymsg
 !ğ
yymsgbuf
)

2271 
	`YYSTACK_FREE
 (
yymsg
);

2272 
yymsg
 = (*è
	`YYSTACK_ALLOC
 (
yymsg_®loc
);

2273 ià(!
yymsg
)

2275 
yymsg
 = 
yymsgbuf
;

2276 
yymsg_®loc
 =  
yymsgbuf
;

2277 
yysyÁax_”rÜ_¡©us
 = 2;

2281 
yysyÁax_”rÜ_¡©us
 = 
YYSYNTAX_ERROR
;

2282 
yymsgp
 = 
yymsg
;

2285 
	`yy”rÜ
 (
sÿÂ”
, 
”½
, 
roÙ
, 
yymsgp
);

2286 ià(
yysyÁax_”rÜ_¡©us
 == 2)

2287 
yyexhau¡edÏb
;

2289 #undeà
YYSYNTAX_ERROR


2295 ià(
yy”r¡©us
 == 3)

2300 ià(
yych¬
 <ğ
YYEOF
)

2303 ià(
yych¬
 =ğ
YYEOF
)

2304 
YYABORT
;

2308 
	`yyde¡ruù
 ("Error: discarding",

2309 
yytok’
, &
yylv®
, 
sÿÂ”
, 
”½
, 
roÙ
);

2310 
yych¬
 = 
YYEMPTY
;

2316 
yy”¾ab1
;

2322 
yy”rÜÏb
:

2328 
yy”rÜÏb
;

2332 
	`YYPOPSTACK
 (
yyËn
);

2333 
yyËn
 = 0;

2334 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

2335 
yy¡©e
 = *
yys¥
;

2336 
yy”¾ab1
;

2342 
yy”¾ab1
:

2343 
yy”r¡©us
 = 3;

2347 
yyn
 = 
yy·ù
[
yy¡©e
];

2348 ià(!
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

2350 
yyn
 +ğ
YYTERROR
;

2351 ià(0 <ğ
yyn
 && yyÀ<ğ
YYLAST
 && 
yycheck
[yyn] =ğ
YYTERROR
)

2353 
yyn
 = 
yybË
[yyn];

2354 ià(0 < 
yyn
)

2360 ià(
yys¥
 =ğ
yyss
)

2361 
YYABORT
;

2364 
	`yyde¡ruù
 ("Error:…opping",

2365 
yy¡os
[
yy¡©e
], 
yyv¥
, 
sÿÂ”
, 
”½
, 
roÙ
);

2366 
	`YYPOPSTACK
 (1);

2367 
yy¡©e
 = *
yys¥
;

2368 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

2371 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


2372 *++
yyv¥
 = 
yylv®
;

2373 
YY_IGNORE_MAYBE_UNINITIALIZED_END


2377 
	`YY_SYMBOL_PRINT
 ("Shiášg", 
yy¡os
[
yyn
], 
yyv¥
, 
yyl¥
);

2379 
yy¡©e
 = 
yyn
;

2380 
yyÃw¡©e
;

2386 
yyacû±Ïb
:

2387 
yy»suÉ
 = 0;

2388 
yy»tuº
;

2393 
yyabÜab
:

2394 
yy»suÉ
 = 1;

2395 
yy»tuº
;

2397 #ià!
defšed
 
yyov”æow
 || 
YYERROR_VERBOSE


2401 
yyexhau¡edÏb
:

2402 
	`yy”rÜ
 (
sÿÂ”
, 
”½
, 
roÙ
, 
	`YY_
("memoryƒxhausted"));

2403 
yy»suÉ
 = 2;

2407 
yy»tuº
:

2408 ià(
yych¬
 !ğ
YYEMPTY
)

2412 
yytok’
 = 
	`YYTRANSLATE
 (
yych¬
);

2413 
	`yyde¡ruù
 ("Cleanup: discarding†ookahead",

2414 
yytok’
, &
yylv®
, 
sÿÂ”
, 
”½
, 
roÙ
);

2418 
	`YYPOPSTACK
 (
yyËn
);

2419 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

2420 
yys¥
 !ğ
yyss
)

2422 
	`yyde¡ruù
 ("Cleanup:…opping",

2423 
yy¡os
[*
yys¥
], 
yyv¥
, 
sÿÂ”
, 
”½
, 
roÙ
);

2424 
	`YYPOPSTACK
 (1);

2426 #iâdeà
yyov”æow


2427 ià(
yyss
 !ğ
yys§
)

2428 
	`YYSTACK_FREE
 (
yyss
);

2430 #ià
YYERROR_VERBOSE


2431 ià(
yymsg
 !ğ
yymsgbuf
)

2432 
	`YYSTACK_FREE
 (
yymsg
);

2434  
yy»suÉ
;

2435 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.h

33 #iâdeà
YY_EMATCH_ROUTE_CLS_EMATCH_SYNTAX_H_INCLUDED


34 
	#YY_EMATCH_ROUTE_CLS_EMATCH_SYNTAX_H_INCLUDED


	)

36 #iâdeà
YYDEBUG


37 
	#YYDEBUG
 0

	)

39 #ià
YYDEBUG


40 
em©ch_debug
;

44 #iâdeà
YYTOKENTYPE


45 
	#YYTOKENTYPE


	)

46 
	eyytok’ty³


48 
	mERROR
 = 258,

49 
	mLOGIC
 = 259,

50 
	mNOT
 = 260,

51 
	mOPERAND
 = 261,

52 
	mNUMBER
 = 262,

53 
	mALIGN
 = 263,

54 
	mLAYER
 = 264,

55 
	mKW_OPEN
 = 265,

56 
	mKW_CLOSE
 = 266,

57 
	mKW_PLUS
 = 267,

58 
	mKW_MASK
 = 268,

59 
	mKW_SHIFT
 = 269,

60 
	mKW_AT
 = 270,

61 
	mEMATCH_CMP
 = 271,

62 
	mEMATCH_NBYTE
 = 272,

63 
	mEMATCH_TEXT
 = 273,

64 
	mEMATCH_META
 = 274,

65 
	mKW_EQ
 = 275,

66 
	mKW_GT
 = 276,

67 
	mKW_LT
 = 277,

68 
	mKW_FROM
 = 278,

69 
	mKW_TO
 = 279,

70 
	mMETA_RANDOM
 = 280,

71 
	mMETA_LOADAVG_0
 = 281,

72 
	mMETA_LOADAVG_1
 = 282,

73 
	mMETA_LOADAVG_2
 = 283,

74 
	mMETA_DEV
 = 284,

75 
	mMETA_PRIO
 = 285,

76 
	mMETA_PROTO
 = 286,

77 
	mMETA_PKTTYPE
 = 287,

78 
	mMETA_PKTLEN
 = 288,

79 
	mMETA_DATALEN
 = 289,

80 
	mMETA_MACLEN
 = 290,

81 
	mMETA_MARK
 = 291,

82 
	mMETA_TCINDEX
 = 292,

83 
	mMETA_RTCLASSID
 = 293,

84 
	mMETA_RTIIF
 = 294,

85 
	mMETA_SK_FAMILY
 = 295,

86 
	mMETA_SK_STATE
 = 296,

87 
	mMETA_SK_REUSE
 = 297,

88 
	mMETA_SK_REFCNT
 = 298,

89 
	mMETA_SK_RCVBUF
 = 299,

90 
	mMETA_SK_SNDBUF
 = 300,

91 
	mMETA_SK_SHUTDOWN
 = 301,

92 
	mMETA_SK_PROTO
 = 302,

93 
	mMETA_SK_TYPE
 = 303,

94 
	mMETA_SK_RMEM_ALLOC
 = 304,

95 
	mMETA_SK_WMEM_ALLOC
 = 305,

96 
	mMETA_SK_WMEM_QUEUED
 = 306,

97 
	mMETA_SK_RCV_QLEN
 = 307,

98 
	mMETA_SK_SND_QLEN
 = 308,

99 
	mMETA_SK_ERR_QLEN
 = 309,

100 
	mMETA_SK_FORWARD_ALLOCS
 = 310,

101 
	mMETA_SK_ALLOCS
 = 311,

102 
	mMETA_SK_ROUTE_CAPS
 = 312,

103 
	mMETA_SK_HASH
 = 313,

104 
	mMETA_SK_LINGERTIME
 = 314,

105 
	mMETA_SK_ACK_BACKLOG
 = 315,

106 
	mMETA_SK_MAX_ACK_BACKLOG
 = 316,

107 
	mMETA_SK_PRIO
 = 317,

108 
	mMETA_SK_RCVLOWAT
 = 318,

109 
	mMETA_SK_RCVTIMEO
 = 319,

110 
	mMETA_SK_SNDTIMEO
 = 320,

111 
	mMETA_SK_SENDMSG_OFF
 = 321,

112 
	mMETA_SK_WRITE_PENDING
 = 322,

113 
	mMETA_VLAN
 = 323,

114 
	mMETA_RXHASH
 = 324,

115 
	mMETA_DEVNAME
 = 325,

116 
	mMETA_SK_BOUND_IF
 = 326,

117 
	mSTR
 = 327,

118 
	mQUOTED
 = 328

122 
	#ERROR
 258

	)

123 
	#LOGIC
 259

	)

124 
	#NOT
 260

	)

125 
	#OPERAND
 261

	)

126 
	#NUMBER
 262

	)

127 
	#ALIGN
 263

	)

128 
	#LAYER
 264

	)

129 
	#KW_OPEN
 265

	)

130 
	#KW_CLOSE
 266

	)

131 
	#KW_PLUS
 267

	)

132 
	#KW_MASK
 268

	)

133 
	#KW_SHIFT
 269

	)

134 
	#KW_AT
 270

	)

135 
	#EMATCH_CMP
 271

	)

136 
	#EMATCH_NBYTE
 272

	)

137 
	#EMATCH_TEXT
 273

	)

138 
	#EMATCH_META
 274

	)

139 
	#KW_EQ
 275

	)

140 
	#KW_GT
 276

	)

141 
	#KW_LT
 277

	)

142 
	#KW_FROM
 278

	)

143 
	#KW_TO
 279

	)

144 
	#META_RANDOM
 280

	)

145 
	#META_LOADAVG_0
 281

	)

146 
	#META_LOADAVG_1
 282

	)

147 
	#META_LOADAVG_2
 283

	)

148 
	#META_DEV
 284

	)

149 
	#META_PRIO
 285

	)

150 
	#META_PROTO
 286

	)

151 
	#META_PKTTYPE
 287

	)

152 
	#META_PKTLEN
 288

	)

153 
	#META_DATALEN
 289

	)

154 
	#META_MACLEN
 290

	)

155 
	#META_MARK
 291

	)

156 
	#META_TCINDEX
 292

	)

157 
	#META_RTCLASSID
 293

	)

158 
	#META_RTIIF
 294

	)

159 
	#META_SK_FAMILY
 295

	)

160 
	#META_SK_STATE
 296

	)

161 
	#META_SK_REUSE
 297

	)

162 
	#META_SK_REFCNT
 298

	)

163 
	#META_SK_RCVBUF
 299

	)

164 
	#META_SK_SNDBUF
 300

	)

165 
	#META_SK_SHUTDOWN
 301

	)

166 
	#META_SK_PROTO
 302

	)

167 
	#META_SK_TYPE
 303

	)

168 
	#META_SK_RMEM_ALLOC
 304

	)

169 
	#META_SK_WMEM_ALLOC
 305

	)

170 
	#META_SK_WMEM_QUEUED
 306

	)

171 
	#META_SK_RCV_QLEN
 307

	)

172 
	#META_SK_SND_QLEN
 308

	)

173 
	#META_SK_ERR_QLEN
 309

	)

174 
	#META_SK_FORWARD_ALLOCS
 310

	)

175 
	#META_SK_ALLOCS
 311

	)

176 
	#META_SK_ROUTE_CAPS
 312

	)

177 
	#META_SK_HASH
 313

	)

178 
	#META_SK_LINGERTIME
 314

	)

179 
	#META_SK_ACK_BACKLOG
 315

	)

180 
	#META_SK_MAX_ACK_BACKLOG
 316

	)

181 
	#META_SK_PRIO
 317

	)

182 
	#META_SK_RCVLOWAT
 318

	)

183 
	#META_SK_RCVTIMEO
 319

	)

184 
	#META_SK_SNDTIMEO
 320

	)

185 
	#META_SK_SENDMSG_OFF
 321

	)

186 
	#META_SK_WRITE_PENDING
 322

	)

187 
	#META_VLAN
 323

	)

188 
	#META_RXHASH
 324

	)

189 
	#META_DEVNAME
 325

	)

190 
	#META_SK_BOUND_IF
 326

	)

191 
	#STR
 327

	)

192 
	#QUOTED
 328

	)

195 #ià! 
defšed
 
YYSTYPE
 && ! defšed 
YYSTYPE_IS_DECLARED


196 
YYSTYPE
 
	tYYSTYPE
;

197 
	uYYSTYPE


201 
tcf_em_cmp
 
	mcmp
;

202 
em©ch_quÙed
 
	mq
;

203 
¹Æ_em©ch
 * 
	me
;

204 
¹Æ_pkoc
 * 
	mloc
;

205 
¹Æ_m‘a_v®ue
 *
	mmv
;

206 
ušt32_t
 
	mi
;

207 
ušt64_t
 
	mi64
;

208 * 
	ms
;

212 
	#YYSTYPE_IS_TRIVIAL
 1

	)

213 
	#YYSTYPE_IS_DECLARED
 1

	)

218 
em©ch_·r£
 (*
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
);

	@mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.y

13 
	~<Ãšk-´iv©e/Ãšk.h
>

14 
	~<Ãšk-´iv©e/tc.h
>

15 
	~<Ãšk/Ãšk.h
>

16 
	~<Ãšk/uts.h
>

17 
	~<Ãšk/rou‹/pkoc.h
>

18 
	~<Ãšk/rou‹/şs/em©ch.h
>

19 
	~<Ãšk/rou‹/şs/em©ch/cmp.h
>

20 
	~<Ãšk/rou‹/şs/em©ch/nby‹.h
>

21 
	~<Ãšk/rou‹/şs/em©ch/‹xt.h
>

22 
	~<Ãšk/rou‹/şs/em©ch/m‘a.h
>

24 
	#META_ALLOC
 
¹Æ_m‘a_v®ue_®loc_id


	)

25 
	#META_ID
(
Çme
è
TCF_META_ID_
##
	)
Çme

26 
	#META_INT
 
TCF_META_TYPE_INT


	)

27 
	#META_VAR
 
TCF_META_TYPE_VAR


	)

30 %
”rÜ
-
v”bo£


31 %
defše
 
­i
.
pu»


32 %
Çme
-
´efix
 "ematch_"

34 %
·r£
-
·¿m
 {*
sÿÂ”
}

35 %
·r£
-
·¿m
 {**
”½
}

36 %
·r£
-
·¿m
 {
Æ_li¡_h—d
 *
roÙ
}

37 %
Ëx
-
·¿m
 {*
sÿÂ”
}

40 
tcf_em_cmp
 
cmp
;

41 
em©ch_quÙed
 
q
;

42 
¹Æ_em©ch
 * 
e
;

43 
¹Æ_pkoc
 * 
loc
;

44 
¹Æ_m‘a_v®ue
 *
mv
;

45 
ušt32_t
 
i
;

46 
ušt64_t
 
i64
;

47 * 
s
;

51 
em©ch_Ëx
(
YYSTYPE
 *, *);

53 
	$yy”rÜ
(*
sÿÂ”
, **
”½
, 
Æ_li¡_h—d
 *
roÙ
, cÚ¡ *
msg
)

55 ià(
msg
)

56 *
”½
 = 
	`¡rdup
(
msg
);

58 *
”½
 = 
NULL
;

59 
	}
}

62 %
tok’
 <
i
> 
ERROR
 
LOGIC
 
NOT
 
OPERAND
 
NUMBER
 
ALIGN
 
LAYER


63 %
tok’
 <
i
> 
KW_OPEN
 "("

64 %
tok’
 <
i
> 
KW_CLOSE
 ")"

65 %
tok’
 <
i
> 
KW_PLUS
 "+"

66 %
tok’
 <
i
> 
KW_MASK
 "mask"

67 %
tok’
 <
i
> 
KW_SHIFT
 ">>"

68 %
tok’
 <
i
> 
KW_AT
 "at"

69 %
tok’
 <
i
> 
EMATCH_CMP
 "cmp"

70 %
tok’
 <
i
> 
EMATCH_NBYTE
 "pattern"

71 %
tok’
 <
i
> 
EMATCH_TEXT
 "text"

72 %
tok’
 <
i
> 
EMATCH_META
 "meta"

73 %
tok’
 <
i
> 
KW_EQ
 "="

74 %
tok’
 <
i
> 
KW_GT
 ">"

75 %
tok’
 <
i
> 
KW_LT
 "<"

76 %
tok’
 <
i
> 
KW_FROM
 "from"

77 %
tok’
 <
i
> 
KW_TO
 "to"

79 %
tok’
 <
i
> 
META_RANDOM
 "random"

80 %
tok’
 <
i
> 
META_LOADAVG_0
 "loadavg_0"

81 %
tok’
 <
i
> 
META_LOADAVG_1
 "loadavg_1"

82 %
tok’
 <
i
> 
META_LOADAVG_2
 "loadavg_2"

83 %
tok’
 <
i
> 
META_DEV
 "dev"

84 %
tok’
 <
i
> 
META_PRIO
 "prio"

85 %
tok’
 <
i
> 
META_PROTO
 "proto"

86 %
tok’
 <
i
> 
META_PKTTYPE
 "pkttype"

87 %
tok’
 <
i
> 
META_PKTLEN
 "pktlen"

88 %
tok’
 <
i
> 
META_DATALEN
 "datalen"

89 %
tok’
 <
i
> 
META_MACLEN
 "maclen"

90 %
tok’
 <
i
> 
META_MARK
 "mark"

91 %
tok’
 <
i
> 
META_TCINDEX
 "tcindex"

92 %
tok’
 <
i
> 
META_RTCLASSID
 "rtclassid"

93 %
tok’
 <
i
> 
META_RTIIF
 "rtiif"

94 %
tok’
 <
i
> 
META_SK_FAMILY
 "sk_family"

95 %
tok’
 <
i
> 
META_SK_STATE
 "sk_state"

96 %
tok’
 <
i
> 
META_SK_REUSE
 "sk_reuse"

97 %
tok’
 <
i
> 
META_SK_REFCNT
 "sk_refcnt"

98 %
tok’
 <
i
> 
META_SK_RCVBUF
 "sk_rcvbuf"

99 %
tok’
 <
i
> 
META_SK_SNDBUF
 "sk_sndbuf"

100 %
tok’
 <
i
> 
META_SK_SHUTDOWN
 "sk_shutdown"

101 %
tok’
 <
i
> 
META_SK_PROTO
 "sk_proto"

102 %
tok’
 <
i
> 
META_SK_TYPE
 "sk_type"

103 %
tok’
 <
i
> 
META_SK_RMEM_ALLOC
 "sk_rmem_alloc"

104 %
tok’
 <
i
> 
META_SK_WMEM_ALLOC
 "sk_wmem_alloc"

105 %
tok’
 <
i
> 
META_SK_WMEM_QUEUED
 "sk_wmem_queued"

106 %
tok’
 <
i
> 
META_SK_RCV_QLEN
 "sk_rcv_qlen"

107 %
tok’
 <
i
> 
META_SK_SND_QLEN
 "sk_snd_qlen"

108 %
tok’
 <
i
> 
META_SK_ERR_QLEN
 "sk_err_qlen"

109 %
tok’
 <
i
> 
META_SK_FORWARD_ALLOCS
 "sk_forward_allocs"

110 %
tok’
 <
i
> 
META_SK_ALLOCS
 "sk_allocs"

111 %
tok’
 <
i
> 
META_SK_ROUTE_CAPS
 "sk_route_caps"

112 %
tok’
 <
i
> 
META_SK_HASH
 "sk_hash"

113 %
tok’
 <
i
> 
META_SK_LINGERTIME
 "sk_lingertime"

114 %
tok’
 <
i
> 
META_SK_ACK_BACKLOG
 "sk_ack_backlog"

115 %
tok’
 <
i
> 
META_SK_MAX_ACK_BACKLOG
 "sk_max_ack_backlog"

116 %
tok’
 <
i
> 
META_SK_PRIO
 "sk_prio"

117 %
tok’
 <
i
> 
META_SK_RCVLOWAT
 "sk_rcvlowat"

118 %
tok’
 <
i
> 
META_SK_RCVTIMEO
 "sk_rcvtimeo"

119 %
tok’
 <
i
> 
META_SK_SNDTIMEO
 "sk_sndtimeo"

120 %
tok’
 <
i
> 
META_SK_SENDMSG_OFF
 "sk_sendmsg_off"

121 %
tok’
 <
i
> 
META_SK_WRITE_PENDING
 "sk_write_pending"

122 %
tok’
 <
i
> 
META_VLAN
 "vlan"

123 %
tok’
 <
i
> 
META_RXHASH
 "rxhash"

124 %
tok’
 <
i
> 
META_DEVNAME
 "devname"

125 %
tok’
 <
i
> 
META_SK_BOUND_IF
 "sk_bound_if"

127 %
tok’
 <
s
> 
STR


129 %
tok’
 <
q
> 
QUOTED


131 %
ty³
 <
i
> 
®ign
 
İ”ªd
 
shiá
 
m‘a_št_id
 
m‘a_v¬_id


132 %
ty³
 <
i64
> 
mask


133 %
ty³
 <
e
> 
ex´
 
m©ch
 
em©ch


134 %
ty³
 <
cmp
> 
cmp_ex´
 
cmp_m©ch


135 %
ty³
 <
loc
> 
pkoc
 
‹xt_äom
 
‹xt_to


136 %
ty³
 <
q
> 
·‰”n


137 %
ty³
 <
mv
> 
m‘a_v®ue


139 %
de¡ruùÜ
 { 
ä“
(
$$
); 
NL_DBG
(2, "¡ršg de¡ruùÜ\n"); } <
s
>

140 %
de¡ruùÜ
 { 
¹Æ_pkoc_put
(
$$
); 
NL_DBG
(2, "pkoøde¡ruùÜ\n"); } <
loc
>

141 %
de¡ruùÜ
 { 
ä“
(
$$
.
d©a
); 
NL_DBG
(2, "quÙed de¡ruùÜ\n"); } <
q
>

142 %
de¡ruùÜ
 { 
¹Æ_m‘a_v®ue_put
(
$$
); 
NL_DBG
(2, "m‘¨v®ude¡ruùÜ\n"); } <
mv
>

144 %
¡¬t
 
šput


146 %% /* 
	$yy·r£
 */ 
	`yyËx
()

148 
šput
:

150 | 
ex´


152 
	`Æ_li¡_add_
(
roÙ
, &
$1
->
e_li¡
);

156 
ex´
:

157 
m©ch


159 
$$
 = 
$1
;

161 | 
m©ch
 
LOGIC
 
ex´


163 
	`¹Æ_em©ch_£t_æags
(
$1
, 
$2
);

166 
	`Æ_li¡_add_
(&
$1
->
e_li¡
, &
$3
->e_list);

168 
$$
 = 
$1
;

172 
m©ch
:

173 
NOT
 
em©ch


175 
	`¹Æ_em©ch_£t_æags
(
$2
, 
TCF_EM_INVERT
);

176 
$$
 = 
$2
;

178 | 
em©ch


180 
$$
 = 
$1
;

184 
em©ch
:

186 
cmp_m©ch


188 
¹Æ_em©ch
 *
e
;

190 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

191 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

192 
YYABORT
;

195 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_CMP
) < 0)

196 
	`BUG
();

198 
	`¹Æ_em©ch_cmp_£t
(
e
, &
$1
);

199 
$$
 = 
e
;

201 | 
EMATCH_NBYTE
 "(" 
pkoc
 
KW_EQ
 
·‰”n
 ")"

203 
¹Æ_em©ch
 *
e
;

205 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

206 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

207 
YYABORT
;

210 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_NBYTE
) < 0)

211 
	`BUG
();

213 
	`¹Æ_em©ch_nby‹_£t_off£t
(
e
, 
$3
->
Ïy”
, $3->
off£t
);

214 
	`¹Æ_pkoc_put
(
$3
);

215 
	`¹Æ_em©ch_nby‹_£t_·‰”n
(
e
, (
ušt8_t
 *è
$5
.
d©a
, $5.
šdex
);

217 
$$
 = 
e
;

219 | 
EMATCH_TEXT
 "(" 
STR
 
QUOTED
 
‹xt_äom
 
‹xt_to
 ")"

221 
¹Æ_em©ch
 *
e
;

223 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

224 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

225 
YYABORT
;

228 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_TEXT
) < 0)

229 
	`BUG
();

231 
	`¹Æ_em©ch_‹xt_£t_®go
(
e
, 
$3
);

232 
	`¹Æ_em©ch_‹xt_£t_·‰”n
(
e
, 
$4
.
d©a
, $4.
šdex
);

234 ià(
$5
) {

235 
	`¹Æ_em©ch_‹xt_£t_äom
(
e
, 
$5
->
Ïy”
, $5->
off£t
);

236 
	`¹Æ_pkoc_put
(
$5
);

239 ià(
$6
) {

240 
	`¹Æ_em©ch_‹xt_£t_to
(
e
, 
$6
->
Ïy”
, $6->
off£t
);

241 
	`¹Æ_pkoc_put
(
$6
);

244 
$$
 = 
e
;

246 | 
EMATCH_META
 "(" 
m‘a_v®ue
 
İ”ªd
 meta_value ")"

248 
¹Æ_em©ch
 *
e
;

250 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

251 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

252 
YYABORT
;

255 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_META
) < 0)

256 
	`BUG
();

258 
	`¹Æ_em©ch_m‘a_£t_lv®ue
(
e
, 
$3
);

259 
	`¹Æ_em©ch_m‘a_£t_rv®ue
(
e
, 
$5
);

260 
	`¹Æ_em©ch_m‘a_£t_İ”ªd
(
e
, 
$4
);

262 
$$
 = 
e
;

265 | "(" 
ex´
 ")"

267 
¹Æ_em©ch
 *
e
;

269 ià(!(
e
 = 
	`¹Æ_em©ch_®loc
())) {

270 *
”½
 = 
	`¡rdup
("Unableo‡llocateƒmatch object");

271 
YYABORT
;

274 ià(
	`¹Æ_em©ch_£t_kšd
(
e
, 
TCF_EM_CONTAINER
) < 0)

275 
	`BUG
();

278 
	`Æ_li¡_add_
(&
e
->
e_chds
, &
$2
->
e_li¡
);

280 
$$
 = 
e
;

292 
cmp_m©ch
:

293 
EMATCH_CMP
 "(" 
cmp_ex´
 ")"

294 { 
$$
 = 
$3
; }

295 | 
cmp_ex´


296 { 
$$
 = 
$1
; }

299 
cmp_ex´
:

300 
pkoc
 
İ”ªd
 
NUMBER


302 ià(
$1
->
®ign
 =ğ
TCF_EM_ALIGN_U16
 ||

303 
$1
->
®ign
 =ğ
TCF_EM_ALIGN_U32
)

304 
$$
.
æags
 = 
TCF_EM_CMP_TRANS
;

306 
	`mem£t
(&
$$
, 0, ($$));

308 
$$
.
mask
 = 
$1
->mask;

309 
$$
.
off
 = 
$1
->
off£t
;

310 
$$
.
®ign
 = 
$1
->align;

311 
$$
.
Ïy”
 = 
$1
->layer;

312 
$$
.
İnd
 = 
$2
;

313 
$$
.
v®
 = 
$3
;

315 
	`¹Æ_pkoc_put
(
$1
);

319 
‹xt_äom
:

321 { 
$$
 = 
NULL
; }

322 | "äom" 
pkoc


323 { 
$$
 = 
$2
; }

326 
‹xt_to
:

328 { 
$$
 = 
NULL
; }

329 | "to" 
pkoc


330 { 
$$
 = 
$2
; }

333 
m‘a_v®ue
:

334 
QUOTED


335 { 
$$
 = 
	`¹Æ_m‘a_v®ue_®loc_v¬
(
$1
.
d©a
, $1.
Ën
); }

336 | 
NUMBER


337 { 
$$
 = 
	`¹Æ_m‘a_v®ue_®loc_št
(
$1
); }

338 | 
m‘a_št_id
 
shiá
 
mask


339 { 
$$
 = 
	`META_ALLOC
(
META_INT
, 
$1
, 
$2
, 
$3
); }

340 | 
m‘a_v¬_id
 
shiá


341 { 
$$
 = 
	`META_ALLOC
(
META_VAR
, 
$1
, 
$2
, 0); }

344 
m‘a_št_id
:

345 
META_RANDOM
 { 
$$
 = 
	`META_ID
(
RANDOM
); }

346 |
META_LOADAVG_0
 { 
$$
 = 
	`META_ID
(
LOADAVG_0
); }

347 |
META_LOADAVG_1
 { 
$$
 = 
	`META_ID
(
LOADAVG_1
); }

348 |
META_LOADAVG_2
 { 
$$
 = 
	`META_ID
(
LOADAVG_2
); }

349 | 
META_DEV
 { 
$$
 = 
	`META_ID
(
DEV
); }

350 | 
META_PRIO
 { 
$$
 = 
	`META_ID
(
PRIORITY
); }

351 | 
META_PROTO
 { 
$$
 = 
	`META_ID
(
PROTOCOL
); }

352 | 
META_PKTTYPE
 { 
$$
 = 
	`META_ID
(
PKTTYPE
); }

353 | 
META_PKTLEN
 { 
$$
 = 
	`META_ID
(
PKTLEN
); }

354 | 
META_DATALEN
 { 
$$
 = 
	`META_ID
(
DATALEN
); }

355 | 
META_MACLEN
 { 
$$
 = 
	`META_ID
(
MACLEN
); }

356 | 
META_MARK
 { 
$$
 = 
	`META_ID
(
NFMARK
); }

357 | 
META_TCINDEX
 { 
$$
 = 
	`META_ID
(
TCINDEX
); }

358 | 
META_RTCLASSID
 { 
$$
 = 
	`META_ID
(
RTCLASSID
); }

359 | 
META_RTIIF
 { 
$$
 = 
	`META_ID
(
RTIIF
); }

360 | 
META_SK_FAMILY
 { 
$$
 = 
	`META_ID
(
SK_FAMILY
); }

361 | 
META_SK_STATE
 { 
$$
 = 
	`META_ID
(
SK_STATE
); }

362 | 
META_SK_REUSE
 { 
$$
 = 
	`META_ID
(
SK_REUSE
); }

363 | 
META_SK_REFCNT
 { 
$$
 = 
	`META_ID
(
SK_REFCNT
); }

364 | 
META_SK_RCVBUF
 { 
$$
 = 
	`META_ID
(
SK_RCVBUF
); }

365 | 
META_SK_SNDBUF
 { 
$$
 = 
	`META_ID
(
SK_SNDBUF
); }

366 | 
META_SK_SHUTDOWN
 { 
$$
 = 
	`META_ID
(
SK_SHUTDOWN
); }

367 | 
META_SK_PROTO
 { 
$$
 = 
	`META_ID
(
SK_PROTO
); }

368 | 
META_SK_TYPE
 { 
$$
 = 
	`META_ID
(
SK_TYPE
); }

369 | 
META_SK_RMEM_ALLOC
 { 
$$
 = 
	`META_ID
(
SK_RMEM_ALLOC
); }

370 | 
META_SK_WMEM_ALLOC
 { 
$$
 = 
	`META_ID
(
SK_WMEM_ALLOC
); }

371 | 
META_SK_WMEM_QUEUED
 { 
$$
 = 
	`META_ID
(
SK_WMEM_QUEUED
); }

372 | 
META_SK_RCV_QLEN
 { 
$$
 = 
	`META_ID
(
SK_RCV_QLEN
); }

373 | 
META_SK_SND_QLEN
 { 
$$
 = 
	`META_ID
(
SK_SND_QLEN
); }

374 | 
META_SK_ERR_QLEN
 { 
$$
 = 
	`META_ID
(
SK_ERR_QLEN
); }

375 | 
META_SK_FORWARD_ALLOCS
 { 
$$
 = 
	`META_ID
(
SK_FORWARD_ALLOCS
); }

376 | 
META_SK_ALLOCS
 { 
$$
 = 
	`META_ID
(
SK_ALLOCS
); }

377 | 
META_SK_ROUTE_CAPS
 { 
$$
 = 
	`META_ID
(
SK_ROUTE_CAPS
); }

378 | 
META_SK_HASH
 { 
$$
 = 
	`META_ID
(
SK_HASH
); }

379 | 
META_SK_LINGERTIME
 { 
$$
 = 
	`META_ID
(
SK_LINGERTIME
); }

380 | 
META_SK_ACK_BACKLOG
 { 
$$
 = 
	`META_ID
(
SK_ACK_BACKLOG
); }

381 | 
META_SK_MAX_ACK_BACKLOG
 { 
$$
 = 
	`META_ID
(
SK_MAX_ACK_BACKLOG
); }

382 | 
META_SK_PRIO
 { 
$$
 = 
	`META_ID
(
SK_PRIO
); }

383 | 
META_SK_RCVLOWAT
 { 
$$
 = 
	`META_ID
(
SK_RCVLOWAT
); }

384 | 
META_SK_RCVTIMEO
 { 
$$
 = 
	`META_ID
(
SK_RCVTIMEO
); }

385 | 
META_SK_SNDTIMEO
 { 
$$
 = 
	`META_ID
(
SK_SNDTIMEO
); }

386 | 
META_SK_SENDMSG_OFF
 { 
$$
 = 
	`META_ID
(
SK_SENDMSG_OFF
); }

387 | 
META_SK_WRITE_PENDING
 { 
$$
 = 
	`META_ID
(
SK_WRITE_PENDING
); }

388 | 
META_VLAN
 { 
$$
 = 
	`META_ID
(
VLAN_TAG
); }

389 | 
META_RXHASH
 { 
$$
 = 
	`META_ID
(
RXHASH
); }

392 
m‘a_v¬_id
:

393 
META_DEVNAME
 { 
$$
 = 
	`META_ID
(
DEV
); }

394 | 
META_SK_BOUND_IF
 { 
$$
 = 
	`META_ID
(
SK_BOUND_IF
); }

400 
·‰”n
:

401 
QUOTED


403 
$$
 = 
$1
;

405 | 
STR


407 
Æ_addr
 *
addr
;

409 ià(
	`Æ_addr_·r£
(
$1
, 
AF_UNSPEC
, &
addr
) == 0) {

410 
$$
.
Ën
 = 
	`Æ_addr_g‘_Ën
(
addr
);

412 
$$
.
šdex
 = 
	`mš_t
(, $$.
Ën
, 
	`Æ_addr_g‘_´efixËn
(
addr
)/8);

414 ià(!(
$$
.
d©a
 = 
	`ÿÎoc
(1, $$.
Ën
))) {

415 
	`Æ_addr_put
(
addr
);

416 
YYABORT
;

419 
	`memıy
(
$$
.
d©a
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
), $$.
Ën
);

420 
	`Æ_addr_put
(
addr
);

422 ià(
	`a¥rštf
(
”½
, "šv®id…©‹º \"%s\"", 
$1
) == -1)

423 *
”½
 = 
NULL
;

424 
YYABORT
;

433 
pkoc
:

434 
STR


436 
¹Æ_pkoc
 *
loc
;

438 ià(
	`¹Æ_pkoc_lookup
(
$1
, &
loc
) < 0) {

439 ià(
	`a¥rštf
(
”½
, "Pack‘†oÿtiÚ \"%s\"‚Ù found", 
$1
) == -1)

440 *
”½
 = 
NULL
;

441 
YYABORT
;

444 
$$
 = 
loc
;

447 | 
®ign
 
LAYER
 "+" 
NUMBER
 
mask


449 
¹Æ_pkoc
 *
loc
;

451 ià(
$5
 && (!
$1
 || $1 > 
TCF_EM_ALIGN_U32
)) {

452 *
”½
 = 
	`¡rdup
("mask only‡llowed for‡lignments u8|u16|u32");

453 
YYABORT
;

456 ià(!(
loc
 = 
	`¹Æ_pkoc_®loc
())) {

457 *
”½
 = 
	`¡rdup
("Unableo‡llocate…acket†ocation object");

458 
YYABORT
;

461 
loc
->
Çme
 = 
	`¡rdup
("<USER-DEFINED>");

462 
loc
->
®ign
 = 
$1
;

463 
loc
->
Ïy”
 = 
$2
;

464 
loc
->
off£t
 = 
$4
;

465 
loc
->
mask
 = 
$5
;

467 
$$
 = 
loc
;

471 
®ign
:

473 { 
$$
 = 0; }

474 | 
ALIGN
 "at"

475 { 
$$
 = 
$1
; }

476 | 
NUMBER
 "at"

477 { 
$$
 = 
$1
; }

480 
mask
:

482 { 
$$
 = 0; }

483 | 
KW_MASK
 
NUMBER


484 { 
$$
 = 
$2
; }

487 
shiá
:

489 { 
$$
 = 0; }

490 | 
KW_SHIFT
 
NUMBER


491 { 
$$
 = 
$2
; }

494 
İ”ªd
:

495 
KW_EQ


496 { 
$$
 = 
TCF_EM_OPND_EQ
; }

497 | 
KW_GT


498 { 
$$
 = 
TCF_EM_OPND_GT
; }

499 | 
KW_LT


500 { 
$$
 = 
TCF_EM_OPND_LT
; }

	@mylibnl/libnl-3.2.25/lib/route/cls/fw.c

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk-´iv©e/tc.h
>

23 
	~<Ãšk/Ãšk.h
>

24 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

25 
	~<Ãšk/rou‹/şassif›r.h
>

26 
	~<Ãšk/rou‹/şs/fw.h
>

29 
	#FW_ATTR_CLASSID
 0x001

	)

30 
	#FW_ATTR_ACTION
 0x002

	)

31 
	#FW_ATTR_POLICE
 0x004

	)

32 
	#FW_ATTR_INDEV
 0x008

	)

33 
	#FW_ATTR_MASK
 0x010

	)

36 
Æa_pŞicy
 
	gfw_pŞicy
[
TCA_FW_MAX
+1] = {

37 [
TCA_FW_CLASSID
] = { .
ty³
 = 
NLA_U32
 },

38 [
TCA_FW_INDEV
] = { .
ty³
 = 
NLA_STRING
,

39 .
	gmaxËn
 = 
IFNAMSIZ
 },

40 [
TCA_FW_MASK
] = { .
ty³
 = 
NLA_U32
 },

43 
	$fw_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

45 
Æ©Œ
 *
tb
[
TCA_FW_MAX
 + 1];

46 
¹Æ_fw
 *
f
 = 
d©a
;

47 
”r
;

49 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_FW_MAX
, 
tc
, 
fw_pŞicy
);

50 ià(
”r
 < 0)

51  
”r
;

53 ià(
tb
[
TCA_FW_CLASSID
]) {

54 
f
->
cf_şassid
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FW_CLASSID
]);

55 
f
->
cf_mask
 |ğ
FW_ATTR_CLASSID
;

58 ià(
tb
[
TCA_FW_ACT
]) {

59 
f
->
cf_aù
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_FW_ACT
]);

60 ià(!
f
->
cf_aù
)

61  -
NLE_NOMEM
;

62 
f
->
cf_mask
 |ğ
FW_ATTR_ACTION
;

65 ià(
tb
[
TCA_FW_POLICE
]) {

66 
f
->
cf_pŞiû
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_FW_POLICE
]);

67 ià(!
f
->
cf_pŞiû
)

68  -
NLE_NOMEM
;

69 
f
->
cf_mask
 |ğ
FW_ATTR_POLICE
;

72 ià(
tb
[
TCA_FW_INDEV
]) {

73 
	`Æa_¡¾ıy
(
f
->
cf_šdev
, 
tb
[
TCA_FW_INDEV
], 
IFNAMSIZ
);

74 
f
->
cf_mask
 |ğ
FW_ATTR_INDEV
;

77 ià(
tb
[
TCA_FW_MASK
]) {

78 
f
->
cf_fwmask
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FW_MASK
]);

79 
f
->
cf_mask
 |ğ
FW_ATTR_MASK
;

83 
	}
}

85 
	$fw_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

87 
¹Æ_fw
 *
f
 = 
d©a
;

89 
	`Æ_d©a_ä“
(
f
->
cf_aù
);

90 
	`Æ_d©a_ä“
(
f
->
cf_pŞiû
);

91 
	}
}

93 
	$fw_şÚe
(*
_d¡
, *
_¤c
)

95 
¹Æ_fw
 *
d¡
 = 
_d¡
, *
¤c
 = 
_¤c
;

97 ià(
¤c
->
cf_aù
 && !(
d¡
->cf_aù = 
	`Æ_d©a_şÚe
(src->cf_act)))

98  -
NLE_NOMEM
;

100 ià(
¤c
->
cf_pŞiû
 && !(
d¡
->cf_pŞiû = 
	`Æ_d©a_şÚe
(src->cf_police)))

101  -
NLE_NOMEM
;

104 
	}
}

106 
	$fw_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

107 
Æ_dump_·¿ms
 *
p
)

109 
¹Æ_fw
 *
f
 = 
d©a
;

111 ià(!
f
)

114 ià(
f
->
cf_mask
 & 
FW_ATTR_CLASSID
) {

115 
buf
[32];

117 
	`Æ_dump
(
p
, "arget %s",

118 
	`¹Æ_tc_hªdË2¡r
(
f
->
cf_şassid
, 
buf
, (buf)));

121 ià(
f
->
cf_mask
 & 
FW_ATTR_MASK
)

122 
	`Æ_dump
(
p
, " mask 0x%x", 
f
->
cf_fwmask
);

123 
	}
}

125 
	$fw_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

126 
Æ_dump_·¿ms
 *
p
)

128 
¹Æ_fw
 *
f
 = 
d©a
;

130 ià(
f
 && f->
cf_mask
 & 
FW_ATTR_INDEV
)

131 
	`Æ_dump
(
p
, "šdev % ", 
f
->
cf_šdev
);

132 
	}
}

134 
	$fw_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

136 
¹Æ_fw
 *
f
 = 
d©a
;

138 ià(!
f
)

141 ià(
f
->
cf_mask
 & 
FW_ATTR_CLASSID
)

142 
	`NLA_PUT_U32
(
msg
, 
TCA_FW_CLASSID
, 
f
->
cf_şassid
);

144 ià(
f
->
cf_mask
 & 
FW_ATTR_ACTION
)

145 
	`NLA_PUT_DATA
(
msg
, 
TCA_FW_ACT
, 
f
->
cf_aù
);

147 ià(
f
->
cf_mask
 & 
FW_ATTR_POLICE
)

148 
	`NLA_PUT_DATA
(
msg
, 
TCA_FW_POLICE
, 
f
->
cf_pŞiû
);

150 ià(
f
->
cf_mask
 & 
FW_ATTR_INDEV
)

151 
	`NLA_PUT_STRING
(
msg
, 
TCA_FW_INDEV
, 
f
->
cf_šdev
);

153 ià(
f
->
cf_mask
 & 
FW_ATTR_MASK
)

154 
	`NLA_PUT_U32
(
msg
, 
TCA_FW_MASK
, 
f
->
cf_fwmask
);

158 
Æa_put_çu»
:

159  -
NLE_MSGSIZE
;

160 
	}
}

167 
	$¹Æ_fw_£t_şassid
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
şassid
)

169 
¹Æ_fw
 *
f
;

171 ià(!(
f
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

172  -
NLE_NOMEM
;

174 
f
->
cf_şassid
 = 
şassid
;

175 
f
->
cf_mask
 |ğ
FW_ATTR_CLASSID
;

178 
	}
}

180 
	$¹Æ_fw_£t_mask
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
mask
)

182 
¹Æ_fw
 *
f
;

184 ià(!(
f
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

185  -
NLE_NOMEM
;

187 
f
->
cf_fwmask
 = 
mask
;

188 
f
->
cf_mask
 |ğ
FW_ATTR_MASK
;

191 
	}
}

195 
¹Æ_tc_İs
 
	gfw_İs
 = {

196 .
to_kšd
 = "fw",

197 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLS
,

198 .
	gto_size
 = (
¹Æ_fw
),

199 .
	gto_msg_·r£r
 = 
fw_msg_·r£r
,

200 .
	gto_msg_fl
 = 
fw_msg_fl
,

201 .
	gto_ä“_d©a
 = 
fw_ä“_d©a
,

202 .
	gto_şÚe
 = 
fw_şÚe
,

203 .
	gto_dump
 = {

204 [
NL_DUMP_LINE
] = 
fw_dump_lše
,

205 [
NL_DUMP_DETAILS
] = 
fw_dump_d‘as
,

209 
__š™
 
	$fw_š™
()

211 
	`¹Æ_tc_»gi¡”
(&
fw_İs
);

212 
	}
}

214 
__ex™
 
	$fw_ex™
()

216 
	`¹Æ_tc_uÄegi¡”
(&
fw_İs
);

217 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/police.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk-´iv©e/tc.h
>

14 
	~<Ãšk/Ãšk.h
>

15 
	~<Ãšk/uts.h
>

16 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

17 
	~<Ãšk/rou‹/şassif›r.h
>

18 
	~<Ãšk/rou‹/şs/pŞiû.h
>

25 cÚ¡ 
Œªs_tbl
 
	gpŞiû_ty³s
[] = {

26 
__ADD
(
TC_POLICE_UNSPEC
,
un¥ec
)

27 
__ADD
(
TC_POLICE_OK
,
ok
)

28 
__ADD
(
TC_POLICE_RECLASSIFY
,
»şassify
)

29 
__ADD
(
TC_POLICE_SHOT
,
shÙ
)

30 #ifdeà
TC_POLICE_PIPE


31 
__ADD
(
TC_POLICE_PIPE
,
pe
)

46 * 
	$Æ_pŞiû2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
)

48  
	`__ty³2¡r
(
ty³
, 
buf
, 
Ën
, 
pŞiû_ty³s
,

49 
	`ARRAY_SIZE
(
pŞiû_ty³s
));

50 
	}
}

61 
	$Æ_¡r2pŞiû
(cÚ¡ *
Çme
)

63  
	`__¡r2ty³
(
Çme
, 
pŞiû_ty³s
, 
	`ARRAY_SIZE
(police_types));

64 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/cls/u32.c

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk-´iv©e/tc.h
>

23 
	~<Ãšk/Ãšk.h
>

24 
	~<Ãšk/©Œ.h
>

25 
	~<Ãšk/uts.h
>

26 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

27 
	~<Ãšk/rou‹/şassif›r.h
>

28 
	~<Ãšk/rou‹/şs/u32.h
>

29 
	~<Ãšk/rou‹/aùiÚ.h
>

32 
	#U32_ATTR_DIVISOR
 0x001

	)

33 
	#U32_ATTR_HASH
 0x002

	)

34 
	#U32_ATTR_CLASSID
 0x004

	)

35 
	#U32_ATTR_LINK
 0x008

	)

36 
	#U32_ATTR_PCNT
 0x010

	)

37 
	#U32_ATTR_SELECTOR
 0x020

	)

38 
	#U32_ATTR_ACTION
 0x040

	)

39 
	#U32_ATTR_POLICE
 0x080

	)

40 
	#U32_ATTR_INDEV
 0x100

	)

43 
šlše
 
tc_u32_£l
 *
	$u32_£ËùÜ
(
¹Æ_u32
 *
u
)

45  (
tc_u32_£l
 *è
u
->
cu_£ËùÜ
->
d_d©a
;

46 
	}
}

48 
šlše
 
tc_u32_£l
 *
	$u32_£ËùÜ_®loc
(
¹Æ_u32
 *
u
)

50 ià(!
u
->
cu_£ËùÜ
)

51 
u
->
cu_£ËùÜ
 = 
	`Æ_d©a_®loc
(
NULL
, (
tc_u32_£l
));

53  
	`u32_£ËùÜ
(
u
);

54 
	}
}

56 
Æa_pŞicy
 
	gu32_pŞicy
[
TCA_U32_MAX
+1] = {

57 [
TCA_U32_DIVISOR
] = { .
ty³
 = 
NLA_U32
 },

58 [
TCA_U32_HASH
] = { .
ty³
 = 
NLA_U32
 },

59 [
TCA_U32_CLASSID
] = { .
ty³
 = 
NLA_U32
 },

60 [
TCA_U32_LINK
] = { .
ty³
 = 
NLA_U32
 },

61 [
TCA_U32_INDEV
] = { .
ty³
 = 
NLA_STRING
,

62 .
	gmaxËn
 = 
IFNAMSIZ
 },

63 [
TCA_U32_SEL
] = { .
mšËn
 = (
tc_u32_£l
) },

64 [
TCA_U32_PCNT
] = { .
mšËn
 = (
tc_u32_pút
) },

67 
	$u32_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

69 
¹Æ_u32
 *
u
 = 
d©a
;

70 
Æ©Œ
 *
tb
[
TCA_U32_MAX
 + 1];

71 
”r
;

73 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_U32_MAX
, 
tc
, 
u32_pŞicy
);

74 ià(
”r
 < 0)

75  
”r
;

77 ià(
tb
[
TCA_U32_DIVISOR
]) {

78 
u
->
cu_divisÜ
 = 
	`Æa_g‘_u32
(
tb
[
TCA_U32_DIVISOR
]);

79 
u
->
cu_mask
 |ğ
U32_ATTR_DIVISOR
;

82 ià(
tb
[
TCA_U32_SEL
]) {

83 
u
->
cu_£ËùÜ
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_U32_SEL
]);

84 ià(!
u
->
cu_£ËùÜ
)

85 
”rout_nomem
;

86 
u
->
cu_mask
 |ğ
U32_ATTR_SELECTOR
;

89 ià(
tb
[
TCA_U32_HASH
]) {

90 
u
->
cu_hash
 = 
	`Æa_g‘_u32
(
tb
[
TCA_U32_HASH
]);

91 
u
->
cu_mask
 |ğ
U32_ATTR_HASH
;

94 ià(
tb
[
TCA_U32_CLASSID
]) {

95 
u
->
cu_şassid
 = 
	`Æa_g‘_u32
(
tb
[
TCA_U32_CLASSID
]);

96 
u
->
cu_mask
 |ğ
U32_ATTR_CLASSID
;

99 ià(
tb
[
TCA_U32_LINK
]) {

100 
u
->
cu_lšk
 = 
	`Æa_g‘_u32
(
tb
[
TCA_U32_LINK
]);

101 
u
->
cu_mask
 |ğ
U32_ATTR_LINK
;

104 ià(
tb
[
TCA_U32_ACT
]) {

105 
u
->
cu_mask
 |ğ
U32_ATTR_ACTION
;

106 
”r
 = 
	`¹Æ_aù_·r£
(&
u
->
cu_aù
, 
tb
[
TCA_U32_ACT
]);

107 ià(
”r
)

108  
”r
;

111 ià(
tb
[
TCA_U32_POLICE
]) {

112 
u
->
cu_pŞiû
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_U32_POLICE
]);

113 ià(!
u
->
cu_pŞiû
)

114 
”rout_nomem
;

115 
u
->
cu_mask
 |ğ
U32_ATTR_POLICE
;

118 ià(
tb
[
TCA_U32_PCNT
]) {

119 
tc_u32_£l
 *
£l
;

120 
size_t
 
pút_size
;

122 ià(!
tb
[
TCA_U32_SEL
]) {

123 
”r
 = -
NLE_MISSING_ATTR
;

124 
”rout
;

127 
£l
 = 
u
->
cu_£ËùÜ
->
d_d©a
;

128 
pút_size
 = (
tc_u32_pút
) +

129 (
£l
->
nkeys
 * (
ušt64_t
));

130 ià(
	`Æa_Ën
(
tb
[
TCA_U32_PCNT
]è< 
pút_size
) {

131 
”r
 = -
NLE_INVAL
;

132 
”rout
;

135 
u
->
cu_pút
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_U32_PCNT
]);

136 ià(!
u
->
cu_pút
)

137 
”rout_nomem
;

138 
u
->
cu_mask
 |ğ
U32_ATTR_PCNT
;

141 ià(
tb
[
TCA_U32_INDEV
]) {

142 
	`Æa_¡¾ıy
(
u
->
cu_šdev
, 
tb
[
TCA_U32_INDEV
], 
IFNAMSIZ
);

143 
u
->
cu_mask
 |ğ
U32_ATTR_INDEV
;

148 
”rout_nomem
:

149 
”r
 = -
NLE_NOMEM
;

150 
”rout
:

151  
”r
;

152 
	}
}

154 
	$u32_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

156 
¹Æ_u32
 *
u
 = 
d©a
;

158 ià(
u
->
cu_aù
)

159 
	`¹Æ_aù_put_®l
(&
u
->
cu_aù
);

160 
	`Æ_d©a_ä“
(
u
->
cu_£ËùÜ
);

161 
	`Æ_d©a_ä“
(
u
->
cu_pŞiû
);

162 
	`Æ_d©a_ä“
(
u
->
cu_pút
);

163 
	}
}

165 
	$u32_şÚe
(*
_d¡
, *
_¤c
)

167 
¹Æ_u32
 *
d¡
 = 
_d¡
, *
¤c
 = 
_¤c
;

169 ià(
¤c
->
cu_£ËùÜ
 &&

170 !(
d¡
->
cu_£ËùÜ
 = 
	`Æ_d©a_şÚe
(
¤c
->cu_selector)))

171  -
NLE_NOMEM
;

173 ià(
¤c
->
cu_aù
) {

174 ià(!(
d¡
->
cu_aù
 = 
	`¹Æ_aù_®loc
()))

175  -
NLE_NOMEM
;

177 
	`memıy
(
d¡
->
cu_aù
, 
¤c
->cu_aù, (
¹Æ_aù
));

180 ià(
¤c
->
cu_pŞiû
 && !(
d¡
->cu_pŞiû = 
	`Æ_d©a_şÚe
(src->cu_police)))

181  -
NLE_NOMEM
;

183 ià(
¤c
->
cu_pút
 && !(
d¡
->cu_púˆğ
	`Æ_d©a_şÚe
(src->cu_pcnt)))

184  -
NLE_NOMEM
;

187 
	}
}

189 
	$u32_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

190 
Æ_dump_·¿ms
 *
p
)

192 
¹Æ_u32
 *
u
 = 
d©a
;

193 
buf
[32];

195 ià(!
u
)

198 ià(
u
->
cu_mask
 & 
U32_ATTR_DIVISOR
)

199 
	`Æ_dump
(
p
, " divisÜ %u", 
u
->
cu_divisÜ
);

200 ià(
u
->
cu_mask
 & 
U32_ATTR_CLASSID
)

201 
	`Æ_dump
(
p
, "arget %s",

202 
	`¹Æ_tc_hªdË2¡r
(
u
->
cu_şassid
, 
buf
, (buf)));

203 
	}
}

205 
	$´št_£ËùÜ
(
Æ_dump_·¿ms
 *
p
, 
tc_u32_£l
 *
£l
,

206 
¹Æ_u32
 *
u
)

208 
i
;

209 
tc_u32_key
 *
key
;

211 ià(
£l
->
hmask
 || s–->
hoff
) {

216 
	`Æ_dump
(
p
, " hash‡ˆ%u & 0x%x", 
£l
->
hoff
, s–->
hmask
);

219 ià(
£l
->
æags
 & (
TC_U32_OFFSET
 | 
TC_U32_VAROFFSET
)) {

220 
	`Æ_dump
(
p
, " off£ˆ© %u", 
£l
->
off
);

222 ià(
£l
->
æags
 & 
TC_U32_VAROFFSET
)

223 
	`Æ_dump
(
p
, " variable (at %u & 0x%x) >> %u",

224 
£l
->
offoff
, 
	`Áohs
(£l->
offmask
), s–->
offshiá
);

227 ià(
£l
->
æags
) {

228 
æags
 = 
£l
->flags;

229 
	`Æ_dump
(
p
, " <");

231 
	#PRINT_FLAG
(
f
èià(
æags
 & 
TC_U32_
##f) { \

232 
æags
 &ğ~
TC_U32_
##
f
; 
	`Æ_dump
(
p
, #à"%s", fÏg ? "," : ""); }

	)

234 
	`PRINT_FLAG
(
TERMINAL
);

235 
	`PRINT_FLAG
(
OFFSET
);

236 
	`PRINT_FLAG
(
VAROFFSET
);

237 
	`PRINT_FLAG
(
EAT
);

238 #undeà
PRINT_FLAG


240 
	`Æ_dump
(
p
, ">");

244 
i
 = 0; i < 
£l
->
nkeys
; i++) {

245 
key
 = (
tc_u32_key
 *è((*è
£l
 + (*£l)è+ 
i
;

247 
	`Æ_dump
(
p
, "\n");

248 
	`Æ_dump_lše
(
p
, " match key‡t %s%u ",

249 
key
->
offmask
 ? "Ãxthdr+" : "", key->
off
);

251 ià(
key
->
offmask
)

252 
	`Æ_dump
(
p
, "[0x%u] ", 
key
->
offmask
);

254 
	`Æ_dump
(
p
, "& 0x%08x =ğ0x%08x", 
	`Áohl
(
key
->
mask
),‚tohl(key->
v®
));

256 ià(
p
->
dp_ty³
 =ğ
NL_DUMP_STATS
 &&

257 (
u
->
cu_mask
 & 
U32_ATTR_PCNT
)) {

258 
tc_u32_pút
 *
pút
 = 
u
->
cu_pút
->
d_d©a
;

259 
	`Æ_dump
(
p
, " sucûssfuÈ%" 
PRIu64
, 
pút
->
kúts
[
i
]);

262 
	}
}

264 
	$u32_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

265 
Æ_dump_·¿ms
 *
p
)

267 
¹Æ_u32
 *
u
 = 
d©a
;

268 
tc_u32_£l
 *
s
;

270 ià(!
u
)

273 ià(!(
u
->
cu_mask
 & 
U32_ATTR_SELECTOR
)) {

274 
	`Æ_dump
(
p
, "no-selector\n");

278 
s
 = 
u
->
cu_£ËùÜ
->
d_d©a
;

280 
	`Æ_dump
(
p
, "nkey %u ", 
s
->
nkeys
);

282 ià(
u
->
cu_mask
 & 
U32_ATTR_HASH
)

283 
	`Æ_dump
(
p
, "ht key 0x%x hash 0x%u",

284 
	`TC_U32_USERHTID
(
u
->
cu_hash
), 
	`TC_U32_HASH
(u->cu_hash));

286 ià(
u
->
cu_mask
 & 
U32_ATTR_LINK
)

287 
	`Æ_dump
(
p
, "lšk %u ", 
u
->
cu_lšk
);

289 ià(
u
->
cu_mask
 & 
U32_ATTR_INDEV
)

290 
	`Æ_dump
(
p
, "šdev % ", 
u
->
cu_šdev
);

292 
	`´št_£ËùÜ
(
p
, 
s
, 
u
);

293 
	`Æ_dump
(
p
, "\n");

294 
	}
}

296 
	$u32_dump_¡©s
(
¹Æ_tc
 *
tc
, *
d©a
,

297 
Æ_dump_·¿ms
 *
p
)

299 
¹Æ_u32
 *
u
 = 
d©a
;

301 ià(!
u
)

304 ià(
u
->
cu_mask
 & 
U32_ATTR_PCNT
) {

305 
tc_u32_pút
 *
pc
 = 
u
->
cu_pút
->
d_d©a
;

306 
	`Æ_dump
(
p
, "\n");

307 
	`Æ_dump_lše
(
p
, " h™ %8" 
PRIu64
 " count %8" PRIu64 "\n",

308 
pc
->
rh™
,…c->
rút
);

310 
	}
}

312 
	$u32_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

314 
¹Æ_u32
 *
u
 = 
d©a
;

316 ià(!
u
)

319 ià(
u
->
cu_mask
 & 
U32_ATTR_DIVISOR
)

320 
	`NLA_PUT_U32
(
msg
, 
TCA_U32_DIVISOR
, 
u
->
cu_divisÜ
);

322 ià(
u
->
cu_mask
 & 
U32_ATTR_HASH
)

323 
	`NLA_PUT_U32
(
msg
, 
TCA_U32_HASH
, 
u
->
cu_hash
);

325 ià(
u
->
cu_mask
 & 
U32_ATTR_CLASSID
)

326 
	`NLA_PUT_U32
(
msg
, 
TCA_U32_CLASSID
, 
u
->
cu_şassid
);

328 ià(
u
->
cu_mask
 & 
U32_ATTR_LINK
)

329 
	`NLA_PUT_U32
(
msg
, 
TCA_U32_LINK
, 
u
->
cu_lšk
);

331 ià(
u
->
cu_mask
 & 
U32_ATTR_SELECTOR
)

332 
	`NLA_PUT_DATA
(
msg
, 
TCA_U32_SEL
, 
u
->
cu_£ËùÜ
);

334 ià(
u
->
cu_mask
 & 
U32_ATTR_ACTION
) {

335 
”r
;

337 
”r
 = 
	`¹Æ_aù_fl
(
msg
, 
TCA_U32_ACT
, 
u
->
cu_aù
);

338 ià(
”r
)

339  
”r
;

342 ià(
u
->
cu_mask
 & 
U32_ATTR_POLICE
)

343 
	`NLA_PUT_DATA
(
msg
, 
TCA_U32_POLICE
, 
u
->
cu_pŞiû
);

345 ià(
u
->
cu_mask
 & 
U32_ATTR_INDEV
)

346 
	`NLA_PUT_STRING
(
msg
, 
TCA_U32_INDEV
, 
u
->
cu_šdev
);

350 
Æa_put_çu»
:

351  -
NLE_NOMEM
;

352 
	}
}

359 
	$¹Æ_u32_£t_hªdË
(
¹Æ_şs
 *
şs
, 
htid
, 
hash
,

360 
nodeid
)

362 
ušt32_t
 
hªdË
 = (
htid
 << 20è| (
hash
 << 12è| 
nodeid
;

364 
	`¹Æ_tc_£t_hªdË
((
¹Æ_tc
 *è
şs
, 
hªdË
 );

365 
	}
}

367 
	$¹Æ_u32_£t_şassid
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
şassid
)

369 
¹Æ_u32
 *
u
;

371 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

372  -
NLE_NOMEM
;

374 
u
->
cu_şassid
 = 
şassid
;

375 
u
->
cu_mask
 |ğ
U32_ATTR_CLASSID
;

378 
	}
}

380 
	$¹Æ_u32_£t_divisÜ
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
divisÜ
)

382 
¹Æ_u32
 *
u
;

384 ià(!(
u
 = (
¹Æ_u32
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

385  -
NLE_NOMEM
;

387 
u
->
cu_divisÜ
 = 
divisÜ
;

388 
u
->
cu_mask
 |ğ
U32_ATTR_DIVISOR
;

390 
	}
}

392 
	$¹Æ_u32_£t_lšk
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
lšk
)

394 
¹Æ_u32
 *
u
;

396 ià(!(
u
 = (
¹Æ_u32
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

397  -
NLE_NOMEM
;

399 
u
->
cu_lšk
 = 
lšk
;

400 
u
->
cu_mask
 |ğ
U32_ATTR_LINK
;

402 
	}
}

404 
	$¹Æ_u32_£t_hashbË
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
ht
)

406 
¹Æ_u32
 *
u
;

408 ià(!(
u
 = (
¹Æ_u32
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

409  -
NLE_NOMEM
;

411 
u
->
cu_hash
 = 
ht
;

412 
u
->
cu_mask
 |ğ
U32_ATTR_HASH
;

414 
	}
}

416 
	$¹Æ_u32_£t_hashmask
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
hashmask
, ušt32_ˆ
off£t
)

418 
¹Æ_u32
 *
u
;

419 
tc_u32_£l
 *
£l
;

420 
”r
;

422 
hashmask
 = 
	`htÚl
(hashmask);

424 ià(!(
u
 = (
¹Æ_u32
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

425  -
NLE_NOMEM
;

427 
£l
 = 
	`u32_£ËùÜ_®loc
(
u
);

428 ià(!
£l
)

429  -
NLE_NOMEM
;

431 
”r
 = 
	`Æ_d©a_­³nd
(
u
->
cu_£ËùÜ
, 
NULL
, (
tc_u32_key
));

432 if(
”r
 < 0)

433  
”r
;

435 
£l
 = 
	`u32_£ËùÜ
(
u
);

437 
£l
->
hmask
 = 
hashmask
;

438 
£l
->
hoff
 = 
off£t
;

440 
	}
}

442 
	$¹Æ_u32_£t_şs_‹rmš®
(
¹Æ_şs
 *
şs
)

444 
¹Æ_u32
 *
u
;

445 
tc_u32_£l
 *
£l
;

446 
”r
;

448 ià(!(
u
 = (
¹Æ_u32
 *è
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

449  -
NLE_NOMEM
;

451 
£l
 = 
	`u32_£ËùÜ_®loc
(
u
);

452 ià(!
£l
)

453  -
NLE_NOMEM
;

455 
”r
 = 
	`Æ_d©a_­³nd
(
u
->
cu_£ËùÜ
, 
NULL
, (
tc_u32_key
));

456 if(
”r
 < 0)

457  
”r
;

459 
£l
 = 
	`u32_£ËùÜ
(
u
);

461 
£l
->
æags
 |ğ
TC_U32_TERMINAL
;

463 
	}
}

465 
	$¹Æ_u32_add_aùiÚ
(
¹Æ_şs
 *
şs
, 
¹Æ_aù
 *
aù
)

467 
¹Æ_u32
 *
u
;

469 ià(!
aù
)

472 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

473  -
NLE_NOMEM
;

475 
u
->
cu_mask
 |ğ
U32_ATTR_ACTION
;

477 
	`¹Æ_aù_g‘
(
aù
);

478  
	`¹Æ_aù_­³nd
(&
u
->
cu_aù
, 
aù
);

479 
	}
}

481 
	$¹Æ_u32_d–_aùiÚ
(
¹Æ_şs
 *
şs
, 
¹Æ_aù
 *
aù
)

483 
¹Æ_u32
 *
u
;

484 
»t
;

486 ià(!
aù
)

489 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

490  -
NLE_NOMEM
;

492 ià(!(
u
->
cu_mask
 & 
U32_ATTR_ACTION
))

493  -
NLE_INVAL
;

495 
»t
 = 
	`¹Æ_aù_»move
(&
u
->
cu_aù
, 
aù
);

496 ià(
»t
)

497  
»t
;

499 ià(!
u
->
cu_aù
)

500 
u
->
cu_mask
 &ğ~
U32_ATTR_ACTION
;

501 
	`¹Æ_aù_put
(
aù
);

503 
	}
}

511 
	$¹Æ_u32_£t_æags
(
¹Æ_şs
 *
şs
, 
æags
)

513 
tc_u32_£l
 *
£l
;

514 
¹Æ_u32
 *
u
;

516 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

517  -
NLE_NOMEM
;

519 
£l
 = 
	`u32_£ËùÜ_®loc
(
u
);

520 ià(!
£l
)

521  -
NLE_NOMEM
;

523 
£l
->
æags
 |= flags;

524 
u
->
cu_mask
 |ğ
U32_ATTR_SELECTOR
;

527 
	}
}

543 
	$¹Æ_u32_add_key
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
v®
, ušt32_ˆ
mask
,

544 
off
, 
offmask
)

546 
tc_u32_£l
 *
£l
;

547 
¹Æ_u32
 *
u
;

548 
”r
;

550 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

551  -
NLE_NOMEM
;

553 
£l
 = 
	`u32_£ËùÜ_®loc
(
u
);

554 ià(!
£l
)

555  -
NLE_NOMEM
;

557 
”r
 = 
	`Æ_d©a_­³nd
(
u
->
cu_£ËùÜ
, 
NULL
, (
tc_u32_key
));

558 ià(
”r
 < 0)

559  
”r
;

562 
£l
 = 
	`u32_£ËùÜ
(
u
);

564 
£l
->
keys
[£l->
nkeys
].
mask
 = mask;

565 
£l
->
keys
[£l->
nkeys
].
v®
 = v® & 
mask
;

566 
£l
->
keys
[£l->
nkeys
].
off
 = off;

567 
£l
->
keys
[£l->
nkeys
].
offmask
 = offmask;

568 
£l
->
nkeys
++;

569 
u
->
cu_mask
 |ğ
U32_ATTR_SELECTOR
;

572 
	}
}

585 
	$¹Æ_u32_g‘_key
(
¹Æ_şs
 *
şs
, 
ušt8_t
 
šdex
,

586 
ušt32_t
 *
v®
, ušt32_ˆ*
mask
, *
off
, *
offmask
)

588 
tc_u32_£l
 *
£l
;

589 
¹Æ_u32
 *
u
;

591 ià(!(
u
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şs
))))

592  -
NLE_NOMEM
;

594 ià(!(
u
->
cu_mask
 & 
U32_ATTR_SELECTOR
))

595  -
NLE_INVAL
;

598 
£l
 = 
	`u32_£ËùÜ
(
u
);

599 ià(
šdex
 >ğ
£l
->
nkeys
)

600  -
NLE_RANGE
;

602 *
mask
 = 
£l
->
keys
[
šdex
].mask;

603 *
v®
 = 
£l
->
keys
[
šdex
].val;

604 *
off
 = 
£l
->
keys
[
šdex
].off;

605 *
offmask
 = 
£l
->
keys
[
šdex
].offmask;

607 
	}
}

610 
	$¹Æ_u32_add_key_ušt8
(
¹Æ_şs
 *
şs
, 
ušt8_t
 
v®
, ušt8_ˆ
mask
,

611 
off
, 
offmask
)

613 
shiá
 = 24 - 8 * (
off
 & 3);

615  
	`¹Æ_u32_add_key
(
şs
, 
	`htÚl
((
ušt32_t
)
v®
 << 
shiá
),

616 
	`htÚl
((
ušt32_t
)
mask
 << 
shiá
),

617 
off
 & ~3, 
offmask
);

618 
	}
}

629 
	$¹Æ_u32_add_key_ušt16
(
¹Æ_şs
 *
şs
, 
ušt16_t
 
v®
, ušt16_ˆ
mask
,

630 
off
, 
offmask
)

632 
shiá
 = ((
off
 & 3) == 0 ? 16 : 0);

633 ià(
off
 % 2)

634  -
NLE_INVAL
;

636  
	`¹Æ_u32_add_key
(
şs
, 
	`htÚl
((
ušt32_t
)
v®
 << 
shiá
),

637 
	`htÚl
((
ušt32_t
)
mask
 << 
shiá
),

638 
off
 & ~3, 
offmask
);

639 
	}
}

650 
	$¹Æ_u32_add_key_ušt32
(
¹Æ_şs
 *
şs
, 
ušt32_t
 
v®
, ušt32_ˆ
mask
,

651 
off
, 
offmask
)

653  
	`¹Æ_u32_add_key
(
şs
, 
	`htÚl
(
v®
), htÚl(
mask
),

654 
off
 & ~3, 
offmask
);

655 
	}
}

657 
	$¹Æ_u32_add_key_š_addr
(
¹Æ_şs
 *
şs
, cÚ¡ 
š_addr
 *
addr
,

658 
ušt8_t
 
b™mask
, 
off
, 
offmask
)

660 
ušt32_t
 
mask
 = 0xFFFFFFFF << (32 - 
b™mask
);

661  
	`¹Æ_u32_add_key
(
şs
, 
addr
->
s_addr
, 
	`htÚl
(
mask
), 
off
, 
offmask
);

662 
	}
}

664 
	$¹Æ_u32_add_key_š6_addr
(
¹Æ_şs
 *
şs
, cÚ¡ 
š6_addr
 *
addr
,

665 
ušt8_t
 
b™mask
, 
off
, 
offmask
)

667 
i
, 
”r
;

669 
i
 = 1; i <= 4; i++) {

670 ià(32 * 
i
 - 
b™mask
 <= 0) {

671 ià((
”r
 = 
	`¹Æ_u32_add_key
(
şs
, 
addr
->
s6_addr32
[
i
-1],

672 0xFFFFFFFF, 
off
+4*(
i
-1), 
offmask
)) < 0)

673  
”r
;

675 ià(32 * 
i
 - 
b™mask
 < 32) {

676 
ušt32_t
 
mask
 = 0xFFFFFFFF << (32 * 
i
 - 
b™mask
);

677 ià((
”r
 = 
	`¹Æ_u32_add_key
(
şs
, 
addr
->
s6_addr32
[
i
-1],

678 
	`htÚl
(
mask
), 
off
+4*(
i
-1), 
offmask
)) < 0)

679  
”r
;

685 
	}
}

689 
¹Æ_tc_İs
 
	gu32_İs
 = {

690 .
to_kšd
 = "u32",

691 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLS
,

692 .
	gto_size
 = (
¹Æ_u32
),

693 .
	gto_msg_·r£r
 = 
u32_msg_·r£r
,

694 .
	gto_ä“_d©a
 = 
u32_ä“_d©a
,

695 .
	gto_şÚe
 = 
u32_şÚe
,

696 .
	gto_msg_fl
 = 
u32_msg_fl
,

697 .
	gto_dump
 = {

698 [
NL_DUMP_LINE
] = 
u32_dump_lše
,

699 [
NL_DUMP_DETAILS
] = 
u32_dump_d‘as
,

700 [
NL_DUMP_STATS
] = 
u32_dump_¡©s
,

704 
__š™
 
	$u32_š™
()

706 
	`¹Æ_tc_»gi¡”
(&
u32_İs
);

707 
	}
}

709 
__ex™
 
	$u32_ex™
()

711 
	`¹Æ_tc_uÄegi¡”
(&
u32_İs
);

712 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link.c

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk/Ãšk.h
>

23 
	~<Ãšk/©Œ.h
>

24 
	~<Ãšk/uts.h
>

25 
	~<Ãšk/objeù.h
>

26 
	~<Ãšk/hashbË.h
>

27 
	~<Ãšk/d©a.h
>

28 
	~<Ãšk/rou‹/¹Æ.h
>

29 
	~<Ãšk/rou‹/lšk.h
>

30 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

33 
	#LINK_ATTR_MTU
 (1 << 0)

	)

34 
	#LINK_ATTR_LINK
 (1 << 1)

	)

35 
	#LINK_ATTR_TXQLEN
 (1 << 2)

	)

36 
	#LINK_ATTR_WEIGHT
 (1 << 3)

	)

37 
	#LINK_ATTR_MASTER
 (1 << 4)

	)

38 
	#LINK_ATTR_QDISC
 (1 << 5)

	)

39 
	#LINK_ATTR_MAP
 (1 << 6)

	)

40 
	#LINK_ATTR_ADDR
 (1 << 7)

	)

41 
	#LINK_ATTR_BRD
 (1 << 8)

	)

42 
	#LINK_ATTR_FLAGS
 (1 << 9)

	)

43 
	#LINK_ATTR_IFNAME
 (1 << 10)

	)

44 
	#LINK_ATTR_IFINDEX
 (1 << 11)

	)

45 
	#LINK_ATTR_FAMILY
 (1 << 12)

	)

46 
	#LINK_ATTR_ARPTYPE
 (1 << 13)

	)

47 
	#LINK_ATTR_STATS
 (1 << 14)

	)

48 
	#LINK_ATTR_CHANGE
 (1 << 15)

	)

49 
	#LINK_ATTR_OPERSTATE
 (1 << 16)

	)

50 
	#LINK_ATTR_LINKMODE
 (1 << 17)

	)

51 
	#LINK_ATTR_LINKINFO
 (1 << 18)

	)

52 
	#LINK_ATTR_IFALIAS
 (1 << 19)

	)

53 
	#LINK_ATTR_NUM_VF
 (1 << 20)

	)

54 
	#LINK_ATTR_PROMISCUITY
 (1 << 21)

	)

55 
	#LINK_ATTR_NUM_TX_QUEUES
 (1 << 22)

	)

56 
	#LINK_ATTR_NUM_RX_QUEUES
 (1 << 23)

	)

57 
	#LINK_ATTR_GROUP
 (1 << 24)

	)

58 
	#LINK_ATTR_CARRIER
 (1 << 25)

	)

59 
	#LINK_ATTR_PROTINFO
 (1 << 26)

	)

60 
	#LINK_ATTR_AF_SPEC
 (1 << 27)

	)

61 
	#LINK_ATTR_PHYS_PORT_ID
 (1 << 28)

	)

62 
	#LINK_ATTR_NS_FD
 (1 << 29)

	)

63 
	#LINK_ATTR_NS_PID
 (1 << 30)

	)

65 
Æ_ÿche_İs
 
	g¹Æ_lšk_İs
;

66 
Æ_objeù_İs
 
	glšk_obj_İs
;

69 
¹Æ_lšk_af_İs
 *
	$af_lookup_ªd_®loc
(
¹Æ_lšk
 *
lšk
,

70 
çmy
)

72 
¹Æ_lšk_af_İs
 *
af_İs
;

73 *
d©a
;

75 
af_İs
 = 
	`¹Æ_lšk_af_İs_lookup
(
çmy
);

76 ià(!
af_İs
)

77  
NULL
;

79 ià(!(
d©a
 = 
	`¹Æ_lšk_af_®loc
(
lšk
, 
af_İs
))) {

80 
	`¹Æ_lšk_af_İs_put
(
af_İs
);

81  
NULL
;

84  
af_İs
;

85 
	}
}

87 
	$af_ä“
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

88 *
d©a
, *
¬g
)

90 ià(
İs
->
ao_ä“
)

91 
İs
->
	`ao_ä“
(
lšk
, 
d©a
);

93 
	`¹Æ_lšk_af_İs_put
(
İs
);

96 
	}
}

98 
	$af_şÚe
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

99 *
d©a
, *
¬g
)

101 
¹Æ_lšk
 *
d¡
 = 
¬g
;

103 ià(
İs
->
ao_şÚe
 &&

104 !(
d¡
->
l_af_d©a
[
İs
->
ao_çmy
] = ops->
	`ao_şÚe
(d¡, 
d©a
)))

105  -
NLE_NOMEM
;

108 
	}
}

110 
	$af_fl
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

111 *
d©a
, *
¬g
)

113 
Æ_msg
 *
msg
 = 
¬g
;

114 
Æ©Œ
 *
af_©Œ
;

115 
”r
;

117 ià(!
İs
->
ao_fl_af
)

120 ià(!(
af_©Œ
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
İs
->
ao_çmy
)))

121  -
NLE_MSGSIZE
;

123 ià((
”r
 = 
İs
->
	`ao_fl_af
(
lšk
, 
¬g
, 
d©a
)) < 0)

124  
”r
;

126 
	`Æa_Ã¡_’d
(
msg
, 
af_©Œ
);

129 
	}
}

131 
	$af_dump_lše
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

132 *
d©a
, *
¬g
)

134 
Æ_dump_·¿ms
 *
p
 = 
¬g
;

136 ià(
İs
->
ao_dump
[
NL_DUMP_LINE
])

137 
İs
->
ao_dump
[
NL_DUMP_LINE
](
lšk
, 
p
, 
d©a
);

140 
	}
}

142 
	$af_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

143 *
d©a
, *
¬g
)

145 
Æ_dump_·¿ms
 *
p
 = 
¬g
;

147 ià(
İs
->
ao_dump
[
NL_DUMP_DETAILS
])

148 
İs
->
ao_dump
[
NL_DUMP_DETAILS
](
lšk
, 
p
, 
d©a
);

151 
	}
}

153 
	$af_dump_¡©s
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_af_İs
 *
İs
,

154 *
d©a
, *
¬g
)

156 
Æ_dump_·¿ms
 *
p
 = 
¬g
;

158 ià(
İs
->
ao_dump
[
NL_DUMP_STATS
])

159 
İs
->
ao_dump
[
NL_DUMP_STATS
](
lšk
, 
p
, 
d©a
);

162 
	}
}

164 
do_fÜ—ch_af
(
¹Æ_lšk
 *
lšk
,

165 (*
cb
)(
¹Æ_lšk
 *,

166 
¹Æ_lšk_af_İs
 *, *, *),

167 *
¬g
)

169 
i
, 
”r
;

171 
i
 = 0; i < 
AF_MAX
; i++) {

172 ià(
lšk
->
l_af_d©a
[
i
]) {

173 
¹Æ_lšk_af_İs
 *
İs
;

175 ià(!(
İs
 = 
	`¹Æ_lšk_af_İs_lookup
(
i
)))

176 
	`BUG
();

178 
”r
 = 
	`cb
(
lšk
, 
İs
,†šk->
l_af_d©a
[
i
], 
¬g
);

180 
	`¹Æ_lšk_af_İs_put
(
İs
);

182 ià(
”r
 < 0)

183  
”r
;

188 
	}
}

190 
	$»Ëa£_lšk_šfo
(
¹Æ_lšk
 *
lšk
)

192 
¹Æ_lšk_šfo_İs
 *
io
 = 
lšk
->
l_šfo_İs
;

194 ià(
io
 !ğ
NULL
) {

195 ià(
io
->
io_ä“
)

196 
io
->
	`io_ä“
(
lšk
);

199 
	`BUG_ON
(
lšk
->
l_šfo
);

201 
	`¹Æ_lšk_šfo_İs_put
(
io
);

202 
lšk
->
l_šfo_İs
 = 
NULL
;

204 
	}
}

206 
	$lšk_ä“_d©a
(
Æ_objeù
 *
c
)

208 
¹Æ_lšk
 *
lšk
 = 
	`Æ_objeù_´iv
(
c
);

210 ià(
lšk
) {

211 
¹Æ_lšk_šfo_İs
 *
io
;

213 ià((
io
 = 
lšk
->
l_šfo_İs
è!ğ
NULL
)

214 
	`»Ëa£_lšk_šfo
(
lšk
);

217 
	`¹Æ_lšk_af_İs_put
(
lšk
->
l_af_İs
);

219 
	`Æ_addr_put
(
lšk
->
l_addr
);

220 
	`Æ_addr_put
(
lšk
->
l_bÿ¡
);

222 
	`ä“
(
lšk
->
l_içlŸs
);

223 
	`ä“
(
lšk
->
l_šfo_kšd
);

225 
	`do_fÜ—ch_af
(
lšk
, 
af_ä“
, 
NULL
);

227 
	`Æ_d©a_ä“
(
lšk
->
l_phys_pÜt_id
);

229 
	}
}

231 
	$lšk_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

233 
¹Æ_lšk
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

234 
¹Æ_lšk
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

235 
”r
;

237 ià(
¤c
->
l_addr
)

238 ià(!(
d¡
->
l_addr
 = 
	`Æ_addr_şÚe
(
¤c
->l_addr)))

239  -
NLE_NOMEM
;

241 ià(
¤c
->
l_bÿ¡
)

242 ià(!(
d¡
->
l_bÿ¡
 = 
	`Æ_addr_şÚe
(
¤c
->l_bcast)))

243  -
NLE_NOMEM
;

245 ià(
¤c
->
l_içlŸs
)

246 ià(!(
d¡
->
l_içlŸs
 = 
	`¡rdup
(
¤c
->l_ifalias)))

247  -
NLE_NOMEM
;

249 ià(
¤c
->
l_šfo_kšd
)

250 ià(!(
d¡
->
l_šfo_kšd
 = 
	`¡rdup
(
¤c
->l_info_kind)))

251  -
NLE_NOMEM
;

253 ià(
¤c
->
l_šfo_İs
 && src->l_šfo_İs->
io_şÚe
) {

254 
”r
 = 
¤c
->
l_šfo_İs
->
	`io_şÚe
(
d¡
, src);

255 ià(
”r
 < 0)

256  
”r
;

259 ià((
”r
 = 
	`do_fÜ—ch_af
(
¤c
, 
af_şÚe
, 
d¡
)) < 0)

260  
”r
;

262 ià(
¤c
->
l_phys_pÜt_id
)

263 ià(!(
d¡
->
l_phys_pÜt_id
 = 
	`Æ_d©a_şÚe
(
¤c
->l_phys_port_id)))

264  -
NLE_NOMEM
;

267 
	}
}

269 
Æa_pŞicy
 
	g¹Ê_lšk_pŞicy
[
IFLA_MAX
+1] = {

270 [
IFLA_IFNAME
] = { .
ty³
 = 
NLA_STRING
,

271 .
	gmaxËn
 = 
IFNAMSIZ
 },

272 [
IFLA_MTU
] = { .
ty³
 = 
NLA_U32
 },

273 [
IFLA_TXQLEN
] = { .
ty³
 = 
NLA_U32
 },

274 [
IFLA_LINK
] = { .
ty³
 = 
NLA_U32
 },

275 [
IFLA_WEIGHT
] = { .
ty³
 = 
NLA_U32
 },

276 [
IFLA_MASTER
] = { .
ty³
 = 
NLA_U32
 },

277 [
IFLA_OPERSTATE
] = { .
ty³
 = 
NLA_U8
 },

278 [
IFLA_LINKMODE
] = { .
ty³
 = 
NLA_U8
 },

279 [
IFLA_LINKINFO
] = { .
ty³
 = 
NLA_NESTED
 },

280 [
IFLA_QDISC
] = { .
ty³
 = 
NLA_STRING
,

281 .
	gmaxËn
 = 
IFQDISCSIZ
 },

282 [
IFLA_STATS
] = { .
mšËn
 = (
¹Æ_lšk_¡©s
) },

283 [
IFLA_STATS64
] = { .
mšËn
 = (
¹Æ_lšk_¡©s64
)},

284 [
IFLA_MAP
] = { .
mšËn
 = (
¹Æ_lšk_ifm­
) },

285 [
IFLA_IFALIAS
] = { .
ty³
 = 
NLA_STRING
, .
	gmaxËn
 = 
IFALIASZ
 },

286 [
IFLA_NUM_VF
] = { .
ty³
 = 
NLA_U32
 },

287 [
IFLA_AF_SPEC
] = { .
ty³
 = 
NLA_NESTED
 },

288 [
IFLA_PROMISCUITY
] = { .
ty³
 = 
NLA_U32
 },

289 [
IFLA_NUM_TX_QUEUES
] = { .
ty³
 = 
NLA_U32
 },

290 [
IFLA_NUM_RX_QUEUES
] = { .
ty³
 = 
NLA_U32
 },

291 [
IFLA_GROUP
] = { .
ty³
 = 
NLA_U32
 },

292 [
IFLA_CARRIER
] = { .
ty³
 = 
NLA_U8
 },

293 [
IFLA_PHYS_PORT_ID
] = { .
ty³
 = 
NLA_UNSPEC
 },

294 [
IFLA_NET_NS_PID
] = { .
ty³
 = 
NLA_U32
 },

295 [
IFLA_NET_NS_FD
] = { .
ty³
 = 
NLA_U32
 },

298 
Æa_pŞicy
 
	glšk_šfo_pŞicy
[
IFLA_INFO_MAX
+1] = {

299 [
IFLA_INFO_KIND
] = { .
ty³
 = 
NLA_STRING
 },

300 [
IFLA_INFO_DATA
] = { .
ty³
 = 
NLA_NESTED
 },

301 [
IFLA_INFO_XSTATS
] = { .
ty³
 = 
NLA_NESTED
 },

304 
	$¹Æ_lšk_šfo_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 **
tb
)

306 ià(
tb
[
IFLA_IFNAME
] =ğ
NULL
)

307  -
NLE_MISSING_ATTR
;

309 
	`Æa_¡¾ıy
(
lšk
->
l_Çme
, 
tb
[
IFLA_IFNAME
], 
IFNAMSIZ
);

312 ià(
tb
[
IFLA_STATS
]) {

313 
¹Æ_lšk_¡©s
 *
¡
 = 
	`Æa_d©a
(
tb
[
IFLA_STATS
]);

315 
lšk
->
l_¡©s
[
RTNL_LINK_RX_PACKETS
] = 
¡
->
rx_·ck‘s
;

316 
lšk
->
l_¡©s
[
RTNL_LINK_TX_PACKETS
] = 
¡
->
tx_·ck‘s
;

317 
lšk
->
l_¡©s
[
RTNL_LINK_RX_BYTES
] = 
¡
->
rx_by‹s
;

318 
lšk
->
l_¡©s
[
RTNL_LINK_TX_BYTES
] = 
¡
->
tx_by‹s
;

319 
lšk
->
l_¡©s
[
RTNL_LINK_RX_ERRORS
] = 
¡
->
rx_”rÜs
;

320 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ERRORS
] = 
¡
->
tx_”rÜs
;

321 
lšk
->
l_¡©s
[
RTNL_LINK_RX_DROPPED
] = 
¡
->
rx_drİ³d
;

322 
lšk
->
l_¡©s
[
RTNL_LINK_TX_DROPPED
] = 
¡
->
tx_drİ³d
;

323 
lšk
->
l_¡©s
[
RTNL_LINK_MULTICAST
] = 
¡
->
muÉiÿ¡
;

324 
lšk
->
l_¡©s
[
RTNL_LINK_COLLISIONS
] = 
¡
->
cŞlisiÚs
;

326 
lšk
->
l_¡©s
[
RTNL_LINK_RX_LEN_ERR
] = 
¡
->
rx_Ëngth_”rÜs
;

327 
lšk
->
l_¡©s
[
RTNL_LINK_RX_OVER_ERR
] = 
¡
->
rx_ov”_”rÜs
;

328 
lšk
->
l_¡©s
[
RTNL_LINK_RX_CRC_ERR
] = 
¡
->
rx_üc_”rÜs
;

329 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FRAME_ERR
] = 
¡
->
rx_äame_”rÜs
;

330 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FIFO_ERR
] = 
¡
->
rx_fifo_”rÜs
;

331 
lšk
->
l_¡©s
[
RTNL_LINK_RX_MISSED_ERR
] = 
¡
->
rx_mis£d_”rÜs
;

333 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ABORT_ERR
] = 
¡
->
tx_abÜ‹d_”rÜs
;

334 
lšk
->
l_¡©s
[
RTNL_LINK_TX_CARRIER_ERR
] = 
¡
->
tx_ÿ¼›r_”rÜs
;

335 
lšk
->
l_¡©s
[
RTNL_LINK_TX_FIFO_ERR
] = 
¡
->
tx_fifo_”rÜs
;

336 
lšk
->
l_¡©s
[
RTNL_LINK_TX_HBEAT_ERR
] = 
¡
->
tx_h—¹b—t_”rÜs
;

337 
lšk
->
l_¡©s
[
RTNL_LINK_TX_WIN_ERR
] = 
¡
->
tx_wšdow_”rÜs
;

339 
lšk
->
l_¡©s
[
RTNL_LINK_RX_COMPRESSED
] = 
¡
->
rx_com´es£d
;

340 
lšk
->
l_¡©s
[
RTNL_LINK_TX_COMPRESSED
] = 
¡
->
tx_com´es£d
;

342 
lšk
->
û_mask
 |ğ
LINK_ATTR_STATS
;

345 ià(
tb
[
IFLA_STATS64
]) {

353 
¹Æ_lšk_¡©s64
 
¡
;

355 
	`Æa_memıy
(&
¡
, 
tb
[
IFLA_STATS64
],

356 (
¹Æ_lšk_¡©s64
));

358 
lšk
->
l_¡©s
[
RTNL_LINK_RX_PACKETS
] = 
¡
.
rx_·ck‘s
;

359 
lšk
->
l_¡©s
[
RTNL_LINK_TX_PACKETS
] = 
¡
.
tx_·ck‘s
;

360 
lšk
->
l_¡©s
[
RTNL_LINK_RX_BYTES
] = 
¡
.
rx_by‹s
;

361 
lšk
->
l_¡©s
[
RTNL_LINK_TX_BYTES
] = 
¡
.
tx_by‹s
;

362 
lšk
->
l_¡©s
[
RTNL_LINK_RX_ERRORS
] = 
¡
.
rx_”rÜs
;

363 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ERRORS
] = 
¡
.
tx_”rÜs
;

364 
lšk
->
l_¡©s
[
RTNL_LINK_RX_DROPPED
] = 
¡
.
rx_drİ³d
;

365 
lšk
->
l_¡©s
[
RTNL_LINK_TX_DROPPED
] = 
¡
.
tx_drİ³d
;

366 
lšk
->
l_¡©s
[
RTNL_LINK_MULTICAST
] = 
¡
.
muÉiÿ¡
;

367 
lšk
->
l_¡©s
[
RTNL_LINK_COLLISIONS
] = 
¡
.
cŞlisiÚs
;

369 
lšk
->
l_¡©s
[
RTNL_LINK_RX_LEN_ERR
] = 
¡
.
rx_Ëngth_”rÜs
;

370 
lšk
->
l_¡©s
[
RTNL_LINK_RX_OVER_ERR
] = 
¡
.
rx_ov”_”rÜs
;

371 
lšk
->
l_¡©s
[
RTNL_LINK_RX_CRC_ERR
] = 
¡
.
rx_üc_”rÜs
;

372 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FRAME_ERR
] = 
¡
.
rx_äame_”rÜs
;

373 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FIFO_ERR
] = 
¡
.
rx_fifo_”rÜs
;

374 
lšk
->
l_¡©s
[
RTNL_LINK_RX_MISSED_ERR
] = 
¡
.
rx_mis£d_”rÜs
;

376 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ABORT_ERR
] = 
¡
.
tx_abÜ‹d_”rÜs
;

377 
lšk
->
l_¡©s
[
RTNL_LINK_TX_CARRIER_ERR
] = 
¡
.
tx_ÿ¼›r_”rÜs
;

378 
lšk
->
l_¡©s
[
RTNL_LINK_TX_FIFO_ERR
] = 
¡
.
tx_fifo_”rÜs
;

379 
lšk
->
l_¡©s
[
RTNL_LINK_TX_HBEAT_ERR
] = 
¡
.
tx_h—¹b—t_”rÜs
;

380 
lšk
->
l_¡©s
[
RTNL_LINK_TX_WIN_ERR
] = 
¡
.
tx_wšdow_”rÜs
;

382 
lšk
->
l_¡©s
[
RTNL_LINK_RX_COMPRESSED
] = 
¡
.
rx_com´es£d
;

383 
lšk
->
l_¡©s
[
RTNL_LINK_TX_COMPRESSED
] = 
¡
.
tx_com´es£d
;

385 
lšk
->
û_mask
 |ğ
LINK_ATTR_STATS
;

388 ià(
tb
[
IFLA_TXQLEN
]) {

389 
lšk
->
l_txqËn
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_TXQLEN
]);

390 
lšk
->
û_mask
 |ğ
LINK_ATTR_TXQLEN
;

393 ià(
tb
[
IFLA_MTU
]) {

394 
lšk
->
l_mtu
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_MTU
]);

395 
lšk
->
û_mask
 |ğ
LINK_ATTR_MTU
;

398 ià(
tb
[
IFLA_ADDRESS
]) {

399 
lšk
->
l_addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFLA_ADDRESS
], 
AF_UNSPEC
);

400 ià(
lšk
->
l_addr
 =ğ
NULL
)

401  -
NLE_NOMEM
;

402 
	`Æ_addr_£t_çmy
(
lšk
->
l_addr
,

403 
	`Æ_addr_guess_çmy
(
lšk
->
l_addr
));

404 
lšk
->
û_mask
 |ğ
LINK_ATTR_ADDR
;

407 ià(
tb
[
IFLA_BROADCAST
]) {

408 
lšk
->
l_bÿ¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
IFLA_BROADCAST
],

409 
AF_UNSPEC
);

410 ià(
lšk
->
l_bÿ¡
 =ğ
NULL
)

411  -
NLE_NOMEM
;

412 
	`Æ_addr_£t_çmy
(
lšk
->
l_bÿ¡
,

413 
	`Æ_addr_guess_çmy
(
lšk
->
l_bÿ¡
));

414 
lšk
->
û_mask
 |ğ
LINK_ATTR_BRD
;

417 ià(
tb
[
IFLA_LINK
]) {

418 
lšk
->
l_lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_LINK
]);

419 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINK
;

422 ià(
tb
[
IFLA_WEIGHT
]) {

423 
lšk
->
l_weight
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_WEIGHT
]);

424 
lšk
->
û_mask
 |ğ
LINK_ATTR_WEIGHT
;

427 ià(
tb
[
IFLA_QDISC
]) {

428 
	`Æa_¡¾ıy
(
lšk
->
l_qdisc
, 
tb
[
IFLA_QDISC
], 
IFQDISCSIZ
);

429 
lšk
->
û_mask
 |ğ
LINK_ATTR_QDISC
;

432 ià(
tb
[
IFLA_MAP
]) {

433 
	`Æa_memıy
(&
lšk
->
l_m­
, 
tb
[
IFLA_MAP
],

434 (
¹Æ_lšk_ifm­
));

435 
lšk
->
û_mask
 |ğ
LINK_ATTR_MAP
;

438 ià(
tb
[
IFLA_MASTER
]) {

439 
lšk
->
l_ma¡”
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_MASTER
]);

440 
lšk
->
û_mask
 |ğ
LINK_ATTR_MASTER
;

443 ià(
tb
[
IFLA_CARRIER
]) {

444 
lšk
->
l_ÿ¼›r
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_CARRIER
]);

445 
lšk
->
û_mask
 |ğ
LINK_ATTR_CARRIER
;

448 ià(
tb
[
IFLA_OPERSTATE
]) {

449 
lšk
->
l_İ”¡©e
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_OPERSTATE
]);

450 
lšk
->
û_mask
 |ğ
LINK_ATTR_OPERSTATE
;

453 ià(
tb
[
IFLA_LINKMODE
]) {

454 
lšk
->
l_lškmode
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_LINKMODE
]);

455 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINKMODE
;

458 ià(
tb
[
IFLA_IFALIAS
]) {

459 
lšk
->
l_içlŸs
 = 
	`Æa_¡rdup
(
tb
[
IFLA_IFALIAS
]);

460 ià(
lšk
->
l_içlŸs
 =ğ
NULL
)

461  -
NLE_NOMEM
;

462 
lšk
->
û_mask
 |ğ
LINK_ATTR_IFALIAS
;

465 ià(
tb
[
IFLA_NET_NS_FD
]) {

466 
lšk
->
l_ns_fd
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_NET_NS_FD
]);

467 
lšk
->
û_mask
 |ğ
LINK_ATTR_NS_FD
;

470 ià(
tb
[
IFLA_NET_NS_PID
]) {

471 
lšk
->
l_ns_pid
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_NET_NS_PID
]);

472 
lšk
->
û_mask
 |ğ
LINK_ATTR_NS_PID
;

476 
	}
}

478 
	$lšk_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

479 
Æmsghdr
 *
n
, 
Æ_·r£r_·¿m
 *
µ
)

481 
¹Æ_lšk
 *
lšk
;

482 
ifšfomsg
 *
ifi
;

483 
Æ©Œ
 *
tb
[
IFLA_MAX
+1];

484 
¹Æ_lšk_af_İs
 *
af_İs
 = 
NULL
;

485 
”r
, 
çmy
;

486 
Æa_pŞicy
 
»®_lšk_pŞicy
[
IFLA_MAX
+1];

488 
	`memıy
(&
»®_lšk_pŞicy
, 
¹Ê_lšk_pŞicy
, (rtln_link_policy));

490 
lšk
 = 
	`¹Æ_lšk_®loc
();

491 ià(
lšk
 =ğ
NULL
) {

492 
”r
 = -
NLE_NOMEM
;

493 
”rout
;

496 
lšk
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

498 ià(!
	`Æmsg_v®id_hdr
(
n
, (*
ifi
)))

499  -
NLE_MSG_TOOSHORT
;

501 
ifi
 = 
	`Æmsg_d©a
(
n
);

502 
lšk
->
l_çmy
 = 
çmy
 = 
ifi
->
ifi_çmy
;

503 
lšk
->
l_¬±y³
 = 
ifi
->
ifi_ty³
;

504 
lšk
->
l_šdex
 = 
ifi
->
ifi_šdex
;

505 
lšk
->
l_æags
 = 
ifi
->
ifi_æags
;

506 
lšk
->
l_chªge
 = 
ifi
->
ifi_chªge
;

507 
lšk
->
û_mask
 = (
LINK_ATTR_IFNAME
 | 
LINK_ATTR_FAMILY
 |

508 
LINK_ATTR_ARPTYPE
| 
LINK_ATTR_IFINDEX
 |

509 
LINK_ATTR_FLAGS
 | 
LINK_ATTR_CHANGE
);

511 ià((
af_İs
 = 
	`af_lookup_ªd_®loc
(
lšk
, 
çmy
))) {

512 ià(
af_İs
->
ao_´Ùšfo_pŞicy
) {

513 
	`memıy
(&
»®_lšk_pŞicy
[
IFLA_PROTINFO
],

514 
af_İs
->
ao_´Ùšfo_pŞicy
,

515 (
Æa_pŞicy
));

518 
lšk
->
l_af_İs
 = 
af_İs
;

521 
”r
 = 
	`Æmsg_·r£
(
n
, (*
ifi
), 
tb
, 
IFLA_MAX
, 
»®_lšk_pŞicy
);

522 ià(
”r
 < 0)

523  
”r
;

525 
”r
 = 
	`¹Æ_lšk_šfo_·r£
(
lšk
, 
tb
);

526 ià(
”r
 < 0)

527  
”r
;

529 ià(
tb
[
IFLA_NUM_VF
]) {

530 
lšk
->
l_num_vf
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_NUM_VF
]);

531 
lšk
->
û_mask
 |ğ
LINK_ATTR_NUM_VF
;

534 ià(
tb
[
IFLA_LINKINFO
]) {

535 
Æ©Œ
 *
li
[
IFLA_INFO_MAX
+1];

537 
”r
 = 
	`Æa_·r£_Ã¡ed
(
li
, 
IFLA_INFO_MAX
, 
tb
[
IFLA_LINKINFO
],

538 
lšk_šfo_pŞicy
);

539 ià(
”r
 < 0)

540 
”rout
;

542 ià(
li
[
IFLA_INFO_KIND
]) {

543 
¹Æ_lšk_šfo_İs
 *
İs
;

544 *
kšd
 = 
	`Æa_g‘_¡ršg
(
li
[
IFLA_INFO_KIND
]);

545 
af
;

547 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, 
kšd
);

548 ià(
”r
 < 0)

549 
”rout
;

551 ià((
af
 = 
	`Æ_¡r2af
(
kšd
)) >= 0 &&

552 !
af_İs
 && (af_İ ğ
	`af_lookup_ªd_®loc
(
lšk
, 
af
))) {

554 ià(
af_İs
->
ao_´Ùšfo_pŞicy
) {

555 
tb
[
IFLA_PROTINFO
] = (
Æ©Œ
 *)
af_İs
->
ao_´Ùšfo_pŞicy
;

557 
lšk
->
l_çmy
 = 
çmy
 = 
af
;

558 
lšk
->
l_af_İs
 = 
af_İs
;

561 
İs
 = 
	`¹Æ_lšk_šfo_İs_lookup
(
kšd
);

562 
lšk
->
l_šfo_İs
 = 
İs
;

564 ià(
İs
) {

565 ià(
İs
->
io_·r£
 &&

566 (
li
[
IFLA_INFO_DATA
] ||†i[
IFLA_INFO_XSTATS
])) {

567 
”r
 = 
İs
->
	`io_·r£
(
lšk
, 
li
[
IFLA_INFO_DATA
],

568 
li
[
IFLA_INFO_XSTATS
]);

569 ià(
”r
 < 0)

570 
”rout
;

576 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINKINFO
;

579 ià(
tb
[
IFLA_PROTINFO
] && 
af_İs
 &&‡f_İs->
ao_·r£_´Ùšfo
) {

580 
”r
 = 
af_İs
->
	`ao_·r£_´Ùšfo
(
lšk
, 
tb
[
IFLA_PROTINFO
],

581 
lšk
->
l_af_d©a
[lšk->
l_çmy
]);

582 ià(
”r
 < 0)

583 
”rout
;

584 
lšk
->
û_mask
 |ğ
LINK_ATTR_PROTINFO
;

587 ià(
tb
[
IFLA_AF_SPEC
]) {

588 
Æ©Œ
 *
af_©Œ
;

589 
»maššg
;

591 
	`Æa_fÜ_—ch_Ã¡ed
(
af_©Œ
, 
tb
[
IFLA_AF_SPEC
], 
»maššg
) {

592 
af_İs
 = 
	`af_lookup_ªd_®loc
(
lšk
, 
	`Æa_ty³
(
af_©Œ
));

593 ià(
af_İs
 &&‡f_İs->
ao_·r£_af
) {

594 *
af_d©a
 = 
lšk
->
l_af_d©a
[
	`Æa_ty³
(
af_©Œ
)];

596 
”r
 = 
af_İs
->
	`ao_·r£_af
(
lšk
, 
af_©Œ
, 
af_d©a
);

597 ià(
”r
 < 0)

598 
”rout
;

602 
lšk
->
û_mask
 |ğ
LINK_ATTR_AF_SPEC
;

605 ià(
tb
[
IFLA_PROMISCUITY
]) {

606 
lšk
->
l_´omiscu™y
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_PROMISCUITY
]);

607 
lšk
->
û_mask
 |ğ
LINK_ATTR_PROMISCUITY
;

610 ià(
tb
[
IFLA_NUM_TX_QUEUES
]) {

611 
lšk
->
l_num_tx_queues
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_NUM_TX_QUEUES
]);

612 
lšk
->
û_mask
 |ğ
LINK_ATTR_NUM_TX_QUEUES
;

615 ià(
tb
[
IFLA_NUM_RX_QUEUES
]) {

616 
lšk
->
l_num_rx_queues
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_NUM_RX_QUEUES
]);

617 
lšk
->
û_mask
 |ğ
LINK_ATTR_NUM_RX_QUEUES
;

620 ià(
tb
[
IFLA_GROUP
]) {

621 
lšk
->
l_group
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GROUP
]);

622 
lšk
->
û_mask
 |ğ
LINK_ATTR_GROUP
;

625 ià(
tb
[
IFLA_PHYS_PORT_ID
]) {

626 
lšk
->
l_phys_pÜt_id
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
IFLA_PHYS_PORT_ID
]);

627 ià(
lšk
->
l_phys_pÜt_id
 =ğ
NULL
) {

628 
”r
 = -
NLE_NOMEM
;

629 
”rout
;

631 
lšk
->
û_mask
 |ğ
LINK_ATTR_PHYS_PORT_ID
;

634 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
lšk
,…p);

635 
”rout
:

636 
	`¹Æ_lšk_af_İs_put
(
af_İs
);

637 
	`¹Æ_lšk_put
(
lšk
);

638  
”r
;

639 
	}
}

641 
	$lšk_»que¡_upd©e
(
Æ_ÿche
 *
ÿche
, 
Æ_sock
 *
sk
)

643 
çmy
 = 
ÿche
->
c_Ÿrg1
;

645  
	`Æ_¹g’_»que¡
(
sk
, 
RTM_GETLINK
, 
çmy
, 
NLM_F_DUMP
);

646 
	}
}

648 
	$lšk_dump_lše
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

650 
buf
[128];

651 
Æ_ÿche
 *
ÿche
 = 
obj
->
û_ÿche
;

652 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

653 
ãtched_ÿche
 = 0;

655 ià(!
ÿche
) {

656 
ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

657 
ãtched_ÿche
 = 1;

660 
	`Æ_dump_lše
(
p
, "% % ", 
lšk
->
l_Çme
,

661 
	`Æ_Î´Ùo2¡r
(
lšk
->
l_¬±y³
, 
buf
, (buf)));

663 ià(
lšk
->
l_addr
 && !
	`Æ_addr_isz”o
(link->l_addr))

664 
	`Æ_dump
(
p
, "% ", 
	`Æ_addr2¡r
(
lšk
->
l_addr
, 
buf
, (buf)));

666 ià(
lšk
->
û_mask
 & 
LINK_ATTR_MASTER
) {

667 ià(
ÿche
) {

668 
¹Æ_lšk
 *
ma¡”
 = 
	`¹Æ_lšk_g‘
(
ÿche
, 
lšk
->
l_ma¡”
);

669 
	`Æ_dump
(
p
, "ma¡” % ", 
ma¡”
 ? ma¡”->
l_Çme
 : "inv");

670 ià(
ma¡”
)

671 
	`¹Æ_lšk_put
(
ma¡”
);

673 
	`Æ_dump
(
p
, "ma¡” %d ", 
lšk
->
l_ma¡”
);

676 
	`¹Æ_lšk_æags2¡r
(
lšk
->
l_æags
, 
buf
, (buf));

677 ià(
buf
[0])

678 
	`Æ_dump
(
p
, "<%s> ", 
buf
);

680 ià(
lšk
->
û_mask
 & 
LINK_ATTR_LINK
) {

681 ià(
ÿche
) {

682 
¹Æ_lšk
 *
Î
 = 
	`¹Æ_lšk_g‘
(
ÿche
, 
lšk
->
l_lšk
);

683 
	`Æ_dump
(
p
, "¦ave-oà% ", 
Î
 ?†l->
l_Çme
 : "NONE");

684 ià(
Î
)

685 
	`¹Æ_lšk_put
(
Î
);

687 
	`Æ_dump
(
p
, "¦ave-oà%d ", 
lšk
->
l_lšk
);

690 ià(
lšk
->
û_mask
 & 
LINK_ATTR_GROUP
)

691 
	`Æ_dump
(
p
, "grou°%u ", 
lšk
->
l_group
);

693 ià(
lšk
->
l_šfo_İs
 &&†šk->l_šfo_İs->
io_dump
[
NL_DUMP_LINE
])

694 
lšk
->
l_šfo_İs
->
io_dump
[
NL_DUMP_LINE
]Öšk, 
p
);

696 
	`do_fÜ—ch_af
(
lšk
, 
af_dump_lše
, 
p
);

698 
	`Æ_dump
(
p
, "\n");

700 ià(
ãtched_ÿche
)

701 
	`Æ_ÿche_put
(
ÿche
);

702 
	}
}

704 
	$lšk_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

706 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

707 
buf
[64];

709 
	`lšk_dump_lše
(
obj
, 
p
);

711 
	`Æ_dump_lše
(
p
, " mtu %u ", 
lšk
->
l_mtu
);

712 
	`Æ_dump
(
p
, "txqËÀ%u weighˆ%u ", 
lšk
->
l_txqËn
,†šk->
l_weight
);

714 ià(
lšk
->
û_mask
 & 
LINK_ATTR_QDISC
)

715 
	`Æ_dump
(
p
, "qdisø% ", 
lšk
->
l_qdisc
);

717 ià(
lšk
->
û_mask
 & 
LINK_ATTR_MAP
 &&†šk->
l_m­
.
lm_œq
)

718 
	`Æ_dump
(
p
, "œq %u ", 
lšk
->
l_m­
.
lm_œq
);

720 ià(
lšk
->
û_mask
 & 
LINK_ATTR_IFINDEX
)

721 
	`Æ_dump
(
p
, "šdex %u ", 
lšk
->
l_šdex
);

723 ià(
lšk
->
û_mask
 & 
LINK_ATTR_PROMISCUITY
 &&†šk->
l_´omiscu™y
 > 0)

724 
	`Æ_dump
(
p
, "´omisc-mod(%u u£rsè", 
lšk
->
l_´omiscu™y
);

726 
	`Æ_dump
(
p
, "\n");

728 ià(
lšk
->
û_mask
 & 
LINK_ATTR_IFALIAS
)

729 
	`Æ_dump_lše
(
p
, "‡lŸ %s\n", 
lšk
->
l_içlŸs
);

731 
	`Æ_dump_lše
(
p
, " ");

733 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_TX_QUEUES
)

734 
	`Æ_dump
(
p
, "txq %u ", 
lšk
->
l_num_tx_queues
);

736 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_RX_QUEUES
)

737 
	`Æ_dump
(
p
, "rxq %u ", 
lšk
->
l_num_rx_queues
);

739 ià(
lšk
->
û_mask
 & 
LINK_ATTR_BRD
)

740 
	`Æ_dump
(
p
, "brd % ", 
	`Æ_addr2¡r
(
lšk
->
l_bÿ¡
, 
buf
,

741 (
buf
)));

743 ià((
lšk
->
û_mask
 & 
LINK_ATTR_OPERSTATE
) &&

744 
lšk
->
l_İ”¡©e
 !ğ
IF_OPER_UNKNOWN
) {

745 
	`¹Æ_lšk_İ”¡©e2¡r
(
lšk
->
l_İ”¡©e
, 
buf
, (buf));

746 
	`Æ_dump
(
p
, "¡©% ", 
buf
);

749 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_VF
)

750 
	`Æ_dump
(
p
, "num-và%u ", 
lšk
->
l_num_vf
);

752 
	`Æ_dump
(
p
, "mode %s ",

753 
	`¹Æ_lšk_mode2¡r
(
lšk
->
l_lškmode
, 
buf
, (buf)));

755 
	`Æ_dump
(
p
, "carrier %s",

756 
	`¹Æ_lšk_ÿ¼›r2¡r
(
lšk
->
l_ÿ¼›r
, 
buf
, (buf)));

758 
	`Æ_dump
(
p
, "\n");

760 ià(
lšk
->
l_šfo_İs
 &&†šk->l_šfo_İs->
io_dump
[
NL_DUMP_DETAILS
])

761 
lšk
->
l_šfo_İs
->
io_dump
[
NL_DUMP_DETAILS
]Öšk, 
p
);

763 
	`do_fÜ—ch_af
(
lšk
, 
af_dump_d‘as
, 
p
);

764 
	}
}

766 
	$lšk_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

768 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

769 *
un™
, 
fmt
[64];

770 
»s
;

772 
	`lšk_dump_d‘as
(
obj
, 
p
);

774 
	`Æ_dump_lše
(
p
, " Stats: bytes…acketsƒrrors "

777 
»s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_RX_BYTES
], &
un™
);

779 
	`¡rıy
(
fmt
, " RX %X.2à% %10" 
PRIu64
 " %10" PRIu64 " %10" PRIu64 " %10" PRIu64 " %10" PRIu64 "\n");

780 
fmt
[9] = *
un™
 == 'B' ? '9' : '7';

782 
	`Æ_dump_lše
(
p
, 
fmt
, 
»s
, 
un™
,

783 
lšk
->
l_¡©s
[
RTNL_LINK_RX_PACKETS
],

784 
lšk
->
l_¡©s
[
RTNL_LINK_RX_ERRORS
],

785 
lšk
->
l_¡©s
[
RTNL_LINK_RX_DROPPED
],

786 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FIFO_ERR
],

787 
lšk
->
l_¡©s
[
RTNL_LINK_RX_COMPRESSED
]);

789 
»s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_TX_BYTES
], &
un™
);

791 
	`¡rıy
(
fmt
, " TX %X.2à% %10" 
PRIu64
 " %10" PRIu64 " %10" PRIu64 " %10" PRIu64 " %10" PRIu64 "\n");

792 
fmt
[9] = *
un™
 == 'B' ? '9' : '7';

794 
	`Æ_dump_lše
(
p
, 
fmt
, 
»s
, 
un™
,

795 
lšk
->
l_¡©s
[
RTNL_LINK_TX_PACKETS
],

796 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ERRORS
],

797 
lšk
->
l_¡©s
[
RTNL_LINK_TX_DROPPED
],

798 
lšk
->
l_¡©s
[
RTNL_LINK_TX_FIFO_ERR
],

799 
lšk
->
l_¡©s
[
RTNL_LINK_TX_COMPRESSED
]);

801 
	`Æ_dump_lše
(
p
, " Errors:†ength over crc "

804 
	`Æ_dump_lše
(
p
, " RX %10" 
PRIu64
 " %10" PRIu64 " %10"

805 
PRIu64
 " %10" PRIu64 " %10" PRIu64 " %10"

806 
PRIu64
 "\n",

807 
lšk
->
l_¡©s
[
RTNL_LINK_RX_LEN_ERR
],

808 
lšk
->
l_¡©s
[
RTNL_LINK_RX_OVER_ERR
],

809 
lšk
->
l_¡©s
[
RTNL_LINK_RX_CRC_ERR
],

810 
lšk
->
l_¡©s
[
RTNL_LINK_RX_FRAME_ERR
],

811 
lšk
->
l_¡©s
[
RTNL_LINK_RX_MISSED_ERR
],

812 
lšk
->
l_¡©s
[
RTNL_LINK_MULTICAST
]);

814 
	`Æ_dump_lše
(
p
, "‡borted carrier heartbeat "

817 
	`Æ_dump_lše
(
p
, " TX %10" 
PRIu64
 " %10" PRIu64 " %10"

818 
PRIu64
 " %10" PRIu64 " %10" PRIu64 "\n",

819 
lšk
->
l_¡©s
[
RTNL_LINK_TX_ABORT_ERR
],

820 
lšk
->
l_¡©s
[
RTNL_LINK_TX_CARRIER_ERR
],

821 
lšk
->
l_¡©s
[
RTNL_LINK_TX_HBEAT_ERR
],

822 
lšk
->
l_¡©s
[
RTNL_LINK_TX_WIN_ERR
],

823 
lšk
->
l_¡©s
[
RTNL_LINK_COLLISIONS
]);

825 ià(
lšk
->
l_šfo_İs
 &&†šk->l_šfo_İs->
io_dump
[
NL_DUMP_STATS
])

826 
lšk
->
l_šfo_İs
->
io_dump
[
NL_DUMP_STATS
]Öšk, 
p
);

828 
	`do_fÜ—ch_af
(
lšk
, 
af_dump_¡©s
, 
p
);

829 
	}
}

832 
	$lšk_hªdË_ev’t
(
Æ_objeù
 *
a
, 
¹Æ_lšk_ev’t_cb
 *
cb
)

834 
¹Æ_lšk
 *
l
 = (¹Æ_lšk *è
a
;

835 
Æ_ÿche
 *
c
 = 
	`dp_ÿche
(
a
);

836 
Ãv’ts
 = 0;

838 ià(
l
->
l_chªge
 == ~0U) {

839 ià(
l
->
û_msgty³
 =ğ
RTM_NEWLINK
)

840 
cb
->
	`Ë_»gi¡”
(
l
);

842 
cb
->
	`Ë_uÄegi¡”
(
l
);

847 ià(
l
->
l_chªge
 & 
IFF_SLAVE
) {

848 ià(
l
->
l_æags
 & 
IFF_SLAVE
) {

849 
¹Æ_lšk
 *
m
 = 
	`¹Æ_lšk_g‘
(
c
, 
l
->
l_ma¡”
);

850 
cb
->
	`Ë_Ãw_bÚdšg
(
l
, 
m
);

851 ià(
m
)

852 
	`¹Æ_lšk_put
(
m
);

854 
cb
->
	`Ë_ÿnûl_bÚdšg
(
l
);

858 ià(
l
->
l_chªge
 & 
IFF_UP
 &&†->l_chªg& 
IFF_RUNNING
)

859 
	`dp_dump_lše
(
p
, 
lše
++, "link %s changed stateo %s.\n",

860 
l
->
l_Çme
,†->
l_æags
 & 
IFF_UP
 ? "up" : "down");

862 ià(
l
->
l_chªge
 & 
IFF_PROMISC
) {

863 
	`dp_Ãw_lše
(
p
, 
lše
++);

864 
	`dp_dump
(
p
, "link %s %s…romiscuous mode.\n",

865 
l
->
l_Çme
,†->
l_æags
 & 
IFF_PROMISC
 ? "entered" : "left");

868 ià(
lše
 == 0)

869 
	`dp_dump_lše
(
p
, 
lše
++, "link %s sent unknownƒvent.\n",

870 
l
->
l_Çme
);

873  
Ãv’ts
;

874 
	}
}

878 
	$lšk_keyg’
(
Æ_objeù
 *
obj
, 
ušt32_t
 *
hashkey
,

879 
ušt32_t
 
bË_sz
)

881 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

882 
lkey_sz
;

883 
	slšk_hash_key
 {

884 
ušt32_t
 
l_šdex
;

885 
ušt32_t
 
l_çmy
;

886 } 
	`__©Œibu‹__
((
·cked
)è
lkey
;

888 
lkey_sz
 = (
lkey
);

889 
lkey
.
l_šdex
 = 
lšk
->l_index;

890 
lkey
.
l_çmy
 = 
lšk
->l_family;

892 *
hashkey
 = 
	`Æ_hash
(&
lkey
, 
lkey_sz
, 0è% 
bË_sz
;

894 
	`NL_DBG
(5, "link %p key (dev %d fam %d) keysz %d, hash 0x%x\n",

895 
lšk
, 
lkey
.
l_šdex
,†key.
l_çmy
, 
lkey_sz
, *
hashkey
);

898 
	}
}

900 
	$lšk_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

901 
ušt32_t
 
©Œs
, 
æags
)

903 
¹Æ_lšk
 *
a
 = (¹Æ_lšk *è
_a
;

904 
¹Æ_lšk
 *
b
 = (¹Æ_lšk *è
_b
;

905 
diff
 = 0;

907 
	#LINK_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
LINK_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

909 
diff
 |ğ
	`LINK_DIFF
(
IFINDEX
, 
a
->
l_šdex
 !ğ
b
->l_index);

910 
diff
 |ğ
	`LINK_DIFF
(
MTU
, 
a
->
l_mtu
 !ğ
b
->l_mtu);

911 
diff
 |ğ
	`LINK_DIFF
(
LINK
, 
a
->
l_lšk
 !ğ
b
->l_link);

912 
diff
 |ğ
	`LINK_DIFF
(
TXQLEN
, 
a
->
l_txqËn
 !ğ
b
->l_txqlen);

913 
diff
 |ğ
	`LINK_DIFF
(
WEIGHT
, 
a
->
l_weight
 !ğ
b
->l_weight);

914 
diff
 |ğ
	`LINK_DIFF
(
MASTER
, 
a
->
l_ma¡”
 !ğ
b
->l_master);

915 
diff
 |ğ
	`LINK_DIFF
(
FAMILY
, 
a
->
l_çmy
 !ğ
b
->l_family);

916 
diff
 |ğ
	`LINK_DIFF
(
OPERSTATE
, 
a
->
l_İ”¡©e
 !ğ
b
->l_operstate);

917 
diff
 |ğ
	`LINK_DIFF
(
LINKMODE
, 
a
->
l_lškmode
 !ğ
b
->l_linkmode);

918 
diff
 |ğ
	`LINK_DIFF
(
QDISC
, 
	`¡rcmp
(
a
->
l_qdisc
, 
b
->l_qdisc));

919 
diff
 |ğ
	`LINK_DIFF
(
IFNAME
, 
	`¡rcmp
(
a
->
l_Çme
, 
b
->l_name));

920 
diff
 |ğ
	`LINK_DIFF
(
ADDR
, 
	`Æ_addr_cmp
(
a
->
l_addr
, 
b
->l_addr));

921 
diff
 |ğ
	`LINK_DIFF
(
BRD
, 
	`Æ_addr_cmp
(
a
->
l_bÿ¡
, 
b
->l_bcast));

922 
diff
 |ğ
	`LINK_DIFF
(
IFALIAS
, 
	`¡rcmp
(
a
->
l_içlŸs
, 
b
->l_ifalias));

923 
diff
 |ğ
	`LINK_DIFF
(
NUM_VF
, 
a
->
l_num_vf
 !ğ
b
->l_num_vf);

924 
diff
 |ğ
	`LINK_DIFF
(
PROMISCUITY
, 
a
->
l_´omiscu™y
 !ğ
b
->l_promiscuity);

925 
diff
 |ğ
	`LINK_DIFF
(
NUM_TX_QUEUES
,
a
->
l_num_tx_queues
 !ğ
b
->l_num_tx_queues);

926 
diff
 |ğ
	`LINK_DIFF
(
NUM_RX_QUEUES
,
a
->
l_num_rx_queues
 !ğ
b
->l_num_rx_queues);

927 
diff
 |ğ
	`LINK_DIFF
(
GROUP
, 
a
->
l_group
 !ğ
b
->l_group);

929 ià(
æags
 & 
LOOSE_COMPARISON
)

930 
diff
 |ğ
	`LINK_DIFF
(
FLAGS
,

931 (
a
->
l_æags
 ^ 
b
->l_æagsè& b->
l_æag_mask
);

933 
diff
 |ğ
	`LINK_DIFF
(
FLAGS
, 
a
->
l_æags
 !ğ
b
->l_flags);

938 ià(
a
->
l_çmy
 =ğ
b
->l_family) {

939 ià(
	`¹Æ_lšk_af_d©a_com·»
(
a
, 
b
,‡->
l_çmy
) != 0)

940 
´Ùšfo_mism©ch
;

943 
out
:

944  
diff
;

946 
´Ùšfo_mism©ch
:

947 
diff
 |ğ
	`LINK_DIFF
(
PROTINFO
, 1);

948 
out
;

950 #undeà
LINK_DIFF


951 
	}
}

953 cÚ¡ 
Œªs_tbl
 
	glšk_©Œs
[] = {

954 
__ADD
(
LINK_ATTR_MTU
, 
mtu
)

955 
__ADD
(
LINK_ATTR_LINK
, 
lšk
)

956 
__ADD
(
LINK_ATTR_TXQLEN
, 
txqËn
)

957 
__ADD
(
LINK_ATTR_WEIGHT
, 
weight
)

958 
__ADD
(
LINK_ATTR_MASTER
, 
ma¡”
)

959 
__ADD
(
LINK_ATTR_QDISC
, 
qdisc
)

960 
__ADD
(
LINK_ATTR_MAP
, 
m­
)

961 
__ADD
(
LINK_ATTR_ADDR
, 
add»ss
)

962 
__ADD
(
LINK_ATTR_BRD
, 
brßdÿ¡
)

963 
__ADD
(
LINK_ATTR_FLAGS
, 
æags
)

964 
__ADD
(
LINK_ATTR_IFNAME
, 
Çme
)

965 
__ADD
(
LINK_ATTR_IFINDEX
, 
ifšdex
)

966 
__ADD
(
LINK_ATTR_FAMILY
, 
çmy
)

967 
__ADD
(
LINK_ATTR_ARPTYPE
, 
¬±y³
)

968 
__ADD
(
LINK_ATTR_STATS
, 
¡©s
)

969 
__ADD
(
LINK_ATTR_CHANGE
, 
chªge
)

970 
__ADD
(
LINK_ATTR_OPERSTATE
, 
İ”¡©e
)

971 
__ADD
(
LINK_ATTR_LINKMODE
, 
lškmode
)

972 
__ADD
(
LINK_ATTR_IFALIAS
, 
içlŸs
)

973 
__ADD
(
LINK_ATTR_NUM_VF
, 
num_vf
)

974 
__ADD
(
LINK_ATTR_PROMISCUITY
, 
´omiscu™y
)

975 
__ADD
(
LINK_ATTR_NUM_TX_QUEUES
, 
num_tx_queues
)

976 
__ADD
(
LINK_ATTR_NUM_RX_QUEUES
, 
num_rx_queues
)

977 
__ADD
(
LINK_ATTR_GROUP
, 
group
)

978 
__ADD
(
LINK_ATTR_CARRIER
, 
ÿ¼›r
)

979 
__ADD
(
LINK_ATTR_PHYS_PORT_ID
, 
phys_pÜt_id
)

982 *
	$lšk_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

984  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
lšk_©Œs
,

985 
	`ARRAY_SIZE
(
lšk_©Œs
));

986 
	}
}

1018 
	$¹Æ_lšk_®loc_ÿche
(
Æ_sock
 *
sk
, 
çmy
, 
Æ_ÿche
 **
»suÉ
)

1020 
Æ_ÿche
 * 
ÿche
;

1021 
”r
;

1023 
ÿche
 = 
	`Æ_ÿche_®loc
(&
¹Æ_lšk_İs
);

1024 ià(!
ÿche
)

1025  -
NLE_NOMEM
;

1027 
ÿche
->
c_Ÿrg1
 = 
çmy
;

1029 ià(
sk
 && (
”r
 = 
	`Æ_ÿche_»fl
(sk, 
ÿche
)) < 0) {

1030 
	`Æ_ÿche_ä“
(
ÿche
);

1031  
”r
;

1034 *
»suÉ
 = 
ÿche
;

1036 
	}
}

1053 
¹Æ_lšk
 *
	$¹Æ_lšk_g‘
(
Æ_ÿche
 *
ÿche
, 
ifšdex
)

1055 
¹Æ_lšk
 *
lšk
;

1057 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_lšk_İs
)

1058  
NULL
;

1060 
	`Æ_li¡_fÜ_—ch_’Œy
(
lšk
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1061 ià(
lšk
->
l_šdex
 =ğ
ifšdex
) {

1062 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
lšk
);

1063  
lšk
;

1067  
NULL
;

1068 
	}
}

1085 
¹Æ_lšk
 *
	$¹Æ_lšk_g‘_by_Çme
(
Æ_ÿche
 *
ÿche
,

1086 cÚ¡ *
Çme
)

1088 
¹Æ_lšk
 *
lšk
;

1090 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_lšk_İs
)

1091  
NULL
;

1093 
	`Æ_li¡_fÜ_—ch_’Œy
(
lšk
, &
ÿche
->
c_™ems
, 
û_li¡
) {

1094 ià(!
	`¡rcmp
(
Çme
, 
lšk
->
l_Çme
)) {

1095 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
lšk
);

1096  
lšk
;

1100  
NULL
;

1101 
	}
}

1117 
	$¹Æ_lšk_bud_g‘_»que¡
(
ifšdex
, cÚ¡ *
Çme
,

1118 
Æ_msg
 **
»suÉ
)

1120 
ifšfomsg
 
ifi
;

1121 
Æ_msg
 *
msg
;

1123 ià(
ifšdex
 <ğ0 && !
Çme
) {

1124 
	`APPBUG
("ifindex or‚ame must be specified");

1125  -
NLE_MISSING_ATTR
;

1128 
	`mem£t
(&
ifi
, 0, (ifi));

1130 ià(!(
msg
 = 
	`Æmsg_®loc_sim¶e
(
RTM_GETLINK
, 0)))

1131  -
NLE_NOMEM
;

1133 ià(
ifšdex
 > 0)

1134 
ifi
.
ifi_šdex
 = 
ifšdex
;

1136 ià(
	`Æmsg_­³nd
(
msg
, &
ifi
, (ifi), 
NLMSG_ALIGNTO
) < 0)

1137 
Æa_put_çu»
;

1139 ià(
Çme
)

1140 
	`NLA_PUT_STRING
(
msg
, 
IFLA_IFNAME
, 
Çme
);

1142 *
»suÉ
 = 
msg
;

1145 
Æa_put_çu»
:

1146 
	`Æmsg_ä“
(
msg
);

1147  -
NLE_MSGSIZE
;

1148 
	}
}

1166 
	$¹Æ_lšk_g‘_k”Ãl
(
Æ_sock
 *
sk
, 
ifšdex
, cÚ¡ *
Çme
,

1167 
¹Æ_lšk
 **
»suÉ
)

1169 
Æ_msg
 *
msg
 = 
NULL
;

1170 
Æ_objeù
 *
obj
;

1171 
”r
;

1173 ià((
”r
 = 
	`¹Æ_lšk_bud_g‘_»que¡
(
ifšdex
, 
Çme
, &
msg
)) < 0)

1174  
”r
;

1176 
”r
 = 
	`Æ_£nd_auto
(
sk
, 
msg
);

1177 
	`Æmsg_ä“
(
msg
);

1178 ià(
”r
 < 0)

1179  
”r
;

1181 ià((
”r
 = 
	`Æ_pickup
(
sk
, 
lšk_msg_·r£r
, &
obj
)) < 0)

1182  
”r
;

1185 *
»suÉ
 = (
¹Æ_lšk
 *è
obj
;

1188 ià(
”r
 =ğ0 && 
obj
)

1189 
	`wa™_fÜ_ack
(
sk
);

1192 
	}
}

1208 * 
	$¹Æ_lšk_i2Çme
(
Æ_ÿche
 *
ÿche
, 
ifšdex
, *
d¡
,

1209 
size_t
 
Ën
)

1211 
¹Æ_lšk
 *
lšk
 = 
	`¹Æ_lšk_g‘
(
ÿche
, 
ifšdex
);

1213 ià(
lšk
) {

1214 
	`¡ºıy
(
d¡
, 
lšk
->
l_Çme
, 
Ën
 - 1);

1215 
	`¹Æ_lšk_put
(
lšk
);

1216  
d¡
;

1219  
NULL
;

1220 
	}
}

1231 
	$¹Æ_lšk_Çme2i
(
Æ_ÿche
 *
ÿche
, cÚ¡ *
Çme
)

1233 
ifšdex
 = 0;

1234 
¹Æ_lšk
 *
lšk
;

1236 
lšk
 = 
	`¹Æ_lšk_g‘_by_Çme
(
ÿche
, 
Çme
);

1237 ià(
lšk
) {

1238 
ifšdex
 = 
lšk
->
l_šdex
;

1239 
	`¹Æ_lšk_put
(
lšk
);

1242  
ifšdex
;

1243 
	}
}

1247 
	$¹Æ_lšk_fl_šfo
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

1249 ià(
lšk
->
û_mask
 & 
LINK_ATTR_ADDR
)

1250 
	`NLA_PUT_ADDR
(
msg
, 
IFLA_ADDRESS
, 
lšk
->
l_addr
);

1252 ià(
lšk
->
û_mask
 & 
LINK_ATTR_BRD
)

1253 
	`NLA_PUT_ADDR
(
msg
, 
IFLA_BROADCAST
, 
lšk
->
l_bÿ¡
);

1255 ià(
lšk
->
û_mask
 & 
LINK_ATTR_MTU
)

1256 
	`NLA_PUT_U32
(
msg
, 
IFLA_MTU
, 
lšk
->
l_mtu
);

1258 ià(
lšk
->
û_mask
 & 
LINK_ATTR_TXQLEN
)

1259 
	`NLA_PUT_U32
(
msg
, 
IFLA_TXQLEN
, 
lšk
->
l_txqËn
);

1261 ià(
lšk
->
û_mask
 & 
LINK_ATTR_WEIGHT
)

1262 
	`NLA_PUT_U32
(
msg
, 
IFLA_WEIGHT
, 
lšk
->
l_weight
);

1264 ià(
lšk
->
û_mask
 & 
LINK_ATTR_IFNAME
)

1265 
	`NLA_PUT_STRING
(
msg
, 
IFLA_IFNAME
, 
lšk
->
l_Çme
);

1267 ià(
lšk
->
û_mask
 & 
LINK_ATTR_OPERSTATE
)

1268 
	`NLA_PUT_U8
(
msg
, 
IFLA_OPERSTATE
, 
lšk
->
l_İ”¡©e
);

1270 ià(
lšk
->
û_mask
 & 
LINK_ATTR_CARRIER
)

1271 
	`NLA_PUT_U8
(
msg
, 
IFLA_CARRIER
, 
lšk
->
l_ÿ¼›r
);

1273 ià(
lšk
->
û_mask
 & 
LINK_ATTR_LINKMODE
)

1274 
	`NLA_PUT_U8
(
msg
, 
IFLA_LINKMODE
, 
lšk
->
l_lškmode
);

1276 ià(
lšk
->
û_mask
 & 
LINK_ATTR_IFALIAS
)

1277 
	`NLA_PUT_STRING
(
msg
, 
IFLA_IFALIAS
, 
lšk
->
l_içlŸs
);

1279 ià(
lšk
->
û_mask
 & 
LINK_ATTR_LINK
)

1280 
	`NLA_PUT_U32
(
msg
, 
IFLA_LINK
, 
lšk
->
l_lšk
);

1282 ià(
lšk
->
û_mask
 & 
LINK_ATTR_MASTER
)

1283 
	`NLA_PUT_U32
(
msg
, 
IFLA_MASTER
, 
lšk
->
l_ma¡”
);

1285 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_TX_QUEUES
)

1286 
	`NLA_PUT_U32
(
msg
, 
IFLA_NUM_TX_QUEUES
, 
lšk
->
l_num_tx_queues
);

1288 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_RX_QUEUES
)

1289 
	`NLA_PUT_U32
(
msg
, 
IFLA_NUM_RX_QUEUES
, 
lšk
->
l_num_rx_queues
);

1291 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NS_FD
)

1292 
	`NLA_PUT_U32
(
msg
, 
IFLA_NET_NS_FD
, 
lšk
->
l_ns_fd
);

1294 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NS_PID
)

1295 
	`NLA_PUT_U32
(
msg
, 
IFLA_NET_NS_PID
, 
lšk
->
l_ns_pid
);

1299 
Æa_put_çu»
:

1300  -
NLE_MSGSIZE
;

1301 
	}
}

1303 
	$bud_lšk_msg
(
cmd
, 
ifšfomsg
 *
hdr
,

1304 
¹Æ_lšk
 *
lšk
, 
æags
, 
Æ_msg
 **
»suÉ
)

1306 
Æ_msg
 *
msg
;

1307 
Æ©Œ
 *
af_¥ec
;

1309 
msg
 = 
	`Æmsg_®loc_sim¶e
(
cmd
, 
æags
);

1310 ià(!
msg
)

1311  -
NLE_NOMEM
;

1313 ià(
	`Æmsg_­³nd
(
msg
, 
hdr
, (*hdr), 
NLMSG_ALIGNTO
) < 0)

1314 
Æa_put_çu»
;

1316 ià(
	`¹Æ_lšk_fl_šfo
(
msg
, 
lšk
))

1317 
Æa_put_çu»
;

1319 ià(
lšk
->
û_mask
 & 
LINK_ATTR_GROUP
)

1320 
	`NLA_PUT_U32
(
msg
, 
IFLA_GROUP
, 
lšk
->
l_group
);

1322 ià(
lšk
->
û_mask
 & 
LINK_ATTR_LINKINFO
) {

1323 
Æ©Œ
 *
šfo
;

1325 ià(!(
šfo
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_LINKINFO
)))

1326 
Æa_put_çu»
;

1328 
	`NLA_PUT_STRING
(
msg
, 
IFLA_INFO_KIND
, 
lšk
->
l_šfo_kšd
);

1330 ià(
lšk
->
l_šfo_İs
) {

1331 ià(
lšk
->
l_šfo_İs
->
io_put_©Œs
 &&

1332 
lšk
->
l_šfo_İs
->
	`io_put_©Œs
(
msg
,†ink) < 0)

1333 
Æa_put_çu»
;

1336 
	`Æa_Ã¡_’d
(
msg
, 
šfo
);

1339 ià(!(
af_¥ec
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_AF_SPEC
)))

1340 
Æa_put_çu»
;

1342 ià(
	`do_fÜ—ch_af
(
lšk
, 
af_fl
, 
msg
) < 0)

1343 
Æa_put_çu»
;

1345 
	`Æa_Ã¡_’d
(
msg
, 
af_¥ec
);

1347 *
»suÉ
 = 
msg
;

1350 
Æa_put_çu»
:

1351 
	`Æmsg_ä“
(
msg
);

1352  -
NLE_MSGSIZE
;

1353 
	}
}

1376 
	$¹Æ_lšk_bud_add_»que¡
(
¹Æ_lšk
 *
lšk
, 
æags
,

1377 
Æ_msg
 **
»suÉ
)

1379 
ifšfomsg
 
ifi
 = {

1380 .
ifi_çmy
 = 
lšk
->
l_çmy
,

1381 .
ifi_šdex
 = 
lšk
->
l_šdex
,

1382 .
ifi_æags
 = 
lšk
->
l_æags
,

1385  
	`bud_lšk_msg
(
RTM_NEWLINK
, &
ifi
, 
lšk
, 
æags
, 
»suÉ
);

1386 
	}
}

1405 
	$¹Æ_lšk_add
(
Æ_sock
 *
sk
, 
¹Æ_lšk
 *
lšk
, 
æags
)

1407 
Æ_msg
 *
msg
;

1408 
”r
;

1410 
”r
 = 
	`¹Æ_lšk_bud_add_»que¡
(
lšk
, 
æags
, &
msg
);

1411 ià(
”r
 < 0)

1412  
”r
;

1414  
	`Æ_£nd_sync
(
sk
, 
msg
);

1415 
	}
}

1437 
	$¹Æ_lšk_bud_chªge_»que¡
(
¹Æ_lšk
 *
Üig
,

1438 
¹Æ_lšk
 *
chªges
, 
æags
,

1439 
Æ_msg
 **
»suÉ
)

1441 
ifšfomsg
 
ifi
 = {

1442 .
ifi_çmy
 = 
Üig
->
l_çmy
,

1443 .
ifi_šdex
 = 
Üig
->
l_šdex
,

1445 
”r
;

1447 ià(
chªges
->
û_mask
 & 
LINK_ATTR_FLAGS
) {

1448 
ifi
.
ifi_æags
 = 
Üig
->
l_æags
 & ~
chªges
->
l_æag_mask
;

1449 
ifi
.
ifi_æags
 |ğ
chªges
->
l_æags
;

1452 ià(
chªges
->
l_çmy
 && chªges->l_çmy !ğ
Üig
->l_family) {

1453 
	`APPBUG
("link change: family is immutable");

1454  -
NLE_IMMUTABLE
;

1458 ià(
Üig
->
û_mask
 & 
LINK_ATTR_IFINDEX
 &&

1459 
Üig
->
û_mask
 & 
LINK_ATTR_IFNAME
 &&

1460 
chªges
->
û_mask
 & 
LINK_ATTR_IFNAME
 &&

1461 !
	`¡rcmp
(
Üig
->
l_Çme
, 
chªges
->l_name))

1462 
chªges
->
û_mask
 &ğ~
LINK_ATTR_IFNAME
;

1464 ià((
”r
 = 
	`bud_lšk_msg
(
RTM_NEWLINK
, &
ifi
, 
chªges
, 
æags
, 
»suÉ
)) < 0)

1465 
”rout
;

1469 
”rout
:

1470  
”r
;

1471 
	}
}

1504 
	$¹Æ_lšk_chªge
(
Æ_sock
 *
sk
, 
¹Æ_lšk
 *
Üig
,

1505 
¹Æ_lšk
 *
chªges
, 
æags
)

1507 
Æ_msg
 *
msg
;

1508 
”r
;

1510 
”r
 = 
	`¹Æ_lšk_bud_chªge_»que¡
(
Üig
, 
chªges
, 
æags
, &
msg
);

1511 ià(
”r
 < 0)

1512  
”r
;

1514 
»Œy
:

1515 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

1516 ià(
”r
 < 0)

1517 
”rout
;

1519 
”r
 = 
	`wa™_fÜ_ack
(
sk
);

1520 ià(
”r
 =ğ-
NLE_OPNOTSUPP
 && 
msg
->
nm_Æh
->
Æmsg_ty³
 =ğ
RTM_NEWLINK
) {

1521 
msg
->
nm_Æh
->
Æmsg_ty³
 = 
RTM_SETLINK
;

1522 
»Œy
;

1525 
”rout
:

1526 
	`Æmsg_ä“
(
msg
);

1527  
”r
;

1528 
	}
}

1550 
	$¹Æ_lšk_bud_d–‘e_»que¡
(cÚ¡ 
¹Æ_lšk
 *
lšk
,

1551 
Æ_msg
 **
»suÉ
)

1553 
Æ_msg
 *
msg
;

1554 
ifšfomsg
 
ifi
 = {

1555 .
ifi_šdex
 = 
lšk
->
l_šdex
,

1558 ià(!(
lšk
->
û_mask
 & (
LINK_ATTR_IFINDEX
 | 
LINK_ATTR_IFNAME
))) {

1559 
	`APPBUG
("ifindex or‚ame must be specified");

1560  -
NLE_MISSING_ATTR
;

1563 ià(!(
msg
 = 
	`Æmsg_®loc_sim¶e
(
RTM_DELLINK
, 0)))

1564  -
NLE_NOMEM
;

1566 ià(
	`Æmsg_­³nd
(
msg
, &
ifi
, (ifi), 
NLMSG_ALIGNTO
) < 0)

1567 
Æa_put_çu»
;

1569 ià(
lšk
->
û_mask
 & 
LINK_ATTR_IFNAME
)

1570 
	`NLA_PUT_STRING
(
msg
, 
IFLA_IFNAME
, 
lšk
->
l_Çme
);

1572 *
»suÉ
 = 
msg
;

1575 
Æa_put_çu»
:

1576 
	`Æmsg_ä“
(
msg
);

1577  -
NLE_MSGSIZE
;

1578 
	}
}

1604 
	$¹Æ_lšk_d–‘e
(
Æ_sock
 *
sk
, cÚ¡ 
¹Æ_lšk
 *
lšk
)

1606 
Æ_msg
 *
msg
;

1607 
”r
;

1609 ià((
”r
 = 
	`¹Æ_lšk_bud_d–‘e_»que¡
(
lšk
, &
msg
)) < 0)

1610  
”r
;

1612  
	`Æ_£nd_sync
(
sk
, 
msg
);

1613 
	}
}

1628 
¹Æ_lšk
 *
	$¹Æ_lšk_®loc
()

1630  (
¹Æ_lšk
 *è
	`Æ_objeù_®loc
(&
lšk_obj_İs
);

1631 
	}
}

1637 
	$¹Æ_lšk_put
(
¹Æ_lšk
 *
lšk
)

1639 
	`Æ_objeù_put
((
Æ_objeù
 *è
lšk
);

1640 
	}
}

1656 
	$¹Æ_lšk_£t_Çme
(
¹Æ_lšk
 *
lšk
, cÚ¡ *
Çme
)

1658 
	`¡ºıy
(
lšk
->
l_Çme
, 
Çme
, (link->l_name) - 1);

1659 
lšk
->
û_mask
 |ğ
LINK_ATTR_IFNAME
;

1660 
	}
}

1670 *
	$¹Æ_lšk_g‘_Çme
(
¹Æ_lšk
 *
lšk
)

1672  
lšk
->
û_mask
 & 
LINK_ATTR_IFNAME
 ?†šk->
l_Çme
 : 
NULL
;

1673 
	}
}

1680 
	$¹Æ_lšk_£t_group
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
group
)

1682 
lšk
->
l_group
 = 
group
;

1683 
lšk
->
û_mask
 |ğ
LINK_ATTR_GROUP
;

1684 
	}
}

1692 
ušt32_t
 
	$¹Æ_lšk_g‘_group
(
¹Æ_lšk
 *
lšk
)

1694  
lšk
->
l_group
;

1695 
	}
}

1697 
šlše
 
	$__assign_addr
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 **
pos
,

1698 
Æ_addr
 *
Ãw
, 
æag
)

1700 ià(*
pos
)

1701 
	`Æ_addr_put
(*
pos
);

1703 
	`Æ_addr_g‘
(
Ãw
);

1704 *
pos
 = 
Ãw
;

1706 
lšk
->
û_mask
 |ğ
æag
;

1707 
	}
}

1720 
	$¹Æ_lšk_£t_addr
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 *
addr
)

1722 
	`__assign_addr
(
lšk
, &lšk->
l_addr
, 
addr
, 
LINK_ATTR_ADDR
);

1723 
	}
}

1734 
Æ_addr
 *
	$¹Æ_lšk_g‘_addr
(
¹Æ_lšk
 *
lšk
)

1736  
lšk
->
û_mask
 & 
LINK_ATTR_ADDR
 ?†šk->
l_addr
 : 
NULL
;

1737 
	}
}

1751 
	$¹Æ_lšk_£t_brßdÿ¡
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 *
addr
)

1753 
	`__assign_addr
(
lšk
, &lšk->
l_bÿ¡
, 
addr
, 
LINK_ATTR_BRD
);

1754 
	}
}

1765 
Æ_addr
 *
	$¹Æ_lšk_g‘_brßdÿ¡
(
¹Æ_lšk
 *
lšk
)

1767  
lšk
->
û_mask
 & 
LINK_ATTR_BRD
 ?†šk->
l_bÿ¡
 : 
NULL
;

1768 
	}
}

1778 
	$¹Æ_lšk_£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

1780 
lšk
->
l_æag_mask
 |ğ
æags
;

1781 
lšk
->
l_æags
 |ğ
æags
;

1782 
lšk
->
û_mask
 |ğ
LINK_ATTR_FLAGS
;

1783 
	}
}

1793 
	$¹Æ_lšk_un£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

1795 
lšk
->
l_æag_mask
 |ğ
æags
;

1796 
lšk
->
l_æags
 &ğ~
æags
;

1797 
lšk
->
û_mask
 |ğ
LINK_ATTR_FLAGS
;

1798 
	}
}

1809 
	$¹Æ_lšk_g‘_æags
(
¹Æ_lšk
 *
lšk
)

1811  
lšk
->
l_æags
;

1812 
	}
}

1819 
	$¹Æ_lšk_£t_çmy
(
¹Æ_lšk
 *
lšk
, 
çmy
)

1821 
lšk
->
l_çmy
 = 
çmy
;

1822 
lšk
->
û_mask
 |ğ
LINK_ATTR_FAMILY
;

1824 ià(
lšk
->
l_af_İs
) {

1825 
	`af_ä“
(
lšk
,†šk->
l_af_İs
,

1826 
lšk
->
l_af_d©a
[lšk->
l_af_İs
->
ao_çmy
], 
NULL
);

1827 
lšk
->
l_af_d©a
[lšk->
l_af_İs
->
ao_çmy
] = 
NULL
;

1830 
lšk
->
l_af_İs
 = 
	`af_lookup_ªd_®loc
Öšk, 
çmy
);

1831 
	}
}

1840 
	$¹Æ_lšk_g‘_çmy
(
¹Æ_lšk
 *
lšk
)

1842  
lšk
->
û_mask
 & 
LINK_ATTR_FAMILY
 ?†šk->
l_çmy
 : 
AF_UNSPEC
;

1843 
	}
}

1854 
	$¹Æ_lšk_£t_¬±y³
(
¹Æ_lšk
 *
lšk
, 
¬±y³
)

1856 
lšk
->
l_¬±y³
 = 
¬±y³
;

1857 
lšk
->
û_mask
 |ğ
LINK_ATTR_ARPTYPE
;

1858 
	}
}

1868 
	$¹Æ_lšk_g‘_¬±y³
(
¹Æ_lšk
 *
lšk
)

1870 ià(
lšk
->
û_mask
 & 
LINK_ATTR_ARPTYPE
)

1871  
lšk
->
l_¬±y³
;

1873  
ARPHRD_VOID
;

1874 
	}
}

1884 
	$¹Æ_lšk_£t_ifšdex
(
¹Æ_lšk
 *
lšk
, 
ifšdex
)

1886 
lšk
->
l_šdex
 = 
ifšdex
;

1887 
lšk
->
û_mask
 |ğ
LINK_ATTR_IFINDEX
;

1888 
	}
}

1899 
	$¹Æ_lšk_g‘_ifšdex
(
¹Æ_lšk
 *
lšk
)

1901  
lšk
->
l_šdex
;

1902 
	}
}

1912 
	$¹Æ_lšk_£t_mtu
(
¹Æ_lšk
 *
lšk
, 
mtu
)

1914 
lšk
->
l_mtu
 = 
mtu
;

1915 
lšk
->
û_mask
 |ğ
LINK_ATTR_MTU
;

1916 
	}
}

1926 
	$¹Æ_lšk_g‘_mtu
(
¹Æ_lšk
 *
lšk
)

1928  
lšk
->
l_mtu
;

1929 
	}
}

1941 
	$¹Æ_lšk_£t_txqËn
(
¹Æ_lšk
 *
lšk
, 
txqËn
)

1943 
lšk
->
l_txqËn
 = 
txqËn
;

1944 
lšk
->
û_mask
 |ğ
LINK_ATTR_TXQLEN
;

1945 
	}
}

1957 
	$¹Æ_lšk_g‘_txqËn
(
¹Æ_lšk
 *
lšk
)

1959  
lšk
->
û_mask
 & 
LINK_ATTR_TXQLEN
 ?†šk->
l_txqËn
 : 0;

1960 
	}
}

1962 
	$¹Æ_lšk_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ifšdex
)

1964 
lšk
->
l_lšk
 = 
ifšdex
;

1965 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINK
;

1966 
	}
}

1968 
	$¹Æ_lšk_g‘_lšk
(
¹Æ_lšk
 *
lšk
)

1970  
lšk
->
l_lšk
;

1971 
	}
}

1980 
	$¹Æ_lšk_£t_ma¡”
(
¹Æ_lšk
 *
lšk
, 
ifšdex
)

1982 
lšk
->
l_ma¡”
 = 
ifšdex
;

1983 
lšk
->
û_mask
 |ğ
LINK_ATTR_MASTER
;

1984 
	}
}

1993 
	$¹Æ_lšk_g‘_ma¡”
(
¹Æ_lšk
 *
lšk
)

1995  
lšk
->
l_ma¡”
;

1996 
	}
}

2005 
	$¹Æ_lšk_£t_ÿ¼›r
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
¡©us
)

2007 
lšk
->
l_ÿ¼›r
 = 
¡©us
;

2008 
lšk
->
û_mask
 |ğ
LINK_ATTR_CARRIER
;

2009 
	}
}

2018 
ušt8_t
 
	$¹Æ_lšk_g‘_ÿ¼›r
(
¹Æ_lšk
 *
lšk
)

2020  
lšk
->
l_ÿ¼›r
;

2021 
	}
}

2031 
	$¹Æ_lšk_£t_İ”¡©e
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
¡©us
)

2033 
lšk
->
l_İ”¡©e
 = 
¡©us
;

2034 
lšk
->
û_mask
 |ğ
LINK_ATTR_OPERSTATE
;

2035 
	}
}

2045 
ušt8_t
 
	$¹Æ_lšk_g‘_İ”¡©e
(
¹Æ_lšk
 *
lšk
)

2047  
lšk
->
l_İ”¡©e
;

2048 
	}
}

2058 
	$¹Æ_lšk_£t_lškmode
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
mode
)

2060 
lšk
->
l_lškmode
 = 
mode
;

2061 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINKMODE
;

2062 
	}
}

2072 
ušt8_t
 
	$¹Æ_lšk_g‘_lškmode
(
¹Æ_lšk
 *
lšk
)

2074  
lšk
->
l_lškmode
;

2075 
	}
}

2085 cÚ¡ *
	$¹Æ_lšk_g‘_içlŸs
(
¹Æ_lšk
 *
lšk
)

2087  
lšk
->
l_içlŸs
;

2088 
	}
}

2102 
	$¹Æ_lšk_£t_içlŸs
(
¹Æ_lšk
 *
lšk
, cÚ¡ *
®Ÿs
)

2104 
	`ä“
(
lšk
->
l_içlŸs
);

2106 ià(
®Ÿs
) {

2107 
lšk
->
l_içlŸs
 = 
	`¡rdup
(
®Ÿs
);

2108 
lšk
->
û_mask
 |ğ
LINK_ATTR_IFALIAS
;

2110 
lšk
->
l_içlŸs
 = 
NULL
;

2111 
lšk
->
û_mask
 &ğ~
LINK_ATTR_IFALIAS
;

2113 
	}
}

2128 
	$¹Æ_lšk_£t_qdisc
(
¹Æ_lšk
 *
lšk
, cÚ¡ *
Çme
)

2130 
	`¡ºıy
(
lšk
->
l_qdisc
, 
Çme
, (link->l_qdisc) - 1);

2131 
lšk
->
û_mask
 |ğ
LINK_ATTR_QDISC
;

2132 
	}
}

2142 *
	$¹Æ_lšk_g‘_qdisc
(
¹Æ_lšk
 *
lšk
)

2144  
lšk
->
û_mask
 & 
LINK_ATTR_QDISC
 ?†šk->
l_qdisc
 : 
NULL
;

2145 
	}
}

2155 
	$¹Æ_lšk_g‘_num_vf
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
num_vf
)

2157 ià(
lšk
->
û_mask
 & 
LINK_ATTR_NUM_VF
) {

2158 *
num_vf
 = 
lšk
->
l_num_vf
;

2161  -
NLE_OPNOTSUPP
;

2162 
	}
}

2171 
ušt64_t
 
	$¹Æ_lšk_g‘_¡©
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_¡©_id_t
 
id
)

2173 ià(
id
 > 
RTNL_LINK_STATS_MAX
)

2176  
lšk
->
l_¡©s
[
id
];

2177 
	}
}

2190 
	$¹Æ_lšk_£t_¡©
(
¹Æ_lšk
 *
lšk
, 
¹Æ_lšk_¡©_id_t
 
id
,

2191 cÚ¡ 
ušt64_t
 
v®ue
)

2193 ià(
id
 > 
RTNL_LINK_STATS_MAX
)

2194  -
NLE_INVAL
;

2196 
lšk
->
l_¡©s
[
id
] = 
v®ue
;

2199 
	}
}

2213 
	$¹Æ_lšk_£t_ty³
(
¹Æ_lšk
 *
lšk
, cÚ¡ *
ty³
)

2215 
¹Æ_lšk_šfo_İs
 *
io
;

2216 
”r
;

2217 *
kšd
;

2219 
	`ä“
(
lšk
->
l_šfo_kšd
);

2220 
lšk
->
û_mask
 &ğ~
LINK_ATTR_LINKINFO
;

2221 ià(
lšk
->
l_šfo_İs
)

2222 
	`»Ëa£_lšk_šfo
(
lšk
);

2224 ià(!
ty³
)

2227 
kšd
 = 
	`¡rdup
(
ty³
);

2228 ià(!
kšd
)

2229  -
NLE_NOMEM
;

2231 
io
 = 
	`¹Æ_lšk_šfo_İs_lookup
(
ty³
);

2232 ià(
io
) {

2233 ià(
io
->
io_®loc
 && (
”r
 = io->
	`io_®loc
(
lšk
)) < 0)

2234 
”rout
;

2236 
lšk
->
l_šfo_İs
 = 
io
;

2239 
lšk
->
l_šfo_kšd
 = 
kšd
;

2240 
lšk
->
û_mask
 |ğ
LINK_ATTR_LINKINFO
;

2244 
”rout
:

2245 
	`ä“
(
kšd
);

2246  
”r
;

2247 
	}
}

2256 *
	$¹Æ_lšk_g‘_ty³
(
¹Æ_lšk
 *
lšk
)

2258  
lšk
->
l_šfo_kšd
;

2259 
	}
}

2270 
	$¹Æ_lšk_£t_´omiscu™y
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
couÁ
)

2272 
lšk
->
l_´omiscu™y
 = 
couÁ
;

2273 
lšk
->
û_mask
 |ğ
LINK_ATTR_PROMISCUITY
;

2274 
	}
}

2283 
ušt32_t
 
	$¹Æ_lšk_g‘_´omiscu™y
(
¹Æ_lšk
 *
lšk
)

2285  
lšk
->
l_´omiscu™y
;

2286 
	}
}

2302 
	$¹Æ_lšk_£t_num_tx_queues
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
nqueues
)

2304 
lšk
->
l_num_tx_queues
 = 
nqueues
;

2305 
lšk
->
û_mask
 |ğ
LINK_ATTR_NUM_TX_QUEUES
;

2306 
	}
}

2314 
ušt32_t
 
	$¹Æ_lšk_g‘_num_tx_queues
(
¹Æ_lšk
 *
lšk
)

2316  
lšk
->
l_num_tx_queues
;

2317 
	}
}

2333 
	$¹Æ_lšk_£t_num_rx_queues
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
nqueues
)

2335 
lšk
->
l_num_rx_queues
 = 
nqueues
;

2336 
lšk
->
û_mask
 |ğ
LINK_ATTR_NUM_RX_QUEUES
;

2337 
	}
}

2345 
ušt32_t
 
	$¹Æ_lšk_g‘_num_rx_queues
(
¹Æ_lšk
 *
lšk
)

2347  
lšk
->
l_num_rx_queues
;

2348 
	}
}

2356 
Æ_d©a
 *
	$¹Æ_lšk_g‘_phys_pÜt_id
(
¹Æ_lšk
 *
lšk
)

2358  
lšk
->
l_phys_pÜt_id
;

2359 
	}
}

2361 
	$¹Æ_lšk_£t_ns_fd
(
¹Æ_lšk
 *
lšk
, 
fd
)

2363 
lšk
->
l_ns_fd
 = 
fd
;

2364 
lšk
->
û_mask
 |ğ
LINK_ATTR_NS_FD
;

2365 
	}
}

2367 
	$¹Æ_lšk_g‘_ns_fd
(
¹Æ_lšk
 *
lšk
)

2369  
lšk
->
l_ns_fd
;

2370 
	}
}

2372 
	$¹Æ_lšk_£t_ns_pid
(
¹Æ_lšk
 *
lšk
, 
pid_t
 
pid
)

2374 
lšk
->
l_ns_pid
 = 
pid
;

2375 
lšk
->
û_mask
 |ğ
LINK_ATTR_NS_PID
;

2376 
	}
}

2378 
pid_t
 
	$¹Æ_lšk_g‘_ns_pid
(
¹Æ_lšk
 *
lšk
)

2380  
lšk
->
l_ns_pid
;

2381 
	}
}

2403 
	$¹Æ_lšk_’¦ave_ifšdex
(
Æ_sock
 *
sock
, 
ma¡”
, 
¦ave
)

2405 
¹Æ_lšk
 *
lšk
;

2406 
”r
;

2408 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

2409  -
NLE_NOMEM
;

2411 
	`¹Æ_lšk_£t_ifšdex
(
lšk
, 
¦ave
);

2412 
	`¹Æ_lšk_£t_ma¡”
(
lšk
, 
ma¡”
);

2414 ià((
”r
 = 
	`¹Æ_lšk_chªge
(
sock
, 
lšk
,†ink, 0)) < 0)

2415 
”rout
;

2417 
	`¹Æ_lšk_put
(
lšk
);

2426 ià((
”r
 = 
	`¹Æ_lšk_g‘_k”Ãl
(
sock
, 
¦ave
, 
NULL
, &
lšk
)) < 0)

2427  
”r
;

2429 ià(
	`¹Æ_lšk_g‘_ma¡”
(
lšk
è!ğ
ma¡”
)

2430 
”r
 = -
NLE_OPNOTSUPP
;

2432 
”rout
:

2433 
	`¹Æ_lšk_put
(
lšk
);

2435  
”r
;

2436 
	}
}

2458 
	$¹Æ_lšk_’¦ave
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
ma¡”
,

2459 
¹Æ_lšk
 *
¦ave
)

2461  
	`¹Æ_lšk_’¦ave_ifšdex
(
sock
, 
	`¹Æ_lšk_g‘_ifšdex
(
ma¡”
),

2462 
	`¹Æ_lšk_g‘_ifšdex
(
¦ave
));

2463 
	}
}

2477 
	$¹Æ_lšk_»Ëa£_ifšdex
(
Æ_sock
 *
sock
, 
¦ave
)

2479  
	`¹Æ_lšk_’¦ave_ifšdex
(
sock
, 0, 
¦ave
);

2480 
	}
}

2501 
	$¹Æ_lšk_»Ëa£
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¦ave
)

2503  
	`¹Æ_lšk_»Ëa£_ifšdex
(
sock
, 
	`¹Æ_lšk_g‘_ifšdex
(
¦ave
));

2504 
	}
}

2513 cÚ¡ 
Œªs_tbl
 
	glšk_æags
[] = {

2514 
__ADD
(
IFF_LOOPBACK
, 
loİback
)

2515 
__ADD
(
IFF_BROADCAST
, 
brßdÿ¡
)

2516 
__ADD
(
IFF_POINTOPOINT
, 
poštİošt
)

2517 
__ADD
(
IFF_MULTICAST
, 
muÉiÿ¡
)

2518 
__ADD
(
IFF_NOARP
, 
nß½
)

2519 
__ADD
(
IFF_ALLMULTI
, 
®lmuÉi
)

2520 
__ADD
(
IFF_PROMISC
, 
´omisc
)

2521 
__ADD
(
IFF_MASTER
, 
ma¡”
)

2522 
__ADD
(
IFF_SLAVE
, 
¦ave
)

2523 
__ADD
(
IFF_DEBUG
, 
debug
)

2524 
__ADD
(
IFF_DYNAMIC
, 
dyÇmic
)

2525 
__ADD
(
IFF_AUTOMEDIA
, 
automedŸ
)

2526 
__ADD
(
IFF_PORTSEL
, 
pÜt£l
)

2527 
__ADD
(
IFF_NOTRAILERS
, 
nÙ¿”s
)

2528 
__ADD
(
IFF_UP
, 
up
)

2529 
__ADD
(
IFF_RUNNING
, 
ruÂšg
)

2530 
__ADD
(
IFF_LOWER_UP
, 
low”up
)

2531 
__ADD
(
IFF_DORMANT
, 
dÜmªt
)

2532 
__ADD
(
IFF_ECHO
, 
echo
)

2535 *
	$¹Æ_lšk_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

2537  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
lšk_æags
,

2538 
	`ARRAY_SIZE
(
lšk_æags
));

2539 
	}
}

2541 
	$¹Æ_lšk_¡r2æags
(cÚ¡ *
Çme
)

2543  
	`__¡r2æags
(
Çme
, 
lšk_æags
, 
	`ARRAY_SIZE
(link_flags));

2544 
	}
}

2546 cÚ¡ 
Œªs_tbl
 
	glšk_¡©s
[] = {

2547 
__ADD
(
RTNL_LINK_RX_PACKETS
, 
rx_·ck‘s
)

2548 
__ADD
(
RTNL_LINK_TX_PACKETS
, 
tx_·ck‘s
)

2549 
__ADD
(
RTNL_LINK_RX_BYTES
, 
rx_by‹s
)

2550 
__ADD
(
RTNL_LINK_TX_BYTES
, 
tx_by‹s
)

2551 
__ADD
(
RTNL_LINK_RX_ERRORS
, 
rx_”rÜs
)

2552 
__ADD
(
RTNL_LINK_TX_ERRORS
, 
tx_”rÜs
)

2553 
__ADD
(
RTNL_LINK_RX_DROPPED
, 
rx_drİ³d
)

2554 
__ADD
(
RTNL_LINK_TX_DROPPED
, 
tx_drİ³d
)

2555 
__ADD
(
RTNL_LINK_RX_COMPRESSED
, 
rx_com´es£d
)

2556 
__ADD
(
RTNL_LINK_TX_COMPRESSED
, 
tx_com´es£d
)

2557 
__ADD
(
RTNL_LINK_RX_FIFO_ERR
, 
rx_fifo_”r
)

2558 
__ADD
(
RTNL_LINK_TX_FIFO_ERR
, 
tx_fifo_”r
)

2559 
__ADD
(
RTNL_LINK_RX_LEN_ERR
, 
rx_Ën_”r
)

2560 
__ADD
(
RTNL_LINK_RX_OVER_ERR
, 
rx_ov”_”r
)

2561 
__ADD
(
RTNL_LINK_RX_CRC_ERR
, 
rx_üc_”r
)

2562 
__ADD
(
RTNL_LINK_RX_FRAME_ERR
, 
rx_äame_”r
)

2563 
__ADD
(
RTNL_LINK_RX_MISSED_ERR
, 
rx_mis£d_”r
)

2564 
__ADD
(
RTNL_LINK_TX_ABORT_ERR
, 
tx_abÜt_”r
)

2565 
__ADD
(
RTNL_LINK_TX_CARRIER_ERR
, 
tx_ÿ¼›r_”r
)

2566 
__ADD
(
RTNL_LINK_TX_HBEAT_ERR
, 
tx_hb—t_”r
)

2567 
__ADD
(
RTNL_LINK_TX_WIN_ERR
, 
tx_wš_”r
)

2568 
__ADD
(
RTNL_LINK_COLLISIONS
, 
cŞlisiÚs
)

2569 
__ADD
(
RTNL_LINK_MULTICAST
, 
muÉiÿ¡
)

2570 
__ADD
(
RTNL_LINK_IP6_INPKTS
, 
Ip6InReûives
)

2571 
__ADD
(
RTNL_LINK_IP6_INHDRERRORS
, 
Ip6InHdrE¼Üs
)

2572 
__ADD
(
RTNL_LINK_IP6_INTOOBIGERRORS
, 
Ip6InTooBigE¼Üs
)

2573 
__ADD
(
RTNL_LINK_IP6_INNOROUTES
, 
Ip6InNoRou‹s
)

2574 
__ADD
(
RTNL_LINK_IP6_INADDRERRORS
, 
Ip6InAddrE¼Üs
)

2575 
__ADD
(
RTNL_LINK_IP6_INUNKNOWNPROTOS
, 
Ip6InUnknownPrÙos
)

2576 
__ADD
(
RTNL_LINK_IP6_INTRUNCATEDPKTS
, 
Ip6InTrunÿ‹dPkts
)

2577 
__ADD
(
RTNL_LINK_IP6_INDISCARDS
, 
Ip6InDisÿrds
)

2578 
__ADD
(
RTNL_LINK_IP6_INDELIVERS
, 
Ip6InD–iv”s
)

2579 
__ADD
(
RTNL_LINK_IP6_OUTFORWDATAGRAMS
, 
Ip6OutFÜwD©ag¿ms
)

2580 
__ADD
(
RTNL_LINK_IP6_OUTPKTS
, 
Ip6OutReque¡s
)

2581 
__ADD
(
RTNL_LINK_IP6_OUTDISCARDS
, 
Ip6OutDisÿrds
)

2582 
__ADD
(
RTNL_LINK_IP6_OUTNOROUTES
, 
Ip6OutNoRou‹s
)

2583 
__ADD
(
RTNL_LINK_IP6_REASMTIMEOUT
, 
Ip6R—smTimeout
)

2584 
__ADD
(
RTNL_LINK_IP6_REASMREQDS
, 
Ip6R—smReqds
)

2585 
__ADD
(
RTNL_LINK_IP6_REASMOKS
, 
Ip6R—smOKs
)

2586 
__ADD
(
RTNL_LINK_IP6_REASMFAILS
, 
Ip6R—smFas
)

2587 
__ADD
(
RTNL_LINK_IP6_FRAGOKS
, 
Ip6F¿gOKs
)

2588 
__ADD
(
RTNL_LINK_IP6_FRAGFAILS
, 
Ip6F¿gFas
)

2589 
__ADD
(
RTNL_LINK_IP6_FRAGCREATES
, 
Ip6F¿gC»©es
)

2590 
__ADD
(
RTNL_LINK_IP6_INMCASTPKTS
, 
Ip6InMÿ¡Pkts
)

2591 
__ADD
(
RTNL_LINK_IP6_OUTMCASTPKTS
, 
Ip6OutMÿ¡Pkts
)

2592 
__ADD
(
RTNL_LINK_IP6_INBCASTPKTS
, 
Ip6InBÿ¡Pkts
)

2593 
__ADD
(
RTNL_LINK_IP6_OUTBCASTPKTS
, 
Ip6OutBÿ¡Pkts
)

2594 
__ADD
(
RTNL_LINK_IP6_INOCTETS
, 
Ip6InOù‘s
)

2595 
__ADD
(
RTNL_LINK_IP6_OUTOCTETS
, 
Ip6OutOù‘s
)

2596 
__ADD
(
RTNL_LINK_IP6_INMCASTOCTETS
, 
Ip6InMÿ¡Où‘s
)

2597 
__ADD
(
RTNL_LINK_IP6_OUTMCASTOCTETS
, 
Ip6OutMÿ¡Où‘s
)

2598 
__ADD
(
RTNL_LINK_IP6_INBCASTOCTETS
, 
Ip6InBÿ¡Où‘s
)

2599 
__ADD
(
RTNL_LINK_IP6_OUTBCASTOCTETS
, 
Ip6OutBÿ¡Où‘s
)

2600 
__ADD
(
RTNL_LINK_ICMP6_INMSGS
, 
ICMP6_InMsgs
)

2601 
__ADD
(
RTNL_LINK_ICMP6_INERRORS
, 
ICMP6_InE¼Üs
)

2602 
__ADD
(
RTNL_LINK_ICMP6_OUTMSGS
, 
ICMP6_OutMsgs
)

2603 
__ADD
(
RTNL_LINK_ICMP6_OUTERRORS
, 
ICMP6_OutE¼Üs
)

2604 
__ADD
(
RTNL_LINK_ICMP6_CSUMERRORS
, 
ICMP6_InCsumE¼Üs
)

2605 
__ADD
(
RTNL_LINK_IP6_CSUMERRORS
, 
Ip6_InCsumE¼Üs
)

2606 
__ADD
(
RTNL_LINK_IP6_NOECTPKTS
, 
Ip6_InNoECTPkts
)

2607 
__ADD
(
RTNL_LINK_IP6_ECT1PKTS
, 
Ip6_InECT1Pkts
)

2608 
__ADD
(
RTNL_LINK_IP6_ECT0PKTS
, 
Ip6_InECT0Pkts
)

2609 
__ADD
(
RTNL_LINK_IP6_CEPKTS
, 
Ip6_InCEPkts
)

2612 *
	$¹Æ_lšk_¡©2¡r
(
¡
, *
buf
, 
size_t
 
Ën
)

2614  
	`__ty³2¡r
(
¡
, 
buf
, 
Ën
, 
lšk_¡©s
, 
	`ARRAY_SIZE
(link_stats));

2615 
	}
}

2617 
	$¹Æ_lšk_¡r2¡©
(cÚ¡ *
Çme
)

2619  
	`__¡r2ty³
(
Çme
, 
lšk_¡©s
, 
	`ARRAY_SIZE
(link_stats));

2620 
	}
}

2622 cÚ¡ 
Œªs_tbl
 
	glšk_İ”¡©es
[] = {

2623 
__ADD
(
IF_OPER_UNKNOWN
, 
unknown
)

2624 
__ADD
(
IF_OPER_NOTPRESENT
, 
nÙ´e£Á
)

2625 
__ADD
(
IF_OPER_DOWN
, 
down
)

2626 
__ADD
(
IF_OPER_LOWERLAYERDOWN
, 
low”Ïy”down
)

2627 
__ADD
(
IF_OPER_TESTING
, 
‹¡šg
)

2628 
__ADD
(
IF_OPER_DORMANT
, 
dÜmªt
)

2629 
__ADD
(
IF_OPER_UP
, 
up
)

2632 *
	$¹Æ_lšk_İ”¡©e2¡r
(
ušt8_t
 
¡
, *
buf
, 
size_t
 
Ën
)

2634  
	`__ty³2¡r
(
¡
, 
buf
, 
Ën
, 
lšk_İ”¡©es
,

2635 
	`ARRAY_SIZE
(
lšk_İ”¡©es
));

2636 
	}
}

2638 
	$¹Æ_lšk_¡r2İ”¡©e
(cÚ¡ *
Çme
)

2640  
	`__¡r2ty³
(
Çme
, 
lšk_İ”¡©es
,

2641 
	`ARRAY_SIZE
(
lšk_İ”¡©es
));

2642 
	}
}

2644 cÚ¡ 
Œªs_tbl
 
	glšk_modes
[] = {

2645 
__ADD
(
IF_LINK_MODE_DEFAULT
, )

2646 
__ADD
(
IF_LINK_MODE_DORMANT
, 
dÜmªt
)

2649 cÚ¡ 
Œªs_tbl
 
	gÿ¼›r_¡©es
[] = {

2650 
__ADD
(
IF_CARRIER_DOWN
, 
down
)

2651 
__ADD
(
IF_CARRIER_UP
, 
up
)

2654 *
	$¹Æ_lšk_mode2¡r
(
ušt8_t
 
¡
, *
buf
, 
size_t
 
Ën
)

2656  
	`__ty³2¡r
(
¡
, 
buf
, 
Ën
, 
lšk_modes
, 
	`ARRAY_SIZE
(link_modes));

2657 
	}
}

2659 
	$¹Æ_lšk_¡r2mode
(cÚ¡ *
Çme
)

2661  
	`__¡r2ty³
(
Çme
, 
lšk_modes
, 
	`ARRAY_SIZE
(link_modes));

2662 
	}
}

2664 *
	$¹Æ_lšk_ÿ¼›r2¡r
(
ušt8_t
 
¡
, *
buf
, 
size_t
 
Ën
)

2666  
	`__ty³2¡r
(
¡
, 
buf
, 
Ën
, 
ÿ¼›r_¡©es
,

2667 
	`ARRAY_SIZE
(
ÿ¼›r_¡©es
));

2668 
	}
}

2670 
	$¹Æ_lšk_¡r2ÿ¼›r
(cÚ¡ *
Çme
)

2672  
	`__¡r2ty³
(
Çme
, 
ÿ¼›r_¡©es
, 
	`ARRAY_SIZE
(carrier_states));

2673 
	}
}

2684 
	$¹Æ_lšk_£t_šfo_ty³
(
¹Æ_lšk
 *
lšk
, cÚ¡ *
ty³
)

2686  
	`¹Æ_lšk_£t_ty³
(
lšk
, 
ty³
);

2687 
	}
}

2692 *
	$¹Æ_lšk_g‘_šfo_ty³
(
¹Æ_lšk
 *
lšk
)

2694  
	`¹Æ_lšk_g‘_ty³
(
lšk
);

2695 
	}
}

2700 
	$¹Æ_lšk_£t_weight
(
¹Æ_lšk
 *
lšk
, 
weight
)

2702 
lšk
->
l_weight
 = 
weight
;

2703 
lšk
->
û_mask
 |ğ
LINK_ATTR_WEIGHT
;

2704 
	}
}

2709 
	$¹Æ_lšk_g‘_weight
(
¹Æ_lšk
 *
lšk
)

2711  
lšk
->
l_weight
;

2712 
	}
}

2716 
Æ_objeù_İs
 
	glšk_obj_İs
 = {

2717 .
oo_Çme
 = "route/link",

2718 .
	goo_size
 = (
¹Æ_lšk
),

2719 .
	goo_ä“_d©a
 = 
lšk_ä“_d©a
,

2720 .
	goo_şÚe
 = 
lšk_şÚe
,

2721 .
	goo_dump
 = {

2722 [
NL_DUMP_LINE
] = 
lšk_dump_lše
,

2723 [
NL_DUMP_DETAILS
] = 
lšk_dump_d‘as
,

2724 [
NL_DUMP_STATS
] = 
lšk_dump_¡©s
,

2726 .
	goo_com·»
 = 
lšk_com·»
,

2727 .
	goo_keyg’
 = 
lšk_keyg’
,

2728 .
	goo_©Œs2¡r
 = 
lšk_©Œs2¡r
,

2729 .
	goo_id_©Œs
 = 
LINK_ATTR_IFINDEX
 | 
LINK_ATTR_FAMILY
,

2732 
Æ_af_group
 
	glšk_groups
[] = {

2733 { 
AF_UNSPEC
, 
RTNLGRP_LINK
 },

2734 { 
AF_BRIDGE
, 
RTNLGRP_LINK
 },

2735 { 
END_OF_GROUP_LIST
 },

2738 
Æ_ÿche_İs
 
	g¹Æ_lšk_İs
 = {

2739 .
co_Çme
 = "route/link",

2740 .
	gco_hdrsize
 = (
ifšfomsg
),

2741 .
	gco_msgty³s
 = {

2742 { 
RTM_NEWLINK
, 
NL_ACT_NEW
, "new" },

2743 { 
RTM_DELLINK
, 
NL_ACT_DEL
, "del" },

2744 { 
RTM_GETLINK
, 
NL_ACT_GET
, "get" },

2745 { 
RTM_SETLINK
, 
NL_ACT_CHANGE
, "set" },

2746 
END_OF_MSGTYPES_LIST
,

2748 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

2749 .
	gco_groups
 = 
lšk_groups
,

2750 .
	gco_»que¡_upd©e
 = 
lšk_»que¡_upd©e
,

2751 .
	gco_msg_·r£r
 = 
lšk_msg_·r£r
,

2752 .
	gco_obj_İs
 = &
lšk_obj_İs
,

2755 
__š™
 
	$lšk_š™
()

2757 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_lšk_İs
);

2758 
	}
}

2760 
__ex™
 
	$lšk_ex™
()

2762 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_lšk_İs
);

2763 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/api.c

42 
	~<Ãšk-´iv©e/Ãšk.h
>

43 
	~<Ãšk/Ãšk.h
>

44 
	~<Ãšk/uts.h
>

45 
	~<Ãšk/rou‹/lšk.h
>

46 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

48 
NL_LIST_HEAD
(
šfo_İs
);

51 
NL_RW_LOCK
(
šfo_lock
);

53 
¹Æ_lšk_šfo_İs
 *
	$__¹Æ_lšk_šfo_İs_lookup
(cÚ¡ *
Çme
)

55 
¹Æ_lšk_šfo_İs
 *
İs
;

57 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
šfo_İs
, 
io_li¡
)

58 ià(!
	`¡rcmp
(
İs
->
io_Çme
, 
Çme
))

59  
İs
;

61  
NULL
;

62 
	}
}

77 
¹Æ_lšk_šfo_İs
 *
	$¹Æ_lšk_šfo_İs_lookup
(cÚ¡ *
Çme
)

79 
¹Æ_lšk_šfo_İs
 *
İs
;

81 
	`Æ_wr™e_lock
(&
šfo_lock
);

82 ià((
İs
 = 
	`__¹Æ_lšk_šfo_İs_lookup
(
Çme
)))

83 
İs
->
io_»fút
++;

84 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

86  
İs
;

87 
	}
}

93 
	$¹Æ_lšk_šfo_İs_put
(
¹Æ_lšk_šfo_İs
 *
İs
)

95 ià(
İs
)

96 
İs
->
io_»fút
--;

97 
	}
}

111 
	$¹Æ_lšk_»gi¡”_šfo
(
¹Æ_lšk_šfo_İs
 *
İs
)

113 
”r
 = 0;

115 ià(
İs
->
io_Çme
 =ğ
NULL
)

116  -
NLE_INVAL
;

118 
	`Æ_wr™e_lock
(&
šfo_lock
);

119 ià(
	`__¹Æ_lšk_šfo_İs_lookup
(
İs
->
io_Çme
)) {

120 
”r
 = -
NLE_EXIST
;

121 
”rout
;

124 
	`NL_DBG
(1, "Regi¡”ed†šk infØİ”©iÚ %s\n", 
İs
->
io_Çme
);

126 
	`Æ_li¡_add_
(&
İs
->
io_li¡
, &
šfo_İs
);

127 
”rout
:

128 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

130  
”r
;

131 
	}
}

146 
	$¹Æ_lšk_uÄegi¡”_šfo
(
¹Æ_lšk_šfo_İs
 *
İs
)

148 
¹Æ_lšk_šfo_İs
 *
t
;

149 
”r
 = -
NLE_OPNOTSUPP
;

151 
	`Æ_wr™e_lock
(&
šfo_lock
);

153 
	`Æ_li¡_fÜ_—ch_’Œy
(
t
, &
šfo_İs
, 
io_li¡
) {

154 ià(
t
 =ğ
İs
) {

155 ià(
t
->
io_»fút
 > 0) {

156 
”r
 = -
NLE_BUSY
;

157 
”rout
;

160 
	`Æ_li¡_d–
(&
t
->
io_li¡
);

162 
	`NL_DBG
(1, "Unregistered†ink info operations %s\n",

163 
İs
->
io_Çme
);

164 
”r
 = 0;

165 
”rout
;

169 
”rout
:

170 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

172  
”r
;

173 
	}
}

182 
¹Æ_lšk_af_İs
 *
	gaf_İs
[
AF_MAX
];

192 
¹Æ_lšk_af_İs
 *
	$¹Æ_lšk_af_İs_lookup
(cÚ¡ 
çmy
)

194 ià(
çmy
 =ğ
AF_UNSPEC
 || famy >ğ
AF_MAX
)

195  
NULL
;

197 
	`Æ_wr™e_lock
(&
šfo_lock
);

198 ià(
af_İs
[
çmy
])

199 
af_İs
[
çmy
]->
ao_»fút
++;

200 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

202  
af_İs
[
çmy
];

203 
	}
}

209 
	$¹Æ_lšk_af_İs_put
(
¹Æ_lšk_af_İs
 *
İs
)

211 ià(
İs
)

212 
İs
->
ao_»fút
--;

213 
	}
}

229 *
	$¹Æ_lšk_af_®loc
(
¹Æ_lšk
 *
lšk
,

230 cÚ¡ 
¹Æ_lšk_af_İs
 *
İs
)

232 
çmy
;

234 ià(!
lšk
 || !
İs
)

235 
	`BUG
();

237 
çmy
 = 
İs
->
ao_çmy
;

239 ià(!
lšk
->
l_af_d©a
[
çmy
]) {

240 ià(!
İs
->
ao_®loc
)

241 
	`BUG
();

243 
lšk
->
l_af_d©a
[
çmy
] = 
İs
->
	`ao_®loc
(link);

244 ià(!
lšk
->
l_af_d©a
[
çmy
])

245  
NULL
;

248  
lšk
->
l_af_d©a
[
çmy
];

249 
	}
}

264 *
	$¹Æ_lšk_af_d©a
(cÚ¡ 
¹Æ_lšk
 *
lšk
,

265 cÚ¡ 
¹Æ_lšk_af_İs
 *
İs
)

267 ià(!
lšk
 || !
İs
)

268 
	`BUG
();

270  
lšk
->
l_af_d©a
[
İs
->
ao_çmy
];

271 
	}
}

285 
	$¹Æ_lšk_af_»gi¡”
(
¹Æ_lšk_af_İs
 *
İs
)

287 
”r
 = 0;

289 ià(
İs
->
ao_çmy
 =ğ
AF_UNSPEC
 || ops->ao_çmy >ğ
AF_MAX
)

290  -
NLE_INVAL
;

292 
	`Æ_wr™e_lock
(&
šfo_lock
);

293 ià(
af_İs
[
İs
->
ao_çmy
]) {

294 
”r
 = -
NLE_EXIST
;

295 
”rout
;

298 
İs
->
ao_»fút
 = 0;

299 
af_İs
[
İs
->
ao_çmy
] = ops;

301 
	`NL_DBG
(1, "Registered†ink‡ddress family operations %u\n",

302 
İs
->
ao_çmy
);

304 
”rout
:

305 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

307  
”r
;

308 
	}
}

324 
	$¹Æ_lšk_af_uÄegi¡”
(
¹Æ_lšk_af_İs
 *
İs
)

326 
”r
 = -
NLE_INVAL
;

328 ià(!
İs
)

329  
”r
;

331 
	`Æ_wr™e_lock
(&
šfo_lock
);

332 ià(!
af_İs
[
İs
->
ao_çmy
]) {

333 
”r
 = -
NLE_OBJ_NOTFOUND
;

334 
”rout
;

337 ià(
İs
->
ao_»fút
 > 0) {

338 
”r
 = -
NLE_BUSY
;

339 
”rout
;

342 
af_İs
[
İs
->
ao_çmy
] = 
NULL
;

344 
	`NL_DBG
(1, "Unregistered†ink‡ddress family operations %u\n",

345 
İs
->
ao_çmy
);

347 
”rout
:

348 
	`Æ_wr™e_uÆock
(&
šfo_lock
);

350  
”r
;

351 
	}
}

365 
	$¹Æ_lšk_af_d©a_com·»
(
¹Æ_lšk
 *
a
, ¹Æ_lšk *
b
,

366 
çmy
)

368 
¹Æ_lšk_af_İs
 *
af_İs
;

369 
»t
 = 0;

371 ià(!
a
->
l_af_d©a
[
çmy
] && !
b
->l_af_data[family])

374 ià(!
a
->
l_af_d©a
[
çmy
] || !
b
->l_af_data[family])

377 
af_İs
 = 
	`¹Æ_lšk_af_İs_lookup
(
çmy
);

378 ià(!
af_İs
)

381 ià(
af_İs
->
ao_com·»
 =ğ
NULL
) {

382 
»t
 = ~0;

383 
out
;

386 
»t
 = 
af_İs
->
	`ao_com·»
(
a
, 
b
, 
çmy
, ~0, 0);

388 
out
:

389 
	`¹Æ_lšk_af_İs_put
(
af_İs
);

391  
»t
;

392 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/bonding.c

23 
	~<Ãšk-´iv©e/Ãšk.h
>

24 
	~<Ãšk/Ãšk.h
>

25 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
¹Æ_lšk
 *
	$¹Æ_lšk_bÚd_®loc
()

34 
¹Æ_lšk
 *
lšk
;

35 
”r
;

37 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

38  
NULL
;

40 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "bond")) < 0) {

41 
	`¹Æ_lšk_put
(
lšk
);

42  
NULL
;

45  
lšk
;

46 
	}
}

72 
	$¹Æ_lšk_bÚd_add
(
Æ_sock
 *
sock
, cÚ¡ *
Çme
,

73 
¹Æ_lšk
 *
İts
)

75 
¹Æ_lšk
 *
lšk
;

76 
”r
;

78 ià(!(
lšk
 = 
	`¹Æ_lšk_bÚd_®loc
()))

79  -
NLE_NOMEM
;

81 ià(!
Çme
 && 
İts
)

82 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
İts
);

84 ià(
Çme
)

85 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

87 
”r
 = 
	`¹Æ_lšk_add
(
sock
, 
lšk
, 
NLM_F_CREATE
);

89 
	`¹Æ_lšk_put
(
lšk
);

91  
”r
;

92 
	}
}

107 
	$¹Æ_lšk_bÚd_’¦ave_ifšdex
(
Æ_sock
 *
sock
, 
ma¡”
,

108 
¦ave
)

110 
¹Æ_lšk
 *
lšk
;

111 
”r
;

113 ià(!(
lšk
 = 
	`¹Æ_lšk_bÚd_®loc
()))

114  -
NLE_NOMEM
;

116 
	`¹Æ_lšk_£t_ifšdex
(
lšk
, 
¦ave
);

117 
	`¹Æ_lšk_£t_ma¡”
(
lšk
, 
ma¡”
);

119 ià((
”r
 = 
	`¹Æ_lšk_chªge
(
sock
, 
lšk
,†ink, 0)) < 0)

120 
”rout
;

122 
	`¹Æ_lšk_put
(
lšk
);

131 ià((
”r
 = 
	`¹Æ_lšk_g‘_k”Ãl
(
sock
, 
¦ave
, 
NULL
, &
lšk
)) < 0)

132  
”r
;

134 ià(
	`¹Æ_lšk_g‘_ma¡”
(
lšk
è!ğ
ma¡”
)

135 
”r
 = -
NLE_OPNOTSUPP
;

137 
”rout
:

138 
	`¹Æ_lšk_put
(
lšk
);

140  
”r
;

141 
	}
}

163 
	$¹Æ_lšk_bÚd_’¦ave
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
ma¡”
,

164 
¹Æ_lšk
 *
¦ave
)

166  
	`¹Æ_lšk_bÚd_’¦ave_ifšdex
(
sock
,

167 
	`¹Æ_lšk_g‘_ifšdex
(
ma¡”
),

168 
	`¹Æ_lšk_g‘_ifšdex
(
¦ave
));

169 
	}
}

183 
	$¹Æ_lšk_bÚd_»Ëa£_ifšdex
(
Æ_sock
 *
sock
, 
¦ave
)

185  
	`¹Æ_lšk_bÚd_’¦ave_ifšdex
(
sock
, 0, 
¦ave
);

186 
	}
}

207 
	$¹Æ_lšk_bÚd_»Ëa£
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¦ave
)

209  
	`¹Æ_lšk_bÚd_»Ëa£_ifšdex
(
sock
,

210 
	`¹Æ_lšk_g‘_ifšdex
(
¦ave
));

211 
	}
}

213 
¹Æ_lšk_šfo_İs
 
	gbÚdšg_šfo_İs
 = {

214 .
io_Çme
 = "bond",

217 
__š™
 
	$bÚdšg_š™
()

219 
	`¹Æ_lšk_»gi¡”_šfo
(&
bÚdšg_šfo_İs
);

220 
	}
}

222 
__ex™
 
	$bÚdšg_ex™
()

224 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
bÚdšg_šfo_İs
);

225 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/bridge.c

20 
	~<Ãšk-´iv©e/Ãšk.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/©Œ.h
>

23 
	~<Ãšk/rou‹/¹Æ.h
>

24 
	~<Ãšk/rou‹/lšk/bridge.h
>

25 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

26 
	~<lšux/if_bridge.h
>

29 
	#BRIDGE_ATTR_PORT_STATE
 (1 << 0)

	)

30 
	#BRIDGE_ATTR_PRIORITY
 (1 << 1)

	)

31 
	#BRIDGE_ATTR_COST
 (1 << 2)

	)

32 
	#BRIDGE_ATTR_FLAGS
 (1 << 3)

	)

34 
	#PRIV_FLAG_NEW_ATTRS
 (1 << 0)

	)

36 
	sbridge_d©a


38 
ušt8_t
 
	mb_pÜt_¡©e
;

39 
ušt8_t
 
	mb_´iv_æags
;

40 
ušt16_t
 
	mb_´iÜ™y
;

41 
ušt32_t
 
	mb_co¡
;

42 
ušt32_t
 
	mb_æags
;

43 
ušt32_t
 
	mb_æags_mask
;

44 
ušt32_t
 
	mû_mask
;

47 
¹Æ_lšk_af_İs
 
	gbridge_İs
;

49 
	#IS_BRIDGE_LINK_ASSERT
(
lšk
) \

50 ià(!
	`¹Æ_lšk_is_bridge
(
lšk
)) { \

51 
	`APPBUG
("A function wasƒxpecting‡†ink object ofype bridge."); \

52  -
NLE_OPNOTSUPP
; \

53 }

	)

55 
šlše
 
bridge_d©a
 *
	$bridge_d©a
(
¹Æ_lšk
 *
lšk
)

57  
	`¹Æ_lšk_af_d©a
(
lšk
, &
bridge_İs
);

58 
	}
}

60 *
	$bridge_®loc
(
¹Æ_lšk
 *
lšk
)

62  
	`ÿÎoc
(1, (
bridge_d©a
));

63 
	}
}

65 *
	$bridge_şÚe
(
¹Æ_lšk
 *
lšk
, *
d©a
)

67 
bridge_d©a
 *
bd
;

69 ià((
bd
 = 
	`bridge_®loc
(
lšk
)))

70 
	`memıy
(
bd
, 
d©a
, (*bd));

72  
bd
;

73 
	}
}

75 
	$bridge_ä“
(
¹Æ_lšk
 *
lšk
, *
d©a
)

77 
	`ä“
(
d©a
);

78 
	}
}

80 
Æa_pŞicy
 
	gbr_©Œs_pŞicy
[
IFLA_BRPORT_MAX
+1] = {

81 [
IFLA_BRPORT_STATE
] = { .
ty³
 = 
NLA_U8
 },

82 [
IFLA_BRPORT_PRIORITY
] = { .
ty³
 = 
NLA_U16
 },

83 [
IFLA_BRPORT_COST
] = { .
ty³
 = 
NLA_U32
 },

84 [
IFLA_BRPORT_MODE
] = { .
ty³
 = 
NLA_U8
 },

85 [
IFLA_BRPORT_GUARD
] = { .
ty³
 = 
NLA_U8
 },

86 [
IFLA_BRPORT_PROTECT
] = { .
ty³
 = 
NLA_U8
 },

87 [
IFLA_BRPORT_FAST_LEAVE
] = { .
ty³
 = 
NLA_U8
 },

90 
	$check_æag
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
©Œs
[],

91 
ty³
, 
æag
)

93 ià(
©Œs
[
ty³
] && 
	`Æa_g‘_u8
(attrs[type]))

94 
	`¹Æ_lšk_bridge_£t_æags
(
lšk
, 
æag
);

95 
	}
}

97 
	$bridge_·r£_´Ùšfo
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
©Œ
,

98 *
d©a
)

100 
bridge_d©a
 *
bd
 = 
d©a
;

101 
Æ©Œ
 *
br_©Œs
[
IFLA_BRPORT_MAX
+1];

102 
”r
;

105 ià(!
	`Æa_is_Ã¡ed
(
©Œ
)) {

106 ià(
	`Æa_Ën
(
©Œ
) < 1)

107  -
NLE_RANGE
;

109 
bd
->
b_pÜt_¡©e
 = 
	`Æa_g‘_u8
(
©Œ
);

110 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_PORT_STATE
;

115 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
br_©Œs
, 
IFLA_BRPORT_MAX
, 
©Œ
,

116 
br_©Œs_pŞicy
)) < 0)

117  
”r
;

119 
bd
->
b_´iv_æags
 |ğ
PRIV_FLAG_NEW_ATTRS
;

121 ià(
br_©Œs
[
IFLA_BRPORT_STATE
]) {

122 
bd
->
b_pÜt_¡©e
 = 
	`Æa_g‘_u8
(
br_©Œs
[
IFLA_BRPORT_STATE
]);

123 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_PORT_STATE
;

126 ià(
br_©Œs
[
IFLA_BRPORT_PRIORITY
]) {

127 
bd
->
b_´iÜ™y
 = 
	`Æa_g‘_u16
(
br_©Œs
[
IFLA_BRPORT_PRIORITY
]);

128 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_PRIORITY
;

131 ià(
br_©Œs
[
IFLA_BRPORT_COST
]) {

132 
bd
->
b_co¡
 = 
	`Æa_g‘_u32
(
br_©Œs
[
IFLA_BRPORT_COST
]);

133 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_COST
;

136 
	`check_æag
(
lšk
, 
br_©Œs
, 
IFLA_BRPORT_MODE
, 
RTNL_BRIDGE_HAIRPIN_MODE
);

137 
	`check_æag
(
lšk
, 
br_©Œs
, 
IFLA_BRPORT_GUARD
, 
RTNL_BRIDGE_BPDU_GUARD
);

138 
	`check_æag
(
lšk
, 
br_©Œs
, 
IFLA_BRPORT_PROTECT
, 
RTNL_BRIDGE_ROOT_BLOCK
);

139 
	`check_æag
(
lšk
, 
br_©Œs
, 
IFLA_BRPORT_FAST_LEAVE
, 
RTNL_BRIDGE_FAST_LEAVE
);

142 
	}
}

144 
	$bridge_dump_d‘as
(
¹Æ_lšk
 *
lšk
,

145 
Æ_dump_·¿ms
 *
p
, *
d©a
)

147 
bridge_d©a
 *
bd
 = 
d©a
;

149 
	`Æ_dump_lše
(
p
, " bridge: ");

151 ià(
bd
->
û_mask
 & 
BRIDGE_ATTR_PORT_STATE
)

152 
	`Æ_dump
(
p
, "pÜt-¡©%u ", 
bd
->
b_pÜt_¡©e
);

154 ià(
bd
->
û_mask
 & 
BRIDGE_ATTR_PRIORITY
)

155 
	`Æ_dump
(
p
, "´iØ%u ", 
bd
->
b_´iÜ™y
);

157 ià(
bd
->
û_mask
 & 
BRIDGE_ATTR_COST
)

158 
	`Æ_dump
(
p
, "co¡ %u ", 
bd
->
b_co¡
);

160 
	`Æ_dump
(
p
, "\n");

161 
	}
}

163 
	$bridge_com·»
(
¹Æ_lšk
 *
_a
, ¹Æ_lšk *
_b
,

164 
çmy
, 
ušt32_t
 
©Œs
, 
æags
)

166 
bridge_d©a
 *
a
 = 
	`bridge_d©a
(
_a
);

167 
bridge_d©a
 *
b
 = 
	`bridge_d©a
(
_b
);

168 
diff
 = 0;

170 
	#BRIDGE_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
BRIDGE_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

171 
diff
 |ğ
	`BRIDGE_DIFF
(
PORT_STATE
, 
a
->
b_pÜt_¡©e
 !ğ
b
->b_port_state);

172 
diff
 |ğ
	`BRIDGE_DIFF
(
PRIORITY
, 
a
->
b_´iÜ™y
 !ğ
b
->b_priority);

173 
diff
 |ğ
	`BRIDGE_DIFF
(
COST
, 
a
->
b_co¡
 !ğ
b
->b_cost);

175 ià(
æags
 & 
LOOSE_COMPARISON
)

176 
diff
 |ğ
	`BRIDGE_DIFF
(
FLAGS
,

177 (
a
->
b_æags
 ^ 
b
->b_æagsè& b->
b_æags_mask
);

179 
diff
 |ğ
	`BRIDGE_DIFF
(
FLAGS
, 
a
->
b_æags
 !ğ
b
->b_flags);

180 #undeà
BRIDGE_DIFF


182  
diff
;

183 
	}
}

191 
¹Æ_lšk
 *
	$¹Æ_lšk_bridge_®loc
()

193 
¹Æ_lšk
 *
lšk
;

194 
”r
;

196 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

197  
NULL
;

199 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "bridge")) < 0) {

200 
	`¹Æ_lšk_put
(
lšk
);

201  
NULL
;

204  
lšk
;

205 
	}
}

218 
	$¹Æ_lšk_bridge_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

220 
”r
;

221 
¹Æ_lšk
 *
lšk
;

223 ià(!(
lšk
 = 
	`¹Æ_lšk_bridge_®loc
()))

224  -
NLE_NOMEM
;

226 if(
Çme
)

227 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

229 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

230 
	`¹Æ_lšk_put
(
lšk
);

232  
”r
;

233 
	}
}

241 
	$¹Æ_lšk_is_bridge
(
¹Æ_lšk
 *
lšk
)

243  
lšk
->
l_çmy
 =ğ
AF_BRIDGE
 &&

244 
lšk
->
l_af_İs
 =ğ&
bridge_İs
;

245 
	}
}

260 
	$¹Æ_lšk_bridge_has_ext_šfo
(
¹Æ_lšk
 *
lšk
)

262 
bridge_d©a
 *
bd
;

264 ià(!
	`¹Æ_lšk_is_bridge
(
lšk
))

267 
bd
 = 
	`bridge_d©a
(
lšk
);

268  !!(
bd
->
b_´iv_æags
 & 
PRIV_FLAG_NEW_ATTRS
);

269 
	}
}

289 
	$¹Æ_lšk_bridge_£t_pÜt_¡©e
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
¡©e
)

291 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

293 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

295 ià(
¡©e
 > 
BR_STATE_BLOCKING
)

296  -
NLE_INVAL
;

298 
bd
->
b_pÜt_¡©e
 = 
¡©e
;

299 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_PORT_STATE
;

302 
	}
}

313 
	$¹Æ_lšk_bridge_g‘_pÜt_¡©e
(
¹Æ_lšk
 *
lšk
)

315 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

317 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

319  
bd
->
b_pÜt_¡©e
;

320 
	}
}

332 
	$¹Æ_lšk_bridge_£t_´iÜ™y
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
´io
)

334 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

336 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

338 
bd
->
b_´iÜ™y
 = 
´io
;

339 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_PRIORITY
;

342 
	}
}

353 
	$¹Æ_lšk_bridge_g‘_´iÜ™y
(
¹Æ_lšk
 *
lšk
)

355 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

357 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

359  
bd
->
b_´iÜ™y
;

360 
	}
}

372 
	$¹Æ_lšk_bridge_£t_co¡
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
co¡
)

374 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

376 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

378 
bd
->
b_co¡
 = 
co¡
;

379 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_COST
;

382 
	}
}

395 
	$¹Æ_lšk_bridge_g‘_co¡
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
co¡
)

397 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

399 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

401 ià(!
co¡
)

402  -
NLE_INVAL
;

404 *
co¡
 = 
bd
->
b_co¡
;

407 
	}
}

420 
	$¹Æ_lšk_bridge_un£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

422 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

424 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

426 
bd
->
b_æags_mask
 |ğ
æags
;

427 
bd
->
b_æags
 &ğ~
æags
;

428 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_FLAGS
;

431 
	}
}

450 
	$¹Æ_lšk_bridge_£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

452 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

454 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

456 
bd
->
b_æags_mask
 |ğ
æags
;

457 
bd
->
b_æags
 |ğ
æags
;

458 
bd
->
û_mask
 |ğ
BRIDGE_ATTR_FLAGS
;

461 
	}
}

473 
	$¹Æ_lšk_bridge_g‘_æags
(
¹Æ_lšk
 *
lšk
)

475 
bridge_d©a
 *
bd
 = 
	`bridge_d©a
(
lšk
);

477 
	`IS_BRIDGE_LINK_ASSERT
(
lšk
);

479  
bd
->
b_æags
;

480 
	}
}

482 cÚ¡ 
Œªs_tbl
 
	gbridge_æags
[] = {

483 
__ADD
(
RTNL_BRIDGE_HAIRPIN_MODE
, 
haœpš_mode
)

484 
__ADD
(
RTNL_BRIDGE_BPDU_GUARD
, 
bpdu_gu¬d
)

485 
__ADD
(
RTNL_BRIDGE_ROOT_BLOCK
, 
roÙ_block
)

486 
__ADD
(
RTNL_BRIDGE_FAST_LEAVE
, 
ç¡_Ëave
)

494 *
	$¹Æ_lšk_bridge_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

496  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
bridge_æags
, 
	`ARRAY_SIZE
(bridge_flags));

497 
	}
}

499 
	$¹Æ_lšk_bridge_¡r2æags
(cÚ¡ *
Çme
)

501  
	`__¡r2æags
(
Çme
, 
bridge_æags
, 
	`ARRAY_SIZE
(bridge_flags));

502 
	}
}

506 
¹Æ_lšk_af_İs
 
	gbridge_İs
 = {

507 .
ao_çmy
 = 
AF_BRIDGE
,

508 .
	gao_®loc
 = &
bridge_®loc
,

509 .
	gao_şÚe
 = &
bridge_şÚe
,

510 .
	gao_ä“
 = &
bridge_ä“
,

511 .
	gao_·r£_´Ùšfo
 = &
bridge_·r£_´Ùšfo
,

512 .
	gao_dump
[
NL_DUMP_DETAILS
] = &
bridge_dump_d‘as
,

513 .
	gao_com·»
 = &
bridge_com·»
,

516 
__š™
 
	$bridge_š™
()

518 
	`¹Æ_lšk_af_»gi¡”
(&
bridge_İs
);

519 
	}
}

521 
__ex™
 
	$bridge_ex™
()

523 
	`¹Æ_lšk_af_uÄegi¡”
(&
bridge_İs
);

524 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/can.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<Ãšk/rou‹/lšk/ÿn.h
>

34 
	~<lšux/ÿn/Ãšk.h
>

37 
	#CAN_HAS_BITTIMING
 (1<<0)

	)

38 
	#CAN_HAS_BITTIMING_CONST
 (1<<1)

	)

39 
	#CAN_HAS_CLOCK
 (1<<2)

	)

40 
	#CAN_HAS_STATE
 (1<<3)

	)

41 
	#CAN_HAS_CTRLMODE
 (1<<4)

	)

42 
	#CAN_HAS_RESTART_MS
 (1<<5)

	)

43 
	#CAN_HAS_RESTART
 (1<<6)

	)

44 
	#CAN_HAS_BERR_COUNTER
 (1<<7)

	)

46 
	sÿn_šfo
 {

47 
ušt32_t
 
	mci_¡©e
;

48 
ušt32_t
 
	mci_»¡¬t
;

49 
ušt32_t
 
	mci_»¡¬t_ms
;

50 
ÿn_ù¾mode
 
	mci_ù¾mode
;

51 
ÿn_b™timšg
 
	mci_b™timšg
;

52 
ÿn_b™timšg_cÚ¡
 
	mci_b™timšg_cÚ¡
;

53 
ÿn_şock
 
	mci_şock
;

54 
ÿn_b”r_couÁ”
 
	mci_b”r_couÁ”
;

55 
ušt32_t
 
	mci_mask
;

60 
Æa_pŞicy
 
	gÿn_pŞicy
[
IFLA_CAN_MAX
 + 1] = {

61 [
IFLA_CAN_STATE
] = { .
ty³
 = 
NLA_U32
 },

62 [
IFLA_CAN_CTRLMODE
] = { .
mšËn
 = (
ÿn_ù¾mode
) },

63 [
IFLA_CAN_RESTART_MS
] = { .
ty³
 = 
NLA_U32
 },

64 [
IFLA_CAN_RESTART
] = { .
ty³
 = 
NLA_U32
 },

65 [
IFLA_CAN_BITTIMING
] = { .
mšËn
 = (
ÿn_b™timšg
) },

66 [
IFLA_CAN_BITTIMING_CONST
]

67 ğ{ .
mšËn
 = (
ÿn_b™timšg_cÚ¡
) },

68 [
IFLA_CAN_CLOCK
] = { .
mšËn
 = (
ÿn_şock
) },

69 [
IFLA_CAN_BERR_COUNTER
] = { .
mšËn
 = (
ÿn_b”r_couÁ”
) },

72 
	$ÿn_®loc
(
¹Æ_lšk
 *
lšk
)

74 
ÿn_šfo
 *
ci
;

76 
ci
 = 
	`ÿÎoc
(1, (*ci));

77 ià(!
ci
)

78  -
NLE_NOMEM
;

80 
lšk
->
l_šfo
 = 
ci
;

83 
	}
}

85 
	$ÿn_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

86 
Æ©Œ
 *
x¡©s
)

88 
Æ©Œ
 *
tb
[
IFLA_CAN_MAX
+1];

89 
ÿn_šfo
 *
ci
;

90 
”r
;

92 
	`NL_DBG
(3, "Parsing CAN†ink info");

94 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_CAN_MAX
, 
d©a
, 
ÿn_pŞicy
)) < 0)

95 
”rout
;

97 ià((
”r
 = 
	`ÿn_®loc
(
lšk
)) < 0)

98 
”rout
;

100 
ci
 = 
lšk
->
l_šfo
;

102 ià(
tb
[
IFLA_CAN_STATE
]) {

103 
ci
->
ci_¡©e
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_CAN_STATE
]);

104 
ci
->
ci_mask
 |ğ
CAN_HAS_STATE
;

107 ià(
tb
[
IFLA_CAN_RESTART
]) {

108 
ci
->
ci_»¡¬t
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_CAN_RESTART
]);

109 
ci
->
ci_mask
 |ğ
CAN_HAS_RESTART
;

112 ià(
tb
[
IFLA_CAN_RESTART_MS
]) {

113 
ci
->
ci_»¡¬t_ms
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_CAN_RESTART_MS
]);

114 
ci
->
ci_mask
 |ğ
CAN_HAS_RESTART_MS
;

117 ià(
tb
[
IFLA_CAN_CTRLMODE
]) {

118 
	`Æa_memıy
(&
ci
->
ci_ù¾mode
, 
tb
[
IFLA_CAN_CTRLMODE
],

119 (
ci
->
ci_ù¾mode
));

120 
ci
->
ci_mask
 |ğ
CAN_HAS_CTRLMODE
;

123 ià(
tb
[
IFLA_CAN_BITTIMING
]) {

124 
	`Æa_memıy
(&
ci
->
ci_b™timšg
, 
tb
[
IFLA_CAN_BITTIMING
],

125 (
ci
->
ci_b™timšg
));

126 
ci
->
ci_mask
 |ğ
CAN_HAS_BITTIMING
;

129 ià(
tb
[
IFLA_CAN_BITTIMING_CONST
]) {

130 
	`Æa_memıy
(&
ci
->
ci_b™timšg_cÚ¡
,

131 
tb
[
IFLA_CAN_BITTIMING_CONST
],

132 (
ci
->
ci_b™timšg_cÚ¡
));

133 
ci
->
ci_mask
 |ğ
CAN_HAS_BITTIMING_CONST
;

136 ià(
tb
[
IFLA_CAN_CLOCK
]) {

137 
	`Æa_memıy
(&
ci
->
ci_şock
, 
tb
[
IFLA_CAN_CLOCK
],

138 (
ci
->
ci_şock
));

139 
ci
->
ci_mask
 |ğ
CAN_HAS_CLOCK
;

142 ià(
tb
[
IFLA_CAN_BERR_COUNTER
]) {

143 
	`Æa_memıy
(&
ci
->
ci_b”r_couÁ”
, 
tb
[
IFLA_CAN_BERR_COUNTER
],

144 (
ci
->
ci_b”r_couÁ”
));

145 
ci
->
ci_mask
 |ğ
CAN_HAS_BERR_COUNTER
;

148 
”r
 = 0;

149 
”rout
:

150  
”r
;

151 
	}
}

153 
	$ÿn_ä“
(
¹Æ_lšk
 *
lšk
)

155 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

157 
	`ä“
(
ci
);

158 
lšk
->
l_šfo
 = 
NULL
;

159 
	}
}

161 *
	$´št_ÿn_¡©e
 (
ušt32_t
 
¡©e
)

163 *
‹xt
;

165 
¡©e
)

167 
CAN_STATE_ERROR_ACTIVE
:

168 
‹xt
 = "error‡ctive";

170 
CAN_STATE_ERROR_WARNING
:

171 
‹xt
 = "error warning";

173 
CAN_STATE_ERROR_PASSIVE
:

174 
‹xt
 = "error…assive";

176 
CAN_STATE_BUS_OFF
:

177 
‹xt
 = "bus off";

179 
CAN_STATE_STOPPED
:

180 
‹xt
 = "stopped";

182 
CAN_STATE_SLEEPING
:

183 
‹xt
 = "sleeping";

186 
‹xt
 = "unknown state";

189  
‹xt
;

190 
	}
}

192 
	$ÿn_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

194 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

195 
buf
 [64];

197 
	`¹Æ_lšk_ÿn_ù¾mode2¡r
(
ci
->
ci_ù¾mode
.
æags
, 
buf
, (buf));

198 
	`Æ_dump
(
p
, "bitrate %d %s <%s>",

199 
ci
->
ci_b™timšg
.
b™¿‹
, 
	`´št_ÿn_¡©e
(ci->
ci_¡©e
), 
buf
);

200 
	}
}

202 
	$ÿn_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

204 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

205 
buf
 [64];

207 
	`¹Æ_lšk_ÿn_ù¾mode2¡r
(
ci
->
ci_ù¾mode
.
æags
, 
buf
, (buf));

208 
	`Æ_dump
(
p
, " bitrate %d %s <%s>",

209 
ci
->
ci_b™timšg
.
b™¿‹
, 
	`´št_ÿn_¡©e
(ci->
ci_¡©e
), 
buf
);

211 ià(
ci
->
ci_mask
 & 
CAN_HAS_RESTART
) {

212 ià(
ci
->
ci_»¡¬t
)

213 
	`Æ_dump_lše
(
p
,"„estarting\n");

216 ià(
ci
->
ci_mask
 & 
CAN_HAS_RESTART_MS
) {

217 
	`Æ_dump_lše
(
p
,"„estart interval %d ms\n",

218 
ci
->
ci_»¡¬t_ms
);

221 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING
) {

222 
	`Æ_dump_lše
(
p
," sample…oint %f %%\n",

223 ((è
ci
->
ci_b™timšg
.
§m¶e_pošt
)/10);

224 
	`Æ_dump_lše
(
p
,"ime quanta %d‚s\n",

225 
ci
->
ci_b™timšg
.
tq
);

226 
	`Æ_dump_lše
(
p
,"…ropagation segment %dq\n",

227 
ci
->
ci_b™timšg
.
´İ_£g
);

228 
	`Æ_dump_lše
(
p
,"…hase buffer segment1 %dq\n",

229 
ci
->
ci_b™timšg
.
pha£_£g1
);

230 
	`Æ_dump_lše
(
p
,"…hase buffer segment2 %dq\n",

231 
ci
->
ci_b™timšg
.
pha£_£g2
);

232 
	`Æ_dump_lše
(
p
," synchronisation jump width %dq\n",

233 
ci
->
ci_b™timšg
.
sjw
);

234 
	`Æ_dump_lše
(
p
," bitrate…rescaler %d\n",

235 
ci
->
ci_b™timšg
.
b½
);

238 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING_CONST
) {

239 
	`Æ_dump_lše
(
p
," minimumsig1 %dq\n",

240 
ci
->
ci_b™timšg_cÚ¡
.
t£g1_mš
);

241 
	`Æ_dump_lše
(
p
," maximumsig1 %dq\n",

242 
ci
->
ci_b™timšg_cÚ¡
.
t£g1_max
);

243 
	`Æ_dump_lše
(
p
," minimumsig2 %dq\n",

244 
ci
->
ci_b™timšg_cÚ¡
.
t£g2_mš
);

245 
	`Æ_dump_lše
(
p
," maximumsig2 %dq\n",

246 
ci
->
ci_b™timšg_cÚ¡
.
t£g2_max
);

247 
	`Æ_dump_lše
(
p
," maximum sjw %dq\n",

248 
ci
->
ci_b™timšg_cÚ¡
.
sjw_max
);

249 
	`Æ_dump_lše
(
p
," minimum brp %d\n",

250 
ci
->
ci_b™timšg_cÚ¡
.
b½_mš
);

251 
	`Æ_dump_lše
(
p
," maximum brp %d\n",

252 
ci
->
ci_b™timšg_cÚ¡
.
b½_max
);

253 
	`Æ_dump_lše
(
p
," brp increment %d\n",

254 
ci
->
ci_b™timšg_cÚ¡
.
b½_šc
);

257 ià(
ci
->
ci_mask
 & 
CAN_HAS_CLOCK
) {

258 
	`Æ_dump_lše
(
p
," ba£ f»q %d Hz\n", 
ci
->
ci_şock
);

262 ià(
ci
->
ci_mask
 & 
CAN_HAS_BERR_COUNTER
) {

263 
	`Æ_dump_lše
(
p
," busƒrror RX %d\n",

264 
ci
->
ci_b”r_couÁ”
.
rx”r
);

265 
	`Æ_dump_lše
(
p
," busƒrror TX %d\n",

266 
ci
->
ci_b”r_couÁ”
.
tx”r
);

270 
	}
}

272 
	$ÿn_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

274 
ÿn_šfo
 *
cd¡
, *
c¤c
 = 
¤c
->
l_šfo
;

275 
»t
;

277 
d¡
->
l_šfo
 = 
NULL
;

278 
»t
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "can");

279 ià(
»t
 < 0)

280  
»t
;

282 
cd¡
 = 
	`m®loc
((*cdst));

283 ià(!
cd¡
)

284  -
NLE_NOMEM
;

286 *
cd¡
 = *
c¤c
;

287 
d¡
->
l_šfo
 = 
cd¡
;

290 
	}
}

292 
	$ÿn_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

294 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

295 
Æ©Œ
 *
d©a
;

297 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

298 ià(!
d©a
)

299  -
NLE_MSGSIZE
;

301 ià(
ci
->
ci_mask
 & 
CAN_HAS_RESTART
)

302 
	`NLA_PUT_U32
(
msg
, 
CAN_HAS_RESTART
, 
ci
->
ci_»¡¬t
);

304 ià(
ci
->
ci_mask
 & 
CAN_HAS_RESTART_MS
)

305 
	`NLA_PUT_U32
(
msg
, 
CAN_HAS_RESTART_MS
, 
ci
->
ci_»¡¬t_ms
);

307 ià(
ci
->
ci_mask
 & 
CAN_HAS_CTRLMODE
)

308 
	`NLA_PUT
(
msg
, 
CAN_HAS_CTRLMODE
, (
ci
->
ci_ù¾mode
),

309 &
ci
->
ci_ù¾mode
);

311 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING
)

312 
	`NLA_PUT
(
msg
, 
CAN_HAS_BITTIMING
, (
ci
->
ci_b™timšg
),

313 &
ci
->
ci_b™timšg
);

315 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING_CONST
)

316 
	`NLA_PUT
(
msg
, 
CAN_HAS_BITTIMING_CONST
,

317 (
ci
->
ci_b™timšg_cÚ¡
),

318 &
ci
->
ci_b™timšg_cÚ¡
);

320 ià(
ci
->
ci_mask
 & 
CAN_HAS_CLOCK
)

321 
	`NLA_PUT
(
msg
, 
CAN_HAS_CLOCK
, (
ci
->
ci_şock
),

322 &
ci
->
ci_şock
);

324 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

326 
Æa_put_çu»
:

329 
	}
}

331 
¹Æ_lšk_šfo_İs
 
	gÿn_šfo_İs
 = {

332 .
io_Çme
 = "can",

333 .
	gio_®loc
 = 
ÿn_®loc
,

334 .
	gio_·r£
 = 
ÿn_·r£
,

335 .
	gio_dump
 = {

336 [
NL_DUMP_LINE
] = 
ÿn_dump_lše
,

337 [
NL_DUMP_DETAILS
] = 
ÿn_dump_d‘as
,

339 .
	gio_şÚe
 = 
ÿn_şÚe
,

340 .
	gio_put_©Œs
 = 
ÿn_put_©Œs
,

341 .
	gio_ä“
 = 
ÿn_ä“
,

345 
	#IS_CAN_LINK_ASSERT
(
lšk
) \

346 ià((
lšk
)->
l_šfo_İs
 !ğ&
ÿn_šfo_İs
) { \

347 
	`APPBUG
("Link is‚ot‡ CAN†ink. setype \"can\" first."); \

348  -
NLE_OPNOTSUPP
; \

349 }

	)

363 
	$¹Æ_lšk_is_ÿn
(
¹Æ_lšk
 *
lšk
)

365  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "can");

366 
	}
}

374 
	$¹Æ_lšk_ÿn_»¡¬t
(
¹Æ_lšk
 *
lšk
)

376 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

378 
	`IS_CAN_LINK_ASSERT
(
lšk
);

380 
ci
->
ci_»¡¬t
 = 1;

381 
ci
->
ci_»¡¬t
 |ğ
CAN_HAS_RESTART
;

384 
	}
}

393 
	$¹Æ_lšk_ÿn_äeq
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
äeq
)

395 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

397 
	`IS_CAN_LINK_ASSERT
(
lšk
);

398 ià(!
äeq
)

399  -
NLE_INVAL
;

401 ià(
ci
->
ci_mask
 & 
CAN_HAS_CLOCK
)

402 *
äeq
 = 
ci
->
ci_şock
.freq;

404  -
NLE_AGAIN
;

407 
	}
}

415 
	$¹Æ_lšk_ÿn_¡©e
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
¡©e
)

417 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

419 
	`IS_CAN_LINK_ASSERT
(
lšk
);

420 ià(!
¡©e
)

421  -
NLE_INVAL
;

423 *
¡©e
 = 
ci
->
ci_¡©e
;

426 
	}
}

434 
	$¹Æ_lšk_ÿn_b”r_rx
(
¹Æ_lšk
 *
lšk
)

436 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

438 
	`IS_CAN_LINK_ASSERT
(
lšk
);

440 ià(
ci
->
ci_mask
 & 
CAN_HAS_BERR_COUNTER
)

441  
ci
->
ci_b”r_couÁ”
.
rx”r
;

443  -
NLE_AGAIN
;

444 
	}
}

452 
	$¹Æ_lšk_ÿn_b”r_tx
(
¹Æ_lšk
 *
lšk
)

454 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

456 
	`IS_CAN_LINK_ASSERT
(
lšk
);

458 ià(
ci
->
ci_mask
 & 
CAN_HAS_BERR_COUNTER
)

459  
ci
->
ci_b”r_couÁ”
.
tx”r
;

461  -
NLE_AGAIN
;

462 
	}
}

471 
	$¹Æ_lšk_ÿn_b”r
(
¹Æ_lšk
 *
lšk
, 
ÿn_b”r_couÁ”
 *
b”r
)

473 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

475 
	`IS_CAN_LINK_ASSERT
(
lšk
);

476 ià(!
b”r
)

477  -
NLE_INVAL
;

479 ià(
ci
->
ci_mask
 & 
CAN_HAS_BERR_COUNTER
)

480 *
b”r
 = 
ci
->
ci_b”r_couÁ”
;

482  -
NLE_AGAIN
;

485 
	}
}

494 
	$¹Æ_lšk_ÿn_g‘_bt_cÚ¡
(
¹Æ_lšk
 *
lšk
,

495 
ÿn_b™timšg_cÚ¡
 *
bt_cÚ¡
)

497 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

499 
	`IS_CAN_LINK_ASSERT
(
lšk
);

500 ià(!
bt_cÚ¡
)

501  -
NLE_INVAL
;

503 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING_CONST
)

504 *
bt_cÚ¡
 = 
ci
->
ci_b™timšg_cÚ¡
;

506  -
NLE_AGAIN
;

509 
	}
}

518 
	$¹Æ_lšk_ÿn_g‘_b™timšg
(
¹Æ_lšk
 *
lšk
,

519 
ÿn_b™timšg
 *
b™_timšg
)

521 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

523 
	`IS_CAN_LINK_ASSERT
(
lšk
);

524 ià(!
b™_timšg
)

525  -
NLE_INVAL
;

527 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING
)

528 *
b™_timšg
 = 
ci
->
ci_b™timšg
;

530  -
NLE_AGAIN
;

533 
	}
}

542 
	$¹Æ_lšk_ÿn_£t_b™timšg
(
¹Æ_lšk
 *
lšk
,

543 
ÿn_b™timšg
 *
b™_timšg
)

545 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

547 
	`IS_CAN_LINK_ASSERT
(
lšk
);

548 ià(!
b™_timšg
)

549  -
NLE_INVAL
;

551 
ci
->
ci_b™timšg
 = *
b™_timšg
;

552 
ci
->
ci_mask
 |ğ
CAN_HAS_BITTIMING
;

555 
	}
}

564 
	$¹Æ_lšk_ÿn_g‘_b™¿‹
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
b™¿‹
)

566 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

568 
	`IS_CAN_LINK_ASSERT
(
lšk
);

569 ià(!
b™¿‹
)

570  -
NLE_INVAL
;

572 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING
)

573 *
b™¿‹
 = 
ci
->
ci_b™timšg
.bitrate;

575  -
NLE_AGAIN
;

578 
	}
}

587 
	$¹Æ_lšk_ÿn_£t_b™¿‹
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
b™¿‹
)

589 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

591 
	`IS_CAN_LINK_ASSERT
(
lšk
);

593 
ci
->
ci_b™timšg
.
b™¿‹
 = bitrate;

594 
ci
->
ci_mask
 |ğ
CAN_HAS_BITTIMING
;

597 
	}
}

606 
	$¹Æ_lšk_ÿn_g‘_§m¶e_pošt
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
¥
)

608 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

610 
	`IS_CAN_LINK_ASSERT
(
lšk
);

611 ià(!
¥
)

612  -
NLE_INVAL
;

614 ià(
ci
->
ci_mask
 & 
CAN_HAS_BITTIMING
)

615 *
¥
 = 
ci
->
ci_b™timšg
.
§m¶e_pošt
;

617  -
NLE_AGAIN
;

620 
	}
}

629 
	$¹Æ_lšk_ÿn_£t_§m¶e_pošt
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
¥
)

631 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

633 
	`IS_CAN_LINK_ASSERT
(
lšk
);

635 
ci
->
ci_b™timšg
.
§m¶e_pošt
 = 
¥
;

636 
ci
->
ci_mask
 |ğ
CAN_HAS_BITTIMING
;

639 
	}
}

648 
	$¹Æ_lšk_ÿn_g‘_»¡¬t_ms
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
š‹rv®
)

650 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

652 
	`IS_CAN_LINK_ASSERT
(
lšk
);

653 ià(!
š‹rv®
)

654  -
NLE_INVAL
;

656 ià(
ci
->
ci_mask
 & 
CAN_HAS_RESTART_MS
)

657 *
š‹rv®
 = 
ci
->
ci_»¡¬t_ms
;

659  -
NLE_AGAIN
;

662 
	}
}

671 
	$¹Æ_lšk_ÿn_£t_»¡¬t_ms
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
š‹rv®
)

673 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

675 
	`IS_CAN_LINK_ASSERT
(
lšk
);

677 
ci
->
ci_»¡¬t_ms
 = 
š‹rv®
;

678 
ci
->
ci_mask
 |ğ
CAN_HAS_RESTART_MS
;

681 
	}
}

690 
	$¹Æ_lšk_ÿn_g‘_ù¾mode
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
ù¾mode
)

692 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

694 
	`IS_CAN_LINK_ASSERT
(
lšk
);

695 ià(!
ù¾mode
)

696  -
NLE_INVAL
;

698 ià(
ci
->
ci_mask
 & 
CAN_HAS_CTRLMODE
)

699 *
ù¾mode
 = 
ci
->
ci_ù¾mode
.
æags
;

701  -
NLE_AGAIN
;

704 
	}
}

713 
	$¹Æ_lšk_ÿn_£t_ù¾mode
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ù¾mode
)

715 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

717 
	`IS_CAN_LINK_ASSERT
(
lšk
);

719 
ci
->
ci_ù¾mode
.
æags
 |ğ
ù¾mode
;

720 
ci
->
ci_ù¾mode
.
mask
 |ğ
ù¾mode
;

721 
ci
->
ci_mask
 |ğ
CAN_HAS_CTRLMODE
;

724 
	}
}

733 
	$¹Æ_lšk_ÿn_un£t_ù¾mode
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ù¾mode
)

735 
ÿn_šfo
 *
ci
 = 
lšk
->
l_šfo
;

737 
	`IS_CAN_LINK_ASSERT
(
lšk
);

739 
ci
->
ci_ù¾mode
.
æags
 &ğ~
ù¾mode
;

740 
ci
->
ci_ù¾mode
.
mask
 |ğ
ù¾mode
;

741 
ci
->
ci_mask
 |ğ
CAN_HAS_CTRLMODE
;

744 
	}
}

753 cÚ¡ 
Œªs_tbl
 
	gÿn_ù¾mode
[] = {

754 
__ADD
(
CAN_CTRLMODE_LOOPBACK
, 
loİback
)

755 
__ADD
(
CAN_CTRLMODE_LISTENONLY
, 
li¡’
-
Úly
)

756 
__ADD
(
CAN_CTRLMODE_3_SAMPLES
, 
ŒË
-
§m¶šg
)

757 
__ADD
(
CAN_CTRLMODE_ONE_SHOT
, 
Úe
-
shÙ
)

758 
__ADD
(
CAN_CTRLMODE_BERR_REPORTING
, 
b”r
-
»pÜtšg
)

761 *
	$¹Æ_lšk_ÿn_ù¾mode2¡r
(
ù¾mode
, *
buf
, 
size_t
 
Ën
)

763  
	`__æags2¡r
(
ù¾mode
, 
buf
, 
Ën
, 
ÿn_ù¾mode
,

764 
	`ARRAY_SIZE
(
ÿn_ù¾mode
));

765 
	}
}

767 
	$¹Æ_lšk_ÿn_¡r2ù¾mode
(cÚ¡ *
Çme
)

769  
	`__¡r2æags
(
Çme
, 
ÿn_ù¾mode
, 
	`ARRAY_SIZE
(can_ctrlmode));

770 
	}
}

774 
__š™
 
	$ÿn_š™
()

776 
	`¹Æ_lšk_»gi¡”_šfo
(&
ÿn_šfo_İs
);

777 
	}
}

779 
__ex™
 
	$ÿn_ex™
()

781 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
ÿn_šfo_İs
);

782 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/dummy.c

22 
	~<Ãšk-´iv©e/Ãšk.h
>

23 
	~<Ãšk/Ãšk.h
>

24 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

26 
¹Æ_lšk_šfo_İs
 
	gdummy_šfo_İs
 = {

27 .
io_Çme
 = "dummy",

30 
__š™
 
	$dummy_š™
()

32 
	`¹Æ_lšk_»gi¡”_šfo
(&
dummy_šfo_İs
);

33 
	}
}

35 
__ex™
 
	$dummy_ex™
()

37 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
dummy_šfo_İs
);

38 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/inet.c

60 
	~<Ãšk-´iv©e/Ãšk.h
>

61 
	~<Ãšk/Ãšk.h
>

62 
	~<Ãšk/©Œ.h
>

63 
	~<Ãšk/rou‹/¹Æ.h
>

64 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

67 
	sš‘_d©a


69 
ušt8_t
 
	mi_cÚf£t
[
IPV4_DEVCONF_MAX
];

70 
ušt32_t
 
	mi_cÚf
[
IPV4_DEVCONF_MAX
];

74 *
	$š‘_®loc
(
¹Æ_lšk
 *
lšk
)

76  
	`ÿÎoc
(1, (
š‘_d©a
));

77 
	}
}

79 *
	$š‘_şÚe
(
¹Æ_lšk
 *
lšk
, *
d©a
)

81 
š‘_d©a
 *
id
;

83 ià((
id
 = 
	`š‘_®loc
(
lšk
)))

84 
	`memıy
(
id
, 
d©a
, (*id));

86  
id
;

87 
	}
}

89 
	$š‘_ä“
(
¹Æ_lšk
 *
lšk
, *
d©a
)

91 
	`ä“
(
d©a
);

92 
	}
}

94 
Æa_pŞicy
 
	gš‘_pŞicy
[
IFLA_INET6_MAX
+1] = {

95 [
IFLA_INET_CONF
] = { .
mšËn
 = 4 },

98 
	$š‘_·r£_af
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
©Œ
, *
d©a
)

100 
š‘_d©a
 *
id
 = 
d©a
;

101 
Æ©Œ
 *
tb
[
IFLA_INET_MAX
+1];

102 
”r
;

104 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_INET_MAX
, 
©Œ
, 
š‘_pŞicy
);

105 ià(
”r
 < 0)

106  
”r
;

107 ià(
tb
[
IFLA_INET_CONF
] && 
	`Æa_Ën
(tb[IFLA_INET_CONF]) % 4)

108  -
EINVAL
;

110 ià(
tb
[
IFLA_INET_CONF
]) {

111 
i
;

112 
Ën
 = 
	`mš_t
(, 
IPV4_DEVCONF_MAX
, 
	`Æa_Ën
(
tb
[
IFLA_INET_CONF
]) / 4);

114 
i
 = 0; i < 
Ën
; i++)

115 
id
->
i_cÚf£t
[
i
] = 1;

116 
	`Æa_memıy
(&
id
->
i_cÚf
, 
tb
[
IFLA_INET_CONF
], (id->i_conf));

120 
	}
}

122 
	$š‘_fl_af
(
¹Æ_lšk
 *
lšk
, 
Æ_msg
 *
msg
, *
d©a
)

124 
š‘_d©a
 *
id
 = 
d©a
;

125 
Æ©Œ
 *
Æa
;

126 
i
;

128 ià(!(
Æa
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INET_CONF
)))

129  -
NLE_MSGSIZE
;

131 
i
 = 0; i < 
IPV4_DEVCONF_MAX
; i++)

132 ià(
id
->
i_cÚf£t
[
i
])

133 
	`NLA_PUT_U32
(
msg
, 
i
+1, 
id
->
i_cÚf
[i]);

135 
	`Æa_Ã¡_’d
(
msg
, 
Æa
);

139 
Æa_put_çu»
:

140  -
NLE_MSGSIZE
;

141 
	}
}

143 cÚ¡ 
Œªs_tbl
 
	gš‘_devcÚf
[] = {

144 
__ADD
(
IPV4_DEVCONF_FORWARDING
, 
fÜw¬dšg
)

145 
__ADD
(
IPV4_DEVCONF_MC_FORWARDING
, 
mc_fÜw¬dšg
)

146 
__ADD
(
IPV4_DEVCONF_PROXY_ARP
, 
´oxy_¬p
)

147 
__ADD
(
IPV4_DEVCONF_ACCEPT_REDIRECTS
, 
acû±_»dœeùs
)

148 
__ADD
(
IPV4_DEVCONF_SECURE_REDIRECTS
, 
£cu»_»dœeùs
)

149 
__ADD
(
IPV4_DEVCONF_SEND_REDIRECTS
, 
£nd_»dœeùs
)

150 
__ADD
(
IPV4_DEVCONF_SHARED_MEDIA
, 
sh¬ed_medŸ
)

151 
__ADD
(
IPV4_DEVCONF_RP_FILTER
, 
½_f‹r
)

152 
__ADD
(
IPV4_DEVCONF_ACCEPT_SOURCE_ROUTE
, 
acû±_sourû_rou‹
)

153 
__ADD
(
IPV4_DEVCONF_BOOTP_RELAY
, 
boÙp_»Ïy
)

154 
__ADD
(
IPV4_DEVCONF_LOG_MARTIANS
, 
log_m¬tŸns
)

155 
__ADD
(
IPV4_DEVCONF_TAG
, 
g
)

156 
__ADD
(
IPV4_DEVCONF_ARPFILTER
, 
¬pf‹r
)

157 
__ADD
(
IPV4_DEVCONF_MEDIUM_ID
, 
medium_id
)

158 
__ADD
(
IPV4_DEVCONF_NOXFRM
, 
noxäm
)

159 
__ADD
(
IPV4_DEVCONF_NOPOLICY
, 
nİŞicy
)

160 
__ADD
(
IPV4_DEVCONF_FORCE_IGMP_VERSION
, 
fÜû_igmp_v”siÚ
)

161 
__ADD
(
IPV4_DEVCONF_ARP_ANNOUNCE
, 
¬p_ªnounû
)

162 
__ADD
(
IPV4_DEVCONF_ARP_IGNORE
, 
¬p_ignÜe
)

163 
__ADD
(
IPV4_DEVCONF_PROMOTE_SECONDARIES
, 
´omÙe_£cÚd¬›s
)

164 
__ADD
(
IPV4_DEVCONF_ARP_ACCEPT
, 
¬p_acû±
)

165 
__ADD
(
IPV4_DEVCONF_ARP_NOTIFY
, 
¬p_nÙify
)

166 
__ADD
(
IPV4_DEVCONF_ACCEPT_LOCAL
, 
acû±_loÿl
)

167 
__ADD
(
IPV4_DEVCONF_SRC_VMARK
, 
¤c_vm¬k
)

168 
__ADD
(
IPV4_DEVCONF_PROXY_ARP_PVLAN
, 
´oxy_¬p_pvÏn
)

169 
__ADD
(
IPV4_DEVCONF_ROUTE_LOCALNET
, 
rou‹_loÿÊ‘
)

170 
__ADD
(
IPV4_DEVCONF_IGMPV2_UNSOLICITED_REPORT_INTERVAL
, 
igmpv2_unsŞic™ed_»pÜt_š‹rv®
)

171 
__ADD
(
IPV4_DEVCONF_IGMPV3_UNSOLICITED_REPORT_INTERVAL
, 
igmpv3_unsŞic™ed_»pÜt_š‹rv®
)

174 cÚ¡ *
	$¹Æ_lšk_š‘_devcÚf2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
)

176  
	`__ty³2¡r
(
ty³
, 
buf
, 
Ën
, 
š‘_devcÚf
,

177 
	`ARRAY_SIZE
(
š‘_devcÚf
));

178 
	}
}

180 
	$¹Æ_lšk_š‘_¡r2devcÚf
(cÚ¡ *
Çme
)

182  
	`__¡r2ty³
(
Çme
, 
š‘_devcÚf
, 
	`ARRAY_SIZE
(inet_devconf));

183 
	}
}

185 
	$š‘_dump_d‘as
(
¹Æ_lšk
 *
lšk
,

186 
Æ_dump_·¿ms
 *
p
, *
d©a
)

188 
š‘_d©a
 *
id
 = 
d©a
;

189 
buf
[64];

190 
i
, 
n
 = 0;

192 
	`Æ_dump_lše
(
p
, " ipv4 devconf:\n");

193 
	`Æ_dump_lše
(
p
, " ");

195 
i
 = 0; i < 
IPV4_DEVCONF_MAX
; i++) {

196 
	`Æ_dump_lše
(
p
, "%-19s %3u",

197 
	`¹Æ_lšk_š‘_devcÚf2¡r
(
i
+1, 
buf
, (buf)),

198 
id
->
i_cÚf£t
[
i
] ? id->
i_cÚf
[i] : 0);

200 ià(++
n
 == 3) {

201 
	`Æ_dump
(
p
, "\n");

202 
	`Æ_dump_lše
(
p
, " ");

203 
n
 = 0;

205 
	`Æ_dump
(
p
, " ");

208 ià(
n
 != 0)

209 
	`Æ_dump
(
p
, "\n");

210 
	}
}

212 
¹Æ_lšk_af_İs
 
	gš‘_İs
 = {

213 .
ao_çmy
 = 
AF_INET
,

214 .
	gao_®loc
 = &
š‘_®loc
,

215 .
	gao_şÚe
 = &
š‘_şÚe
,

216 .
	gao_ä“
 = &
š‘_ä“
,

217 .
	gao_·r£_af
 = &
š‘_·r£_af
,

218 .
	gao_fl_af
 = &
š‘_fl_af
,

219 .
	gao_dump
[
NL_DUMP_DETAILS
] = &
š‘_dump_d‘as
,

237 
	$¹Æ_lšk_š‘_g‘_cÚf
(
¹Æ_lšk
 *
lšk
, cÚ¡ 
cfgid
,

238 
ušt32_t
 *
»s
)

240 
š‘_d©a
 *
id
;

242 ià(
cfgid
 =ğ0 || cfgid > 
IPV4_DEVCONF_MAX
)

243  -
NLE_RANGE
;

245 ià(!(
id
 = 
	`¹Æ_lšk_af_®loc
(
lšk
, &
š‘_İs
)))

246  -
NLE_NOATTR
;

248 ià(!
id
->
i_cÚf£t
[
cfgid
 - 1])

249  -
NLE_INVAL
;

250 *
»s
 = 
id
->
i_cÚf
[
cfgid
 - 1];

253 
	}
}

267 
	$¹Æ_lšk_š‘_£t_cÚf
(
¹Æ_lšk
 *
lšk
, cÚ¡ 
cfgid
,

268 
ušt32_t
 
v®ue
)

270 
š‘_d©a
 *
id
;

272 ià(!(
id
 = 
	`¹Æ_lšk_af_®loc
(
lšk
, &
š‘_İs
)))

273  -
NLE_NOMEM
;

275 ià(
cfgid
 =ğ0 || cfgid > 
IPV4_DEVCONF_MAX
)

276  -
NLE_RANGE
;

278 
id
->
i_cÚf£t
[
cfgid
 - 1] = 1;

279 
id
->
i_cÚf
[
cfgid
 - 1] = 
v®ue
;

282 
	}
}

285 
__š™
 
	$š‘_š™
()

287 
	`¹Æ_lšk_af_»gi¡”
(&
š‘_İs
);

288 
	}
}

290 
__ex™
 
	$š‘_ex™
()

292 
	`¹Æ_lšk_af_uÄegi¡”
(&
š‘_İs
);

293 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/inet6.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/Ãšk.h
>

14 
	~<Ãšk/©Œ.h
>

15 
	~<Ãšk/rou‹/¹Æ.h
>

16 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

18 
	sš‘6_d©a


20 
ušt32_t
 
	mi6_æags
;

21 
iæa_ÿchešfo
 
	mi6_ÿchešfo
;

22 
ušt32_t
 
	mi6_cÚf
[
DEVCONF_MAX
];

25 *
	$š‘6_®loc
(
¹Æ_lšk
 *
lšk
)

27  
	`ÿÎoc
(1, (
š‘6_d©a
));

28 
	}
}

30 *
	$š‘6_şÚe
(
¹Æ_lšk
 *
lšk
, *
d©a
)

32 
š‘6_d©a
 *
i6
;

34 ià((
i6
 = 
	`š‘6_®loc
(
lšk
)))

35 
	`memıy
(
i6
, 
d©a
, (*i6));

37  
i6
;

38 
	}
}

40 
	$š‘6_ä“
(
¹Æ_lšk
 *
lšk
, *
d©a
)

42 
	`ä“
(
d©a
);

43 
	}
}

45 
Æa_pŞicy
 
	gš‘6_pŞicy
[
IFLA_INET6_MAX
+1] = {

46 [
IFLA_INET6_FLAGS
] = { .
ty³
 = 
NLA_U32
 },

47 [
IFLA_INET6_CACHEINFO
] = { .
mšËn
 = (
iæa_ÿchešfo
) },

48 [
IFLA_INET6_CONF
] = { .
mšËn
 = 4 },

49 [
IFLA_INET6_STATS
] = { .
mšËn
 = 8 },

50 [
IFLA_INET6_ICMP6STATS
] = { .
mšËn
 = 8 },

53 cÚ¡ 
ušt8_t
 
	gm­_¡©_id_äom_IPSTATS_MIB_v1
[
__IPSTATS_MIB_MAX
] = {

59 [ 1] = 
RTNL_LINK_IP6_INPKTS
,

60 [ 2] = 
RTNL_LINK_IP6_INHDRERRORS
,

61 [ 3] = 
RTNL_LINK_IP6_INTOOBIGERRORS
,

62 [ 4] = 
RTNL_LINK_IP6_INNOROUTES
,

63 [ 5] = 
RTNL_LINK_IP6_INADDRERRORS
,

64 [ 6] = 
RTNL_LINK_IP6_INUNKNOWNPROTOS
,

65 [ 7] = 
RTNL_LINK_IP6_INTRUNCATEDPKTS
,

66 [ 8] = 
RTNL_LINK_IP6_INDISCARDS
,

67 [ 9] = 
RTNL_LINK_IP6_INDELIVERS
,

68 [10] = 
RTNL_LINK_IP6_OUTFORWDATAGRAMS
,

69 [11] = 
RTNL_LINK_IP6_OUTPKTS
,

70 [12] = 
RTNL_LINK_IP6_OUTDISCARDS
,

71 [13] = 
RTNL_LINK_IP6_OUTNOROUTES
,

72 [14] = 
RTNL_LINK_IP6_REASMTIMEOUT
,

73 [15] = 
RTNL_LINK_IP6_REASMREQDS
,

74 [16] = 
RTNL_LINK_IP6_REASMOKS
,

75 [17] = 
RTNL_LINK_IP6_REASMFAILS
,

76 [18] = 
RTNL_LINK_IP6_FRAGOKS
,

77 [19] = 
RTNL_LINK_IP6_FRAGFAILS
,

78 [20] = 
RTNL_LINK_IP6_FRAGCREATES
,

79 [21] = 
RTNL_LINK_IP6_INMCASTPKTS
,

80 [22] = 
RTNL_LINK_IP6_OUTMCASTPKTS
,

81 [23] = 
RTNL_LINK_IP6_INBCASTPKTS
,

82 [24] = 
RTNL_LINK_IP6_OUTBCASTPKTS
,

83 [25] = 
RTNL_LINK_IP6_INOCTETS
,

84 [26] = 
RTNL_LINK_IP6_OUTOCTETS
,

85 [27] = 
RTNL_LINK_IP6_INMCASTOCTETS
,

86 [28] = 
RTNL_LINK_IP6_OUTMCASTOCTETS
,

87 [29] = 
RTNL_LINK_IP6_INBCASTOCTETS
,

88 [30] = 
RTNL_LINK_IP6_OUTBCASTOCTETS
,

91 cÚ¡ 
ušt8_t
 
	gm­_¡©_id_äom_IPSTATS_MIB_v2
[
__IPSTATS_MIB_MAX
] = {

94 [ 1] = 
RTNL_LINK_IP6_INPKTS
,

95 [ 2] = 
RTNL_LINK_IP6_INOCTETS
,

96 [ 3] = 
RTNL_LINK_IP6_INDELIVERS
,

97 [ 4] = 
RTNL_LINK_IP6_OUTFORWDATAGRAMS
,

98 [ 5] = 
RTNL_LINK_IP6_OUTPKTS
,

99 [ 6] = 
RTNL_LINK_IP6_OUTOCTETS
,

100 [ 7] = 
RTNL_LINK_IP6_INHDRERRORS
,

101 [ 8] = 
RTNL_LINK_IP6_INTOOBIGERRORS
,

102 [ 9] = 
RTNL_LINK_IP6_INNOROUTES
,

103 [10] = 
RTNL_LINK_IP6_INADDRERRORS
,

104 [11] = 
RTNL_LINK_IP6_INUNKNOWNPROTOS
,

105 [12] = 
RTNL_LINK_IP6_INTRUNCATEDPKTS
,

106 [13] = 
RTNL_LINK_IP6_INDISCARDS
,

107 [14] = 
RTNL_LINK_IP6_OUTDISCARDS
,

108 [15] = 
RTNL_LINK_IP6_OUTNOROUTES
,

109 [16] = 
RTNL_LINK_IP6_REASMTIMEOUT
,

110 [17] = 
RTNL_LINK_IP6_REASMREQDS
,

111 [18] = 
RTNL_LINK_IP6_REASMOKS
,

112 [19] = 
RTNL_LINK_IP6_REASMFAILS
,

113 [20] = 
RTNL_LINK_IP6_FRAGOKS
,

114 [21] = 
RTNL_LINK_IP6_FRAGFAILS
,

115 [22] = 
RTNL_LINK_IP6_FRAGCREATES
,

116 [23] = 
RTNL_LINK_IP6_INMCASTPKTS
,

117 [24] = 
RTNL_LINK_IP6_OUTMCASTPKTS
,

118 [25] = 
RTNL_LINK_IP6_INBCASTPKTS
,

119 [26] = 
RTNL_LINK_IP6_OUTBCASTPKTS
,

120 [27] = 
RTNL_LINK_IP6_INMCASTOCTETS
,

121 [28] = 
RTNL_LINK_IP6_OUTMCASTOCTETS
,

122 [29] = 
RTNL_LINK_IP6_INBCASTOCTETS
,

123 [30] = 
RTNL_LINK_IP6_OUTBCASTOCTETS
,

124 [31] = 
RTNL_LINK_IP6_CSUMERRORS
,

125 [32] = 
RTNL_LINK_IP6_NOECTPKTS
,

126 [33] = 
RTNL_LINK_IP6_ECT1PKTS
,

127 [34] = 
RTNL_LINK_IP6_ECT0PKTS
,

128 [35] = 
RTNL_LINK_IP6_CEPKTS
,

131 
	$š‘6_·r£_´Ùšfo
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
©Œ
,

132 *
d©a
)

134 
š‘6_d©a
 *
i6
 = 
d©a
;

135 
Æ©Œ
 *
tb
[
IFLA_INET6_MAX
+1];

136 
”r
;

138 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_INET6_MAX
, 
©Œ
, 
š‘6_pŞicy
);

139 ià(
”r
 < 0)

140  
”r
;

141 ià(
tb
[
IFLA_INET6_CONF
] && 
	`Æa_Ën
(tb[IFLA_INET6_CONF]) % 4)

142  -
EINVAL
;

143 ià(
tb
[
IFLA_INET6_STATS
] && 
	`Æa_Ën
(tb[IFLA_INET6_STATS]) % 8)

144  -
EINVAL
;

145 ià(
tb
[
IFLA_INET6_ICMP6STATS
] && 
	`Æa_Ën
(tb[IFLA_INET6_ICMP6STATS]) % 8)

146  -
EINVAL
;

148 ià(
tb
[
IFLA_INET6_FLAGS
])

149 
i6
->
i6_æags
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_INET6_FLAGS
]);

151 ià(
tb
[
IFLA_INET6_CACHEINFO
])

152 
	`Æa_memıy
(&
i6
->
i6_ÿchešfo
, 
tb
[
IFLA_INET6_CACHEINFO
],

153 (
i6
->
i6_ÿchešfo
));

155 ià(
tb
[
IFLA_INET6_CONF
])

156 
	`Æa_memıy
(&
i6
->
i6_cÚf
, 
tb
[
IFLA_INET6_CONF
],

157 (
i6
->
i6_cÚf
));

163 ià(
tb
[
IFLA_INET6_STATS
]) {

164 *
út
 = 
	`Æa_d©a
(
tb
[
IFLA_INET6_STATS
]);

165 
ušt64_t
 
¡©
;

166 
i
;

167 
Ën
 = 
	`Æa_Ën
(
tb
[
IFLA_INET6_STATS
]) / 8;

168 cÚ¡ 
ušt8_t
 *
m­_¡©_id
 = 
m­_¡©_id_äom_IPSTATS_MIB_v2
;

170 ià(
Ën
 < 32 ||

171 (
tb
[
IFLA_INET6_ICMP6STATS
] && 
	`Æa_Ën
(tb[IFLA_INET6_ICMP6STATS]) < 6)) {

177 
m­_¡©_id
 = 
m­_¡©_id_äom_IPSTATS_MIB_v1
;

180 
Ën
 = 
	`mš_t
(, 
__IPSTATS_MIB_MAX
,†en);

181 
i
 = 1; i < 
Ën
; i++) {

182 
	`memıy
(&
¡©
, &
út
[
i
 * (stat)], (stat));

183 
	`¹Æ_lšk_£t_¡©
(
lšk
, 
m­_¡©_id
[
i
], 
¡©
);

187 ià(
tb
[
IFLA_INET6_ICMP6STATS
]) {

188 *
út
 = 
	`Æa_d©a
(
tb
[
IFLA_INET6_ICMP6STATS
]);

189 
ušt64_t
 
¡©
;

190 
i
;

191 
Ën
 = 
	`mš_t
(, 
__ICMP6_MIB_MAX
, 
	`Æa_Ën
(
tb
[
IFLA_INET6_ICMP6STATS
]) / 8);

193 
i
 = 1; i < 
Ën
; i++) {

194 
	`memıy
(&
¡©
, &
út
[
i
 * (stat)], (stat));

195 
	`¹Æ_lšk_£t_¡©
(
lšk
, 
RTNL_LINK_ICMP6_INMSGS
 + 
i
 - 1,

196 
¡©
);

201 
	}
}

204 
	#IF_RA_OTHERCONF
 0x80

	)

205 
	#IF_RA_MANAGED
 0x40

	)

206 
	#IF_RA_RCVD
 0x20

	)

207 
	#IF_RS_SENT
 0x10

	)

208 
	#IF_READY
 0x80000000

	)

210 cÚ¡ 
Œªs_tbl
 
	gš‘6_æags
[] = {

211 
__ADD
(
IF_RA_OTHERCONF
, 
¿_Ùh”cÚf
)

212 
__ADD
(
IF_RA_MANAGED
, 
¿_mªaged
)

213 
__ADD
(
IF_RA_RCVD
, 
¿_rcvd
)

214 
__ADD
(
IF_RS_SENT
, 
rs_£Á
)

215 
__ADD
(
IF_READY
, 
»ady
)

218 *
	$š‘6_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

220  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
š‘6_æags
,

221 
	`ARRAY_SIZE
(
š‘6_æags
));

222 
	}
}

224 cÚ¡ 
Œªs_tbl
 
	gš‘6_devcÚf
[] = {

225 
__ADD
(
DEVCONF_FORWARDING
, 
fÜw¬dšg
)

226 
__ADD
(
DEVCONF_HOPLIMIT
, 
hİlim™
)

227 
__ADD
(
DEVCONF_MTU6
, 
mtu6
)

228 
__ADD
(
DEVCONF_ACCEPT_RA
, 
acû±_¿
)

229 
__ADD
(
DEVCONF_ACCEPT_REDIRECTS
, 
acû±_»dœeùs
)

230 
__ADD
(
DEVCONF_AUTOCONF
, 
autocÚf
)

231 
__ADD
(
DEVCONF_DAD_TRANSMITS
, 
dad_Œªsm™s
)

232 
__ADD
(
DEVCONF_RTR_SOLICITS
, 
¹r_sŞic™s
)

233 
__ADD
(
DEVCONF_RTR_SOLICIT_INTERVAL
, 
¹r_sŞic™_š‹rv®
)

234 
__ADD
(
DEVCONF_RTR_SOLICIT_DELAY
, 
¹r_sŞic™_d–ay
)

235 
__ADD
(
DEVCONF_USE_TEMPADDR
, 
u£_‹m·ddr
)

236 
__ADD
(
DEVCONF_TEMP_VALID_LFT
, 
‹mp_v®id_lá
)

237 
__ADD
(
DEVCONF_TEMP_PREFERED_LFT
, 
‹mp_´eã»d_lá
)

238 
__ADD
(
DEVCONF_REGEN_MAX_RETRY
, 
»g’_max_»Œy
)

239 
__ADD
(
DEVCONF_MAX_DESYNC_FACTOR
, 
max_desync_çùÜ
)

240 
__ADD
(
DEVCONF_MAX_ADDRESSES
, 
max_add»s£s
)

241 
__ADD
(
DEVCONF_FORCE_MLD_VERSION
, 
fÜû_mld_v”siÚ
)

242 
__ADD
(
DEVCONF_ACCEPT_RA_DEFRTR
, 
acû±_¿_deäŒ
)

243 
__ADD
(
DEVCONF_ACCEPT_RA_PINFO
, 
acû±_¿_pšfo
)

244 
__ADD
(
DEVCONF_ACCEPT_RA_RTR_PREF
, 
acû±_¿_¹r_´ef
)

245 
__ADD
(
DEVCONF_RTR_PROBE_INTERVAL
, 
¹r_´obe_š‹rv®
)

246 
__ADD
(
DEVCONF_ACCEPT_RA_RT_INFO_MAX_PLEN
, 
acû±_¿_¹_šfo
)

247 
__ADD
(
DEVCONF_PROXY_NDP
, 
´oxy_ndp
)

248 
__ADD
(
DEVCONF_OPTIMISTIC_DAD
, 
İtimi¡ic_dad
)

249 
__ADD
(
DEVCONF_ACCEPT_SOURCE_ROUTE
, 
acû±_sourû_rou‹
)

250 
__ADD
(
DEVCONF_MC_FORWARDING
, 
mc_fÜw¬dšg
)

251 
__ADD
(
DEVCONF_DISABLE_IPV6
, 
di§bË_v6
)

252 
__ADD
(
DEVCONF_ACCEPT_DAD
, 
acû±_dad
)

253 
__ADD
(
DEVCONF_FORCE_TLLAO
, 
fÜû_Ïo
)

256 *
	$š‘6_devcÚf2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
)

258  
	`__ty³2¡r
(
ty³
, 
buf
, 
Ën
, 
š‘6_devcÚf
,

259 
	`ARRAY_SIZE
(
š‘6_devcÚf
));

260 
	}
}

263 
	$š‘6_dump_d‘as
(
¹Æ_lšk
 *
lšk
,

264 
Æ_dump_·¿ms
 *
p
, *
d©a
)

266 
š‘6_d©a
 *
i6
 = 
d©a
;

267 
buf
[64], 
buf2
[64];

268 
i
, 
n
 = 0;

270 
	`Æ_dump_lše
(
p
, " ipv6 max-reasm-len %s",

271 
	`Æ_size2¡r
(
i6
->
i6_ÿchešfo
.
max_»asm_Ën
, 
buf
, (buf)));

273 
	`Æ_dump
(
p
, " <%s>\n",

274 
	`š‘6_æags2¡r
(
i6
->
i6_æags
, 
buf
, (buf)));

277 
	`Æ_dump_lše
(
p
, " create-stamp %.2fs„eachable-time %s",

278 (è
i6
->
i6_ÿchešfo
.
t¡amp
 / 100.,

279 
	`Æ_m£c2¡r
(
i6
->
i6_ÿchešfo
.
»achabË_time
, 
buf
, (buf)));

281 
	`Æ_dump
(
p
, "„etrans-time %s\n",

282 
	`Æ_m£c2¡r
(
i6
->
i6_ÿchešfo
.
»Œªs_time
, 
buf
, (buf)));

284 
	`Æ_dump_lše
(
p
, " devconf:\n");

285 
	`Æ_dump_lše
(
p
, " ");

287 
i
 = 0; i < 
DEVCONF_MAX
; i++) {

288 
ušt32_t
 
v®ue
 = 
i6
->
i6_cÚf
[
i
];

289 
x
, 
off£t
;

291 
i
) {

292 
DEVCONF_TEMP_VALID_LFT
:

293 
DEVCONF_TEMP_PREFERED_LFT
:

294 
	`Æ_m£c2¡r
((
ušt64_t
è
v®ue
 * 1000., 
buf2
, (buf2));

297 
DEVCONF_RTR_PROBE_INTERVAL
:

298 
DEVCONF_RTR_SOLICIT_INTERVAL
:

299 
DEVCONF_RTR_SOLICIT_DELAY
:

300 
	`Æ_m£c2¡r
(
v®ue
, 
buf2
, (buf2));

304 
	`¢´štf
(
buf2
, (buf2), "%u", 
v®ue
);

309 
	`š‘6_devcÚf2¡r
(
i
, 
buf
, (buf));

311 
off£t
 = 23 - 
	`¡¾’
(
buf2
);

312 ià(
off£t
 < 0)

313 
off£t
 = 0;

315 
x
 = 
	`¡¾’
(
buf
); x < 
off£t
; x++)

316 
buf
[
x
] = ' ';

318 
	`¡ºıy
(&
buf
[
off£t
], 
buf2
, 
	`¡¾’
(buf2));

320 
	`Æ_dump_lše
(
p
, "%s", 
buf
);

322 ià(++
n
 == 3) {

323 
	`Æ_dump
(
p
, "\n");

324 
	`Æ_dump_lše
(
p
, " ");

325 
n
 = 0;

327 
	`Æ_dump
(
p
, " ");

330 ià(
n
 != 0)

331 
	`Æ_dump
(
p
, "\n");

332 
	}
}

334 
	$š‘6_dump_¡©s
(
¹Æ_lšk
 *
lšk
,

335 
Æ_dump_·¿ms
 *
p
, *
d©a
)

337 
où‘s
;

338 *
où‘sUn™
;

340 
	`Æ_dump
(
p
, " IPv6: InPkts InOctets "

342 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INPKTS
]);

344 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INOCTETS
],

345 &
où‘sUn™
);

346 ià(
où‘s
)

347 
	`Æ_dump
(
p
, "%14.2à%3 ", 
où‘s
, 
où‘sUn™
);

349 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B ", 0);

351 
	`Æ_dump
(
p
, "%18" 
PRIu64
 " %18" PRIu64 "\n",

352 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INDISCARDS
],

353 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INDELIVERS
]);

355 
	`Æ_dump
(
p
, " OutPkts OutOctets "

358 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTPKTS
]);

360 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTOCTETS
],

361 &
où‘sUn™
);

362 ià(
où‘s
)

363 
	`Æ_dump
(
p
, "%14.2à%3 ", 
où‘s
, 
où‘sUn™
);

365 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B ", 0);

367 
	`Æ_dump
(
p
, "%18" 
PRIu64
 " %18" PRIu64 "\n",

368 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTDISCARDS
],

369 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTFORWDATAGRAMS
]);

371 
	`Æ_dump
(
p
, " InMcastPkts InMcastOctets "

374 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INMCASTPKTS
]);

376 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INMCASTOCTETS
],

377 &
où‘sUn™
);

378 ià(
où‘s
)

379 
	`Æ_dump
(
p
, "%14.2à%3 ", 
où‘s
, 
où‘sUn™
);

381 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B ", 0);

383 
	`Æ_dump
(
p
, "%18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INBCASTPKTS
]);

384 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INBCASTOCTETS
],

385 &
où‘sUn™
);

386 ià(
où‘s
)

387 
	`Æ_dump
(
p
, "%14.2à%3s\n", 
où‘s
, 
où‘sUn™
);

389 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B\n", 0);

391 
	`Æ_dump
(
p
, " OutMcastPkts OutMcastOctets "

394 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTMCASTPKTS
]);

396 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTMCASTOCTETS
],

397 &
où‘sUn™
);

398 ià(
où‘s
)

399 
	`Æ_dump
(
p
, "%14.2à%3 ", 
où‘s
, 
où‘sUn™
);

401 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B ", 0);

403 
	`Æ_dump
(
p
, "%18" 
PRIu64
 " ", 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTBCASTPKTS
]);

404 
où‘s
 = 
	`Æ_ÿnûl_down_by‹s
(
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTBCASTOCTETS
],

405 &
où‘sUn™
);

406 ià(
où‘s
)

407 
	`Æ_dump
(
p
, "%14.2à%3s\n", 
où‘s
, 
où‘sUn™
);

409 
	`Æ_dump
(
p
, "%16" 
PRIu64
 " B\n", 0);

411 
	`Æ_dump
(
p
, " ReasmOKs ReasmFails "

413 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 "\n",

414 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_REASMOKS
],

415 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_REASMFAILS
],

416 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_REASMREQDS
],

417 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_REASMTIMEOUT
]);

419 
	`Æ_dump
(
p
, " FragOKs FragFails "

421 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 "\n",

422 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_FRAGOKS
],

423 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_FRAGFAILS
],

424 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_FRAGCREATES
]);

426 
	`Æ_dump
(
p
, " InHdrErrors InTooBigErrors "

428 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 "\n",

429 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INHDRERRORS
],

430 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INTOOBIGERRORS
],

431 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INNOROUTES
],

432 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INADDRERRORS
]);

434 
	`Æ_dump
(
p
, " InUnknownProtos InTruncatedPkts "

436 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 "\n",

437 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INUNKNOWNPROTOS
],

438 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_INTRUNCATEDPKTS
],

439 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_OUTNOROUTES
],

440 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_CSUMERRORS
]);

442 
	`Æ_dump
(
p
, " InNoECTPkts InECT1Pkts "

444 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 "\n",

445 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_NOECTPKTS
],

446 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_ECT1PKTS
],

447 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_ECT0PKTS
],

448 
lšk
->
l_¡©s
[
RTNL_LINK_IP6_CEPKTS
]);

450 
	`Æ_dump
(
p
, " ICMPv6: InMsgs InErrors "

452 
	`Æ_dump
(
p
, " %18" 
PRIu64
 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 " %18" PRIu64 "\n",

453 
lšk
->
l_¡©s
[
RTNL_LINK_ICMP6_INMSGS
],

454 
lšk
->
l_¡©s
[
RTNL_LINK_ICMP6_INERRORS
],

455 
lšk
->
l_¡©s
[
RTNL_LINK_ICMP6_OUTMSGS
],

456 
lšk
->
l_¡©s
[
RTNL_LINK_ICMP6_OUTERRORS
],

457 
lšk
->
l_¡©s
[
RTNL_LINK_ICMP6_CSUMERRORS
]);

458 
	}
}

460 cÚ¡ 
Æa_pŞicy
 
	g´Ùšfo_pŞicy
 = {

461 .
ty³
 = 
NLA_NESTED
,

464 
¹Æ_lšk_af_İs
 
	gš‘6_İs
 = {

465 .
ao_çmy
 = 
AF_INET6
,

466 .
	gao_®loc
 = &
š‘6_®loc
,

467 .
	gao_şÚe
 = &
š‘6_şÚe
,

468 .
	gao_ä“
 = &
š‘6_ä“
,

469 .
	gao_·r£_´Ùšfo
 = &
š‘6_·r£_´Ùšfo
,

470 .
	gao_·r£_af
 = &
š‘6_·r£_´Ùšfo
,

471 .
	gao_dump
[
NL_DUMP_DETAILS
] = &
š‘6_dump_d‘as
,

472 .
	gao_dump
[
NL_DUMP_STATS
] = &
š‘6_dump_¡©s
,

473 .
	gao_´Ùšfo_pŞicy
 = &
´Ùšfo_pŞicy
,

476 
__š™
 
	$š‘6_š™
()

478 
	`¹Æ_lšk_af_»gi¡”
(&
š‘6_İs
);

479 
	}
}

481 
__ex™
 
	$š‘6_ex™
()

483 
	`¹Æ_lšk_af_uÄegi¡”
(&
š‘6_İs
);

484 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/ip6tnl.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<lšux/if_tuÂ–.h
>

33 
	~<Ãtš‘/š.h
>

35 
	#IP6_TNL_ATTR_LINK
 (1 << 0)

	)

36 
	#IP6_TNL_ATTR_LOCAL
 (1 << 1)

	)

37 
	#IP6_TNL_ATTR_REMOTE
 (1 << 2)

	)

38 
	#IP6_TNL_ATTR_TTL
 (1 << 3)

	)

39 
	#IP6_TNL_ATTR_TOS
 (1 << 4)

	)

40 
	#IP6_TNL_ATTR_ENCAPLIMIT
 (1 << 5)

	)

41 
	#IP6_TNL_ATTR_FLAGS
 (1 << 6)

	)

42 
	#IP6_TNL_ATTR_PROTO
 (1 << 7)

	)

43 
	#IP6_TNL_ATTR_FLOWINFO
 (1 << 8)

	)

45 
	s6_Šl_šfo


47 
ušt8_t
 
	m‰l
;

48 
ušt8_t
 
	mtos
;

49 
ušt8_t
 
	m’ÿp_lim™
;

50 
ušt8_t
 
	m´Ùo
;

51 
ušt32_t
 
	mæags
;

52 
ušt32_t
 
	mlšk
;

53 
ušt32_t
 
	mæowšfo
;

54 
š6_addr
 
	mloÿl
;

55 
š6_addr
 
	m»mÙe
;

56 
ušt32_t
 
	m6_Šl_mask
;

59 
Æa_pŞicy
 
	g6_Šl_pŞicy
[
IFLA_IPTUN_MAX
 + 1] = {

60 [
IFLA_IPTUN_LINK
] = { .
ty³
 = 
NLA_U32
 },

61 [
IFLA_IPTUN_LOCAL
] = { .
mšËn
 = (
š6_addr
) },

62 [
IFLA_IPTUN_REMOTE
] = { .
mšËn
 = (
š6_addr
) },

63 [
IFLA_IPTUN_TTL
] = { .
ty³
 = 
NLA_U8
 },

64 [
IFLA_IPTUN_TOS
] = { .
ty³
 = 
NLA_U8
 },

65 [
IFLA_IPTUN_ENCAP_LIMIT
] = { .
ty³
 = 
NLA_U8
 },

66 [
IFLA_IPTUN_FLOWINFO
] = { .
ty³
 = 
NLA_U32
 },

67 [
IFLA_IPTUN_FLAGS
] = { .
ty³
 = 
NLA_U32
 },

68 [
IFLA_IPTUN_PROTO
] = { .
ty³
 = 
NLA_U8
 },

71 
	$6_Šl_®loc
(
¹Æ_lšk
 *
lšk
)

73 
6_Šl_šfo
 *
6_Šl
;

75 
6_Šl
 = 
	`ÿÎoc
(1, (*ip6_tnl));

76 ià(!
6_Šl
)

77  -
NLE_NOMEM
;

79 
lšk
->
l_šfo
 = 
6_Šl
;

82 
	}
}

84 
	$6_Šl_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

85 
Æ©Œ
 *
x¡©s
)

87 
Æ©Œ
 *
tb
[
IFLA_IPTUN_MAX
 + 1];

88 
6_Šl_šfo
 *
6_Šl
;

89 
”r
;

91 
	`NL_DBG
(3, "Parsing IP6_TNL†ink info");

93 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_IPTUN_MAX
, 
d©a
, 
6_Šl_pŞicy
);

94 ià(
”r
 < 0)

95 
”rout
;

97 
”r
 = 
	`6_Šl_®loc
(
lšk
);

98 ià(
”r
 < 0)

99 
”rout
;

101 
6_Šl
 = 
lšk
->
l_šfo
;

103 ià(
tb
[
IFLA_IPTUN_LINK
]) {

104 
6_Šl
->
lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_LINK
]);

105 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_LINK
;

108 ià(
tb
[
IFLA_IPTUN_LOCAL
]) {

109 
	`Æa_memıy
(&
6_Šl
->
loÿl
, 
tb
[
IFLA_IPTUN_LOCAL
], (
š6_addr
));

110 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_LOCAL
;

113 ià(
tb
[
IFLA_IPTUN_REMOTE
]) {

114 
	`Æa_memıy
(&
6_Šl
->
»mÙe
, 
tb
[
IFLA_IPTUN_REMOTE
], (
š6_addr
));

115 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_REMOTE
;

118 ià(
tb
[
IFLA_IPTUN_TTL
]) {

119 
6_Šl
->
‰l
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TTL
]);

120 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_TTL
;

123 ià(
tb
[
IFLA_IPTUN_TOS
]) {

124 
6_Šl
->
tos
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TOS
]);

125 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_TOS
;

128 ià(
tb
[
IFLA_IPTUN_ENCAP_LIMIT
]) {

129 
6_Šl
->
’ÿp_lim™
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_ENCAP_LIMIT
]);

130 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_ENCAPLIMIT
;

133 ià(
tb
[
IFLA_IPTUN_FLAGS
]) {

134 
6_Šl
->
æags
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_FLAGS
]);

135 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_FLAGS
;

138 ià(
tb
[
IFLA_IPTUN_FLOWINFO
]) {

139 
6_Šl
->
æowšfo
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_FLOWINFO
]);

140 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_FLOWINFO
;

143 ià(
tb
[
IFLA_IPTUN_PROTO
]) {

144 
6_Šl
->
´Ùo
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_PROTO
]);

145 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_PROTO
;

148 
”r
 = 0;

150 
”rout
:

151  
”r
;

152 
	}
}

154 
	$6_Šl_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

156 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

157 
Æ©Œ
 *
d©a
;

159 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

160 ià(!
d©a
)

161  -
NLE_MSGSIZE
;

163 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_LINK
)

164 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_LINK
, 
6_Šl
->
lšk
);

166 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_LOCAL
)

167 
	`NLA_PUT
(
msg
, 
IFLA_IPTUN_LOCAL
, (
š6_addr
), &
6_Šl
->
loÿl
);

169 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_REMOTE
)

170 
	`NLA_PUT
(
msg
, 
IFLA_IPTUN_REMOTE
, (
š6_addr
), &
6_Šl
->
»mÙe
);

172 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_TTL
)

173 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TTL
, 
6_Šl
->
‰l
);

175 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_TOS
)

176 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TOS
, 
6_Šl
->
tos
);

178 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_ENCAPLIMIT
)

179 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_ENCAP_LIMIT
, 
6_Šl
->
’ÿp_lim™
);

181 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_FLAGS
)

182 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_FLAGS
, 
6_Šl
->
æags
);

184 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_FLOWINFO
)

185 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_FLOWINFO
, 
6_Šl
->
æowšfo
);

188 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_PROTO
)

189 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_PROTO
, 
6_Šl
->
´Ùo
);

191 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_PROTO
, 0);

193 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

195 
Æa_put_çu»
:

197 
	}
}

199 
	$6_Šl_ä“
(
¹Æ_lšk
 *
lšk
)

201 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

203 
	`ä“
(
6_Šl
);

204 
lšk
->
l_šfo
 = 
NULL
;

205 
	}
}

207 
	$6_Šl_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

209 
	`Æ_dump
(
p
, "6_ŠÈ: %s", 
lšk
->
l_Çme
);

210 
	}
}

212 
	$6_Šl_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

214 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

215 *
Çme
, 
addr
[
INET6_ADDRSTRLEN
];

217 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_LINK
) {

218 
	`Æ_dump
(
p
, "†ink ");

219 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

220 ià(
Çme
)

221 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

223 
	`Æ_dump_lše
(
p
, "%u\n", 
6_Šl
->
lšk
);

226 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_LOCAL
) {

227 
	`Æ_dump
(
p
, "†ocal ");

229 if(
	`š‘_Áİ
(
AF_INET6
, &
6_Šl
->
loÿl
, 
addr
, 
INET6_ADDRSTRLEN
))

230 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

232 
	`Æ_dump_lše
(
p
, "%#x\n", 
6_Šl
->
loÿl
);

235 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_REMOTE
) {

236 
	`Æ_dump
(
p
, "„emote ");

238 if(
	`š‘_Áİ
(
AF_INET6
, &
6_Šl
->
»mÙe
, 
addr
, 
INET6_ADDRSTRLEN
))

239 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

241 
	`Æ_dump_lše
(
p
, "%#x\n", 
6_Šl
->
»mÙe
);

244 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_TTL
) {

245 
	`Æ_dump
(
p
, "tl ");

246 
	`Æ_dump_lše
(
p
, "%d\n", 
6_Šl
->
‰l
);

249 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_TOS
) {

250 
	`Æ_dump
(
p
, "os ");

251 
	`Æ_dump_lše
(
p
, "%d\n", 
6_Šl
->
tos
);

254 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_ENCAPLIMIT
) {

255 
	`Æ_dump
(
p
, "ƒncaplimit ");

256 
	`Æ_dump_lše
(
p
, "%d\n", 
6_Šl
->
’ÿp_lim™
);

259 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_FLAGS
) {

260 
	`Æ_dump
(
p
, " flags ");

261 
	`Æ_dump_lše
(
p
, " (%x)\n", 
6_Šl
->
æags
);

264 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_FLOWINFO
) {

265 
	`Æ_dump
(
p
, " flowinfo ");

266 
	`Æ_dump_lše
(
p
, " (%x)\n", 
6_Šl
->
æowšfo
);

269 ià(
6_Šl
->
6_Šl_mask
 & 
IP6_TNL_ATTR_PROTO
) {

270 
	`Æ_dump
(
p
, "…roto ");

271 
	`Æ_dump_lše
(
p
, " (%x)\n", 
6_Šl
->
´Ùo
);

273 
	}
}

275 
	$6_Šl_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

277 
6_Šl_šfo
 *
6_Šl_d¡
, *
6_Šl_¤c
 = 
¤c
->
l_šfo
;

278 
”r
;

280 
d¡
->
l_šfo
 = 
NULL
;

282 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "ip6tnl");

283 ià(
”r
 < 0)

284  
”r
;

286 
6_Šl_d¡
 = 
d¡
->
l_šfo
;

288 ià(!
6_Šl_d¡
 || !
6_Šl_¤c
)

289 
	`BUG
();

291 
	`memıy
(
6_Šl_d¡
, 
6_Šl_¤c
, (
6_Šl_šfo
));

294 
	}
}

296 
¹Æ_lšk_šfo_İs
 
	g6_Šl_šfo_İs
 = {

297 .
io_Çme
 = "ip6tnl",

298 .
	gio_®loc
 = 
6_Šl_®loc
,

299 .
	gio_·r£
 = 
6_Šl_·r£
,

300 .
	gio_dump
 = {

301 [
NL_DUMP_LINE
] = 
6_Šl_dump_lše
,

302 [
NL_DUMP_DETAILS
] = 
6_Šl_dump_d‘as
,

304 .
	gio_şÚe
 = 
6_Šl_şÚe
,

305 .
	gio_put_©Œs
 = 
6_Šl_put_©Œs
,

306 .
	gio_ä“
 = 
6_Šl_ä“
,

309 
	#IS_IP6_TNL_LINK_ASSERT
(
lšk
)\

310 ià((
lšk
)->
l_šfo_İs
 !ğ&
6_Šl_šfo_İs
) {\

311 
	`APPBUG
("Link is‚ot‡ ip6_tnl†ink. setype \"ip6tnl\" first.");\

312  -
NLE_OPNOTSUPP
;\

313 }

	)

315 
¹Æ_lšk
 *
	$¹Æ_lšk_6_Šl_®loc
()

317 
¹Æ_lšk
 *
lšk
;

318 
”r
;

320 
lšk
 = 
	`¹Æ_lšk_®loc
();

321 ià(!
lšk
)

322  
NULL
;

324 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "ip6tnl");

325 ià(
”r
 < 0) {

326 
	`¹Æ_lšk_put
(
lšk
);

327  
NULL
;

330  
lšk
;

331 
	}
}

339 
	$¹Æ_lšk_is_6_Šl
(
¹Æ_lšk
 *
lšk
)

341  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "ip6tnl");

342 
	}
}

352 
	$¹Æ_lšk_6_Šl_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

354 
¹Æ_lšk
 *
lšk
;

355 
”r
;

357 
lšk
 = 
	`¹Æ_lšk_6_Šl_®loc
();

358 ià(!
lšk
)

359  -
NLE_NOMEM
;

361 if(
Çme
)

362 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

364 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

365 
	`¹Æ_lšk_put
(
lšk
);

367  
”r
;

368 
	}
}

377 
	$¹Æ_lšk_6_Šl_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

379 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

381 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

383 
6_Šl
->
lšk
 = 
šdex
;

384 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_LINK
;

387 
	}
}

395 
ušt32_t
 
	$¹Æ_lšk_6_Šl_g‘_lšk
(
¹Æ_lšk
 *
lšk
)

397 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

399 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

401  
6_Šl
->
lšk
;

402 
	}
}

411 
	$¹Æ_lšk_6_Šl_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *
addr
)

413 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

415 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

417 
	`memıy
(&
6_Šl
->
loÿl
, 
addr
, (
š6_addr
));

418 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_LOCAL
;

421 
	}
}

429 
	$¹Æ_lšk_6_Šl_g‘_loÿl
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *
addr
)

431 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

433 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

435 
	`memıy
(
addr
, &
6_Šl
->
loÿl
, (
š6_addr
));

438 
	}
}

447 
	$¹Æ_lšk_6_Šl_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *
addr
)

449 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

451 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

453 
	`memıy
(&
6_Šl
->
»mÙe
, 
addr
, (
š6_addr
));

454 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_REMOTE
;

457 
	}
}

465 
	$¹Æ_lšk_6_Šl_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
, 
š6_addr
 *
addr
)

467 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

469 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

471 
	`memıy
(
addr
, &
6_Šl
->
»mÙe
, (
š6_addr
));

474 
	}
}

483 
	$¹Æ_lšk_6_Šl_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
)

485 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

487 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

489 
6_Šl
->
‰l
 =tl;

490 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_TTL
;

493 
	}
}

501 
ušt8_t
 
	$¹Æ_lšk_6_Šl_g‘_‰l
(
¹Æ_lšk
 *
lšk
)

503 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

505 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

507  
6_Šl
->
‰l
;

508 
	}
}

517 
	$¹Æ_lšk_6_Šl_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
)

519 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

521 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

523 
6_Šl
->
tos
 =os;

524 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_TOS
;

527 
	}
}

535 
ušt8_t
 
	$¹Æ_lšk_6_Šl_g‘_tos
(
¹Æ_lšk
 *
lšk
)

537 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

539 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

541  
6_Šl
->
tos
;

542 
	}
}

551 
	$¹Æ_lšk_6_Šl_£t_’ÿ¶im™
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
’ÿp_lim™
)

553 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

555 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

557 
6_Šl
->
’ÿp_lim™
 =ƒncap_limit;

558 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_ENCAPLIMIT
;

561 
	}
}

569 
ušt8_t
 
	$¹Æ_lšk_6_Šl_g‘_’ÿ¶im™
(
¹Æ_lšk
 *
lšk
)

571 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

573 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

575  
6_Šl
->
’ÿp_lim™
;

576 
	}
}

585 
	$¹Æ_lšk_6_Šl_£t_æowšfo
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
æowšfo
)

587 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

589 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

591 
6_Šl
->
æowšfo
 = flowinfo;

592 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_FLOWINFO
;

595 
	}
}

603 
ušt32_t
 
	$¹Æ_lšk_6_Šl_g‘_æowšfo
(
¹Æ_lšk
 *
lšk
)

605 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

607 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

609  
6_Šl
->
æowšfo
;

610 
	}
}

619 
	$¹Æ_lšk_6_Šl_£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
æags
)

621 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

623 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

625 
6_Šl
->
æags
 = flags;

626 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_FLAGS
;

629 
	}
}

637 
ušt32_t
 
	$¹Æ_lšk_6_Šl_g‘_æags
(
¹Æ_lšk
 *
lšk
)

639 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

641 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

643  
6_Šl
->
æags
;

644 
	}
}

653 
	$¹Æ_lšk_6_Šl_£t_´Ùo
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
´Ùo
)

655 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

657 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

659 
6_Šl
->
´Ùo
 =…roto;

660 
6_Šl
->
6_Šl_mask
 |ğ
IP6_TNL_ATTR_PROTO
;

663 
	}
}

671 
ušt8_t
 
	$¹Æ_lšk_6_Šl_g‘_´Ùo
(
¹Æ_lšk
 *
lšk
)

673 
6_Šl_šfo
 *
6_Šl
 = 
lšk
->
l_šfo
;

675 
	`IS_IP6_TNL_LINK_ASSERT
(
lšk
);

677  
6_Šl
->
´Ùo
;

678 
	}
}

680 
__š™
 
	$6_Šl_š™
()

682 
	`¹Æ_lšk_»gi¡”_šfo
(&
6_Šl_šfo_İs
);

683 
	}
}

685 
__ex™
 
	$6_Šl_ex™
()

687 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
6_Šl_šfo_İs
);

688 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/ipgre.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<lšux/if_tuÂ–.h
>

34 
	#IPGRE_ATTR_LINK
 (1 << 0)

	)

35 
	#IPGRE_ATTR_IFLAGS
 (1 << 1)

	)

36 
	#IPGRE_ATTR_OFLAGS
 (1 << 2)

	)

37 
	#IPGRE_ATTR_IKEY
 (1 << 3)

	)

38 
	#IPGRE_ATTR_OKEY
 (1 << 4)

	)

39 
	#IPGRE_ATTR_LOCAL
 (1 << 5)

	)

40 
	#IPGRE_ATTR_REMOTE
 (1 << 6)

	)

41 
	#IPGRE_ATTR_TTL
 (1 << 7)

	)

42 
	#IPGRE_ATTR_TOS
 (1 << 8)

	)

43 
	#IPGRE_ATTR_PMTUDISC
 (1 << 9)

	)

45 
	sg»_šfo


47 
ušt8_t
 
	m‰l
;

48 
ušt8_t
 
	mtos
;

49 
ušt8_t
 
	mpmtudisc
;

50 
ušt16_t
 
	miæags
;

51 
ušt16_t
 
	moæags
;

52 
ušt32_t
 
	mikey
;

53 
ušt32_t
 
	mokey
;

54 
ušt32_t
 
	mlšk
;

55 
ušt32_t
 
	mloÿl
;

56 
ušt32_t
 
	m»mÙe
;

57 
ušt32_t
 
	mg»_mask
;

60 
Æa_pŞicy
 
	gg»_pŞicy
[
IFLA_GRE_MAX
 + 1] = {

61 [
IFLA_GRE_LINK
] = { .
ty³
 = 
NLA_U32
 },

62 [
IFLA_GRE_IFLAGS
] = { .
ty³
 = 
NLA_U16
 },

63 [
IFLA_GRE_OFLAGS
] = { .
ty³
 = 
NLA_U16
 },

64 [
IFLA_GRE_IKEY
] = { .
ty³
 = 
NLA_U32
 },

65 [
IFLA_GRE_OKEY
] = { .
ty³
 = 
NLA_U32
 },

66 [
IFLA_GRE_LOCAL
] = { .
ty³
 = 
NLA_U32
 },

67 [
IFLA_GRE_REMOTE
] = { .
ty³
 = 
NLA_U32
 },

68 [
IFLA_GRE_TTL
] = { .
ty³
 = 
NLA_U8
 },

69 [
IFLA_GRE_TOS
] = { .
ty³
 = 
NLA_U8
 },

70 [
IFLA_GRE_PMTUDISC
] = { .
ty³
 = 
NLA_U8
 },

73 
	$g»_®loc
(
¹Æ_lšk
 *
lšk
)

75 
g»_šfo
 *
g»
;

77 
g»
 = 
	`ÿÎoc
(1, (*ipgre));

78 ià(!
g»
)

79  -
NLE_NOMEM
;

81 
lšk
->
l_šfo
 = 
g»
;

84 
	}
}

86 
	$g»_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

87 
Æ©Œ
 *
x¡©s
)

89 
Æ©Œ
 *
tb
[
IFLA_IPTUN_MAX
 + 1];

90 
g»_šfo
 *
g»
;

91 
”r
;

93 
	`NL_DBG
(3, "Parsing IPGRE†ink info");

95 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_GRE_MAX
, 
d©a
, 
g»_pŞicy
);

96 ià(
”r
 < 0)

97 
”rout
;

99 
”r
 = 
	`g»_®loc
(
lšk
);

100 ià(
”r
 < 0)

101 
”rout
;

103 
g»
 = 
lšk
->
l_šfo
;

105 ià(
tb
[
IFLA_GRE_LINK
]) {

106 
g»
->
lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GRE_LINK
]);

107 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_LINK
;

110 ià(
tb
[
IFLA_GRE_IFLAGS
]) {

111 
g»
->
iæags
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_GRE_IFLAGS
]);

112 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_IFLAGS
;

115 ià(
tb
[
IFLA_GRE_OFLAGS
]) {

116 
g»
->
oæags
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_GRE_OFLAGS
]);

117 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_OFLAGS
;

120 ià(
tb
[
IFLA_GRE_IKEY
]) {

121 
g»
->
ikey
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GRE_IKEY
]);

122 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_IKEY
;

125 ià(
tb
[
IFLA_GRE_OKEY
]) {

126 
g»
->
okey
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GRE_OKEY
]);

127 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_OKEY
;

130 ià(
tb
[
IFLA_GRE_LOCAL
]) {

131 
g»
->
loÿl
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GRE_LOCAL
]);

132 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_LOCAL
;

135 ià(
tb
[
IFLA_GRE_LOCAL
]) {

136 
g»
->
»mÙe
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_GRE_LOCAL
]);

137 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_REMOTE
;

140 ià(
tb
[
IFLA_GRE_TTL
]) {

141 
g»
->
‰l
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_GRE_TTL
]);

142 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_TTL
;

145 ià(
tb
[
IFLA_GRE_TOS
]) {

146 
g»
->
tos
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_GRE_TOS
]);

147 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_TOS
;

150 ià(
tb
[
IFLA_GRE_PMTUDISC
]) {

151 
g»
->
pmtudisc
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_GRE_PMTUDISC
]);

152 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_PMTUDISC
;

155 
”r
 = 0;

157 
”rout
:

158  
”r
;

159 
	}
}

161 
	$g»_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

163 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

164 
Æ©Œ
 *
d©a
;

166 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

167 ià(!
d©a
)

168  -
NLE_MSGSIZE
;

170 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_LINK
)

171 
	`NLA_PUT_U32
(
msg
, 
IFLA_GRE_LINK
, 
g»
->
lšk
);

173 ià(
g»
->
g»_mask
 & 
IFLA_GRE_IFLAGS
)

174 
	`NLA_PUT_U16
(
msg
, 
IFLA_GRE_IFLAGS
, 
g»
->
iæags
);

176 ià(
g»
->
g»_mask
 & 
IFLA_GRE_OFLAGS
)

177 
	`NLA_PUT_U16
(
msg
, 
IFLA_GRE_OFLAGS
, 
g»
->
oæags
);

179 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_IKEY
)

180 
	`NLA_PUT_U32
(
msg
, 
IFLA_GRE_IKEY
, 
g»
->
ikey
);

182 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_OKEY
)

183 
	`NLA_PUT_U32
(
msg
, 
IFLA_GRE_OKEY
, 
g»
->
okey
);

185 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_LOCAL
)

186 
	`NLA_PUT_U32
(
msg
, 
IFLA_GRE_LOCAL
, 
g»
->
loÿl
);

188 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_REMOTE
)

189 
	`NLA_PUT_U32
(
msg
, 
IFLA_GRE_REMOTE
, 
g»
->
»mÙe
);

191 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_TTL
)

192 
	`NLA_PUT_U8
(
msg
, 
IFLA_GRE_TTL
, 
g»
->
‰l
);

194 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_TOS
)

195 
	`NLA_PUT_U8
(
msg
, 
IFLA_GRE_TOS
, 
g»
->
tos
);

197 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_PMTUDISC
)

198 
	`NLA_PUT_U8
(
msg
, 
IFLA_GRE_PMTUDISC
, 
g»
->
pmtudisc
);

200 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

202 
Æa_put_çu»
:

205 
	}
}

207 
	$g»_ä“
(
¹Æ_lšk
 *
lšk
)

209 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

211 
	`ä“
(
g»
);

212 
lšk
->
l_šfo
 = 
NULL
;

213 
	}
}

215 
	$g»_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

217 
	`Æ_dump
(
p
, "g» : %s", 
lšk
->
l_Çme
);

218 
	}
}

220 
	$g»_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

222 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

223 *
Çme
, 
addr
[
INET_ADDRSTRLEN
];

225 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_LINK
) {

226 
	`Æ_dump
(
p
, "†ink ");

227 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

228 ià(
Çme
)

229 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

231 
	`Æ_dump_lše
(
p
, "%u\n", 
g»
->
lšk
);

234 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_IFLAGS
) {

235 
	`Æ_dump
(
p
, " iflags ");

236 
	`Æ_dump_lše
(
p
, "%x\n", 
g»
->
iæags
);

239 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_OFLAGS
) {

240 
	`Æ_dump
(
p
, " oflags ");

241 
	`Æ_dump_lše
(
p
, "%x\n", 
g»
->
oæags
);

244 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_IKEY
) {

245 
	`Æ_dump
(
p
, " ikey ");

246 
	`Æ_dump_lše
(
p
, "%x\n",
g»
->
ikey
);

249 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_OKEY
) {

250 
	`Æ_dump
(
p
, " okey ");

251 
	`Æ_dump_lše
(
p
, "%x\n", 
g»
->
okey
);

254 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_LOCAL
) {

255 
	`Æ_dump
(
p
, "†ocal ");

256 if(
	`š‘_Áİ
(
AF_INET
, &
g»
->
loÿl
, 
addr
, (addr)))

257 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

259 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
g»
->
loÿl
));

262 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_REMOTE
) {

263 
	`Æ_dump
(
p
, "„emote ");

264 if(
	`š‘_Áİ
(
AF_INET
, &
g»
->
»mÙe
, 
addr
, (addr)))

265 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

267 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
g»
->
»mÙe
));

270 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_TTL
) {

271 
	`Æ_dump
(
p
, "tl ");

272 
	`Æ_dump_lše
(
p
, "%u\n", 
g»
->
‰l
);

275 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_TOS
) {

276 
	`Æ_dump
(
p
, "os ");

277 
	`Æ_dump_lše
(
p
, "%u\n", 
g»
->
tos
);

280 ià(
g»
->
g»_mask
 & 
IPGRE_ATTR_PMTUDISC
) {

281 
	`Æ_dump
(
p
, "…mtudisc ");

282 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
g»
->
pmtudisc
);

284 
	}
}

286 
	$g»_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

288 
g»_šfo
 *
g»_d¡
, *
g»_¤c
 = 
¤c
->
l_šfo
;

289 
”r
;

291 
d¡
->
l_šfo
 = 
NULL
;

293 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "gre");

294 ià(
”r
 < 0)

295  
”r
;

297 
g»_d¡
 = 
d¡
->
l_šfo
;

299 ià(!
g»_d¡
 || !
g»_¤c
)

300 
	`BUG
();

302 
	`memıy
(
g»_d¡
, 
g»_¤c
, (
g»_šfo
));

305 
	}
}

307 
¹Æ_lšk_šfo_İs
 
	gg»_šfo_İs
 = {

308 .
io_Çme
 = "gre",

309 .
	gio_®loc
 = 
g»_®loc
,

310 .
	gio_·r£
 = 
g»_·r£
,

311 .
	gio_dump
 = {

312 [
NL_DUMP_LINE
] = 
g»_dump_lše
,

313 [
NL_DUMP_DETAILS
] = 
g»_dump_d‘as
,

315 .
	gio_şÚe
 = 
g»_şÚe
,

316 .
	gio_put_©Œs
 = 
g»_put_©Œs
,

317 .
	gio_ä“
 = 
g»_ä“
,

320 
	#IS_IPGRE_LINK_ASSERT
(
lšk
) \

321 ià((
lšk
)->
l_šfo_İs
 !ğ&
g»_šfo_İs
) { \

322 
	`APPBUG
("Link is‚ot‡ ipgre†ink. setype \"gre\" first.");\

323  -
NLE_OPNOTSUPP
; \

324 }

	)

326 
¹Æ_lšk
 *
	$¹Æ_lšk_g»_®loc
()

328 
¹Æ_lšk
 *
lšk
;

329 
”r
;

331 
lšk
 = 
	`¹Æ_lšk_®loc
();

332 ià(!
lšk
)

333  
NULL
;

335 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "gre");

336 ià(
”r
 < 0) {

337 
	`¹Æ_lšk_put
(
lšk
);

338  
NULL
;

341  
lšk
;

342 
	}
}

350 
	$¹Æ_lšk_is_g»
(
¹Æ_lšk
 *
lšk
)

352  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "gre");

353 
	}
}

362 
	$¹Æ_lšk_g»_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

364 
¹Æ_lšk
 *
lšk
;

365 
”r
;

367 
lšk
 = 
	`¹Æ_lšk_g»_®loc
();

368 ià(!
lšk
)

369  -
NLE_NOMEM
;

371 if(
Çme
)

372 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

374 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

375 
	`¹Æ_lšk_put
(
lšk
);

377  
”r
;

378 
	}
}

386 
	$¹Æ_lšk_g»_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

388 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

390 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

392 
g»
->
lšk
 = 
šdex
;

393 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_LINK
;

396 
	}
}

404 
ušt32_t
 
	$¹Æ_lšk_g»_g‘_lšk
(
¹Æ_lšk
 *
lšk
)

406 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

408 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

410  
g»
->
lšk
;

411 
	}
}

420 
	$¹Æ_lšk_g»_£t_iæags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
iæags
)

422 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

424 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

426 
g»
->
iæags
 = iflags;

427 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_IFLAGS
;

430 
	}
}

438 
ušt16_t
 
	$¹Æ_lšk_g»_g‘_iæags
(
¹Æ_lšk
 *
lšk
)

440 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

442 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

444  
g»
->
iæags
;

445 
	}
}

454 
	$¹Æ_lšk_g»_£t_oæags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
oæags
)

456 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

458 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

460 
g»
->
oæags
 = oflags;

461 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_OFLAGS
;

464 
	}
}

472 
ušt16_t
 
	$¹Æ_lšk_g»_g‘_oæags
(
¹Æ_lšk
 *
lšk
)

474 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

476 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

478  
g»
->
oæags
;

479 
	}
}

488 
	$¹Æ_lšk_g»_£t_ikey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ikey
)

490 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

492 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

494 
g»
->
ikey
 = ikey;

495 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_IKEY
;

498 
	}
}

506 
ušt32_t
 
	$¹Æ_lšk_g»_g‘_ikey
(
¹Æ_lšk
 *
lšk
)

508 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

510 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

512  
g»
->
ikey
;

513 
	}
}

522 
	$¹Æ_lšk_g»_£t_okey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
okey
)

524 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

526 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

528 
g»
->
okey
 = okey;

529 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_OKEY
;

532 
	}
}

540 
ušt32_t
 
	$¹Æ_lšk_g»_g‘_okey
(
¹Æ_lšk
 *
lšk
)

542 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

544 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

546  
g»
->
okey
;

547 
	}
}

556 
	$¹Æ_lšk_g»_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

558 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

560 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

562 
g»
->
loÿl
 = 
addr
;

563 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_LOCAL
;

566 
	}
}

574 
ušt32_t
 
	$¹Æ_lšk_g»_g‘_loÿl
(
¹Æ_lšk
 *
lšk
)

576 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

578 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

580  
g»
->
loÿl
;

581 
	}
}

590 
	$¹Æ_lšk_g»_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
»mÙe
)

592 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

594 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

596 
g»
->
»mÙe
 =„emote;

597 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_REMOTE
;

600 
	}
}

608 
ušt32_t
 
	$¹Æ_lšk_g»_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
)

610 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

612 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

614  
g»
->
»mÙe
;

615 
	}
}

624 
	$¹Æ_lšk_g»_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
)

626 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

628 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

630 
g»
->
‰l
 =tl;

631 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_TTL
;

634 
	}
}

642 
ušt8_t
 
	$¹Æ_lšk_g»_g‘_‰l
(
¹Æ_lšk
 *
lšk
)

644 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

646 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

648  
g»
->
‰l
;

649 
	}
}

658 
	$¹Æ_lšk_g»_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
)

660 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

662 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

664 
g»
->
tos
 =os;

665 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_TOS
;

668 
	}
}

676 
ušt8_t
 
	$¹Æ_lšk_g»_g‘_tos
(
¹Æ_lšk
 *
lšk
)

678 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

680 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

682  
g»
->
tos
;

683 
	}
}

692 
	$¹Æ_lšk_g»_£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
)

694 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

696 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

698 
g»
->
pmtudisc
 =…mtudisc;

699 
g»
->
g»_mask
 |ğ
IPGRE_ATTR_PMTUDISC
;

702 
	}
}

710 
ušt8_t
 
	$¹Æ_lšk_g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
)

712 
g»_šfo
 *
g»
 = 
lšk
->
l_šfo
;

714 
	`IS_IPGRE_LINK_ASSERT
(
lšk
);

716  
g»
->
pmtudisc
;

717 
	}
}

719 
__š™
 
	$g»_š™
()

721 
	`¹Æ_lšk_»gi¡”_šfo
(&
g»_šfo_İs
);

722 
	}
}

724 
__ex™
 
	$g»_ex™
()

726 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
g»_šfo_İs
);

727 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/ipip.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<lšux/if_tuÂ–.h
>

34 
	#IPIP_ATTR_LINK
 (1 << 0)

	)

35 
	#IPIP_ATTR_LOCAL
 (1 << 1)

	)

36 
	#IPIP_ATTR_REMOTE
 (1 << 2)

	)

37 
	#IPIP_ATTR_TTL
 (1 << 3)

	)

38 
	#IPIP_ATTR_TOS
 (1 << 4)

	)

39 
	#IPIP_ATTR_PMTUDISC
 (1 << 5)

	)

41 
	s_šfo


43 
ušt8_t
 
	m‰l
;

44 
ušt8_t
 
	mtos
;

45 
ušt8_t
 
	mpmtudisc
;

46 
ušt32_t
 
	mlšk
;

47 
ušt32_t
 
	mloÿl
;

48 
ušt32_t
 
	m»mÙe
;

49 
ušt32_t
 
	m_mask
;

52 
Æa_pŞicy
 
	g_pŞicy
[
IFLA_IPTUN_MAX
 + 1] = {

53 [
IFLA_IPTUN_LINK
] = { .
ty³
 = 
NLA_U32
 },

54 [
IFLA_IPTUN_LOCAL
] = { .
ty³
 = 
NLA_U32
 },

55 [
IFLA_IPTUN_REMOTE
] = { .
ty³
 = 
NLA_U32
 },

56 [
IFLA_IPTUN_TTL
] = { .
ty³
 = 
NLA_U8
 },

57 [
IFLA_IPTUN_TOS
] = { .
ty³
 = 
NLA_U8
 },

58 [
IFLA_IPTUN_PMTUDISC
] = { .
ty³
 = 
NLA_U8
 },

61 
	$_®loc
(
¹Æ_lšk
 *
lšk
)

63 
_šfo
 *

;

65 

 = 
	`ÿÎoc
(1, (*ipip));

66 ià(!

)

67  -
NLE_NOMEM
;

69 
lšk
->
l_šfo
 = 

;

72 
	}
}

74 
	$_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

75 
Æ©Œ
 *
x¡©s
)

77 
Æ©Œ
 *
tb
[
IFLA_IPTUN_MAX
 + 1];

78 
_šfo
 *

;

79 
”r
;

81 
	`NL_DBG
(3, "Parsing IPIP†ink info");

83 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_IPTUN_MAX
, 
d©a
, 
_pŞicy
);

84 ià(
”r
 < 0)

85 
”rout
;

87 
”r
 = 
	`_®loc
(
lšk
);

88 ià(
”r
 < 0)

89 
”rout
;

91 

 = 
lšk
->
l_šfo
;

93 ià(
tb
[
IFLA_IPTUN_LINK
]) {

94 

->
lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_LINK
]);

95 

->
_mask
 |ğ
IPIP_ATTR_LINK
;

98 ià(
tb
[
IFLA_IPTUN_LOCAL
]) {

99 

->
loÿl
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_LOCAL
]);

100 

->
_mask
 |ğ
IPIP_ATTR_LOCAL
;

103 ià(
tb
[
IFLA_IPTUN_REMOTE
]) {

104 

->
»mÙe
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_REMOTE
]);

105 

->
_mask
 |ğ
IPIP_ATTR_REMOTE
;

108 ià(
tb
[
IFLA_IPTUN_TTL
]) {

109 

->
‰l
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TTL
]);

110 

->
_mask
 |ğ
IPIP_ATTR_TTL
;

113 ià(
tb
[
IFLA_IPTUN_TOS
]) {

114 

->
tos
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TOS
]);

115 

->
_mask
 |ğ
IPIP_ATTR_TOS
;

118 ià(
tb
[
IFLA_IPTUN_PMTUDISC
]) {

119 

->
pmtudisc
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_PMTUDISC
]);

120 

->
_mask
 |ğ
IPIP_ATTR_PMTUDISC
;

123 
”r
 = 0;

125 
”rout
:

126  
”r
;

127 
	}
}

129 
	$_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

131 
_šfo
 *

 = 
lšk
->
l_šfo
;

132 
Æ©Œ
 *
d©a
;

134 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

135 ià(!
d©a
)

136  -
NLE_MSGSIZE
;

138 ià(

->
_mask
 & 
IPIP_ATTR_LINK
)

139 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_LINK
, 

->
lšk
);

141 ià(

->
_mask
 & 
IPIP_ATTR_LOCAL
)

142 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_LOCAL
, 

->
loÿl
);

144 ià(

->
_mask
 & 
IPIP_ATTR_REMOTE
)

145 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_REMOTE
, 

->
»mÙe
);

147 ià(

->
_mask
 & 
IPIP_ATTR_TTL
)

148 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TTL
, 

->
‰l
);

150 ià(

->
_mask
 & 
IPIP_ATTR_TOS
)

151 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TOS
, 

->
tos
);

153 ià(

->
_mask
 & 
IPIP_ATTR_PMTUDISC
)

154 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_PMTUDISC
, 

->
pmtudisc
);

156 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

158 
Æa_put_çu»
:

160 
	}
}

162 
	$_ä“
(
¹Æ_lšk
 *
lšk
)

164 
_šfo
 *

 = 
lšk
->
l_šfo
;

166 
	`ä“
(

);

167 
lšk
->
l_šfo
 = 
NULL
;

168 
	}
}

170 
	$_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

172 
	`Æ_dump
(
p
, " : %s", 
lšk
->
l_Çme
);

173 
	}
}

175 
	$_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

177 
_šfo
 *

 = 
lšk
->
l_šfo
;

178 *
Çme
, 
addr
[
INET_ADDRSTRLEN
];

180 ià(

->
_mask
 & 
IPIP_ATTR_LINK
) {

181 
	`Æ_dump
(
p
, "†ink ");

182 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

183 ià(
Çme
)

184 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

186 
	`Æ_dump_lše
(
p
, "%u\n", 

->
lšk
);

189 ià(

->
_mask
 & 
IPIP_ATTR_LOCAL
) {

190 
	`Æ_dump
(
p
, "†ocal ");

191 if(
	`š‘_Áİ
(
AF_INET
, &

->
loÿl
, 
addr
, (addr)))

192 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

194 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(

->
loÿl
));

197 ià(

->
_mask
 & 
IPIP_ATTR_REMOTE
) {

198 
	`Æ_dump
(
p
, "„emote ");

199 if(
	`š‘_Áİ
(
AF_INET
, &

->
»mÙe
, 
addr
, (addr)))

200 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

202 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(

->
»mÙe
));

205 ià(

->
_mask
 & 
IPIP_ATTR_TTL
) {

206 
	`Æ_dump
(
p
, "tl ");

207 
	`Æ_dump_lše
(
p
, "%u\n", 

->
‰l
);

210 ià(

->
_mask
 & 
IPIP_ATTR_TOS
) {

211 
	`Æ_dump
(
p
, "os ");

212 
	`Æ_dump_lše
(
p
, "%u\n", 

->
tos
);

215 ià(

->
_mask
 & 
IPIP_ATTR_PMTUDISC
) {

216 
	`Æ_dump
(
p
, "…mtudisc ");

217 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 

->
pmtudisc
);

219 
	}
}

221 
	$_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

223 
_šfo
 *
_d¡
, *
_¤c
 = 
¤c
->
l_šfo
;

224 
”r
;

226 
d¡
->
l_šfo
 = 
NULL
;

228 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "ipip");

229 ià(
”r
 < 0)

230  
”r
;

232 
_d¡
 = 
d¡
->
l_šfo
;

234 ià(!
_d¡
 || !
_¤c
)

235 
	`BUG
();

237 
	`memıy
(
_d¡
, 
_¤c
, (
_šfo
));

240 
	}
}

242 
¹Æ_lšk_šfo_İs
 
	g_šfo_İs
 = {

243 .
io_Çme
 = "ipip",

244 .
	gio_®loc
 = 
_®loc
,

245 .
	gio_·r£
 = 
_·r£
,

246 .
	gio_dump
 = {

247 [
NL_DUMP_LINE
] = 
_dump_lše
,

248 [
NL_DUMP_DETAILS
] = 
_dump_d‘as
,

250 .
	gio_şÚe
 = 
_şÚe
,

251 .
	gio_put_©Œs
 = 
_put_©Œs
,

252 .
	gio_ä“
 = 
_ä“
,

255 
	#IS_IPIP_LINK_ASSERT
(
lšk
) \

256 ià((
lšk
)->
l_šfo_İs
 !ğ&
_šfo_İs
) { \

257 
	`APPBUG
("Link is‚ot‡ ipip†ink. setype \"ipip\" first."); \

258  -
NLE_OPNOTSUPP
; \

259 }

	)

261 
¹Æ_lšk
 *
	$¹Æ_lšk__®loc
()

263 
¹Æ_lšk
 *
lšk
;

264 
”r
;

266 
lšk
 = 
	`¹Æ_lšk_®loc
();

267 ià(!
lšk
)

268  
NULL
;

270 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "ipip");

271 ià(
”r
 < 0) {

272 
	`¹Æ_lšk_put
(
lšk
);

273  
NULL
;

276  
lšk
;

277 
	}
}

285 
	$¹Æ_lšk_is_
(
¹Æ_lšk
 *
lšk
)

287  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "ipip");

288 
	}
}

298 
	$¹Æ_lšk__add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

300 
¹Æ_lšk
 *
lšk
;

301 
”r
;

303 
lšk
 = 
	`¹Æ_lšk__®loc
();

304 ià(!
lšk
)

305  -
NLE_NOMEM
;

307 if(
Çme
)

308 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

310 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

311 
	`¹Æ_lšk_put
(
lšk
);

313  
”r
;

314 
	}
}

323 
	$¹Æ_lšk__£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

325 
_šfo
 *

 = 
lšk
->
l_šfo
;

327 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

329 

->
lšk
 = 
šdex
;

330 

->
_mask
 |ğ
IPIP_ATTR_LINK
;

333 
	}
}

341 
ušt32_t
 
	$¹Æ_lšk__g‘_lšk
(
¹Æ_lšk
 *
lšk
)

343 
_šfo
 *

 = 
lšk
->
l_šfo
;

345 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

347  

->
lšk
;

348 
	}
}

357 
	$¹Æ_lšk__£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

359 
_šfo
 *

 = 
lšk
->
l_šfo
;

361 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

363 

->
loÿl
 = 
addr
;

364 

->
_mask
 |ğ
IPIP_ATTR_LOCAL
;

367 
	}
}

375 
ušt32_t
 
	$¹Æ_lšk__g‘_loÿl
(
¹Æ_lšk
 *
lšk
)

377 
_šfo
 *

 = 
lšk
->
l_šfo
;

379 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

381  

->
loÿl
;

382 
	}
}

391 
	$¹Æ_lšk__£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

393 
_šfo
 *

 = 
lšk
->
l_šfo
;

395 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

397 

->
»mÙe
 = 
addr
;

398 

->
_mask
 |ğ
IPIP_ATTR_REMOTE
;

401 
	}
}

409 
ušt32_t
 
	$¹Æ_lšk__g‘_»mÙe
(
¹Æ_lšk
 *
lšk
)

411 
_šfo
 *

 = 
lšk
->
l_šfo
;

413 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

415  

->
»mÙe
;

416 
	}
}

425 
	$¹Æ_lšk__£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
)

427 
_šfo
 *

 = 
lšk
->
l_šfo
;

429 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

431 

->
‰l
 =tl;

432 

->
_mask
 |ğ
IPIP_ATTR_TTL
;

435 
	}
}

443 
ušt8_t
 
	$¹Æ_lšk__g‘_‰l
(
¹Æ_lšk
 *
lšk
)

445 
_šfo
 *

 = 
lšk
->
l_šfo
;

447 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

449  

->
‰l
;

450 
	}
}

459 
	$¹Æ_lšk__£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
)

461 
_šfo
 *

 = 
lšk
->
l_šfo
;

463 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

465 

->
tos
 =os;

466 

->
_mask
 |ğ
IPIP_ATTR_TOS
;

469 
	}
}

477 
ušt8_t
 
	$¹Æ_lšk__g‘_tos
(
¹Æ_lšk
 *
lšk
)

479 
_šfo
 *

 = 
lšk
->
l_šfo
;

481 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

483  

->
tos
;

484 
	}
}

493 
	$¹Æ_lšk__£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
)

495 
_šfo
 *

 = 
lšk
->
l_šfo
;

497 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

499 

->
pmtudisc
 =…mtudisc;

500 

->
_mask
 |ğ
IPIP_ATTR_PMTUDISC
;

503 
	}
}

511 
ušt8_t
 
	$¹Æ_lšk__g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
)

513 
_šfo
 *

 = 
lšk
->
l_šfo
;

515 
	`IS_IPIP_LINK_ASSERT
(
lšk
);

517  

->
pmtudisc
;

518 
	}
}

520 
__š™
 
	$_š™
()

522 
	`¹Æ_lšk_»gi¡”_šfo
(&
_šfo_İs
);

523 
	}
}

525 
__ex™
 
	$_ex™
()

527 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
_šfo_İs
);

528 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/ipvti.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<lšux/if_tuÂ–.h
>

34 
	#IPVTI_ATTR_LINK
 (1 << 0)

	)

35 
	#IPVTI_ATTR_IKEY
 (1 << 1)

	)

36 
	#IPVTI_ATTR_OKEY
 (1 << 2)

	)

37 
	#IPVTI_ATTR_LOCAL
 (1 << 3)

	)

38 
	#IPVTI_ATTR_REMOTE
 (1 << 4)

	)

40 
	svti_šfo


42 
ušt32_t
 
	mlšk
;

43 
ušt32_t
 
	mikey
;

44 
ušt32_t
 
	mokey
;

45 
ušt32_t
 
	mloÿl
;

46 
ušt32_t
 
	m»mÙe
;

47 
ušt32_t
 
	mvti_mask
;

50 
Æa_pŞicy
 
	gvti_pŞicy
[
IFLA_GRE_MAX
 + 1] = {

51 [
IFLA_VTI_LINK
] = { .
ty³
 = 
NLA_U32
 },

52 [
IFLA_VTI_IKEY
] = { .
ty³
 = 
NLA_U32
 },

53 [
IFLA_VTI_OKEY
] = { .
ty³
 = 
NLA_U32
 },

54 [
IFLA_VTI_LOCAL
] = { .
ty³
 = 
NLA_U32
 },

55 [
IFLA_VTI_REMOTE
] = { .
ty³
 = 
NLA_U32
 },

58 
	$vti_®loc
(
¹Æ_lšk
 *
lšk
)

60 
vti_šfo
 *
vti
;

62 
vti
 = 
	`ÿÎoc
(1, (*ipvti));

63 ià(!
vti
)

64  -
NLE_NOMEM
;

66 
lšk
->
l_šfo
 = 
vti
;

69 
	}
}

71 
	$vti_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

72 
Æ©Œ
 *
x¡©s
)

74 
Æ©Œ
 *
tb
[
IFLA_IPTUN_MAX
 + 1];

75 
vti_šfo
 *
vti
;

76 
”r
;

78 
	`NL_DBG
(3, "Parsing IPVTI†ink info");

80 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_GRE_MAX
, 
d©a
, 
vti_pŞicy
);

81 ià(
”r
 < 0)

82 
”rout
;

84 
”r
 = 
	`vti_®loc
(
lšk
);

85 ià(
”r
 < 0)

86 
”rout
;

88 
vti
 = 
lšk
->
l_šfo
;

90 ià(
tb
[
IFLA_VTI_LINK
]) {

91 
vti
->
lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VTI_LINK
]);

92 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_LINK
;

95 ià(
tb
[
IFLA_VTI_IKEY
]) {

96 
vti
->
ikey
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VTI_IKEY
]);

97 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_IKEY
;

100 ià(
tb
[
IFLA_VTI_OKEY
]) {

101 
vti
->
okey
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VTI_OKEY
]);

102 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_OKEY
;

105 ià(
tb
[
IFLA_VTI_LOCAL
]) {

106 
vti
->
loÿl
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VTI_LOCAL
]);

107 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_LOCAL
;

110 ià(
tb
[
IFLA_VTI_REMOTE
]) {

111 
vti
->
»mÙe
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VTI_REMOTE
]);

112 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_REMOTE
;

115 
”r
 = 0;

117 
”rout
:

118  
”r
;

119 
	}
}

121 
	$vti_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

123 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

124 
Æ©Œ
 *
d©a
;

126 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

127 ià(!
d©a
)

128  -
NLE_MSGSIZE
;

130 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_LINK
)

131 
	`NLA_PUT_U32
(
msg
, 
IFLA_VTI_LINK
, 
vti
->
lšk
);

133 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_IKEY
)

134 
	`NLA_PUT_U32
(
msg
, 
IFLA_VTI_IKEY
, 
vti
->
ikey
);

136 ià(
vti
->
vti_mask
 & 
IFLA_VTI_IKEY
)

137 
	`NLA_PUT_U32
(
msg
, 
IFLA_VTI_OKEY
, 
vti
->
okey
);

139 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_LOCAL
)

140 
	`NLA_PUT_U32
(
msg
, 
IFLA_VTI_LOCAL
, 
vti
->
loÿl
);

142 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_REMOTE
)

143 
	`NLA_PUT_U32
(
msg
, 
IFLA_VTI_REMOTE
, 
vti
->
»mÙe
);

145 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

147 
Æa_put_çu»
:

150 
	}
}

152 
	$vti_ä“
(
¹Æ_lšk
 *
lšk
)

154 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

156 
	`ä“
(
vti
);

157 
lšk
->
l_šfo
 = 
NULL
;

158 
	}
}

160 
	$vti_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

162 
	`Æ_dump
(
p
, "vt˜: %s", 
lšk
->
l_Çme
);

163 
	}
}

165 
	$vti_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

167 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

168 *
Çme
, 
addr
[
INET_ADDRSTRLEN
];

170 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_LINK
) {

171 
	`Æ_dump
(
p
, "†ink ");

172 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

173 ià(
Çme
)

174 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

176 
	`Æ_dump_lše
(
p
, "%u\n", 
vti
->
lšk
);

179 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_IKEY
) {

180 
	`Æ_dump
(
p
, " ikey ");

181 
	`Æ_dump_lše
(
p
, "%x\n",
vti
->
ikey
);

184 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_OKEY
) {

185 
	`Æ_dump
(
p
, " okey ");

186 
	`Æ_dump_lše
(
p
, "%x\n", 
vti
->
okey
);

189 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_LOCAL
) {

190 
	`Æ_dump
(
p
, "†ocal ");

191 if(
	`š‘_Áİ
(
AF_INET
, &
vti
->
loÿl
, 
addr
, (addr)))

192 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

194 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
vti
->
loÿl
));

197 ià(
vti
->
vti_mask
 & 
IPVTI_ATTR_REMOTE
) {

198 
	`Æ_dump
(
p
, "„emote ");

199 if(
	`š‘_Áİ
(
AF_INET
, &
vti
->
»mÙe
, 
addr
, (addr)))

200 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

202 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
vti
->
»mÙe
));

204 
	}
}

206 
	$vti_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

208 
vti_šfo
 *
vti_d¡
, *
vti_¤c
 = 
¤c
->
l_šfo
;

209 
”r
;

211 
d¡
->
l_šfo
 = 
NULL
;

213 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "vti");

214 ià(
”r
 < 0)

215  
”r
;

217 
vti_d¡
 = 
d¡
->
l_šfo
;

219 ià(!
vti_d¡
 || !
vti_¤c
)

220 
	`BUG
();

222 
	`memıy
(
vti_d¡
, 
vti_¤c
, (
vti_šfo
));

225 
	}
}

227 
¹Æ_lšk_šfo_İs
 
	gvti_šfo_İs
 = {

228 .
io_Çme
 = "vti",

229 .
	gio_®loc
 = 
vti_®loc
,

230 .
	gio_·r£
 = 
vti_·r£
,

231 .
	gio_dump
 = {

232 [
NL_DUMP_LINE
] = 
vti_dump_lše
,

233 [
NL_DUMP_DETAILS
] = 
vti_dump_d‘as
,

235 .
	gio_şÚe
 = 
vti_şÚe
,

236 .
	gio_put_©Œs
 = 
vti_put_©Œs
,

237 .
	gio_ä“
 = 
vti_ä“
,

240 
	#IS_IPVTI_LINK_ASSERT
(
lšk
) \

241 ià((
lšk
)->
l_šfo_İs
 !ğ&
vti_šfo_İs
) { \

242 
	`APPBUG
("Link is‚ot‡ ipvti†ink. setype \vti\" first."); \

243  -
NLE_OPNOTSUPP
; \

244 }

	)

246 
¹Æ_lšk
 *
	$¹Æ_lšk_vti_®loc
()

248 
¹Æ_lšk
 *
lšk
;

249 
”r
;

251 
lšk
 = 
	`¹Æ_lšk_®loc
();

252 ià(!
lšk
)

253  
NULL
;

255 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "vti");

256 ià(
”r
 < 0) {

257 
	`¹Æ_lšk_put
(
lšk
);

258  
NULL
;

261  
lšk
;

262 
	}
}

270 
	$¹Æ_lšk_is_vti
(
¹Æ_lšk
 *
lšk
)

272  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "vti");

273 
	}
}

282 
	$¹Æ_lšk_vti_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

284 
¹Æ_lšk
 *
lšk
;

285 
”r
;

287 
lšk
 = 
	`¹Æ_lšk_vti_®loc
();

288 ià(!
lšk
)

289  -
NLE_NOMEM
;

291 if(
Çme
)

292 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

294 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

295 
	`¹Æ_lšk_put
(
lšk
);

297  
”r
;

298 
	}
}

306 
	$¹Æ_lšk_vti_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

308 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

310 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

312 
vti
->
lšk
 = 
šdex
;

313 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_LINK
;

316 
	}
}

324 
ušt32_t
 
	$¹Æ_lšk_vti_g‘_lšk
(
¹Æ_lšk
 *
lšk
)

326 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

328 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

330  
vti
->
lšk
;

331 
	}
}

340 
	$¹Æ_lšk_vti_£t_ikey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
ikey
)

342 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

344 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

346 
vti
->
ikey
 = ikey;

347 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_IKEY
;

350 
	}
}

358 
ušt32_t
 
	$¹Æ_lšk_vti_g‘_ikey
(
¹Æ_lšk
 *
lšk
)

360 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

362 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

364  
vti
->
ikey
;

365 
	}
}

374 
	$¹Æ_lšk_vti_£t_okey
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
okey
)

376 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

378 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

380 
vti
->
okey
 = okey;

381 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_OKEY
;

384 
	}
}

392 
ušt32_t
 
	$¹Æ_lšk_vti_g‘_okey
(
¹Æ_lšk
 *
lšk
)

394 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

396 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

398  
vti
->
okey
;

399 
	}
}

408 
	$¹Æ_lšk_vti_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

410 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

412 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

414 
vti
->
loÿl
 = 
addr
;

415 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_LOCAL
;

418 
	}
}

426 
ušt32_t
 
	$¹Æ_lšk_vti_g‘_loÿl
(
¹Æ_lšk
 *
lšk
)

428 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

430 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

432  
vti
->
loÿl
;

433 
	}
}

442 
	$¹Æ_lšk_vti_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
»mÙe
)

444 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

446 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

448 
vti
->
»mÙe
 =„emote;

449 
vti
->
vti_mask
 |ğ
IPVTI_ATTR_REMOTE
;

452 
	}
}

460 
ušt32_t
 
	$¹Æ_lšk_vti_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
)

462 
vti_šfo
 *
vti
 = 
lšk
->
l_šfo
;

464 
	`IS_IPVTI_LINK_ASSERT
(
lšk
);

466  
vti
->
»mÙe
;

467 
	}
}

469 
__š™
 
	$vti_š™
()

471 
	`¹Æ_lšk_»gi¡”_šfo
(&
vti_šfo_İs
);

472 
	}
}

474 
__ex™
 
	$vti_ex™
()

476 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
vti_šfo_İs
);

477 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/macvlan.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<Ãšk/rou‹/lšk/macvÏn.h
>

34 
	~<lšux/if_lšk.h
>

37 
	#MACVLAN_HAS_MODE
 (1<<0)

	)

38 
	#MACVLAN_HAS_FLAGS
 (1<<1)

	)

40 
	smacvÏn_šfo


42 
ušt32_t
 
	mmvi_mode
;

43 
ušt16_t
 
	mmvi_æags
;

44 
ušt32_t
 
	mmvi_mask
;

49 
Æa_pŞicy
 
	gmacvÏn_pŞicy
[
IFLA_MACVLAN_MAX
+1] = {

50 [
IFLA_MACVLAN_MODE
] = { .
ty³
 = 
NLA_U32
 },

51 [
IFLA_MACVLAN_FLAGS
] = { .
ty³
 = 
NLA_U16
 },

54 
	$macvÏn_®loc
(
¹Æ_lšk
 *
lšk
)

56 
macvÏn_šfo
 *
mvi
;

58 ià((
mvi
 = 
	`ÿÎoc
(1, (*mvi))è=ğ
NULL
)

59  -
NLE_NOMEM
;

61 
lšk
->
l_šfo
 = 
mvi
;

64 
	}
}

66 
	$macvÏn_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

67 
Æ©Œ
 *
x¡©s
)

69 
Æ©Œ
 *
tb
[
IFLA_MACVLAN_MAX
+1];

70 
macvÏn_šfo
 *
mvi
;

71 
”r
;

73 
	`NL_DBG
(3, "Parsing MACVLAN†ink info");

75 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_MACVLAN_MAX
, 
d©a
, 
macvÏn_pŞicy
)) < 0)

76 
”rout
;

78 ià((
”r
 = 
	`macvÏn_®loc
(
lšk
)) < 0)

79 
”rout
;

81 
mvi
 = 
lšk
->
l_šfo
;

83 ià(
tb
[
IFLA_MACVLAN_MODE
]) {

84 
mvi
->
mvi_mode
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_MACVLAN_MODE
]);

85 
mvi
->
mvi_mask
 |ğ
MACVLAN_HAS_MODE
;

88 ià(
tb
[
IFLA_MACVLAN_FLAGS
]) {

89 
mvi
->
mvi_mode
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_MACVLAN_FLAGS
]);

90 
mvi
->
mvi_mask
 |ğ
MACVLAN_HAS_FLAGS
;

93 
”r
 = 0;

94 
”rout
:

95  
”r
;

96 
	}
}

98 
	$macvÏn_ä“
(
¹Æ_lšk
 *
lšk
)

100 
	`ä“
(
lšk
->
l_šfo
);

101 
lšk
->
l_šfo
 = 
NULL
;

102 
	}
}

104 
	$macvÏn_dump
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

106 
buf
[64];

107 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

109 ià(
mvi
->
mvi_mask
 & 
MACVLAN_HAS_MODE
) {

110 
	`¹Æ_lšk_macvÏn_mode2¡r
(
mvi
->
mvi_mode
, 
buf
, (buf));

111 
	`Æ_dump
(
p
, "macvÏn-mod%s", 
buf
);

114 ià(
mvi
->
mvi_mask
 & 
MACVLAN_HAS_FLAGS
) {

115 
	`¹Æ_lšk_macvÏn_æags2¡r
(
mvi
->
mvi_æags
, 
buf
, (buf));

116 
	`Æ_dump
(
p
, "macvÏn-æag %s", 
buf
);

118 
	}
}

120 
	$macvÏn_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

122 
macvÏn_šfo
 *
vd¡
, *
v¤c
 = 
¤c
->
l_šfo
;

123 
”r
;

125 
d¡
->
l_šfo
 = 
NULL
;

126 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "macvlan")) < 0)

127  
”r
;

128 
vd¡
 = 
d¡
->
l_šfo
;

130 ià(!
vd¡
 || !
v¤c
)

131  -
NLE_NOMEM
;

133 
	`memıy
(
vd¡
, 
v¤c
, (
macvÏn_šfo
));

136 
	}
}

138 
	$macvÏn_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

140 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

141 
Æ©Œ
 *
d©a
;

143 ià(!(
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
)))

144  -
NLE_MSGSIZE
;

146 ià(
mvi
->
mvi_mask
 & 
MACVLAN_HAS_MODE
)

147 
	`NLA_PUT_U32
(
msg
, 
IFLA_MACVLAN_MODE
, 
mvi
->
mvi_mode
);

149 ià(
mvi
->
mvi_mask
 & 
MACVLAN_HAS_FLAGS
)

150 
	`NLA_PUT_U16
(
msg
, 
IFLA_MACVLAN_FLAGS
, 
mvi
->
mvi_æags
);

152 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

154 
Æa_put_çu»
:

157 
	}
}

159 
¹Æ_lšk_šfo_İs
 
	gmacvÏn_šfo_İs
 = {

160 .
io_Çme
 = "macvlan",

161 .
	gio_®loc
 = 
macvÏn_®loc
,

162 .
	gio_·r£
 = 
macvÏn_·r£
,

163 .
	gio_dump
 = {

164 [
NL_DUMP_LINE
] = 
macvÏn_dump
,

165 [
NL_DUMP_DETAILS
] = 
macvÏn_dump
,

167 .
	gio_şÚe
 = 
macvÏn_şÚe
,

168 .
	gio_put_©Œs
 = 
macvÏn_put_©Œs
,

169 .
	gio_ä“
 = 
macvÏn_ä“
,

173 
	#IS_MACVLAN_LINK_ASSERT
(
lšk
) \

174 ià((
lšk
)->
l_šfo_İs
 !ğ&
macvÏn_šfo_İs
) { \

175 
	`APPBUG
("Link is‚ot‡ macvlan†ink. setype \"macvlan\" first."); \

176  -
NLE_OPNOTSUPP
; \

177 }

	)

190 
¹Æ_lšk
 *
	$¹Æ_lšk_macvÏn_®loc
()

192 
¹Æ_lšk
 *
lšk
;

193 
”r
;

195 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

196  
NULL
;

198 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "macvlan")) < 0) {

199 
	`¹Æ_lšk_put
(
lšk
);

200  
NULL
;

203  
lšk
;

204 
	}
}

212 
	$¹Æ_lšk_is_macvÏn
(
¹Æ_lšk
 *
lšk
)

214  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "macvlan");

215 
	}
}

224 
	$¹Æ_lšk_macvÏn_£t_mode
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
mode
)

226 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

228 
	`IS_MACVLAN_LINK_ASSERT
(
lšk
);

230 
mvi
->
mvi_mode
 = 
mode
;

231 
mvi
->
mvi_mask
 |ğ
MACVLAN_HAS_MODE
;

234 
	}
}

242 
ušt32_t
 
	$¹Æ_lšk_macvÏn_g‘_mode
(
¹Æ_lšk
 *
lšk
)

244 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

246 
	`IS_MACVLAN_LINK_ASSERT
(
lšk
);

248 ià(
mvi
->
mvi_mask
 & 
MACVLAN_HAS_MODE
)

249  
mvi
->
mvi_mode
;

252 
	}
}

261 
	$¹Æ_lšk_macvÏn_£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
æags
)

263 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

265 
	`IS_MACVLAN_LINK_ASSERT
(
lšk
);

267 
mvi
->
mvi_æags
 |ğ
æags
;

268 
mvi
->
mvi_mask
 |ğ
MACVLAN_HAS_FLAGS
;

271 
	}
}

283 
	$¹Æ_lšk_macvÏn_un£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
æags
)

285 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

287 
	`IS_MACVLAN_LINK_ASSERT
(
lšk
);

289 
mvi
->
mvi_æags
 &ğ~
æags
;

290 
mvi
->
mvi_mask
 |ğ
MACVLAN_HAS_FLAGS
;

293 
	}
}

301 
ušt16_t
 
	$¹Æ_lšk_macvÏn_g‘_æags
(
¹Æ_lšk
 *
lšk
)

303 
macvÏn_šfo
 *
mvi
 = 
lšk
->
l_šfo
;

305 
	`IS_MACVLAN_LINK_ASSERT
(
lšk
);

307  
mvi
->
mvi_æags
;

308 
	}
}

312 cÚ¡ 
Œªs_tbl
 
	gmacvÏn_æags
[] = {

313 
__ADD
(
MACVLAN_FLAG_NOPROMISC
, 
nİromisc
)

316 cÚ¡ 
Œªs_tbl
 
	gmacvÏn_modes
[] = {

317 
__ADD
(
MACVLAN_MODE_PRIVATE
, 
´iv©e
)

318 
__ADD
(
MACVLAN_MODE_VEPA
, 
v•a
)

319 
__ADD
(
MACVLAN_MODE_BRIDGE
, 
bridge
)

320 
__ADD
(
MACVLAN_MODE_PASSTHRU
, 
·s¡hru
)

328 *
	$¹Æ_lšk_macvÏn_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

330  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
macvÏn_æags
, 
	`ARRAY_SIZE
(macvlan_flags));

331 
	}
}

333 
	$¹Æ_lšk_macvÏn_¡r2æags
(cÚ¡ *
Çme
)

335  
	`__¡r2æags
(
Çme
, 
macvÏn_æags
, 
	`ARRAY_SIZE
(macvlan_flags));

336 
	}
}

345 *
	$¹Æ_lšk_macvÏn_mode2¡r
(
mode
, *
buf
, 
size_t
 
Ën
)

347  
	`__ty³2¡r
(
mode
, 
buf
, 
Ën
, 
macvÏn_modes
, 
	`ARRAY_SIZE
(macvlan_modes));

348 
	}
}

350 
	$¹Æ_lšk_macvÏn_¡r2mode
(cÚ¡ *
Çme
)

352  
	`__¡r2ty³
(
Çme
, 
macvÏn_modes
, 
	`ARRAY_SIZE
(macvlan_modes));

353 
	}
}

357 
__š™
 
	$macvÏn_š™
()

359 
	`¹Æ_lšk_»gi¡”_šfo
(&
macvÏn_šfo_İs
);

360 
	}
}

362 
__ex™
 
	$macvÏn_ex™
()

364 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
macvÏn_šfo_İs
);

365 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/sit.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<lšux/if_tuÂ–.h
>

34 
	#SIT_ATTR_LINK
 (1 << 0)

	)

35 
	#SIT_ATTR_LOCAL
 (1 << 1)

	)

36 
	#SIT_ATTR_REMOTE
 (1 << 2)

	)

37 
	#SIT_ATTR_TTL
 (1 << 3)

	)

38 
	#SIT_ATTR_TOS
 (1 << 4)

	)

39 
	#SIT_ATTR_PMTUDISC
 (1 << 5)

	)

40 
	#SIT_ATTR_FLAGS
 (1 << 6)

	)

41 
	#SIT_ATTR_PROTO
 (1 << 7)

	)

43 
	ss™_šfo


45 
ušt8_t
 
	m‰l
;

46 
ušt8_t
 
	mtos
;

47 
ušt8_t
 
	mpmtudisc
;

48 
ušt8_t
 
	m´Ùo
;

49 
ušt16_t
 
	mæags
;

50 
ušt32_t
 
	mlšk
;

51 
ušt32_t
 
	mloÿl
;

52 
ušt32_t
 
	m»mÙe
;

53 
ušt32_t
 
	ms™_mask
;

56 
Æa_pŞicy
 
	gs™_pŞicy
[
IFLA_IPTUN_MAX
 + 1] = {

57 [
IFLA_IPTUN_LINK
] = { .
ty³
 = 
NLA_U32
 },

58 [
IFLA_IPTUN_LOCAL
] = { .
ty³
 = 
NLA_U32
 },

59 [
IFLA_IPTUN_REMOTE
] = { .
ty³
 = 
NLA_U32
 },

60 [
IFLA_IPTUN_TTL
] = { .
ty³
 = 
NLA_U8
 },

61 [
IFLA_IPTUN_TOS
] = { .
ty³
 = 
NLA_U8
 },

62 [
IFLA_IPTUN_PMTUDISC
] = { .
ty³
 = 
NLA_U8
 },

63 [
IFLA_IPTUN_FLAGS
] = { .
ty³
 = 
NLA_U16
 },

64 [
IFLA_IPTUN_PROTO
] = { .
ty³
 = 
NLA_U8
 },

67 
	$s™_®loc
(
¹Æ_lšk
 *
lšk
)

69 
s™_šfo
 *
s™
;

71 
s™
 = 
	`ÿÎoc
(1, (*sit));

72 ià(!
s™
)

73  -
NLE_NOMEM
;

75 
lšk
->
l_šfo
 = 
s™
;

78 
	}
}

80 
	$s™_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

81 
Æ©Œ
 *
x¡©s
)

83 
Æ©Œ
 *
tb
[
IFLA_IPTUN_MAX
 + 1];

84 
s™_šfo
 *
s™
;

85 
”r
;

87 
	`NL_DBG
(3, "Parsing SIT†ink info");

89 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_IPTUN_MAX
, 
d©a
, 
s™_pŞicy
);

90 ià(
”r
 < 0)

91 
”rout
;

93 
”r
 = 
	`s™_®loc
(
lšk
);

94 ià(
”r
 < 0)

95 
”rout
;

97 
s™
 = 
lšk
->
l_šfo
;

99 ià(
tb
[
IFLA_IPTUN_LINK
]) {

100 
s™
->
lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_LINK
]);

101 
s™
->
s™_mask
 |ğ
SIT_ATTR_LINK
;

104 ià(
tb
[
IFLA_IPTUN_LOCAL
]) {

105 
s™
->
loÿl
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_LOCAL
]);

106 
s™
->
s™_mask
 |ğ
SIT_ATTR_LOCAL
;

109 ià(
tb
[
IFLA_IPTUN_REMOTE
]) {

110 
s™
->
»mÙe
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_IPTUN_REMOTE
]);

111 
s™
->
s™_mask
 |ğ
SIT_ATTR_REMOTE
;

114 ià(
tb
[
IFLA_IPTUN_TTL
]) {

115 
s™
->
‰l
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TTL
]);

116 
s™
->
s™_mask
 |ğ
SIT_ATTR_TTL
;

119 ià(
tb
[
IFLA_IPTUN_TOS
]) {

120 
s™
->
tos
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_TOS
]);

121 
s™
->
s™_mask
 |ğ
SIT_ATTR_TOS
;

124 ià(
tb
[
IFLA_IPTUN_PMTUDISC
]) {

125 
s™
->
pmtudisc
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_PMTUDISC
]);

126 
s™
->
s™_mask
 |ğ
SIT_ATTR_PMTUDISC
;

129 ià(
tb
[
IFLA_IPTUN_FLAGS
]) {

130 
s™
->
æags
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_IPTUN_FLAGS
]);

131 
s™
->
s™_mask
 |ğ
SIT_ATTR_FLAGS
;

134 ià(
tb
[
IFLA_IPTUN_PROTO
]) {

135 
s™
->
´Ùo
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_IPTUN_PROTO
]);

136 
s™
->
s™_mask
 |ğ
SIT_ATTR_PROTO
;

139 
”r
 = 0;

141 
”rout
:

142  
”r
;

143 
	}
}

145 
	$s™_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

147 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

148 
Æ©Œ
 *
d©a
;

150 
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
);

151 ià(!
d©a
)

152  -
NLE_MSGSIZE
;

154 ià(
s™
->
s™_mask
 & 
SIT_ATTR_LINK
)

155 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_LINK
, 
s™
->
lšk
);

157 ià(
s™
->
s™_mask
 & 
SIT_ATTR_LOCAL
)

158 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_LOCAL
, 
s™
->
loÿl
);

160 ià(
s™
->
s™_mask
 & 
SIT_ATTR_REMOTE
)

161 
	`NLA_PUT_U32
(
msg
, 
IFLA_IPTUN_REMOTE
, 
s™
->
»mÙe
);

163 ià(
s™
->
s™_mask
 & 
SIT_ATTR_TTL
)

164 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TTL
, 
s™
->
‰l
);

166 ià(
s™
->
s™_mask
 & 
SIT_ATTR_TOS
)

167 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_TOS
, 
s™
->
tos
);

169 ià(
s™
->
s™_mask
 & 
SIT_ATTR_PMTUDISC
)

170 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_PMTUDISC
, 
s™
->
pmtudisc
);

172 ià(
s™
->
s™_mask
 & 
SIT_ATTR_FLAGS
)

173 
	`NLA_PUT_U16
(
msg
, 
IFLA_IPTUN_FLAGS
, 
s™
->
æags
);

175 ià(
s™
->
s™_mask
 & 
SIT_ATTR_PROTO
)

176 
	`NLA_PUT_U8
(
msg
, 
IFLA_IPTUN_PROTO
, 
s™
->
´Ùo
);

178 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

180 
Æa_put_çu»
:

183 
	}
}

185 
	$s™_ä“
(
¹Æ_lšk
 *
lšk
)

187 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

189 
	`ä“
(
s™
);

190 
lšk
->
l_šfo
 = 
NULL
;

191 
	}
}

193 
	$s™_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

195 
	`Æ_dump
(
p
, "s™ : %s", 
lšk
->
l_Çme
);

196 
	}
}

198 
	$s™_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

200 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

201 *
Çme
, 
addr
[
INET_ADDRSTRLEN
];

203 ià(
s™
->
s™_mask
 & 
SIT_ATTR_LINK
) {

204 
	`Æ_dump
(
p
, "†ink ");

205 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

206 ià(
Çme
)

207 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

209 
	`Æ_dump_lše
(
p
, "%u\n", 
s™
->
lšk
);

212 ià(
s™
->
s™_mask
 & 
SIT_ATTR_LOCAL
) {

213 
	`Æ_dump
(
p
, "†ocal ");

214 if(
	`š‘_Áİ
(
AF_INET
, &
s™
->
loÿl
, 
addr
, (addr)))

215 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

217 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
s™
->
loÿl
));

220 ià(
s™
->
s™_mask
 & 
SIT_ATTR_REMOTE
) {

221 
	`Æ_dump
(
p
, "„emote ");

222 if(
	`š‘_Áİ
(
AF_INET
, &
s™
->
»mÙe
, 
addr
, (addr)))

223 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

225 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
s™
->
»mÙe
));

228 ià(
s™
->
s™_mask
 & 
SIT_ATTR_TTL
) {

229 
	`Æ_dump
(
p
, "tl ");

230 
	`Æ_dump_lše
(
p
, "%u\n", 
s™
->
‰l
);

233 ià(
s™
->
s™_mask
 & 
SIT_ATTR_TOS
) {

234 
	`Æ_dump
(
p
, "os ");

235 
	`Æ_dump_lše
(
p
, "%u\n", 
s™
->
tos
);

238 ià(
s™
->
s™_mask
 & 
SIT_ATTR_FLAGS
) {

239 
	`Æ_dump
(
p
, " flags ");

240 
	`Æ_dump_lše
(
p
, " (%x)\n", 
s™
->
æags
);

243 ià(
s™
->
s™_mask
 & 
SIT_ATTR_PROTO
) {

244 
	`Æ_dump
(
p
, "…roto ");

245 
	`Æ_dump_lše
(
p
, " (%x)\n", 
s™
->
´Ùo
);

247 
	}
}

249 
	$s™_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

251 
s™_šfo
 *
s™_d¡
, *
s™_¤c
 = 
¤c
->
l_šfo
;

252 
”r
;

254 
d¡
->
l_šfo
 = 
NULL
;

256 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "sit");

257 ià(
”r
 < 0)

258  
”r
;

260 
s™_d¡
 = 
d¡
->
l_šfo
;

262 ià(!
s™_d¡
 || !
s™_¤c
)

263  -
NLE_NOMEM
;

265 
	`memıy
(
s™_d¡
, 
s™_¤c
, (
s™_šfo
));

268 
	}
}

270 
¹Æ_lšk_šfo_İs
 
	gs™_šfo_İs
 = {

271 .
io_Çme
 = "sit",

272 .
	gio_®loc
 = 
s™_®loc
,

273 .
	gio_·r£
 = 
s™_·r£
,

274 .
	gio_dump
 = {

275 [
NL_DUMP_LINE
] = 
s™_dump_lše
,

276 [
NL_DUMP_DETAILS
] = 
s™_dump_d‘as
,

278 .
	gio_şÚe
 = 
s™_şÚe
,

279 .
	gio_put_©Œs
 = 
s™_put_©Œs
,

280 .
	gio_ä“
 = 
s™_ä“
,

283 
	#IS_SIT_LINK_ASSERT
(
lšk
) \

284 ià((
lšk
)->
l_šfo_İs
 !ğ&
s™_šfo_İs
) { \

285 
	`APPBUG
("Link is‚ot‡ sit†ink. setype \"sit\" first."); \

286  -
NLE_OPNOTSUPP
; \

287 }

	)

289 
¹Æ_lšk
 *
	$¹Æ_lšk_s™_®loc
()

291 
¹Æ_lšk
 *
lšk
;

292 
”r
;

294 
lšk
 = 
	`¹Æ_lšk_®loc
();

295 ià(!
lšk
)

296  
NULL
;

298 
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "sit");

299 ià(
”r
 < 0) {

300 
	`¹Æ_lšk_put
(
lšk
);

301  
NULL
;

304  
lšk
;

305 
	}
}

313 
	$¹Æ_lšk_is_s™
(
¹Æ_lšk
 *
lšk
)

315  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "sit");

316 
	}
}

326 
	$¹Æ_lšk_s™_add
(
Æ_sock
 *
sk
, cÚ¡ *
Çme
)

328 
¹Æ_lšk
 *
lšk
;

329 
”r
;

331 
lšk
 = 
	`¹Æ_lšk_s™_®loc
();

332 ià(!
lšk
)

333  -
NLE_NOMEM
;

335 if(
Çme
)

336 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

338 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

339 
	`¹Æ_lšk_put
(
lšk
);

341  
”r
;

342 
	}
}

351 
	$¹Æ_lšk_s™_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

353 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

355 
	`IS_SIT_LINK_ASSERT
(
lšk
);

357 
s™
->
lšk
 = 
šdex
;

358 
s™
->
s™_mask
 |ğ
SIT_ATTR_LINK
;

361 
	}
}

369 
ušt32_t
 
	$¹Æ_lšk_s™_g‘_lšk
(
¹Æ_lšk
 *
lšk
)

371 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

373 
	`IS_SIT_LINK_ASSERT
(
lšk
);

375  
s™
->
lšk
;

376 
	}
}

385 
	$¹Æ_lšk_s™_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

387 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

389 
	`IS_SIT_LINK_ASSERT
(
lšk
);

391 
s™
->
loÿl
 = 
addr
;

392 
s™
->
s™_mask
 |ğ
SIT_ATTR_LOCAL
;

395 
	}
}

403 
ušt32_t
 
	$¹Æ_lšk_s™_g‘_loÿl
(
¹Æ_lšk
 *
lšk
)

405 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

407 
	`IS_SIT_LINK_ASSERT
(
lšk
);

409  
s™
->
loÿl
;

410 
	}
}

419 
	$¹Æ_lšk_s™_£t_»mÙe
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
addr
)

421 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

423 
	`IS_SIT_LINK_ASSERT
(
lšk
);

425 
s™
->
»mÙe
 = 
addr
;

426 
s™
->
s™_mask
 |ğ
SIT_ATTR_REMOTE
;

429 
	}
}

437 
ušt32_t
 
	$¹Æ_lšk_s™_g‘_»mÙe
(
¹Æ_lšk
 *
lšk
)

439 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

441 
	`IS_SIT_LINK_ASSERT
(
lšk
);

443  
s™
->
»mÙe
;

444 
	}
}

453 
	$¹Æ_lšk_s™_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
)

455 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

457 
	`IS_SIT_LINK_ASSERT
(
lšk
);

459 
s™
->
‰l
 =tl;

460 
s™
->
s™_mask
 |ğ
SIT_ATTR_TTL
;

463 
	}
}

471 
ušt8_t
 
	$¹Æ_lšk_s™_g‘_‰l
(
¹Æ_lšk
 *
lšk
)

473 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

475 
	`IS_SIT_LINK_ASSERT
(
lšk
);

477  
s™
->
‰l
;

478 
	}
}

487 
	$¹Æ_lšk_s™_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
)

489 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

491 
	`IS_SIT_LINK_ASSERT
(
lšk
);

493 
s™
->
tos
 =os;

494 
s™
->
s™_mask
 |ğ
SIT_ATTR_TOS
;

497 
	}
}

505 
ušt8_t
 
	$¹Æ_lšk_s™_g‘_tos
(
¹Æ_lšk
 *
lšk
)

507 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

509 
	`IS_SIT_LINK_ASSERT
(
lšk
);

511  
s™
->
tos
;

512 
	}
}

521 
	$¹Æ_lšk_s™_£t_pmtudisc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
pmtudisc
)

523 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

525 
	`IS_SIT_LINK_ASSERT
(
lšk
);

527 
s™
->
pmtudisc
 =…mtudisc;

528 
s™
->
s™_mask
 |ğ
SIT_ATTR_PMTUDISC
;

531 
	}
}

539 
ušt8_t
 
	$¹Æ_lšk_s™_g‘_pmtudisc
(
¹Æ_lšk
 *
lšk
)

541 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

543 
	`IS_SIT_LINK_ASSERT
(
lšk
);

545  
s™
->
pmtudisc
;

546 
	}
}

555 
	$¹Æ_lšk_s™_£t_æags
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
æags
)

557 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

559 
	`IS_SIT_LINK_ASSERT
(
lšk
);

561 
s™
->
æags
 = flags;

562 
s™
->
s™_mask
 |ğ
SIT_ATTR_FLAGS
;

565 
	}
}

573 
ušt16_t
 
	$¹Æ_lšk_s™_g‘_æags
(
¹Æ_lšk
 *
lšk
)

575 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

577 
	`IS_SIT_LINK_ASSERT
(
lšk
);

579  
s™
->
æags
;

580 
	}
}

589 
	$¹Æ_lšk_s™_£t_´Ùo
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
´Ùo
)

591 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

593 
	`IS_SIT_LINK_ASSERT
(
lšk
);

595 
s™
->
´Ùo
 =…roto;

596 
s™
->
s™_mask
 |ğ
SIT_ATTR_PROTO
;

599 
	}
}

607 
ušt8_t
 
	$¹Æ_lšk_s™_g‘_´Ùo
(
¹Æ_lšk
 *
lšk
)

609 
s™_šfo
 *
s™
 = 
lšk
->
l_šfo
;

611 
	`IS_SIT_LINK_ASSERT
(
lšk
);

613  
s™
->
´Ùo
;

614 
	}
}

616 
__š™
 
	$s™_š™
()

618 
	`¹Æ_lšk_»gi¡”_šfo
(&
s™_šfo_İs
);

619 
	}
}

621 
__ex™
 
	$s™_ex™
()

623 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
s™_šfo_İs
);

624 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/veth.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<Ãšk/rou‹/lšk/v‘h.h
>

34 
	~<lšux/if_lšk.h
>

36 
Æa_pŞicy
 
	gv‘h_pŞicy
[
VETH_INFO_MAX
+1] = {

37 [
VETH_INFO_PEER
] = { .
mšËn
 = (
ifšfomsg
) },

40 
	$v‘h_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

41 
Æ©Œ
 *
x¡©s
)

43 
Æ©Œ
 *
tb
[
VETH_INFO_MAX
+1];

44 
Æ©Œ
 *
³”_tb
[
IFLA_MAX
 + 1];

45 
¹Æ_lšk
 *
³”
 = 
lšk
->
l_šfo
;

46 
”r
;

48 
	`NL_DBG
(3, "Parsing veth†ink info");

50 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
VETH_INFO_MAX
, 
d©a
, 
v‘h_pŞicy
)) < 0)

51 
”rout
;

53 ià(
tb
[
VETH_INFO_PEER
]) {

54 
Æ©Œ
 *
Æa_³”
;

55 
ifšfomsg
 *
ifi
;

57 
Æa_³”
 = 
tb
[
VETH_INFO_PEER
];

58 
ifi
 = 
	`Æa_d©a
(
Æa_³”
);

60 
³”
->
l_çmy
 = 
ifi
->
ifi_çmy
;

61 
³”
->
l_¬±y³
 = 
ifi
->
ifi_ty³
;

62 
³”
->
l_šdex
 = 
ifi
->
ifi_šdex
;

63 
³”
->
l_æags
 = 
ifi
->
ifi_æags
;

64 
³”
->
l_chªge
 = 
ifi
->
ifi_chªge
;

65 
”r
 = 
	`Æa_·r£
(
³”_tb
, 
IFLA_MAX
,

66 
	`Æa_d©a
(
Æa_³”
è+ (
ifšfomsg
),

67 
	`Æa_Ën
(
Æa_³”
è- (
ifšfomsg
),

68 
¹Ê_lšk_pŞicy
);

69 ià(
”r
 < 0)

70 
”rout
;

72 
”r
 = 
	`¹Æ_lšk_šfo_·r£
(
³”
, 
³”_tb
);

73 ià(
”r
 < 0)

74 
”rout
;

77 
”r
 = 0;

79 
”rout
:

80  
”r
;

81 
	}
}

83 
	$v‘h_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

85 
	}
}

87 
	$v‘h_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

89 
¹Æ_lšk
 *
³”
 = 
lšk
->
l_šfo
;

90 *
Çme
;

91 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
³”
);

92 
	`Æ_dump
(
p
, "…eer ");

93 ià(
Çme
)

94 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

96 
	`Æ_dump_lše
(
p
, "%u\n", 
³”
->
l_šdex
);

97 
	}
}

99 
	$v‘h_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

101 
¹Æ_lšk
 *
d¡_³”
 = 
NULL
, *
¤c_³”
 = 
¤c
->
l_šfo
;

105 ià(
¤c_³”
) {

106 
¤c_³”
->
l_šfo
 = 
NULL
;

107 
d¡_³”
 = (
¹Æ_lšk
 *)
	`Æ_objeù_şÚe
(
	`OBJ_CAST
(
¤c_³”
));

108 ià(!
d¡_³”
)

109  -
NLE_NOMEM
;

110 
¤c_³”
->
l_šfo
 = 
¤c
;

111 
d¡_³”
->
l_šfo
 = 
d¡
;

113 
d¡
->
l_šfo
 = 
d¡_³”
;

115 
	}
}

117 
	$v‘h_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

119 
¹Æ_lšk
 *
³”
 = 
lšk
->
l_šfo
;

120 
ifšfomsg
 
ifi
;

121 
Æ©Œ
 *
d©a
, *
šfo_³”
;

123 
	`mem£t
(&
ifi
, 0,  ifi);

124 
ifi
.
ifi_çmy
 = 
³”
->
l_çmy
;

125 
ifi
.
ifi_ty³
 = 
³”
->
l_¬±y³
;

126 
ifi
.
ifi_šdex
 = 
³”
->
l_šdex
;

127 
ifi
.
ifi_æags
 = 
³”
->
l_æags
;

128 
ifi
.
ifi_chªge
 = 
³”
->
l_chªge
;

130 ià(!(
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
)))

131  -
NLE_MSGSIZE
;

132 ià(!(
šfo_³”
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
VETH_INFO_PEER
)))

133  -
NLE_MSGSIZE
;

134 ià(
	`Æmsg_­³nd
(
msg
, &
ifi
, (ifi), 
NLMSG_ALIGNTO
) < 0)

135  -
NLE_MSGSIZE
;

136 
	`¹Æ_lšk_fl_šfo
(
msg
, 
³”
);

137 
	`Æa_Ã¡_’d
(
msg
, 
šfo_³”
);

138 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

141 
	}
}

143 
	$v‘h_®loc
(
¹Æ_lšk
 *
lšk
)

145 
¹Æ_lšk
 *
³”
;

146 
”r
;

149 ià(
lšk
->
l_šfo
)

152 ià(!(
³”
 = 
	`¹Æ_lšk_®loc
()))

153  -
NLE_NOMEM
;

158 
³”
->
l_šfo
 = 
lšk
;

159 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
³”
, "veth")) < 0) {

160 
	`¹Æ_lšk_put
(
³”
);

161  
”r
;

164 
lšk
->
l_šfo
 = 
³”
;

166 
	}
}

168 
	$v‘h_ä“
(
¹Æ_lšk
 *
lšk
)

170 
¹Æ_lšk
 *
³”
 = 
lšk
->
l_šfo
;

171 ià(
³”
) {

172 
lšk
->
l_šfo
 = 
NULL
;

174 
³”
->
l_šfo
 = 
NULL
;

175 
	`¹Æ_lšk_put
(
³”
);

178 
	}
}

180 
¹Æ_lšk_šfo_İs
 
	gv‘h_šfo_İs
 = {

181 .
io_Çme
 = "veth",

182 .
	gio_·r£
 = 
v‘h_·r£
,

183 .
	gio_dump
 = {

184 [
NL_DUMP_LINE
] = 
v‘h_dump_lše
,

185 [
NL_DUMP_DETAILS
] = 
v‘h_dump_d‘as
,

187 .
	gio_®loc
 = 
v‘h_®loc
,

188 .
	gio_şÚe
 = 
v‘h_şÚe
,

189 .
	gio_put_©Œs
 = 
v‘h_put_©Œs
,

190 .
	gio_ä“
 = 
v‘h_ä“
,

195 
	#IS_VETH_LINK_ASSERT
(
lšk
) \

196 ià((
lšk
)->
l_šfo_İs
 !ğ&
v‘h_šfo_İs
) { \

197 
	`APPBUG
("Link is‚ot‡ veth†ink. setype \"veth\" first."); \

198  
NULL
; \

199 }

	)

212 
¹Æ_lšk
 *
	$¹Æ_lšk_v‘h_®loc
()

214 
¹Æ_lšk
 *
lšk
;

215 
”r
;

217 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

218  
NULL
;

219 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "veth")) < 0) {

220 
	`¹Æ_lšk_put
(
lšk
);

221  
NULL
;

224  
lšk
;

225 
	}
}

232 
¹Æ_lšk
 *
	$¹Æ_lšk_v‘h_g‘_³”
(
¹Æ_lšk
 *
lšk
)

234 
	`IS_VETH_LINK_ASSERT
(
lšk
);

235 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
lšk
->
l_šfo
));

236  
lšk
->
l_šfo
;

237 
	}
}

243 
	$¹Æ_lšk_v‘h_»Ëa£
(
¹Æ_lšk
 *
lšk
)

245 
	`v‘h_ä“
(
lšk
);

246 
	`¹Æ_lšk_put
(
lšk
);

247 
	}
}

255 
	$¹Æ_lšk_is_v‘h
(
¹Æ_lšk
 *
lšk
)

257  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "veth");

258 
	}
}

274 
	$¹Æ_lšk_v‘h_add
(
Æ_sock
 *
sock
, cÚ¡ *
Çme
,

275 cÚ¡ *
³”_Çme
, 
pid_t
 
pid
)

277 
¹Æ_lšk
 *
lšk
, *
³”
;

278 
”r
 = -
NLE_NOMEM
;

280 ià(!(
lšk
 = 
	`¹Æ_lšk_v‘h_®loc
()))

281  -
NLE_NOMEM
;

282 
³”
 = 
lšk
->
l_šfo
;

284 ià(
Çme
 && 
³”_Çme
) {

285 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

286 
	`¹Æ_lšk_£t_Çme
(
³”
, 
³”_Çme
);

289 
	`¹Æ_lšk_£t_ns_pid
(
³”
, 
pid
);

290 
”r
 = 
	`¹Æ_lšk_add
(
sock
, 
lšk
, 
NLM_F_CREATE
 | 
NLM_F_EXCL
);

292 
	`¹Æ_lšk_put
(
lšk
);

293  
”r
;

294 
	}
}

298 
__š™
 
	$v‘h_š™
()

300 
	`¹Æ_lšk_»gi¡”_šfo
(&
v‘h_šfo_İs
);

301 
	}
}

303 
__ex™
 
	$v‘h_ex™
()

305 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
v‘h_šfo_İs
);

306 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/vlan.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<Ãšk/rou‹/lšk/vÏn.h
>

34 
	~<lšux/if_vÏn.h
>

37 
	#VLAN_HAS_ID
 (1<<0)

	)

38 
	#VLAN_HAS_FLAGS
 (1<<1)

	)

39 
	#VLAN_HAS_INGRESS_QOS
 (1<<2)

	)

40 
	#VLAN_HAS_EGRESS_QOS
 (1<<3)

	)

41 
	#VLAN_HAS_PROTOCOL
 (1<<4)

	)

43 
	svÏn_šfo


45 
ušt16_t
 
	mvi_vÏn_id
;

46 
ušt16_t
 
	mvi_´ÙocŞ
;

47 
ušt32_t
 
	mvi_æags
;

48 
ušt32_t
 
	mvi_æags_mask
;

49 
ušt32_t
 
	mvi_šg»ss_qos
[
VLAN_PRIO_MAX
+1];

50 
ušt32_t
 
	mvi_Ãg»ss
;

51 
ušt32_t
 
	mvi_eg»ss_size
;

52 
vÏn_m­
 * 
	mvi_eg»ss_qos
;

53 
ušt32_t
 
	mvi_mask
;

58 
Æa_pŞicy
 
	gvÏn_pŞicy
[
IFLA_VLAN_MAX
+1] = {

59 [
IFLA_VLAN_ID
] = { .
ty³
 = 
NLA_U16
 },

60 [
IFLA_VLAN_FLAGS
] = { .
mšËn
 = (
iæa_vÏn_æags
) },

61 [
IFLA_VLAN_INGRESS_QOS
] = { .
ty³
 = 
NLA_NESTED
 },

62 [
IFLA_VLAN_EGRESS_QOS
] = { .
ty³
 = 
NLA_NESTED
 },

63 [
IFLA_VLAN_PROTOCOL
] = { .
ty³
 = 
NLA_U16
 },

66 
	$vÏn_®loc
(
¹Æ_lšk
 *
lšk
)

68 
vÏn_šfo
 *
vi
;

70 ià((
vi
 = 
	`ÿÎoc
(1, (*vi))è=ğ
NULL
)

71  -
NLE_NOMEM
;

73 
lšk
->
l_šfo
 = 
vi
;

76 
	}
}

78 
	$vÏn_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

79 
Æ©Œ
 *
x¡©s
)

81 
Æ©Œ
 *
tb
[
IFLA_VLAN_MAX
+1];

82 
vÏn_šfo
 *
vi
;

83 
”r
;

85 
	`NL_DBG
(3, "Parsing VLAN†ink info");

87 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_VLAN_MAX
, 
d©a
, 
vÏn_pŞicy
)) < 0)

88 
”rout
;

90 ià((
”r
 = 
	`vÏn_®loc
(
lšk
)) < 0)

91 
”rout
;

93 
vi
 = 
lšk
->
l_šfo
;

95 ià(
tb
[
IFLA_VLAN_ID
]) {

96 
vi
->
vi_vÏn_id
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_VLAN_ID
]);

97 
vi
->
vi_mask
 |ğ
VLAN_HAS_ID
;

100 ià(
tb
[
IFLA_VLAN_PROTOCOL
]) {

101 
vi
->
vi_´ÙocŞ
 = 
	`Æa_g‘_u16
(
tb
[
IFLA_VLAN_PROTOCOL
]);

102 
vi
->
vi_mask
 |ğ
VLAN_HAS_PROTOCOL
;

105 ià(
tb
[
IFLA_VLAN_FLAGS
]) {

106 
iæa_vÏn_æags
 
æags
;

107 
	`Æa_memıy
(&
æags
, 
tb
[
IFLA_VLAN_FLAGS
], (flags));

109 
vi
->
vi_æags
 = 
æags
.flags;

110 
vi
->
vi_mask
 |ğ
VLAN_HAS_FLAGS
;

113 ià(
tb
[
IFLA_VLAN_INGRESS_QOS
]) {

114 
iæa_vÏn_qos_m­pšg
 *
m­
;

115 
Æ©Œ
 *
Æa
;

116 
»maššg
;

118 
	`mem£t
(
vi
->
vi_šg»ss_qos
, 0, (vi->vi_ingress_qos));

120 
	`Æa_fÜ_—ch_Ã¡ed
(
Æa
, 
tb
[
IFLA_VLAN_INGRESS_QOS
], 
»maššg
) {

121 ià(
	`Æa_Ën
(
Æa
è< (*
m­
))

122  -
NLE_INVAL
;

124 
m­
 = 
	`Æa_d©a
(
Æa
);

125 ià(
m­
->
äom
 > 
VLAN_PRIO_MAX
) {

126  -
NLE_INVAL
;

129 
vi
->
vi_šg»ss_qos
[
m­
->
äom
] = m­->
to
;

132 
vi
->
vi_mask
 |ğ
VLAN_HAS_INGRESS_QOS
;

135 ià(
tb
[
IFLA_VLAN_EGRESS_QOS
]) {

136 
iæa_vÏn_qos_m­pšg
 *
m­
;

137 
Æ©Œ
 *
Æa
;

138 
»maššg
, 
i
 = 0;

140 
	`Æa_fÜ_—ch_Ã¡ed
(
Æa
, 
tb
[
IFLA_VLAN_EGRESS_QOS
], 
»maššg
) {

141 ià(
	`Æa_Ën
(
Æa
è< (*
m­
))

142  -
NLE_INVAL
;

143 
i
++;

147 
vi
->
vi_eg»ss_size
 = (
i
 + 32) & ~31;

148 
vi
->
vi_eg»ss_qos
 = 
	`ÿÎoc
(vi->
vi_eg»ss_size
, (*vi->vi_egress_qos));

149 ià(
vi
->
vi_eg»ss_qos
 =ğ
NULL
)

150  -
NLE_NOMEM
;

152 
i
 = 0;

153 
	`Æa_fÜ_—ch_Ã¡ed
(
Æa
, 
tb
[
IFLA_VLAN_EGRESS_QOS
], 
»maššg
) {

154 
m­
 = 
	`Æa_d©a
(
Æa
);

155 
	`NL_DBG
(4, "Assignšgƒg»s qo m­pšg %d\n", 
i
);

156 
vi
->
vi_eg»ss_qos
[
i
].
vm_äom
 = 
m­
->
äom
;

157 
vi
->
vi_eg»ss_qos
[
i
++].
vm_to
 = 
m­
->
to
;

160 
vi
->
vi_Ãg»ss
 = 
i
;

161 
vi
->
vi_mask
 |ğ
VLAN_HAS_EGRESS_QOS
;

164 
”r
 = 0;

165 
”rout
:

166  
”r
;

167 
	}
}

169 
	$vÏn_ä“
(
¹Æ_lšk
 *
lšk
)

171 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

173 ià(
vi
) {

174 
	`ä“
(
vi
->
vi_eg»ss_qos
);

175 
vi
->
vi_eg»ss_qos
 = 
NULL
;

178 
	`ä“
(
vi
);

179 
lšk
->
l_šfo
 = 
NULL
;

180 
	}
}

182 
	$vÏn_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

184 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

186 
	`Æ_dump
(
p
, "vÏn-id %d", 
vi
->
vi_vÏn_id
);

187 
	}
}

189 
	$vÏn_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

191 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

192 
´š‹d
;

193 
ušt32_t
 
i
;

194 
buf
[64];

196 
	`¹Æ_lšk_vÏn_æags2¡r
(
vi
->
vi_æags
, 
buf
, (buf));

197 
	`Æ_dump_lše
(
p
, " vÏn-šfØid %d <%s>", 
vi
->
vi_vÏn_id
, 
buf
);

199 ià(
vi
->
vi_mask
 & 
VLAN_HAS_PROTOCOL
)

200 
	`Æ_dump_lše
(
p
, " vÏÀ´ÙocŞ <%d>", 
vi
->
vi_´ÙocŞ
);

202 
	`Æ_dump
(
p
, "\n");

204 ià(
vi
->
vi_mask
 & 
VLAN_HAS_INGRESS_QOS
) {

205 
	`Æ_dump_lše
(
p
,

207 
i
 = 0, 
´š‹d
 = 0; i <ğ
VLAN_PRIO_MAX
; i++) {

208 ià(
vi
->
vi_šg»ss_qos
[
i
]) {

209 ià(
´š‹d
 == 0)

210 
	`Æ_dump_lše
(
p
, " ");

211 
	`Æ_dump
(
p
, "%x -> %#08x, ",

212 
i
, 
vi
->
vi_šg»ss_qos
[i]);

213 ià(
´š‹d
++ == 3) {

214 
	`Æ_dump
(
p
, "\n");

215 
´š‹d
 = 0;

220 ià(
´š‹d
 > 0 &&…rinted != 4)

221 
	`Æ_dump
(
p
, "\n");

224 ià(
vi
->
vi_mask
 & 
VLAN_HAS_EGRESS_QOS
) {

225 
	`Æ_dump_lše
(
p
,

227 
i
 = 0, 
´š‹d
 = 0; i < 
vi
->
vi_Ãg»ss
; i++) {

228 ià(
´š‹d
 == 0)

229 
	`Æ_dump_lše
(
p
, " ");

230 
	`Æ_dump
(
p
, "%#08x -> %x, ",

231 
vi
->
vi_eg»ss_qos
[
i
].
vm_äom
,

232 
vi
->
vi_eg»ss_qos
[
i
].
vm_to
);

233 ià(
´š‹d
++ == 3) {

234 
	`Æ_dump
(
p
, "\n");

235 
´š‹d
 = 0;

239 ià(
´š‹d
 > 0 &&…rinted != 4)

240 
	`Æ_dump
(
p
, "\n");

242 
	}
}

244 
	$vÏn_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

246 
vÏn_šfo
 *
vd¡
, *
v¤c
 = 
¤c
->
l_šfo
;

247 
”r
;

249 
d¡
->
l_šfo
 = 
NULL
;

250 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "vlan")) < 0)

251  
”r
;

252 
vd¡
 = 
d¡
->
l_šfo
;

254 
vd¡
->
vi_eg»ss_qos
 = 
	`ÿÎoc
(
v¤c
->
vi_eg»ss_size
,

255 (
vÏn_m­
));

256 ià(!
vd¡
->
vi_eg»ss_qos
)

257  -
NLE_NOMEM
;

259 
	`memıy
(
vd¡
->
vi_eg»ss_qos
, 
v¤c
->vi_egress_qos,

260 
v¤c
->
vi_eg»ss_size
 * (
vÏn_m­
));

263 
	}
}

265 
	$vÏn_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

267 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

268 
Æ©Œ
 *
d©a
;

270 ià(!(
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
)))

271  -
NLE_MSGSIZE
;

273 ià(
vi
->
vi_mask
 & 
VLAN_HAS_ID
)

274 
	`NLA_PUT_U16
(
msg
, 
IFLA_VLAN_ID
, 
vi
->
vi_vÏn_id
);

276 ià(
vi
->
vi_mask
 & 
VLAN_HAS_FLAGS
) {

277 
iæa_vÏn_æags
 
æags
 = {

278 .
æags
 = 
vi
->
vi_æags
,

279 .
mask
 = 
vi
->
vi_æags_mask
,

282 
	`NLA_PUT
(
msg
, 
IFLA_VLAN_FLAGS
, (
æags
), &flags);

285 ià(
vi
->
vi_mask
 & 
VLAN_HAS_INGRESS_QOS
) {

286 
iæa_vÏn_qos_m­pšg
 
m­
;

287 
Æ©Œ
 *
qos
;

288 
i
;

290 ià(!(
qos
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_VLAN_INGRESS_QOS
)))

291 
Æa_put_çu»
;

293 
i
 = 0; i <ğ
VLAN_PRIO_MAX
; i++) {

294 ià(
vi
->
vi_šg»ss_qos
[
i
]) {

295 
m­
.
äom
 = 
i
;

296 
m­
.
to
 = 
vi
->
vi_šg»ss_qos
[
i
];

298 
	`NLA_PUT
(
msg
, 
i
, (
m­
), &map);

302 
	`Æa_Ã¡_’d
(
msg
, 
qos
);

305 ià(
vi
->
vi_mask
 & 
VLAN_HAS_EGRESS_QOS
) {

306 
iæa_vÏn_qos_m­pšg
 
m­
;

307 
Æ©Œ
 *
qos
;

308 
ušt32_t
 
i
;

310 ià(!(
qos
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_VLAN_EGRESS_QOS
)))

311 
Æa_put_çu»
;

313 
i
 = 0; i < 
vi
->
vi_Ãg»ss
; i++) {

314 
m­
.
äom
 = 
vi
->
vi_eg»ss_qos
[
i
].
vm_äom
;

315 
m­
.
to
 = 
vi
->
vi_eg»ss_qos
[
i
].
vm_to
;

317 
	`NLA_PUT
(
msg
, 
i
, (
m­
), &map);

320 
	`Æa_Ã¡_’d
(
msg
, 
qos
);

323 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

325 
Æa_put_çu»
:

328 
	}
}

330 
¹Æ_lšk_šfo_İs
 
	gvÏn_šfo_İs
 = {

331 .
io_Çme
 = "vlan",

332 .
	gio_®loc
 = 
vÏn_®loc
,

333 .
	gio_·r£
 = 
vÏn_·r£
,

334 .
	gio_dump
 = {

335 [
NL_DUMP_LINE
] = 
vÏn_dump_lše
,

336 [
NL_DUMP_DETAILS
] = 
vÏn_dump_d‘as
,

338 .
	gio_şÚe
 = 
vÏn_şÚe
,

339 .
	gio_put_©Œs
 = 
vÏn_put_©Œs
,

340 .
	gio_ä“
 = 
vÏn_ä“
,

344 
	#IS_VLAN_LINK_ASSERT
(
lšk
) \

345 ià((
lšk
)->
l_šfo_İs
 !ğ&
vÏn_šfo_İs
) { \

346 
	`APPBUG
("Link is‚ot‡ vlan†ink. setype \"vlan\" first."); \

347  -
NLE_OPNOTSUPP
; \

348 }

	)

361 
¹Æ_lšk
 *
	$¹Æ_lšk_vÏn_®loc
()

363 
¹Æ_lšk
 *
lšk
;

364 
”r
;

366 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

367  
NULL
;

369 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "vlan")) < 0) {

370 
	`¹Æ_lšk_put
(
lšk
);

371  
NULL
;

374  
lšk
;

375 
	}
}

383 
	$¹Æ_lšk_is_vÏn
(
¹Æ_lšk
 *
lšk
)

385  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "vlan");

386 
	}
}

395 
	$¹Æ_lšk_vÏn_£t_id
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
id
)

397 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

399 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

401 
vi
->
vi_vÏn_id
 = 
id
;

402 
vi
->
vi_mask
 |ğ
VLAN_HAS_ID
;

405 
	}
}

413 
	$¹Æ_lšk_vÏn_g‘_id
(
¹Æ_lšk
 *
lšk
)

415 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

417 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

419 ià(
vi
->
vi_mask
 & 
VLAN_HAS_ID
)

420  
vi
->
vi_vÏn_id
;

423 
	}
}

432 
	$¹Æ_lšk_vÏn_£t_´ÙocŞ
(
¹Æ_lšk
 *
lšk
, 
ušt16_t
 
´ÙocŞ
)

434 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

436 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

438 
vi
->
vi_´ÙocŞ
 = 
´ÙocŞ
;

439 
vi
->
vi_mask
 |ğ
VLAN_HAS_PROTOCOL
;

442 
	}
}

450 
	$¹Æ_lšk_vÏn_g‘_´ÙocŞ
(
¹Æ_lšk
 *
lšk
)

452 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

454 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

456 ià(
vi
->
vi_mask
 & 
VLAN_HAS_PROTOCOL
)

457  
vi
->
vi_´ÙocŞ
;

460 
	}
}

469 
	$¹Æ_lšk_vÏn_£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

471 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

473 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

475 
vi
->
vi_æags_mask
 |ğ
æags
;

476 
vi
->
vi_æags
 |ğ
æags
;

477 
vi
->
vi_mask
 |ğ
VLAN_HAS_FLAGS
;

480 
	}
}

489 
	$¹Æ_lšk_vÏn_un£t_æags
(
¹Æ_lšk
 *
lšk
, 
æags
)

491 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

493 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

495 
vi
->
vi_æags_mask
 |ğ
æags
;

496 
vi
->
vi_æags
 &ğ~
æags
;

497 
vi
->
vi_mask
 |ğ
VLAN_HAS_FLAGS
;

500 
	}
}

508 
	$¹Æ_lšk_vÏn_g‘_æags
(
¹Æ_lšk
 *
lšk
)

510 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

512 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

514  
vi
->
vi_æags
;

515 
	}
}

524 
	$¹Æ_lšk_vÏn_£t_šg»ss_m­
(
¹Æ_lšk
 *
lšk
, 
äom
,

525 
ušt32_t
 
to
)

527 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

529 
	`IS_VLAN_LINK_ASSERT
(
lšk
);

531 ià(
äom
 < 0 || from > 
VLAN_PRIO_MAX
)

532  -
NLE_INVAL
;

534 
vi
->
vi_šg»ss_qos
[
äom
] = 
to
;

535 
vi
->
vi_mask
 |ğ
VLAN_HAS_INGRESS_QOS
;

538 
	}
}

540 
ušt32_t
 *
	$¹Æ_lšk_vÏn_g‘_šg»ss_m­
(
¹Æ_lšk
 *
lšk
)

542 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

544 ià(
lšk
->
l_šfo_İs
 !ğ&
vÏn_šfo_İs
 || !link->l_info_ops)

545  
NULL
;

547 ià(
vi
->
vi_mask
 & 
VLAN_HAS_INGRESS_QOS
)

548  
vi
->
vi_šg»ss_qos
;

550  
NULL
;

551 
	}
}

553 
	$¹Æ_lšk_vÏn_£t_eg»ss_m­
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
äom
, 
to
)

555 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

557 ià(
lšk
->
l_šfo_İs
 !ğ&
vÏn_šfo_İs
 || !link->l_info_ops)

558  -
NLE_OPNOTSUPP
;

560 ià(
to
 < 0 ||Ø> 
VLAN_PRIO_MAX
)

561  -
NLE_INVAL
;

563 ià(
vi
->
vi_Ãg»ss
 >ğvi->
vi_eg»ss_size
) {

564 
Ãw_size
 = 
vi
->
vi_eg»ss_size
 + 32;

565 *
±r
;

567 
±r
 = 
	`»®loc
(
vi
->
vi_eg»ss_qos
, 
Ãw_size
);

568 ià(!
±r
)

569  -
NLE_NOMEM
;

571 
vi
->
vi_eg»ss_qos
 = 
±r
;

572 
vi
->
vi_eg»ss_size
 = 
Ãw_size
;

575 
vi
->
vi_eg»ss_qos
[vi->
vi_Ãg»ss
].
vm_äom
 = 
äom
;

576 
vi
->
vi_eg»ss_qos
[vi->
vi_Ãg»ss
].
vm_to
 = 
to
;

577 
vi
->
vi_Ãg»ss
++;

578 
vi
->
vi_mask
 |ğ
VLAN_HAS_EGRESS_QOS
;

581 
	}
}

583 
vÏn_m­
 *
	$¹Æ_lšk_vÏn_g‘_eg»ss_m­
(
¹Æ_lšk
 *
lšk
,

584 *
Ãg»ss
)

586 
vÏn_šfo
 *
vi
 = 
lšk
->
l_šfo
;

588 ià(
lšk
->
l_šfo_İs
 !ğ&
vÏn_šfo_İs
 || !link->l_info_ops)

589  
NULL
;

591 ià(
Ãg»ss
 =ğ
NULL
)

592  
NULL
;

594 ià(
vi
->
vi_mask
 & 
VLAN_HAS_EGRESS_QOS
) {

595 *
Ãg»ss
 = 
vi
->
vi_Ãg»ss
;

596  
vi
->
vi_eg»ss_qos
;

598 *
Ãg»ss
 = 0;

599  
NULL
;

601 
	}
}

605 cÚ¡ 
Œªs_tbl
 
	gvÏn_æags
[] = {

606 
__ADD
(
VLAN_FLAG_REORDER_HDR
, 
»Üd”_hdr
)

614 *
	$¹Æ_lšk_vÏn_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

616  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
vÏn_æags
, 
	`ARRAY_SIZE
(vlan_flags));

617 
	}
}

619 
	$¹Æ_lšk_vÏn_¡r2æags
(cÚ¡ *
Çme
)

621  
	`__¡r2æags
(
Çme
, 
vÏn_æags
, 
	`ARRAY_SIZE
(vlan_flags));

622 
	}
}

627 
__š™
 
	$vÏn_š™
()

629 
	`¹Æ_lšk_»gi¡”_šfo
(&
vÏn_šfo_İs
);

630 
	}
}

632 
__ex™
 
	$vÏn_ex™
()

634 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
vÏn_šfo_İs
);

635 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/link/vxlan.c

25 
	~<Ãšk-´iv©e/Ãšk.h
>

26 
	~<Ãšk/Ãšk.h
>

27 
	~<Ãšk/©Œ.h
>

28 
	~<Ãšk/uts.h
>

29 
	~<Ãšk/objeù.h
>

30 
	~<Ãšk/rou‹/¹Æ.h
>

31 
	~<Ãšk-´iv©e/rou‹/lšk/­i.h
>

32 
	~<Ãšk/rou‹/lšk/vxÏn.h
>

34 
	~<lšux/if_lšk.h
>

37 
	#VXLAN_HAS_ID
 (1<<0)

	)

38 
	#VXLAN_HAS_GROUP
 (1<<1)

	)

39 
	#VXLAN_HAS_LINK
 (1<<2)

	)

40 
	#VXLAN_HAS_LOCAL
 (1<<3)

	)

41 
	#VXLAN_HAS_TTL
 (1<<4)

	)

42 
	#VXLAN_HAS_TOS
 (1<<5)

	)

43 
	#VXLAN_HAS_LEARNING
 (1<<6)

	)

44 
	#VXLAN_HAS_AGEING
 (1<<7)

	)

45 
	#VXLAN_HAS_LIMIT
 (1<<8)

	)

46 
	#VXLAN_HAS_PORT_RANGE
 (1<<9)

	)

47 
	#VXLAN_HAS_PROXY
 (1<<10)

	)

48 
	#VXLAN_HAS_RSC
 (1<<11)

	)

49 
	#VXLAN_HAS_L2MISS
 (1<<12)

	)

50 
	#VXLAN_HAS_L3MISS
 (1<<13)

	)

52 
	svxÏn_šfo


54 
ušt32_t
 
	mvxi_id
;

55 
ušt32_t
 
	mvxi_group
;

56 
ušt32_t
 
	mvxi_lšk
;

57 
ušt32_t
 
	mvxi_loÿl
;

58 
ušt8_t
 
	mvxi_‰l
;

59 
ušt8_t
 
	mvxi_tos
;

60 
ušt8_t
 
	mvxi_Ë¬nšg
;

61 
ušt32_t
 
	mvxi_agešg
;

62 
ušt32_t
 
	mvxi_lim™
;

63 
iæa_vxÏn_pÜt_¿nge
 
	mvxi_pÜt_¿nge
;

64 
ušt8_t
 
	mvxi_´oxy
;

65 
ušt8_t
 
	mvxi_rsc
;

66 
ušt8_t
 
	mvxi_l2miss
;

67 
ušt8_t
 
	mvxi_l3miss
;

68 
ušt32_t
 
	mvxi_mask
;

73 
Æa_pŞicy
 
	gvxÏn_pŞicy
[
IFLA_VXLAN_MAX
+1] = {

74 [
IFLA_VXLAN_ID
] = { .
ty³
 = 
NLA_U32
 },

75 [
IFLA_VXLAN_GROUP
] = { .
mšËn
 = (
ušt32_t
) },

76 [
IFLA_VXLAN_LINK
] = { .
ty³
 = 
NLA_U32
 },

77 [
IFLA_VXLAN_LOCAL
] = { .
mšËn
 = (
ušt32_t
) },

78 [
IFLA_VXLAN_TTL
] = { .
ty³
 = 
NLA_U8
 },

79 [
IFLA_VXLAN_TOS
] = { .
ty³
 = 
NLA_U8
 },

80 [
IFLA_VXLAN_LEARNING
] = { .
ty³
 = 
NLA_U8
 },

81 [
IFLA_VXLAN_AGEING
] = { .
ty³
 = 
NLA_U32
 },

82 [
IFLA_VXLAN_LIMIT
] = { .
ty³
 = 
NLA_U32
 },

83 [
IFLA_VXLAN_PORT_RANGE
] = { .
mšËn
 = (
iæa_vxÏn_pÜt_¿nge
) },

84 [
IFLA_VXLAN_PROXY
] = { .
ty³
 = 
NLA_U8
 },

85 [
IFLA_VXLAN_RSC
] = { .
ty³
 = 
NLA_U8
 },

86 [
IFLA_VXLAN_L2MISS
] = { .
ty³
 = 
NLA_U8
 },

87 [
IFLA_VXLAN_L3MISS
] = { .
ty³
 = 
NLA_U8
 },

90 
	$vxÏn_®loc
(
¹Æ_lšk
 *
lšk
)

92 
vxÏn_šfo
 *
vxi
;

94 ià((
vxi
 = 
	`ÿÎoc
(1, (*vxi))è=ğ
NULL
)

95  -
NLE_NOMEM
;

97 
lšk
->
l_šfo
 = 
vxi
;

100 
	}
}

102 
	$vxÏn_·r£
(
¹Æ_lšk
 *
lšk
, 
Æ©Œ
 *
d©a
,

103 
Æ©Œ
 *
x¡©s
)

105 
Æ©Œ
 *
tb
[
IFLA_VXLAN_MAX
+1];

106 
vxÏn_šfo
 *
vxi
;

107 
”r
;

109 
	`NL_DBG
(3, "Parsing VXLAN†ink info");

111 ià((
”r
 = 
	`Æa_·r£_Ã¡ed
(
tb
, 
IFLA_VXLAN_MAX
, 
d©a
, 
vxÏn_pŞicy
)) < 0)

112 
”rout
;

114 ià((
”r
 = 
	`vxÏn_®loc
(
lšk
)) < 0)

115 
”rout
;

117 
vxi
 = 
lšk
->
l_šfo
;

119 ià(
tb
[
IFLA_VXLAN_ID
]) {

120 
vxi
->
vxi_id
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VXLAN_ID
]);

121 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_ID
;

124 ià(
tb
[
IFLA_VXLAN_GROUP
]) {

125 
	`Æa_memıy
(&
vxi
->
vxi_group
, 
tb
[
IFLA_VXLAN_GROUP
],

126 (
vxi
->
vxi_group
));

127 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_GROUP
;

130 ià(
tb
[
IFLA_VXLAN_LINK
]) {

131 
vxi
->
vxi_lšk
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VXLAN_LINK
]);

132 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LINK
;

135 ià(
tb
[
IFLA_VXLAN_LOCAL
]) {

136 
	`Æa_memıy
(&
vxi
->
vxi_loÿl
, 
tb
[
IFLA_VXLAN_LOCAL
],

137 (
vxi
->
vxi_loÿl
));

138 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LOCAL
;

141 ià(
tb
[
IFLA_VXLAN_TTL
]) {

142 
vxi
->
vxi_‰l
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_TTL
]);

143 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_TTL
;

146 ià(
tb
[
IFLA_VXLAN_TOS
]) {

147 
vxi
->
vxi_tos
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_TOS
]);

148 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_TOS
;

151 ià(
tb
[
IFLA_VXLAN_LEARNING
]) {

152 
vxi
->
vxi_Ë¬nšg
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_LEARNING
]);

153 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LEARNING
;

156 ià(
tb
[
IFLA_VXLAN_AGEING
]) {

157 
vxi
->
vxi_agešg
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VXLAN_AGEING
]);

158 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_AGEING
;

161 ià(
tb
[
IFLA_VXLAN_LIMIT
]) {

162 
vxi
->
vxi_lim™
 = 
	`Æa_g‘_u32
(
tb
[
IFLA_VXLAN_LIMIT
]);

163 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LIMIT
;

166 ià(
tb
[
IFLA_VXLAN_PORT_RANGE
]) {

167 
	`Æa_memıy
(&
vxi
->
vxi_pÜt_¿nge
, 
tb
[
IFLA_VXLAN_PORT_RANGE
],

168 (
vxi
->
vxi_pÜt_¿nge
));

169 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_PORT_RANGE
;

172 ià(
tb
[
IFLA_VXLAN_PROXY
]) {

173 
vxi
->
vxi_´oxy
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_PROXY
]);

174 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_PROXY
;

177 ià(
tb
[
IFLA_VXLAN_RSC
]) {

178 
vxi
->
vxi_rsc
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_RSC
]);

179 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_RSC
;

182 ià(
tb
[
IFLA_VXLAN_L2MISS
]) {

183 
vxi
->
vxi_l2miss
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_L2MISS
]);

184 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_L2MISS
;

187 ià(
tb
[
IFLA_VXLAN_L3MISS
]) {

188 
vxi
->
vxi_l3miss
 = 
	`Æa_g‘_u8
(
tb
[
IFLA_VXLAN_L3MISS
]);

189 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_L3MISS
;

192 
”r
 = 0;

194 
”rout
:

195  
”r
;

196 
	}
}

198 
	$vxÏn_ä“
(
¹Æ_lšk
 *
lšk
)

200 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

202 
	`ä“
(
vxi
);

203 
lšk
->
l_šfo
 = 
NULL
;

204 
	}
}

206 
	$vxÏn_dump_lše
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

208 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

210 
	`Æ_dump
(
p
, "vxÏn-id %u", 
vxi
->
vxi_id
);

211 
	}
}

213 
	$vxÏn_dump_d‘as
(
¹Æ_lšk
 *
lšk
, 
Æ_dump_·¿ms
 *
p
)

215 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

216 *
Çme
, 
addr
[
INET_ADDRSTRLEN
];

218 
	`Æ_dump_lše
(
p
, " vxÏn-id %u\n", 
vxi
->
vxi_id
);

220 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_GROUP
) {

221 
	`Æ_dump
(
p
, " group ");

222 if(
	`š‘_Áİ
(
AF_INET
, &
vxi
->
vxi_group
, 
addr
, (addr)))

223 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

225 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
vxi
->
vxi_group
));

228 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LINK
) {

229 
	`Æ_dump
(
p
, "†ink ");

230 
Çme
 = 
	`¹Æ_lšk_g‘_Çme
(
lšk
);

231 ià(
Çme
)

232 
	`Æ_dump_lše
(
p
, "%s\n", 
Çme
);

234 
	`Æ_dump_lše
(
p
, "%u\n", 
vxi
->
vxi_lšk
);

237 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LOCAL
) {

238 
	`Æ_dump
(
p
, "†ocal ");

239 if(
	`š‘_Áİ
(
AF_INET
, &
vxi
->
vxi_loÿl
, 
addr
, (addr)))

240 
	`Æ_dump_lše
(
p
, "%s\n", 
addr
);

242 
	`Æ_dump_lše
(
p
, "%#x\n", 
	`Áohs
(
vxi
->
vxi_loÿl
));

245 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TTL
) {

246 
	`Æ_dump
(
p
, "tl ");

247 if(
vxi
->
vxi_‰l
)

248 
	`Æ_dump_lše
(
p
, "%u\n", 
vxi
->
vxi_‰l
);

250 
	`Æ_dump_lše
(
p
, "inherit\n");

253 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TOS
) {

254 
	`Æ_dump
(
p
, "os ");

255 ià(
vxi
->
vxi_tos
 == 1)

256 
	`Æ_dump_lše
(
p
, "šh”™\n", 
vxi
->
vxi_tos
);

258 
	`Æ_dump_lše
(
p
, "%#x\n", 
vxi
->
vxi_tos
);

261 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LEARNING
) {

262 
	`Æ_dump
(
p
, "†earning ");

263 ià(
vxi
->
vxi_Ë¬nšg
)

264 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
vxi
->
vxi_Ë¬nšg
);

266 
	`Æ_dump_lše
(
p
, "disabled\n");

269 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_AGEING
) {

270 
	`Æ_dump
(
p
, "‡geing ");

271 ià(
vxi
->
vxi_agešg
)

272 
	`Æ_dump_lše
(
p
, "%u secÚds\n", 
vxi
->
vxi_agešg
);

274 
	`Æ_dump_lše
(
p
, "disabled\n");

277 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LIMIT
) {

278 
	`Æ_dump
(
p
, "†imit ");

279 ià(
vxi
->
vxi_lim™
)

280 
	`Æ_dump_lše
(
p
, "%u\n", 
vxi
->
vxi_lim™
);

282 
	`Æ_dump_lše
(
p
, "unlimited\n");

285 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PORT_RANGE
)

286 
	`Æ_dump_lše
(
p
, "…ort„ange %u - %u\n",

287 
	`Áohs
(
vxi
->
vxi_pÜt_¿nge
.
low
),

288 
	`Áohs
(
vxi
->
vxi_pÜt_¿nge
.
high
));

290 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PROXY
) {

291 
	`Æ_dump
(
p
, "…roxy ");

292 ià(
vxi
->
vxi_´oxy
)

293 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
vxi
->
vxi_´oxy
);

295 
	`Æ_dump_lše
(
p
, "disabled\n");

298 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_RSC
) {

299 
	`Æ_dump
(
p
, "„sc ");

300 ià(
vxi
->
vxi_rsc
)

301 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
vxi
->
vxi_rsc
);

303 
	`Æ_dump_lše
(
p
, "disabled\n");

306 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L2MISS
) {

307 
	`Æ_dump
(
p
, "†2miss ");

308 ià(
vxi
->
vxi_l2miss
)

309 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
vxi
->
vxi_l2miss
);

311 
	`Æ_dump_lše
(
p
, "disabled\n");

314 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L3MISS
) {

315 
	`Æ_dump
(
p
, "†3miss ");

316 ià(
vxi
->
vxi_l3miss
)

317 
	`Æ_dump_lše
(
p
, "’abËd (%#x)\n", 
vxi
->
vxi_l3miss
);

319 
	`Æ_dump_lše
(
p
, "disabled\n");

321 
	}
}

323 
	$vxÏn_şÚe
(
¹Æ_lšk
 *
d¡
, ¹Æ_lšk *
¤c
)

325 
vxÏn_šfo
 *
vd¡
, *
v¤c
 = 
¤c
->
l_šfo
;

326 
”r
;

328 
d¡
->
l_šfo
 = 
NULL
;

329 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
d¡
, "vxlan")) < 0)

330  
”r
;

331 
vd¡
 = 
d¡
->
l_šfo
;

333 ià(!
vd¡
 || !
v¤c
)

334  -
NLE_NOMEM
;

336 
	`memıy
(
vd¡
, 
v¤c
, (
vxÏn_šfo
));

339 
	}
}

341 
	$vxÏn_put_©Œs
(
Æ_msg
 *
msg
, 
¹Æ_lšk
 *
lšk
)

343 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

344 
Æ©Œ
 *
d©a
;

346 ià(!(
d©a
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
IFLA_INFO_DATA
)))

347  -
NLE_MSGSIZE
;

349 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_ID
)

350 
	`NLA_PUT_U32
(
msg
, 
IFLA_VXLAN_ID
, 
vxi
->
vxi_id
);

352 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_GROUP
)

353 
	`NLA_PUT
(
msg
, 
IFLA_VXLAN_GROUP
, (
vxi
->
vxi_group
), &vxi->vxi_group);

355 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LINK
)

356 
	`NLA_PUT_U32
(
msg
, 
IFLA_VXLAN_LINK
, 
vxi
->
vxi_lšk
);

358 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LOCAL
)

359 
	`NLA_PUT
(
msg
, 
IFLA_VXLAN_LOCAL
, (
vxi
->
vxi_loÿl
), &vxi->vxi_local);

361 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TTL
)

362 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_TTL
, 
vxi
->
vxi_‰l
);

364 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TOS
)

365 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_TOS
, 
vxi
->
vxi_tos
);

367 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LEARNING
)

368 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_LEARNING
, 
vxi
->
vxi_Ë¬nšg
);

370 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_AGEING
)

371 
	`NLA_PUT_U32
(
msg
, 
IFLA_VXLAN_AGEING
, 
vxi
->
vxi_agešg
);

373 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LIMIT
)

374 
	`NLA_PUT_U32
(
msg
, 
IFLA_VXLAN_LIMIT
, 
vxi
->
vxi_lim™
);

376 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PORT_RANGE
)

377 
	`NLA_PUT
(
msg
, 
IFLA_VXLAN_PORT_RANGE
, (
vxi
->
vxi_pÜt_¿nge
),

378 &
vxi
->
vxi_pÜt_¿nge
);

380 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PROXY
)

381 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_PROXY
, 
vxi
->
vxi_´oxy
);

383 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_RSC
)

384 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_RSC
, 
vxi
->
vxi_rsc
);

386 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L2MISS
)

387 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_L2MISS
, 
vxi
->
vxi_l2miss
);

389 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L3MISS
)

390 
	`NLA_PUT_U8
(
msg
, 
IFLA_VXLAN_L3MISS
, 
vxi
->
vxi_l3miss
);

392 
	`Æa_Ã¡_’d
(
msg
, 
d©a
);

394 
Æa_put_çu»
:

397 
	}
}

399 
¹Æ_lšk_šfo_İs
 
	gvxÏn_šfo_İs
 = {

400 .
io_Çme
 = "vxlan",

401 .
	gio_®loc
 = 
vxÏn_®loc
,

402 .
	gio_·r£
 = 
vxÏn_·r£
,

403 .
	gio_dump
 = {

404 [
NL_DUMP_LINE
] = 
vxÏn_dump_lše
,

405 [
NL_DUMP_DETAILS
] = 
vxÏn_dump_d‘as
,

407 .
	gio_şÚe
 = 
vxÏn_şÚe
,

408 .
	gio_put_©Œs
 = 
vxÏn_put_©Œs
,

409 .
	gio_ä“
 = 
vxÏn_ä“
,

413 
	#IS_VXLAN_LINK_ASSERT
(
lšk
) \

414 ià((
lšk
)->
l_šfo_İs
 !ğ&
vxÏn_šfo_İs
) { \

415 
	`APPBUG
("Link is‚ot‡ vxlan†ink. setype \"vxlan\" first."); \

416  -
NLE_OPNOTSUPP
; \

417 }

	)

430 
¹Æ_lšk
 *
	$¹Æ_lšk_vxÏn_®loc
()

432 
¹Æ_lšk
 *
lšk
;

433 
”r
;

435 ià(!(
lšk
 = 
	`¹Æ_lšk_®loc
()))

436  
NULL
;

438 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "vxlan")) < 0) {

439 
	`¹Æ_lšk_put
(
lšk
);

440  
NULL
;

443  
lšk
;

444 
	}
}

452 
	$¹Æ_lšk_is_vxÏn
(
¹Æ_lšk
 *
lšk
)

454  
lšk
->
l_šfo_İs
 && !
	`¡rcmp
Öšk->l_šfo_İs->
io_Çme
, "vxlan");

455 
	}
}

464 
	$¹Æ_lšk_vxÏn_£t_id
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
id
)

466 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

468 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

470 ià(
id
 > 
VXLAN_ID_MAX
)

471  -
NLE_INVAL
;

473 
vxi
->
vxi_id
 = 
id
;

474 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_ID
;

477 
	}
}

486 
	$¹Æ_lšk_vxÏn_g‘_id
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
id
)

488 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

490 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

492 if(!
id
)

493  -
NLE_INVAL
;

495 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_ID
)

496 *
id
 = 
vxi
->
vxi_id
;

498  -
NLE_AGAIN
;

501 
	}
}

510 
	$¹Æ_lšk_vxÏn_£t_group
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 *
addr
)

512 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

514 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

516 ià((
	`Æ_addr_g‘_çmy
(
addr
è!ğ
AF_INET
) ||

517 (
	`Æ_addr_g‘_Ën
(
addr
è!ğ(
vxi
->
vxi_group
)))

518  -
NLE_INVAL
;

520 
	`memıy
(&
vxi
->
vxi_group
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
),

521 (
vxi
->
vxi_group
));

522 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_GROUP
;

525 
	}
}

534 
	$¹Æ_lšk_vxÏn_g‘_group
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 **
addr
)

536 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

538 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

540 ià(!
addr
)

541  -
NLE_INVAL
;

543 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_GROUP
))

544  -
NLE_AGAIN
;

546 *
addr
 = 
	`Æ_addr_bud
(
AF_INET
, &
vxi
->
vxi_group
, (vxi->vxi_group));

549 
	}
}

558 
	$¹Æ_lšk_vxÏn_£t_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
šdex
)

560 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

562 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

564 
vxi
->
vxi_lšk
 = 
šdex
;

565 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LINK
;

568 
	}
}

577 
	$¹Æ_lšk_vxÏn_g‘_lšk
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
šdex
)

579 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

581 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

583 ià(!
šdex
)

584  -
NLE_INVAL
;

586 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LINK
))

587  -
NLE_AGAIN
;

589 *
šdex
 = 
vxi
->
vxi_lšk
;

592 
	}
}

601 
	$¹Æ_lšk_vxÏn_£t_loÿl
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 *
addr
)

603 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

605 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

607 ià((
	`Æ_addr_g‘_çmy
(
addr
è!ğ
AF_INET
) ||

608 (
	`Æ_addr_g‘_Ën
(
addr
è!ğ(
vxi
->
vxi_loÿl
)))

609  -
NLE_INVAL
;

611 
	`memıy
(&
vxi
->
vxi_loÿl
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
),

612 (
vxi
->
vxi_loÿl
));

613 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LOCAL
;

616 
	}
}

625 
	$¹Æ_lšk_vxÏn_g‘_loÿl
(
¹Æ_lšk
 *
lšk
, 
Æ_addr
 **
addr
)

627 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

629 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

631 ià(!
addr
)

632  -
NLE_INVAL
;

634 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LOCAL
))

635  -
NLE_AGAIN
;

637 *
addr
 = 
	`Æ_addr_bud
(
AF_INET
, &
vxi
->
vxi_loÿl
, (vxi->vxi_local));

640 
	}
}

649 
	$¹Æ_lšk_vxÏn_£t_‰l
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
‰l
)

651 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

653 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

655 
vxi
->
vxi_‰l
 = 
‰l
;

656 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_TTL
;

659 
	}
}

667 
	$¹Æ_lšk_vxÏn_g‘_‰l
(
¹Æ_lšk
 *
lšk
)

669 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

671 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

673 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TTL
))

674  -
NLE_AGAIN
;

676  
vxi
->
vxi_‰l
;

677 
	}
}

686 
	$¹Æ_lšk_vxÏn_£t_tos
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
tos
)

688 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

690 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

692 
vxi
->
vxi_tos
 = 
tos
;

693 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_TOS
;

696 
	}
}

704 
	$¹Æ_lšk_vxÏn_g‘_tos
(
¹Æ_lšk
 *
lšk
)

706 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

708 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

710 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_TOS
))

711  -
NLE_AGAIN
;

713  
vxi
->
vxi_tos
;

714 
	}
}

723 
	$¹Æ_lšk_vxÏn_£t_Ë¬nšg
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
Ë¬nšg
)

725 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

727 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

729 
vxi
->
vxi_Ë¬nšg
 = 
Ë¬nšg
;

730 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LEARNING
;

733 
	}
}

741 
	$¹Æ_lšk_vxÏn_g‘_Ë¬nšg
(
¹Æ_lšk
 *
lšk
)

743 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

745 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

747 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LEARNING
))

748  -
NLE_AGAIN
;

750  
vxi
->
vxi_Ë¬nšg
;

751 
	}
}

759 
	$¹Æ_lšk_vxÏn_’abË_Ë¬nšg
(
¹Æ_lšk
 *
lšk
)

761  
	`¹Æ_lšk_vxÏn_£t_Ë¬nšg
(
lšk
, 1);

762 
	}
}

770 
	$¹Æ_lšk_vxÏn_di§bË_Ë¬nšg
(
¹Æ_lšk
 *
lšk
)

772  
	`¹Æ_lšk_vxÏn_£t_Ë¬nšg
(
lšk
, 0);

773 
	}
}

782 
	$¹Æ_lšk_vxÏn_£t_agešg
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
expœy
)

784 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

786 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

788 
vxi
->
vxi_agešg
 = 
expœy
;

789 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_AGEING
;

792 
	}
}

801 
	$¹Æ_lšk_vxÏn_g‘_agešg
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
expœy
)

803 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

805 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

807 ià(!
expœy
)

808  -
NLE_INVAL
;

810 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_AGEING
)

811 *
expœy
 = 
vxi
->
vxi_agešg
;

813  -
NLE_AGAIN
;

816 
	}
}

825 
	$¹Æ_lšk_vxÏn_£t_lim™
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 
lim™
)

827 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

829 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

831 
vxi
->
vxi_lim™
 = 
lim™
;

832 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_LIMIT
;

835 
	}
}

844 
	$¹Æ_lšk_vxÏn_g‘_lim™
(
¹Æ_lšk
 *
lšk
, 
ušt32_t
 *
lim™
)

846 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

848 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

850 ià(!
lim™
)

851  -
NLE_INVAL
;

853 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_LIMIT
)

854 *
lim™
 = 
vxi
->
vxi_lim™
;

856  -
NLE_AGAIN
;

859 
	}
}

868 
	$¹Æ_lšk_vxÏn_£t_pÜt_¿nge
(
¹Æ_lšk
 *
lšk
,

869 
iæa_vxÏn_pÜt_¿nge
 *
¿nge
)

871 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

873 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

875 ià(!
¿nge
)

876  -
NLE_INVAL
;

878 
	`memıy
(&
vxi
->
vxi_pÜt_¿nge
, 
¿nge
, (vxi->vxi_port_range));

879 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_PORT_RANGE
;

882 
	}
}

891 
	$¹Æ_lšk_vxÏn_g‘_pÜt_¿nge
(
¹Æ_lšk
 *
lšk
,

892 
iæa_vxÏn_pÜt_¿nge
 *
¿nge
)

894 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

896 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

898 ià(!
¿nge
)

899  -
NLE_INVAL
;

901 ià(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PORT_RANGE
)

902 
	`memıy
(
¿nge
, &
vxi
->
vxi_pÜt_¿nge
, (*range));

904  -
NLE_AGAIN
;

907 
	}
}

916 
	$¹Æ_lšk_vxÏn_£t_´oxy
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
´oxy
)

918 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

920 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

922 
vxi
->
vxi_´oxy
 = 
´oxy
;

923 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_PROXY
;

926 
	}
}

934 
	$¹Æ_lšk_vxÏn_g‘_´oxy
(
¹Æ_lšk
 *
lšk
)

936 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

938 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

940 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_PROXY
))

941  -
NLE_AGAIN
;

943  
vxi
->
vxi_´oxy
;

944 
	}
}

952 
	$¹Æ_lšk_vxÏn_’abË_´oxy
(
¹Æ_lšk
 *
lšk
)

954  
	`¹Æ_lšk_vxÏn_£t_´oxy
(
lšk
, 1);

955 
	}
}

963 
	$¹Æ_lšk_vxÏn_di§bË_´oxy
(
¹Æ_lšk
 *
lšk
)

965  
	`¹Æ_lšk_vxÏn_£t_´oxy
(
lšk
, 0);

966 
	}
}

975 
	$¹Æ_lšk_vxÏn_£t_rsc
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
rsc
)

977 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

979 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

981 
vxi
->
vxi_rsc
 = 
rsc
;

982 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_RSC
;

985 
	}
}

993 
	$¹Æ_lšk_vxÏn_g‘_rsc
(
¹Æ_lšk
 *
lšk
)

995 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

997 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

999 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_RSC
))

1000  -
NLE_AGAIN
;

1002  
vxi
->
vxi_rsc
;

1003 
	}
}

1011 
	$¹Æ_lšk_vxÏn_’abË_rsc
(
¹Æ_lšk
 *
lšk
)

1013  
	`¹Æ_lšk_vxÏn_£t_rsc
(
lšk
, 1);

1014 
	}
}

1022 
	$¹Æ_lšk_vxÏn_di§bË_rsc
(
¹Æ_lšk
 *
lšk
)

1024  
	`¹Æ_lšk_vxÏn_£t_rsc
(
lšk
, 0);

1025 
	}
}

1034 
	$¹Æ_lšk_vxÏn_£t_l2miss
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
miss
)

1036 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

1038 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

1040 
vxi
->
vxi_l2miss
 = 
miss
;

1041 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_L2MISS
;

1044 
	}
}

1052 
	$¹Æ_lšk_vxÏn_g‘_l2miss
(
¹Æ_lšk
 *
lšk
)

1054 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

1056 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

1058 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L2MISS
))

1059  -
NLE_AGAIN
;

1061  
vxi
->
vxi_l2miss
;

1062 
	}
}

1070 
	$¹Æ_lšk_vxÏn_’abË_l2miss
(
¹Æ_lšk
 *
lšk
)

1072  
	`¹Æ_lšk_vxÏn_£t_l2miss
(
lšk
, 1);

1073 
	}
}

1081 
	$¹Æ_lšk_vxÏn_di§bË_l2miss
(
¹Æ_lšk
 *
lšk
)

1083  
	`¹Æ_lšk_vxÏn_£t_l2miss
(
lšk
, 0);

1084 
	}
}

1093 
	$¹Æ_lšk_vxÏn_£t_l3miss
(
¹Æ_lšk
 *
lšk
, 
ušt8_t
 
miss
)

1095 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

1097 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

1099 
vxi
->
vxi_l3miss
 = 
miss
;

1100 
vxi
->
vxi_mask
 |ğ
VXLAN_HAS_L3MISS
;

1103 
	}
}

1111 
	$¹Æ_lšk_vxÏn_g‘_l3miss
(
¹Æ_lšk
 *
lšk
)

1113 
vxÏn_šfo
 *
vxi
 = 
lšk
->
l_šfo
;

1115 
	`IS_VXLAN_LINK_ASSERT
(
lšk
);

1117 ià(!(
vxi
->
vxi_mask
 & 
VXLAN_HAS_L3MISS
))

1118  -
NLE_AGAIN
;

1120  
vxi
->
vxi_l3miss
;

1121 
	}
}

1129 
	$¹Æ_lšk_vxÏn_’abË_l3miss
(
¹Æ_lšk
 *
lšk
)

1131  
	`¹Æ_lšk_vxÏn_£t_l3miss
(
lšk
, 1);

1132 
	}
}

1140 
	$¹Æ_lšk_vxÏn_di§bË_l3miss
(
¹Æ_lšk
 *
lšk
)

1142  
	`¹Æ_lšk_vxÏn_£t_l3miss
(
lšk
, 0);

1143 
	}
}

1147 
__š™
 
	$vxÏn_š™
()

1149 
	`¹Æ_lšk_»gi¡”_šfo
(&
vxÏn_šfo_İs
);

1150 
	}
}

1152 
__ex™
 
	$vxÏn_ex™
()

1154 
	`¹Æ_lšk_uÄegi¡”_šfo
(&
vxÏn_šfo_İs
);

1155 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/neigh.c

151 
	~<Ãšk-´iv©e/Ãšk.h
>

152 
	~<Ãšk/Ãšk.h
>

153 
	~<Ãšk/uts.h
>

154 
	~<Ãšk/hashbË.h
>

155 
	~<Ãšk/rou‹/¹Æ.h
>

156 
	~<Ãšk/rou‹/Ãighbour.h
>

157 
	~<Ãšk/rou‹/lšk.h
>

158 
	~<Ãšk/hashbË.h
>

161 
	#NEIGH_ATTR_FLAGS
 0x01

	)

162 
	#NEIGH_ATTR_STATE
 0x02

	)

163 
	#NEIGH_ATTR_LLADDR
 0x04

	)

164 
	#NEIGH_ATTR_DST
 0x08

	)

165 
	#NEIGH_ATTR_CACHEINFO
 0x10

	)

166 
	#NEIGH_ATTR_IFINDEX
 0x20

	)

167 
	#NEIGH_ATTR_FAMILY
 0x40

	)

168 
	#NEIGH_ATTR_TYPE
 0x80

	)

169 
	#NEIGH_ATTR_PROBES
 0x100

	)

170 
	#NEIGH_ATTR_MASTER
 0x200

	)

172 
Æ_ÿche_İs
 
	g¹Æ_Ãigh_İs
;

173 
Æ_objeù_İs
 
	gÃigh_obj_İs
;

176 
	$Ãigh_ä“_d©a
(
Æ_objeù
 *
c
)

178 
¹Æ_Ãigh
 *
Ãigh
 = 
	`Æ_objeù_´iv
(
c
);

180 ià(!
Ãigh
)

183 
	`Æ_addr_put
(
Ãigh
->
n_Îaddr
);

184 
	`Æ_addr_put
(
Ãigh
->
n_d¡
);

185 
	}
}

187 
	$Ãigh_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

189 
¹Æ_Ãigh
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

190 
¹Æ_Ãigh
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

192 ià(
¤c
->
n_Îaddr
)

193 ià(!(
d¡
->
n_Îaddr
 = 
	`Æ_addr_şÚe
(
¤c
->n_lladdr)))

194  -
NLE_NOMEM
;

196 ià(
¤c
->
n_d¡
)

197 ià(!(
d¡
->
n_d¡
 = 
	`Æ_addr_şÚe
(
¤c
->n_dst)))

198  -
NLE_NOMEM
;

201 
	}
}

203 
	$Ãigh_keyg’
(
Æ_objeù
 *
obj
, 
ušt32_t
 *
hashkey
,

204 
ušt32_t
 
bË_sz
)

206 
¹Æ_Ãigh
 *
Ãigh
 = (¹Æ_Ãigh *è
obj
;

207 
nkey_sz
;

208 
Æ_addr
 *
addr
 = 
NULL
;

209 
	sÃigh_hash_key
 {

210 
ušt32_t
 
n_çmy
;

211 
ušt32_t
 
n_ifšdex
;

212 
n_addr
[0];

213 } 
	`__©Œibu‹__
((
·cked
)è*
nkey
;

214 #ifdeà
NL_DEBUG


215 
buf
[
INET6_ADDRSTRLEN
+5];

218 ià(
Ãigh
->
n_çmy
 =ğ
AF_BRIDGE
) {

219 ià(
Ãigh
->
n_Îaddr
)

220 
addr
 = 
Ãigh
->
n_Îaddr
;

221 } ià(
Ãigh
->
n_d¡
) {

222 
addr
 = 
Ãigh
->
n_d¡
;

225 
nkey_sz
 = (*
nkey
);

226 ià(
addr
)

227 
nkey_sz
 +ğ
	`Æ_addr_g‘_Ën
(
addr
);

229 
nkey
 = 
	`ÿÎoc
(1, 
nkey_sz
);

230 ià(!
nkey
) {

231 *
hashkey
 = 0;

234 
nkey
->
n_çmy
 = 
Ãigh
->n_family;

235 ià(
Ãigh
->
n_çmy
 =ğ
AF_BRIDGE
)

236 
nkey
->
n_ifšdex
 = 
Ãigh
->
n_ma¡”
;

238 
nkey
->
n_ifšdex
 = 
Ãigh
->n_ifindex;

239 ià(
addr
)

240 
	`memıy
(
nkey
->
n_addr
,

241 
	`Æ_addr_g‘_bš¬y_addr
(
addr
),

242 
	`Æ_addr_g‘_Ën
(
addr
));

244 *
hashkey
 = 
	`Æ_hash
(
nkey
, 
nkey_sz
, 0è% 
bË_sz
;

246 
	`NL_DBG
(5, "neigh %p key (fam %d dev %d‡ddr %s) keysz %d hash 0x%x\n",

247 
Ãigh
, 
nkey
->
n_çmy
,‚key->
n_ifšdex
,

248 
	`Æ_addr2¡r
(
addr
, 
buf
, (buf)),

249 
nkey_sz
, *
hashkey
);

251 
	`ä“
(
nkey
);

254 
	}
}

256 
	$Ãigh_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

257 
ušt32_t
 
©Œs
, 
æags
)

259 
¹Æ_Ãigh
 *
a
 = (¹Æ_Ãigh *è
_a
;

260 
¹Æ_Ãigh
 *
b
 = (¹Æ_Ãigh *è
_b
;

261 
diff
 = 0;

263 
	#NEIGH_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
NEIGH_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

265 
diff
 |ğ
	`NEIGH_DIFF
(
IFINDEX
, 
a
->
n_ifšdex
 !ğ
b
->n_ifindex);

266 
diff
 |ğ
	`NEIGH_DIFF
(
FAMILY
, 
a
->
n_çmy
 !ğ
b
->n_family);

267 
diff
 |ğ
	`NEIGH_DIFF
(
TYPE
, 
a
->
n_ty³
 !ğ
b
->n_type);

268 
diff
 |ğ
	`NEIGH_DIFF
(
LLADDR
, 
	`Æ_addr_cmp
(
a
->
n_Îaddr
, 
b
->n_lladdr));

269 
diff
 |ğ
	`NEIGH_DIFF
(
DST
, 
	`Æ_addr_cmp
(
a
->
n_d¡
, 
b
->n_dst));

270 
diff
 |ğ
	`NEIGH_DIFF
(
MASTER
, 
a
->
n_ma¡”
 !ğ
b
->n_master);

272 ià(
æags
 & 
LOOSE_COMPARISON
) {

273 
diff
 |ğ
	`NEIGH_DIFF
(
STATE
,

274 (
a
->
n_¡©e
 ^ 
b
->n_¡©eè& b->
n_¡©e_mask
);

275 
diff
 |ğ
	`NEIGH_DIFF
(
FLAGS
,

276 (
a
->
n_æags
 ^ 
b
->n_æagsè& b->
n_æag_mask
);

278 
diff
 |ğ
	`NEIGH_DIFF
(
STATE
, 
a
->
n_¡©e
 !ğ
b
->n_state);

279 
diff
 |ğ
	`NEIGH_DIFF
(
FLAGS
, 
a
->
n_æags
 !ğ
b
->n_flags);

282 #undeà
NEIGH_DIFF


284  
diff
;

285 
	}
}

287 cÚ¡ 
Œªs_tbl
 
	gÃigh_©Œs
[] = {

288 
__ADD
(
NEIGH_ATTR_FLAGS
, 
æags
)

289 
__ADD
(
NEIGH_ATTR_STATE
, 
¡©e
)

290 
__ADD
(
NEIGH_ATTR_LLADDR
, 
Îaddr
)

291 
__ADD
(
NEIGH_ATTR_DST
, 
d¡
)

292 
__ADD
(
NEIGH_ATTR_CACHEINFO
, 
ÿchešfo
)

293 
__ADD
(
NEIGH_ATTR_IFINDEX
, 
ifšdex
)

294 
__ADD
(
NEIGH_ATTR_FAMILY
, 
çmy
)

295 
__ADD
(
NEIGH_ATTR_TYPE
, 
ty³
)

296 
__ADD
(
NEIGH_ATTR_PROBES
, 
´obes
)

299 *
	$Ãigh_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

301  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
Ãigh_©Œs
,

302 
	`ARRAY_SIZE
(
Ãigh_©Œs
));

303 
	}
}

305 
ušt32_t
 
	$Ãigh_id_©Œs_g‘
(
Æ_objeù
 *
obj
)

307 
¹Æ_Ãigh
 *
Ãigh
 = (¹Æ_Ãigh *)
obj
;

309 ià(
Ãigh
->
n_çmy
 =ğ
AF_BRIDGE
)

310  (
NEIGH_ATTR_LLADDR
 | 
NEIGH_ATTR_FAMILY
 | 
NEIGH_ATTR_MASTER
);

312  (
NEIGH_ATTR_IFINDEX
 | 
NEIGH_ATTR_DST
 | 
NEIGH_ATTR_FAMILY
);

313 
	}
}

315 
Æa_pŞicy
 
	gÃigh_pŞicy
[
NDA_MAX
+1] = {

316 [
NDA_CACHEINFO
] = { .
mšËn
 = (
nda_ÿchešfo
) },

317 [
NDA_PROBES
] = { .
ty³
 = 
NLA_U32
 },

320 
	$Ãigh_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

321 
Æmsghdr
 *
n
, 
Æ_·r£r_·¿m
 *
µ
)

323 
¹Æ_Ãigh
 *
Ãigh
;

324 
”r
;

326 ià((
”r
 = 
	`¹Æ_Ãigh_·r£
(
n
, &
Ãigh
)) < 0)

327  
”r
;

329 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
Ãigh
,…p);

331 
	`¹Æ_Ãigh_put
(
Ãigh
);

332  
”r
;

333 
	}
}

336 
	$¹Æ_Ãigh_·r£
(
Æmsghdr
 *
n
, 
¹Æ_Ãigh
 **
»suÉ
)

338 
¹Æ_Ãigh
 *
Ãigh
;

339 
Æ©Œ
 *
tb
[
NDA_MAX
 + 1];

340 
ndmsg
 *
nm
;

341 
”r
;

343 
Ãigh
 = 
	`¹Æ_Ãigh_®loc
();

344 ià(!
Ãigh
) {

345 
”r
 = -
NLE_NOMEM
;

346 
”rout
;

349 
Ãigh
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

350 
nm
 = 
	`Æmsg_d©a
(
n
);

352 
”r
 = 
	`Æmsg_·r£
(
n
, (*
nm
), 
tb
, 
NDA_MAX
, 
Ãigh_pŞicy
);

353 ià(
”r
 < 0)

354 
”rout
;

356 
Ãigh
->
n_çmy
 = 
nm
->
ndm_çmy
;

357 
Ãigh
->
n_ifšdex
 = 
nm
->
ndm_ifšdex
;

358 
Ãigh
->
n_¡©e
 = 
nm
->
ndm_¡©e
;

359 
Ãigh
->
n_æags
 = 
nm
->
ndm_æags
;

360 
Ãigh
->
n_ty³
 = 
nm
->
ndm_ty³
;

362 
Ãigh
->
û_mask
 |ğ(
NEIGH_ATTR_FAMILY
 | 
NEIGH_ATTR_IFINDEX
 |

363 
NEIGH_ATTR_STATE
 | 
NEIGH_ATTR_FLAGS
 |

364 
NEIGH_ATTR_TYPE
);

366 ià(
tb
[
NDA_LLADDR
]) {

367 
Ãigh
->
n_Îaddr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
NDA_LLADDR
], 
AF_UNSPEC
);

368 ià(!
Ãigh
->
n_Îaddr
) {

369 
”r
 = -
NLE_NOMEM
;

370 
”rout
;

372 
	`Æ_addr_£t_çmy
(
Ãigh
->
n_Îaddr
,

373 
	`Æ_addr_guess_çmy
(
Ãigh
->
n_Îaddr
));

374 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_LLADDR
;

377 ià(
tb
[
NDA_DST
]) {

378 
Ãigh
->
n_d¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
NDA_DST
],‚eigh->
n_çmy
);

379 ià(!
Ãigh
->
n_d¡
) {

380 
”r
 = -
NLE_NOMEM
;

381 
”rout
;

383 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_DST
;

386 ià(
tb
[
NDA_CACHEINFO
]) {

387 
nda_ÿchešfo
 *
ci
 = 
	`Æa_d©a
(
tb
[
NDA_CACHEINFO
]);

389 
Ãigh
->
n_ÿchešfo
.
nci_cÚfœmed
 = 
ci
->
ndm_cÚfœmed
;

390 
Ãigh
->
n_ÿchešfo
.
nci_u£d
 = 
ci
->
ndm_u£d
;

391 
Ãigh
->
n_ÿchešfo
.
nci_upd©ed
 = 
ci
->
ndm_upd©ed
;

392 
Ãigh
->
n_ÿchešfo
.
nci_»fút
 = 
ci
->
ndm_»fút
;

394 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_CACHEINFO
;

397 ià(
tb
[
NDA_PROBES
]) {

398 
Ãigh
->
n_´obes
 = 
	`Æa_g‘_u32
(
tb
[
NDA_PROBES
]);

399 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_PROBES
;

405 ià(
Ãigh
->
n_çmy
 =ğ
AF_BRIDGE
) {

406 
Æ_ÿche
 *
lÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

407 ià(
lÿche
 ) {

408 
¹Æ_lšk
 *
lšk
 = 
	`¹Æ_lšk_g‘
(
lÿche
,

409 
Ãigh
->
n_ifšdex
);

410 ià(
lšk
) {

411 
Ãigh
->
n_ma¡”
 = 
lšk
->
l_ma¡”
;

412 
	`¹Æ_lšk_put
(
lšk
);

413 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_MASTER
;

416 
	`Æ_ÿche_put
(
lÿche
);

420 *
»suÉ
 = 
Ãigh
;

423 
”rout
:

424 
	`¹Æ_Ãigh_put
(
Ãigh
);

425  
”r
;

426 
	}
}

428 
	$Ãigh_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
h
)

430 
çmy
 = 
c
->
c_Ÿrg1
;

432  
	`Æ_¹g’_»que¡
(
h
, 
RTM_GETNEIGH
, 
çmy
, 
NLM_F_DUMP
);

433 
	}
}

436 
	$Ãigh_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

438 
d¡
[
INET6_ADDRSTRLEN
+5], 
Îaddr
[INET6_ADDRSTRLEN+5];

439 
¹Æ_Ãigh
 *
n
 = (¹Æ_Ãigh *è
a
;

440 
Æ_ÿche
 *
lšk_ÿche
;

441 
¡©e
[128], 
æags
[64];

443 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

445 ià(
n
->
n_çmy
 !ğ
AF_BRIDGE
)

446 
	`Æ_dump_lše
(
p
, "% ", 
	`Æ_addr2¡r
(
n
->
n_d¡
, 
d¡
, (dst)));

448 ià(
lšk_ÿche
)

449 
	`Æ_dump
(
p
, "dev %s ",

450 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
, 
n
->
n_ifšdex
,

451 
¡©e
, (state)));

453 
	`Æ_dump
(
p
, "dev %d ", 
n
->
n_ifšdex
);

455 ià(
n
->
û_mask
 & 
NEIGH_ATTR_LLADDR
)

456 
	`Æ_dump
(
p
, "lladdr %s ",

457 
	`Æ_addr2¡r
(
n
->
n_Îaddr
, 
Îaddr
, (lladdr)));

459 
	`¹Æ_Ãigh_¡©e2¡r
(
n
->
n_¡©e
, 
¡©e
, (state));

460 
	`¹Æ_Ãigh_æags2¡r
(
n
->
n_æags
, 
æags
, (flags));

462 ià(
¡©e
[0])

463 
	`Æ_dump
(
p
, "<%s", 
¡©e
);

464 ià(
æags
[0])

465 
	`Æ_dump
(
p
, "%s%s", 
¡©e
[0] ? "," : "<", 
æags
);

466 ià(
¡©e
[0] || 
æags
[0])

467 
	`Æ_dump
(
p
, ">");

468 
	`Æ_dump
(
p
, "\n");

470 ià(
lšk_ÿche
)

471 
	`Æ_ÿche_put
(
lšk_ÿche
);

472 
	}
}

474 
	$Ãigh_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

476 
¹n_ty³
[32];

477 
¹Æ_Ãigh
 *
n
 = (¹Æ_Ãigh *è
a
;

478 
hz
 = 
	`Æ_g‘_u£r_hz
();

480 
	`Ãigh_dump_lše
(
a
, 
p
);

482 
	`Æ_dump_lše
(
p
, "„efcnt %uype %s confirmed %u used "

484 
n
->
n_ÿchešfo
.
nci_»fút
,

485 
	`Æ_¹Áy³2¡r
(
n
->
n_ty³
, 
¹n_ty³
, (rtn_type)),

486 
n
->
n_ÿchešfo
.
nci_cÚfœmed
/
hz
,

487 
n
->
n_ÿchešfo
.
nci_u£d
/
hz
,‚->n_ÿchešfo.
nci_upd©ed
/hz);

488 
	}
}

490 
	$Ãigh_dump_¡©s
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

492 
	`Ãigh_dump_d‘as
(
a
, 
p
);

493 
	}
}

500 
¹Æ_Ãigh
 *
	$¹Æ_Ãigh_®loc
()

502  (
¹Æ_Ãigh
 *è
	`Æ_objeù_®loc
(&
Ãigh_obj_İs
);

503 
	}
}

505 
	$¹Æ_Ãigh_put
(
¹Æ_Ãigh
 *
Ãigh
)

507 
	`Æ_objeù_put
((
Æ_objeù
 *è
Ãigh
);

508 
	}
}

527 
	$¹Æ_Ãigh_®loc_ÿche
(
Æ_sock
 *
sock
, 
Æ_ÿche
 **
»suÉ
)

529  
	`Æ_ÿche_®loc_ªd_fl
(&
¹Æ_Ãigh_İs
, 
sock
, 
»suÉ
);

530 
	}
}

540 
¹Æ_Ãigh
 * 
	$¹Æ_Ãigh_g‘
(
Æ_ÿche
 *
ÿche
, 
ifšdex
,

541 
Æ_addr
 *
d¡
)

543 
¹Æ_Ãigh
 *
Ãigh
;

545 
	`Æ_li¡_fÜ_—ch_’Œy
(
Ãigh
, &
ÿche
->
c_™ems
, 
û_li¡
) {

546 ià(
Ãigh
->
n_ifšdex
 =ğ
ifšdex
 &&

547 !
	`Æ_addr_cmp
(
Ãigh
->
n_d¡
, 
d¡
)) {

548 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
Ãigh
);

549  
Ãigh
;

553  
NULL
;

554 
	}
}

563 
	$bud_Ãigh_msg
(
¹Æ_Ãigh
 *
tm¶
, 
cmd
, 
æags
,

564 
Æ_msg
 **
»suÉ
)

566 
Æ_msg
 *
msg
;

567 
ndmsg
 
nhdr
 = {

568 .
ndm_ifšdex
 = 
tm¶
->
n_ifšdex
,

569 .
ndm_¡©e
 = 
NUD_PERMANENT
,

572 ià(
tm¶
->
n_çmy
 !ğ
AF_BRIDGE
) {

573 ià(!(
tm¶
->
û_mask
 & 
NEIGH_ATTR_DST
))

574  -
NLE_MISSING_ATTR
;

575 
nhdr
.
ndm_çmy
 = 
	`Æ_addr_g‘_çmy
(
tm¶
->
n_d¡
);

578 
nhdr
.
ndm_çmy
 = 
AF_BRIDGE
;

580 ià(
tm¶
->
û_mask
 & 
NEIGH_ATTR_FLAGS
)

581 
nhdr
.
ndm_æags
 = 
tm¶
->
n_æags
;

583 ià(
tm¶
->
û_mask
 & 
NEIGH_ATTR_STATE
)

584 
nhdr
.
ndm_¡©e
 = 
tm¶
->
n_¡©e
;

586 
msg
 = 
	`Æmsg_®loc_sim¶e
(
cmd
, 
æags
);

587 ià(!
msg
)

588  -
NLE_NOMEM
;

590 ià(
	`Æmsg_­³nd
(
msg
, &
nhdr
, Òhdr), 
NLMSG_ALIGNTO
) < 0)

591 
Æa_put_çu»
;

593 ià(
tm¶
->
n_çmy
 !ğ
AF_BRIDGE
)

594 
	`NLA_PUT_ADDR
(
msg
, 
NDA_DST
, 
tm¶
->
n_d¡
);

596 ià(
tm¶
->
û_mask
 & 
NEIGH_ATTR_LLADDR
)

597 
	`NLA_PUT_ADDR
(
msg
, 
NDA_LLADDR
, 
tm¶
->
n_Îaddr
);

599 *
»suÉ
 = 
msg
;

602 
Æa_put_çu»
:

603 
	`Æmsg_ä“
(
msg
);

604  -
NLE_MSGSIZE
;

605 
	}
}

627 
	$¹Æ_Ãigh_bud_add_»que¡
(
¹Æ_Ãigh
 *
tm¶
, 
æags
,

628 
Æ_msg
 **
»suÉ
)

630  
	`bud_Ãigh_msg
(
tm¶
, 
RTM_NEWNEIGH
, 
æags
, 
»suÉ
);

631 
	}
}

651 
	$¹Æ_Ãigh_add
(
Æ_sock
 *
sk
, 
¹Æ_Ãigh
 *
tm¶
, 
æags
)

653 
”r
;

654 
Æ_msg
 *
msg
;

656 ià((
”r
 = 
	`¹Æ_Ãigh_bud_add_»que¡
(
tm¶
, 
æags
, &
msg
)) < 0)

657  
”r
;

659 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

660 
	`Æmsg_ä“
(
msg
);

661 ià(
”r
 < 0)

662  
”r
;

664  
	`wa™_fÜ_ack
(
sk
);

665 
	}
}

688 
	$¹Æ_Ãigh_bud_d–‘e_»que¡
(
¹Æ_Ãigh
 *
Ãigh
, 
æags
,

689 
Æ_msg
 **
»suÉ
)

691  
	`bud_Ãigh_msg
(
Ãigh
, 
RTM_DELNEIGH
, 
æags
, 
»suÉ
);

692 
	}
}

706 
	$¹Æ_Ãigh_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_Ãigh
 *
Ãigh
,

707 
æags
)

709 
Æ_msg
 *
msg
;

710 
”r
;

712 ià((
”r
 = 
	`¹Æ_Ãigh_bud_d–‘e_»que¡
(
Ãigh
, 
æags
, &
msg
)) < 0)

713  
”r
;

715 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

716 
	`Æmsg_ä“
(
msg
);

717 ià(
”r
 < 0)

718  
”r
;

720  
	`wa™_fÜ_ack
(
sk
);

721 
	}
}

730 cÚ¡ 
Œªs_tbl
 
	gÃigh_¡©es
[] = {

731 
__ADD
(
NUD_INCOMPLETE
, 
šcom¶‘e
)

732 
__ADD
(
NUD_REACHABLE
, 
»achabË
)

733 
__ADD
(
NUD_STALE
, 
¡®e
)

734 
__ADD
(
NUD_DELAY
, 
d–ay
)

735 
__ADD
(
NUD_PROBE
, 
´obe
)

736 
__ADD
(
NUD_FAILED
, 
çed
)

737 
__ADD
(
NUD_NOARP
, 
nÜ¬p
)

738 
__ADD
(
NUD_PERMANENT
, 
³rmª’t
)

741 * 
	$¹Æ_Ãigh_¡©e2¡r
(
¡©e
, *
buf
, 
size_t
 
Ën
)

743  
	`__æags2¡r
(
¡©e
, 
buf
, 
Ën
, 
Ãigh_¡©es
,

744 
	`ARRAY_SIZE
(
Ãigh_¡©es
));

745 
	}
}

747 
	$¹Æ_Ãigh_¡r2¡©e
(cÚ¡ *
Çme
)

749  
	`__¡r2ty³
(
Çme
, 
Ãigh_¡©es
, 
	`ARRAY_SIZE
(neigh_states));

750 
	}
}

759 cÚ¡ 
Œªs_tbl
 
	gÃigh_æags
[] = {

760 
__ADD
(
NTF_USE
, 
u£
)

761 
__ADD
(
NTF_PROXY
, 
´oxy
)

762 
__ADD
(
NTF_ROUTER
, 
rou‹r
)

765 * 
	$¹Æ_Ãigh_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

767  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
Ãigh_æags
,

768 
	`ARRAY_SIZE
(
Ãigh_æags
));

769 
	}
}

771 
	$¹Æ_Ãigh_¡r2æag
(cÚ¡ *
Çme
)

773  
	`__¡r2ty³
(
Çme
, 
Ãigh_æags
, 
	`ARRAY_SIZE
(neigh_flags));

774 
	}
}

783 
	$¹Æ_Ãigh_£t_¡©e
(
¹Æ_Ãigh
 *
Ãigh
, 
¡©e
)

785 
Ãigh
->
n_¡©e_mask
 |ğ
¡©e
;

786 
Ãigh
->
n_¡©e
 |ğ
¡©e
;

787 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_STATE
;

788 
	}
}

790 
	$¹Æ_Ãigh_g‘_¡©e
(
¹Æ_Ãigh
 *
Ãigh
)

792 ià(
Ãigh
->
û_mask
 & 
NEIGH_ATTR_STATE
)

793  
Ãigh
->
n_¡©e
;

796 
	}
}

798 
	$¹Æ_Ãigh_un£t_¡©e
(
¹Æ_Ãigh
 *
Ãigh
, 
¡©e
)

800 
Ãigh
->
n_¡©e_mask
 |ğ
¡©e
;

801 
Ãigh
->
n_¡©e
 &ğ~
¡©e
;

802 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_STATE
;

803 
	}
}

805 
	$¹Æ_Ãigh_£t_æags
(
¹Æ_Ãigh
 *
Ãigh
, 
æags
)

807 
Ãigh
->
n_æag_mask
 |ğ
æags
;

808 
Ãigh
->
n_æags
 |ğ
æags
;

809 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_FLAGS
;

810 
	}
}

812 
	$¹Æ_Ãigh_g‘_æags
(
¹Æ_Ãigh
 *
Ãigh
)

814  
Ãigh
->
n_æags
;

815 
	}
}

817 
	$¹Æ_Ãigh_un£t_æags
(
¹Æ_Ãigh
 *
Ãigh
, 
æags
)

819 
Ãigh
->
n_æag_mask
 |ğ
æags
;

820 
Ãigh
->
n_æags
 &ğ~
æags
;

821 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_FLAGS
;

822 
	}
}

824 
	$¹Æ_Ãigh_£t_ifšdex
(
¹Æ_Ãigh
 *
Ãigh
, 
ifšdex
)

826 
Ãigh
->
n_ifšdex
 = 
ifšdex
;

827 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_IFINDEX
;

828 
	}
}

830 
	$¹Æ_Ãigh_g‘_ifšdex
(
¹Æ_Ãigh
 *
Ãigh
)

832  
Ãigh
->
n_ifšdex
;

833 
	}
}

835 
šlše
 
	$__assign_addr
(
¹Æ_Ãigh
 *
Ãigh
, 
Æ_addr
 **
pos
,

836 
Æ_addr
 *
Ãw
, 
æag
, 
nocheck
)

838 ià(!
nocheck
) {

839 ià(
Ãigh
->
û_mask
 & 
NEIGH_ATTR_FAMILY
) {

840 ià(
Ãw
->
a_çmy
 !ğ
Ãigh
->
n_çmy
)

841  -
NLE_AF_MISMATCH
;

843 
Ãigh
->
n_çmy
 = 
Ãw
->
a_çmy
;

844 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_FAMILY
;

848 ià(*
pos
)

849 
	`Æ_addr_put
(*
pos
);

851 
	`Æ_addr_g‘
(
Ãw
);

852 *
pos
 = 
Ãw
;

854 
Ãigh
->
û_mask
 |ğ
æag
;

857 
	}
}

859 
	$¹Æ_Ãigh_£t_Îaddr
(
¹Æ_Ãigh
 *
Ãigh
, 
Æ_addr
 *
addr
)

861 
	`__assign_addr
(
Ãigh
, &Ãigh->
n_Îaddr
, 
addr
, 
NEIGH_ATTR_LLADDR
, 1);

862 
	}
}

864 
Æ_addr
 *
	$¹Æ_Ãigh_g‘_Îaddr
(
¹Æ_Ãigh
 *
Ãigh
)

866 ià(
Ãigh
->
û_mask
 & 
NEIGH_ATTR_LLADDR
)

867  
Ãigh
->
n_Îaddr
;

869  
NULL
;

870 
	}
}

872 
	$¹Æ_Ãigh_£t_d¡
(
¹Æ_Ãigh
 *
Ãigh
, 
Æ_addr
 *
addr
)

874  
	`__assign_addr
(
Ãigh
, &Ãigh->
n_d¡
, 
addr
,

875 
NEIGH_ATTR_DST
, 0);

876 
	}
}

878 
Æ_addr
 *
	$¹Æ_Ãigh_g‘_d¡
(
¹Æ_Ãigh
 *
Ãigh
)

880 ià(
Ãigh
->
û_mask
 & 
NEIGH_ATTR_DST
)

881  
Ãigh
->
n_d¡
;

883  
NULL
;

884 
	}
}

886 
	$¹Æ_Ãigh_£t_çmy
(
¹Æ_Ãigh
 *
Ãigh
, 
çmy
)

888 
Ãigh
->
n_çmy
 = 
çmy
;

889 
Ãigh
->
û_mask
 |ğ
NEIGH_ATTR_FAMILY
;

890 
	}
}

892 
	$¹Æ_Ãigh_g‘_çmy
(
¹Æ_Ãigh
 *
Ãigh
)

894  
Ãigh
->
n_çmy
;

895 
	}
}

897 
	$¹Æ_Ãigh_£t_ty³
(
¹Æ_Ãigh
 *
Ãigh
, 
ty³
)

899 
Ãigh
->
n_ty³
 = 
ty³
;

900 
Ãigh
->
û_mask
 = 
NEIGH_ATTR_TYPE
;

901 
	}
}

903 
	$¹Æ_Ãigh_g‘_ty³
(
¹Æ_Ãigh
 *
Ãigh
)

905 ià(
Ãigh
->
û_mask
 & 
NEIGH_ATTR_TYPE
)

906  
Ãigh
->
n_ty³
;

909 
	}
}

913 
Æ_objeù_İs
 
	gÃigh_obj_İs
 = {

914 .
oo_Çme
 = "route/neigh",

915 .
	goo_size
 = (
¹Æ_Ãigh
),

916 .
	goo_ä“_d©a
 = 
Ãigh_ä“_d©a
,

917 .
	goo_şÚe
 = 
Ãigh_şÚe
,

918 .
	goo_dump
 = {

919 [
NL_DUMP_LINE
] = 
Ãigh_dump_lše
,

920 [
NL_DUMP_DETAILS
] = 
Ãigh_dump_d‘as
,

921 [
NL_DUMP_STATS
] = 
Ãigh_dump_¡©s
,

923 .
	goo_com·»
 = 
Ãigh_com·»
,

924 .
	goo_keyg’
 = 
Ãigh_keyg’
,

925 .
	goo_©Œs2¡r
 = 
Ãigh_©Œs2¡r
,

926 .
	goo_id_©Œs
 = (
NEIGH_ATTR_IFINDEX
 | 
NEIGH_ATTR_DST
 | 
NEIGH_ATTR_FAMILY
),

927 .
	goo_id_©Œs_g‘
 = 
Ãigh_id_©Œs_g‘


930 
Æ_af_group
 
	gÃigh_groups
[] = {

931 { 
AF_UNSPEC
, 
RTNLGRP_NEIGH
 },

932 { 
AF_BRIDGE
, 
RTNLGRP_NEIGH
 },

933 { 
END_OF_GROUP_LIST
 },

936 
Æ_ÿche_İs
 
	g¹Æ_Ãigh_İs
 = {

937 .
co_Çme
 = "route/neigh",

938 .
	gco_hdrsize
 = (
ndmsg
),

939 .
	gco_msgty³s
 = {

940 { 
RTM_NEWNEIGH
, 
NL_ACT_NEW
, "new" },

941 { 
RTM_DELNEIGH
, 
NL_ACT_DEL
, "del" },

942 { 
RTM_GETNEIGH
, 
NL_ACT_GET
, "get" },

943 
END_OF_MSGTYPES_LIST
,

945 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

946 .
	gco_groups
 = 
Ãigh_groups
,

947 .
	gco_»que¡_upd©e
 = 
Ãigh_»que¡_upd©e
,

948 .
	gco_msg_·r£r
 = 
Ãigh_msg_·r£r
,

949 .
	gco_obj_İs
 = &
Ãigh_obj_İs
,

952 
__š™
 
	$Ãigh_š™
()

954 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_Ãigh_İs
);

955 
	}
}

957 
__ex™
 
	$Ãigh_ex™
()

959 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_Ãigh_İs
);

960 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/neightbl.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk/rou‹/¹Æ.h
>

23 
	~<Ãšk/rou‹/Ãightbl.h
>

24 
	~<Ãšk/rou‹/lšk.h
>

27 
	#NEIGHTBL_ATTR_FAMILY
 0x001

	)

28 
	#NEIGHTBL_ATTR_STATS
 0x002

	)

29 
	#NEIGHTBL_ATTR_NAME
 0x004

	)

30 
	#NEIGHTBL_ATTR_THRESH1
 0x008

	)

31 
	#NEIGHTBL_ATTR_THRESH2
 0x010

	)

32 
	#NEIGHTBL_ATTR_THRESH3
 0x020

	)

33 
	#NEIGHTBL_ATTR_CONFIG
 0x040

	)

34 
	#NEIGHTBL_ATTR_PARMS
 0x080

	)

35 
	#NEIGHTBL_ATTR_GC_INTERVAL
 0x100

	)

37 
	#NEIGHTBLPARM_ATTR_IFINDEX
 0x0001

	)

38 
	#NEIGHTBLPARM_ATTR_REFCNT
 0x0002

	)

39 
	#NEIGHTBLPARM_ATTR_QUEUE_LEN
 0x0004

	)

40 
	#NEIGHTBLPARM_ATTR_APP_PROBES
 0x0008

	)

41 
	#NEIGHTBLPARM_ATTR_UCAST_PROBES
 0x0010

	)

42 
	#NEIGHTBLPARM_ATTR_MCAST_PROBES
 0x0020

	)

43 
	#NEIGHTBLPARM_ATTR_PROXY_QLEN
 0x0040

	)

44 
	#NEIGHTBLPARM_ATTR_REACHABLE_TIME
 0x0080

	)

45 
	#NEIGHTBLPARM_ATTR_BASE_REACHABLE_TIME
 0x0100

	)

46 
	#NEIGHTBLPARM_ATTR_RETRANS_TIME
 0x0200

	)

47 
	#NEIGHTBLPARM_ATTR_GC_STALETIME
 0x0400

	)

48 
	#NEIGHTBLPARM_ATTR_DELAY_PROBE_TIME
 0x0800

	)

49 
	#NEIGHTBLPARM_ATTR_ANYCAST_DELAY
 0x1000

	)

50 
	#NEIGHTBLPARM_ATTR_PROXY_DELAY
 0x2000

	)

51 
	#NEIGHTBLPARM_ATTR_LOCKTIME
 0x4000

	)

53 
Æ_ÿche_İs
 
	g¹Æ_Ãightbl_İs
;

54 
Æ_objeù_İs
 
	gÃightbl_obj_İs
;

57 
	$Ãightbl_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

58 
ušt32_t
 
©Œs
, 
æags
)

60 
¹Æ_Ãightbl
 *
a
 = (¹Æ_ÃightbÈ*è
_a
;

61 
¹Æ_Ãightbl
 *
b
 = (¹Æ_ÃightbÈ*è
_b
;

62 
diff
 = 0;

64 
	#NT_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
NEIGHTBL_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

66 
diff
 |ğ
	`NT_DIFF
(
FAMILY
, 
a
->
Á_çmy
 !ğ
b
->nt_family);

67 
diff
 |ğ
	`NT_DIFF
(
NAME
, 
	`¡rcmp
(
a
->
Á_Çme
, 
b
->nt_name));

68 
diff
 |ğ
	`NT_DIFF
(
THRESH1
, 
a
->
Á_gc_th»sh1
 !ğ
b
->nt_gc_thresh1);

69 
diff
 |ğ
	`NT_DIFF
(
THRESH2
, 
a
->
Á_gc_th»sh2
 !ğ
b
->nt_gc_thresh2);

70 
diff
 |ğ
	`NT_DIFF
(
THRESH3
, 
a
->
Á_gc_th»sh3
 !ğ
b
->nt_gc_thresh3);

71 
diff
 |ğ
	`NT_DIFF
(
GC_INTERVAL
, 
a
->
Á_gc_š‹rv®
 !ğ
b
->nt_gc_interval);

73 #undeà
NT_DIFF


75 ià(!(
a
->
û_mask
 & 
NEIGHTBL_ATTR_PARMS
) &&

76 !(
b
->
û_mask
 & 
NEIGHTBL_ATTR_PARMS
))

77  
diff
;

83 
	#REQ
(
F
è(
å
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_
##F)

	)

84 
	#AVAIL
(
F
è(
İ
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_
##F)

	)

85 
	#_C
(
F
, 
N
è(
	`REQ
(Fè&& (!
	`AVAIL
(Fè|| (
İ
->N !ğ
å
->N)))

	)

86 ià(
	`_C
(
IFINDEX
, 
Áp_ifšdex
) ||

87 
	`_C
(
QUEUE_LEN
, 
Áp_queue_Ën
) ||

88 
	`_C
(
APP_PROBES
, 
Áp_­p_´obes
) ||

89 
	`_C
(
UCAST_PROBES
, 
Áp_uÿ¡_´obes
) ||

90 
	`_C
(
MCAST_PROBES
, 
Áp_mÿ¡_´obes
) ||

91 
	`_C
(
PROXY_QLEN
, 
Áp_´oxy_qËn
) ||

92 
	`_C
(
LOCKTIME
, 
Áp_locktime
) ||

93 
	`_C
(
RETRANS_TIME
, 
Áp_»Œªs_time
) ||

94 
	`_C
(
BASE_REACHABLE_TIME
, 
Áp_ba£_»achabË_time
) ||

95 
	`_C
(
GC_STALETIME
, 
Áp_gc_¡®e_time
) ||

96 
	`_C
(
DELAY_PROBE_TIME
, 
Áp_´obe_d–ay
) ||

97 
	`_C
(
ANYCAST_DELAY
, 
Áp_ªyÿ¡_d–ay
) ||

98 
	`_C
(
PROXY_DELAY
, 
Áp_´oxy_d–ay
))

100 #undeà
REQ


101 #undeà
AVAIL


102 #undeà
_C


105  
diff
;

106 
	}
}

109 
Æa_pŞicy
 
	gÃightbl_pŞicy
[
NDTA_MAX
+1] = {

110 [
NDTA_NAME
] = { .
ty³
 = 
NLA_STRING
,

111 .
	gmaxËn
 = 
NTBLNAMSIZ
 },

112 [
NDTA_THRESH1
] = { .
ty³
 = 
NLA_U32
 },

113 [
NDTA_THRESH2
] = { .
ty³
 = 
NLA_U32
 },

114 [
NDTA_THRESH3
] = { .
ty³
 = 
NLA_U32
 },

115 [
NDTA_GC_INTERVAL
] = { .
ty³
 = 
NLA_U32
 },

116 [
NDTA_CONFIG
] = { .
mšËn
 = (
ndt_cÚfig
) },

117 [
NDTA_STATS
] = { .
mšËn
 = (
ndt_¡©s
) },

118 [
NDTA_PARMS
] = { .
ty³
 = 
NLA_NESTED
 },

121 
	$Ãightbl_msg_·r£r
(
Æ_ÿche_İs
 *
İs
,

122 
sockaddr_Æ
 *
who
, 
Æmsghdr
 *
n
,

123 
Æ_·r£r_·¿m
 *
µ
)

125 
¹Æ_Ãightbl
 *
Ábl
;

126 
Æ©Œ
 *
tb
[
NDTA_MAX
 + 1];

127 
¹g’msg
 *
¹msg
;

128 
”r
;

130 
Ábl
 = 
	`¹Æ_Ãightbl_®loc
();

131 ià(!
Ábl
) {

132 
”r
 = -
NLE_NOMEM
;

133 
”rout
;

136 
Ábl
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

137 
¹msg
 = 
	`Æmsg_d©a
(
n
);

139 
”r
 = 
	`Æmsg_·r£
(
n
, (*
¹msg
), 
tb
, 
NDTA_MAX
, 
Ãightbl_pŞicy
);

140 ià(
”r
 < 0)

141 
”rout
;

143 
Ábl
->
Á_çmy
 = 
¹msg
->
¹g’_çmy
;

145 ià(
tb
[
NDTA_NAME
] =ğ
NULL
) {

146 
”r
 = -
NLE_MISSING_ATTR
;

147 
”rout
;

150 
	`Æa_¡¾ıy
(
Ábl
->
Á_Çme
, 
tb
[
NDTA_NAME
], 
NTBLNAMSIZ
);

151 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_NAME
;

153 ià(
tb
[
NDTA_THRESH1
]) {

154 
Ábl
->
Á_gc_th»sh1
 = 
	`Æa_g‘_u32
(
tb
[
NDTA_THRESH1
]);

155 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH1
;

158 ià(
tb
[
NDTA_THRESH2
]) {

159 
Ábl
->
Á_gc_th»sh2
 = 
	`Æa_g‘_u32
(
tb
[
NDTA_THRESH2
]);

160 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH2
;

163 ià(
tb
[
NDTA_THRESH3
]) {

164 
Ábl
->
Á_gc_th»sh3
 = 
	`Æa_g‘_u32
(
tb
[
NDTA_THRESH3
]);

165 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH3
;

168 ià(
tb
[
NDTA_GC_INTERVAL
]) {

169 
Ábl
->
Á_gc_š‹rv®
 = 
	`Æa_g‘_u32
(
tb
[
NDTA_GC_INTERVAL
]);

170 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_GC_INTERVAL
;

173 ià(
tb
[
NDTA_CONFIG
]) {

174 
	`Æa_memıy
(&
Ábl
->
Á_cÚfig
, 
tb
[
NDTA_CONFIG
],

175 (
Ábl
->
Á_cÚfig
));

176 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_CONFIG
;

179 ià(
tb
[
NDTA_STATS
]) {

180 
	`Æa_memıy
(&
Ábl
->
Á_¡©s
, 
tb
[
NDTA_STATS
],

181 (
Ábl
->
Á_¡©s
));

182 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_STATS
;

185 ià(
tb
[
NDTA_PARMS
]) {

186 
Æ©Œ
 *
tbp
[
NDTPA_MAX
 + 1];

187 
¹Æ_Ãightbl_·rms
 *
p
 = &
Ábl
->
Á_·rms
;

189 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tbp
, 
NDTPA_MAX
, 
tb
[
NDTA_PARMS
], 
NULL
);

190 ià(
”r
 < 0)

191 
”rout
;

193 
	#COPY_ENTRY
(
Çme
, 
v¬
) \

194 ià(
tbp
[
NDTPA_
 ##
Çme
]) { \

195 
p
->
Áp_
 ##
v¬
 = 
	`Æa_g‘_u32
(
tbp
[
NDTPA_
 ##
Çme
]); \

196 
p
->
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_
 ##
Çme
; \

197 }

	)

199 
	`COPY_ENTRY
(
IFINDEX
, 
ifšdex
);

200 
	`COPY_ENTRY
(
REFCNT
, 
»fút
);

201 
	`COPY_ENTRY
(
QUEUE_LEN
, 
queue_Ën
);

202 
	`COPY_ENTRY
(
APP_PROBES
, 
­p_´obes
);

203 
	`COPY_ENTRY
(
UCAST_PROBES
, 
uÿ¡_´obes
);

204 
	`COPY_ENTRY
(
MCAST_PROBES
, 
mÿ¡_´obes
);

205 
	`COPY_ENTRY
(
PROXY_QLEN
, 
´oxy_qËn
);

206 
	`COPY_ENTRY
(
PROXY_DELAY
, 
´oxy_d–ay
);

207 
	`COPY_ENTRY
(
ANYCAST_DELAY
, 
ªyÿ¡_d–ay
);

208 
	`COPY_ENTRY
(
LOCKTIME
, 
locktime
);

209 
	`COPY_ENTRY
(
REACHABLE_TIME
, 
»achabË_time
);

210 
	`COPY_ENTRY
(
BASE_REACHABLE_TIME
, 
ba£_»achabË_time
);

211 
	`COPY_ENTRY
(
RETRANS_TIME
, 
»Œªs_time
);

212 
	`COPY_ENTRY
(
GC_STALETIME
, 
gc_¡®e_time
);

213 
	`COPY_ENTRY
(
DELAY_PROBE_TIME
, 
´obe_d–ay
);

214 #undeà
COPY_ENTRY


216 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

219 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
Ábl
,…p);

220 
”rout
:

221 
	`¹Æ_Ãightbl_put
(
Ábl
);

222  
”r
;

223 
	}
}

225 
	$Ãightbl_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
h
)

227  
	`Æ_¹g’_»que¡
(
h
, 
RTM_GETNEIGHTBL
, 
AF_UNSPEC
, 
NLM_F_DUMP
);

228 
	}
}

231 
	$Ãightbl_dump_lše
(
Æ_objeù
 *
¬g
, 
Æ_dump_·¿ms
 *
p
)

233 
¹Æ_Ãightbl
 *
Ábl
 = (¹Æ_ÃightbÈ*è
¬g
;

235 
	`Æ_dump_lše
(
p
, "%s", 
Ábl
->
Á_Çme
);

237 ià(
Ábl
->
Á_·rms
.
Áp_mask
 & 
NEIGHTBLPARM_ATTR_IFINDEX
) {

238 
Æ_ÿche
 *
lšk_ÿche
;

240 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

242 ià(
lšk_ÿche
) {

243 
buf
[32];

244 
	`Æ_dump
(
p
, "<%s> ",

245 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

246 
Ábl
->
Á_·rms
.
Áp_ifšdex
,

247 
buf
, (buf)));

248 
	`Æ_ÿche_put
(
lšk_ÿche
);

250 
	`Æ_dump
(
p
, "<%u> ", 
Ábl
->
Á_·rms
.
Áp_ifšdex
);

252 
	`Æ_dump
(
p
, " ");

254 ià(
Ábl
->
û_mask
 & 
NEIGHTBL_ATTR_CONFIG
)

255 
	`Æ_dump
(
p
, "’Œ› %u ", 
Ábl
->
Á_cÚfig
.
ndtc_’Œ›s
);

257 ià(
Ábl
->
û_mask
 & 
NEIGHTBL_ATTR_PARMS
) {

258 
¹
[32], 
¹2
[32];

259 
¹Æ_Ãightbl_·rms
 *
·
 = &
Ábl
->
Á_·rms
;

261 
	`Æ_dump
(
p
, "reachable-time %s„etransmit-time %s",

262 
	`Æ_m£c2¡r
(
·
->
Áp_»achabË_time
, 
¹
, (rt)),

263 
	`Æ_m£c2¡r
(
·
->
Áp_»Œªs_time
, 
¹2
, (rt2)));

266 
	`Æ_dump
(
p
, "\n");

267 
	}
}

269 
	$Ãightbl_dump_d‘as
(
Æ_objeù
 *
¬g
, 
Æ_dump_·¿ms
 *
p
)

271 
x
[32], 
y
[32], 
z
[32];

272 
¹Æ_Ãightbl
 *
Ábl
 = (¹Æ_ÃightbÈ*è
¬g
;

274 
	`Ãightbl_dump_lše
(
¬g
, 
p
);

276 ià(
Ábl
->
û_mask
 & 
NEIGHTBL_ATTR_CONFIG
) {

277 
	`Æ_dump_lše
(
p
, " key-len %uƒntry-size %u†ast-flush %s\n",

278 
Ábl
->
Á_cÚfig
.
ndtc_key_Ën
,

279 
Ábl
->
Á_cÚfig
.
ndtc_’Œy_size
,

280 
	`Æ_m£c2¡r
(
Ábl
->
Á_cÚfig
.
ndtc_Ï¡_æush
,

281 
x
, (x)));

283 
	`Æ_dump_lše
(
p
, " gchreshold %u/%u/%u interval %s " \

285 
Ábl
->
Á_gc_th»sh1
,‚tbl->
Á_gc_th»sh2
,

286 
Ábl
->
Á_gc_th»sh3
,

287 
	`Æ_m£c2¡r
(
Ábl
->
Á_gc_š‹rv®
, 
x
, (x)),

288 
Ábl
->
Á_cÚfig
.
ndtc_hash_chaš_gc
);

290 
	`Æ_dump_lše
(
p
, " hash-rand 0x%08X/0x%08X†ast-rand %s\n",

291 
Ábl
->
Á_cÚfig
.
ndtc_hash_ºd
,

292 
Ábl
->
Á_cÚfig
.
ndtc_hash_mask
,

293 
	`Æ_m£c2¡r
(
Ábl
->
Á_cÚfig
.
ndtc_Ï¡_¿nd
,

294 
x
, (x)));

297 ià(
Ábl
->
û_mask
 & 
NEIGHTBL_ATTR_PARMS
) {

298 
¹Æ_Ãightbl_·rms
 *
·
 = &
Ábl
->
Á_·rms
;

300 
	`Æ_dump_lše
(
p
, "„efcnt %u…ending-queue-limit %u " \

302 
·
->
Áp_»fút
,

303 
·
->
Áp_queue_Ën
,

304 
·
->
Áp_´oxy_qËn
);

306 
	`Æ_dump_lše
(
p
, "‚um-userspace-probes %u‚um-unicast-probes " \

308 
·
->
Áp_­p_´obes
,

309 
·
->
Áp_uÿ¡_´obes
,

310 
·
->
Áp_mÿ¡_´obes
);

312 
	`Æ_dump_lše
(
p
, " min-age %s base-reachable-time %s " \

314 
	`Æ_m£c2¡r
(
·
->
Áp_locktime
, 
x
, (x)),

315 
	`Æ_m£c2¡r
(
·
->
Áp_ba£_»achabË_time
,

316 
y
, (y)),

317 
	`Æ_m£c2¡r
(
·
->
Áp_gc_¡®e_time
, 
z
, (z)));

319 
	`Æ_dump_lše
(
p
, " initial-probe-delay %s‡nswer-delay %s " \

321 
	`Æ_m£c2¡r
(
·
->
Áp_´obe_d–ay
, 
x
, (x)),

322 
	`Æ_m£c2¡r
(
·
->
Áp_ªyÿ¡_d–ay
, 
y
, (y)),

323 
	`Æ_m£c2¡r
(
·
->
Áp_´oxy_d–ay
, 
z
, (z)));

325 
	}
}

327 
	$Ãightbl_dump_¡©s
(
Æ_objeù
 *
¬g
, 
Æ_dump_·¿ms
 *
p
)

329 
¹Æ_Ãightbl
 *
Ábl
 = (¹Æ_ÃightbÈ*è
¬g
;

331 
	`Ãightbl_dump_d‘as
(
¬g
, 
p
);

333 ià(!(
Ábl
->
û_mask
 & 
NEIGHTBL_ATTR_STATS
))

336 
	`Æ_dump_lše
(
p
, " " \

337 "†ookup %" 
PRIu64
 \

338 " h™ %" 
PRIu64
 \

339 " faed %" 
PRIu64
 \

340 "‡ÎoÿtiÚ %" 
PRIu64
 \

341 " de¡roy %" 
PRIu64
 \

343 
Ábl
->
Á_¡©s
.
ndts_lookups
,

344 
Ábl
->
Á_¡©s
.
ndts_h™s
,

345 
Ábl
->
Á_¡©s
.
ndts_»s_çed
,

346 
Ábl
->
Á_¡©s
.
ndts_®locs
,

347 
Ábl
->
Á_¡©s
.
ndts_de¡roys
);

349 
	`Æ_dump_lše
(
p
, " " \

350 " hash-grow %" 
PRIu64
 \

351 " fÜûd-gc-run %" 
PRIu64
 \

352 "…”iodic-gc-run %" 
PRIu64
 \

354 
Ábl
->
Á_¡©s
.
ndts_hash_grows
,

355 
Ábl
->
Á_¡©s
.
ndts_fÜûd_gc_runs
,

356 
Ábl
->
Á_¡©s
.
ndts_³riodic_gc_runs
);

358 
	`Æ_dump_lše
(
p
, " " \

359 "„cv-uniÿ¡-´obe %" 
PRIu64
 \

360 "„cv-muÉiÿ¡-´obe %" 
PRIu64
 \

362 
Ábl
->
Á_¡©s
.
ndts_rcv_´obes_uÿ¡
,

363 
Ábl
->
Á_¡©s
.
ndts_rcv_´obes_mÿ¡
);

364 
	}
}

371 
¹Æ_Ãightbl
 *
	$¹Æ_Ãightbl_®loc
()

373  (
¹Æ_Ãightbl
 *è
	`Æ_objeù_®loc
(&
Ãightbl_obj_İs
);

374 
	}
}

376 
	$¹Æ_Ãightbl_put
(
¹Æ_Ãightbl
 *
Ãightbl
)

378 
	`Æ_objeù_put
((
Æ_objeù
 *è
Ãightbl
);

379 
	}
}

399 
	$¹Æ_Ãightbl_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

401  
	`Æ_ÿche_®loc_ªd_fl
(&
¹Æ_Ãightbl_İs
, 
sk
, 
»suÉ
);

402 
	}
}

417 
¹Æ_Ãightbl
 *
	$¹Æ_Ãightbl_g‘
(
Æ_ÿche
 *
ÿche
,

418 cÚ¡ *
Çme
, 
ifšdex
)

420 
¹Æ_Ãightbl
 *
Á
;

422 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_Ãightbl_İs
)

423  
NULL
;

425 
	`Æ_li¡_fÜ_—ch_’Œy
(
Á
, &
ÿche
->
c_™ems
, 
û_li¡
) {

426 ià(!
	`¡rÿ£cmp
(
Á
->
Á_Çme
, 
Çme
) &&

427 ((!
ifšdex
 && !
Á
->
Á_·rms
.
Áp_ifšdex
) ||

428 (
ifšdex
 && ifšdex =ğ
Á
->
Á_·rms
.
Áp_ifšdex
))) {

429 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
Á
);

430  
Á
;

434  
NULL
;

435 
	}
}

460 
	$¹Æ_Ãightbl_bud_chªge_»que¡
(
¹Æ_Ãightbl
 *
Şd
,

461 
¹Æ_Ãightbl
 *
tm¶
,

462 
Æ_msg
 **
»suÉ
)

464 
Æ_msg
 *
m
, *
·rms
 = 
NULL
;

465 
ndtmsg
 
ndt
 = {

466 .
ndtm_çmy
 = 
Şd
->
Á_çmy
,

469 
m
 = 
	`Æmsg_®loc_sim¶e
(
RTM_SETNEIGHTBL
, 0);

470 ià(!
m
)

471  -
NLE_NOMEM
;

473 ià(
	`Æmsg_­³nd
(
m
, &
ndt
, Òdt), 
NLMSG_ALIGNTO
) < 0)

474 
Æa_put_çu»
;

476 
	`NLA_PUT_STRING
(
m
, 
NDTA_NAME
, 
Şd
->
Á_Çme
);

478 ià(
tm¶
->
û_mask
 & 
NEIGHTBL_ATTR_THRESH1
)

479 
	`NLA_PUT_U32
(
m
, 
NDTA_THRESH1
, 
tm¶
->
Á_gc_th»sh1
);

481 ià(
tm¶
->
û_mask
 & 
NEIGHTBL_ATTR_THRESH2
)

482 
	`NLA_PUT_U32
(
m
, 
NDTA_THRESH2
, 
tm¶
->
Á_gc_th»sh2
);

484 ià(
tm¶
->
û_mask
 & 
NEIGHTBL_ATTR_THRESH2
)

485 
	`NLA_PUT_U32
(
m
, 
NDTA_THRESH2
, 
tm¶
->
Á_gc_th»sh2
);

487 ià(
tm¶
->
û_mask
 & 
NEIGHTBL_ATTR_GC_INTERVAL
)

488 
	`NLA_PUT_U64
(
m
, 
NDTA_GC_INTERVAL
,

489 
tm¶
->
Á_gc_š‹rv®
);

491 ià(
tm¶
->
û_mask
 & 
NEIGHTBL_ATTR_PARMS
) {

492 
¹Æ_Ãightbl_·rms
 *
p
 = &
tm¶
->
Á_·rms
;

494 
·rms
 = 
	`Æmsg_®loc
();

495 ià(!
·rms
)

496 
Æa_put_çu»
;

498 ià(
Şd
->
Á_·rms
.
Áp_mask
 & 
NEIGHTBLPARM_ATTR_IFINDEX
)

499 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_IFINDEX
,

500 
Şd
->
Á_·rms
.
Áp_ifšdex
);

503 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_QUEUE_LEN
)

504 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_QUEUE_LEN
, 
p
->
Áp_queue_Ën
);

506 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_APP_PROBES
)

507 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_APP_PROBES
, 
p
->
Áp_­p_´obes
);

509 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_UCAST_PROBES
)

510 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_UCAST_PROBES
,

511 
p
->
Áp_uÿ¡_´obes
);

513 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_MCAST_PROBES
)

514 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_MCAST_PROBES
,

515 
p
->
Áp_mÿ¡_´obes
);

517 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_PROXY_QLEN
)

518 
	`NLA_PUT_U32
(
·rms
, 
NDTPA_PROXY_QLEN
,

519 
p
->
Áp_´oxy_qËn
);

521 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_BASE_REACHABLE_TIME
)

522 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_BASE_REACHABLE_TIME
,

523 
p
->
Áp_ba£_»achabË_time
);

525 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_RETRANS_TIME
)

526 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_RETRANS_TIME
,

527 
p
->
Áp_»Œªs_time
);

529 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_GC_STALETIME
)

530 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_GC_STALETIME
,

531 
p
->
Áp_gc_¡®e_time
);

533 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_DELAY_PROBE_TIME
)

534 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_DELAY_PROBE_TIME
,

535 
p
->
Áp_´oxy_d–ay
);

537 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_ANYCAST_DELAY
)

538 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_ANYCAST_DELAY
,

539 
p
->
Áp_ªyÿ¡_d–ay
);

541 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_PROXY_DELAY
)

542 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_PROXY_DELAY
,

543 
p
->
Áp_´oxy_d–ay
);

545 ià(
p
->
Áp_mask
 & 
NEIGHTBLPARM_ATTR_LOCKTIME
)

546 
	`NLA_PUT_U64
(
·rms
, 
NDTPA_LOCKTIME
, 
p
->
Áp_locktime
);

548 ià(
	`Æa_put_Ã¡ed
(
m
, 
NDTA_PARMS
, 
·rms
) < 0)

549 
Æa_put_çu»
;

551 
	`Æmsg_ä“
(
·rms
);

554 *
»suÉ
 = 
m
;

557 
Æa_put_çu»
:

558 ià(
·rms
)

559 
	`Æmsg_ä“
(
·rms
);

560 
	`Æmsg_ä“
(
m
);

561  -
NLE_MSGSIZE
;

562 
	}
}

577 
	$¹Æ_Ãightbl_chªge
(
Æ_sock
 *
sk
, 
¹Æ_Ãightbl
 *
Şd
,

578 
¹Æ_Ãightbl
 *
tm¶
)

580 
Æ_msg
 *
msg
;

581 
”r
;

583 ià((
”r
 = 
	`¹Æ_Ãightbl_bud_chªge_»que¡
(
Şd
, 
tm¶
, &
msg
)) < 0)

584  
”r
;

586 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

587 
	`Æmsg_ä“
(
msg
);

588 ià(
”r
 < 0)

589  
”r
;

591  
	`wa™_fÜ_ack
(
sk
);

592 
	}
}

601 
	$¹Æ_Ãightbl_£t_çmy
(
¹Æ_Ãightbl
 *
Ábl
, 
çmy
)

603 
Ábl
->
Á_çmy
 = 
çmy
;

604 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_FAMILY
;

605 
	}
}

607 
	$¹Æ_Ãightbl_£t_gc_š‹rv®
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

609 
Ábl
->
Á_gc_š‹rv®
 = 
ms
;

610 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_GC_INTERVAL
;

611 
	}
}

613 
	$¹Æ_Ãightbl_£t_gc_Œesh1
(
¹Æ_Ãightbl
 *
Ábl
, 
th»sh
)

615 
Ábl
->
Á_gc_th»sh1
 = 
th»sh
;

616 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH1
;

617 
	}
}

619 
	$¹Æ_Ãightbl_£t_gc_Œesh2
(
¹Æ_Ãightbl
 *
Ábl
, 
th»sh
)

621 
Ábl
->
Á_gc_th»sh2
 = 
th»sh
;

622 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH2
;

623 
	}
}

625 
	$¹Æ_Ãightbl_£t_gc_Œesh3
(
¹Æ_Ãightbl
 *
Ábl
, 
th»sh
)

627 
Ábl
->
Á_gc_th»sh3
 = 
th»sh
;

628 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_THRESH3
;

629 
	}
}

631 
	$¹Æ_Ãightbl_£t_Çme
(
¹Æ_Ãightbl
 *
Ábl
, cÚ¡ *
Çme
)

633 
	`¡ºıy
(
Ábl
->
Á_Çme
, 
Çme
, (ntbl->nt_name) - 1);

634 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_NAME
;

635 
	}
}

637 
	$¹Æ_Ãightbl_£t_dev
(
¹Æ_Ãightbl
 *
Ábl
, 
ifšdex
)

639 
Ábl
->
Á_·rms
.
Áp_ifšdex
 = 
ifšdex
;

640 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_IFINDEX
;

641 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

642 
	}
}

649 
	$¹Æ_Ãightbl_£t_queue_Ën
(
¹Æ_Ãightbl
 *
Ábl
, 
Ën
)

651 
Ábl
->
Á_·rms
.
Áp_queue_Ën
 = 
Ën
;

652 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_QUEUE_LEN
;

653 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

654 
	}
}

661 
	$¹Æ_Ãightbl_£t_´oxy_queue_Ën
(
¹Æ_Ãightbl
 *
Ábl
, 
Ën
)

663 
Ábl
->
Á_·rms
.
Áp_´oxy_qËn
 = 
Ën
;

664 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_PROXY_QLEN
;

665 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

666 
	}
}

673 
	$¹Æ_Ãightbl_£t_­p_´obes
(
¹Æ_Ãightbl
 *
Ábl
, 
´obes
)

675 
Ábl
->
Á_·rms
.
Áp_­p_´obes
 = 
´obes
;

676 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_APP_PROBES
;

677 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

678 
	}
}

685 
	$¹Æ_Ãightbl_£t_uÿ¡_´obes
(
¹Æ_Ãightbl
 *
Ábl
, 
´obes
)

687 
Ábl
->
Á_·rms
.
Áp_uÿ¡_´obes
 = 
´obes
;

688 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_UCAST_PROBES
;

689 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

690 
	}
}

697 
	$¹Æ_Ãightbl_£t_mÿ¡_´obes
(
¹Æ_Ãightbl
 *
Ábl
, 
´obes
)

699 
Ábl
->
Á_·rms
.
Áp_mÿ¡_´obes
 = 
´obes
;

700 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_MCAST_PROBES
;

701 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

702 
	}
}

709 
	$¹Æ_Ãightbl_£t_ba£_»achabË_time
(
¹Æ_Ãightbl
 *
Ábl
,

710 
ušt64_t
 
ms
)

712 
Ábl
->
Á_·rms
.
Áp_ba£_»achabË_time
 = 
ms
;

713 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_BASE_REACHABLE_TIME
;

714 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

715 
	}
}

722 
	$¹Æ_Ãightbl_£t_»Œªs_time
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

724 
Ábl
->
Á_·rms
.
Áp_»Œªs_time
 = 
ms
;

725 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_RETRANS_TIME
;

726 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

727 
	}
}

734 
	$¹Æ_Ãightbl_£t_gc_¡®e_time
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

736 
Ábl
->
Á_·rms
.
Áp_gc_¡®e_time
 = 
ms
;

737 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_GC_STALETIME
;

738 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

739 
	}
}

746 
	$¹Æ_Ãightbl_£t_d–ay_´obe_time
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

748 
Ábl
->
Á_·rms
.
Áp_´obe_d–ay
 = 
ms
;

749 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_DELAY_PROBE_TIME
;

750 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

751 
	}
}

758 
	$¹Æ_Ãightbl_£t_ªyÿ¡_d–ay
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

760 
Ábl
->
Á_·rms
.
Áp_ªyÿ¡_d–ay
 = 
ms
;

761 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_ANYCAST_DELAY
;

762 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

763 
	}
}

770 
	$¹Æ_Ãightbl_£t_´oxy_d–ay
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

772 
Ábl
->
Á_·rms
.
Áp_´oxy_d–ay
 = 
ms
;

773 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_PROXY_DELAY
;

774 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

775 
	}
}

782 
	$¹Æ_Ãightbl_£t_locktime
(
¹Æ_Ãightbl
 *
Ábl
, 
ušt64_t
 
ms
)

784 
Ábl
->
Á_·rms
.
Áp_locktime
 = 
ms
;

785 
Ábl
->
Á_·rms
.
Áp_mask
 |ğ
NEIGHTBLPARM_ATTR_LOCKTIME
;

786 
Ábl
->
û_mask
 |ğ
NEIGHTBL_ATTR_PARMS
;

787 
	}
}

791 
Æ_objeù_İs
 
	gÃightbl_obj_İs
 = {

792 .
oo_Çme
 = "route/neightbl",

793 .
	goo_size
 = (
¹Æ_Ãightbl
),

794 .
	goo_dump
 = {

795 [
NL_DUMP_LINE
] = 
Ãightbl_dump_lše
,

796 [
NL_DUMP_DETAILS
] = 
Ãightbl_dump_d‘as
,

797 [
NL_DUMP_STATS
] = 
Ãightbl_dump_¡©s
,

799 .
	goo_com·»
 = 
Ãightbl_com·»
,

802 
Æ_ÿche_İs
 
	g¹Æ_Ãightbl_İs
 = {

803 .
co_Çme
 = "route/neightbl",

804 .
	gco_hdrsize
 = (
¹g’msg
),

805 .
	gco_msgty³s
 = {

806 { 
RTM_NEWNEIGHTBL
, 
NL_ACT_NEW
, "new" },

807 { 
RTM_SETNEIGHTBL
, 
NL_ACT_SET
, "set" },

808 { 
RTM_GETNEIGHTBL
, 
NL_ACT_GET
, "get" },

809 
END_OF_MSGTYPES_LIST
,

811 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

812 .
	gco_»que¡_upd©e
 = 
Ãightbl_»que¡_upd©e
,

813 .
	gco_msg_·r£r
 = 
Ãightbl_msg_·r£r
,

814 .
	gco_obj_İs
 = &
Ãightbl_obj_İs
,

817 
__š™
 
	$Ãightbl_š™
()

819 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_Ãightbl_İs
);

820 
	}
}

822 
__ex™
 
	$Ãightbl_ex™
()

824 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_Ãightbl_İs
);

825 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/nexthop.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk/Ãšk.h
>

20 
	~<Ãšk/uts.h
>

21 
	~<Ãšk/rou‹/¹Æ.h
>

22 
	~<Ãšk/rou‹/rou‹.h
>

25 
	#NH_ATTR_FLAGS
 0x000001

	)

26 
	#NH_ATTR_WEIGHT
 0x000002

	)

27 
	#NH_ATTR_IFINDEX
 0x000004

	)

28 
	#NH_ATTR_GATEWAY
 0x000008

	)

29 
	#NH_ATTR_REALMS
 0x000010

	)

37 
¹Æ_Ãxthİ
 *
	$¹Æ_rou‹_nh_®loc
()

39 
¹Æ_Ãxthİ
 *
nh
;

41 
nh
 = 
	`ÿÎoc
(1, (*nh));

42 ià(!
nh
)

43  
NULL
;

45 
	`Æ_š™_li¡_h—d
(&
nh
->
¹nh_li¡
);

47  
nh
;

48 
	}
}

50 
¹Æ_Ãxthİ
 *
	$¹Æ_rou‹_nh_şÚe
(
¹Æ_Ãxthİ
 *
¤c
)

52 
¹Æ_Ãxthİ
 *
nh
;

54 
nh
 = 
	`¹Æ_rou‹_nh_®loc
();

55 ià(!
nh
)

56  
NULL
;

58 
nh
->
¹nh_æags
 = 
¤c
->rtnh_flags;

59 
nh
->
¹nh_æag_mask
 = 
¤c
->rtnh_flag_mask;

60 
nh
->
¹nh_weight
 = 
¤c
->rtnh_weight;

61 
nh
->
¹nh_ifšdex
 = 
¤c
->rtnh_ifindex;

62 
nh
->
û_mask
 = 
¤c
->ce_mask;

64 ià(
¤c
->
¹nh_g©eway
) {

65 
nh
->
¹nh_g©eway
 = 
	`Æ_addr_şÚe
(
¤c
->rtnh_gateway);

66 ià(!
nh
->
¹nh_g©eway
) {

67 
	`ä“
(
nh
);

68  
NULL
;

72  
nh
;

73 
	}
}

75 
	$¹Æ_rou‹_nh_ä“
(
¹Æ_Ãxthİ
 *
nh
)

77 
	`Æ_addr_put
(
nh
->
¹nh_g©eway
);

78 
	`ä“
(
nh
);

79 
	}
}

83 
	$¹Æ_rou‹_nh_com·»
(
¹Æ_Ãxthİ
 *
a
, ¹Æ_Ãxthİ *
b
,

84 
ušt32_t
 
©Œs
, 
loo£
)

86 
diff
 = 0;

88 
	#NH_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
NH_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

90 
diff
 |ğ
	`NH_DIFF
(
IFINDEX
, 
a
->
¹nh_ifšdex
 !ğ
b
->rtnh_ifindex);

91 
diff
 |ğ
	`NH_DIFF
(
WEIGHT
, 
a
->
¹nh_weight
 !ğ
b
->rtnh_weight);

92 
diff
 |ğ
	`NH_DIFF
(
REALMS
, 
a
->
¹nh_»®ms
 !ğ
b
->rtnh_realms);

93 
diff
 |ğ
	`NH_DIFF
(
GATEWAY
, 
	`Æ_addr_cmp
(
a
->
¹nh_g©eway
,

94 
b
->
¹nh_g©eway
));

96 ià(
loo£
)

97 
diff
 |ğ
	`NH_DIFF
(
FLAGS
,

98 (
a
->
¹nh_æags
 ^ 
b
->¹nh_æagsè& b->
¹nh_æag_mask
);

100 
diff
 |ğ
	`NH_DIFF
(
FLAGS
, 
a
->
¹nh_æags
 !ğ
b
->rtnh_flags);

102 #undeà
NH_DIFF


104  
diff
;

105 
	}
}

107 
	$nh_dump_lše
(
¹Æ_Ãxthİ
 *
nh
, 
Æ_dump_·¿ms
 *
dp
)

109 
Æ_ÿche
 *
lšk_ÿche
;

110 
buf
[128];

112 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

114 
	`Æ_dump
(
dp
, "via");

116 ià(
nh
->
û_mask
 & 
NH_ATTR_GATEWAY
)

117 
	`Æ_dump
(
dp
, " %s", 
	`Æ_addr2¡r
(
nh
->
¹nh_g©eway
,

118 
buf
, (buf)));

120 if(
nh
->
û_mask
 & 
NH_ATTR_IFINDEX
) {

121 ià(
lšk_ÿche
) {

122 
	`Æ_dump
(
dp
, " dev %s",

123 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

124 
nh
->
¹nh_ifšdex
,

125 
buf
, (buf)));

127 
	`Æ_dump
(
dp
, " dev %d", 
nh
->
¹nh_ifšdex
);

130 
	`Æ_dump
(
dp
, " ");

132 ià(
lšk_ÿche
)

133 
	`Æ_ÿche_put
(
lšk_ÿche
);

134 
	}
}

136 
	$nh_dump_d‘as
(
¹Æ_Ãxthİ
 *
nh
, 
Æ_dump_·¿ms
 *
dp
)

138 
Æ_ÿche
 *
lšk_ÿche
;

139 
buf
[128];

141 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

143 
	`Æ_dump
(
dp
, "nexthop");

145 ià(
nh
->
û_mask
 & 
NH_ATTR_GATEWAY
)

146 
	`Æ_dump
(
dp
, " vŸ %s", 
	`Æ_addr2¡r
(
nh
->
¹nh_g©eway
,

147 
buf
, (buf)));

149 if(
nh
->
û_mask
 & 
NH_ATTR_IFINDEX
) {

150 ià(
lšk_ÿche
) {

151 
	`Æ_dump
(
dp
, " dev %s",

152 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

153 
nh
->
¹nh_ifšdex
,

154 
buf
, (buf)));

156 
	`Æ_dump
(
dp
, " dev %d", 
nh
->
¹nh_ifšdex
);

159 ià(
nh
->
û_mask
 & 
NH_ATTR_WEIGHT
)

160 
	`Æ_dump
(
dp
, " weighˆ%u", 
nh
->
¹nh_weight
);

162 ià(
nh
->
û_mask
 & 
NH_ATTR_REALMS
)

163 
	`Æ_dump
(
dp
, "„ealm %04x:%04x",

164 
	`RTNL_REALM_FROM
(
nh
->
¹nh_»®ms
),

165 
	`RTNL_REALM_TO
(
nh
->
¹nh_»®ms
));

167 ià(
nh
->
û_mask
 & 
NH_ATTR_FLAGS
)

168 
	`Æ_dump
(
dp
, " <%s>", 
	`¹Æ_rou‹_nh_æags2¡r
(
nh
->
¹nh_æags
,

169 
buf
, (buf)));

171 ià(
lšk_ÿche
)

172 
	`Æ_ÿche_put
(
lšk_ÿche
);

173 
	}
}

175 
	$¹Æ_rou‹_nh_dump
(
¹Æ_Ãxthİ
 *
nh
, 
Æ_dump_·¿ms
 *
dp
)

177 
dp
->
dp_ty³
) {

178 
NL_DUMP_LINE
:

179 
	`nh_dump_lše
(
nh
, 
dp
);

182 
NL_DUMP_DETAILS
:

183 
NL_DUMP_STATS
:

184 ià(
dp
->
dp_iv¬
 =ğ
NH_DUMP_FROM_DETAILS
)

185 
	`nh_dump_d‘as
(
nh
, 
dp
);

191 
	}
}

198 
	$¹Æ_rou‹_nh_£t_weight
(
¹Æ_Ãxthİ
 *
nh
, 
ušt8_t
 
weight
)

200 
nh
->
¹nh_weight
 = 
weight
;

201 
nh
->
û_mask
 |ğ
NH_ATTR_WEIGHT
;

202 
	}
}

204 
ušt8_t
 
	$¹Æ_rou‹_nh_g‘_weight
(
¹Æ_Ãxthİ
 *
nh
)

206  
nh
->
¹nh_weight
;

207 
	}
}

209 
	$¹Æ_rou‹_nh_£t_ifšdex
(
¹Æ_Ãxthİ
 *
nh
, 
ifšdex
)

211 
nh
->
¹nh_ifšdex
 = 
ifšdex
;

212 
nh
->
û_mask
 |ğ
NH_ATTR_IFINDEX
;

213 
	}
}

215 
	$¹Æ_rou‹_nh_g‘_ifšdex
(
¹Æ_Ãxthİ
 *
nh
)

217  
nh
->
¹nh_ifšdex
;

218 
	}
}

221 
	$¹Æ_rou‹_nh_£t_g©eway
(
¹Æ_Ãxthİ
 *
nh
, 
Æ_addr
 *
addr
)

223 
Æ_addr
 *
Şd
 = 
nh
->
¹nh_g©eway
;

225 ià(
addr
) {

226 
nh
->
¹nh_g©eway
 = 
	`Æ_addr_g‘
(
addr
);

227 
nh
->
û_mask
 |ğ
NH_ATTR_GATEWAY
;

229 
nh
->
û_mask
 &ğ~
NH_ATTR_GATEWAY
;

230 
nh
->
¹nh_g©eway
 = 
NULL
;

233 ià(
Şd
)

234 
	`Æ_addr_put
(
Şd
);

235 
	}
}

237 
Æ_addr
 *
	$¹Æ_rou‹_nh_g‘_g©eway
(
¹Æ_Ãxthİ
 *
nh
)

239  
nh
->
¹nh_g©eway
;

240 
	}
}

242 
	$¹Æ_rou‹_nh_£t_æags
(
¹Æ_Ãxthİ
 *
nh
, 
æags
)

244 
nh
->
¹nh_æag_mask
 |ğ
æags
;

245 
nh
->
¹nh_æags
 |ğ
æags
;

246 
nh
->
û_mask
 |ğ
NH_ATTR_FLAGS
;

247 
	}
}

249 
	$¹Æ_rou‹_nh_un£t_æags
(
¹Æ_Ãxthİ
 *
nh
, 
æags
)

251 
nh
->
¹nh_æag_mask
 |ğ
æags
;

252 
nh
->
¹nh_æags
 &ğ~
æags
;

253 
nh
->
û_mask
 |ğ
NH_ATTR_FLAGS
;

254 
	}
}

256 
	$¹Æ_rou‹_nh_g‘_æags
(
¹Æ_Ãxthİ
 *
nh
)

258  
nh
->
¹nh_æags
;

259 
	}
}

261 
	$¹Æ_rou‹_nh_£t_»®ms
(
¹Æ_Ãxthİ
 *
nh
, 
ušt32_t
 
»®ms
)

263 
nh
->
¹nh_»®ms
 = 
»®ms
;

264 
nh
->
û_mask
 |ğ
NH_ATTR_REALMS
;

265 
	}
}

267 
ušt32_t
 
	$¹Æ_rou‹_nh_g‘_»®ms
(
¹Æ_Ãxthİ
 *
nh
)

269  
nh
->
¹nh_»®ms
;

270 
	}
}

279 cÚ¡ 
Œªs_tbl
 
	gnh_æags
[] = {

280 
__ADD
(
RTNH_F_DEAD
, 
d—d
)

281 
__ADD
(
RTNH_F_PERVASIVE
, 
³rvasive
)

282 
__ADD
(
RTNH_F_ONLINK
, 
Úlšk
)

285 *
	$¹Æ_rou‹_nh_æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
)

287  
	`__æags2¡r
(
æags
, 
buf
, 
Ën
, 
nh_æags
, 
	`ARRAY_SIZE
(nh_flags));

288 
	}
}

290 
	$¹Æ_rou‹_nh_¡r2æags
(cÚ¡ *
Çme
)

292  
	`__¡r2æags
(
Çme
, 
nh_æags
, 
	`ARRAY_SIZE
(nh_flags));

293 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/pktloc.c

34 
	~<Ãšk-´iv©e/Ãšk.h
>

35 
	~<Ãšk-´iv©e/tc.h
>

36 
	~<Ãšk/Ãšk.h
>

37 
	~<Ãšk/uts.h
>

38 
	~<Ãšk/rou‹/pkoc.h
>

40 
	~"pkoc_syÁax.h
"

41 
	~"pkoc_g¿mm¬.h
"

44 
	#PKTLOC_NAME_HT_SIZ
 256

	)

46 
Æ_li¡_h—d
 
	gpkoc_Çme_ht
[
PKTLOC_NAME_HT_SIZ
];

49 
	$pkoc_hash
(cÚ¡ *
¡r
)

51 
hash
 = 5381;

52 
c
;

54 (
c
 = *
¡r
++))

55 
hash
 = ((hash << 5è+ hashè+ 
c
;

57  
hash
 % 
PKTLOC_NAME_HT_SIZ
;

58 
	}
}

60 
	$__pkoc_lookup
(cÚ¡ *
Çme
, 
¹Æ_pkoc
 **
»suÉ
)

62 
¹Æ_pkoc
 *
loc
;

63 
hash
;

65 
hash
 = 
	`pkoc_hash
(
Çme
);

66 
	`Æ_li¡_fÜ_—ch_’Œy
(
loc
, &
pkoc_Çme_ht
[
hash
], 
li¡
) {

67 ià(!
	`¡rÿ£cmp
(
loc
->
Çme
,‚ame)) {

68 
loc
->
»fút
++;

69 *
»suÉ
 = 
loc
;

74  -
NLE_OBJ_NOTFOUND
;

75 
	}
}

77 
pkoc_·r£
(*
sÿÂ”
);

79 
	$¹Æ_pkoc_ä“
(
¹Æ_pkoc
 *
loc
)

81 ià(!
loc
)

84 
	`ä“
(
loc
->
Çme
);

85 
	`ä“
(
loc
);

86 
	}
}

88 
	$»ad_pkocs
()

90 
YY_BUFFER_STATE
 
buf
 = 
NULL
;

91 
yysÿn_t
 
sÿÂ”
 = 
NULL
;

92 
time_t
 
Ï¡_»ad
;

93 
¡©
 
¡
;

94 *
·th
;

95 
i
, 
”r
;

96 
FILE
 *
fd
;

98 ià(
	`bud_syscÚf_·th
(&
·th
, "pktloc") < 0)

99  -
NLE_NOMEM
;

102 ià(
	`¡©
(
·th
, &
¡
) == 0) {

104 ià(
Ï¡_»ad
 =ğ
¡
.
¡_mtime
)

108 
	`NL_DBG
(2, "R—dšg…ack‘†oÿtiÚ f\"%s\"\n", 
·th
);

110 ià(!(
fd
 = 
	`fİ’
(
·th
, "r"))) {

111 
”r
 = -
NLE_PKTLOC_FILE
;

112 
”rout
;

115 
i
 = 0; i < 
PKTLOC_NAME_HT_SIZ
; i++) {

116 
¹Æ_pkoc
 *
loc
, *
n
;

118 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
loc
, 
n
, &
pkoc_Çme_ht
[
i
], 
li¡
)

119 
	`¹Æ_pkoc_put
(
loc
);

121 
	`Æ_š™_li¡_h—d
(&
pkoc_Çme_ht
[
i
]);

124 ià((
”r
 = 
	`pkoc_Ëx_š™
(&
sÿÂ”
)) < 0) {

125 
”r
 = -
NLE_FAILURE
;

126 
”rout_şo£
;

129 
buf
 = 
	`pkoc__ü—‹_bufãr
(
fd
, 
YY_BUF_SIZE
, 
sÿÂ”
);

130 
	`pkoc__sw™ch_to_bufãr
(
buf
, 
sÿÂ”
);

132 ià((
”r
 = 
	`pkoc_·r£
(
sÿÂ”
)) != 0) {

133 
	`pkoc__d–‘e_bufãr
(
buf
, 
sÿÂ”
);

134 
”r
 = -
NLE_PARSE_ERR
;

135 
”rout_sÿÂ”
;

138 
Ï¡_»ad
 = 
¡
.
¡_mtime
;

140 
”rout_sÿÂ”
:

141 
	`pkoc_Ëx_de¡roy
(
sÿÂ”
);

142 
”rout_şo£
:

143 
	`fşo£
(
fd
);

144 
”rout
:

145 
	`ä“
(
·th
);

147  
”r
;

148 
	}
}

171 
	$¹Æ_pkoc_lookup
(cÚ¡ *
Çme
, 
¹Æ_pkoc
 **
»suÉ
)

173 
”r
;

175 ià((
”r
 = 
	`»ad_pkocs
()) < 0)

176  
”r
;

178  
	`__pkoc_lookup
(
Çme
, 
»suÉ
);

179 
	}
}

184 
¹Æ_pkoc
 *
	$¹Æ_pkoc_®loc
()

186 
¹Æ_pkoc
 *
loc
;

188 ià(!(
loc
 = 
	`ÿÎoc
(1, (*loc))))

189  
NULL
;

191 
loc
->
»fút
 = 1;

192 
	`Æ_š™_li¡_h—d
(&
loc
->
li¡
);

194  
loc
;

195 
	}
}

201 
	$¹Æ_pkoc_put
(
¹Æ_pkoc
 *
loc
)

203 ià(!
loc
)

206 
loc
->
»fút
--;

207 ià(
loc
->
»fút
 <= 0)

208 
	`¹Æ_pkoc_ä“
(
loc
);

209 
	}
}

217 
	$¹Æ_pkoc_add
(
¹Æ_pkoc
 *
loc
)

219 
¹Æ_pkoc
 *
l
;

221 ià(
	`__pkoc_lookup
(
loc
->
Çme
, &
l
) == 0) {

222 
	`¹Æ_pkoc_put
(
l
);

223  -
NLE_EXIST
;

226 
	`NL_DBG
(2, "New…acket†ocationƒntry \"%s\"‡lign=%u†ayer=%u "

228 
loc
->
Çme
,†oc->
®ign
,†oc->
Ïy”
,†oc->
off£t
,

229 
loc
->
mask
,†oc->
shiá
,†oc->
»fút
);

231 
	`Æ_li¡_add_
(&
loc
->
li¡
, &
pkoc_Çme_ht
[
	`pkoc_hash
Öoc->
Çme
)]);

234 
	}
}

236 
¹Æ_pkoc_fÜ—ch
((*
cb
)(
¹Æ_pkoc
 *, *), *
¬g
)

238 
¹Æ_pkoc
 *
loc
;

239 
i
;

242 
	`»ad_pkocs
();

244 
i
 = 0; i < 
PKTLOC_NAME_HT_SIZ
; i++)

245 
	`Æ_li¡_fÜ_—ch_’Œy
(
loc
, &
pkoc_Çme_ht
[
i
], 
li¡
)

246 
	`cb
(
loc
, 
¬g
);

247 
	}
}

249 
__š™
 
	$pkoc_š™
()

251 
i
;

253 
i
 = 0; i < 
PKTLOC_NAME_HT_SIZ
; i++)

254 
	`Æ_š™_li¡_h—d
(&
pkoc_Çme_ht
[
i
]);

257 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.c

5 
	#YY_INT_ALIGNED
 

	)

9 
	#FLEX_SCANNER


	)

10 
	#YY_FLEX_MAJOR_VERSION
 2

	)

11 
	#YY_FLEX_MINOR_VERSION
 5

	)

12 
	#YY_FLEX_SUBMINOR_VERSION
 39

	)

13 #ià
YY_FLEX_SUBMINOR_VERSION
 > 0

14 
	#FLEX_BETA


	)

20 
	~<¡dio.h
>

21 
	~<¡ršg.h
>

22 
	~<”ºo.h
>

23 
	~<¡dlib.h
>

29 #iâdeà
FLEXINT_H


30 
	#FLEXINT_H


	)

34 #ià
defšed
 (
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

39 #iâdeà
__STDC_LIMIT_MACROS


40 
	#__STDC_LIMIT_MACROS
 1

	)

43 
	~<š‰y³s.h
>

44 
št8_t
 
	tæex_št8_t
;

45 
ušt8_t
 
	tæex_ušt8_t
;

46 
št16_t
 
	tæex_št16_t
;

47 
ušt16_t
 
	tæex_ušt16_t
;

48 
št32_t
 
	tæex_št32_t
;

49 
ušt32_t
 
	tæex_ušt32_t
;

51 sigÃd 
	tæex_št8_t
;

52 
	tæex_št16_t
;

53 
	tæex_št32_t
;

54 
	tæex_ušt8_t
;

55 
	tæex_ušt16_t
;

56 
	tæex_ušt32_t
;

59 #iâdeà
INT8_MIN


60 
	#INT8_MIN
 (-128)

	)

62 #iâdeà
INT16_MIN


63 
	#INT16_MIN
 (-32767-1)

	)

65 #iâdeà
INT32_MIN


66 
	#INT32_MIN
 (-2147483647-1)

	)

68 #iâdeà
INT8_MAX


69 
	#INT8_MAX
 (127)

	)

71 #iâdeà
INT16_MAX


72 
	#INT16_MAX
 (32767)

	)

74 #iâdeà
INT32_MAX


75 
	#INT32_MAX
 (2147483647)

	)

77 #iâdeà
UINT8_MAX


78 
	#UINT8_MAX
 (255U)

	)

80 #iâdeà
UINT16_MAX


81 
	#UINT16_MAX
 (65535U)

	)

83 #iâdeà
UINT32_MAX


84 
	#UINT32_MAX
 (4294967295U)

	)

91 #ifdeà
__ılu¥lus


94 
	#YY_USE_CONST


	)

99 #ià
defšed
 (
__STDC__
)

101 
	#YY_USE_CONST


	)

106 #ifdeà
YY_USE_CONST


107 
	#yycÚ¡
 cÚ¡

	)

109 
	#yycÚ¡


	)

113 
	#YY_NULL
 0

	)

120 
	#YY_SC_TO_UI
(
c
è((è(èc)

	)

123 #iâdeà
YY_TYPEDEF_YY_SCANNER_T


124 
	#YY_TYPEDEF_YY_SCANNER_T


	)

125 * 
	tyysÿn_t
;

130 
	#yyš
 
yyg
->
yyš_r


	)

131 
	#yyout
 
yyg
->
yyout_r


	)

132 
	#yyexŒa
 
yyg
->
yyexŒa_r


	)

133 
	#yyËng
 
yyg
->
yyËng_r


	)

134 
	#yy‹xt
 
yyg
->
yy‹xt_r


	)

135 
	#yylš’o
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_lš’o
)

	)

136 
	#yycŞumn
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_cŞumn
)

	)

137 
	#yy_æex_debug
 
yyg
->
yy_æex_debug_r


	)

143 
	#BEGIN
 
yyg
->
yy_¡¬t
 = 1 + 2 *

	)

149 
	#YY_START
 ((
yyg
->
yy_¡¬t
 - 1è/ 2)

	)

150 
	#YYSTATE
 
YY_START


	)

153 
	#YY_STATE_EOF
(
¡©e
è(
YY_END_OF_BUFFER
 + s‹ + 1)

	)

156 
	#YY_NEW_FILE
 
	`pkoc_»¡¬t
(
yyš
 ,
yysÿÂ”
 )

	)

158 
	#YY_END_OF_BUFFER_CHAR
 0

	)

161 #iâdeà
YY_BUF_SIZE


162 #ifdeà
__Ÿ64__


167 
	#YY_BUF_SIZE
 32768

	)

169 
	#YY_BUF_SIZE
 16384

	)

175 
	#YY_STATE_BUF_SIZE
 ((
YY_BUF_SIZE
 + 2è* (
yy_¡©e_ty³
))

	)

177 #iâdeà
YY_TYPEDEF_YY_BUFFER_STATE


178 
	#YY_TYPEDEF_YY_BUFFER_STATE


	)

179 
yy_bufãr_¡©e
 *
	tYY_BUFFER_STATE
;

182 #iâdeà
YY_TYPEDEF_YY_SIZE_T


183 
	#YY_TYPEDEF_YY_SIZE_T


	)

184 
size_t
 
	tyy_size_t
;

187 
	#EOB_ACT_CONTINUE_SCAN
 0

	)

188 
	#EOB_ACT_END_OF_FILE
 1

	)

189 
	#EOB_ACT_LAST_MATCH
 2

	)

191 
	#YY_LESS_LINENO
(
n
)

	)

192 
	#YY_LINENO_REWIND_TO
(
±r
)

	)

195 
	#yyËss
(
n
) \

199 
yyËss_maüo_¬g
 = (
n
); \

200 
	`YY_LESS_LINENO
(
yyËss_maüo_¬g
);\

201 *
yy_ı
 = 
yyg
->
yy_hŞd_ch¬
; \

202 
YY_RESTORE_YY_MORE_OFFSET
 \

203 
yyg
->
yy_c_buf_p
 = 
yy_ı
 = 
yy_bp
 + 
yyËss_maüo_¬g
 - 
YY_MORE_ADJ
; \

204 
YY_DO_BEFORE_ACTION
; \

206  0 )

	)

208 
	#uÅut
(
c
è
	`yyuÅut
Ğc, 
yyg
->
yy‹xt_±r
 , 
yysÿÂ”
 )

	)

210 #iâdeà
YY_STRUCT_YY_BUFFER_STATE


211 
	#YY_STRUCT_YY_BUFFER_STATE


	)

212 
	syy_bufãr_¡©e


214 
FILE
 *
	myy_šput_fe
;

216 *
	myy_ch_buf
;

217 *
	myy_buf_pos
;

222 
yy_size_t
 
	myy_buf_size
;

227 
yy_size_t
 
	myy_n_ch¬s
;

233 
	myy_is_our_bufãr
;

240 
	myy_is_š‹¿ùive
;

246 
	myy_©_bŞ
;

248 
	myy_bs_lš’o
;

249 
	myy_bs_cŞumn
;

254 
	myy_fl_bufãr
;

256 
	myy_bufãr_¡©us
;

258 
	#YY_BUFFER_NEW
 0

	)

259 
	#YY_BUFFER_NORMAL
 1

	)

270 
	#YY_BUFFER_EOF_PENDING
 2

	)

281 
	#YY_CURRENT_BUFFER
 ( 
yyg
->
yy_bufãr_¡ack
 \

282 ? 
yyg
->
yy_bufãr_¡ack
[yyg->
yy_bufãr_¡ack_tİ
] \

283 : 
NULL
)

	)

288 
	#YY_CURRENT_BUFFER_LVALUE
 
yyg
->
yy_bufãr_¡ack
[yyg->
yy_bufãr_¡ack_tİ
]

	)

290 
pkoc_»¡¬t
 (
FILE
 *
šput_fe
 ,
yysÿn_t
 
yysÿÂ”
 );

291 
pkoc__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

292 
YY_BUFFER_STATE
 
pkoc__ü—‹_bufãr
 (
FILE
 *
fe
,
size
 ,
yysÿn_t
 
yysÿÂ”
 );

293 
pkoc__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

294 
pkoc__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

295 
pkoc_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

296 
pkoc_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

298 
pkoc_’su»_bufãr_¡ack
 (
yysÿn_t
 
yysÿÂ”
 );

299 
pkoc__lßd_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

300 
pkoc__š™_bufãr
 (
YY_BUFFER_STATE
 
b
,
FILE
 *
fe
 ,
yysÿn_t
 
yysÿÂ”
 );

302 
	#YY_FLUSH_BUFFER
 
	`pkoc__æush_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
)

	)

304 
YY_BUFFER_STATE
 
pkoc__sÿn_bufãr
 (*
ba£
,
yy_size_t
 
size
 ,
yysÿn_t
 
yysÿÂ”
 );

305 
YY_BUFFER_STATE
 
pkoc__sÿn_¡ršg
 (
yycÚ¡
 *
yy_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

306 
YY_BUFFER_STATE
 
pkoc__sÿn_by‹s
 (
yycÚ¡
 *
by‹s
,
yy_size_t
 
Ën
 ,
yysÿn_t
 
yysÿÂ”
 );

308 *
pkoc_®loc
 (
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

309 *
pkoc_»®loc
 (*,
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

310 
pkoc_ä“
 (* ,
yysÿn_t
 
yysÿÂ”
 );

312 
	#yy_Ãw_bufãr
 
pkoc__ü—‹_bufãr


	)

314 
	#yy_£t_š‹¿ùive
(
is_š‹¿ùive
) \

316 iàĞ! 
YY_CURRENT_BUFFER
 ){ \

317 
	`pkoc_’su»_bufãr_¡ack
 (
yysÿÂ”
); \

318 
YY_CURRENT_BUFFER_LVALUE
 = \

319 
	`pkoc__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
); \

321 
YY_CURRENT_BUFFER_LVALUE
->
yy_is_š‹¿ùive
 = 
is_š‹¿ùive
; \

322 }

	)

324 
	#yy_£t_bŞ
(
©_bŞ
) \

326 iàĞ! 
YY_CURRENT_BUFFER
 ){\

327 
	`pkoc_’su»_bufãr_¡ack
 (
yysÿÂ”
); \

328 
YY_CURRENT_BUFFER_LVALUE
 = \

329 
	`pkoc__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
); \

331 
YY_CURRENT_BUFFER_LVALUE
->
yy_©_bŞ
 = 
©_bŞ
; \

332 }

	)

334 
	#YY_AT_BOL
(è(
YY_CURRENT_BUFFER_LVALUE
->
yy_©_bŞ
)

	)

336 
	#pkoc_w¿p
(
yysÿÂ”
è1

	)

337 
	#YY_SKIP_YYWRAP


	)

339 
	tYY_CHAR
;

341 
	tyy_¡©e_ty³
;

343 
	#yy‹xt_±r
 
yy‹xt_r


	)

345 
yy_¡©e_ty³
 
yy_g‘_´evious_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

346 
yy_¡©e_ty³
 
yy_Œy_NUL_Œªs
 (yy_¡©e_ty³ 
cu¼’t_¡©e
 ,
yysÿn_t
 
yysÿÂ”
);

347 
yy_g‘_Ãxt_bufãr
 (
yysÿn_t
 
yysÿÂ”
 );

348 
yy_çl_”rÜ
 (
yycÚ¡
 
msg
[] ,
yysÿn_t
 
yysÿÂ”
 );

353 
	#YY_DO_BEFORE_ACTION
 \

354 
yyg
->
yy‹xt_±r
 = 
yy_bp
; \

355 
yyËng
 = (
size_t
è(
yy_ı
 - 
yy_bp
); \

356 
yyg
->
yy_hŞd_ch¬
 = *
yy_ı
; \

357 *
yy_ı
 = '\0'; \

358 
yyg
->
yy_c_buf_p
 = 
yy_ı
;

	)

360 
	#YY_NUM_RULES
 16

	)

361 
	#YY_END_OF_BUFFER
 17

	)

364 
	syy_Œªs_šfo


366 
æex_št32_t
 
	myy_v”ify
;

367 
æex_št32_t
 
	myy_nxt
;

369 
yycÚ¡
 
æex_št16_t
 
	gyy_acû±
[47] =

378 
yycÚ¡
 
æex_št32_t
 
	gyy_ec
[256] =

410 
yycÚ¡
 
æex_št32_t
 
	gyy_m‘a
[29] =

417 
yycÚ¡
 
æex_št16_t
 
	gyy_ba£
[50] =

426 
yycÚ¡
 
æex_št16_t
 
	gyy_def
[50] =

435 
yycÚ¡
 
æex_št16_t
 
	gyy_nxt
[116] =

452 
yycÚ¡
 
æex_št16_t
 
	gyy_chk
[116] =

472 
	#REJECT
 
»jeù_u£d_but_nÙ_d‘eùed


	)

473 
	#yymÜe
(è
yymÜe_u£d_but_nÙ_d‘eùed


	)

474 
	#YY_MORE_ADJ
 0

	)

475 
	#YY_RESTORE_YY_MORE_OFFSET


	)

478 
	~<Ãšk-´iv©e/Ãšk.h
>

479 
	~<Ãšk-´iv©e/tc.h
>

480 
	~<Ãšk/Ãšk.h
>

481 
	~<Ãšk/uts.h
>

482 
	~<Ãšk/rou‹/pkoc.h
>

483 
	~"pkoc_syÁax.h
"

484 
	#YY_NO_INPUT
 1

	)

487 
	#INITIAL
 0

	)

489 #iâdeà
YY_NO_UNISTD_H


494 
	~<uni¡d.h
>

497 #iâdeà
YY_EXTRA_TYPE


498 
	#YY_EXTRA_TYPE
 *

	)

502 
	syyguts_t


506 
YY_EXTRA_TYPE
 
	myyexŒa_r
;

509 
FILE
 *
	myyš_r
, *
	myyout_r
;

510 
size_t
 
	myy_bufãr_¡ack_tİ
;

511 
size_t
 
	myy_bufãr_¡ack_max
;

512 
YY_BUFFER_STATE
 * 
	myy_bufãr_¡ack
;

513 
	myy_hŞd_ch¬
;

514 
yy_size_t
 
	myy_n_ch¬s
;

515 
yy_size_t
 
	myyËng_r
;

516 *
	myy_c_buf_p
;

517 
	myy_š™
;

518 
	myy_¡¬t
;

519 
	myy_did_bufãr_sw™ch_Ú_eof
;

520 
	myy_¡¬t_¡ack_±r
;

521 
	myy_¡¬t_¡ack_d•th
;

522 *
	myy_¡¬t_¡ack
;

523 
yy_¡©e_ty³
 
	myy_Ï¡_acû±šg_¡©e
;

524 * 
	myy_Ï¡_acû±šg_ıos
;

526 
	myylš’o_r
;

527 
	myy_æex_debug_r
;

529 *
	myy‹xt_r
;

530 
	myy_mÜe_æag
;

531 
	myy_mÜe_Ën
;

533 
YYSTYPE
 * 
	myylv®_r
;

535 
YYLTYPE
 * 
	myyÎoc_r
;

539 
yy_š™_glob®s
 (
yysÿn_t
 
yysÿÂ”
 );

543 
	#yylv®
 
yyg
->
yylv®_r


	)

545 
	#yyÎoc
 
yyg
->
yyÎoc_r


	)

547 
pkoc_Ëx_š™
 (
yysÿn_t
* 
sÿÂ”
);

549 
pkoc_Ëx_š™_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
,
yysÿn_t
* 
sÿÂ”
);

554 
pkoc_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
 );

556 
pkoc_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
 );

558 
pkoc_£t_debug
 (
debug_æag
 ,
yysÿn_t
 
yysÿÂ”
 );

560 
YY_EXTRA_TYPE
 
pkoc_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
 );

562 
pkoc_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 ,
yysÿn_t
 
yysÿÂ”
 );

564 
FILE
 *
pkoc_g‘_š
 (
yysÿn_t
 
yysÿÂ”
 );

566 
pkoc_£t_š
 (
FILE
 * 
š_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

568 
FILE
 *
pkoc_g‘_out
 (
yysÿn_t
 
yysÿÂ”
 );

570 
pkoc_£t_out
 (
FILE
 * 
out_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

572 
yy_size_t
 
pkoc_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
 );

574 *
pkoc_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
 );

576 
pkoc_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
 );

578 
pkoc_£t_lš’o
 (
lše_numb”
 ,
yysÿn_t
 
yysÿÂ”
 );

580 
pkoc_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
 );

582 
pkoc_£t_cŞumn
 (
cŞumn_no
 ,
yysÿn_t
 
yysÿÂ”
 );

584 
YYSTYPE
 * 
pkoc_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
 );

586 
pkoc_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

588 
YYLTYPE
 *
pkoc_g‘_Îoc
 (
yysÿn_t
 
yysÿÂ”
 );

590 
pkoc_£t_Îoc
 (
YYLTYPE
 * 
yyÎoc_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

596 #iâdeà
YY_SKIP_YYWRAP


597 #ifdeà
__ılu¥lus


598 "C" 
pkoc_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

600 
pkoc_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

604 #iâdeà
yy‹xt_±r


605 
yy_æex_¡ºıy
 (*,
yycÚ¡
 *,,
yysÿn_t
 
yysÿÂ”
);

608 #ifdeà
YY_NEED_STRLEN


609 
yy_æex_¡¾’
 (
yycÚ¡
 * ,
yysÿn_t
 
yysÿÂ”
);

612 #iâdeà
YY_NO_INPUT


614 #ifdeà
__ılu¥lus


615 
yyšput
 (
yysÿn_t
 
yysÿÂ”
 );

617 
šput
 (
yysÿn_t
 
yysÿÂ”
 );

623 #iâdeà
YY_READ_BUF_SIZE


624 #ifdeà
__Ÿ64__


626 
	#YY_READ_BUF_SIZE
 16384

	)

628 
	#YY_READ_BUF_SIZE
 8192

	)

633 #iâdeà
ECHO


637 
	#ECHO
 dØ{ ià(
	`fwr™e
Ğ
yy‹xt
, 
yyËng
, 1, 
yyout
 )è{} } 0)

	)

643 #iâdeà
YY_INPUT


644 
	#YY_INPUT
(
buf
,
»suÉ
,
max_size
) \

645 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_is_š‹¿ùive
 ) \

647 
c
 = '*'; \

648 
size_t
 
n
; \

649  
n
 = 0;‚ < 
max_size
 && \

650 (
c
 = 
	`g‘c
Ğ
yyš
 )è!ğ
EOF
 && c !ğ'\n'; ++
n
 ) \

651 
buf
[
n
] = (è
c
; \

652 iàĞ
c
 == '\n' ) \

653 
buf
[
n
++] = (è
c
; \

654 iàĞ
c
 =ğ
EOF
 && 
	`ã¼Ü
Ğ
yyš
 ) ) \

655 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

656 
»suÉ
 = 
n
; \

660 
”ºo
=0; \

661  (
»suÉ
 = 
	`ä—d
(
buf
, 1, 
max_size
, 
yyš
))==0 && 
	`ã¼Ü
(yyin)) \

663 ifĞ
”ºo
 !ğ
EINTR
) \

665 
	`YY_FATAL_ERROR
( "input in flex scanner failed" ); \

668 
”ºo
=0; \

669 
	`ş—»¼
(
yyš
); \

673 

	)

680 #iâdeà
yy‹rmš©e


681 
	#yy‹rmš©e
(è 
YY_NULL


	)

685 #iâdeà
YY_START_STACK_INCR


686 
	#YY_START_STACK_INCR
 25

	)

690 #iâdeà
YY_FATAL_ERROR


691 
	#YY_FATAL_ERROR
(
msg
è
	`yy_çl_”rÜ
Ğmsg , 
yysÿÂ”
)

	)

699 #iâdeà
YY_DECL


700 
	#YY_DECL_IS_OURS
 1

	)

702 
pkoc_Ëx
 \

703 (
YYSTYPE
 * 
yylv®_·¿m
,
YYLTYPE
 * 
yyÎoc_·¿m
 ,
yysÿn_t
 
yysÿÂ”
);

705 
	#YY_DECL
 
pkoc_Ëx
 \

706 (
YYSTYPE
 * 
yylv®_·¿m
, 
YYLTYPE
 * 
yyÎoc_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

	)

712 #iâdeà
YY_USER_ACTION


713 
	#YY_USER_ACTION


	)

717 #iâdeà
YY_BREAK


718 
	#YY_BREAK
 ;

	)

721 
	#YY_RULE_SETUP
 \

722 
YY_USER_ACTION


	)

726 
	gYY_DECL


728 
yy_¡©e_ty³
 
	gyy_cu¼’t_¡©e
;

729 *
	gyy_ı
, *
	gyy_bp
;

730 
	gyy_aù
;

731 
yyguts_t
 * 
	gyyg
 = (yyguts_t*)
yysÿÂ”
;

733 
	gyylv®
 = 
yylv®_·¿m
;

735 
	gyyÎoc
 = 
yyÎoc_·¿m
;

737 iàĞ!
	gyyg
->
	gyy_š™
 )

739 
	gyyg
->
	gyy_š™
 = 1;

741 #ifdeà
YY_USER_INIT


742 
	gYY_USER_INIT
;

745 iàĞ! 
	gyyg
->
	gyy_¡¬t
 )

746 
	gyyg
->
	gyy_¡¬t
 = 1;

748 iàĞ! 
	gyyš
 )

749 
	gyyš
 = 
¡dš
;

751 iàĞ! 
	gyyout
 )

752 
	gyyout
 = 
¡dout
;

754 iàĞ! 
	gYY_CURRENT_BUFFER
 ) {

755 
pkoc_’su»_bufãr_¡ack
 (
yysÿÂ”
);

756 
	gYY_CURRENT_BUFFER_LVALUE
 =

757 
pkoc__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
);

760 
pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

771 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

774 *
	gyy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

779 
	gyy_bp
 = 
yy_ı
;

781 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_¡¬t
;

782 
	gyy_m©ch
:

785 
YY_CHAR
 
yy_c
 = 
yy_ec
[
YY_SC_TO_UI
(*
yy_ı
)] ;

786 iàĞ
	gyy_acû±
[
yy_cu¼’t_¡©e
] )

788 
	gyyg
->
	gyy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

789 
	gyyg
->
	gyy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

791  
	gyy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
	gyy_c
] != yy_current_state )

793 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

794 iàĞ
	gyy_cu¼’t_¡©e
 >= 47 )

795 
yy_c
 = 
yy_m‘a
[() yy_c];

797 
	gyy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[
yy_cu¼’t_¡©e
] + (è
yy_c
];

798 ++
	gyy_ı
;

800  
	gyy_ba£
[
yy_cu¼’t_¡©e
] != 87 );

802 
	gyy_fšd_aùiÚ
:

803 
yy_aù
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

804 iàĞ
	gyy_aù
 == 0 )

806 
yy_ı
 = 
yyg
->
yy_Ï¡_acû±šg_ıos
;

807 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_Ï¡_acû±šg_¡©e
;

808 
	gyy_aù
 = 
yy_acû±
[
yy_cu¼’t_¡©e
];

811 
	gYY_DO_BEFORE_ACTION
;

813 
	gdo_aùiÚ
:

815  
yy_aù
 )

819 *
yy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

820 
	gyy_ı
 = 
yyg
->
yy_Ï¡_acû±šg_ıos
;

821 
	gyy_cu¼’t_¡©e
 = 
yyg
->
yy_Ï¡_acû±šg_¡©e
;

822 
	gyy_fšd_aùiÚ
;

826 
YY_RULE_SETUP


829 
YY_BREAK


831 
YY_RULE_SETUP


834 
YY_BREAK


838 
YY_RULE_SETUP


841 
yylv®
->
i
 = 
¡¹oul
(
yy‹xt
, 
NULL
, 0);

842  
	gNUMBER
;

844 
YY_BREAK


846 
YY_RULE_SETUP


848 {  
yylv®
->
i
 = 
yy‹xt
[0]; }

849 
YY_BREAK


851 
YY_RULE_SETUP


853 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U8
;  
	gALIGN
; }

854 
YY_BREAK


856 
YY_RULE_SETUP


858 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U16
;  
	gALIGN
; }

859 
YY_BREAK


861 
YY_RULE_SETUP


863 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U32
;  
	gALIGN
; }

864 
YY_BREAK


868 
YY_RULE_SETUP


870 { 
yylv®
->
i
 = 
TCF_LAYER_LINK
;  
	gLAYER
; }

871 
YY_BREAK


875 
YY_RULE_SETUP


877 { 
yylv®
->
i
 = 
TCF_LAYER_NETWORK
;  
	gLAYER
; }

878 
YY_BREAK


882 
YY_RULE_SETUP


884 { 
yylv®
->
i
 = 
TCF_LAYER_TRANSPORT
;  
	gLAYER
; }

885 
YY_BREAK


887 
YY_RULE_SETUP


890 
yylv®
->
s
 = 
¡rdup
(
yy‹xt
);

891 ià(
	gyylv®
->
	gs
 =ğ
NULL
)

892  
ERROR
;

893  
	gNAME
;

895 
YY_BREAK


897 
YY_RULE_SETUP


899 
ECHO
;

900 
	gYY_BREAK


902 
YY_STATE_EOF
(
INITIAL
):

903 
yy‹rmš©e
();

905 
	gYY_END_OF_BUFFER
:

908 
yy_amouÁ_of_m©ched_‹xt
 = (è(
yy_ı
 - 
yyg
->
yy‹xt_±r
) - 1;

911 *
	gyy_ı
 = 
yyg
->
yy_hŞd_ch¬
;

912 
YY_RESTORE_YY_MORE_OFFSET


914 iàĞ
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_bufãr_¡©us
 =ğ
YY_BUFFER_NEW
 )

925 
yyg
->
yy_n_ch¬s
 = 
YY_CURRENT_BUFFER_LVALUE
->yy_n_chars;

926 
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_šput_fe
 = 
yyš
;

927 
	gYY_CURRENT_BUFFER_LVALUE
->
	gyy_bufãr_¡©us
 = 
YY_BUFFER_NORMAL
;

937 iàĞ
	gyyg
->
	gyy_c_buf_p
 <ğ&
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
] )

939 
yy_¡©e_ty³
 
yy_Ãxt_¡©e
;

941 
	gyyg
->
	gyy_c_buf_p
 = 
yyg
->
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

943 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

954 
	gyy_Ãxt_¡©e
 = 
yy_Œy_NUL_Œªs
Ğ
yy_cu¼’t_¡©e
 , 
yysÿÂ”
);

956 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

958 iàĞ
	gyy_Ãxt_¡©e
 )

961 
	gyy_ı
 = ++
yyg
->
yy_c_buf_p
;

962 
	gyy_cu¼’t_¡©e
 = 
yy_Ãxt_¡©e
;

963 
	gyy_m©ch
;

968 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

969 
	gyy_fšd_aùiÚ
;

973  
yy_g‘_Ãxt_bufãr
Ğ
yysÿÂ”
 ) )

975 
	gEOB_ACT_END_OF_FILE
:

977 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 0;

979 iàĞ
pkoc_w¿p
(
yysÿÂ”
 ) )

990 
	gyyg
->
	gyy_c_buf_p
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

992 
	gyy_aù
 = 
YY_STATE_EOF
(
YY_START
);

993 
	gdo_aùiÚ
;

998 iàĞ! 
	gyyg
->
	gyy_did_bufãr_sw™ch_Ú_eof
 )

999 
	gYY_NEW_FILE
;

1004 
	gEOB_ACT_CONTINUE_SCAN
:

1005 
yyg
->
yy_c_buf_p
 =

1006 
yyg
->
yy‹xt_±r
 + 
yy_amouÁ_of_m©ched_‹xt
;

1008 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

1010 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1011 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1012 
	gyy_m©ch
;

1014 
	gEOB_ACT_LAST_MATCH
:

1015 
yyg
->
yy_c_buf_p
 =

1016 &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
];

1018 
	gyy_cu¼’t_¡©e
 = 
yy_g‘_´evious_¡©e
Ğ
yysÿÂ”
 );

1020 
	gyy_ı
 = 
yyg
->
yy_c_buf_p
;

1021 
	gyy_bp
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
;

1022 
	gyy_fšd_aùiÚ
;

1028 
YY_FATAL_ERROR
(

1042 
	$yy_g‘_Ãxt_bufãr
 (
yysÿn_t
 
yysÿÂ”
)

1044 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1045 *
de¡
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
;

1046 *
sourû
 = 
yyg
->
yy‹xt_±r
;

1047 
numb”_to_move
, 
i
;

1048 
»t_v®
;

1050 iàĞ
yyg
->
yy_c_buf_p
 > &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[yyg->
yy_n_ch¬s
 + 1] )

1051 
	`YY_FATAL_ERROR
(

1054 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_fl_bufãr
 == 0 )

1056 iàĞ
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
 - 
YY_MORE_ADJ
 == 1 )

1061  
EOB_ACT_END_OF_FILE
;

1069  
EOB_ACT_LAST_MATCH
;

1076 
numb”_to_move
 = (è(
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
) - 1;

1078  
i
 = 0; i < 
numb”_to_move
; ++i )

1079 *(
de¡
++èğ*(
sourû
++);

1081 iàĞ
YY_CURRENT_BUFFER_LVALUE
->
yy_bufãr_¡©us
 =ğ
YY_BUFFER_EOF_PENDING
 )

1085 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars = 0;

1089 
yy_size_t
 
num_to_»ad
 =

1090 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
 - 
numb”_to_move
 - 1;

1092  
num_to_»ad
 <= 0 )

1096 
YY_BUFFER_STATE
 
b
 = 
YY_CURRENT_BUFFER_LVALUE
;

1098 
yy_c_buf_p_off£t
 =

1099 (è(
yyg
->
yy_c_buf_p
 - 
b
->
yy_ch_buf
);

1101 iàĞ
b
->
yy_is_our_bufãr
 )

1103 
yy_size_t
 
Ãw_size
 = 
b
->
yy_buf_size
 * 2;

1105 iàĞ
Ãw_size
 <= 0 )

1106 
b
->
yy_buf_size
 += b->yy_buf_size / 8;

1108 
b
->
yy_buf_size
 *= 2;

1110 
b
->
yy_ch_buf
 = (*)

1112 
	`pkoc_»®loc
((*è
b
->
yy_ch_buf
,b->
yy_buf_size
 + 2 ,
yysÿÂ”
 );

1116 
b
->
yy_ch_buf
 = 0;

1118 iàĞ! 
b
->
yy_ch_buf
 )

1119 
	`YY_FATAL_ERROR
(

1122 
yyg
->
yy_c_buf_p
 = &
b
->
yy_ch_buf
[
yy_c_buf_p_off£t
];

1124 
num_to_»ad
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
 -

1125 
numb”_to_move
 - 1;

1129 iàĞ
num_to_»ad
 > 
YY_READ_BUF_SIZE
 )

1130 
num_to_»ad
 = 
YY_READ_BUF_SIZE
;

1133 
	`YY_INPUT
Ğ(&
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
numb”_to_move
]),

1134 
yyg
->
yy_n_ch¬s
, 
num_to_»ad
 );

1136 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

1139 iàĞ
yyg
->
yy_n_ch¬s
 == 0 )

1141 iàĞ
numb”_to_move
 =ğ
YY_MORE_ADJ
 )

1143 
»t_v®
 = 
EOB_ACT_END_OF_FILE
;

1144 
	`pkoc_»¡¬t
(
yyš
 ,
yysÿÂ”
);

1149 
»t_v®
 = 
EOB_ACT_LAST_MATCH
;

1150 
YY_CURRENT_BUFFER_LVALUE
->
yy_bufãr_¡©us
 =

1151 
YY_BUFFER_EOF_PENDING
;

1156 
»t_v®
 = 
EOB_ACT_CONTINUE_SCAN
;

1158 ià((
yy_size_t
è(
yyg
->
yy_n_ch¬s
 + 
numb”_to_move
è> 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_size
) {

1160 
yy_size_t
 
Ãw_size
 = 
yyg
->
yy_n_ch¬s
 + 
numb”_to_move
 + (yyg->yy_n_chars >> 1);

1161 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
 = (*è
	`pkoc_»®loc
((*èYY_CURRENT_BUFFER_LVALUE->yy_ch_buf,
Ãw_size
 ,
yysÿÂ”
 );

1162 iàĞ! 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
 )

1163 
	`YY_FATAL_ERROR
( "out of dynamic memory in yy_get_next_buffer()" );

1166 
yyg
->
yy_n_ch¬s
 +ğ
numb”_to_move
;

1167 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
] = 
YY_END_OF_BUFFER_CHAR
;

1168 
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[
yyg
->
yy_n_ch¬s
 + 1] = 
YY_END_OF_BUFFER_CHAR
;

1170 
yyg
->
yy‹xt_±r
 = &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[0];

1172  
»t_v®
;

1173 
	}
}

1177 
yy_¡©e_ty³
 
	$yy_g‘_´evious_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

1179 
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
;

1180 *
yy_ı
;

1181 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1183 
yy_cu¼’t_¡©e
 = 
yyg
->
yy_¡¬t
;

1185  
yy_ı
 = 
yyg
->
yy‹xt_±r
 + 
YY_MORE_ADJ
; yy_ı < yyg->
yy_c_buf_p
; ++yy_cp )

1187 
YY_CHAR
 
yy_c
 = (*
yy_ı
 ? 
yy_ec
[
	`YY_SC_TO_UI
(*yy_cp)] : 1);

1188 iàĞ
yy_acû±
[
yy_cu¼’t_¡©e
] )

1190 
yyg
->
yy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

1191 
yyg
->
yy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

1193  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1195 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1196 iàĞ
yy_cu¼’t_¡©e
 >= 47 )

1197 
yy_c
 = 
yy_m‘a
[() yy_c];

1199 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1202  
yy_cu¼’t_¡©e
;

1203 
	}
}

1210 
yy_¡©e_ty³
 
	$yy_Œy_NUL_Œªs
 (
yy_¡©e_ty³
 
yy_cu¼’t_¡©e
 , 
yysÿn_t
 
yysÿÂ”
)

1212 
yy_is_jam
;

1213 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1214 *
yy_ı
 = 
yyg
->
yy_c_buf_p
;

1216 
YY_CHAR
 
yy_c
 = 1;

1217 iàĞ
yy_acû±
[
yy_cu¼’t_¡©e
] )

1219 
yyg
->
yy_Ï¡_acû±šg_¡©e
 = 
yy_cu¼’t_¡©e
;

1220 
yyg
->
yy_Ï¡_acû±šg_ıos
 = 
yy_ı
;

1222  
yy_chk
[
yy_ba£
[
yy_cu¼’t_¡©e
] + 
yy_c
] != yy_current_state )

1224 
yy_cu¼’t_¡©e
 = (è
yy_def
[yy_current_state];

1225 iàĞ
yy_cu¼’t_¡©e
 >= 47 )

1226 
yy_c
 = 
yy_m‘a
[() yy_c];

1228 
yy_cu¼’t_¡©e
 = 
yy_nxt
[
yy_ba£
[yy_cu¼’t_¡©e] + (è
yy_c
];

1229 
yy_is_jam
 = (
yy_cu¼’t_¡©e
 == 46);

1231 ()
yyg
;

1232  
yy_is_jam
 ? 0 : 
yy_cu¼’t_¡©e
;

1233 
	}
}

1235 #iâdeà
YY_NO_INPUT


1236 #ifdeà
__ılu¥lus


1237 
	$yyšput
 (
yysÿn_t
 
yysÿÂ”
)

1239 
	$šput
 (
yysÿn_t
 
yysÿÂ”
)

1243 
c
;

1244 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1246 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

1248 iàĞ*
yyg
->
yy_c_buf_p
 =ğ
YY_END_OF_BUFFER_CHAR
 )

1254 iàĞ
yyg
->
yy_c_buf_p
 < &
YY_CURRENT_BUFFER_LVALUE
->
yy_ch_buf
[yyg->
yy_n_ch¬s
] )

1256 *
yyg
->
yy_c_buf_p
 = '\0';

1260 
yy_size_t
 
off£t
 = 
yyg
->
yy_c_buf_p
 - yyg->
yy‹xt_±r
;

1261 ++
yyg
->
yy_c_buf_p
;

1263  
	`yy_g‘_Ãxt_bufãr
Ğ
yysÿÂ”
 ) )

1265 
EOB_ACT_LAST_MATCH
:

1277 
	`pkoc_»¡¬t
(
yyš
 ,
yysÿÂ”
);

1281 
EOB_ACT_END_OF_FILE
:

1283 iàĞ
	`pkoc_w¿p
(
yysÿÂ”
 ) )

1284  
EOF
;

1286 iàĞ! 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 )

1287 
YY_NEW_FILE
;

1288 #ifdeà
__ılu¥lus


1289  
	`yyšput
(
yysÿÂ”
);

1291  
	`šput
(
yysÿÂ”
);

1295 
EOB_ACT_CONTINUE_SCAN
:

1296 
yyg
->
yy_c_buf_p
 = yyg->
yy‹xt_±r
 + 
off£t
;

1302 
c
 = *(*è
yyg
->
yy_c_buf_p
;

1303 *
yyg
->
yy_c_buf_p
 = '\0';

1304 
yyg
->
yy_hŞd_ch¬
 = *++yyg->
yy_c_buf_p
;

1306  
c
;

1307 
	}
}

1315 
	$pkoc_»¡¬t
 (
FILE
 * 
šput_fe
 , 
yysÿn_t
 
yysÿÂ”
)

1317 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1319 iàĞ! 
YY_CURRENT_BUFFER
 ){

1320 
	`pkoc_’su»_bufãr_¡ack
 (
yysÿÂ”
);

1321 
YY_CURRENT_BUFFER_LVALUE
 =

1322 
	`pkoc__ü—‹_bufãr
(
yyš
,
YY_BUF_SIZE
 ,
yysÿÂ”
);

1325 
	`pkoc__š™_bufãr
(
YY_CURRENT_BUFFER
,
šput_fe
 ,
yysÿÂ”
);

1326 
	`pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1327 
	}
}

1333 
	$pkoc__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 , 
yysÿn_t
 
yysÿÂ”
)

1335 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1342 
	`pkoc_’su»_bufãr_¡ack
 (
yysÿÂ”
);

1343 iàĞ
YY_CURRENT_BUFFER
 =ğ
Ãw_bufãr
 )

1346 iàĞ
YY_CURRENT_BUFFER
 )

1349 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

1350 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
 = 
yyg
->
yy_c_buf_p
;

1351 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

1354 
YY_CURRENT_BUFFER_LVALUE
 = 
Ãw_bufãr
;

1355 
	`pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1362 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

1363 
	}
}

1365 
	$pkoc__lßd_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

1367 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1368 
yyg
->
yy_n_ch¬s
 = 
YY_CURRENT_BUFFER_LVALUE
->yy_n_chars;

1369 
yyg
->
yy‹xt_±r
 = yyg->
yy_c_buf_p
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
;

1370 
yyš
 = 
YY_CURRENT_BUFFER_LVALUE
->
yy_šput_fe
;

1371 
yyg
->
yy_hŞd_ch¬
 = *yyg->
yy_c_buf_p
;

1372 
	}
}

1380 
YY_BUFFER_STATE
 
	$pkoc__ü—‹_bufãr
 (
FILE
 * 
fe
, 
size
 , 
yysÿn_t
 
yysÿÂ”
)

1382 
YY_BUFFER_STATE
 
b
;

1384 
b
 = (
YY_BUFFER_STATE
è
	`pkoc_®loc
(Ğ
yy_bufãr_¡©e
 ) ,
yysÿÂ”
 );

1385 iàĞ! 
b
 )

1386 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc__create_buffer()" );

1388 
b
->
yy_buf_size
 = 
size
;

1393 
b
->
yy_ch_buf
 = (*è
	`pkoc_®loc
(b->
yy_buf_size
 + 2 ,
yysÿÂ”
 );

1394 iàĞ! 
b
->
yy_ch_buf
 )

1395 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc__create_buffer()" );

1397 
b
->
yy_is_our_bufãr
 = 1;

1399 
	`pkoc__š™_bufãr
(
b
,
fe
 ,
yysÿÂ”
);

1401  
b
;

1402 
	}
}

1408 
	$pkoc__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 , 
yysÿn_t
 
yysÿÂ”
)

1410 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1412 iàĞ! 
b
 )

1415 iàĞ
b
 =ğ
YY_CURRENT_BUFFER
 )

1416 
YY_CURRENT_BUFFER_LVALUE
 = (
YY_BUFFER_STATE
) 0;

1418 iàĞ
b
->
yy_is_our_bufãr
 )

1419 
	`pkoc_ä“
((*è
b
->
yy_ch_buf
 ,
yysÿÂ”
 );

1421 
	`pkoc_ä“
((*è
b
 ,
yysÿÂ”
 );

1422 
	}
}

1428 
	$pkoc__š™_bufãr
 (
YY_BUFFER_STATE
 
b
, 
FILE
 * 
fe
 , 
yysÿn_t
 
yysÿÂ”
)

1431 
Û¼no
 = 
”ºo
;

1432 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1434 
	`pkoc__æush_bufãr
(
b
 ,
yysÿÂ”
);

1436 
b
->
yy_šput_fe
 = 
fe
;

1437 
b
->
yy_fl_bufãr
 = 1;

1443 ià(
b
 !ğ
YY_CURRENT_BUFFER
){

1444 
b
->
yy_bs_lš’o
 = 1;

1445 
b
->
yy_bs_cŞumn
 = 0;

1448 
b
->
yy_is_š‹¿ùive
 = 
fe
 ? (
	`i§‰y
Ğ
	`f’o
(file) ) > 0) : 0;

1450 
”ºo
 = 
Û¼no
;

1451 
	}
}

1457 
	$pkoc__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 , 
yysÿn_t
 
yysÿÂ”
)

1459 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1460 iàĞ! 
b
 )

1463 
b
->
yy_n_ch¬s
 = 0;

1469 
b
->
yy_ch_buf
[0] = 
YY_END_OF_BUFFER_CHAR
;

1470 
b
->
yy_ch_buf
[1] = 
YY_END_OF_BUFFER_CHAR
;

1472 
b
->
yy_buf_pos
 = &b->
yy_ch_buf
[0];

1474 
b
->
yy_©_bŞ
 = 1;

1475 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

1477 iàĞ
b
 =ğ
YY_CURRENT_BUFFER
 )

1478 
	`pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1479 
	}
}

1487 
	$pkoc_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 , 
yysÿn_t
 
yysÿÂ”
)

1489 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1490 ià(
Ãw_bufãr
 =ğ
NULL
)

1493 
	`pkoc_’su»_bufãr_¡ack
(
yysÿÂ”
);

1496 iàĞ
YY_CURRENT_BUFFER
 )

1499 *
yyg
->
yy_c_buf_p
 = yyg->
yy_hŞd_ch¬
;

1500 
YY_CURRENT_BUFFER_LVALUE
->
yy_buf_pos
 = 
yyg
->
yy_c_buf_p
;

1501 
YY_CURRENT_BUFFER_LVALUE
->
yy_n_ch¬s
 = 
yyg
->yy_n_chars;

1505 ià(
YY_CURRENT_BUFFER
)

1506 
yyg
->
yy_bufãr_¡ack_tİ
++;

1507 
YY_CURRENT_BUFFER_LVALUE
 = 
Ãw_bufãr
;

1510 
	`pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1511 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

1512 
	}
}

1518 
	$pkoc_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
)

1520 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1521 ià(!
YY_CURRENT_BUFFER
)

1524 
	`pkoc__d–‘e_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
);

1525 
YY_CURRENT_BUFFER_LVALUE
 = 
NULL
;

1526 ià(
yyg
->
yy_bufãr_¡ack_tİ
 > 0)

1527 --
yyg
->
yy_bufãr_¡ack_tİ
;

1529 ià(
YY_CURRENT_BUFFER
) {

1530 
	`pkoc__lßd_bufãr_¡©e
(
yysÿÂ”
 );

1531 
yyg
->
yy_did_bufãr_sw™ch_Ú_eof
 = 1;

1533 
	}
}

1538 
	$pkoc_’su»_bufãr_¡ack
 (
yysÿn_t
 
yysÿÂ”
)

1540 
yy_size_t
 
num_to_®loc
;

1541 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1543 ià(!
yyg
->
yy_bufãr_¡ack
) {

1549 
num_to_®loc
 = 1;

1550 
yyg
->
yy_bufãr_¡ack
 = (
yy_bufãr_¡©e
**)
pkoc_®loc


1551 (
num_to_®loc
 * (
yy_bufãr_¡©e
*)

1552 , 
yysÿÂ”
);

1553 iàĞ! 
yyg
->
yy_bufãr_¡ack
 )

1554 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc_ensure_buffer_stack()" );

1556 
	`mem£t
(
yyg
->
yy_bufãr_¡ack
, 0, 
num_to_®loc
 * (
yy_bufãr_¡©e
*));

1558 
yyg
->
yy_bufãr_¡ack_max
 = 
num_to_®loc
;

1559 
yyg
->
yy_bufãr_¡ack_tİ
 = 0;

1563 ià(
yyg
->
yy_bufãr_¡ack_tİ
 >ğ(yyg->
yy_bufãr_¡ack_max
) - 1){

1566 
grow_size
 = 8 ;

1568 
num_to_®loc
 = 
yyg
->
yy_bufãr_¡ack_max
 + 
grow_size
;

1569 
yyg
->
yy_bufãr_¡ack
 = (
yy_bufãr_¡©e
**)
pkoc_»®loc


1570 (
yyg
->
yy_bufãr_¡ack
,

1571 
num_to_®loc
 * (
yy_bufãr_¡©e
*)

1572 , 
yysÿÂ”
);

1573 iàĞ! 
yyg
->
yy_bufãr_¡ack
 )

1574 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc_ensure_buffer_stack()" );

1577 
	`mem£t
(
yyg
->
yy_bufãr_¡ack
 + yyg->
yy_bufãr_¡ack_max
, 0, 
grow_size
 * (
yy_bufãr_¡©e
*));

1578 
yyg
->
yy_bufãr_¡ack_max
 = 
num_to_®loc
;

1580 
	}
}

1588 
YY_BUFFER_STATE
 
	$pkoc__sÿn_bufãr
 (* 
ba£
, 
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

1590 
YY_BUFFER_STATE
 
b
;

1592 iàĞ
size
 < 2 ||

1593 
ba£
[
size
-2] !ğ
YY_END_OF_BUFFER_CHAR
 ||

1594 
ba£
[
size
-1] !ğ
YY_END_OF_BUFFER_CHAR
 )

1598 
b
 = (
YY_BUFFER_STATE
è
	`pkoc_®loc
(Ğ
yy_bufãr_¡©e
 ) ,
yysÿÂ”
 );

1599 iàĞ! 
b
 )

1600 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc__scan_buffer()" );

1602 
b
->
yy_buf_size
 = 
size
 - 2;

1603 
b
->
yy_buf_pos
 = b->
yy_ch_buf
 = 
ba£
;

1604 
b
->
yy_is_our_bufãr
 = 0;

1605 
b
->
yy_šput_fe
 = 0;

1606 
b
->
yy_n_ch¬s
 = b->
yy_buf_size
;

1607 
b
->
yy_is_š‹¿ùive
 = 0;

1608 
b
->
yy_©_bŞ
 = 1;

1609 
b
->
yy_fl_bufãr
 = 0;

1610 
b
->
yy_bufãr_¡©us
 = 
YY_BUFFER_NEW
;

1612 
	`pkoc__sw™ch_to_bufãr
(
b
 ,
yysÿÂ”
 );

1614  
b
;

1615 
	}
}

1625 
YY_BUFFER_STATE
 
	$pkoc__sÿn_¡ršg
 (
yycÚ¡
 * 
yy¡r
 , 
yysÿn_t
 
yysÿÂ”
)

1628  
	`pkoc__sÿn_by‹s
(
yy¡r
,
	`¡¾’
(yy¡rè,
yysÿÂ”
);

1629 
	}
}

1638 
YY_BUFFER_STATE
 
	$pkoc__sÿn_by‹s
 (
yycÚ¡
 * 
yyby‹s
, 
yy_size_t
 
_yyby‹s_Ën
 , 
yysÿn_t
 
yysÿÂ”
)

1640 
YY_BUFFER_STATE
 
b
;

1641 *
buf
;

1642 
yy_size_t
 
n
;

1643 
yy_size_t
 
i
;

1646 
n
 = 
_yyby‹s_Ën
 + 2;

1647 
buf
 = (*è
	`pkoc_®loc
(
n
 ,
yysÿÂ”
 );

1648 iàĞ! 
buf
 )

1649 
	`YY_FATAL_ERROR
( "out of dynamic memory in…ktloc__scan_bytes()" );

1651  
i
 = 0; i < 
_yyby‹s_Ën
; ++i )

1652 
buf
[
i
] = 
yyby‹s
[i];

1654 
buf
[
_yyby‹s_Ën
] = buf[_yyby‹s_Ën+1] = 
YY_END_OF_BUFFER_CHAR
;

1656 
b
 = 
	`pkoc__sÿn_bufãr
(
buf
,
n
 ,
yysÿÂ”
);

1657 iàĞ! 
b
 )

1658 
	`YY_FATAL_ERROR
( "bad buffer in…ktloc__scan_bytes()" );

1663 
b
->
yy_is_our_bufãr
 = 1;

1665  
b
;

1666 
	}
}

1668 #iâdeà
YY_EXIT_FAILURE


1669 
	#YY_EXIT_FAILURE
 2

	)

1672 
	$yy_çl_”rÜ
 (
yycÚ¡
 * 
msg
 , 
yysÿn_t
 
yysÿÂ”
)

1674 (è
	`årštf
Ğ
¡d”r
, "%s\n", 
msg
 );

1675 
	`ex™
Ğ
YY_EXIT_FAILURE
 );

1676 
	}
}

1680 #undeà
yyËss


1681 
	#yyËss
(
n
) \

1685 
yyËss_maüo_¬g
 = (
n
); \

1686 
	`YY_LESS_LINENO
(
yyËss_maüo_¬g
);\

1687 
yy‹xt
[
yyËng
] = 
yyg
->
yy_hŞd_ch¬
; \

1688 
yyg
->
yy_c_buf_p
 = 
yy‹xt
 + 
yyËss_maüo_¬g
; \

1689 
yyg
->
yy_hŞd_ch¬
 = *yyg->
yy_c_buf_p
; \

1690 *
yyg
->
yy_c_buf_p
 = '\0'; \

1691 
yyËng
 = 
yyËss_maüo_¬g
; \

1693  0 )

	)

1700 
YY_EXTRA_TYPE
 
	$pkoc_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
)

1702 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1703  
yyexŒa
;

1704 
	}
}

1709 
	$pkoc_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
)

1711 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1713 ià(! 
YY_CURRENT_BUFFER
)

1716  
yylš’o
;

1717 
	}
}

1722 
	$pkoc_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
)

1724 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1726 ià(! 
YY_CURRENT_BUFFER
)

1729  
yycŞumn
;

1730 
	}
}

1735 
FILE
 *
	$pkoc_g‘_š
 (
yysÿn_t
 
yysÿÂ”
)

1737 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1738  
yyš
;

1739 
	}
}

1744 
FILE
 *
	$pkoc_g‘_out
 (
yysÿn_t
 
yysÿÂ”
)

1746 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1747  
yyout
;

1748 
	}
}

1753 
yy_size_t
 
	$pkoc_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
)

1755 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1756  
yyËng
;

1757 
	}
}

1763 *
	$pkoc_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
)

1765 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1766  
yy‹xt
;

1767 
	}
}

1773 
	$pkoc_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 , 
yysÿn_t
 
yysÿÂ”
)

1775 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1776 
yyexŒa
 = 
u£r_defšed
 ;

1777 
	}
}

1783 
	$pkoc_£t_lš’o
 (
lše_numb”
 , 
yysÿn_t
 
yysÿÂ”
)

1785 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1788 ià(! 
YY_CURRENT_BUFFER
 )

1789 
	`YY_FATAL_ERROR
( "pktloc_set_lineno called with‚o buffer" );

1791 
yylš’o
 = 
lše_numb”
;

1792 
	}
}

1798 
	$pkoc_£t_cŞumn
 (
cŞumn_no
 , 
yysÿn_t
 
yysÿÂ”
)

1800 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1803 ià(! 
YY_CURRENT_BUFFER
 )

1804 
	`YY_FATAL_ERROR
( "pktloc_set_column called with‚o buffer" );

1806 
yycŞumn
 = 
cŞumn_no
;

1807 
	}
}

1815 
	$pkoc_£t_š
 (
FILE
 * 
š_¡r
 , 
yysÿn_t
 
yysÿÂ”
)

1817 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1818 
yyš
 = 
š_¡r
 ;

1819 
	}
}

1821 
	$pkoc_£t_out
 (
FILE
 * 
out_¡r
 , 
yysÿn_t
 
yysÿÂ”
)

1823 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1824 
yyout
 = 
out_¡r
 ;

1825 
	}
}

1827 
	$pkoc_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
)

1829 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1830  
yy_æex_debug
;

1831 
	}
}

1833 
	$pkoc_£t_debug
 (
bdebug
 , 
yysÿn_t
 
yysÿÂ”
)

1835 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1836 
yy_æex_debug
 = 
bdebug
 ;

1837 
	}
}

1841 
YYSTYPE
 * 
	$pkoc_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
)

1843 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1844  
yylv®
;

1845 
	}
}

1847 
	$pkoc_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

1849 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1850 
yylv®
 = 
yylv®_·¿m
;

1851 
	}
}

1853 
YYLTYPE
 *
	$pkoc_g‘_Îoc
 (
yysÿn_t
 
yysÿÂ”
)

1855 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1856  
yyÎoc
;

1857 
	}
}

1859 
	$pkoc_£t_Îoc
 (
YYLTYPE
 * 
yyÎoc_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

1861 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1862 
yyÎoc
 = 
yyÎoc_·¿m
;

1863 
	}
}

1872 
	$pkoc_Ëx_š™
(
yysÿn_t
* 
±r_yy_glob®s
)

1875 ià(
±r_yy_glob®s
 =ğ
NULL
){

1876 
”ºo
 = 
EINVAL
;

1880 *
±r_yy_glob®s
 = (
yysÿn_t
è
	`pkoc_®loc
 ( Ğ
yyguts_t
 ), 
NULL
 );

1882 ià(*
±r_yy_glob®s
 =ğ
NULL
){

1883 
”ºo
 = 
ENOMEM
;

1888 
	`mem£t
(*
±r_yy_glob®s
,0x00,(
yyguts_t
));

1890  
	`yy_š™_glob®s
 ( *
±r_yy_glob®s
 );

1891 
	}
}

1901 
	$pkoc_Ëx_š™_exŒa
(
YY_EXTRA_TYPE
 
yy_u£r_defšed
,
yysÿn_t
* 
±r_yy_glob®s
 )

1904 
yyguts_t
 
dummy_yyguts
;

1906 
	`pkoc_£t_exŒa
 (
yy_u£r_defšed
, &
dummy_yyguts
);

1908 ià(
±r_yy_glob®s
 =ğ
NULL
){

1909 
”ºo
 = 
EINVAL
;

1913 *
±r_yy_glob®s
 = (
yysÿn_t
è
	`pkoc_®loc
 ( Ğ
yyguts_t
 ), &
dummy_yyguts
 );

1915 ià(*
±r_yy_glob®s
 =ğ
NULL
){

1916 
”ºo
 = 
ENOMEM
;

1922 
	`mem£t
(*
±r_yy_glob®s
,0x00,(
yyguts_t
));

1924 
	`pkoc_£t_exŒa
 (
yy_u£r_defšed
, *
±r_yy_glob®s
);

1926  
	`yy_š™_glob®s
 ( *
±r_yy_glob®s
 );

1927 
	}
}

1929 
	$yy_š™_glob®s
 (
yysÿn_t
 
yysÿÂ”
)

1931 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1936 
yyg
->
yy_bufãr_¡ack
 = 0;

1937 
yyg
->
yy_bufãr_¡ack_tİ
 = 0;

1938 
yyg
->
yy_bufãr_¡ack_max
 = 0;

1939 
yyg
->
yy_c_buf_p
 = (*) 0;

1940 
yyg
->
yy_š™
 = 0;

1941 
yyg
->
yy_¡¬t
 = 0;

1943 
yyg
->
yy_¡¬t_¡ack_±r
 = 0;

1944 
yyg
->
yy_¡¬t_¡ack_d•th
 = 0;

1945 
yyg
->
yy_¡¬t_¡ack
 = 
NULL
;

1948 #ifdeà
YY_STDINIT


1949 
yyš
 = 
¡dš
;

1950 
yyout
 = 
¡dout
;

1952 
yyš
 = (
FILE
 *) 0;

1953 
yyout
 = (
FILE
 *) 0;

1960 
	}
}

1963 
	$pkoc_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
)

1965 
yyguts_t
 * 
yyg
 = (yyguts_t*)
yysÿÂ”
;

1968 
YY_CURRENT_BUFFER
){

1969 
	`pkoc__d–‘e_bufãr
(
YY_CURRENT_BUFFER
 ,
yysÿÂ”
 );

1970 
YY_CURRENT_BUFFER_LVALUE
 = 
NULL
;

1971 
	`pkoc_pİ_bufãr_¡©e
(
yysÿÂ”
);

1975 
	`pkoc_ä“
(
yyg
->
yy_bufãr_¡ack
 ,
yysÿÂ”
);

1976 
yyg
->
yy_bufãr_¡ack
 = 
NULL
;

1979 
	`pkoc_ä“
(
yyg
->
yy_¡¬t_¡ack
 ,
yysÿÂ”
 );

1980 
yyg
->
yy_¡¬t_¡ack
 = 
NULL
;

1984 
	`yy_š™_glob®s
Ğ
yysÿÂ”
);

1987 
	`pkoc_ä“
 ( 
yysÿÂ”
 , yyscanner );

1988 
yysÿÂ”
 = 
NULL
;

1990 
	}
}

1996 #iâdeà
yy‹xt_±r


1997 
	$yy_æex_¡ºıy
 (* 
s1
, 
yycÚ¡
 * 
s2
, 
n
 , 
yysÿn_t
 
yysÿÂ”
)

1999 
i
;

2000  
i
 = 0; i < 
n
; ++i )

2001 
s1
[
i
] = 
s2
[i];

2002 
	}
}

2005 #ifdeà
YY_NEED_STRLEN


2006 
	$yy_æex_¡¾’
 (
yycÚ¡
 * 
s
 , 
yysÿn_t
 
yysÿÂ”
)

2008 
n
;

2009  
n
 = 0; 
s
[n]; ++n )

2012  
n
;

2013 
	}
}

2016 *
	$pkoc_®loc
 (
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

2018  (*è
	`m®loc
Ğ
size
 );

2019 
	}
}

2021 *
	$pkoc_»®loc
 (* 
±r
, 
yy_size_t
 
size
 , 
yysÿn_t
 
yysÿÂ”
)

2030  (*è
	`»®loc
Ğ(*è
±r
, 
size
 );

2031 
	}
}

2033 
	$pkoc_ä“
 (* 
±r
 , 
yysÿn_t
 
yysÿÂ”
)

2035 
	`ä“
Ğ(*è
±r
 );

2036 
	}
}

2038 
	#YYTABLES_NAME
 "yybËs"

	)

	@mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.h

1 #iâdeà
pkoc_HEADER_H


2 
	#pkoc_HEADER_H
 1

	)

3 
	#pkoc_IN_HEADER
 1

	)

9 
	#YY_INT_ALIGNED
 

	)

13 
	#FLEX_SCANNER


	)

14 
	#YY_FLEX_MAJOR_VERSION
 2

	)

15 
	#YY_FLEX_MINOR_VERSION
 5

	)

16 
	#YY_FLEX_SUBMINOR_VERSION
 39

	)

17 #ià
YY_FLEX_SUBMINOR_VERSION
 > 0

18 
	#FLEX_BETA


	)

24 
	~<¡dio.h
>

25 
	~<¡ršg.h
>

26 
	~<”ºo.h
>

27 
	~<¡dlib.h
>

33 #iâdeà
FLEXINT_H


34 
	#FLEXINT_H


	)

38 #ià
defšed
 (
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

43 #iâdeà
__STDC_LIMIT_MACROS


44 
	#__STDC_LIMIT_MACROS
 1

	)

47 
	~<š‰y³s.h
>

48 
št8_t
 
	tæex_št8_t
;

49 
ušt8_t
 
	tæex_ušt8_t
;

50 
št16_t
 
	tæex_št16_t
;

51 
ušt16_t
 
	tæex_ušt16_t
;

52 
št32_t
 
	tæex_št32_t
;

53 
ušt32_t
 
	tæex_ušt32_t
;

55 sigÃd 
	tæex_št8_t
;

56 
	tæex_št16_t
;

57 
	tæex_št32_t
;

58 
	tæex_ušt8_t
;

59 
	tæex_ušt16_t
;

60 
	tæex_ušt32_t
;

63 #iâdeà
INT8_MIN


64 
	#INT8_MIN
 (-128)

	)

66 #iâdeà
INT16_MIN


67 
	#INT16_MIN
 (-32767-1)

	)

69 #iâdeà
INT32_MIN


70 
	#INT32_MIN
 (-2147483647-1)

	)

72 #iâdeà
INT8_MAX


73 
	#INT8_MAX
 (127)

	)

75 #iâdeà
INT16_MAX


76 
	#INT16_MAX
 (32767)

	)

78 #iâdeà
INT32_MAX


79 
	#INT32_MAX
 (2147483647)

	)

81 #iâdeà
UINT8_MAX


82 
	#UINT8_MAX
 (255U)

	)

84 #iâdeà
UINT16_MAX


85 
	#UINT16_MAX
 (65535U)

	)

87 #iâdeà
UINT32_MAX


88 
	#UINT32_MAX
 (4294967295U)

	)

95 #ifdeà
__ılu¥lus


98 
	#YY_USE_CONST


	)

103 #ià
defšed
 (
__STDC__
)

105 
	#YY_USE_CONST


	)

110 #ifdeà
YY_USE_CONST


111 
	#yycÚ¡
 cÚ¡

	)

113 
	#yycÚ¡


	)

117 #iâdeà
YY_TYPEDEF_YY_SCANNER_T


118 
	#YY_TYPEDEF_YY_SCANNER_T


	)

119 * 
	tyysÿn_t
;

124 
	#yyš
 
yyg
->
yyš_r


	)

125 
	#yyout
 
yyg
->
yyout_r


	)

126 
	#yyexŒa
 
yyg
->
yyexŒa_r


	)

127 
	#yyËng
 
yyg
->
yyËng_r


	)

128 
	#yy‹xt
 
yyg
->
yy‹xt_r


	)

129 
	#yylš’o
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_lš’o
)

	)

130 
	#yycŞumn
 (
YY_CURRENT_BUFFER_LVALUE
->
yy_bs_cŞumn
)

	)

131 
	#yy_æex_debug
 
yyg
->
yy_æex_debug_r


	)

134 #iâdeà
YY_BUF_SIZE


135 #ifdeà
__Ÿ64__


140 
	#YY_BUF_SIZE
 32768

	)

142 
	#YY_BUF_SIZE
 16384

	)

146 #iâdeà
YY_TYPEDEF_YY_BUFFER_STATE


147 
	#YY_TYPEDEF_YY_BUFFER_STATE


	)

148 
yy_bufãr_¡©e
 *
	tYY_BUFFER_STATE
;

151 #iâdeà
YY_TYPEDEF_YY_SIZE_T


152 
	#YY_TYPEDEF_YY_SIZE_T


	)

153 
size_t
 
	tyy_size_t
;

156 #iâdeà
YY_STRUCT_YY_BUFFER_STATE


157 
	#YY_STRUCT_YY_BUFFER_STATE


	)

158 
	syy_bufãr_¡©e


160 
FILE
 *
	myy_šput_fe
;

162 *
	myy_ch_buf
;

163 *
	myy_buf_pos
;

168 
yy_size_t
 
	myy_buf_size
;

173 
yy_size_t
 
	myy_n_ch¬s
;

179 
	myy_is_our_bufãr
;

186 
	myy_is_š‹¿ùive
;

192 
	myy_©_bŞ
;

194 
	myy_bs_lš’o
;

195 
	myy_bs_cŞumn
;

200 
	myy_fl_bufãr
;

202 
	myy_bufãr_¡©us
;

207 
pkoc_»¡¬t
 (
FILE
 *
šput_fe
 ,
yysÿn_t
 
yysÿÂ”
 );

208 
pkoc__sw™ch_to_bufãr
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

209 
YY_BUFFER_STATE
 
pkoc__ü—‹_bufãr
 (
FILE
 *
fe
,
size
 ,
yysÿn_t
 
yysÿÂ”
 );

210 
pkoc__d–‘e_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

211 
pkoc__æush_bufãr
 (
YY_BUFFER_STATE
 
b
 ,
yysÿn_t
 
yysÿÂ”
 );

212 
pkoc_push_bufãr_¡©e
 (
YY_BUFFER_STATE
 
Ãw_bufãr
 ,
yysÿn_t
 
yysÿÂ”
 );

213 
pkoc_pİ_bufãr_¡©e
 (
yysÿn_t
 
yysÿÂ”
 );

215 
YY_BUFFER_STATE
 
pkoc__sÿn_bufãr
 (*
ba£
,
yy_size_t
 
size
 ,
yysÿn_t
 
yysÿÂ”
 );

216 
YY_BUFFER_STATE
 
pkoc__sÿn_¡ršg
 (
yycÚ¡
 *
yy_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

217 
YY_BUFFER_STATE
 
pkoc__sÿn_by‹s
 (
yycÚ¡
 *
by‹s
,
yy_size_t
 
Ën
 ,
yysÿn_t
 
yysÿÂ”
 );

219 *
pkoc_®loc
 (
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

220 *
pkoc_»®loc
 (*,
yy_size_t
 ,
yysÿn_t
 
yysÿÂ”
 );

221 
pkoc_ä“
 (* ,
yysÿn_t
 
yysÿÂ”
 );

223 
	#pkoc_w¿p
(
yysÿÂ”
è1

	)

224 
	#YY_SKIP_YYWRAP


	)

226 
	#yy‹xt_±r
 
yy‹xt_r


	)

228 #ifdeà
YY_HEADER_EXPORT_START_CONDITIONS


229 
	#INITIAL
 0

	)

233 #iâdeà
YY_NO_UNISTD_H


238 
	~<uni¡d.h
>

241 #iâdeà
YY_EXTRA_TYPE


242 
	#YY_EXTRA_TYPE
 *

	)

245 
pkoc_Ëx_š™
 (
yysÿn_t
* 
sÿÂ”
);

247 
pkoc_Ëx_š™_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
,
yysÿn_t
* 
sÿÂ”
);

252 
pkoc_Ëx_de¡roy
 (
yysÿn_t
 
yysÿÂ”
 );

254 
pkoc_g‘_debug
 (
yysÿn_t
 
yysÿÂ”
 );

256 
pkoc_£t_debug
 (
debug_æag
 ,
yysÿn_t
 
yysÿÂ”
 );

258 
YY_EXTRA_TYPE
 
pkoc_g‘_exŒa
 (
yysÿn_t
 
yysÿÂ”
 );

260 
pkoc_£t_exŒa
 (
YY_EXTRA_TYPE
 
u£r_defšed
 ,
yysÿn_t
 
yysÿÂ”
 );

262 
FILE
 *
pkoc_g‘_š
 (
yysÿn_t
 
yysÿÂ”
 );

264 
pkoc_£t_š
 (
FILE
 * 
š_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

266 
FILE
 *
pkoc_g‘_out
 (
yysÿn_t
 
yysÿÂ”
 );

268 
pkoc_£t_out
 (
FILE
 * 
out_¡r
 ,
yysÿn_t
 
yysÿÂ”
 );

270 
yy_size_t
 
pkoc_g‘_Ëng
 (
yysÿn_t
 
yysÿÂ”
 );

272 *
pkoc_g‘_‹xt
 (
yysÿn_t
 
yysÿÂ”
 );

274 
pkoc_g‘_lš’o
 (
yysÿn_t
 
yysÿÂ”
 );

276 
pkoc_£t_lš’o
 (
lše_numb”
 ,
yysÿn_t
 
yysÿÂ”
 );

278 
pkoc_g‘_cŞumn
 (
yysÿn_t
 
yysÿÂ”
 );

280 
pkoc_£t_cŞumn
 (
cŞumn_no
 ,
yysÿn_t
 
yysÿÂ”
 );

282 
YYSTYPE
 * 
pkoc_g‘_lv®
 (
yysÿn_t
 
yysÿÂ”
 );

284 
pkoc_£t_lv®
 (
YYSTYPE
 * 
yylv®_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

286 
YYLTYPE
 *
pkoc_g‘_Îoc
 (
yysÿn_t
 
yysÿÂ”
 );

288 
pkoc_£t_Îoc
 (
YYLTYPE
 * 
yyÎoc_·¿m
 ,
yysÿn_t
 
yysÿÂ”
 );

294 #iâdeà
YY_SKIP_YYWRAP


295 #ifdeà
__ılu¥lus


296 "C" 
pkoc_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

298 
pkoc_w¿p
 (
yysÿn_t
 
yysÿÂ”
 );

302 #iâdeà
yy‹xt_±r


303 
yy_æex_¡ºıy
 (*,
yycÚ¡
 *,,
yysÿn_t
 
yysÿÂ”
);

306 #ifdeà
YY_NEED_STRLEN


307 
yy_æex_¡¾’
 (
yycÚ¡
 * ,
yysÿn_t
 
yysÿÂ”
);

310 #iâdeà
YY_NO_INPUT


315 #iâdeà
YY_READ_BUF_SIZE


316 #ifdeà
__Ÿ64__


318 
	#YY_READ_BUF_SIZE
 16384

	)

320 
	#YY_READ_BUF_SIZE
 8192

	)

325 #iâdeà
YY_START_STACK_INCR


326 
	#YY_START_STACK_INCR
 25

	)

332 #iâdeà
YY_DECL


333 
	#YY_DECL_IS_OURS
 1

	)

335 
pkoc_Ëx
 \

336 (
YYSTYPE
 * 
yylv®_·¿m
,
YYLTYPE
 * 
yyÎoc_·¿m
 ,
yysÿn_t
 
yysÿÂ”
);

338 
	#YY_DECL
 
pkoc_Ëx
 \

339 (
YYSTYPE
 * 
yylv®_·¿m
, 
YYLTYPE
 * 
yyÎoc_·¿m
 , 
yysÿn_t
 
yysÿÂ”
)

	)

344 #undeà
YY_NEW_FILE


345 #undeà
YY_FLUSH_BUFFER


346 #undeà
yy_£t_bŞ


347 #undeà
yy_Ãw_bufãr


348 #undeà
yy_£t_š‹¿ùive


349 #undeà
YY_DO_BEFORE_ACTION


351 #ifdeà
YY_DECL_IS_OURS


352 #undeà
YY_DECL_IS_OURS


353 #undeà
YY_DECL


359 #undeà
pkoc_IN_HEADER


	@mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.l

2 
	~<Ãšk-´iv©e/Ãšk.h
>

3 
	~<Ãšk-´iv©e/tc.h
>

4 
	~<Ãšk/Ãšk.h
>

5 
	~<Ãšk/uts.h
>

6 
	~<Ãšk/rou‹/pkoc.h
>

7 
	~"pkoc_syÁax.h
"

10 %
İtiÚ
 8b
™


11 %
İtiÚ
 
»’Œªt


12 %
İtiÚ
 
w¬n


13 %
İtiÚ
 
noyyw¿p


14 %
İtiÚ
 
nošput


15 %
İtiÚ
 
nouÅut


16 %
İtiÚ
 
bisÚ
-
bridge


17 %
İtiÚ
 
bisÚ
-
loÿtiÚs


18 %
İtiÚ
 
´efix
="pktloc_"

20 %% /* 
	$yyËx
 */

22 [ \
t
\
r
\
n
]+

26 [[:
dig™
:]]+ |

27 0[
xX
][[:
xdig™
:]]+ {

28 
yylv®
->
i
 = 
	`¡¹oul
(
yy‹xt
, 
NULL
, 0);

29  
NUMBER
;

32 "+" {  
yylv®
->
i
 = 
yy‹xt
[0]; }

34 [
uU
]8 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U8
;  
ALIGN
; }

35 [
uU
]16 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U16
;  
ALIGN
; }

36 [
uU
]32 { 
yylv®
->
i
 = 
TCF_EM_ALIGN_U32
;  
ALIGN
; }

38 [
lL
][
iI
][
nN
][
kK
] |

39 [
eE
][
tT
][
hH
] { 
yylv®
->
i
 = 
TCF_LAYER_LINK
;  
LAYER
; }

40 [
nN
][
eE
][
tT
] |

41 [
iI
][
pP
] { 
yylv®
->
i
 = 
TCF_LAYER_NETWORK
;  
LAYER
; }

42 [
tT
][
rR
][
aA
][
nN
][
sS
][
pP
][
oO
][rR][tT] |

43 [
tT
][
cC
][
pP
] { 
yylv®
->
i
 = 
TCF_LAYER_TRANSPORT
;  
LAYER
; }

46 [^ \
t
\
r
\
n
+]+ {

47 
yylv®
->
s
 = 
	`¡rdup
(
yy‹xt
);

48 ià(
yylv®
->
s
 =ğ
NULL
)

49  
ERROR
;

50  
NAME
;

	@mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.c

44 
	#YYBISON
 1

	)

47 
	#YYBISON_VERSION
 "3.0.2"

	)

50 
	#YYSKELETON_NAME
 "yacc.c"

	)

53 
	#YYPURE
 1

	)

56 
	#YYPUSH
 0

	)

59 
	#YYPULL
 1

	)

63 
	#yy·r£
 
pkoc_·r£


	)

64 
	#yyËx
 
pkoc_Ëx


	)

65 
	#yy”rÜ
 
pkoc_”rÜ


	)

66 
	#yydebug
 
pkoc_debug


	)

67 
	#yyÃ¼s
 
pkoc_Ã¼s


	)

73 
	~<Ãšk-´iv©e/Ãšk.h
>

74 
	~<Ãšk-´iv©e/tc.h
>

75 
	~<Ãšk/Ãšk.h
>

76 
	~<Ãšk/uts.h
>

77 
	~<Ãšk/rou‹/pkoc.h
>

81 #iâdeà
YY_NULLPTR


82 #ià
defšed
 
__ılu¥lus
 && 201103L <= __cplusplus

83 
	#YY_NULLPTR
 
nuÎ±r


	)

85 
	#YY_NULLPTR
 0

	)

90 #ifdeà
YYERROR_VERBOSE


91 #undeà
YYERROR_VERBOSE


92 
	#YYERROR_VERBOSE
 1

	)

94 
	#YYERROR_VERBOSE
 1

	)

99 #iâdeà
YY_PKTLOC_ROUTE_PKTLOC_SYNTAX_H_INCLUDED


100 
	#YY_PKTLOC_ROUTE_PKTLOC_SYNTAX_H_INCLUDED


	)

102 #iâdeà
YYDEBUG


103 
	#YYDEBUG
 0

	)

105 #ià
YYDEBUG


106 
pkoc_debug
;

110 #iâdeà
YYTOKENTYPE


111 
	#YYTOKENTYPE


	)

112 
	eyytok’ty³


114 
	mERROR
 = 258,

115 
	mNUMBER
 = 259,

116 
	mLAYER
 = 260,

117 
	mALIGN
 = 261,

118 
	mNAME
 = 262

122 
	#ERROR
 258

	)

123 
	#NUMBER
 259

	)

124 
	#LAYER
 260

	)

125 
	#ALIGN
 261

	)

126 
	#NAME
 262

	)

129 #ià! 
defšed
 
YYSTYPE
 && ! defšed 
YYSTYPE_IS_DECLARED


130 
YYSTYPE
 
	tYYSTYPE
;

131 
	uYYSTYPE


135 
¹Æ_pkoc
 *
	ml
;

136 
ušt32_t
 
	mi
;

137 *
	ms
;

141 
	#YYSTYPE_IS_TRIVIAL
 1

	)

142 
	#YYSTYPE_IS_DECLARED
 1

	)

146 #ià! 
defšed
 
YYLTYPE
 && ! defšed 
YYLTYPE_IS_DECLARED


147 
YYLTYPE
 
	tYYLTYPE
;

148 
	sYYLTYPE


150 
	mfœ¡_lše
;

151 
	mfœ¡_cŞumn
;

152 
	mÏ¡_lše
;

153 
	mÏ¡_cŞumn
;

155 
	#YYLTYPE_IS_DECLARED
 1

	)

156 
	#YYLTYPE_IS_TRIVIAL
 1

	)

161 
pkoc_·r£
 (*
sÿÂ”
);

168 
pkoc_Ëx
(
YYSTYPE
 *, 
YYLTYPE
 *, *);

170 
	$yy”rÜ
(
YYLTYPE
 *
loı
, *
sÿÂ”
, cÚ¡ *
msg
)

172 
	`NL_DBG
(1, "E¼Ü wh·rsšg…ack‘†oÿtiÚ fe: %s\n", 
msg
);

173 
	}
}

181 #ifdeà
YYTYPE_UINT8


182 
YYTYPE_UINT8
 
	tyyty³_ušt8
;

184 
	tyyty³_ušt8
;

187 #ifdeà
YYTYPE_INT8


188 
YYTYPE_INT8
 
	tyyty³_št8
;

190 sigÃd 
	tyyty³_št8
;

193 #ifdeà
YYTYPE_UINT16


194 
YYTYPE_UINT16
 
	tyyty³_ušt16
;

196 
	tyyty³_ušt16
;

199 #ifdeà
YYTYPE_INT16


200 
YYTYPE_INT16
 
	tyyty³_št16
;

202 
	tyyty³_št16
;

205 #iâdeà
YYSIZE_T


206 #ifdeà
__SIZE_TYPE__


207 
	#YYSIZE_T
 
__SIZE_TYPE__


	)

208 #–ià
defšed
 
size_t


209 
	#YYSIZE_T
 
size_t


	)

210 #–ià! 
defšed
 
YYSIZE_T


211 
	~<¡ddef.h
>

212 
	#YYSIZE_T
 
size_t


	)

214 
	#YYSIZE_T
 

	)

218 
	#YYSIZE_MAXIMUM
 ((
YYSIZE_T
è-1)

	)

220 #iâdeà
YY_


221 #ià
defšed
 
YYENABLE_NLS
 && YYENABLE_NLS

222 #ià
ENABLE_NLS


223 
	~<libš.h
>

224 
	#YY_
(
Msgid
è
	`dg‘‹xt
 ("bisÚ-ruÁime", Msgid)

	)

227 #iâdeà
YY_


228 
	#YY_
(
Msgid
è
	)
Msgid

232 #iâdeà
YY_ATTRIBUTE


233 #ià(
defšed
 
__GNUC__
 \

234 && (2 < 
	g__GNUC__
 || (__GNUC__ =ğ2 && 96 <ğ
__GNUC_MINOR__
))) \

235 || 
defšed
 
__SUNPRO_C
 && 0x5110 <= __SUNPRO_C

236 
	#YY_ATTRIBUTE
(
S³c
è
	`__©Œibu‹__
(S³c)

	)

238 
	#YY_ATTRIBUTE
(
S³c
è

	)

242 #iâdeà
YY_ATTRIBUTE_PURE


243 
	#YY_ATTRIBUTE_PURE
 
	`YY_ATTRIBUTE
 ((
__pu»__
))

	)

246 #iâdeà
YY_ATTRIBUTE_UNUSED


247 
	#YY_ATTRIBUTE_UNUSED
 
	`YY_ATTRIBUTE
 ((
__unu£d__
))

	)

250 #ià!
defšed
 
_NÜ‘uº
 \

251 && (!
defšed
 
__STDC_VERSION__
 || __STDC_VERSION__ < 201112)

252 #ià
defšed
 
_MSC_VER
 && 1200 <= _MSC_VER

253 
	#_NÜ‘uº
 
	`__deş¥ec
 (
nÜ‘uº
)

	)

255 
	#_NÜ‘uº
 
	`YY_ATTRIBUTE
 ((
__nÜ‘uº__
))

	)

260 #ià! 
defšed
 
lšt
 || defšed 
__GNUC__


261 
	#YYUSE
(
E
è((è(E))

	)

263 
	#YYUSE
(
E
è

	)

266 #ià
defšed
 
__GNUC__
 && 407 <ğ__GNUC__ * 100 + 
__GNUC_MINOR__


268 
	#YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN
 \

269 
	`_P¿gma
 ("GCC diagnostic…ush") \

270 
	`_P¿gma
 ("GCC diagnostic ignored \"-Wuninitialized\"")\

271 
	`_P¿gma
 ("GCC dŸgno¡iøignÜed \"-Wmaybe-unš™Ÿlized\"")

	)

272 
	#YY_IGNORE_MAYBE_UNINITIALIZED_END
 \

273 
	`_P¿gma
 ("GCC dŸgno¡iøpİ")

	)

275 
	#YY_INITIAL_VALUE
(
V®ue
è
	)
V®ue

277 #iâdeà
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


278 
	#YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


	)

279 
	#YY_IGNORE_MAYBE_UNINITIALIZED_END


	)

281 #iâdeà
YY_INITIAL_VALUE


282 
	#YY_INITIAL_VALUE
(
V®ue
è

	)

286 #ià! 
defšed
 
yyov”æow
 || 
YYERROR_VERBOSE


290 #ifdeà
YYSTACK_USE_ALLOCA


291 #ià
YYSTACK_USE_ALLOCA


292 #ifdeà
__GNUC__


293 
	#YYSTACK_ALLOC
 
__butš_®loÿ


	)

294 #–ià
defšed
 
__BUILTIN_VA_ARG_INCR


295 
	~<®loÿ.h
>

296 #–ià
defšed
 
_AIX


297 
	#YYSTACK_ALLOC
 
__®loÿ


	)

298 #–ià
defšed
 
_MSC_VER


299 
	~<m®loc.h
>

300 
	#®loÿ
 
_®loÿ


	)

302 
	#YYSTACK_ALLOC
 
®loÿ


	)

303 #ià! 
defšed
 
_ALLOCA_H
 && ! defšed 
EXIT_SUCCESS


304 
	~<¡dlib.h
>

306 #iâdeà
EXIT_SUCCESS


307 
	#EXIT_SUCCESS
 0

	)

314 #ifdeà
YYSTACK_ALLOC


316 
	#YYSTACK_FREE
(
PŒ
èdØ{ ; } 0)

	)

317 #iâdeà
YYSTACK_ALLOC_MAXIMUM


322 
	#YYSTACK_ALLOC_MAXIMUM
 4032

	)

325 
	#YYSTACK_ALLOC
 
YYMALLOC


	)

326 
	#YYSTACK_FREE
 
YYFREE


	)

327 #iâdeà
YYSTACK_ALLOC_MAXIMUM


328 
	#YYSTACK_ALLOC_MAXIMUM
 
YYSIZE_MAXIMUM


	)

330 #ià(
defšed
 
__ılu¥lus
 && ! defšed 
EXIT_SUCCESS
 \

331 && ! ((
defšed
 
	gYYMALLOC
 || defšed 
	gm®loc
) \

332 && (
defšed
 
	gYYFREE
 || defšed 
	gä“
)))

333 
	~<¡dlib.h
>

334 #iâdeà
EXIT_SUCCESS


335 
	#EXIT_SUCCESS
 0

	)

338 #iâdeà
YYMALLOC


339 
	#YYMALLOC
 
m®loc


	)

340 #ià! 
defšed
 
m®loc
 && ! defšed 
EXIT_SUCCESS


341 *
m®loc
 (
YYSIZE_T
);

344 #iâdeà
YYFREE


345 
	#YYFREE
 
ä“


	)

346 #ià! 
defšed
 
ä“
 && ! defšed 
EXIT_SUCCESS


347 
ä“
 (*);

354 #ià(! 
defšed
 
yyov”æow
 \

355 && (! 
defšed
 
	g__ılu¥lus
 \

356 || (
defšed
 
	gYYLTYPE_IS_TRIVIAL
 && YYLTYPE_IS_TRIVIAL \

357 && 
defšed
 
	gYYSTYPE_IS_TRIVIAL
 && YYSTYPE_IS_TRIVIAL)))

360 
	uyy®loc


362 
yyty³_št16
 
	myyss_®loc
;

363 
YYSTYPE
 
	myyvs_®loc
;

364 
YYLTYPE
 
	myyls_®loc
;

368 
	#YYSTACK_GAP_MAXIMUM
 ( (
yy®loc
è- 1)

	)

372 
	#YYSTACK_BYTES
(
N
) \

373 ((
N
è* ( (
yyty³_št16
è+  (
YYSTYPE
è+  (
YYLTYPE
)) \

374 + 2 * 
YYSTACK_GAP_MAXIMUM
)

	)

376 
	#YYCOPY_NEEDED
 1

	)

383 
	#YYSTACK_RELOCATE
(
Sck_®loc
, 
Sck
) \

386 
YYSIZE_T
 
yyÃwby‹s
; \

387 
	`YYCOPY
 (&
yy±r
->
Sck_®loc
, 
Sck
, 
yysize
); \

388 
Sck
 = &
yy±r
->
Sck_®loc
; \

389 
yyÃwby‹s
 = 
yy¡acksize
 *  (*
Sck
è+ 
YYSTACK_GAP_MAXIMUM
; \

390 
yy±r
 +ğ
yyÃwby‹s
 /  (*yyptr); \

392 0)

	)

396 #ià
defšed
 
YYCOPY_NEEDED
 && YYCOPY_NEEDED

399 #iâdeà
YYCOPY


400 #ià
defšed
 
__GNUC__
 && 1 < __GNUC__

401 
	#YYCOPY
(
D¡
, 
Src
, 
CouÁ
) \

402 
	`__butš_memıy
 (
D¡
, 
Src
, (
CouÁ
è*  (*(Src)))

	)

404 
	#YYCOPY
(
D¡
, 
Src
, 
CouÁ
) \

407 
YYSIZE_T
 
yyi
; \

408 
yyi
 = 0; yy˜< (
CouÁ
); yyi++) \

409 (
D¡
)[
yyi
] = (
Src
)[yyi]; \

411 0)

	)

417 
	#YYFINAL
 7

	)

419 
	#YYLAST
 10

	)

422 
	#YYNTOKENS
 9

	)

424 
	#YYNNTS
 7

	)

426 
	#YYNRULES
 12

	)

428 
	#YYNSTATES
 17

	)

432 
	#YYUNDEFTOK
 2

	)

433 
	#YYMAXUTOK
 262

	)

435 
	#YYTRANSLATE
(
YYX
) \

436 ((è(
YYX
è<ğ
YYMAXUTOK
 ? 
yyŒª¦©e
[YYX] : 
YYUNDEFTOK
)

	)

440 cÚ¡ 
yyty³_ušt8
 
	gyyŒª¦©e
[] =

471 #ià
YYDEBUG


473 cÚ¡ 
yyty³_ušt8
 
	gyy¾še
[] =

480 #ià
YYDEBUG
 || 
YYERROR_VERBOSE
 || 1

483 cÚ¡ *cÚ¡ 
	gyyŠame
[] =

487 "shiá", 
YY_NULLPTR


491 #ifdeà
YYPRINT


494 cÚ¡ 
yyty³_ušt16
 
	gyytoknum
[] =

500 
	#YYPACT_NINF
 -7

	)

502 
	#yy·ù_v®ue_is_deçuÉ
(
Yy¡©e
) \

503 (!!((
Yy¡©e
è=ğ(-7)))

	)

505 
	#YYTABLE_NINF
 -1

	)

507 
	#yybË_v®ue_is_”rÜ
(
YybË_v®ue
) \

508 0

	)

512 cÚ¡ 
yyty³_št8
 
	gyy·ù
[] =

521 cÚ¡ 
yyty³_ušt8
 
	gyydeçù
[] =

528 cÚ¡ 
yyty³_št8
 
	gyypgÙo
[] =

534 cÚ¡ 
yyty³_št8
 
	gyydefgÙo
[] =

542 cÚ¡ 
yyty³_ušt8
 
	gyybË
[] =

548 cÚ¡ 
yyty³_št8
 
	gyycheck
[] =

556 cÚ¡ 
yyty³_ušt8
 
	gyy¡os
[] =

563 cÚ¡ 
yyty³_ušt8
 
	gyyr1
[] =

570 cÚ¡ 
yyty³_ušt8
 
	gyyr2
[] =

577 
	#yy”rok
 (
yy”r¡©us
 = 0)

	)

578 
	#yyş—rš
 (
yych¬
 = 
YYEMPTY
)

	)

579 
	#YYEMPTY
 (-2)

	)

580 
	#YYEOF
 0

	)

582 
	#YYACCEPT
 
yyacû±Ïb


	)

583 
	#YYABORT
 
yyabÜab


	)

584 
	#YYERROR
 
yy”rÜÏb


	)

587 
	#YYRECOVERING
(è(!!
yy”r¡©us
)

	)

589 
	#YYBACKUP
(
Tok’
, 
V®ue
) \

591 ià(
yych¬
 =ğ
YYEMPTY
) \

593 
yych¬
 = (
Tok’
); \

594 
yylv®
 = (
V®ue
); \

595 
	`YYPOPSTACK
 (
yyËn
); \

596 
yy¡©e
 = *
yys¥
; \

597 
yybackup
; \

601 
	`yy”rÜ
 (&
yyÎoc
, 
sÿÂ”
, 
	`YY_
("syntaxƒrror: cannot back up")); \

602 
YYERROR
; \

604 0)

	)

607 
	#YYTERROR
 1

	)

608 
	#YYERRCODE
 256

	)

615 #iâdeà
YYLLOC_DEFAULT


616 
	#YYLLOC_DEFAULT
(
Cu¼’t
, 
Rhs
, 
N
) \

618 ià(
N
) \

620 (
Cu¼’t
).
fœ¡_lše
 = 
	`YYRHSLOC
 (
Rhs
, 1).first_line; \

621 (
Cu¼’t
).
fœ¡_cŞumn
 = 
	`YYRHSLOC
 (
Rhs
, 1).first_column; \

622 (
Cu¼’t
).
Ï¡_lše
 = 
	`YYRHSLOC
 (
Rhs
, 
N
).last_line; \

623 (
Cu¼’t
).
Ï¡_cŞumn
 = 
	`YYRHSLOC
 (
Rhs
, 
N
).last_column; \

627 (
Cu¼’t
).
fœ¡_lše
 = (Cu¼’t).
Ï¡_lše
 = \

628 
	`YYRHSLOC
 (
Rhs
, 0).
Ï¡_lše
; \

629 (
Cu¼’t
).
fœ¡_cŞumn
 = (Cu¼’t).
Ï¡_cŞumn
 = \

630 
	`YYRHSLOC
 (
Rhs
, 0).
Ï¡_cŞumn
; \

632 0)

	)

635 
	#YYRHSLOC
(
Rhs
, 
K
è((Rhs)[K])

	)

639 #ià
YYDEBUG


641 #iâdeà
YYFPRINTF


642 
	~<¡dio.h
>

643 
	#YYFPRINTF
 
årštf


	)

646 
	#YYDPRINTF
(
Args
) \

648 ià(
yydebug
) \

649 
YYFPRINTF
 
Args
; \

650 } 0)

	)

657 #iâdeà
YY_LOCATION_PRINT


658 #ià
defšed
 
YYLTYPE_IS_TRIVIAL
 && YYLTYPE_IS_TRIVIAL

662 
YY_ATTRIBUTE_UNUSED


664 
	$yy_loÿtiÚ_´št_
 (
FILE
 *
yyo
, 
YYLTYPE
 cÚ¡ * cÚ¡ 
yyloı
)

666 
»s
 = 0;

667 
’d_cŞ
 = 0 !ğ
yyloı
->
Ï¡_cŞumn
 ? yylocp->last_column - 1 : 0;

668 ià(0 <ğ
yyloı
->
fœ¡_lše
)

670 
»s
 +ğ
	`YYFPRINTF
 (
yyo
, "%d", 
yyloı
->
fœ¡_lše
);

671 ià(0 <ğ
yyloı
->
fœ¡_cŞumn
)

672 
»s
 +ğ
	`YYFPRINTF
 (
yyo
, ".%d", 
yyloı
->
fœ¡_cŞumn
);

674 ià(0 <ğ
yyloı
->
Ï¡_lše
)

676 ià(
yyloı
->
fœ¡_lše
 < yyloı->
Ï¡_lše
)

678 
»s
 +ğ
	`YYFPRINTF
 (
yyo
, "-%d", 
yyloı
->
Ï¡_lše
);

679 ià(0 <ğ
’d_cŞ
)

680 
»s
 +ğ
	`YYFPRINTF
 (
yyo
, ".%d", 
’d_cŞ
);

682 ià(0 <ğ
’d_cŞ
 && 
yyloı
->
fœ¡_cŞumn
 <ƒnd_col)

683 
»s
 +ğ
	`YYFPRINTF
 (
yyo
, "-%d", 
’d_cŞ
);

685  
»s
;

686 
	}
}

688 
	#YY_LOCATION_PRINT
(
Fe
, 
Loc
) \

689 
	`yy_loÿtiÚ_´št_
 (
Fe
, &(
Loc
))

	)

692 
	#YY_LOCATION_PRINT
(
Fe
, 
Loc
è((è0)

	)

697 
	#YY_SYMBOL_PRINT
(
T™Ë
, 
Ty³
, 
V®ue
, 
LoÿtiÚ
) \

699 ià(
yydebug
) \

701 
	`YYFPRINTF
 (
¡d”r
, "% ", 
T™Ë
); \

702 
	`yy_symbŞ_´št
 (
¡d”r
, \

703 
Ty³
, 
V®ue
, 
LoÿtiÚ
, 
sÿÂ”
); \

704 
	`YYFPRINTF
 (
¡d”r
, "\n"); \

706 } 0)

	)

714 
	$yy_symbŞ_v®ue_´št
 (
FILE
 *
yyouut
, 
yyty³
, 
YYSTYPE
 cÚ¡ * cÚ¡ 
yyv®u•
, 
YYLTYPE
 cÚ¡ * cÚ¡ 
yyloÿtiÚp
, *
sÿÂ”
)

716 
FILE
 *
yyo
 = 
yyouut
;

717 
	`YYUSE
 (
yyo
);

718 
	`YYUSE
 (
yyloÿtiÚp
);

719 
	`YYUSE
 (
sÿÂ”
);

720 ià(!
yyv®u•
)

722 #ifdeà
YYPRINT


723 ià(
yyty³
 < 
YYNTOKENS
)

724 
	`YYPRINT
 (
yyouut
, 
yytoknum
[
yyty³
], *
yyv®u•
);

726 
	`YYUSE
 (
yyty³
);

727 
	}
}

735 
	$yy_symbŞ_´št
 (
FILE
 *
yyouut
, 
yyty³
, 
YYSTYPE
 cÚ¡ * cÚ¡ 
yyv®u•
, 
YYLTYPE
 cÚ¡ * cÚ¡ 
yyloÿtiÚp
, *
sÿÂ”
)

737 
	`YYFPRINTF
 (
yyouut
, "%s %s (",

738 
yyty³
 < 
YYNTOKENS
 ? "tok’" : "Á”m", 
yyŠame
[yytype]);

740 
	`YY_LOCATION_PRINT
 (
yyouut
, *
yyloÿtiÚp
);

741 
	`YYFPRINTF
 (
yyouut
, ": ");

742 
	`yy_symbŞ_v®ue_´št
 (
yyouut
, 
yyty³
, 
yyv®u•
, 
yyloÿtiÚp
, 
sÿÂ”
);

743 
	`YYFPRINTF
 (
yyouut
, ")");

744 
	}
}

752 
	$yy_¡ack_´št
 (
yyty³_št16
 *
yybÙtom
, yyty³_št16 *
yytİ
)

754 
	`YYFPRINTF
 (
¡d”r
, "Stack‚ow");

755 ; 
yybÙtom
 <ğ
yytİ
; yybottom++)

757 
yybÙ
 = *
yybÙtom
;

758 
	`YYFPRINTF
 (
¡d”r
, " %d", 
yybÙ
);

760 
	`YYFPRINTF
 (
¡d”r
, "\n");

761 
	}
}

763 
	#YY_STACK_PRINT
(
BÙtom
, 
Tİ
) \

765 ià(
yydebug
) \

766 
	`yy_¡ack_´št
 ((
BÙtom
), (
Tİ
)); \

767 } 0)

	)

775 
	$yy_»duû_´št
 (
yyty³_št16
 *
yys¥
, 
YYSTYPE
 *
yyv¥
, 
YYLTYPE
 *
yyl¥
, 
yyruË
, *
sÿÂ”
)

777 
yyÊo
 = 
yy¾še
[
yyruË
];

778 
yyÄhs
 = 
yyr2
[
yyruË
];

779 
yyi
;

780 
	`YYFPRINTF
 (
¡d”r
, "Reducing stack by„ule %d (line %lu):\n",

781 
yyruË
 - 1, 
yyÊo
);

783 
yyi
 = 0; yy˜< 
yyÄhs
; yyi++)

785 
	`YYFPRINTF
 (
¡d”r
, " $%d = ", 
yyi
 + 1);

786 
	`yy_symbŞ_´št
 (
¡d”r
,

787 
yy¡os
[
yys¥
[
yyi
 + 1 - 
yyÄhs
]],

788 &(
yyv¥
[(
yyi
 + 1è- (
yyÄhs
)])

789 , &(
yyl¥
[(
yyi
 + 1è- (
yyÄhs
)]è, 
sÿÂ”
);

790 
	`YYFPRINTF
 (
¡d”r
, "\n");

792 
	}
}

794 
	#YY_REDUCE_PRINT
(
RuË
) \

796 ià(
yydebug
) \

797 
	`yy_»duû_´št
 (
yys¥
, 
yyv¥
, 
yyl¥
, 
RuË
, 
sÿÂ”
); \

798 } 0)

	)

802 
	gyydebug
;

804 
	#YYDPRINTF
(
Args
)

	)

805 
	#YY_SYMBOL_PRINT
(
T™Ë
, 
Ty³
, 
V®ue
, 
LoÿtiÚ
)

	)

806 
	#YY_STACK_PRINT
(
BÙtom
, 
Tİ
)

	)

807 
	#YY_REDUCE_PRINT
(
RuË
)

	)

812 #iâdeà
YYINITDEPTH


813 
	#YYINITDEPTH
 200

	)

823 #iâdeà
YYMAXDEPTH


824 
	#YYMAXDEPTH
 10000

	)

828 #ià
YYERROR_VERBOSE


830 #iâdeà
yy¡¾’


831 #ià
defšed
 
__GLIBC__
 && defšed 
_STRING_H


832 
	#yy¡¾’
 
¡¾’


	)

835 
YYSIZE_T


836 
	$yy¡¾’
 (cÚ¡ *
yy¡r
)

838 
YYSIZE_T
 
yyËn
;

839 
yyËn
 = 0; 
yy¡r
[yylen]; yylen++)

841  
yyËn
;

842 
	}
}

846 #iâdeà
yy¡pıy


847 #ià
defšed
 
__GLIBC__
 && defšed 
_STRING_H
 && defšed 
_GNU_SOURCE


848 
	#yy¡pıy
 
¡pıy


	)

853 
	$yy¡pıy
 (*
yyde¡
, cÚ¡ *
yy¤c
)

855 *
yyd
 = 
yyde¡
;

856 cÚ¡ *
yys
 = 
yy¤c
;

858 (*
yyd
++ = *
yys
++) != '\0')

861  
yyd
 - 1;

862 
	}
}

866 #iâdeà
yyŠam”r


874 
YYSIZE_T


875 
	$yyŠam”r
 (*
yy»s
, cÚ¡ *
yy¡r
)

877 ià(*
yy¡r
 == '"')

879 
YYSIZE_T
 
yyn
 = 0;

880 cÚ¡ *
yyp
 = 
yy¡r
;

883 *++
yyp
)

887 
do_nÙ_¡r_quÙes
;

890 ià(*++
yyp
 != '\\')

891 
do_nÙ_¡r_quÙes
;

894 ià(
yy»s
)

895 
yy»s
[
yyn
] = *
yyp
;

896 
yyn
++;

900 ià(
yy»s
)

901 
yy»s
[
yyn
] = '\0';

902  
yyn
;

904 
do_nÙ_¡r_quÙes
: ;

907 ià(! 
yy»s
)

908  
	`yy¡¾’
 (
yy¡r
);

910  
	`yy¡pıy
 (
yy»s
, 
yy¡r
) - yyres;

911 
	}
}

923 
	$yysyÁax_”rÜ
 (
YYSIZE_T
 *
yymsg_®loc
, **
yymsg
,

924 
yyty³_št16
 *
yys¥
, 
yytok’
)

926 
YYSIZE_T
 
yysize0
 = 
	`yyŠam”r
 (
YY_NULLPTR
, 
yyŠame
[
yytok’
]);

927 
YYSIZE_T
 
yysize
 = 
yysize0
;

928 ’um { 
YYERROR_VERBOSE_ARGS_MAXIMUM
 = 5 };

930 cÚ¡ *
yyfÜm©
 = 
YY_NULLPTR
;

932 cÚ¡ *
yy¬g
[
YYERROR_VERBOSE_ARGS_MAXIMUM
];

935 
yycouÁ
 = 0;

960 ià(
yytok’
 !ğ
YYEMPTY
)

962 
yyn
 = 
yy·ù
[*
yys¥
];

963 
yy¬g
[
yycouÁ
++] = 
yyŠame
[
yytok’
];

964 ià(!
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

969 
yyxbegš
 = 
yyn
 < 0 ? -yyn : 0;

971 
yychecklim
 = 
YYLAST
 - 
yyn
 + 1;

972 
yyx’d
 = 
yychecklim
 < 
YYNTOKENS
 ? yychecklim : YYNTOKENS;

973 
yyx
;

975 
yyx
 = 
yyxbegš
; yyx < 
yyx’d
; ++yyx)

976 ià(
yycheck
[
yyx
 + 
yyn
] =ğyyx && yyx !ğ
YYTERROR


977 && !
	`yybË_v®ue_is_”rÜ
 (
yybË
[
yyx
 + 
yyn
]))

979 ià(
yycouÁ
 =ğ
YYERROR_VERBOSE_ARGS_MAXIMUM
)

981 
yycouÁ
 = 1;

982 
yysize
 = 
yysize0
;

985 
yy¬g
[
yycouÁ
++] = 
yyŠame
[
yyx
];

987 
YYSIZE_T
 
yysize1
 = 
yysize
 + 
	`yyŠam”r
 (
YY_NULLPTR
, 
yyŠame
[
yyx
]);

988 ià(! (
yysize
 <ğ
yysize1


989 && 
yysize1
 <ğ
YYSTACK_ALLOC_MAXIMUM
))

991 
yysize
 = 
yysize1
;

997 
yycouÁ
)

999 
	#YYCASE_
(
N
, 
S
) \

1000 
N
: \

1001 
yyfÜm©
 = 
S
; \

1002 

	)

1003 
	`YYCASE_
(0, 
	`YY_
("syntaxƒrror"));

1004 
	`YYCASE_
(1, 
	`YY_
("syntaxƒrror, unexpected %s"));

1005 
	`YYCASE_
(2, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s"));

1006 
	`YYCASE_
(3, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s"));

1007 
	`YYCASE_
(4, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s or %s"));

1008 
	`YYCASE_
(5, 
	`YY_
("syntaxƒrror, unexpected %s,ƒxpecting %s or %s or %s or %s"));

1009 #undeà
YYCASE_


1013 
YYSIZE_T
 
yysize1
 = 
yysize
 + 
	`yy¡¾’
 (
yyfÜm©
);

1014 ià(! (
yysize
 <ğ
yysize1
 && yysize1 <ğ
YYSTACK_ALLOC_MAXIMUM
))

1016 
yysize
 = 
yysize1
;

1019 ià(*
yymsg_®loc
 < 
yysize
)

1021 *
yymsg_®loc
 = 2 * 
yysize
;

1022 ià(! (
yysize
 <ğ*
yymsg_®loc


1023 && *
yymsg_®loc
 <ğ
YYSTACK_ALLOC_MAXIMUM
))

1024 *
yymsg_®loc
 = 
YYSTACK_ALLOC_MAXIMUM
;

1032 *
yyp
 = *
yymsg
;

1033 
yyi
 = 0;

1034 (*
yyp
 = *
yyfÜm©
) != '\0')

1035 ià(*
yyp
 =ğ'%' && 
yyfÜm©
[1] =ğ's' && 
yyi
 < 
yycouÁ
)

1037 
yyp
 +ğ
	`yyŠam”r
 (yyp, 
yy¬g
[
yyi
++]);

1038 
yyfÜm©
 += 2;

1042 
yyp
++;

1043 
yyfÜm©
++;

1047 
	}
}

1055 
	$yyde¡ruù
 (cÚ¡ *
yymsg
, 
yyty³
, 
YYSTYPE
 *
yyv®u•
, 
YYLTYPE
 *
yyloÿtiÚp
, *
sÿÂ”
)

1057 
	`YYUSE
 (
yyv®u•
);

1058 
	`YYUSE
 (
yyloÿtiÚp
);

1059 
	`YYUSE
 (
sÿÂ”
);

1060 ià(!
yymsg
)

1061 
yymsg
 = "Deleting";

1062 
	`YY_SYMBOL_PRINT
 (
yymsg
, 
yyty³
, 
yyv®u•
, 
yyloÿtiÚp
);

1064 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


1065 
yyty³
)

1069 { 
	`ä“
(((*
yyv®u•
).
s
)); }

1077 
YY_IGNORE_MAYBE_UNINITIALIZED_END


1078 
	}
}

1088 
	$yy·r£
 (*
sÿÂ”
)

1091 
yych¬
;

1097 
	`YY_INITIAL_VALUE
 (
YYSTYPE
 
yyv®_deçuÉ
;)

1098 
YYSTYPE
 
yylv®
 
	`YY_INITIAL_VALUE
 (ğ
yyv®_deçuÉ
);

1101 
YYLTYPE
 
yyloc_deçuÉ


1102 #ià
defšed
 
YYLTYPE_IS_TRIVIAL
 && YYLTYPE_IS_TRIVIAL

1106 
YYLTYPE
 
yyÎoc
 = 
yyloc_deçuÉ
;

1109 
yyÃ¼s
;

1111 
yy¡©e
;

1113 
yy”r¡©us
;

1124 
yyty³_št16
 
yys§
[
YYINITDEPTH
];

1125 
yyty³_št16
 *
yyss
;

1126 
yyty³_št16
 *
yys¥
;

1129 
YYSTYPE
 
yyv§
[
YYINITDEPTH
];

1130 
YYSTYPE
 *
yyvs
;

1131 
YYSTYPE
 *
yyv¥
;

1134 
YYLTYPE
 
yyl§
[
YYINITDEPTH
];

1135 
YYLTYPE
 *
yyls
;

1136 
YYLTYPE
 *
yyl¥
;

1139 
YYLTYPE
 
yy”rÜ_¿nge
[3];

1141 
YYSIZE_T
 
yy¡acksize
;

1143 
yyn
;

1144 
yy»suÉ
;

1146 
yytok’
 = 0;

1149 
YYSTYPE
 
yyv®
;

1150 
YYLTYPE
 
yyloc
;

1152 #ià
YYERROR_VERBOSE


1154 
yymsgbuf
[128];

1155 *
yymsg
 = 
yymsgbuf
;

1156 
YYSIZE_T
 
yymsg_®loc
 =  
yymsgbuf
;

1159 
	#YYPOPSTACK
(
N
è(
yyv¥
 -ğ(N), 
yys¥
 -ğ(N), 
yyl¥
 -ğ(N))

	)

1163 
yyËn
 = 0;

1165 
yys¥
 = 
yyss
 = 
yys§
;

1166 
yyv¥
 = 
yyvs
 = 
yyv§
;

1167 
yyl¥
 = 
yyls
 = 
yyl§
;

1168 
yy¡acksize
 = 
YYINITDEPTH
;

1170 
	`YYDPRINTF
 ((
¡d”r
, "Starting…arse\n"));

1172 
yy¡©e
 = 0;

1173 
yy”r¡©us
 = 0;

1174 
yyÃ¼s
 = 0;

1175 
yych¬
 = 
YYEMPTY
;

1176 
yyl¥
[0] = 
yyÎoc
;

1177 
yy£t¡©e
;

1182 
yyÃw¡©e
:

1185 
yys¥
++;

1187 
yy£t¡©e
:

1188 *
yys¥
 = 
yy¡©e
;

1190 ià(
yyss
 + 
yy¡acksize
 - 1 <ğ
yys¥
)

1193 
YYSIZE_T
 
yysize
 = 
yys¥
 - 
yyss
 + 1;

1195 #ifdeà
yyov”æow


1200 
YYSTYPE
 *
yyvs1
 = 
yyvs
;

1201 
yyty³_št16
 *
yyss1
 = 
yyss
;

1202 
YYLTYPE
 *
yyls1
 = 
yyls
;

1208 
	`yyov”æow
 (
	`YY_
("memoryƒxhausted"),

1209 &
yyss1
, 
yysize
 *  (*
yys¥
),

1210 &
yyvs1
, 
yysize
 *  (*
yyv¥
),

1211 &
yyls1
, 
yysize
 *  (*
yyl¥
),

1212 &
yy¡acksize
);

1214 
yyls
 = 
yyls1
;

1215 
yyss
 = 
yyss1
;

1216 
yyvs
 = 
yyvs1
;

1219 #iâdeà
YYSTACK_RELOCATE


1220 
yyexhau¡edÏb
;

1223 ià(
YYMAXDEPTH
 <ğ
yy¡acksize
)

1224 
yyexhau¡edÏb
;

1225 
yy¡acksize
 *= 2;

1226 ià(
YYMAXDEPTH
 < 
yy¡acksize
)

1227 
yy¡acksize
 = 
YYMAXDEPTH
;

1230 
yyty³_št16
 *
yyss1
 = 
yyss
;

1231 
yy®loc
 *
yy±r
 =

1232 (
yy®loc
 *è
	`YYSTACK_ALLOC
 (
	`YYSTACK_BYTES
 (
yy¡acksize
));

1233 ià(! 
yy±r
)

1234 
yyexhau¡edÏb
;

1235 
	`YYSTACK_RELOCATE
 (
yyss_®loc
, 
yyss
);

1236 
	`YYSTACK_RELOCATE
 (
yyvs_®loc
, 
yyvs
);

1237 
	`YYSTACK_RELOCATE
 (
yyls_®loc
, 
yyls
);

1238 #undeà
YYSTACK_RELOCATE


1239 ià(
yyss1
 !ğ
yys§
)

1240 
	`YYSTACK_FREE
 (
yyss1
);

1245 
yys¥
 = 
yyss
 + 
yysize
 - 1;

1246 
yyv¥
 = 
yyvs
 + 
yysize
 - 1;

1247 
yyl¥
 = 
yyls
 + 
yysize
 - 1;

1249 
	`YYDPRINTF
 ((
¡d”r
, "Stack size increasedo %lu\n",

1250 (è
yy¡acksize
));

1252 ià(
yyss
 + 
yy¡acksize
 - 1 <ğ
yys¥
)

1253 
YYABORT
;

1256 
	`YYDPRINTF
 ((
¡d”r
, "EÁ”šg s‹ %d\n", 
yy¡©e
));

1258 ià(
yy¡©e
 =ğ
YYFINAL
)

1259 
YYACCEPT
;

1261 
yybackup
;

1266 
yybackup
:

1272 
yyn
 = 
yy·ù
[
yy¡©e
];

1273 ià(
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

1274 
yydeçuÉ
;

1279 ià(
yych¬
 =ğ
YYEMPTY
)

1281 
	`YYDPRINTF
 ((
¡d”r
, "Reading‡oken: "));

1282 
yych¬
 = 
	`yyËx
 (&
yylv®
, &
yyÎoc
, 
sÿÂ”
);

1285 ià(
yych¬
 <ğ
YYEOF
)

1287 
yych¬
 = 
yytok’
 = 
YYEOF
;

1288 
	`YYDPRINTF
 ((
¡d”r
, "Now‡tƒnd of input.\n"));

1292 
yytok’
 = 
	`YYTRANSLATE
 (
yych¬
);

1293 
	`YY_SYMBOL_PRINT
 ("Nexˆtok’ is", 
yytok’
, &
yylv®
, &
yyÎoc
);

1298 
yyn
 +ğ
yytok’
;

1299 ià(
yyn
 < 0 || 
YYLAST
 < yyÀ|| 
yycheck
[yyn] !ğ
yytok’
)

1300 
yydeçuÉ
;

1301 
yyn
 = 
yybË
[yyn];

1302 ià(
yyn
 <= 0)

1304 ià(
	`yybË_v®ue_is_”rÜ
 (
yyn
))

1305 
yy”¾ab
;

1306 
yyn
 = -yyn;

1307 
yy»duû
;

1312 ià(
yy”r¡©us
)

1313 
yy”r¡©us
--;

1316 
	`YY_SYMBOL_PRINT
 ("Shiášg", 
yytok’
, &
yylv®
, &
yyÎoc
);

1319 
yych¬
 = 
YYEMPTY
;

1321 
yy¡©e
 = 
yyn
;

1322 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


1323 *++
yyv¥
 = 
yylv®
;

1324 
YY_IGNORE_MAYBE_UNINITIALIZED_END


1325 *++
yyl¥
 = 
yyÎoc
;

1326 
yyÃw¡©e
;

1332 
yydeçuÉ
:

1333 
yyn
 = 
yydeçù
[
yy¡©e
];

1334 ià(
yyn
 == 0)

1335 
yy”¾ab
;

1336 
yy»duû
;

1342 
yy»duû
:

1344 
yyËn
 = 
yyr2
[
yyn
];

1354 
yyv®
 = 
yyv¥
[1-
yyËn
];

1357 
	`YYLLOC_DEFAULT
 (
yyloc
, (
yyl¥
 - 
yyËn
), yylen);

1358 
	`YY_REDUCE_PRINT
 (
yyn
);

1359 
yyn
)

1364 
¹Æ_pkoc
 *
loc
;

1366 ià(!(
loc
 = 
	`¹Æ_pkoc_®loc
())) {

1367 
	`NL_DBG
(1, "Allocating‡…acket†ocation "

1369 
YYABORT
;

1372 
loc
->
Çme
 = (
yyv¥
[-5].
s
);

1373 
loc
->
®ign
 = (
yyv¥
[-4].
i
);

1374 
loc
->
Ïy”
 = (
yyv¥
[-3].
i
);

1375 
loc
->
off£t
 = (
yyv¥
[-2].
i
);

1376 
loc
->
mask
 = (
yyv¥
[-1].
i
);

1377 
loc
->
shiá
 = (
yyv¥
[0].
i
);

1379 ià(
	`¹Æ_pkoc_add
(
loc
) < 0) {

1380 
	`NL_DBG
(1, "Duplicate…acket†ocationƒntry "

1381 "\"%s\"\n", (
yyv¥
[-5].
s
));

1384 (
yyv®
.
l
èğ
loc
;

1391 { (
yyv®
.
i
èğ(
yyv¥
[0].i); }

1397 { (
yyv®
.
i
èğ(
yyv¥
[0].i); }

1403 { (
yyv®
.
i
èğ
TCF_LAYER_NETWORK
; }

1409 { (
yyv®
.
i
èğ(
yyv¥
[-1].i); }

1415 { (
yyv®
.
i
) = 0; }

1421 { (
yyv®
.
i
èğ(
yyv¥
[0].i); }

1427 { (
yyv®
.
i
) = 0; }

1433 { (
yyv®
.
i
èğ(
yyv¥
[0].i); }

1452 
	`YY_SYMBOL_PRINT
 ("-> $$ =", 
yyr1
[
yyn
], &
yyv®
, &
yyloc
);

1454 
	`YYPOPSTACK
 (
yyËn
);

1455 
yyËn
 = 0;

1456 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

1458 *++
yyv¥
 = 
yyv®
;

1459 *++
yyl¥
 = 
yyloc
;

1465 
yyn
 = 
yyr1
[yyn];

1467 
yy¡©e
 = 
yypgÙo
[
yyn
 - 
YYNTOKENS
] + *
yys¥
;

1468 ià(0 <ğ
yy¡©e
 && yy¡©<ğ
YYLAST
 && 
yycheck
[yy¡©e] =ğ*
yys¥
)

1469 
yy¡©e
 = 
yybË
[yystate];

1471 
yy¡©e
 = 
yydefgÙo
[
yyn
 - 
YYNTOKENS
];

1473 
yyÃw¡©e
;

1479 
yy”¾ab
:

1482 
yytok’
 = 
yych¬
 =ğ
YYEMPTY
 ? YYEMPTY : 
	`YYTRANSLATE
 (yychar);

1485 ià(!
yy”r¡©us
)

1487 ++
yyÃ¼s
;

1488 #ià! 
YYERROR_VERBOSE


1489 
	`yy”rÜ
 (&
yyÎoc
, 
sÿÂ”
, 
	`YY_
("syntaxƒrror"));

1491 
	#YYSYNTAX_ERROR
 
	`yysyÁax_”rÜ
 (&
yymsg_®loc
, &
yymsg
, \

1492 
yys¥
, 
yytok’
)

	)

1494 cÚ¡ *
yymsgp
 = 
	`YY_
("syntaxƒrror");

1495 
yysyÁax_”rÜ_¡©us
;

1496 
yysyÁax_”rÜ_¡©us
 = 
YYSYNTAX_ERROR
;

1497 ià(
yysyÁax_”rÜ_¡©us
 == 0)

1498 
yymsgp
 = 
yymsg
;

1499 ià(
yysyÁax_”rÜ_¡©us
 == 1)

1501 ià(
yymsg
 !ğ
yymsgbuf
)

1502 
	`YYSTACK_FREE
 (
yymsg
);

1503 
yymsg
 = (*è
	`YYSTACK_ALLOC
 (
yymsg_®loc
);

1504 ià(!
yymsg
)

1506 
yymsg
 = 
yymsgbuf
;

1507 
yymsg_®loc
 =  
yymsgbuf
;

1508 
yysyÁax_”rÜ_¡©us
 = 2;

1512 
yysyÁax_”rÜ_¡©us
 = 
YYSYNTAX_ERROR
;

1513 
yymsgp
 = 
yymsg
;

1516 
	`yy”rÜ
 (&
yyÎoc
, 
sÿÂ”
, 
yymsgp
);

1517 ià(
yysyÁax_”rÜ_¡©us
 == 2)

1518 
yyexhau¡edÏb
;

1520 #undeà
YYSYNTAX_ERROR


1524 
yy”rÜ_¿nge
[1] = 
yyÎoc
;

1526 ià(
yy”r¡©us
 == 3)

1531 ià(
yych¬
 <ğ
YYEOF
)

1534 ià(
yych¬
 =ğ
YYEOF
)

1535 
YYABORT
;

1539 
	`yyde¡ruù
 ("Error: discarding",

1540 
yytok’
, &
yylv®
, &
yyÎoc
, 
sÿÂ”
);

1541 
yych¬
 = 
YYEMPTY
;

1547 
yy”¾ab1
;

1553 
yy”rÜÏb
:

1559 
yy”rÜÏb
;

1561 
yy”rÜ_¿nge
[1] = 
yyl¥
[1-
yyËn
];

1564 
	`YYPOPSTACK
 (
yyËn
);

1565 
yyËn
 = 0;

1566 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

1567 
yy¡©e
 = *
yys¥
;

1568 
yy”¾ab1
;

1574 
yy”¾ab1
:

1575 
yy”r¡©us
 = 3;

1579 
yyn
 = 
yy·ù
[
yy¡©e
];

1580 ià(!
	`yy·ù_v®ue_is_deçuÉ
 (
yyn
))

1582 
yyn
 +ğ
YYTERROR
;

1583 ià(0 <ğ
yyn
 && yyÀ<ğ
YYLAST
 && 
yycheck
[yyn] =ğ
YYTERROR
)

1585 
yyn
 = 
yybË
[yyn];

1586 ià(0 < 
yyn
)

1592 ià(
yys¥
 =ğ
yyss
)

1593 
YYABORT
;

1595 
yy”rÜ_¿nge
[1] = *
yyl¥
;

1596 
	`yyde¡ruù
 ("Error:…opping",

1597 
yy¡os
[
yy¡©e
], 
yyv¥
, 
yyl¥
, 
sÿÂ”
);

1598 
	`YYPOPSTACK
 (1);

1599 
yy¡©e
 = *
yys¥
;

1600 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

1603 
YY_IGNORE_MAYBE_UNINITIALIZED_BEGIN


1604 *++
yyv¥
 = 
yylv®
;

1605 
YY_IGNORE_MAYBE_UNINITIALIZED_END


1607 
yy”rÜ_¿nge
[2] = 
yyÎoc
;

1610 
	`YYLLOC_DEFAULT
 (
yyloc
, 
yy”rÜ_¿nge
, 2);

1611 *++
yyl¥
 = 
yyloc
;

1614 
	`YY_SYMBOL_PRINT
 ("Shiášg", 
yy¡os
[
yyn
], 
yyv¥
, 
yyl¥
);

1616 
yy¡©e
 = 
yyn
;

1617 
yyÃw¡©e
;

1623 
yyacû±Ïb
:

1624 
yy»suÉ
 = 0;

1625 
yy»tuº
;

1630 
yyabÜab
:

1631 
yy»suÉ
 = 1;

1632 
yy»tuº
;

1634 #ià!
defšed
 
yyov”æow
 || 
YYERROR_VERBOSE


1638 
yyexhau¡edÏb
:

1639 
	`yy”rÜ
 (&
yyÎoc
, 
sÿÂ”
, 
	`YY_
("memoryƒxhausted"));

1640 
yy»suÉ
 = 2;

1644 
yy»tuº
:

1645 ià(
yych¬
 !ğ
YYEMPTY
)

1649 
yytok’
 = 
	`YYTRANSLATE
 (
yych¬
);

1650 
	`yyde¡ruù
 ("Cleanup: discarding†ookahead",

1651 
yytok’
, &
yylv®
, &
yyÎoc
, 
sÿÂ”
);

1655 
	`YYPOPSTACK
 (
yyËn
);

1656 
	`YY_STACK_PRINT
 (
yyss
, 
yys¥
);

1657 
yys¥
 !ğ
yyss
)

1659 
	`yyde¡ruù
 ("Cleanup:…opping",

1660 
yy¡os
[*
yys¥
], 
yyv¥
, 
yyl¥
, 
sÿÂ”
);

1661 
	`YYPOPSTACK
 (1);

1663 #iâdeà
yyov”æow


1664 ià(
yyss
 !ğ
yys§
)

1665 
	`YYSTACK_FREE
 (
yyss
);

1667 #ià
YYERROR_VERBOSE


1668 ià(
yymsg
 !ğ
yymsgbuf
)

1669 
	`YYSTACK_FREE
 (
yymsg
);

1671  
yy»suÉ
;

1672 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.h

33 #iâdeà
YY_PKTLOC_ROUTE_PKTLOC_SYNTAX_H_INCLUDED


34 
	#YY_PKTLOC_ROUTE_PKTLOC_SYNTAX_H_INCLUDED


	)

36 #iâdeà
YYDEBUG


37 
	#YYDEBUG
 0

	)

39 #ià
YYDEBUG


40 
pkoc_debug
;

44 #iâdeà
YYTOKENTYPE


45 
	#YYTOKENTYPE


	)

46 
	eyytok’ty³


48 
	mERROR
 = 258,

49 
	mNUMBER
 = 259,

50 
	mLAYER
 = 260,

51 
	mALIGN
 = 261,

52 
	mNAME
 = 262

56 
	#ERROR
 258

	)

57 
	#NUMBER
 259

	)

58 
	#LAYER
 260

	)

59 
	#ALIGN
 261

	)

60 
	#NAME
 262

	)

63 #ià! 
defšed
 
YYSTYPE
 && ! defšed 
YYSTYPE_IS_DECLARED


64 
YYSTYPE
 
	tYYSTYPE
;

65 
	uYYSTYPE


69 
¹Æ_pkoc
 *
	ml
;

70 
ušt32_t
 
	mi
;

71 *
	ms
;

75 
	#YYSTYPE_IS_TRIVIAL
 1

	)

76 
	#YYSTYPE_IS_DECLARED
 1

	)

80 #ià! 
defšed
 
YYLTYPE
 && ! defšed 
YYLTYPE_IS_DECLARED


81 
YYLTYPE
 
	tYYLTYPE
;

82 
	sYYLTYPE


84 
	mfœ¡_lše
;

85 
	mfœ¡_cŞumn
;

86 
	mÏ¡_lše
;

87 
	mÏ¡_cŞumn
;

89 
	#YYLTYPE_IS_DECLARED
 1

	)

90 
	#YYLTYPE_IS_TRIVIAL
 1

	)

95 
pkoc_·r£
 (*
sÿÂ”
);

	@mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.y

2 
	~<Ãšk-´iv©e/Ãšk.h
>

3 
	~<Ãšk-´iv©e/tc.h
>

4 
	~<Ãšk/Ãšk.h
>

5 
	~<Ãšk/uts.h
>

6 
	~<Ãšk/rou‹/pkoc.h
>

9 %
loÿtiÚs


10 %
”rÜ
-
v”bo£


11 %
defše
 
­i
.
pu»


12 %
Çme
-
´efix
 "pktloc_"

14 %
·r£
-
·¿m
 {*
sÿÂ”
}

15 %
Ëx
-
·¿m
 {*
sÿÂ”
}

16 %
ex³ù
 1

19 
¹Æ_pkoc
 *
l
;

20 
ušt32_t
 
i
;

21 *
s
;

25 
pkoc_Ëx
(
YYSTYPE
 *, 
YYLTYPE
 *, *);

27 
	$yy”rÜ
(
YYLTYPE
 *
loı
, *
sÿÂ”
, cÚ¡ *
msg
)

29 
	`NL_DBG
(1, "E¼Ü wh·rsšg…ack‘†oÿtiÚ fe: %s\n", 
msg
);

30 
	}
}

33 %
tok’
 <
i
> 
ERROR
 
NUMBER
 
LAYER
 
ALIGN


34 %
tok’
 <
s
> 
NAME


36 %
ty³
 <
i
> 
mask
 
Ïy”
 
®ign
 
shiá


37 %
ty³
 <
l
> 
loÿtiÚ


39 %
de¡ruùÜ
 { 
ä“
(
$$
); } 
NAME


41 %
¡¬t
 
šput


43 %% /* 
	$yy·r£
 */ 
	`yyËx
()

45 
šput
:

47 | 
loÿtiÚ
 
šput


50 
loÿtiÚ
:

51 
NAME
 
®ign
 
Ïy”
 
NUMBER
 
mask
 
shiá


53 
¹Æ_pkoc
 *
loc
;

55 ià(!(
loc
 = 
	`¹Æ_pkoc_®loc
())) {

56 
	`NL_DBG
(1, "Allocating‡…acket†ocation "

58 
YYABORT
;

61 
loc
->
Çme
 = 
$1
;

62 
loc
->
®ign
 = 
$2
;

63 
loc
->
Ïy”
 = 
$3
;

64 
loc
->
off£t
 = 
$4
;

65 
loc
->
mask
 = 
$5
;

66 
loc
->
shiá
 = 
$6
;

68 ià(
	`¹Æ_pkoc_add
(
loc
) < 0) {

69 
	`NL_DBG
(1, "Duplicate…acket†ocationƒntry "

70 "\"%s\"\n", 
$1
);

73 
$$
 = 
loc
;

77 
®ign
:

78 
ALIGN


79 { 
$$
 = 
$1
; }

80 | 
NUMBER


81 { 
$$
 = 
$1
; }

84 
Ïy”
:

86 { 
$$
 = 
TCF_LAYER_NETWORK
; }

87 | 
LAYER
 '+'

88 { 
$$
 = 
$1
; }

91 
mask
:

93 { 
$$
 = 0; }

94 | 
NUMBER


95 { 
$$
 = 
$1
; }

98 
shiá
:

100 { 
$$
 = 0; }

101 | 
NUMBER


102 { 
$$
 = 
$1
; }

	@mylibnl/libnl-3.2.25/lib/route/qdisc.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk/rou‹/lšk.h
>

23 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

24 
	~<Ãšk/rou‹/qdisc.h
>

25 
	~<Ãšk/rou‹/şass.h
>

26 
	~<Ãšk/rou‹/şassif›r.h
>

28 
Æ_ÿche_İs
 
	g¹Æ_qdisc_İs
;

29 
Æ_objeù_İs
 
	gqdisc_obj_İs
;

31 
	$qdisc_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

32 
Æmsghdr
 *
n
, 
Æ_·r£r_·¿m
 *
µ
)

34 
¹Æ_qdisc
 *
qdisc
;

35 
”r
;

37 ià(!(
qdisc
 = 
	`¹Æ_qdisc_®loc
()))

38  -
NLE_NOMEM
;

40 ià((
”r
 = 
	`¹Æ_tc_msg_·r£
(
n
, 
	`TC_CAST
(
qdisc
))) < 0)

41 
”rout
;

43 
”r
 = 
µ
->
	`µ_cb
(
	`OBJ_CAST
(
qdisc
),…p);

44 
”rout
:

45 
	`¹Æ_qdisc_put
(
qdisc
);

47  
”r
;

48 
	}
}

50 
	$qdisc_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
sk
)

52 
tcmsg
 
tchdr
 = {

53 .
tcm_çmy
 = 
AF_UNSPEC
,

54 .
tcm_ifšdex
 = 
c
->
c_Ÿrg1
,

57  
	`Æ_£nd_sim¶e
(
sk
, 
RTM_GETQDISC
, 
NLM_F_DUMP
, &
tchdr
,

58 (
tchdr
));

59 
	}
}

66 
¹Æ_qdisc
 *
	$¹Æ_qdisc_®loc
()

68 
¹Æ_tc
 *
tc
;

70 
tc
 = 
	`TC_CAST
(
	`Æ_objeù_®loc
(&
qdisc_obj_İs
));

71 ià(
tc
)

72 
tc
->
tc_ty³
 = 
RTNL_TC_TYPE_QDISC
;

74  (
¹Æ_qdisc
 *è
tc
;

75 
	}
}

77 
	$¹Æ_qdisc_put
(
¹Æ_qdisc
 *
qdisc
)

79 
	`Æ_objeù_put
((
Æ_objeù
 *è
qdisc
);

80 
	}
}

89 
	$bud_qdisc_msg
(
¹Æ_qdisc
 *
qdisc
, 
ty³
, 
æags
,

90 
Æ_msg
 **
»suÉ
)

92 ià(!(
qdisc
->
û_mask
 & 
TCA_ATTR_IFINDEX
)) {

93 
	`APPBUG
("ifindex must be specified");

94  -
NLE_MISSING_ATTR
;

97  
	`¹Æ_tc_msg_bud
(
	`TC_CAST
(
qdisc
), 
ty³
, 
æags
, 
»suÉ
);

98 
	}
}

114 
	$¹Æ_qdisc_bud_add_»que¡
(
¹Æ_qdisc
 *
qdisc
, 
æags
,

115 
Æ_msg
 **
»suÉ
)

117 ià(!(
qdisc
->
û_mask
 & (
TCA_ATTR_HANDLE
 | 
TCA_ATTR_PARENT
))) {

118 
	`APPBUG
("handle or…arent must be specified");

119  -
NLE_MISSING_ATTR
;

122  
	`bud_qdisc_msg
(
qdisc
, 
RTM_NEWQDISC
, 
æags
, 
»suÉ
);

123 
	}
}

162 
	$¹Æ_qdisc_add
(
Æ_sock
 *
sk
, 
¹Æ_qdisc
 *
qdisc
, 
æags
)

164 
Æ_msg
 *
msg
;

165 
”r
;

167 ià((
”r
 = 
	`¹Æ_qdisc_bud_add_»que¡
(
qdisc
, 
æags
, &
msg
)) < 0)

168  
”r
;

170  
	`Æ_£nd_sync
(
sk
, 
msg
);

171 
	}
}

188 
	$¹Æ_qdisc_bud_upd©e_»que¡
(
¹Æ_qdisc
 *
qdisc
,

189 
¹Æ_qdisc
 *
Ãw
, 
æags
,

190 
Æ_msg
 **
»suÉ
)

192 ià(
æags
 & (
NLM_F_CREATE
 | 
NLM_F_EXCL
)) {

193 
	`APPBUG
("NLM_F_CREATE‡nd NLM_F_EXCL may‚ot be used here, "

195  -
NLE_INVAL
;

198 ià(!(
qdisc
->
û_mask
 & 
TCA_ATTR_IFINDEX
)) {

199 
	`APPBUG
("ifindex must be specified");

200  -
NLE_MISSING_ATTR
;

203 ià(!(
qdisc
->
û_mask
 & (
TCA_ATTR_HANDLE
 | 
TCA_ATTR_PARENT
))) {

204 
	`APPBUG
("handle or…arent must be specified");

205  -
NLE_MISSING_ATTR
;

208 
	`¹Æ_tc_£t_ifšdex
(
	`TC_CAST
(
Ãw
), 
qdisc
->
q_ifšdex
);

210 ià(
qdisc
->
û_mask
 & 
TCA_ATTR_HANDLE
)

211 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
Ãw
), 
qdisc
->
q_hªdË
);

213 ià(
qdisc
->
û_mask
 & 
TCA_ATTR_PARENT
)

214 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
Ãw
), 
qdisc
->
q_·»Á
);

216  
	`bud_qdisc_msg
(
Ãw
, 
RTM_NEWQDISC
, 
æags
, 
»suÉ
);

217 
	}
}

247 
	$¹Æ_qdisc_upd©e
(
Æ_sock
 *
sk
, 
¹Æ_qdisc
 *
qdisc
,

248 
¹Æ_qdisc
 *
Ãw
, 
æags
)

250 
Æ_msg
 *
msg
;

251 
”r
;

253 
”r
 = 
	`¹Æ_qdisc_bud_upd©e_»que¡
(
qdisc
, 
Ãw
, 
æags
, &
msg
);

254 ià(
”r
 < 0)

255  
”r
;

257  
	`Æ_£nd_sync
(
sk
, 
msg
);

258 
	}
}

273 
	$¹Æ_qdisc_bud_d–‘e_»que¡
(
¹Æ_qdisc
 *
qdisc
,

274 
Æ_msg
 **
»suÉ
)

276 
Æ_msg
 *
msg
;

277 
tcmsg
 
tchdr
;

278 
ušt32_t
 
»quœed
 = 
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_PARENT
;

280 ià((
qdisc
->
û_mask
 & 
»quœed
) !=„equired) {

281 
	`APPBUG
("ifindex‡nd…arent must be specified");

282  -
NLE_MISSING_ATTR
;

285 ià(!(
msg
 = 
	`Æmsg_®loc_sim¶e
(
RTM_DELQDISC
, 0)))

286  -
NLE_NOMEM
;

288 
	`mem£t
(&
tchdr
, 0, (tchdr));

290 
tchdr
.
tcm_çmy
 = 
AF_UNSPEC
;

291 
tchdr
.
tcm_ifšdex
 = 
qdisc
->
q_ifšdex
;

292 
tchdr
.
tcm_·»Á
 = 
qdisc
->
q_·»Á
;

294 ià(
qdisc
->
û_mask
 & 
TCA_ATTR_HANDLE
)

295 
tchdr
.
tcm_hªdË
 = 
qdisc
->
q_hªdË
;

297 ià(
	`Æmsg_­³nd
(
msg
, &
tchdr
, Ñchdr), 
NLMSG_ALIGNTO
) < 0)

298 
Æa_put_çu»
;

300 ià(
qdisc
->
û_mask
 & 
TCA_ATTR_KIND
)

301 
	`NLA_PUT_STRING
(
msg
, 
TCA_KIND
, 
qdisc
->
q_kšd
);

303 *
»suÉ
 = 
msg
;

306 
Æa_put_çu»
:

307 
	`Æmsg_ä“
(
msg
);

308  -
NLE_MSGSIZE
;

309 
	}
}

340 
	$¹Æ_qdisc_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_qdisc
 *
qdisc
)

342 
Æ_msg
 *
msg
;

343 
”r
;

345 ià((
”r
 = 
	`¹Æ_qdisc_bud_d–‘e_»que¡
(
qdisc
, &
msg
)) < 0)

346  
”r
;

348  
	`Æ_£nd_sync
(
sk
, 
msg
);

349 
	}
}

368 
	$¹Æ_qdisc_®loc_ÿche
(
Æ_sock
 *
sk
, 
Æ_ÿche
 **
»suÉ
)

370  
	`Æ_ÿche_®loc_ªd_fl
(&
¹Æ_qdisc_İs
, 
sk
, 
»suÉ
);

371 
	}
}

387 
¹Æ_qdisc
 *
	$¹Æ_qdisc_g‘_by_·»Á
(
Æ_ÿche
 *
ÿche
,

388 
ifšdex
, 
ušt32_t
 
·»Á
)

390 
¹Æ_qdisc
 *
q
;

392 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_qdisc_İs
)

393  
NULL
;

395 
	`Æ_li¡_fÜ_—ch_’Œy
(
q
, &
ÿche
->
c_™ems
, 
û_li¡
) {

396 ià(
q
->
q_·»Á
 =ğ
·»Á
 && q->
q_ifšdex
 =ğ
ifšdex
) {

397 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
q
);

398  
q
;

402  
NULL
;

403 
	}
}

419 
¹Æ_qdisc
 *
	$¹Æ_qdisc_g‘
(
Æ_ÿche
 *
ÿche
, 
ifšdex
,

420 
ušt32_t
 
hªdË
)

422 
¹Æ_qdisc
 *
q
;

424 ià(
ÿche
->
c_İs
 !ğ&
¹Æ_qdisc_İs
)

425  
NULL
;

427 
	`Æ_li¡_fÜ_—ch_’Œy
(
q
, &
ÿche
->
c_™ems
, 
û_li¡
) {

428 ià(
q
->
q_hªdË
 =ğ
hªdË
 && q->
q_ifšdex
 =ğ
ifšdex
) {

429 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
q
);

430  
q
;

434  
NULL
;

435 
	}
}

450 
¹Æ_qdisc_fÜ—ch_chd
(
¹Æ_qdisc
 *
qdisc
, 
Æ_ÿche
 *
ÿche
,

451 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

453 
¹Æ_şass
 *
f‹r
;

455 
f‹r
 = 
	`¹Æ_şass_®loc
();

456 ià(!
f‹r
)

459 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
f‹r
), 
qdisc
->
q_hªdË
);

460 
	`¹Æ_tc_£t_ifšdex
(
	`TC_CAST
(
f‹r
), 
qdisc
->
q_ifšdex
);

461 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
f‹r
), 
qdisc
->
q_kšd
);

463 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, 
	`OBJ_CAST
(
f‹r
), 
cb
, 
¬g
);

465 
	`¹Æ_şass_put
(
f‹r
);

466 
	}
}

474 
¹Æ_qdisc_fÜ—ch_şs
(
¹Æ_qdisc
 *
qdisc
, 
Æ_ÿche
 *
ÿche
,

475 (*
cb
)(
Æ_objeù
 *, *), *
¬g
)

477 
¹Æ_şs
 *
f‹r
;

479 ià(!(
f‹r
 = 
	`¹Æ_şs_®loc
()))

482 
	`¹Æ_tc_£t_ifšdex
(
	`TC_CAST
(
f‹r
), 
qdisc
->
q_ifšdex
);

483 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
f‹r
), 
qdisc
->
q_·»Á
);

485 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, 
	`OBJ_CAST
(
f‹r
), 
cb
, 
¬g
);

486 
	`¹Æ_şs_put
(
f‹r
);

487 
	}
}

496 
	$¹Æ_qdisc_bud_chªge_»que¡
(
¹Æ_qdisc
 *
qdisc
,

497 
¹Æ_qdisc
 *
Ãw
,

498 
Æ_msg
 **
»suÉ
)

500  
	`¹Æ_qdisc_bud_upd©e_»que¡
(
qdisc
, 
Ãw
, 
NLM_F_REPLACE
,

501 
»suÉ
);

502 
	}
}

511 
	$¹Æ_qdisc_chªge
(
Æ_sock
 *
sk
, 
¹Æ_qdisc
 *
qdisc
,

512 
¹Æ_qdisc
 *
Ãw
)

514  
	`¹Æ_qdisc_upd©e
(
sk
, 
qdisc
, 
Ãw
, 
NLM_F_REPLACE
);

515 
	}
}

519 
	$qdisc_dump_d‘as
(
¹Æ_tc
 *
tc
, 
Æ_dump_·¿ms
 *
p
)

521 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
tc
;

523 
	`Æ_dump
(
p
, "»fúˆ%u ", 
qdisc
->
q_šfo
);

524 
	}
}

526 
¹Æ_tc_ty³_İs
 
	gqdisc_İs
 = {

527 .
‰_ty³
 = 
RTNL_TC_TYPE_QDISC
,

528 .
	g‰_dump_´efix
 = "qdisc",

529 .
	g‰_dump
 = {

530 [
NL_DUMP_DETAILS
] = 
qdisc_dump_d‘as
,

534 
Æ_ÿche_İs
 
	g¹Æ_qdisc_İs
 = {

535 .
co_Çme
 = "route/qdisc",

536 .
	gco_hdrsize
 = (
tcmsg
),

537 .
	gco_msgty³s
 = {

538 { 
RTM_NEWQDISC
, 
NL_ACT_NEW
, "new" },

539 { 
RTM_DELQDISC
, 
NL_ACT_DEL
, "del" },

540 { 
RTM_GETQDISC
, 
NL_ACT_GET
, "get" },

541 
END_OF_MSGTYPES_LIST
,

543 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

544 .
	gco_groups
 = 
tc_groups
,

545 .
	gco_»que¡_upd©e
 = 
qdisc_»que¡_upd©e
,

546 .
	gco_msg_·r£r
 = 
qdisc_msg_·r£r
,

547 .
	gco_obj_İs
 = &
qdisc_obj_İs
,

550 
Æ_objeù_İs
 
	gqdisc_obj_İs
 = {

551 .
oo_Çme
 = "route/qdisc",

552 .
	goo_size
 = (
¹Æ_qdisc
),

553 .
	goo_ä“_d©a
 = 
¹Æ_tc_ä“_d©a
,

554 .
	goo_şÚe
 = 
¹Æ_tc_şÚe
,

555 .
	goo_dump
 = {

556 [
NL_DUMP_LINE
] = 
¹Æ_tc_dump_lše
,

557 [
NL_DUMP_DETAILS
] = 
¹Æ_tc_dump_d‘as
,

558 [
NL_DUMP_STATS
] = 
¹Æ_tc_dump_¡©s
,

560 .
	goo_com·»
 = 
¹Æ_tc_com·»
,

561 .
	goo_id_©Œs
 = (
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
),

564 
__š™
 
	$qdisc_š™
()

566 
	`¹Æ_tc_ty³_»gi¡”
(&
qdisc_İs
);

567 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_qdisc_İs
);

568 
	}
}

570 
__ex™
 
	$qdisc_ex™
()

572 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_qdisc_İs
);

573 
	`¹Æ_tc_ty³_uÄegi¡”
(&
qdisc_İs
);

574 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/blackhole.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk/Ãšk.h
>

20 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

22 
¹Æ_tc_İs
 
	gbÏckhŞe_İs
 = {

23 .
to_kšd
 = "blackhole",

24 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

27 
__š™
 
	$bÏckhŞe_š™
()

29 
	`¹Æ_tc_»gi¡”
(&
bÏckhŞe_İs
);

30 
	}
}

32 
__ex™
 
	$bÏckhŞe_ex™
()

34 
	`¹Æ_tc_uÄegi¡”
(&
bÏckhŞe_İs
);

35 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/cbq.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk-´iv©e/tc.h
>

14 
	~<Ãšk/Ãšk.h
>

15 
	~<Ãšk/uts.h
>

16 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

17 
	~<Ãšk/rou‹/qdisc.h
>

18 
	~<Ãšk/rou‹/şass.h
>

19 
	~<Ãšk/rou‹/lšk.h
>

20 
	~<Ãšk/rou‹/qdisc/cbq.h
>

21 
	~<Ãšk/rou‹/şs/pŞiû.h
>

30 cÚ¡ 
Œªs_tbl
 
	govl_¡¿‹g›s
[] = {

31 
__ADD
(
TC_CBQ_OVL_CLASSIC
,
şassic
)

32 
__ADD
(
TC_CBQ_OVL_DELAY
,
d–ay
)

33 
__ADD
(
TC_CBQ_OVL_LOWPRIO
,
low´io
)

34 
__ADD
(
TC_CBQ_OVL_DROP
,
drİ
)

35 
__ADD
(
TC_CBQ_OVL_RCLASSIC
,
rşassic
)

48 *
	$Æ_ovl_¡¿‹gy2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
)

50  
	`__ty³2¡r
(
ty³
, 
buf
, 
Ën
, 
ovl_¡¿‹g›s
,

51 
	`ARRAY_SIZE
(
ovl_¡¿‹g›s
));

52 
	}
}

61 
	$Æ_¡r2ovl_¡¿‹gy
(cÚ¡ *
Çme
)

63  
	`__¡r2ty³
(
Çme
, 
ovl_¡¿‹g›s
, 
	`ARRAY_SIZE
(ovl_strategies));

64 
	}
}

66 
Æa_pŞicy
 
	gcbq_pŞicy
[
TCA_CBQ_MAX
+1] = {

67 [
TCA_CBQ_LSSOPT
] = { .
mšËn
 = (
tc_cbq_lssİt
) },

68 [
TCA_CBQ_RATE
] = { .
mšËn
 = (
tc_¿‹¥ec
) },

69 [
TCA_CBQ_WRROPT
] = { .
mšËn
 = (
tc_cbq_w¼İt
) },

70 [
TCA_CBQ_OVL_STRATEGY
] = { .
mšËn
 = (
tc_cbq_ovl
) },

71 [
TCA_CBQ_FOPT
] = { .
mšËn
 = (
tc_cbq_fİt
) },

72 [
TCA_CBQ_POLICE
] = { .
mšËn
 = (
tc_cbq_pŞiû
) },

75 
	$cbq_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

77 
Æ©Œ
 *
tb
[
TCA_CBQ_MAX
 + 1];

78 
¹Æ_cbq
 *
cbq
 = 
d©a
;

79 
”r
;

81 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_CBQ_MAX
, 
tc
, 
cbq_pŞicy
);

82 ià(
”r
 < 0)

83  
”r
;

85 
	`Æa_memıy
(&
cbq
->
cbq_lss
, 
tb
[
TCA_CBQ_LSSOPT
], (cbq->cbq_lss));

86 
	`Æa_memıy
(&
cbq
->
cbq_¿‹
, 
tb
[
TCA_CBQ_RATE
], (cbq->cbq_rate));

87 
	`Æa_memıy
(&
cbq
->
cbq_w¼
, 
tb
[
TCA_CBQ_WRROPT
], (cbq->cbq_wrr));

88 
	`Æa_memıy
(&
cbq
->
cbq_fİt
, 
tb
[
TCA_CBQ_FOPT
], (cbq->cbq_fopt));

89 
	`Æa_memıy
(&
cbq
->
cbq_ovl
, 
tb
[
TCA_CBQ_OVL_STRATEGY
],

90 (
cbq
->
cbq_ovl
));

91 
	`Æa_memıy
(&
cbq
->
cbq_pŞiû
, 
tb
[
TCA_CBQ_POLICE
],

92 (
cbq
->
cbq_pŞiû
));

95 
	}
}

97 
	$cbq_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

98 
Æ_dump_·¿ms
 *
p
)

100 
¹Æ_cbq
 *
cbq
 = 
d©a
;

101 
r
, 
rb™
;

102 *
ru
, *
rub™
;

104 ià(!
cbq
)

107 
r
 = 
	`Æ_ÿnûl_down_by‹s
(
cbq
->
cbq_¿‹
.
¿‹
, &
ru
);

108 
rb™
 = 
	`Æ_ÿnûl_down_b™s
(
cbq
->
cbq_¿‹
.
¿‹
 * 8, &
rub™
);

110 
	`Æ_dump
(
p
, "„ate %.2f%s/s (%.0f%s)…rio %u",

111 
r
, 
ru
, 
rb™
, 
rub™
, 
cbq
->
cbq_w¼
.
´iÜ™y
);

112 
	}
}

114 
	$cbq_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

115 
Æ_dump_·¿ms
 *
p
)

117 
¹Æ_cbq
 *
cbq
 = 
d©a
;

118 *
un™
, 
buf
[32];

119 
w
;

120 
ušt32_t
 
–
;

122 ià(!
cbq
)

125 
w
 = 
	`Æ_ÿnûl_down_b™s
(
cbq
->
cbq_w¼
.
weight
 * 8, &
un™
);

127 
	`Æ_dump
(
p
, "avgpkt %u mpu %u cell %u‡llot %u weight %.0f%s\n",

128 
cbq
->
cbq_lss
.
avpkt
,

129 
cbq
->
cbq_¿‹
.
mpu
,

130 1 << 
cbq
->
cbq_¿‹
.
ûÎ_log
,

131 
cbq
->
cbq_w¼
.
®lÙ
, 
w
, 
un™
);

133 
–
 = 
cbq
->
cbq_lss
.
ewma_log
;

134 
	`Æ_dump_lše
(
p
, " minidle %uus maxidle %uus offtime "

136 
	`Æ_ticks2us
(
cbq
->
cbq_lss
.
mšidË
 >> 
–
),

137 
	`Æ_ticks2us
(
cbq
->
cbq_lss
.
maxidË
 >> 
–
),

138 
	`Æ_ticks2us
(
cbq
->
cbq_lss
.
ofáime
 >> 
–
),

139 
cbq
->
cbq_lss
.
Ëv–
,

140 
cbq
->
cbq_lss
.
ewma_log
);

142 
	`Æ_dump_lše
(
p
, "…enalty %uus strategy %s ",

143 
	`Æ_ticks2us
(
cbq
->
cbq_ovl
.
³ÇÉy
),

144 
	`Æ_ovl_¡¿‹gy2¡r
(
cbq
->
cbq_ovl
.
¡¿‹gy
, 
buf
, (buf)));

146 
	`Æ_dump
(
p
, "split %s defmap 0x%08x ",

147 
	`¹Æ_tc_hªdË2¡r
(
cbq
->
cbq_fİt
.
¥l™
, 
buf
, (buf)),

148 
cbq
->
cbq_fİt
.
defm­
);

150 
	`Æ_dump
(
p
, "police %s",

151 
	`Æ_pŞiû2¡r
(
cbq
->
cbq_pŞiû
.
pŞiû
, 
buf
, (buf)));

152 
	}
}

154 
	$cbq_dump_¡©s
(
¹Æ_tc
 *
tc
, *
d©a
,

155 
Æ_dump_·¿ms
 *
p
)

157 
tc_cbq_x¡©s
 *
x
;

159 ià(!(
x
 = 
	`tÿ_x¡©s
(
tc
)))

162 
	`Æ_dump_lše
(
p
, " borrows overact "

164 
	`Æ_dump_lše
(
p
, " %10u %10u %10u %10u\n",

165 
x
->
bÜrows
, x->
ov”aùiÚs
, x->
avgidË
, x->
und”time
);

166 
	}
}

168 
¹Æ_tc_İs
 
	gcbq_qdisc_İs
 = {

169 .
to_kšd
 = "cbq",

170 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

171 .
	gto_size
 = (
¹Æ_cbq
),

172 .
	gto_msg_·r£r
 = 
cbq_msg_·r£r
,

173 .
	gto_dump
 = {

174 [
NL_DUMP_LINE
] = 
cbq_dump_lše
,

175 [
NL_DUMP_DETAILS
] = 
cbq_dump_d‘as
,

176 [
NL_DUMP_STATS
] = 
cbq_dump_¡©s
,

180 
¹Æ_tc_İs
 
	gcbq_şass_İs
 = {

181 .
to_kšd
 = "cbq",

182 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLASS
,

183 .
	gto_size
 = (
¹Æ_cbq
),

184 .
	gto_msg_·r£r
 = 
cbq_msg_·r£r
,

185 .
	gto_dump
 = {

186 [
NL_DUMP_LINE
] = 
cbq_dump_lše
,

187 [
NL_DUMP_DETAILS
] = 
cbq_dump_d‘as
,

188 [
NL_DUMP_STATS
] = 
cbq_dump_¡©s
,

192 
__š™
 
	$cbq_š™
()

194 
	`¹Æ_tc_»gi¡”
(&
cbq_qdisc_İs
);

195 
	`¹Æ_tc_»gi¡”
(&
cbq_şass_İs
);

196 
	}
}

198 
__ex™
 
	$cbq_ex™
()

200 
	`¹Æ_tc_uÄegi¡”
(&
cbq_qdisc_İs
);

201 
	`¹Æ_tc_uÄegi¡”
(&
cbq_şass_İs
);

202 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/dsmark.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk/rou‹/qdisc.h
>

24 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

25 
	~<Ãšk/rou‹/şass.h
>

26 
	~<Ãšk/rou‹/qdisc/dsm¬k.h
>

29 
	#SCH_DSMARK_ATTR_INDICES
 0x1

	)

30 
	#SCH_DSMARK_ATTR_DEFAULT_INDEX
 0x2

	)

31 
	#SCH_DSMARK_ATTR_SET_TC_INDEX
 0x4

	)

33 
	#SCH_DSMARK_ATTR_MASK
 0x1

	)

34 
	#SCH_DSMARK_ATTR_VALUE
 0x2

	)

37 
Æa_pŞicy
 
	gdsm¬k_pŞicy
[
TCA_DSMARK_MAX
+1] = {

38 [
TCA_DSMARK_INDICES
] = { .
ty³
 = 
NLA_U16
 },

39 [
TCA_DSMARK_DEFAULT_INDEX
] = { .
ty³
 = 
NLA_U16
 },

40 [
TCA_DSMARK_SET_TC_INDEX
] = { .
ty³
 = 
NLA_FLAG
 },

41 [
TCA_DSMARK_VALUE
] = { .
ty³
 = 
NLA_U8
 },

42 [
TCA_DSMARK_MASK
] = { .
ty³
 = 
NLA_U8
 },

45 
	$dsm¬k_qdisc_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

47 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
 = 
d©a
;

48 
Æ©Œ
 *
tb
[
TCA_DSMARK_MAX
 + 1];

49 
”r
;

51 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_DSMARK_MAX
, 
tc
, 
dsm¬k_pŞicy
);

52 ià(
”r
 < 0)

53  
”r
;

55 ià(
tb
[
TCA_DSMARK_INDICES
]) {

56 
dsm¬k
->
qdm_šdiûs
 = 
	`Æa_g‘_u16
(
tb
[
TCA_DSMARK_INDICES
]);

57 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_INDICES
;

60 ià(
tb
[
TCA_DSMARK_DEFAULT_INDEX
]) {

61 
dsm¬k
->
qdm_deçuÉ_šdex
 =

62 
	`Æa_g‘_u16
(
tb
[
TCA_DSMARK_DEFAULT_INDEX
]);

63 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_DEFAULT_INDEX
;

66 ià(
tb
[
TCA_DSMARK_SET_TC_INDEX
]) {

67 
dsm¬k
->
qdm_£t_tc_šdex
 = 1;

68 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_SET_TC_INDEX
;

72 
	}
}

74 
	$dsm¬k_şass_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

76 
¹Æ_dsm¬k_şass
 *
dsm¬k
 = 
d©a
;

77 
Æ©Œ
 *
tb
[
TCA_DSMARK_MAX
 + 1];

78 
”r
;

80 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_DSMARK_MAX
, 
tc
, 
dsm¬k_pŞicy
);

81 ià(
”r
 < 0)

82  
”r
;

84 ià(
tb
[
TCA_DSMARK_MASK
]) {

85 
dsm¬k
->
cdm_bmask
 = 
	`Æa_g‘_u8
(
tb
[
TCA_DSMARK_MASK
]);

86 
dsm¬k
->
cdm_mask
 |ğ
SCH_DSMARK_ATTR_MASK
;

89 ià(
tb
[
TCA_DSMARK_VALUE
]) {

90 
dsm¬k
->
cdm_v®ue
 = 
	`Æa_g‘_u8
(
tb
[
TCA_DSMARK_VALUE
]);

91 
dsm¬k
->
cdm_mask
 |ğ
SCH_DSMARK_ATTR_VALUE
;

95 
	}
}

97 
	$dsm¬k_qdisc_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

98 
Æ_dump_·¿ms
 *
p
)

100 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
 = 
d©a
;

102 ià(
dsm¬k
 && (dsm¬k->
qdm_mask
 & 
SCH_DSMARK_ATTR_INDICES
))

103 
	`Æ_dump
(
p
, " indiû 0x%04x", 
dsm¬k
->
qdm_šdiûs
);

104 
	}
}

106 
	$dsm¬k_qdisc_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

107 
Æ_dump_·¿ms
 *
p
)

109 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
 = 
d©a
;

111 ià(!
dsm¬k
)

114 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_DEFAULT_INDEX
)

115 
	`Æ_dump
(
p
, " deçuÉ index 0x%04x", 
dsm¬k
->
qdm_deçuÉ_šdex
);

117 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_SET_TC_INDEX
)

118 
	`Æ_dump
(
p
, " set-tc-index");

119 
	}
}

121 
	$dsm¬k_şass_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

122 
Æ_dump_·¿ms
 *
p
)

124 
¹Æ_dsm¬k_şass
 *
dsm¬k
 = 
d©a
;

126 ià(!
dsm¬k
)

129 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_VALUE
)

130 
	`Æ_dump
(
p
, " v®u0x%02x", 
dsm¬k
->
cdm_v®ue
);

132 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_MASK
)

133 
	`Æ_dump
(
p
, " mask 0x%02x", 
dsm¬k
->
cdm_bmask
);

134 
	}
}

136 
	$dsm¬k_qdisc_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
,

137 
Æ_msg
 *
msg
)

139 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
 = 
d©a
;

141 ià(!
dsm¬k
)

144 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_INDICES
)

145 
	`NLA_PUT_U16
(
msg
, 
TCA_DSMARK_INDICES
, 
dsm¬k
->
qdm_šdiûs
);

147 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_DEFAULT_INDEX
)

148 
	`NLA_PUT_U16
(
msg
, 
TCA_DSMARK_DEFAULT_INDEX
,

149 
dsm¬k
->
qdm_deçuÉ_šdex
);

151 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_SET_TC_INDEX
)

152 
	`NLA_PUT_FLAG
(
msg
, 
TCA_DSMARK_SET_TC_INDEX
);

156 
Æa_put_çu»
:

157  -
NLE_MSGSIZE
;

158 
	}
}

160 
	$dsm¬k_şass_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
,

161 
Æ_msg
 *
msg
)

163 
¹Æ_dsm¬k_şass
 *
dsm¬k
 = 
d©a
;

165 ià(!
dsm¬k
)

168 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_MASK
)

169 
	`NLA_PUT_U8
(
msg
, 
TCA_DSMARK_MASK
, 
dsm¬k
->
cdm_bmask
);

171 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_VALUE
)

172 
	`NLA_PUT_U8
(
msg
, 
TCA_DSMARK_VALUE
, 
dsm¬k
->
cdm_v®ue
);

176 
Æa_put_çu»
:

177  -
NLE_MSGSIZE
;

178 
	}
}

191 
	$¹Æ_şass_dsm¬k_£t_b™mask
(
¹Æ_şass
 *
şass
, 
ušt8_t
 
mask
)

193 
¹Æ_dsm¬k_şass
 *
dsm¬k
;

195 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şass
))))

196  -
NLE_NOMEM
;

198 
dsm¬k
->
cdm_bmask
 = 
mask
;

199 
dsm¬k
->
cdm_mask
 |ğ
SCH_DSMARK_ATTR_MASK
;

202 
	}
}

209 
	$¹Æ_şass_dsm¬k_g‘_b™mask
(
¹Æ_şass
 *
şass
)

211 
¹Æ_dsm¬k_şass
 *
dsm¬k
;

213 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şass
))))

214  -
NLE_NOMEM
;

216 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_MASK
)

217  
dsm¬k
->
cdm_bmask
;

219  -
NLE_NOATTR
;

220 
	}
}

228 
	$¹Æ_şass_dsm¬k_£t_v®ue
(
¹Æ_şass
 *
şass
, 
ušt8_t
 
v®ue
)

230 
¹Æ_dsm¬k_şass
 *
dsm¬k
;

232 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şass
))))

233  -
NLE_NOMEM
;

235 
dsm¬k
->
cdm_v®ue
 = 
v®ue
;

236 
dsm¬k
->
cdm_mask
 |ğ
SCH_DSMARK_ATTR_VALUE
;

239 
	}
}

246 
	$¹Æ_şass_dsm¬k_g‘_v®ue
(
¹Æ_şass
 *
şass
)

248 
¹Æ_dsm¬k_şass
 *
dsm¬k
;

250 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
şass
))))

251  -
NLE_NOMEM
;

253 ià(
dsm¬k
->
cdm_mask
 & 
SCH_DSMARK_ATTR_VALUE
)

254  
dsm¬k
->
cdm_v®ue
;

256  -
NLE_NOATTR
;

257 
	}
}

271 
	$¹Æ_qdisc_dsm¬k_£t_šdiûs
(
¹Æ_qdisc
 *
qdisc
, 
ušt16_t
 
šdiûs
)

273 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

275 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

276  -
NLE_NOMEM
;

278 
dsm¬k
->
qdm_šdiûs
 = 
šdiûs
;

279 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_INDICES
;

282 
	}
}

289 
	$¹Æ_qdisc_dsm¬k_g‘_šdiûs
(
¹Æ_qdisc
 *
qdisc
)

291 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

293 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

294  -
NLE_NOMEM
;

296 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_INDICES
)

297  
dsm¬k
->
qdm_šdiûs
;

299  -
NLE_NOATTR
;

300 
	}
}

308 
	$¹Æ_qdisc_dsm¬k_£t_deçuÉ_šdex
(
¹Æ_qdisc
 *
qdisc
,

309 
ušt16_t
 
deçuÉ_šdex
)

311 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

313 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

314  -
NLE_NOMEM
;

316 
dsm¬k
->
qdm_deçuÉ_šdex
 = 
deçuÉ_šdex
;

317 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_DEFAULT_INDEX
;

320 
	}
}

327 
	$¹Æ_qdisc_dsm¬k_g‘_deçuÉ_šdex
(
¹Æ_qdisc
 *
qdisc
)

329 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

331 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

332  -
NLE_NOMEM
;

334 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_DEFAULT_INDEX
)

335  
dsm¬k
->
qdm_deçuÉ_šdex
;

337  -
NLE_NOATTR
;

338 
	}
}

346 
	$¹Æ_qdisc_dsm¬k_£t_£t_tc_šdex
(
¹Æ_qdisc
 *
qdisc
, 
æag
)

348 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

350 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

351  -
NLE_NOMEM
;

353 
dsm¬k
->
qdm_£t_tc_šdex
 = !!
æag
;

354 
dsm¬k
->
qdm_mask
 |ğ
SCH_DSMARK_ATTR_SET_TC_INDEX
;

357 
	}
}

365 
	$¹Æ_qdisc_dsm¬k_g‘_£t_tc_šdex
(
¹Æ_qdisc
 *
qdisc
)

367 
¹Æ_dsm¬k_qdisc
 *
dsm¬k
;

369 ià(!(
dsm¬k
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

370  -
NLE_NOMEM
;

372 ià(
dsm¬k
->
qdm_mask
 & 
SCH_DSMARK_ATTR_SET_TC_INDEX
)

373  
dsm¬k
->
qdm_£t_tc_šdex
;

375  -
NLE_NOATTR
;

376 
	}
}

380 
¹Æ_tc_İs
 
	gdsm¬k_qdisc_İs
 = {

381 .
to_kšd
 = "dsmark",

382 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

383 .
	gto_size
 = (
¹Æ_dsm¬k_qdisc
),

384 .
	gto_msg_·r£r
 = 
dsm¬k_qdisc_msg_·r£r
,

385 .
	gto_dump
 = {

386 [
NL_DUMP_LINE
] = 
dsm¬k_qdisc_dump_lše
,

387 [
NL_DUMP_DETAILS
] = 
dsm¬k_qdisc_dump_d‘as
,

389 .
	gto_msg_fl
 = 
dsm¬k_qdisc_msg_fl
,

392 
¹Æ_tc_İs
 
	gdsm¬k_şass_İs
 = {

393 .
to_kšd
 = "dsmark",

394 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLASS
,

395 .
	gto_size
 = (
¹Æ_dsm¬k_şass
),

396 .
	gto_msg_·r£r
 = 
dsm¬k_şass_msg_·r£r
,

397 .
	gto_dump
[
NL_DUMP_LINE
] = 
dsm¬k_şass_dump_lše
,

398 .
	gto_msg_fl
 = 
dsm¬k_şass_msg_fl
,

401 
__š™
 
	$dsm¬k_š™
()

403 
	`¹Æ_tc_»gi¡”
(&
dsm¬k_qdisc_İs
);

404 
	`¹Æ_tc_»gi¡”
(&
dsm¬k_şass_İs
);

405 
	}
}

407 
__ex™
 
	$dsm¬k_ex™
()

409 
	`¹Æ_tc_uÄegi¡”
(&
dsm¬k_qdisc_İs
);

410 
	`¹Æ_tc_uÄegi¡”
(&
dsm¬k_şass_İs
);

411 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/fifo.c

32 
	~<Ãšk-´iv©e/Ãšk.h
>

33 
	~<Ãšk-´iv©e/tc.h
>

34 
	~<Ãšk/Ãšk.h
>

35 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

36 
	~<Ãšk/rou‹/qdisc.h
>

37 
	~<Ãšk/rou‹/qdisc/fifo.h
>

38 
	~<Ãšk/uts.h
>

41 
	#SCH_FIFO_ATTR_LIMIT
 1

	)

44 
	$fifo_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

46 
¹Æ_fifo
 *
fifo
 = 
d©a
;

47 
tc_fifo_qİt
 *
İt
;

49 ià(
tc
->
tc_İts
->
d_size
 < (
tc_fifo_qİt
))

50  -
NLE_INVAL
;

52 
İt
 = (
tc_fifo_qİt
 *è
tc
->
tc_İts
->
d_d©a
;

53 
fifo
->
qf_lim™
 = 
İt
->
lim™
;

54 
fifo
->
qf_mask
 = 
SCH_FIFO_ATTR_LIMIT
;

57 
	}
}

59 
	$pfifo_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

60 
Æ_dump_·¿ms
 *
p
)

62 
¹Æ_fifo
 *
fifo
 = 
d©a
;

64 ià(
fifo
)

65 
	`Æ_dump
(
p
, "†im™ %u…ack‘s", 
fifo
->
qf_lim™
);

66 
	}
}

68 
	$bfifo_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

69 
Æ_dump_·¿ms
 *
p
)

71 
¹Æ_fifo
 *
fifo
 = 
d©a
;

72 *
un™
;

73 
r
;

75 ià(!
fifo
)

78 
r
 = 
	`Æ_ÿnûl_down_by‹s
(
fifo
->
qf_lim™
, &
un™
);

79 
	`Æ_dump
(
p
, "†im™ %.1f%s", 
r
, 
un™
);

80 
	}
}

82 
	$fifo_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

84 
¹Æ_fifo
 *
fifo
 = 
d©a
;

85 
tc_fifo_qİt
 
İts
 = {0};

87 ià(!
fifo
 || !(fifo->
qf_mask
 & 
SCH_FIFO_ATTR_LIMIT
))

88  -
NLE_INVAL
;

90 
İts
.
lim™
 = 
fifo
->
qf_lim™
;

92  
	`Æmsg_­³nd
(
msg
, &
İts
, (İts), 
NL_DONTPAD
);

93 
	}
}

106 
	$¹Æ_qdisc_fifo_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

108 
¹Æ_fifo
 *
fifo
;

110 ià(!(
fifo
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

111  -
NLE_NOMEM
;

113 
fifo
->
qf_lim™
 = 
lim™
;

114 
fifo
->
qf_mask
 |ğ
SCH_FIFO_ATTR_LIMIT
;

117 
	}
}

124 
	$¹Æ_qdisc_fifo_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

126 
¹Æ_fifo
 *
fifo
;

128 ià(!(
fifo
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

129  -
NLE_NOMEM
;

131 ià(
fifo
->
qf_mask
 & 
SCH_FIFO_ATTR_LIMIT
)

132  
fifo
->
qf_lim™
;

134  -
NLE_NOATTR
;

135 
	}
}

139 
¹Æ_tc_İs
 
	gpfifo_İs
 = {

140 .
to_kšd
 = "pfifo",

141 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

142 .
	gto_size
 = (
¹Æ_fifo
),

143 .
	gto_msg_·r£r
 = 
fifo_msg_·r£r
,

144 .
	gto_dump
[
NL_DUMP_LINE
] = 
pfifo_dump_lše
,

145 .
	gto_msg_fl
 = 
fifo_msg_fl
,

148 
¹Æ_tc_İs
 
	gbfifo_İs
 = {

149 .
to_kšd
 = "bfifo",

150 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

151 .
	gto_size
 = (
¹Æ_fifo
),

152 .
	gto_msg_·r£r
 = 
fifo_msg_·r£r
,

153 .
	gto_dump
[
NL_DUMP_LINE
] = 
bfifo_dump_lše
,

154 .
	gto_msg_fl
 = 
fifo_msg_fl
,

157 
__š™
 
	$fifo_š™
()

159 
	`¹Æ_tc_»gi¡”
(&
pfifo_İs
);

160 
	`¹Æ_tc_»gi¡”
(&
bfifo_İs
);

161 
	}
}

163 
__ex™
 
	$fifo_ex™
()

165 
	`¹Æ_tc_uÄegi¡”
(&
pfifo_İs
);

166 
	`¹Æ_tc_uÄegi¡”
(&
bfifo_İs
);

167 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/fq_codel.c

20 
	~<Ãšk-´iv©e/Ãšk.h
>

21 
	~<Ãšk-´iv©e/tc.h
>

22 
	~<Ãšk/Ãšk.h
>

23 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

24 
	~<Ãšk/rou‹/qdisc.h
>

25 
	~<Ãšk/rou‹/qdisc/fq_cod–.h
>

26 
	~<Ãšk/uts.h
>

29 
	#SCH_FQ_CODEL_ATTR_TARGET
 0x1

	)

30 
	#SCH_FQ_CODEL_ATTR_LIMIT
 0x2

	)

31 
	#SCH_FQ_CODEL_ATTR_INTERVAL
 0x4

	)

32 
	#SCH_FQ_CODEL_ATTR_FLOWS
 0x8

	)

33 
	#SCH_FQ_CODEL_ATTR_QUANTUM
 0x10

	)

34 
	#SCH_FQ_CODEL_ATTR_ECN
 0x20

	)

37 
Æa_pŞicy
 
	gfq_cod–_pŞicy
[
TCA_FQ_CODEL_MAX
 + 1] = {

38 [
TCA_FQ_CODEL_TARGET
] = { .
ty³
 = 
NLA_U32
 },

39 [
TCA_FQ_CODEL_LIMIT
] = { .
ty³
 = 
NLA_U32
 },

40 [
TCA_FQ_CODEL_INTERVAL
] = { .
ty³
 = 
NLA_U32
 },

41 [
TCA_FQ_CODEL_ECN
] = { .
ty³
 = 
NLA_U32
 },

42 [
TCA_FQ_CODEL_FLOWS
] = { .
ty³
 = 
NLA_U32
 },

43 [
TCA_FQ_CODEL_QUANTUM
] = { .
ty³
 = 
NLA_U32
 },

46 
	$fq_cod–_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

48 
¹Æ_fq_cod–
 *
fq_cod–
 = 
d©a
;

49 
Æ©Œ
 *
tb
[
TCA_FQ_CODEL_MAX
 + 1];

50 
”r
;

52 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_FQ_CODEL_MAX
, 
tc
, 
fq_cod–_pŞicy
);

53 ià(
”r
 < 0)

54  
”r
;

56 ià(
tb
[
TCA_FQ_CODEL_TARGET
]) {

57 
fq_cod–
->
fq_rg‘
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_TARGET
]);

58 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_TARGET
;

61 ià(
tb
[
TCA_FQ_CODEL_INTERVAL
]) {

62 
fq_cod–
->
fq_š‹rv®
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_INTERVAL
]);

63 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_INTERVAL
;

66 ià(
tb
[
TCA_FQ_CODEL_LIMIT
]) {

67 
fq_cod–
->
fq_lim™
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_LIMIT
]);

68 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_LIMIT
;

71 ià(
tb
[
TCA_FQ_CODEL_QUANTUM
]) {

72 
fq_cod–
->
fq_quªtum
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_QUANTUM
]);

73 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_QUANTUM
;

76 ià(
tb
[
TCA_FQ_CODEL_FLOWS
]) {

77 
fq_cod–
->
fq_æows
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_FLOWS
]);

78 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_FLOWS
;

81 ià(
tb
[
TCA_FQ_CODEL_ECN
]) {

82 
fq_cod–
->
fq_eú
 = 
	`Æa_g‘_u32
(
tb
[
TCA_FQ_CODEL_ECN
]);

83 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_ECN
;

87 
	}
}

89 
	$fq_cod–_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

90 
Æ_dump_·¿ms
 *
p
)

92 
¹Æ_fq_cod–
 *
fq_cod–
 = 
d©a
;

94 ià(!
fq_cod–
)

97 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_LIMIT
)

98 
	`Æ_dump
(
p
, "†im™ %u…ack‘s", 
fq_cod–
->
fq_lim™
);

99 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_TARGET
)

100 
	`Æ_dump
(
p
, "¬g‘ %u", 
fq_cod–
->
fq_rg‘
);

101 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_INTERVAL
)

102 
	`Æ_dump
(
p
, " iÁ”v® %u", 
fq_cod–
->
fq_š‹rv®
);

103 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_ECN
)

104 
	`Æ_dump
(
p
, "ƒú %u", 
fq_cod–
->
fq_eú
);

105 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_FLOWS
)

106 
	`Æ_dump
(
p
, " flow %u", 
fq_cod–
->
fq_æows
);

107 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_QUANTUM
)

108 
	`Æ_dump
(
p
, " quªtum %u", 
fq_cod–
->
fq_quªtum
);

109 
	}
}

111 
	$fq_cod–_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

113 
¹Æ_fq_cod–
 *
fq_cod–
 = 
d©a
;

115 ià(!
fq_cod–
)

116  -
NLE_INVAL
;

118 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_LIMIT
)

119 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_LIMIT
, 
fq_cod–
->
fq_lim™
);

120 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_INTERVAL
)

121 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_INTERVAL
, 
fq_cod–
->
fq_š‹rv®
);

122 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_TARGET
)

123 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_TARGET
, 
fq_cod–
->
fq_rg‘
);

124 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_QUANTUM
)

125 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_QUANTUM
, 
fq_cod–
->
fq_quªtum
);

126 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_FLOWS
)

127 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_FLOWS
, 
fq_cod–
->
fq_æows
);

128 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_ECN
)

129 
	`NLA_PUT_U32
(
msg
, 
TCA_FQ_CODEL_ECN
, 
fq_cod–
->
fq_eú
);

132 
Æa_put_çu»
:

133  -
NLE_MSGSIZE
;

135 
	}
}

148 
	$¹Æ_qdisc_fq_cod–_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

150 
¹Æ_fq_cod–
 *
fq_cod–
;

152 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

153  -
NLE_NOMEM
;

155 
fq_cod–
->
fq_lim™
 = 
lim™
;

156 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_LIMIT
;

159 
	}
}

166 
	$¹Æ_qdisc_fq_cod–_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

168 
¹Æ_fq_cod–
 *
fq_cod–
;

170 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

171  -
NLE_NOMEM
;

173 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_LIMIT
)

174  
fq_cod–
->
fq_lim™
;

176  -
NLE_NOATTR
;

177 
	}
}

185 
	$¹Æ_qdisc_fq_cod–_£t_rg‘
(
¹Æ_qdisc
 *
qdisc
, 
ušt32_t
 
rg‘
)

187 
¹Æ_fq_cod–
 *
fq_cod–
;

189 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

190  -
NLE_NOMEM
;

192 
fq_cod–
->
fq_rg‘
 = 
rg‘
;

193 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_TARGET
;

196 
	}
}

203 
ušt32_t
 
	$¹Æ_qdisc_fq_cod–_g‘_rg‘
(
¹Æ_qdisc
 *
qdisc
)

205 
¹Æ_fq_cod–
 *
fq_cod–
;

207 ià((
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))) &&

208 
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_TARGET
)

209  
fq_cod–
->
fq_rg‘
;

212 
	}
}

220 
	$¹Æ_qdisc_fq_cod–_£t_š‹rv®
(
¹Æ_qdisc
 *
qdisc
, 
ušt32_t
 
š‹rv®
)

222 
¹Æ_fq_cod–
 *
fq_cod–
;

224 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

225  -
NLE_NOMEM
;

227 
fq_cod–
->
fq_š‹rv®
 = 
š‹rv®
;

228 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_INTERVAL
;

231 
	}
}

238 
ušt32_t
 
	$¹Æ_qdisc_fq_cod–_g‘_š‹rv®
(
¹Æ_qdisc
 *
qdisc
)

240 
¹Æ_fq_cod–
 *
fq_cod–
;

242 ià((
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))) &&

243 
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_INTERVAL
)

244  
fq_cod–
->
fq_š‹rv®
;

247 
	}
}

255 
	$¹Æ_qdisc_fq_cod–_£t_quªtum
(
¹Æ_qdisc
 *
qdisc
, 
ušt32_t
 
quªtum
)

257 
¹Æ_fq_cod–
 *
fq_cod–
;

259 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

260  -
NLE_NOMEM
;

262 
fq_cod–
->
fq_quªtum
 = 
quªtum
;

263 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_QUANTUM
;

266 
	}
}

273 
ušt32_t
 
	$¹Æ_qdisc_fq_cod–_g‘_quªtum
(
¹Æ_qdisc
 *
qdisc
)

275 
¹Æ_fq_cod–
 *
fq_cod–
;

277 ià((
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))) &&

278 (
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_QUANTUM
))

279  
fq_cod–
->
fq_quªtum
;

282 
	}
}

290 
	$¹Æ_qdisc_fq_cod–_£t_æows
(
¹Æ_qdisc
 *
qdisc
, 
æows
)

292 
¹Æ_fq_cod–
 *
fq_cod–
;

294 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

295  -
NLE_NOMEM
;

297 
fq_cod–
->
fq_æows
 = 
æows
;

298 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_FLOWS
;

301 
	}
}

308 
	$¹Æ_qdisc_fq_cod–_g‘_æows
(
¹Æ_qdisc
 *
qdisc
)

310 
¹Æ_fq_cod–
 *
fq_cod–
;

312 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

313  -
NLE_NOMEM
;

315 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_FLOWS
)

316  
fq_cod–
->
fq_æows
;

318  -
NLE_NOATTR
;

319 
	}
}

326 
	$¹Æ_qdisc_fq_cod–_£t_eú
(
¹Æ_qdisc
 *
qdisc
, 
eú
)

328 
¹Æ_fq_cod–
 *
fq_cod–
;

330 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

331  -
NLE_NOMEM
;

333 
fq_cod–
->
fq_eú
 = 
eú
;

334 
fq_cod–
->
fq_mask
 |ğ
SCH_FQ_CODEL_ATTR_ECN
;

337 
	}
}

344 
	$¹Æ_qdisc_fq_cod–_g‘_eú
(
¹Æ_qdisc
 *
qdisc
)

346 
¹Æ_fq_cod–
 *
fq_cod–
;

348 ià(!(
fq_cod–
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

349  -
NLE_NOMEM
;

351 ià(
fq_cod–
->
fq_mask
 & 
SCH_FQ_CODEL_ATTR_ECN
)

352  
fq_cod–
->
fq_eú
;

354  -
NLE_NOATTR
;

355 
	}
}

358 
¹Æ_tc_İs
 
	gfq_cod–_İs
 = {

359 .
to_kšd
 = "fq_codel",

360 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

361 .
	gto_size
 = (
¹Æ_fq_cod–
),

362 .
	gto_msg_·r£r
 = 
fq_cod–_msg_·r£r
,

363 .
	gto_dump
[
NL_DUMP_LINE
] = 
fq_cod–_dump_lše
,

364 .
	gto_msg_fl
 = 
fq_cod–_msg_fl
,

367 
__š™
 
	$fq_cod–_š™
()

369 
	`¹Æ_tc_»gi¡”
(&
fq_cod–_İs
);

370 
	}
}

372 
__ex™
 
	$fq_cod–_ex™
()

374 
	`¹Æ_tc_uÄegi¡”
(&
fq_cod–_İs
);

375 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/htb.c

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk-´iv©e/tc.h
>

23 
	~<Ãšk/Ãšk.h
>

24 
	~<Ãšk/ÿche.h
>

25 
	~<Ãšk/uts.h
>

26 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

27 
	~<Ãšk/rou‹/qdisc.h
>

28 
	~<Ãšk/rou‹/şass.h
>

29 
	~<Ãšk/rou‹/lšk.h
>

30 
	~<Ãšk/rou‹/qdisc/htb.h
>

33 
	#SCH_HTB_HAS_RATE2QUANTUM
 0x01

	)

34 
	#SCH_HTB_HAS_DEFCLS
 0x02

	)

36 
	#SCH_HTB_HAS_PRIO
 0x001

	)

37 
	#SCH_HTB_HAS_RATE
 0x002

	)

38 
	#SCH_HTB_HAS_CEIL
 0x004

	)

39 
	#SCH_HTB_HAS_RBUFFER
 0x008

	)

40 
	#SCH_HTB_HAS_CBUFFER
 0x010

	)

41 
	#SCH_HTB_HAS_QUANTUM
 0x020

	)

42 
	#SCH_HTB_HAS_LEVEL
 0x040

	)

45 
Æa_pŞicy
 
	ghtb_pŞicy
[
TCA_HTB_MAX
+1] = {

46 [
TCA_HTB_INIT
] = { .
mšËn
 = (
tc_htb_glob
) },

47 [
TCA_HTB_PARMS
] = { .
mšËn
 = (
tc_htb_İt
) },

50 
	$htb_qdisc_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

52 
Æ©Œ
 *
tb
[
TCA_HTB_MAX
 + 1];

53 
¹Æ_htb_qdisc
 *
htb
 = 
d©a
;

54 
”r
;

56 ià((
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_HTB_MAX
, 
tc
, 
htb_pŞicy
)) < 0)

57  
”r
;

59 ià(
tb
[
TCA_HTB_INIT
]) {

60 
tc_htb_glob
 
İts
;

62 
	`Æa_memıy
(&
İts
, 
tb
[
TCA_HTB_INIT
], (opts));

63 
htb
->
qh_¿‹2quªtum
 = 
İts
.
¿‹2quªtum
;

64 
htb
->
qh_defşs
 = 
İts
.
defşs
;

65 
htb
->
qh_dœeù_pkts
 = 
İts
.
dœeù_pkts
;

67 
htb
->
qh_mask
 = (
SCH_HTB_HAS_RATE2QUANTUM
 | 
SCH_HTB_HAS_DEFCLS
);

71 
	}
}

73 
	$htb_şass_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

75 
Æ©Œ
 *
tb
[
TCA_HTB_MAX
 + 1];

76 
¹Æ_htb_şass
 *
htb
 = 
d©a
;

77 
”r
;

79 ià((
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_HTB_MAX
, 
tc
, 
htb_pŞicy
)) < 0)

80  
”r
;

82 ià(
tb
[
TCA_HTB_PARMS
]) {

83 
tc_htb_İt
 
İts
;

85 
	`Æa_memıy
(&
İts
, 
tb
[
TCA_HTB_PARMS
], (opts));

86 
htb
->
ch_´io
 = 
İts
.
´io
;

87 
	`¹Æ_cİy_¿‹¥ec
(&
htb
->
ch_¿‹
, &
İts
.
¿‹
);

88 
	`¹Æ_cİy_¿‹¥ec
(&
htb
->
ch_û
, &
İts
.
û
);

89 
htb
->
ch_rbufãr
 = 
	`¹Æ_tc_ÿlc_bufsize
(
	`Æ_ticks2us
(
İts
.
bufãr
),

90 
İts
.
¿‹
.rate);

91 
htb
->
ch_cbufãr
 = 
	`¹Æ_tc_ÿlc_bufsize
(
	`Æ_ticks2us
(
İts
.
cbufãr
),

92 
İts
.
û
.
¿‹
);

93 
htb
->
ch_quªtum
 = 
İts
.
quªtum
;

94 
htb
->
ch_Ëv–
 = 
İts
.
Ëv–
;

96 
	`¹Æ_tc_£t_mpu
(
tc
, 
htb
->
ch_¿‹
.
rs_mpu
);

97 
	`¹Æ_tc_£t_ov”h—d
(
tc
, 
htb
->
ch_¿‹
.
rs_ov”h—d
);

99 
htb
->
ch_mask
 = (
SCH_HTB_HAS_PRIO
 | 
SCH_HTB_HAS_RATE
 |

100 
SCH_HTB_HAS_CEIL
 | 
SCH_HTB_HAS_RBUFFER
 |

101 
SCH_HTB_HAS_CBUFFER
 | 
SCH_HTB_HAS_QUANTUM
 |

102 
SCH_HTB_HAS_LEVEL
);

106 
	}
}

108 
	$htb_qdisc_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

109 
Æ_dump_·¿ms
 *
p
)

111 
¹Æ_htb_qdisc
 *
htb
 = 
d©a
;

113 ià(!
htb
)

116 ià(
htb
->
qh_mask
 & 
SCH_HTB_HAS_RATE2QUANTUM
)

117 
	`Æ_dump
(
p
, "„2q %u", 
htb
->
qh_¿‹2quªtum
);

119 ià(
htb
->
qh_mask
 & 
SCH_HTB_HAS_DEFCLS
) {

120 
buf
[64];

121 
	`Æ_dump
(
p
, " default-class %s",

122 
	`¹Æ_tc_hªdË2¡r
(
htb
->
qh_defşs
, 
buf
, (buf)));

124 
	}
}

126 
	$htb_şass_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

127 
Æ_dump_·¿ms
 *
p
)

129 
¹Æ_htb_şass
 *
htb
 = 
d©a
;

131 ià(!
htb
)

134 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_RATE
) {

135 
r
, 
rb™
;

136 *
ru
, *
rub™
;

138 
r
 = 
	`Æ_ÿnûl_down_by‹s
(
htb
->
ch_¿‹
.
rs_¿‹
, &
ru
);

139 
rb™
 = 
	`Æ_ÿnûl_down_b™s
(
htb
->
ch_¿‹
.
rs_¿‹
*8, &
rub™
);

141 
	`Æ_dump
(
p
, "„ate %.2f%s/s (%.0f%s)†og %u",

142 
r
, 
ru
, 
rb™
, 
rub™
, 1<<
htb
->
ch_¿‹
.
rs_ûÎ_log
);

144 
	}
}

146 
	$htb_şass_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

147 
Æ_dump_·¿ms
 *
p
)

149 
¹Æ_htb_şass
 *
htb
 = 
d©a
;

151 ià(!
htb
)

155 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_CEIL
) {

156 
r
, 
rb™
;

157 *
ru
, *
rub™
;

159 
r
 = 
	`Æ_ÿnûl_down_by‹s
(
htb
->
ch_û
.
rs_¿‹
, &
ru
);

160 
rb™
 = 
	`Æ_ÿnûl_down_b™s
(
htb
->
ch_û
.
rs_¿‹
*8, &
rub™
);

162 
	`Æ_dump
(
p
, " ceil %.2f%s/s (%.0f%s)†og %u",

163 
r
, 
ru
, 
rb™
, 
rub™
, 1<<
htb
->
ch_û
.
rs_ûÎ_log
);

166 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_PRIO
)

167 
	`Æ_dump
(
p
, "…riØ%u", 
htb
->
ch_´io
);

169 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_RBUFFER
) {

170 
b
;

171 *
bu
;

173 
b
 = 
	`Æ_ÿnûl_down_by‹s
(
htb
->
ch_rbufãr
, &
bu
);

174 
	`Æ_dump
(
p
, "„bufã¸%.2f%s", 
b
, 
bu
);

177 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_CBUFFER
) {

178 
b
;

179 *
bu
;

181 
b
 = 
	`Æ_ÿnûl_down_by‹s
(
htb
->
ch_cbufãr
, &
bu
);

182 
	`Æ_dump
(
p
, " cbufã¸%.2f%s", 
b
, 
bu
);

185 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_QUANTUM
)

186 
	`Æ_dump
(
p
, " quªtum %u", 
htb
->
ch_quªtum
);

187 
	}
}

189 
	$htb_qdisc_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
,

190 
Æ_msg
 *
msg
)

192 
¹Æ_htb_qdisc
 *
htb
 = 
d©a
;

193 
tc_htb_glob
 
İts
 = {

194 .
v”siÚ
 = 
TC_HTB_PROTOVER
,

195 .
¿‹2quªtum
 = 10,

198 ià(
htb
) {

199 ià(
htb
->
qh_mask
 & 
SCH_HTB_HAS_RATE2QUANTUM
)

200 
İts
.
¿‹2quªtum
 = 
htb
->
qh_¿‹2quªtum
;

202 ià(
htb
->
qh_mask
 & 
SCH_HTB_HAS_DEFCLS
)

203 
İts
.
defşs
 = 
htb
->
qh_defşs
;

206  
	`Æa_put
(
msg
, 
TCA_HTB_INIT
, (
İts
), &opts);

207 
	}
}

209 
	$htb_şass_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
,

210 
Æ_msg
 *
msg
)

212 
¹Æ_htb_şass
 *
htb
 = 
d©a
;

213 
ušt32_t
 
mtu
, 
¹abË
[
RTNL_TC_RTABLE_SIZE
], 
ùabË
[RTNL_TC_RTABLE_SIZE];

214 
tc_htb_İt
 
İts
;

215 
bufãr
, 
cbufãr
;

217 ià(!
htb
 || !(htb->
ch_mask
 & 
SCH_HTB_HAS_RATE
))

218 
	`BUG
();

220 
	`mem£t
(&
İts
, 0, (opts));

223 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_PRIO
)

224 
İts
.
´io
 = 
htb
->
ch_´io
;

226 
mtu
 = 
	`¹Æ_tc_g‘_mtu
(
tc
);

228 
	`¹Æ_tc_bud_¿‹_bË
(
tc
, &
htb
->
ch_¿‹
, 
¹abË
);

229 
	`¹Æ_rcİy_¿‹¥ec
(&
İts
.
¿‹
, &
htb
->
ch_¿‹
);

231 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_CEIL
) {

232 
	`¹Æ_tc_bud_¿‹_bË
(
tc
, &
htb
->
ch_û
, 
ùabË
);

233 
	`¹Æ_rcİy_¿‹¥ec
(&
İts
.
û
, &
htb
->
ch_û
);

239 
	`memıy
(&
İts
.
û
, &İts.
¿‹
, (
tc_¿‹¥ec
));

242 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_RBUFFER
)

243 
bufãr
 = 
htb
->
ch_rbufãr
;

245 
bufãr
 = 
İts
.
¿‹
.¿‹ / 
	`Æ_g‘_psched_hz
(è+ 
mtu
;

247 
İts
.
bufãr
 = 
	`Æ_us2ticks
(
	`¹Æ_tc_ÿlc_txtime
(bufãr, o±s.
¿‹
.rate));

249 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_CBUFFER
)

250 
cbufãr
 = 
htb
->
ch_cbufãr
;

252 
cbufãr
 = 
İts
.
û
.
¿‹
 / 
	`Æ_g‘_psched_hz
(è+ 
mtu
;

254 
İts
.
cbufãr
 = 
	`Æ_us2ticks
(
	`¹Æ_tc_ÿlc_txtime
(cbufãr, o±s.
û
.
¿‹
));

256 ià(
htb
->
ch_mask
 & 
SCH_HTB_HAS_QUANTUM
)

257 
İts
.
quªtum
 = 
htb
->
ch_quªtum
;

259 
	`NLA_PUT
(
msg
, 
TCA_HTB_PARMS
, (
İts
), &opts);

260 
	`NLA_PUT
(
msg
, 
TCA_HTB_RTAB
, (
¹abË
), &rtable);

261 
	`NLA_PUT
(
msg
, 
TCA_HTB_CTAB
, (
ùabË
), &ctable);

265 
Æa_put_çu»
:

266  -
NLE_MSGSIZE
;

267 
	}
}

269 
¹Æ_tc_İs
 
	ghtb_qdisc_İs
;

270 
¹Æ_tc_İs
 
	ghtb_şass_İs
;

272 
¹Æ_htb_qdisc
 *
	$htb_qdisc_d©a
(
¹Æ_qdisc
 *
qdisc
)

274  
	`¹Æ_tc_d©a_check
(
	`TC_CAST
(
qdisc
), &
htb_qdisc_İs
);

275 
	}
}

277 
¹Æ_htb_şass
 *
	$htb_şass_d©a
(
¹Æ_şass
 *
şass
)

279  
	`¹Æ_tc_d©a_check
(
	`TC_CAST
(
şass
), &
htb_şass_İs
);

280 
	}
}

293 
ušt32_t
 
	$¹Æ_htb_g‘_¿‹2quªtum
(
¹Æ_qdisc
 *
qdisc
)

295 
¹Æ_htb_qdisc
 *
htb
;

297 ià((
htb
 = 
	`htb_qdisc_d©a
(
qdisc
)) &&

298 
htb
->
qh_mask
 & 
SCH_HTB_HAS_RATE2QUANTUM
)

299  
htb
->
qh_¿‹2quªtum
;

302 
	}
}

304 
	$¹Æ_htb_£t_¿‹2quªtum
(
¹Æ_qdisc
 *
qdisc
, 
ušt32_t
 
¿‹2quªtum
)

306 
¹Æ_htb_qdisc
 *
htb
;

308 ià(!(
htb
 = 
	`htb_qdisc_d©a
(
qdisc
)))

309  -
NLE_OPNOTSUPP
;

311 
htb
->
qh_¿‹2quªtum
 = 
¿‹2quªtum
;

312 
htb
->
qh_mask
 |ğ
SCH_HTB_HAS_RATE2QUANTUM
;

315 
	}
}

326 
ušt32_t
 
	$¹Æ_htb_g‘_defşs
(
¹Æ_qdisc
 *
qdisc
)

328 
¹Æ_htb_qdisc
 *
htb
;

330 ià((
htb
 = 
	`htb_qdisc_d©a
(
qdisc
)) &&

331 
htb
->
qh_mask
 & 
SCH_HTB_HAS_DEFCLS
)

332  
htb
->
qh_defşs
;

334  
TC_H_UNSPEC
;

335 
	}
}

342 
	$¹Æ_htb_£t_defşs
(
¹Æ_qdisc
 *
qdisc
, 
ušt32_t
 
defşs
)

344 
¹Æ_htb_qdisc
 *
htb
;

346 ià(!(
htb
 = 
	`htb_qdisc_d©a
(
qdisc
)))

347  -
NLE_OPNOTSUPP
;

349 
htb
->
qh_defşs
 = 
defşs
;

350 
htb
->
qh_mask
 |ğ
SCH_HTB_HAS_DEFCLS
;

353 
	}
}

355 
ušt32_t
 
	$¹Æ_htb_g‘_´io
(
¹Æ_şass
 *
şass
)

357 
¹Æ_htb_şass
 *
htb
;

359 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)è&& htb->
ch_mask
 & 
SCH_HTB_HAS_PRIO
)

360  
htb
->
ch_´io
;

363 
	}
}

365 
	$¹Æ_htb_£t_´io
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
´io
)

367 
¹Æ_htb_şass
 *
htb
;

369 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

370  -
NLE_OPNOTSUPP
;

372 
htb
->
ch_´io
 = 
´io
;

373 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_PRIO
;

376 
	}
}

384 
ušt32_t
 
	$¹Æ_htb_g‘_¿‹
(
¹Æ_şass
 *
şass
)

386 
¹Æ_htb_şass
 *
htb
;

388 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)è&& htb->
ch_mask
 & 
SCH_HTB_HAS_RATE
)

389  
htb
->
ch_¿‹
.
rs_¿‹
;

392 
	}
}

401 
	$¹Æ_htb_£t_¿‹
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
¿‹
)

403 
¹Æ_htb_şass
 *
htb
;

405 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

406  -
NLE_OPNOTSUPP
;

408 
htb
->
ch_¿‹
.
rs_ûÎ_log
 = 
UINT8_MAX
;

409 
htb
->
ch_¿‹
.
rs_¿‹
 = 
¿‹
;

410 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_RATE
;

413 
	}
}

421 
ušt32_t
 
	$¹Æ_htb_g‘_û
(
¹Æ_şass
 *
şass
)

423 
¹Æ_htb_şass
 *
htb
;

425 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)è&& htb->
ch_mask
 & 
SCH_HTB_HAS_CEIL
)

426  
htb
->
ch_û
.
rs_¿‹
;

429 
	}
}

438 
	$¹Æ_htb_£t_û
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
û
)

440 
¹Æ_htb_şass
 *
htb
;

442 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

443  -
NLE_OPNOTSUPP
;

445 
htb
->
ch_û
.
rs_ûÎ_log
 = 
UINT8_MAX
;

446 
htb
->
ch_û
.
rs_¿‹
 = 
û
;

447 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_CEIL
;

450 
	}
}

458 
ušt32_t
 
	$¹Æ_htb_g‘_rbufãr
(
¹Æ_şass
 *
şass
)

460 
¹Æ_htb_şass
 *
htb
;

462 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)) &&

463 
htb
->
ch_mask
 & 
SCH_HTB_HAS_RBUFFER
)

464  
htb
->
ch_rbufãr
;

467 
	}
}

474 
	$¹Æ_htb_£t_rbufãr
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
rbufãr
)

476 
¹Æ_htb_şass
 *
htb
;

478 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

479  -
NLE_OPNOTSUPP
;

481 
htb
->
ch_rbufãr
 = 
rbufãr
;

482 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_RBUFFER
;

485 
	}
}

493 
ušt32_t
 
	$¹Æ_htb_g‘_cbufãr
(
¹Æ_şass
 *
şass
)

495 
¹Æ_htb_şass
 *
htb
;

497 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)) &&

498 
htb
->
ch_mask
 & 
SCH_HTB_HAS_CBUFFER
)

499  
htb
->
ch_cbufãr
;

502 
	}
}

509 
	$¹Æ_htb_£t_cbufãr
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
cbufãr
)

511 
¹Æ_htb_şass
 *
htb
;

513 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

514  -
NLE_OPNOTSUPP
;

516 
htb
->
ch_cbufãr
 = 
cbufãr
;

517 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_CBUFFER
;

520 
	}
}

530 
ušt32_t
 
	$¹Æ_htb_g‘_quªtum
(
¹Æ_şass
 *
şass
)

532 
¹Æ_htb_şass
 *
htb
;

534 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)) &&

535 
htb
->
ch_mask
 & 
SCH_HTB_HAS_QUANTUM
)

536  
htb
->
ch_quªtum
;

539 
	}
}

550 
	$¹Æ_htb_£t_quªtum
(
¹Æ_şass
 *
şass
, 
ušt32_t
 
quªtum
)

552 
¹Æ_htb_şass
 *
htb
;

554 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

555  -
NLE_OPNOTSUPP
;

557 
htb
->
ch_quªtum
 = 
quªtum
;

558 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_QUANTUM
;

561 
	}
}

573 
	$¹Æ_htb_g‘_Ëv–
(
¹Æ_şass
 *
şass
)

575 
¹Æ_htb_şass
 *
htb
;

577 ià((
htb
 = 
	`htb_şass_d©a
(
şass
)è&& htb->
ch_mask
 & 
SCH_HTB_HAS_LEVEL
)

578  
htb
->
ch_Ëv–
;

580  -
NLE_OPNOTSUPP
;

581 
	}
}

595 
	$¹Æ_htb_£t_Ëv–
(
¹Æ_şass
 *
şass
, 
Ëv–
)

597 
¹Æ_htb_şass
 *
htb
;

599 ià(!(
htb
 = 
	`htb_şass_d©a
(
şass
)))

600  -
NLE_OPNOTSUPP
;

602 
htb
->
ch_Ëv–
 = 
Ëv–
;

603 
htb
->
ch_mask
 |ğ
SCH_HTB_HAS_LEVEL
;

606 
	}
}

610 
¹Æ_tc_İs
 
	ghtb_qdisc_İs
 = {

611 .
to_kšd
 = "htb",

612 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

613 .
	gto_size
 = (
¹Æ_htb_qdisc
),

614 .
	gto_msg_·r£r
 = 
htb_qdisc_msg_·r£r
,

615 .
	gto_dump
[
NL_DUMP_LINE
] = 
htb_qdisc_dump_lše
,

616 .
	gto_msg_fl
 = 
htb_qdisc_msg_fl
,

619 
¹Æ_tc_İs
 
	ghtb_şass_İs
 = {

620 .
to_kšd
 = "htb",

621 .
	gto_ty³
 = 
RTNL_TC_TYPE_CLASS
,

622 .
	gto_size
 = (
¹Æ_htb_şass
),

623 .
	gto_msg_·r£r
 = 
htb_şass_msg_·r£r
,

624 .
	gto_dump
 = {

625 [
NL_DUMP_LINE
] = 
htb_şass_dump_lše
,

626 [
NL_DUMP_DETAILS
] = 
htb_şass_dump_d‘as
,

628 .
	gto_msg_fl
 = 
htb_şass_msg_fl
,

631 
__š™
 
	$htb_š™
()

633 
	`¹Æ_tc_»gi¡”
(&
htb_qdisc_İs
);

634 
	`¹Æ_tc_»gi¡”
(&
htb_şass_İs
);

635 
	}
}

637 
__ex™
 
	$htb_ex™
()

639 
	`¹Æ_tc_uÄegi¡”
(&
htb_qdisc_İs
);

640 
	`¹Æ_tc_uÄegi¡”
(&
htb_şass_İs
);

641 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/ingress.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

23 
	~<Ãšk/rou‹/qdisc.h
>

24 
	~<Ãšk/uts.h
>

26 
	sdumb
 {

27 
ušt32_t
 
	mfoo
;

30 
	$dumb_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

33 
	}
}

35 
	$dumb_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

36 
Æ_dump_·¿ms
 *
p
)

38 
	}
}

40 
	$dumb_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

43 
	}
}

45 
¹Æ_tc_İs
 
	gšg»ss_İs
 = {

46 .
to_kšd
 = "ingress",

47 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

48 .
	gto_size
 = (
dumb
),

49 .
	gto_msg_·r£r
 = 
dumb_msg_·r£r
,

50 .
	gto_dump
[
NL_DUMP_LINE
] = 
dumb_dump_lše
,

51 .
	gto_msg_fl
 = 
dumb_msg_fl
,

54 
__š™
 
	$šg»ss_š™
()

56 
	`¹Æ_tc_»gi¡”
(&
šg»ss_İs
);

57 
	}
}

59 
__ex™
 
	$šg»ss_ex™
()

61 
	`¹Æ_tc_uÄegi¡”
(&
šg»ss_İs
);

62 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/netem.c

21 
	~<Ãšk-´iv©e/Ãšk.h
>

22 
	~<Ãšk-´iv©e/tc.h
>

23 
	~<Ãšk/Ãšk.h
>

24 
	~<Ãšk/uts.h
>

25 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

26 
	~<Ãšk/rou‹/qdisc.h
>

27 
	~<Ãšk/rou‹/qdisc/Ã‹m.h
>

30 
	#SCH_NETEM_ATTR_LATENCY
 0x0001

	)

31 
	#SCH_NETEM_ATTR_LIMIT
 0x0002

	)

32 
	#SCH_NETEM_ATTR_LOSS
 0x0004

	)

33 
	#SCH_NETEM_ATTR_GAP
 0x0008

	)

34 
	#SCH_NETEM_ATTR_DUPLICATE
 0x0010

	)

35 
	#SCH_NETEM_ATTR_JITTER
 0x0020

	)

36 
	#SCH_NETEM_ATTR_DELAY_CORR
 0x0040

	)

37 
	#SCH_NETEM_ATTR_LOSS_CORR
 0x0080

	)

38 
	#SCH_NETEM_ATTR_DUP_CORR
 0x0100

	)

39 
	#SCH_NETEM_ATTR_RO_PROB
 0x0200

	)

40 
	#SCH_NETEM_ATTR_RO_CORR
 0x0400

	)

41 
	#SCH_NETEM_ATTR_CORRUPT_PROB
 0x0800

	)

42 
	#SCH_NETEM_ATTR_CORRUPT_CORR
 0x1000

	)

43 
	#SCH_NETEM_ATTR_DIST
 0x2000

	)

46 
Æa_pŞicy
 
	gÃ‹m_pŞicy
[
TCA_NETEM_MAX
+1] = {

47 [
TCA_NETEM_CORR
] = { .
mšËn
 = (
tc_Ã‹m_cÜr
) },

48 [
TCA_NETEM_REORDER
] = { .
mšËn
 = (
tc_Ã‹m_»Üd”
) },

49 [
TCA_NETEM_CORRUPT
] = { .
mšËn
 = (
tc_Ã‹m_cÜru±
) },

52 
	$Ã‹m_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

54 
¹Æ_Ã‹m
 *
Ã‹m
 = 
d©a
;

55 
tc_Ã‹m_qİt
 *
İts
;

56 
Ën
, 
”r
 = 0;

58 ià(
tc
->
tc_İts
->
d_size
 < (*
İts
))

59  -
NLE_INVAL
;

61 
İts
 = (
tc_Ã‹m_qİt
 *è
tc
->
tc_İts
->
d_d©a
;

62 
Ã‹m
->
qnm_Ï‹ncy
 = 
İts
->
Ï‹ncy
;

63 
Ã‹m
->
qnm_lim™
 = 
İts
->
lim™
;

64 
Ã‹m
->
qnm_loss
 = 
İts
->
loss
;

65 
Ã‹m
->
qnm_g­
 = 
İts
->
g­
;

66 
Ã‹m
->
qnm_du¶iÿ‹
 = 
İts
->
du¶iÿ‹
;

67 
Ã‹m
->
qnm_j™‹r
 = 
İts
->
j™‹r
;

69 
Ã‹m
->
qnm_mask
 = (
SCH_NETEM_ATTR_LATENCY
 | 
SCH_NETEM_ATTR_LIMIT
 |

70 
SCH_NETEM_ATTR_LOSS
 | 
SCH_NETEM_ATTR_GAP
 |

71 
SCH_NETEM_ATTR_DUPLICATE
 | 
SCH_NETEM_ATTR_JITTER
);

73 
Ën
 = 
tc
->
tc_İts
->
d_size
 - (*
İts
);

75 ià(
Ën
 > 0) {

76 
Æ©Œ
 *
tb
[
TCA_NETEM_MAX
+1];

78 
”r
 = 
	`Æa_·r£
(
tb
, 
TCA_NETEM_MAX
, (
Æ©Œ
 *)

79 (
tc
->
tc_İts
->
d_d©a
 + (*
İts
)),

80 
Ën
, 
Ã‹m_pŞicy
);

81 ià(
”r
 < 0) {

82 
	`ä“
(
Ã‹m
);

83  
”r
;

86 ià(
tb
[
TCA_NETEM_CORR
]) {

87 
tc_Ã‹m_cÜr
 
cÜ
;

89 
	`Æa_memıy
(&
cÜ
, 
tb
[
TCA_NETEM_CORR
], (cor));

90 
Ã‹m
->
qnm_cÜr
.
nmc_d–ay
 = 
cÜ
.
d–ay_cÜr
;

91 
Ã‹m
->
qnm_cÜr
.
nmc_loss
 = 
cÜ
.
loss_cÜr
;

92 
Ã‹m
->
qnm_cÜr
.
nmc_du¶iÿ‹
 = 
cÜ
.
dup_cÜr
;

94 
Ã‹m
->
qnm_mask
 |ğ(
SCH_NETEM_ATTR_DELAY_CORR
 |

95 
SCH_NETEM_ATTR_LOSS_CORR
 |

96 
SCH_NETEM_ATTR_DUP_CORR
);

99 ià(
tb
[
TCA_NETEM_REORDER
]) {

100 
tc_Ã‹m_»Üd”
 
ro
;

102 
	`Æa_memıy
(&
ro
, 
tb
[
TCA_NETEM_REORDER
], (ro));

103 
Ã‹m
->
qnm_ro
.
nmro_´obab™y
 = 
ro
.
´obab™y
;

104 
Ã‹m
->
qnm_ro
.
nmro_cÜ»ÏtiÚ
 = 
ro
.
cÜ»ÏtiÚ
;

106 
Ã‹m
->
qnm_mask
 |ğ(
SCH_NETEM_ATTR_RO_PROB
 |

107 
SCH_NETEM_ATTR_RO_CORR
);

110 ià(
tb
[
TCA_NETEM_CORRUPT
]) {

111 
tc_Ã‹m_cÜru±
 
cÜru±
;

113 
	`Æa_memıy
(&
cÜru±
, 
tb
[
TCA_NETEM_CORRUPT
], (corrupt));

114 
Ã‹m
->
qnm_ü±
.
nmü_´obab™y
 = 
cÜru±
.
´obab™y
;

115 
Ã‹m
->
qnm_ü±
.
nmü_cÜ»ÏtiÚ
 = 
cÜru±
.
cÜ»ÏtiÚ
;

117 
Ã‹m
->
qnm_mask
 |ğ(
SCH_NETEM_ATTR_CORRUPT_PROB
 |

118 
SCH_NETEM_ATTR_CORRUPT_CORR
);

122 
Ã‹m
->
qnm_di¡
.
di¡_d©a
 = 
NULL
;

123 
Ã‹m
->
qnm_di¡
.
di¡_size
 = 0;

127 
	}
}

129 
	$Ã‹m_ä“_d©a
(
¹Æ_tc
 *
tc
, *
d©a
)

131 
¹Æ_Ã‹m
 *
Ã‹m
 = 
d©a
;

133 ià(!
Ã‹m
)

136 
	`ä“
(
Ã‹m
->
qnm_di¡
.
di¡_d©a
);

137 
	}
}

139 
	$Ã‹m_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

140 
Æ_dump_·¿ms
 *
p
)

142 
¹Æ_Ã‹m
 *
Ã‹m
 = 
d©a
;

144 ià(
Ã‹m
)

145 
	`Æ_dump
(
p
, "lim™ %d", 
Ã‹m
->
qnm_lim™
);

146 
	}
}

148 
	$Ã‹m_msg_fl_¿w
(
¹Æ_tc
 *
tc
, *
d©a
,

149 
Æ_msg
 *
msg
)

151 
”r
 = 0;

152 
tc_Ã‹m_qİt
 
İts
;

153 
tc_Ã‹m_cÜr
 
cÜ
;

154 
tc_Ã‹m_»Üd”
 
»Üd”
;

155 
tc_Ã‹m_cÜru±
 
cÜru±
;

156 
¹Æ_Ã‹m
 *
Ã‹m
 = 
d©a
;

158 
£t_cÜ»ÏtiÚ
 = 0, 
£t_»Üd”
 = 0,

159 
£t_cÜru±
 = 0, 
£t_di¡
 = 0;

161 ià(!
Ã‹m
)

162 
	`BUG
();

164 
	`mem£t
(&
İts
, 0, (opts));

165 
	`mem£t
(&
cÜ
, 0, (cor));

166 
	`mem£t
(&
»Üd”
, 0, (reorder));

167 
	`mem£t
(&
cÜru±
, 0, (corrupt));

169 
msg
->
nm_Æh
->
Æmsg_æags
 |ğ
NLM_F_REQUEST
;

171 iàĞ
Ã‹m
->
qnm_ro
.
nmro_´obab™y
 != 0 ) {

172 ià(
Ã‹m
->
qnm_Ï‹ncy
 == 0) {

173  -
NLE_MISSING_ATTR
;

175 ià(
Ã‹m
->
qnm_g­
 == 0)‚etem->qnm_gap = 1;

177 iàĞ
Ã‹m
->
qnm_g­
 ) {

178  -
NLE_MISSING_ATTR
;

181 iàĞ
Ã‹m
->
qnm_cÜr
.
nmc_d–ay
 != 0 ) {

182 iàĞ
Ã‹m
->
qnm_Ï‹ncy
 =ğ0 ||‚‘em->
qnm_j™‹r
 == 0) {

183  -
NLE_MISSING_ATTR
;

185 
£t_cÜ»ÏtiÚ
 = 1;

188 iàĞ
Ã‹m
->
qnm_cÜr
.
nmc_loss
 != 0 ) {

189 iàĞ
Ã‹m
->
qnm_loss
 == 0 ) {

190  -
NLE_MISSING_ATTR
;

192 
£t_cÜ»ÏtiÚ
 = 1;

195 iàĞ
Ã‹m
->
qnm_cÜr
.
nmc_du¶iÿ‹
 != 0 ) {

196 iàĞ
Ã‹m
->
qnm_du¶iÿ‹
 == 0 ) {

197  -
NLE_MISSING_ATTR
;

199 
£t_cÜ»ÏtiÚ
 = 1;

202 iàĞ
Ã‹m
->
qnm_ro
.
nmro_´obab™y
 !ğ0 ) 
£t_»Üd”
 = 1;

203 iàĞ
Ã‹m
->
qnm_ro
.
nmro_cÜ»ÏtiÚ
 != 0 ) {

204  -
NLE_MISSING_ATTR
;

207 iàĞ
Ã‹m
->
qnm_ü±
.
nmü_´obab™y
 !ğ0 ) 
£t_cÜru±
 = 1;

208 iàĞ
Ã‹m
->
qnm_ü±
.
nmü_cÜ»ÏtiÚ
 != 0 ) {

209  -
NLE_MISSING_ATTR
;

212 iàĞ
Ã‹m
->
qnm_di¡
.
di¡_d©a
 &&‚‘em->qnm_di¡.
di¡_size
 ) {

213 ià(
Ã‹m
->
qnm_Ï‹ncy
 =ğ0 ||‚‘em->
qnm_j™‹r
 == 0) {

214  -
NLE_MISSING_ATTR
;

218 
Ãw_msg_Ën
 = 
msg
->
nm_size
 + 
Ã‹m
->
qnm_di¡
.
di¡_size
 *

219 (
Ã‹m
->
qnm_di¡
.
di¡_d©a
[0]);

221 
msg
->
nm_Æh
 = (
Æmsghdr
 *è
	`»®loc
(msg->nm_Æh, 
Ãw_msg_Ën
);

222 iàĞ
msg
->
nm_Æh
 =ğ
NULL
 )

223  -
NLE_NOMEM
;

224 
msg
->
nm_size
 = 
Ãw_msg_Ën
;

225 
£t_di¡
 = 1;

229 
İts
.
Ï‹ncy
 = 
Ã‹m
->
qnm_Ï‹ncy
;

230 
İts
.
lim™
 = 
Ã‹m
->
qnm_lim™
 ?‚etem->qnm_limit : 1000;

231 
İts
.
loss
 = 
Ã‹m
->
qnm_loss
;

232 
İts
.
g­
 = 
Ã‹m
->
qnm_g­
;

233 
İts
.
du¶iÿ‹
 = 
Ã‹m
->
qnm_du¶iÿ‹
;

234 
İts
.
j™‹r
 = 
Ã‹m
->
qnm_j™‹r
;

236 
	`NLA_PUT
(
msg
, 
TCA_OPTIONS
, (
İts
), &opts);

238 iàĞ
£t_cÜ»ÏtiÚ
 ) {

239 
cÜ
.
d–ay_cÜr
 = 
Ã‹m
->
qnm_cÜr
.
nmc_d–ay
;

240 
cÜ
.
loss_cÜr
 = 
Ã‹m
->
qnm_cÜr
.
nmc_loss
;

241 
cÜ
.
dup_cÜr
 = 
Ã‹m
->
qnm_cÜr
.
nmc_du¶iÿ‹
;

243 
	`NLA_PUT
(
msg
, 
TCA_NETEM_CORR
, (
cÜ
), &cor);

246 iàĞ
£t_»Üd”
 ) {

247 
»Üd”
.
´obab™y
 = 
Ã‹m
->
qnm_ro
.
nmro_´obab™y
;

248 
»Üd”
.
cÜ»ÏtiÚ
 = 
Ã‹m
->
qnm_ro
.
nmro_cÜ»ÏtiÚ
;

250 
	`NLA_PUT
(
msg
, 
TCA_NETEM_REORDER
, (
»Üd”
), &reorder);

253 iàĞ
£t_cÜru±
 ) {

254 
cÜru±
.
´obab™y
 = 
Ã‹m
->
qnm_ü±
.
nmü_´obab™y
;

255 
cÜru±
.
cÜ»ÏtiÚ
 = 
Ã‹m
->
qnm_ü±
.
nmü_cÜ»ÏtiÚ
;

257 
	`NLA_PUT
(
msg
, 
TCA_NETEM_CORRUPT
, (
cÜru±
), &corrupt);

260 iàĞ
£t_di¡
 ) {

261 
	`NLA_PUT
(
msg
, 
TCA_NETEM_DELAY_DIST
,

262 
Ã‹m
->
qnm_di¡
.
di¡_size
 * Ò‘em->qnm_di¡.
di¡_d©a
[0]),

263 
Ã‹m
->
qnm_di¡
.
di¡_d©a
);

270 
Æ©Œ
* 
h—d
 = (Æ©Œ *)(
	`NLMSG_DATA
(
msg
->
nm_Æh
) +

271 
	`NLMSG_LENGTH
((
tcmsg
)è- 
NLMSG_ALIGNTO
);

273 
Æ©Œ
* 

 = (Æ©Œ *)(((*è(
msg
->
nm_Æh
)) +

274 
	`NLMSG_ALIGN
(
msg
->
nm_Æh
->
Æmsg_Ën
));

276 
Şd_Ën
 = 
h—d
->
Æa_Ën
;

277 
h—d
->
Æa_Ën
 = (*)

 - (*)head;

278 
msg
->
nm_Æh
->
Æmsg_Ën
 +ğ(
h—d
->
Æa_Ën
 - 
Şd_Ën
);

280  
”r
;

281 
Æa_put_çu»
:

282  -
NLE_MSGSIZE
;

283 
	}
}

296 
	$¹Æ_Ã‹m_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

298 
¹Æ_Ã‹m
 *
Ã‹m
;

300 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

301 
	`BUG
();

303 
Ã‹m
->
qnm_lim™
 = 
lim™
;

304 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_LIMIT
;

305 
	}
}

312 
	$¹Æ_Ã‹m_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

314 
¹Æ_Ã‹m
 *
Ã‹m
;

316 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

317  -
NLE_NOMEM
;

319 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_LIMIT
)

320  
Ã‹m
->
qnm_lim™
;

322  -
NLE_NOATTR
;

323 
	}
}

338 
	$¹Æ_Ã‹m_£t_g­
(
¹Æ_qdisc
 *
qdisc
, 
g­
)

340 
¹Æ_Ã‹m
 *
Ã‹m
;

342 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

343 
	`BUG
();

345 
Ã‹m
->
qnm_g­
 = 
g­
;

346 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_GAP
;

347 
	}
}

354 
	$¹Æ_Ã‹m_g‘_g­
(
¹Æ_qdisc
 *
qdisc
)

356 
¹Æ_Ã‹m
 *
Ã‹m
;

358 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

359  -
NLE_NOMEM
;

361 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_GAP
)

362  
Ã‹m
->
qnm_g­
;

364  -
NLE_NOATTR
;

365 
	}
}

373 
	$¹Æ_Ã‹m_£t_»Üd”_´obab™y
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

375 
¹Æ_Ã‹m
 *
Ã‹m
;

377 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

378 
	`BUG
();

380 
Ã‹m
->
qnm_ro
.
nmro_´obab™y
 = 
´ob
;

381 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_RO_PROB
;

382 
	}
}

389 
	$¹Æ_Ã‹m_g‘_»Üd”_´obab™y
(
¹Æ_qdisc
 *
qdisc
)

391 
¹Æ_Ã‹m
 *
Ã‹m
;

393 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

394  -
NLE_NOMEM
;

396 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_RO_PROB
)

397  
Ã‹m
->
qnm_ro
.
nmro_´obab™y
;

399  -
NLE_NOATTR
;

400 
	}
}

408 
	$¹Æ_Ã‹m_£t_»Üd”_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

410 
¹Æ_Ã‹m
 *
Ã‹m
;

412 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

413 
	`BUG
();

415 
Ã‹m
->
qnm_ro
.
nmro_cÜ»ÏtiÚ
 = 
´ob
;

416 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_RO_CORR
;

417 
	}
}

424 
	$¹Æ_Ã‹m_g‘_»Üd”_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
)

426 
¹Æ_Ã‹m
 *
Ã‹m
;

428 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

429  -
NLE_NOMEM
;

431 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_RO_CORR
)

432  
Ã‹m
->
qnm_ro
.
nmro_cÜ»ÏtiÚ
;

434  -
NLE_NOATTR
;

435 
	}
}

450 
	$¹Æ_Ã‹m_£t_cÜru±iÚ_´obab™y
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

452 
¹Æ_Ã‹m
 *
Ã‹m
;

454 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

455 
	`BUG
();

457 
Ã‹m
->
qnm_ü±
.
nmü_´obab™y
 = 
´ob
;

458 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_CORRUPT_PROB
;

459 
	}
}

466 
	$¹Æ_Ã‹m_g‘_cÜru±iÚ_´obab™y
(
¹Æ_qdisc
 *
qdisc
)

468 
¹Æ_Ã‹m
 *
Ã‹m
;

470 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

471 
	`BUG
();

473 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_CORRUPT_PROB
)

474  
Ã‹m
->
qnm_ü±
.
nmü_´obab™y
;

476  -
NLE_NOATTR
;

477 
	}
}

485 
	$¹Æ_Ã‹m_£t_cÜru±iÚ_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

487 
¹Æ_Ã‹m
 *
Ã‹m
;

489 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

490 
	`BUG
();

492 
Ã‹m
->
qnm_ü±
.
nmü_cÜ»ÏtiÚ
 = 
´ob
;

493 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_CORRUPT_CORR
;

494 
	}
}

501 
	$¹Æ_Ã‹m_g‘_cÜru±iÚ_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
)

503 
¹Æ_Ã‹m
 *
Ã‹m
;

505 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

506 
	`BUG
();

508 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_CORRUPT_CORR
)

509  
Ã‹m
->
qnm_ü±
.
nmü_cÜ»ÏtiÚ
;

511  -
NLE_NOATTR
;

512 
	}
}

527 
	$¹Æ_Ã‹m_£t_loss
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

529 
¹Æ_Ã‹m
 *
Ã‹m
;

531 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

532 
	`BUG
();

534 
Ã‹m
->
qnm_loss
 = 
´ob
;

535 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_LOSS
;

536 
	}
}

543 
	$¹Æ_Ã‹m_g‘_loss
(
¹Æ_qdisc
 *
qdisc
)

545 
¹Æ_Ã‹m
 *
Ã‹m
;

547 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

548 
	`BUG
();

550 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_LOSS
)

551  
Ã‹m
->
qnm_loss
;

553  -
NLE_NOATTR
;

554 
	}
}

562 
	$¹Æ_Ã‹m_£t_loss_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

564 
¹Æ_Ã‹m
 *
Ã‹m
;

566 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

567 
	`BUG
();

569 
Ã‹m
->
qnm_cÜr
.
nmc_loss
 = 
´ob
;

570 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_LOSS_CORR
;

571 
	}
}

578 
	$¹Æ_Ã‹m_g‘_loss_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
)

580 
¹Æ_Ã‹m
 *
Ã‹m
;

582 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

583 
	`BUG
();

585 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_LOSS_CORR
)

586  
Ã‹m
->
qnm_cÜr
.
nmc_loss
;

588  -
NLE_NOATTR
;

589 
	}
}

604 
	$¹Æ_Ã‹m_£t_du¶iÿ‹
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

606 
¹Æ_Ã‹m
 *
Ã‹m
;

608 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

609 
	`BUG
();

611 
Ã‹m
->
qnm_du¶iÿ‹
 = 
´ob
;

612 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_DUPLICATE
;

613 
	}
}

620 
	$¹Æ_Ã‹m_g‘_du¶iÿ‹
(
¹Æ_qdisc
 *
qdisc
)

622 
¹Æ_Ã‹m
 *
Ã‹m
;

624 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

625 
	`BUG
();

627 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_DUPLICATE
)

628  
Ã‹m
->
qnm_du¶iÿ‹
;

630  -
NLE_NOATTR
;

631 
	}
}

639 
	$¹Æ_Ã‹m_£t_du¶iÿ‹_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

641 
¹Æ_Ã‹m
 *
Ã‹m
;

643 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

644 
	`BUG
();

646 
Ã‹m
->
qnm_cÜr
.
nmc_du¶iÿ‹
 = 
´ob
;

647 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_DUP_CORR
;

648 
	}
}

655 
	$¹Æ_Ã‹m_g‘_du¶iÿ‹_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
)

657 
¹Æ_Ã‹m
 *
Ã‹m
;

659 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

660 
	`BUG
();

662 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_DUP_CORR
)

663  
Ã‹m
->
qnm_cÜr
.
nmc_du¶iÿ‹
;

665  -
NLE_NOATTR
;

666 
	}
}

681 
	$¹Æ_Ã‹m_£t_d–ay
(
¹Æ_qdisc
 *
qdisc
, 
d–ay
)

683 
¹Æ_Ã‹m
 *
Ã‹m
;

685 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

686 
	`BUG
();

688 
Ã‹m
->
qnm_Ï‹ncy
 = 
	`Æ_us2ticks
(
d–ay
);

689 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_LATENCY
;

690 
	}
}

697 
	$¹Æ_Ã‹m_g‘_d–ay
(
¹Æ_qdisc
 *
qdisc
)

699 
¹Æ_Ã‹m
 *
Ã‹m
;

701 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

702 
	`BUG
();

704 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_LATENCY
)

705  
	`Æ_ticks2us
(
Ã‹m
->
qnm_Ï‹ncy
);

707  -
NLE_NOATTR
;

708 
	}
}

716 
	$¹Æ_Ã‹m_£t_j™‹r
(
¹Æ_qdisc
 *
qdisc
, 
j™‹r
)

718 
¹Æ_Ã‹m
 *
Ã‹m
;

720 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

721 
	`BUG
();

723 
Ã‹m
->
qnm_j™‹r
 = 
	`Æ_us2ticks
(
j™‹r
);

724 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_JITTER
;

725 
	}
}

732 
	$¹Æ_Ã‹m_g‘_j™‹r
(
¹Æ_qdisc
 *
qdisc
)

734 
¹Æ_Ã‹m
 *
Ã‹m
;

736 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

737 
	`BUG
();

739 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_JITTER
)

740  
	`Æ_ticks2us
(
Ã‹m
->
qnm_j™‹r
);

742  -
NLE_NOATTR
;

743 
	}
}

750 
	$¹Æ_Ã‹m_£t_d–ay_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
, 
´ob
)

752 
¹Æ_Ã‹m
 *
Ã‹m
;

754 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

755 
	`BUG
();

757 
Ã‹m
->
qnm_cÜr
.
nmc_d–ay
 = 
´ob
;

758 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_DELAY_CORR
;

759 
	}
}

766 
	$¹Æ_Ã‹m_g‘_d–ay_cÜ»ÏtiÚ
(
¹Æ_qdisc
 *
qdisc
)

768 
¹Æ_Ã‹m
 *
Ã‹m
;

770 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

771 
	`BUG
();

773 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_DELAY_CORR
)

774  
Ã‹m
->
qnm_cÜr
.
nmc_d–ay
;

776  -
NLE_NOATTR
;

777 
	}
}

784 
	$¹Æ_Ã‹m_g‘_d–ay_di¡ributiÚ_size
(
¹Æ_qdisc
 *
qdisc
)

786 
¹Æ_Ã‹m
 *
Ã‹m
;

788 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

789 
	`BUG
();

791 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_DIST
)

792  
Ã‹m
->
qnm_di¡
.
di¡_size
;

794  -
NLE_NOATTR
;

795 
	}
}

803 
	$¹Æ_Ã‹m_g‘_d–ay_di¡ributiÚ
(
¹Æ_qdisc
 *
qdisc
, 
št16_t
 **
di¡_±r
)

805 
¹Æ_Ã‹m
 *
Ã‹m
;

807 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

808 
	`BUG
();

810 ià(
Ã‹m
->
qnm_mask
 & 
SCH_NETEM_ATTR_DIST
) {

811 *
di¡_±r
 = 
Ã‹m
->
qnm_di¡
.
di¡_d©a
;

814  -
NLE_NOATTR
;

815 
	}
}

823 
	$¹Æ_Ã‹m_£t_d–ay_di¡ributiÚ
(
¹Æ_qdisc
 *
qdisc
, cÚ¡ *
di¡_ty³
) {

824 
¹Æ_Ã‹m
 *
Ã‹m
;

826 ià(!(
Ã‹m
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

827 
	`BUG
();

829 
FILE
 *
f
;

830 
n
 = 0;

831 
size_t
 
i
;

832 
size_t
 
Ën
 = 2048;

833 *
lše
;

834 
Çme
[
NAME_MAX
];

835 
di¡_suffix
[] = ".dist";

838 *
‹¡_suffix
 = 
	`¡r¡r
(
di¡_ty³
, 
di¡_suffix
);

839 ià(
‹¡_suffix
 !ğ
NULL
 && 
	`¡¾’
(test_suffix) == 5)

840 
	`¡rıy
(
di¡_suffix
, "");

843 *
‹¡_·th
[] = { "", "./", "/usr/lib/tc/", "/usr/local/lib/tc/" };

845 
i
 = 0; i < 
	`ARRAY_SIZE
(
‹¡_·th
); i++) {

846 
	`¢´štf
(
Çme
, 
NAME_MAX
, "%s%s%s", 
‹¡_·th
[
i
], 
di¡_ty³
, 
di¡_suffix
);

847 ià((
f
 = 
	`fİ’
(
Çme
, "r")))

851 iàĞ
f
 =ğ
NULL
 )

852  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

854 
Ã‹m
->
qnm_di¡
.
di¡_d©a
 = (
št16_t
 *è
	`ÿÎoc
 (
MAXDIST
, (int16_t));

856 
lše
 = (*è
	`ÿÎoc
 ((), 
Ën
 + 1);

858 
	`g‘lše
(&
lše
, &
Ën
, 
f
) != -1) {

859 *
p
, *
’dp
;

861 ià(*
lše
 == '\n' || *line == '#')

864 
p
 = 
lše
; ;… = 
’dp
) {

865 
x
 = 
	`¡¹Ş
(
p
, &
’dp
, 0);

866 ià(
’dp
 =ğ
p
) ;

868 ià(
n
 >ğ
MAXDIST
) {

869 
	`ä“
(
lše
);

870 
	`fşo£
(
f
);

871  -
NLE_INVAL
;

873 
Ã‹m
->
qnm_di¡
.
di¡_d©a
[
n
++] = 
x
;

877 
	`ä“
(
lše
);

879 
Ã‹m
->
qnm_di¡
.
di¡_size
 = 
n
;

880 
Ã‹m
->
qnm_mask
 |ğ
SCH_NETEM_ATTR_DIST
;

882 
	`fşo£
(
f
);

884 
	}
}

888 
¹Æ_tc_İs
 
	gÃ‹m_İs
 = {

889 .
to_kšd
 = "netem",

890 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

891 .
	gto_size
 = (
¹Æ_Ã‹m
),

892 .
	gto_msg_·r£r
 = 
Ã‹m_msg_·r£r
,

893 .
	gto_ä“_d©a
 = 
Ã‹m_ä“_d©a
,

894 .
	gto_dump
[
NL_DUMP_LINE
] = 
Ã‹m_dump_lše
,

895 .
	gto_msg_fl_¿w
 = 
Ã‹m_msg_fl_¿w
,

898 
__š™
 
	$Ã‹m_š™
()

900 
	`¹Æ_tc_»gi¡”
(&
Ã‹m_İs
);

901 
	}
}

903 
__ex™
 
	$Ã‹m_ex™
()

905 
	`¹Æ_tc_uÄegi¡”
(&
Ã‹m_İs
);

906 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/plug.c

63 
	~<Ãšk-´iv©e/Ãšk.h
>

64 
	~<Ãšk-´iv©e/tc.h
>

65 
	~<Ãšk/Ãšk.h
>

66 
	~<Ãšk/uts.h
>

67 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

68 
	~<Ãšk/rou‹/qdisc/¶ug.h
>

70 
	$¶ug_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

72 
¹Æ_¶ug
 *
¶ug
 = 
d©a
;

73 
tc_¶ug_qİt
 
İts
;

75 ià(!
¶ug
)

76  -
NLE_INVAL
;

78 
İts
.
aùiÚ
 = 
¶ug
->action;

79 
İts
.
lim™
 = 
¶ug
->limit;

81  
	`Æmsg_­³nd
(
msg
, &
İts
, (İts), 
NL_DONTPAD
);

82 
	}
}

94 
	$¹Æ_qdisc_¶ug_bufãr
(
¹Æ_qdisc
 *
qdisc
)

96 
¹Æ_¶ug
 *
¶ug
;

98 ià(!(
¶ug
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

99  -
NLE_NOMEM
;

101 
¶ug
->
aùiÚ
 = 
TCQ_PLUG_BUFFER
;

103 
	}
}

111 
	$¹Æ_qdisc_¶ug_»Ëa£_Úe
(
¹Æ_qdisc
 *
qdisc
)

113 
¹Æ_¶ug
 *
¶ug
;

115 ià(!(
¶ug
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

116  -
NLE_NOMEM
;

118 
¶ug
->
aùiÚ
 = 
TCQ_PLUG_RELEASE_ONE
;

120 
	}
}

128 
	$¹Æ_qdisc_¶ug_»Ëa£_šdefš™e
(
¹Æ_qdisc
 *
qdisc
)

130 
¹Æ_¶ug
 *
¶ug
;

132 ià(!(
¶ug
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

133  -
NLE_NOMEM
;

135 
¶ug
->
aùiÚ
 = 
TCQ_PLUG_RELEASE_INDEFINITE
;

137 
	}
}

145 
	$¹Æ_qdisc_¶ug_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

147 
¹Æ_¶ug
 *
¶ug
;

149 ià(!(
¶ug
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

150  -
NLE_NOMEM
;

152 
¶ug
->
aùiÚ
 = 
TCQ_PLUG_LIMIT
;

153 
¶ug
->
lim™
 =†imit;

156 
	}
}

160 
¹Æ_tc_İs
 
	g¶ug_İs
 = {

161 .
to_kšd
 = "plug",

162 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

163 .
	gto_size
 = (
¹Æ_¶ug
),

164 .
	gto_msg_fl
 = 
¶ug_msg_fl
,

167 
__š™
 
	$¶ug_š™
()

169 
	`¹Æ_tc_»gi¡”
(&
¶ug_İs
);

170 
	}
}

172 
__ex™
 
	$¶ug_ex™
()

174 
	`¹Æ_tc_uÄegi¡”
(&
¶ug_İs
);

175 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/prio.c

29 
	~<Ãšk-´iv©e/Ãšk.h
>

30 
	~<Ãšk-´iv©e/tc.h
>

31 
	~<Ãšk/Ãšk.h
>

32 
	~<Ãšk/uts.h
>

33 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

34 
	~<Ãšk/rou‹/qdisc.h
>

35 
	~<Ãšk/rou‹/qdisc/´io.h
>

38 
	#SCH_PRIO_ATTR_BANDS
 1

	)

39 
	#SCH_PRIO_ATTR_PRIOMAP
 2

	)

42 
	$´io_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

44 
¹Æ_´io
 *
´io
 = 
d©a
;

45 
tc_´io_qİt
 *
İt
;

47 ià(
tc
->
tc_İts
->
d_size
 < (*
İt
))

48  -
NLE_INVAL
;

50 
İt
 = (
tc_´io_qİt
 *è
tc
->
tc_İts
->
d_d©a
;

51 
´io
->
qp_bªds
 = 
İt
->
bªds
;

52 
	`memıy
(
´io
->
qp_´iom­
, 
İt
->
´iom­
, (prio->qp_priomap));

53 
´io
->
qp_mask
 = (
SCH_PRIO_ATTR_BANDS
 | 
SCH_PRIO_ATTR_PRIOMAP
);

56 
	}
}

58 
	$´io_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

59 
Æ_dump_·¿ms
 *
p
)

61 
¹Æ_´io
 *
´io
 = 
d©a
;

63 ià(
´io
)

64 
	`Æ_dump
(
p
, " bªd %u", 
´io
->
qp_bªds
);

65 
	}
}

67 
	$´io_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

68 
Æ_dump_·¿ms
 *
p
)

70 
¹Æ_´io
 *
´io
 = 
d©a
;

71 
i
, 
hp
;

73 ià(!
´io
)

76 
	`Æ_dump
(
p
, "priomap [");

78 
i
 = 0; i <ğ
TC_PRIO_MAX
; i++)

79 
	`Æ_dump
(
p
, "%u%s", 
´io
->
qp_´iom­
[
i
],

80 
i
 < 
TC_PRIO_MAX
 ? " " : "");

82 
	`Æ_dump
(
p
, "]\n");

83 
	`Æ_Ãw_lše
(
p
);

85 
hp
 = (((
TC_PRIO_MAX
/2) + 1) & ~1);

87 
i
 = 0; i < 
hp
; i++) {

88 
a
[32];

89 
	`Æ_dump
(
p
, " %18s => %u",

90 
	`¹Æ_´io2¡r
(
i
, 
a
, (a)),

91 
´io
->
qp_´iom­
[
i
]);

92 ià(
hp
+
i
 <ğ
TC_PRIO_MAX
) {

93 
	`Æ_dump
(
p
, " %18s => %u",

94 
	`¹Æ_´io2¡r
(
hp
+
i
, 
a
, (a)),

95 
´io
->
qp_´iom­
[
hp
+
i
]);

96 ià(
i
 < (
hp
 - 1)) {

97 
	`Æ_dump
(
p
, "\n");

98 
	`Æ_Ãw_lše
(
p
);

102 
	}
}

104 
	$´io_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

106 
¹Æ_´io
 *
´io
 = 
d©a
;

107 
tc_´io_qİt
 
İts
;

109 ià(!
´io
 || !Õrio->
qp_mask
 & 
SCH_PRIO_ATTR_PRIOMAP
))

110 
	`BUG
();

112 
İts
.
bªds
 = 
´io
->
qp_bªds
;

113 
	`memıy
(
İts
.
´iom­
, 
´io
->
qp_´iom­
, (opts.priomap));

115  
	`Æmsg_­³nd
(
msg
, &
İts
, (İts), 
NL_DONTPAD
);

116 
	}
}

129 
	$¹Æ_qdisc_´io_£t_bªds
(
¹Æ_qdisc
 *
qdisc
, 
bªds
)

131 
¹Æ_´io
 *
´io
;

133 ià(!(
´io
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

134 
	`BUG
();

136 
´io
->
qp_bªds
 = 
bªds
;

137 
´io
->
qp_mask
 |ğ
SCH_PRIO_ATTR_BANDS
;

138 
	}
}

145 
	$¹Æ_qdisc_´io_g‘_bªds
(
¹Æ_qdisc
 *
qdisc
)

147 
¹Æ_´io
 *
´io
;

149 ià(!(
´io
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

150 
	`BUG
();

152 ià(
´io
->
qp_mask
 & 
SCH_PRIO_ATTR_BANDS
)

153  
´io
->
qp_bªds
;

155  -
NLE_NOMEM
;

156 
	}
}

165 
	$¹Æ_qdisc_´io_£t_´iom­
(
¹Æ_qdisc
 *
qdisc
, 
ušt8_t
 
´iom­
[],

166 
Ën
)

168 
¹Æ_´io
 *
´io
;

169 
i
;

171 ià(!(
´io
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

172 
	`BUG
();

174 ià(!(
´io
->
qp_mask
 & 
SCH_PRIO_ATTR_BANDS
))

175  -
NLE_MISSING_ATTR
;

177 ià((
Ën
 / (
ušt8_t
)è> (
TC_PRIO_MAX
+1))

178  -
NLE_RANGE
;

180 
i
 = 0; i <ğ
TC_PRIO_MAX
; i++) {

181 ià(
´iom­
[
i
] > 
´io
->
qp_bªds
)

182  -
NLE_RANGE
;

185 
	`memıy
(
´io
->
qp_´iom­
, 
´iom­
, 
Ën
);

186 
´io
->
qp_mask
 |ğ
SCH_PRIO_ATTR_PRIOMAP
;

189 
	}
}

197 
ušt8_t
 *
	$¹Æ_qdisc_´io_g‘_´iom­
(
¹Æ_qdisc
 *
qdisc
)

199 
¹Æ_´io
 *
´io
;

201 ià(!(
´io
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

202 
	`BUG
();

204 ià(
´io
->
qp_mask
 & 
SCH_PRIO_ATTR_PRIOMAP
)

205  
´io
->
qp_´iom­
;

207  
NULL
;

208 
	}
}

217 cÚ¡ 
Œªs_tbl
 
	g´ios
[] = {

218 
__ADD
(
TC_PRIO_BESTEFFORT
,
be¡effÜt
)

219 
__ADD
(
TC_PRIO_FILLER
,
fËr
)

220 
__ADD
(
TC_PRIO_BULK
,
bulk
)

221 
__ADD
(
TC_PRIO_INTERACTIVE_BULK
,
š‹¿ùive_bulk
)

222 
__ADD
(
TC_PRIO_INTERACTIVE
,
š‹¿ùive
)

223 
__ADD
(
TC_PRIO_CONTROL
,
cÚŒŞ
)

237 * 
	$¹Æ_´io2¡r
(
´io
, *
buf
, 
size_t
 
size
)

239  
	`__ty³2¡r
(
´io
, 
buf
, 
size
, 
´ios
, 
	`ARRAY_SIZE
(prios));

240 
	}
}

251 
	$¹Æ_¡r2´io
(cÚ¡ *
Çme
)

253  
	`__¡r2ty³
(
Çme
, 
´ios
, 
	`ARRAY_SIZE
(prios));

254 
	}
}

258 
¹Æ_tc_İs
 
	g´io_İs
 = {

259 .
to_kšd
 = "prio",

260 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

261 .
	gto_size
 = (
¹Æ_´io
),

262 .
	gto_msg_·r£r
 = 
´io_msg_·r£r
,

263 .
	gto_dump
 = {

264 [
NL_DUMP_LINE
] = 
´io_dump_lše
,

265 [
NL_DUMP_DETAILS
] = 
´io_dump_d‘as
,

267 .
	gto_msg_fl
 = 
´io_msg_fl
,

270 
¹Æ_tc_İs
 
	gpfifo_ç¡_İs
 = {

271 .
to_kšd
 = "pfifo_fast",

272 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

273 .
	gto_size
 = (
¹Æ_´io
),

274 .
	gto_msg_·r£r
 = 
´io_msg_·r£r
,

275 .
	gto_dump
 = {

276 [
NL_DUMP_LINE
] = 
´io_dump_lše
,

277 [
NL_DUMP_DETAILS
] = 
´io_dump_d‘as
,

279 .
	gto_msg_fl
 = 
´io_msg_fl
,

282 
__š™
 
	$´io_š™
()

284 
	`¹Æ_tc_»gi¡”
(&
´io_İs
);

285 
	`¹Æ_tc_»gi¡”
(&
pfifo_ç¡_İs
);

286 
	}
}

288 
__ex™
 
	$´io_ex™
()

290 
	`¹Æ_tc_uÄegi¡”
(&
´io_İs
);

291 
	`¹Æ_tc_uÄegi¡”
(&
pfifo_ç¡_İs
);

292 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/red.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk-´iv©e/tc.h
>

21 
	~<Ãšk/Ãšk.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

24 
	~<Ãšk/rou‹/qdisc.h
>

25 
	~<Ãšk/rou‹/qdisc/»d.h
>

28 
	#RED_ATTR_LIMIT
 0x01

	)

29 
	#RED_ATTR_QTH_MIN
 0x02

	)

30 
	#RED_ATTR_QTH_MAX
 0x04

	)

31 
	#RED_ATTR_FLAGS
 0x08

	)

32 
	#RED_ATTR_WLOG
 0x10

	)

33 
	#RED_ATTR_PLOG
 0x20

	)

34 
	#RED_ATTR_SCELL_LOG
 0x40

	)

37 
Æa_pŞicy
 
	g»d_pŞicy
[
TCA_RED_MAX
+1] = {

38 [
TCA_RED_PARMS
] = { .
mšËn
 = (
tc_»d_qİt
) },

41 
	$»d_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

43 
Æ©Œ
 *
tb
[
TCA_RED_MAX
+1];

44 
¹Æ_»d
 *
»d
 = 
d©a
;

45 
tc_»d_qİt
 *
İts
;

46 
”r
;

48 ià(!(
tc
->
û_mask
 & 
TCA_ATTR_OPTS
))

51 
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_RED_MAX
, 
tc
, 
»d_pŞicy
);

52 ià(
”r
 < 0)

53  
”r
;

55 ià(!
tb
[
TCA_RED_PARMS
])

56  -
NLE_MISSING_ATTR
;

58 
İts
 = 
	`Æa_d©a
(
tb
[
TCA_RED_PARMS
]);

60 
»d
->
qr_lim™
 = 
İts
->
lim™
;

61 
»d
->
qr_qth_mš
 = 
İts
->
qth_mš
;

62 
»d
->
qr_qth_max
 = 
İts
->
qth_max
;

63 
»d
->
qr_æags
 = 
İts
->
æags
;

64 
»d
->
qr_wlog
 = 
İts
->
Wlog
;

65 
»d
->
qr_¶og
 = 
İts
->
Plog
;

66 
»d
->
qr_sûÎ_log
 = 
İts
->
SûÎ_log
;

68 
»d
->
qr_mask
 = (
RED_ATTR_LIMIT
 | 
RED_ATTR_QTH_MIN
 | 
RED_ATTR_QTH_MAX
 |

69 
RED_ATTR_FLAGS
 | 
RED_ATTR_WLOG
 | 
RED_ATTR_PLOG
 |

70 
RED_ATTR_SCELL_LOG
);

73 
	}
}

75 
	$»d_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

76 
Æ_dump_·¿ms
 *
p
)

78 
¹Æ_»d
 *
»d
 = 
d©a
;

80 ià(
»d
) {

83 
	}
}

85 
	$»d_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

86 
Æ_dump_·¿ms
 *
p
)

88 
¹Æ_»d
 *
»d
 = 
d©a
;

90 ià(
»d
) {

93 
	}
}

95 
	$»d_dump_¡©s
(
¹Æ_tc
 *
tc
, *
d©a
,

96 
Æ_dump_·¿ms
 *
p
)

98 
¹Æ_»d
 *
»d
 = 
d©a
;

100 ià(
»d
) {

103 
	}
}

105 
	$»d_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

107 
¹Æ_»d
 *
»d
 = 
d©a
;

109 ià(!
»d
)

110 
	`BUG
();

113 
	`mem£t
(&
İts
, 0, (opts));

114 
İts
.
quªtum
 = 
sfq
->
qs_quªtum
;

115 
İts
.
³¹urb_³riod
 = 
sfq
->
qs_³¹urb
;

116 
İts
.
lim™
 = 
sfq
->
qs_lim™
;

118 ià(
	`Æmsg_­³nd
(
msg
, &
İts
, (İts), 
NL_DONTPAD
) < 0)

119 
”rout
;

122  -
NLE_OPNOTSUPP
;

123 
	}
}

136 
	$¹Æ_»d_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

138 
¹Æ_»d
 *
»d
;

140 ià(!(
»d
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

141 
	`BUG
();

143 
»d
->
qr_lim™
 = 
lim™
;

144 
»d
->
qr_mask
 |ğ
RED_ATTR_LIMIT
;

145 
	}
}

152 
	$¹Æ_»d_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

154 
¹Æ_»d
 *
»d
;

156 ià(!(
»d
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

157 
	`BUG
();

159 ià(
»d
->
qr_mask
 & 
RED_ATTR_LIMIT
)

160  
»d
->
qr_lim™
;

162  -
NLE_NOATTR
;

163 
	}
}

167 
¹Æ_tc_İs
 
	g»d_İs
 = {

168 .
to_kšd
 = "red",

169 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

170 .
	gto_size
 = (
¹Æ_»d
),

171 .
	gto_msg_·r£r
 = 
»d_msg_·r£r
,

172 .
	gto_dump
 = {

173 [
NL_DUMP_LINE
] = 
»d_dump_lše
,

174 [
NL_DUMP_DETAILS
] = 
»d_dump_d‘as
,

175 [
NL_DUMP_STATS
] = 
»d_dump_¡©s
,

177 .
	gto_msg_fl
 = 
»d_msg_fl
,

180 
__š™
 
	$»d_š™
()

182 
	`¹Æ_tc_»gi¡”
(&
»d_İs
);

183 
	}
}

185 
__ex™
 
	$»d_ex™
()

187 
	`¹Æ_tc_uÄegi¡”
(&
»d_İs
);

188 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/sfq.c

26 
	~<Ãšk-´iv©e/Ãšk.h
>

27 
	~<Ãšk-´iv©e/tc.h
>

28 
	~<Ãšk/Ãšk.h
>

29 
	~<Ãšk/uts.h
>

30 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

31 
	~<Ãšk/rou‹/qdisc.h
>

32 
	~<Ãšk/rou‹/qdisc/sfq.h
>

35 
	#SCH_SFQ_ATTR_QUANTUM
 0x01

	)

36 
	#SCH_SFQ_ATTR_PERTURB
 0x02

	)

37 
	#SCH_SFQ_ATTR_LIMIT
 0x04

	)

38 
	#SCH_SFQ_ATTR_DIVISOR
 0x08

	)

39 
	#SCH_SFQ_ATTR_FLOWS
 0x10

	)

42 
	$sfq_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

44 
¹Æ_sfq
 *
sfq
 = 
d©a
;

45 
tc_sfq_qİt
 *
İts
;

47 ià(!(
tc
->
û_mask
 & 
TCA_ATTR_OPTS
))

50 ià(
tc
->
tc_İts
->
d_size
 < (*
İts
))

51  -
NLE_INVAL
;

53 
İts
 = (
tc_sfq_qİt
 *è
tc
->
tc_İts
->
d_d©a
;

55 
sfq
->
qs_quªtum
 = 
İts
->
quªtum
;

56 
sfq
->
qs_³¹urb
 = 
İts
->
³¹urb_³riod
;

57 
sfq
->
qs_lim™
 = 
İts
->
lim™
;

58 
sfq
->
qs_divisÜ
 = 
İts
->
divisÜ
;

59 
sfq
->
qs_æows
 = 
İts
->
æows
;

61 
sfq
->
qs_mask
 = (
SCH_SFQ_ATTR_QUANTUM
 | 
SCH_SFQ_ATTR_PERTURB
 |

62 
SCH_SFQ_ATTR_LIMIT
 | 
SCH_SFQ_ATTR_DIVISOR
 |

63 
SCH_SFQ_ATTR_FLOWS
);

66 
	}
}

68 
	$sfq_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

69 
Æ_dump_·¿ms
 *
p
)

71 
¹Æ_sfq
 *
sfq
 = 
d©a
;

73 ià(
sfq
)

74 
	`Æ_dump
(
p
, " quªtum %u…”turb %us", 
sfq
->
qs_quªtum
,

75 
sfq
->
qs_³¹urb
);

76 
	}
}

78 
	$sfq_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

79 
Æ_dump_·¿ms
 *
p
)

81 
¹Æ_sfq
 *
sfq
 = 
d©a
;

83 ià(
sfq
)

84 
	`Æ_dump
(
p
, "limit %u divisor %u",

85 
sfq
->
qs_lim™
, sfq->
qs_divisÜ
);

86 
	}
}

88 
	$sfq_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

90 
¹Æ_sfq
 *
sfq
 = 
d©a
;

91 
tc_sfq_qİt
 
İts
 = {0};

93 ià(!
sfq
)

94 
	`BUG
();

96 
İts
.
quªtum
 = 
sfq
->
qs_quªtum
;

97 
İts
.
³¹urb_³riod
 = 
sfq
->
qs_³¹urb
;

98 
İts
.
lim™
 = 
sfq
->
qs_lim™
;

100  
	`Æmsg_­³nd
(
msg
, &
İts
, (İts), 
NL_DONTPAD
);

101 
	}
}

114 
	$¹Æ_sfq_£t_quªtum
(
¹Æ_qdisc
 *
qdisc
, 
quªtum
)

116 
¹Æ_sfq
 *
sfq
;

118 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

119 
	`BUG
();

121 
sfq
->
qs_quªtum
 = 
quªtum
;

122 
sfq
->
qs_mask
 |ğ
SCH_SFQ_ATTR_QUANTUM
;

123 
	}
}

130 
	$¹Æ_sfq_g‘_quªtum
(
¹Æ_qdisc
 *
qdisc
)

132 
¹Æ_sfq
 *
sfq
;

134 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

135 
	`BUG
();

137 ià(
sfq
->
qs_mask
 & 
SCH_SFQ_ATTR_QUANTUM
)

138  
sfq
->
qs_quªtum
;

140  -
NLE_NOATTR
;

141 
	}
}

149 
	$¹Æ_sfq_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

151 
¹Æ_sfq
 *
sfq
;

153 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

154 
	`BUG
();

156 
sfq
->
qs_lim™
 = 
lim™
;

157 
sfq
->
qs_mask
 |ğ
SCH_SFQ_ATTR_LIMIT
;

158 
	}
}

165 
	$¹Æ_sfq_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

167 
¹Æ_sfq
 *
sfq
;

169 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

170 
	`BUG
();

172 ià(
sfq
->
qs_mask
 & 
SCH_SFQ_ATTR_LIMIT
)

173  
sfq
->
qs_lim™
;

175  -
NLE_NOATTR
;

176 
	}
}

185 
	$¹Æ_sfq_£t_³¹urb
(
¹Æ_qdisc
 *
qdisc
, 
³¹urb
)

187 
¹Æ_sfq
 *
sfq
;

189 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

190 
	`BUG
();

192 
sfq
->
qs_³¹urb
 = 
³¹urb
;

193 
sfq
->
qs_mask
 |ğ
SCH_SFQ_ATTR_PERTURB
;

194 
	}
}

201 
	$¹Æ_sfq_g‘_³¹urb
(
¹Æ_qdisc
 *
qdisc
)

203 
¹Æ_sfq
 *
sfq
;

205 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

206 
	`BUG
();

208 ià(
sfq
->
qs_mask
 & 
SCH_SFQ_ATTR_PERTURB
)

209  
sfq
->
qs_³¹urb
;

211  -
NLE_NOATTR
;

212 
	}
}

219 
	$¹Æ_sfq_g‘_divisÜ
(
¹Æ_qdisc
 *
qdisc
)

221 
¹Æ_sfq
 *
sfq
;

223 ià(!(
sfq
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

224 
	`BUG
();

226 ià(
sfq
->
qs_mask
 & 
SCH_SFQ_ATTR_DIVISOR
)

227  
sfq
->
qs_divisÜ
;

229  -
NLE_NOATTR
;

230 
	}
}

234 
¹Æ_tc_İs
 
	gsfq_İs
 = {

235 .
to_kšd
 = "sfq",

236 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

237 .
	gto_size
 = (
¹Æ_sfq
),

238 .
	gto_msg_·r£r
 = 
sfq_msg_·r£r
,

239 .
	gto_dump
 = {

240 [
NL_DUMP_LINE
] = 
sfq_dump_lše
,

241 [
NL_DUMP_DETAILS
] = 
sfq_dump_d‘as
,

243 .
	gto_msg_fl
 = 
sfq_msg_fl
,

246 
__š™
 
	$sfq_š™
()

248 
	`¹Æ_tc_»gi¡”
(&
sfq_İs
);

249 
	}
}

251 
__ex™
 
	$sfq_ex™
()

253 
	`¹Æ_tc_uÄegi¡”
(&
sfq_İs
);

254 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/qdisc/tbf.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/ÿche.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

24 
	~<Ãšk/rou‹/qdisc.h
>

25 
	~<Ãšk/rou‹/şass.h
>

26 
	~<Ãšk/rou‹/lšk.h
>

27 
	~<Ãšk/rou‹/qdisc/tbf.h
>

30 
	#TBF_ATTR_LIMIT
 0x01

	)

31 
	#TBF_ATTR_RATE
 0x02

	)

32 
	#TBF_ATTR_PEAKRATE
 0x10

	)

35 
Æa_pŞicy
 
	gtbf_pŞicy
[
TCA_TBF_MAX
+1] = {

36 [
TCA_TBF_PARMS
] = { .
mšËn
 = (
tc_tbf_qİt
) },

39 
	$tbf_msg_·r£r
(
¹Æ_tc
 *
tc
, *
d©a
)

41 
Æ©Œ
 *
tb
[
TCA_TBF_MAX
 + 1];

42 
¹Æ_tbf
 *
tbf
 = 
d©a
;

43 
”r
;

45 ià((
”r
 = 
	`tÿ_·r£
(
tb
, 
TCA_TBF_MAX
, 
tc
, 
tbf_pŞicy
)) < 0)

46  
”r
;

48 ià(
tb
[
TCA_TBF_PARMS
]) {

49 
tc_tbf_qİt
 
İts
;

50 
bufsize
;

52 
	`Æa_memıy
(&
İts
, 
tb
[
TCA_TBF_PARMS
], (opts));

53 
tbf
->
qt_lim™
 = 
İts
.
lim™
;

55 
	`¹Æ_cİy_¿‹¥ec
(&
tbf
->
qt_¿‹
, &
İts
.
¿‹
);

56 
tbf
->
qt_¿‹_txtime
 = 
İts
.
bufãr
;

57 
bufsize
 = 
	`¹Æ_tc_ÿlc_bufsize
(
	`Æ_ticks2us
(
İts
.
bufãr
),

58 
İts
.
¿‹
.rate);

59 
tbf
->
qt_¿‹_buck‘
 = 
bufsize
;

61 
	`¹Æ_cİy_¿‹¥ec
(&
tbf
->
qt_³ak¿‹
, &
İts
.
³ak¿‹
);

62 
tbf
->
qt_³ak¿‹_txtime
 = 
İts
.
mtu
;

63 
bufsize
 = 
	`¹Æ_tc_ÿlc_bufsize
(
	`Æ_ticks2us
(
İts
.
mtu
),

64 
İts
.
³ak¿‹
.
¿‹
);

65 
tbf
->
qt_³ak¿‹_buck‘
 = 
bufsize
;

67 
	`¹Æ_tc_£t_mpu
(
tc
, 
tbf
->
qt_¿‹
.
rs_mpu
);

68 
	`¹Æ_tc_£t_ov”h—d
(
tc
, 
tbf
->
qt_¿‹
.
rs_ov”h—d
);

70 
tbf
->
qt_mask
 = (
TBF_ATTR_LIMIT
 | 
TBF_ATTR_RATE
 | 
TBF_ATTR_PEAKRATE
);

74 
	}
}

76 
	$tbf_dump_lše
(
¹Æ_tc
 *
tc
, *
d©a
,

77 
Æ_dump_·¿ms
 *
p
)

79 
r
, 
rb™
, 
lim
;

80 *
ru
, *
rub™
, *
limu
;

81 
¹Æ_tbf
 *
tbf
 = 
d©a
;

83 ià(!
tbf
)

86 
r
 = 
	`Æ_ÿnûl_down_by‹s
(
tbf
->
qt_¿‹
.
rs_¿‹
, &
ru
);

87 
rb™
 = 
	`Æ_ÿnûl_down_b™s
(
tbf
->
qt_¿‹
.
rs_¿‹
*8, &
rub™
);

88 
lim
 = 
	`Æ_ÿnûl_down_by‹s
(
tbf
->
qt_lim™
, &
limu
);

90 
	`Æ_dump
(
p
, "„ate %.2f%s/s (%.0f%s)†imit %.2f%s",

91 
r
, 
ru
, 
rb™
, 
rub™
, 
lim
, 
limu
);

92 
	}
}

94 
	$tbf_dump_d‘as
(
¹Æ_tc
 *
tc
, *
d©a
,

95 
Æ_dump_·¿ms
 *
p
)

97 
¹Æ_tbf
 *
tbf
 = 
d©a
;

99 ià(!
tbf
)

103 *
bu
, *
cu
;

104 
bs
 = 
	`Æ_ÿnûl_down_by‹s
(
tbf
->
qt_¿‹_buck‘
, &
bu
);

105 
ş
 = 
	`Æ_ÿnûl_down_by‹s
(1 << 
tbf
->
qt_¿‹
.
rs_ûÎ_log
,

106 &
cu
);

108 
	`Æ_dump
(
p
, "rate-bucket-size %1.f%s "

110 
bs
, 
bu
, 
ş
, 
cu
);

114 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
) {

115 *
´u
, *
´bu
, *
bsu
, *
şu
;

116 
´
, 
´b
, 
bs
, 
ş
;

118 
´
 = 
	`Æ_ÿnûl_down_by‹s
(
tbf
->
qt_³ak¿‹
.
rs_¿‹
, &
´u
);

119 
´b
 = 
	`Æ_ÿnûl_down_b™s
(
tbf
->
qt_³ak¿‹
.
rs_¿‹
 * 8, &
´bu
);

120 
bs
 = 
	`Æ_ÿnûl_down_b™s
(
tbf
->
qt_³ak¿‹_buck‘
, &
bsu
);

121 
ş
 = 
	`Æ_ÿnûl_down_b™s
(1 << 
tbf
->
qt_³ak¿‹
.
rs_ûÎ_log
,

122 &
şu
);

124 
	`Æ_dump_lše
(
p
, "…eak-rate %.2f%s/s (%.0f%s) "

127 
´
, 
´u
, 
´b
, 
´bu
, 
bs
, 
bsu
, 
ş
, 
şu
);

129 
	}
}

131 
	$tbf_msg_fl
(
¹Æ_tc
 *
tc
, *
d©a
, 
Æ_msg
 *
msg
)

133 
ušt32_t
 
¹ab
[
RTNL_TC_RTABLE_SIZE
], 
±ab
[RTNL_TC_RTABLE_SIZE];

134 
tc_tbf_qİt
 
İts
;

135 
¹Æ_tbf
 *
tbf
 = 
d©a
;

136 
»quœed
 = 
TBF_ATTR_RATE
 | 
TBF_ATTR_LIMIT
;

138 ià((
tbf
->
qt_mask
 & 
»quœed
) !=„equired)

139  -
NLE_MISSING_ATTR
;

141 
	`mem£t
(&
İts
, 0, (opts));

142 
İts
.
lim™
 = 
tbf
->
qt_lim™
;

143 
İts
.
bufãr
 = 
tbf
->
qt_¿‹_txtime
;

145 
	`¹Æ_tc_bud_¿‹_bË
(
tc
, &
tbf
->
qt_¿‹
, 
¹ab
);

146 
	`¹Æ_rcİy_¿‹¥ec
(&
İts
.
¿‹
, &
tbf
->
qt_¿‹
);

148 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
) {

149 
İts
.
mtu
 = 
tbf
->
qt_³ak¿‹_txtime
;

150 
	`¹Æ_tc_bud_¿‹_bË
(
tc
, &
tbf
->
qt_³ak¿‹
, 
±ab
);

151 
	`¹Æ_rcİy_¿‹¥ec
(&
İts
.
³ak¿‹
, &
tbf
->
qt_³ak¿‹
);

155 
	`NLA_PUT
(
msg
, 
TCA_TBF_PARMS
, (
İts
), &opts);

156 
	`NLA_PUT
(
msg
, 
TCA_TBF_RTAB
, (
¹ab
),„tab);

158 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
)

159 
	`NLA_PUT
(
msg
, 
TCA_TBF_PTAB
, (
±ab
),…tab);

163 
Æa_put_çu»
:

164  -
NLE_MSGSIZE
;

165 
	}
}

178 
	$¹Æ_qdisc_tbf_£t_lim™
(
¹Æ_qdisc
 *
qdisc
, 
lim™
)

180 
¹Æ_tbf
 *
tbf
;

182 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

183 
	`BUG
();

185 
tbf
->
qt_lim™
 = 
lim™
;

186 
tbf
->
qt_mask
 |ğ
TBF_ATTR_LIMIT
;

187 
	}
}

189 
šlše
 
	$ÿlc_lim™
(
¹Æ_¿‹¥ec
 *
¥ec
, 
Ï‹ncy
,

190 
buck‘
)

192 
lim™
;

194 
lim™
 = (è
¥ec
->
rs_¿‹
 * ((è
Ï‹ncy
 / 1000000.);

195 
lim™
 +ğ
buck‘
;

197  
lim™
;

198 
	}
}

218 
	$¹Æ_qdisc_tbf_£t_lim™_by_Ï‹ncy
(
¹Æ_qdisc
 *
qdisc
, 
Ï‹ncy
)

220 
¹Æ_tbf
 *
tbf
;

221 
lim™
, 
lim™2
;

223 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

224 
	`BUG
();

226 ià(!(
tbf
->
qt_mask
 & 
TBF_ATTR_RATE
))

227  -
NLE_MISSING_ATTR
;

229 
lim™
 = 
	`ÿlc_lim™
(&
tbf
->
qt_¿‹
, 
Ï‹ncy
,bf->
qt_¿‹_buck‘
);

231 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
) {

232 
lim™2
 = 
	`ÿlc_lim™
(&
tbf
->
qt_³ak¿‹
, 
Ï‹ncy
,

233 
tbf
->
qt_³ak¿‹_buck‘
);

235 ià(
lim™2
 < 
lim™
)

236 
lim™
 = 
lim™2
;

239 
	`¹Æ_qdisc_tbf_£t_lim™
(
qdisc
, (è
lim™
);

242 
	}
}

249 
	$¹Æ_qdisc_tbf_g‘_lim™
(
¹Æ_qdisc
 *
qdisc
)

251 
¹Æ_tbf
 *
tbf
;

253 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

254 
	`BUG
();

256 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_LIMIT
)

257  
tbf
->
qt_lim™
;

259  -
NLE_NOATTR
;

260 
	}
}

262 
šlše
 
	$ÿlc_ûÎ_log
(
ûÎ
, 
buck‘
)

264 
ûÎ
 = 
	`¹Æ_tc_ÿlc_ûÎ_log
(cell);

265  
ûÎ
;

266 
	}
}

276 
	$¹Æ_qdisc_tbf_£t_¿‹
(
¹Æ_qdisc
 *
qdisc
, 
¿‹
, 
buck‘
,

277 
ûÎ
)

279 
¹Æ_tbf
 *
tbf
;

280 
ûÎ_log
;

282 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

283 
	`BUG
();

285 ià(!
ûÎ
)

286 
ûÎ_log
 = 
UINT8_MAX
;

288 
ûÎ_log
 = 
	`¹Æ_tc_ÿlc_ûÎ_log
(
ûÎ
);

290 
tbf
->
qt_¿‹
.
rs_¿‹
 = 
¿‹
;

291 
tbf
->
qt_¿‹_buck‘
 = 
buck‘
;

292 
tbf
->
qt_¿‹
.
rs_ûÎ_log
 = 
ûÎ_log
;

293 
tbf
->
qt_¿‹_txtime
 = 
	`Æ_us2ticks
(
	`¹Æ_tc_ÿlc_txtime
(
buck‘
, 
¿‹
));

294 
tbf
->
qt_mask
 |ğ
TBF_ATTR_RATE
;

295 
	}
}

302 
	$¹Æ_qdisc_tbf_g‘_¿‹
(
¹Æ_qdisc
 *
qdisc
)

304 
¹Æ_tbf
 *
tbf
;

306 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

307 
	`BUG
();

309 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_RATE
)

310  
tbf
->
qt_¿‹
.
rs_¿‹
;

313 
	}
}

320 
	$¹Æ_qdisc_tbf_g‘_¿‹_buck‘
(
¹Æ_qdisc
 *
qdisc
)

322 
¹Æ_tbf
 *
tbf
;

324 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

325 
	`BUG
();

327 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_RATE
)

328  
tbf
->
qt_¿‹_buck‘
;

331 
	}
}

338 
	$¹Æ_qdisc_tbf_g‘_¿‹_ûÎ
(
¹Æ_qdisc
 *
qdisc
)

340 
¹Æ_tbf
 *
tbf
;

342 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

343 
	`BUG
();

345 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_RATE
)

346  (1 << 
tbf
->
qt_¿‹
.
rs_ûÎ_log
);

349 
	}
}

359 
	$¹Æ_qdisc_tbf_£t_³ak¿‹
(
¹Æ_qdisc
 *
qdisc
, 
¿‹
, 
buck‘
,

360 
ûÎ
)

362 
¹Æ_tbf
 *
tbf
;

363 
ûÎ_log
;

365 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

366 
	`BUG
();

368 
ûÎ_log
 = 
	`ÿlc_ûÎ_log
(
ûÎ
, 
buck‘
);

369 ià(
ûÎ_log
 < 0)

370  
ûÎ_log
;

372 
tbf
->
qt_³ak¿‹
.
rs_¿‹
 = 
¿‹
;

373 
tbf
->
qt_³ak¿‹_buck‘
 = 
buck‘
;

374 
tbf
->
qt_³ak¿‹
.
rs_ûÎ_log
 = 
ûÎ_log
;

375 
tbf
->
qt_³ak¿‹_txtime
 = 
	`Æ_us2ticks
(
	`¹Æ_tc_ÿlc_txtime
(
buck‘
, 
¿‹
));

377 
tbf
->
qt_mask
 |ğ
TBF_ATTR_PEAKRATE
;

380 
	}
}

387 
	$¹Æ_qdisc_tbf_g‘_³ak¿‹
(
¹Æ_qdisc
 *
qdisc
)

389 
¹Æ_tbf
 *
tbf
;

391 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

392 
	`BUG
();

394 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
)

395  
tbf
->
qt_³ak¿‹
.
rs_¿‹
;

398 
	}
}

405 
	$¹Æ_qdisc_tbf_g‘_³ak¿‹_buck‘
(
¹Æ_qdisc
 *
qdisc
)

407 
¹Æ_tbf
 *
tbf
;

409 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

410 
	`BUG
();

412 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
)

413  
tbf
->
qt_³ak¿‹_buck‘
;

416 
	}
}

423 
	$¹Æ_qdisc_tbf_g‘_³ak¿‹_ûÎ
(
¹Æ_qdisc
 *
qdisc
)

425 
¹Æ_tbf
 *
tbf
;

427 ià(!(
tbf
 = 
	`¹Æ_tc_d©a
(
	`TC_CAST
(
qdisc
))))

428 
	`BUG
();

430 ià(
tbf
->
qt_mask
 & 
TBF_ATTR_PEAKRATE
)

431  (1 << 
tbf
->
qt_³ak¿‹
.
rs_ûÎ_log
);

434 
	}
}

438 
¹Æ_tc_İs
 
	gtbf_tc_İs
 = {

439 .
to_kšd
 = "tbf",

440 .
	gto_ty³
 = 
RTNL_TC_TYPE_QDISC
,

441 .
	gto_size
 = (
¹Æ_tbf
),

442 .
	gto_msg_·r£r
 = 
tbf_msg_·r£r
,

443 .
	gto_dump
 = {

444 [
NL_DUMP_LINE
] = 
tbf_dump_lše
,

445 [
NL_DUMP_DETAILS
] = 
tbf_dump_d‘as
,

447 .
	gto_msg_fl
 = 
tbf_msg_fl
,

450 
__š™
 
	$tbf_š™
()

452 
	`¹Æ_tc_»gi¡”
(&
tbf_tc_İs
);

453 
	}
}

455 
__ex™
 
	$tbf_ex™
()

457 
	`¹Æ_tc_uÄegi¡”
(&
tbf_tc_İs
);

458 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/route.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/ÿche.h
>

22 
	~<Ãšk/uts.h
>

23 
	~<Ãšk/d©a.h
>

24 
	~<Ãšk/rou‹/¹Æ.h
>

25 
	~<Ãšk/rou‹/rou‹.h
>

26 
	~<Ãšk/rou‹/lšk.h
>

28 
Æ_ÿche_İs
 
	g¹Æ_rou‹_İs
;

30 
	$rou‹_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

31 
Æmsghdr
 *
Æh
, 
Æ_·r£r_·¿m
 *
µ
)

33 
¹Æ_rou‹
 *
rou‹
;

34 
”r
;

36 ià((
”r
 = 
	`¹Æ_rou‹_·r£
(
Æh
, &
rou‹
)) < 0)

37  
”r
;

39 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
rou‹
,…p);

41 
	`¹Æ_rou‹_put
(
rou‹
);

42  
”r
;

43 
	}
}

45 
	$rou‹_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
h
)

47 
¹msg
 
rhdr
 = {

48 .
¹m_çmy
 = 
c
->
c_Ÿrg1
,

51 ià(
c
->
c_Ÿrg2
 & 
ROUTE_CACHE_CONTENT
)

52 
rhdr
.
¹m_æags
 |ğ
RTM_F_CLONED
;

54  
	`Æ_£nd_sim¶e
(
h
, 
RTM_GETROUTE
, 
NLM_F_DUMP
, &
rhdr
, (rhdr));

55 
	}
}

80 
	$¹Æ_rou‹_®loc_ÿche
(
Æ_sock
 *
sk
, 
çmy
, 
æags
,

81 
Æ_ÿche
 **
»suÉ
)

83 
Æ_ÿche
 *
ÿche
;

84 
”r
;

86 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(&
¹Æ_rou‹_İs
)))

87  -
NLE_NOMEM
;

89 
ÿche
->
c_Ÿrg1
 = 
çmy
;

90 
ÿche
->
c_Ÿrg2
 = 
æags
;

92 ià(
sk
 && (
”r
 = 
	`Æ_ÿche_»fl
(sk, 
ÿche
)) < 0) {

93 
	`ä“
(
ÿche
);

94  
”r
;

97 *
»suÉ
 = 
ÿche
;

99 
	}
}

108 
	$bud_rou‹_msg
(
¹Æ_rou‹
 *
tm¶
, 
cmd
, 
æags
,

109 
Æ_msg
 **
»suÉ
)

111 
Æ_msg
 *
msg
;

112 
”r
;

114 ià(!(
msg
 = 
	`Æmsg_®loc_sim¶e
(
cmd
, 
æags
)))

115  -
NLE_NOMEM
;

117 ià((
”r
 = 
	`¹Æ_rou‹_bud_msg
(
msg
, 
tm¶
)) < 0) {

118 
	`Æmsg_ä“
(
msg
);

119  
”r
;

122 *
»suÉ
 = 
msg
;

124 
	}
}

126 
	$¹Æ_rou‹_bud_add_»que¡
(
¹Æ_rou‹
 *
tm¶
, 
æags
,

127 
Æ_msg
 **
»suÉ
)

129  
	`bud_rou‹_msg
(
tm¶
, 
RTM_NEWROUTE
, 
NLM_F_CREATE
 | 
æags
,

130 
»suÉ
);

131 
	}
}

133 
	$¹Æ_rou‹_add
(
Æ_sock
 *
sk
, 
¹Æ_rou‹
 *
rou‹
, 
æags
)

135 
Æ_msg
 *
msg
;

136 
”r
;

138 ià((
”r
 = 
	`¹Æ_rou‹_bud_add_»que¡
(
rou‹
, 
æags
, &
msg
)) < 0)

139  
”r
;

141 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

142 
	`Æmsg_ä“
(
msg
);

143 ià(
”r
 < 0)

144  
”r
;

146  
	`wa™_fÜ_ack
(
sk
);

147 
	}
}

149 
	$¹Æ_rou‹_bud_d–_»que¡
(
¹Æ_rou‹
 *
tm¶
, 
æags
,

150 
Æ_msg
 **
»suÉ
)

152  
	`bud_rou‹_msg
(
tm¶
, 
RTM_DELROUTE
, 
æags
, 
»suÉ
);

153 
	}
}

155 
	$¹Æ_rou‹_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_rou‹
 *
rou‹
, 
æags
)

157 
Æ_msg
 *
msg
;

158 
”r
;

160 ià((
”r
 = 
	`¹Æ_rou‹_bud_d–_»que¡
(
rou‹
, 
æags
, &
msg
)) < 0)

161  
”r
;

163 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

164 
	`Æmsg_ä“
(
msg
);

165 ià(
”r
 < 0)

166  
”r
;

168  
	`wa™_fÜ_ack
(
sk
);

169 
	}
}

173 
Æ_af_group
 
	grou‹_groups
[] = {

174 { 
AF_INET
, 
RTNLGRP_IPV4_ROUTE
 },

175 { 
AF_INET6
, 
RTNLGRP_IPV6_ROUTE
 },

176 { 
AF_DECÃt
, 
RTNLGRP_DECÃt_ROUTE
 },

177 { 
END_OF_GROUP_LIST
 },

180 
Æ_ÿche_İs
 
	g¹Æ_rou‹_İs
 = {

181 .
co_Çme
 = "route/route",

182 .
	gco_hdrsize
 = (
¹msg
),

183 .
	gco_msgty³s
 = {

184 { 
RTM_NEWROUTE
, 
NL_ACT_NEW
, "new" },

185 { 
RTM_DELROUTE
, 
NL_ACT_DEL
, "del" },

186 { 
RTM_GETROUTE
, 
NL_ACT_GET
, "get" },

187 
END_OF_MSGTYPES_LIST
,

189 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

190 .
	gco_groups
 = 
rou‹_groups
,

191 .
	gco_»que¡_upd©e
 = 
rou‹_»que¡_upd©e
,

192 .
	gco_msg_·r£r
 = 
rou‹_msg_·r£r
,

193 .
	gco_obj_İs
 = &
rou‹_obj_İs
,

196 
__š™
 
	$rou‹_š™
()

198 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_rou‹_İs
);

199 
	}
}

201 
__ex™
 
	$rou‹_ex™
()

203 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_rou‹_İs
);

204 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/route_obj.c

33 
	~<Ãšk-´iv©e/Ãšk.h
>

34 
	~<Ãšk/Ãšk.h
>

35 
	~<Ãšk/ÿche.h
>

36 
	~<Ãšk/uts.h
>

37 
	~<Ãšk/d©a.h
>

38 
	~<Ãšk/hashbË.h
>

39 
	~<Ãšk/rou‹/¹Æ.h
>

40 
	~<Ãšk/rou‹/rou‹.h
>

41 
	~<Ãšk/rou‹/lšk.h
>

42 
	~<Ãšk/rou‹/Ãxthİ.h
>

45 
	#ROUTE_ATTR_FAMILY
 0x000001

	)

46 
	#ROUTE_ATTR_TOS
 0x000002

	)

47 
	#ROUTE_ATTR_TABLE
 0x000004

	)

48 
	#ROUTE_ATTR_PROTOCOL
 0x000008

	)

49 
	#ROUTE_ATTR_SCOPE
 0x000010

	)

50 
	#ROUTE_ATTR_TYPE
 0x000020

	)

51 
	#ROUTE_ATTR_FLAGS
 0x000040

	)

52 
	#ROUTE_ATTR_DST
 0x000080

	)

53 
	#ROUTE_ATTR_SRC
 0x000100

	)

54 
	#ROUTE_ATTR_IIF
 0x000200

	)

55 
	#ROUTE_ATTR_OIF
 0x000400

	)

56 
	#ROUTE_ATTR_GATEWAY
 0x000800

	)

57 
	#ROUTE_ATTR_PRIO
 0x001000

	)

58 
	#ROUTE_ATTR_PREF_SRC
 0x002000

	)

59 
	#ROUTE_ATTR_METRICS
 0x004000

	)

60 
	#ROUTE_ATTR_MULTIPATH
 0x008000

	)

61 
	#ROUTE_ATTR_REALMS
 0x010000

	)

62 
	#ROUTE_ATTR_CACHEINFO
 0x020000

	)

65 
	$rou‹_cÚ¡ruùÜ
(
Æ_objeù
 *
c
)

67 
¹Æ_rou‹
 *
r
 = (¹Æ_rou‹ *è
c
;

69 
r
->
¹_çmy
 = 
AF_UNSPEC
;

70 
r
->
¹_scİe
 = 
RT_SCOPE_NOWHERE
;

71 
r
->
¹_bË
 = 
RT_TABLE_MAIN
;

72 
r
->
¹_´ÙocŞ
 = 
RTPROT_STATIC
;

73 
r
->
¹_ty³
 = 
RTN_UNICAST
;

74 
r
->
¹_´io
 = 0;

76 
	`Æ_š™_li¡_h—d
(&
r
->
¹_Ãxthİs
);

77 
	}
}

79 
	$rou‹_ä“_d©a
(
Æ_objeù
 *
c
)

81 
¹Æ_rou‹
 *
r
 = (¹Æ_rou‹ *è
c
;

82 
¹Æ_Ãxthİ
 *
nh
, *
tmp
;

84 ià(
r
 =ğ
NULL
)

87 
	`Æ_addr_put
(
r
->
¹_d¡
);

88 
	`Æ_addr_put
(
r
->
¹_¤c
);

89 
	`Æ_addr_put
(
r
->
¹_´ef_¤c
);

91 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(
nh
, 
tmp
, &
r
->
¹_Ãxthİs
, 
¹nh_li¡
) {

92 
	`¹Æ_rou‹_»move_Ãxthİ
(
r
, 
nh
);

93 
	`¹Æ_rou‹_nh_ä“
(
nh
);

95 
	}
}

97 
	$rou‹_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

99 
¹Æ_rou‹
 *
d¡
 = (¹Æ_rou‹ *è
_d¡
;

100 
¹Æ_rou‹
 *
¤c
 = (¹Æ_rou‹ *è
_¤c
;

101 
¹Æ_Ãxthİ
 *
nh
, *
Ãw
;

103 ià(
¤c
->
¹_d¡
)

104 ià(!(
d¡
->
¹_d¡
 = 
	`Æ_addr_şÚe
(
¤c
->rt_dst)))

105  -
NLE_NOMEM
;

107 ià(
¤c
->
¹_¤c
)

108 ià(!(
d¡
->
¹_¤c
 = 
	`Æ_addr_şÚe
(
¤c
->rt_src)))

109  -
NLE_NOMEM
;

111 ià(
¤c
->
¹_´ef_¤c
)

112 ià(!(
d¡
->
¹_´ef_¤c
 = 
	`Æ_addr_şÚe
(
¤c
->rt_pref_src)))

113  -
NLE_NOMEM
;

116 
d¡
->
¹_Ä_nh
 = 0;

118 
	`Æ_š™_li¡_h—d
(&
d¡
->
¹_Ãxthİs
);

119 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
¤c
->
¹_Ãxthİs
, 
¹nh_li¡
) {

120 
Ãw
 = 
	`¹Æ_rou‹_nh_şÚe
(
nh
);

121 ià(!
Ãw
)

122  -
NLE_NOMEM
;

124 
	`¹Æ_rou‹_add_Ãxthİ
(
d¡
, 
Ãw
);

128 
	}
}

130 
	$rou‹_dump_lše
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

132 
¹Æ_rou‹
 *
r
 = (¹Æ_rou‹ *è
a
;

133 
ÿche
 = 0, 
æags
;

134 
buf
[64];

136 ià(
r
->
¹_æags
 & 
RTM_F_CLONED
)

137 
ÿche
 = 1;

139 
	`Æ_dump_lše
(
p
, "% ", 
	`Æ_af2¡r
(
r
->
¹_çmy
, 
buf
, (buf)));

141 ià(
ÿche
)

142 
	`Æ_dump
(
p
, "cache ");

144 ià(!(
r
->
û_mask
 & 
ROUTE_ATTR_DST
) ||

145 
	`Æ_addr_g‘_Ën
(
r
->
¹_d¡
) == 0)

146 
	`Æ_dump
(
p
, "default ");

148 
	`Æ_dump
(
p
, "% ", 
	`Æ_addr2¡r
(
r
->
¹_d¡
, 
buf
, (buf)));

150 ià(
r
->
û_mask
 & 
ROUTE_ATTR_TABLE
 && !
ÿche
)

151 
	`Æ_dump
(
p
, "table %s ",

152 
	`¹Æ_rou‹_bË2¡r
(
r
->
¹_bË
, 
buf
, (buf)));

154 ià(
r
->
û_mask
 & 
ROUTE_ATTR_TYPE
)

155 
	`Æ_dump
(
p
, "type %s ",

156 
	`Æ_¹Áy³2¡r
(
r
->
¹_ty³
, 
buf
, (buf)));

158 ià(
r
->
û_mask
 & 
ROUTE_ATTR_TOS
 &&„->
¹_tos
 != 0)

159 
	`Æ_dump
(
p
, "to %#x ", 
r
->
¹_tos
);

161 ià(
r
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
) {

162 
¹Æ_Ãxthİ
 *
nh
;

164 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
r
->
¹_Ãxthİs
, 
¹nh_li¡
) {

165 
p
->
dp_iv¬
 = 
NH_DUMP_FROM_ONELINE
;

166 
	`¹Æ_rou‹_nh_dump
(
nh
, 
p
);

170 
æags
 = 
r
->
¹_æags
 & ~(
RTM_F_CLONED
);

171 ià(
r
->
û_mask
 & 
ROUTE_ATTR_FLAGS
 && 
æags
) {

173 
	`Æ_dump
(
p
, "<");

175 
	#PRINT_FLAG
(
f
èià(
æags
 & 
RTNH_F_
##f) { \

176 
æags
 &ğ~
RTNH_F_
##
f
; 
	`Æ_dump
(
p
, #à"%s", fÏg ? "," : ""); }

	)

177 
	`PRINT_FLAG
(
DEAD
);

178 
	`PRINT_FLAG
(
ONLINK
);

179 
	`PRINT_FLAG
(
PERVASIVE
);

180 #undeà
PRINT_FLAG


182 
	#PRINT_FLAG
(
f
èià(
æags
 & 
RTM_F_
##f) { \

183 
æags
 &ğ~
RTM_F_
##
f
; 
	`Æ_dump
(
p
, #à"%s", fÏg ? "," : ""); }

	)

184 
	`PRINT_FLAG
(
NOTIFY
);

185 
	`PRINT_FLAG
(
EQUALIZE
);

186 
	`PRINT_FLAG
(
PREFIX
);

187 #undeà
PRINT_FLAG


189 
	#PRINT_FLAG
(
f
èià(
æags
 & 
RTCF_
##f) { \

190 
æags
 &ğ~
RTCF_
##
f
; 
	`Æ_dump
(
p
, #à"%s", fÏg ? "," : ""); }

	)

191 
	`PRINT_FLAG
(
NOTIFY
);

192 
	`PRINT_FLAG
(
REDIRECTED
);

193 
	`PRINT_FLAG
(
DOREDIRECT
);

194 
	`PRINT_FLAG
(
DIRECTSRC
);

195 
	`PRINT_FLAG
(
DNAT
);

196 
	`PRINT_FLAG
(
BROADCAST
);

197 
	`PRINT_FLAG
(
MULTICAST
);

198 
	`PRINT_FLAG
(
LOCAL
);

199 #undeà
PRINT_FLAG


201 
	`Æ_dump
(
p
, ">");

204 
	`Æ_dump
(
p
, "\n");

205 
	}
}

207 
	$rou‹_dump_d‘as
(
Æ_objeù
 *
a
, 
Æ_dump_·¿ms
 *
p
)

209 
¹Æ_rou‹
 *
r
 = (¹Æ_rou‹ *è
a
;

210 
Æ_ÿche
 *
lšk_ÿche
;

211 
buf
[256];

212 
i
;

214 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

216 
	`rou‹_dump_lše
(
a
, 
p
);

217 
	`Æ_dump_lše
(
p
, " ");

219 ià(
r
->
û_mask
 & 
ROUTE_ATTR_PREF_SRC
)

220 
	`Æ_dump
(
p
, "preferred-src %s ",

221 
	`Æ_addr2¡r
(
r
->
¹_´ef_¤c
, 
buf
, (buf)));

223 ià(
r
->
û_mask
 & 
ROUTE_ATTR_SCOPE
 &&„->
¹_scİe
 !ğ
RT_SCOPE_NOWHERE
)

224 
	`Æ_dump
(
p
, "scope %s ",

225 
	`¹Æ_scİe2¡r
(
r
->
¹_scİe
, 
buf
, (buf)));

227 ià(
r
->
û_mask
 & 
ROUTE_ATTR_PRIO
)

228 
	`Æ_dump
(
p
, "´iÜ™y %#x ", 
r
->
¹_´io
);

230 ià(
r
->
û_mask
 & 
ROUTE_ATTR_PROTOCOL
)

231 
	`Æ_dump
(
p
, "protocol %s ",

232 
	`¹Æ_rou‹_´Ùo2¡r
(
r
->
¹_´ÙocŞ
, 
buf
, (buf)));

234 ià(
r
->
û_mask
 & 
ROUTE_ATTR_IIF
) {

235 ià(
lšk_ÿche
) {

236 
	`Æ_dump
(
p
, "iif %s ",

237 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
, 
r
->
¹_iif
,

238 
buf
, (buf)));

240 
	`Æ_dump
(
p
, "iià%d ", 
r
->
¹_iif
);

243 ià(
r
->
û_mask
 & 
ROUTE_ATTR_SRC
)

244 
	`Æ_dump
(
p
, "¤ø% ", 
	`Æ_addr2¡r
(
r
->
¹_¤c
, 
buf
, (buf)));

246 
	`Æ_dump
(
p
, "\n");

248 ià(
r
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
) {

249 
¹Æ_Ãxthİ
 *
nh
;

251 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
r
->
¹_Ãxthİs
, 
¹nh_li¡
) {

252 
	`Æ_dump_lše
(
p
, " ");

253 
p
->
dp_iv¬
 = 
NH_DUMP_FROM_DETAILS
;

254 
	`¹Æ_rou‹_nh_dump
(
nh
, 
p
);

255 
	`Æ_dump
(
p
, "\n");

259 ià((
r
->
û_mask
 & 
ROUTE_ATTR_CACHEINFO
è&&„->
¹_ÿchešfo
.
¹ci_”rÜ
) {

260 
	`Æ_dump_lše
(
p
, " cacheinfoƒrror %d (%s)\n",

261 
r
->
¹_ÿchešfo
.
¹ci_”rÜ
,

262 
	`¡»¼Ü_r
(-
r
->
¹_ÿchešfo
.
¹ci_”rÜ
, 
buf
, (buf)));

265 ià(
r
->
û_mask
 & 
ROUTE_ATTR_METRICS
) {

266 
	`Æ_dump_lše
(
p
, " metrics [");

267 
i
 = 0; i < 
RTAX_MAX
; i++)

268 ià(
r
->
¹_m‘rics_mask
 & (1 << 
i
))

269 
	`Æ_dump
(
p
, "%s %u ",

270 
	`¹Æ_rou‹_m‘ric2¡r
(
i
+1,

271 
buf
, (buf)),

272 
r
->
¹_m‘rics
[
i
]);

273 
	`Æ_dump
(
p
, "]\n");

276 ià(
lšk_ÿche
)

277 
	`Æ_ÿche_put
(
lšk_ÿche
);

278 
	}
}

280 
	$rou‹_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

282 
¹Æ_rou‹
 *
rou‹
 = (¹Æ_rou‹ *è
obj
;

284 
	`rou‹_dump_d‘as
(
obj
, 
p
);

286 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_CACHEINFO
) {

287 
¹Æ_¹ÿchešfo
 *
ci
 = &
rou‹
->
¹_ÿchešfo
;

289 
	`Æ_dump_lše
(
p
, " used %u„efcnt %u†ast-use %us "

291 
ci
->
¹ci_u£d
, ci->
¹ci_şÁ»f
,

292 
ci
->
¹ci_Ï¡_u£
 / 
	`Æ_g‘_u£r_hz
(),

293 
ci
->
¹ci_expœes
 / 
	`Æ_g‘_u£r_hz
());

295 
	}
}

297 
	$rou‹_keyg’
(
Æ_objeù
 *
obj
, 
ušt32_t
 *
hashkey
,

298 
ušt32_t
 
bË_sz
)

300 
¹Æ_rou‹
 *
rou‹
 = (¹Æ_rou‹ *è
obj
;

301 
rkey_sz
;

302 
Æ_addr
 *
addr
 = 
NULL
;

303 
	srou‹_hash_key
 {

304 
ušt8_t
 
¹_çmy
;

305 
ušt8_t
 
¹_tos
;

306 
ušt32_t
 
¹_bË
;

307 
ušt32_t
 
¹_´io
;

308 
¹_addr
[0];

309 } 
	`__©Œibu‹__
((
·cked
)è*
rkey
;

310 #ifdeà
NL_DEBUG


311 
buf
[
INET6_ADDRSTRLEN
+5];

314 ià(
rou‹
->
¹_d¡
)

315 
addr
 = 
rou‹
->
¹_d¡
;

317 
rkey_sz
 = (*
rkey
);

318 ià(
addr
)

319 
rkey_sz
 +ğ
	`Æ_addr_g‘_Ën
(
addr
);

320 
rkey
 = 
	`ÿÎoc
(1, 
rkey_sz
);

321 ià(!
rkey
) {

322 
	`NL_DBG
(2, "W¬nšg: c®loøçed fÜ %d by‹s...\n", 
rkey_sz
);

323 *
hashkey
 = 0;

326 
rkey
->
¹_çmy
 = 
rou‹
->rt_family;

327 
rkey
->
¹_tos
 = 
rou‹
->rt_tos;

328 
rkey
->
¹_bË
 = 
rou‹
->rt_table;

329 
rkey
->
¹_´io
 = 
rou‹
->rt_prio;

330 ià(
addr
)

331 
	`memıy
(
rkey
->
¹_addr
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
),

332 
	`Æ_addr_g‘_Ën
(
addr
));

334 *
hashkey
 = 
	`Æ_hash
(
rkey
, 
rkey_sz
, 0è% 
bË_sz
;

336 
	`NL_DBG
(5, "route %p key (fam %dos %dable %d‡ddr %s) keysz %d "

337 "hash 0x%x\n", 
rou‹
, 
rkey
->
¹_çmy
,„key->
¹_tos
,

338 
rkey
->
¹_bË
, 
	`Æ_addr2¡r
(
addr
, 
buf
, (buf)),

339 
rkey_sz
, *
hashkey
);

341 
	`ä“
(
rkey
);

344 
	}
}

346 
	$rou‹_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

347 
ušt32_t
 
©Œs
, 
æags
)

349 
¹Æ_rou‹
 *
a
 = (¹Æ_rou‹ *è
_a
;

350 
¹Æ_rou‹
 *
b
 = (¹Æ_rou‹ *è
_b
;

351 
¹Æ_Ãxthİ
 *
nh_a
, *
nh_b
;

352 
i
, 
diff
 = 0, 
found
;

354 
	#ROUTE_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
ROUTE_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

356 
diff
 |ğ
	`ROUTE_DIFF
(
FAMILY
, 
a
->
¹_çmy
 !ğ
b
->rt_family);

357 
diff
 |ğ
	`ROUTE_DIFF
(
TOS
, 
a
->
¹_tos
 !ğ
b
->rt_tos);

358 
diff
 |ğ
	`ROUTE_DIFF
(
TABLE
, 
a
->
¹_bË
 !ğ
b
->rt_table);

359 
diff
 |ğ
	`ROUTE_DIFF
(
PROTOCOL
, 
a
->
¹_´ÙocŞ
 !ğ
b
->rt_protocol);

360 
diff
 |ğ
	`ROUTE_DIFF
(
SCOPE
, 
a
->
¹_scİe
 !ğ
b
->rt_scope);

361 
diff
 |ğ
	`ROUTE_DIFF
(
TYPE
, 
a
->
¹_ty³
 !ğ
b
->rt_type);

362 
diff
 |ğ
	`ROUTE_DIFF
(
PRIO
, 
a
->
¹_´io
 !ğ
b
->rt_prio);

363 
diff
 |ğ
	`ROUTE_DIFF
(
DST
, 
	`Æ_addr_cmp
(
a
->
¹_d¡
, 
b
->rt_dst));

364 
diff
 |ğ
	`ROUTE_DIFF
(
SRC
, 
	`Æ_addr_cmp
(
a
->
¹_¤c
, 
b
->rt_src));

365 
diff
 |ğ
	`ROUTE_DIFF
(
IIF
, 
a
->
¹_iif
 !ğ
b
->rt_iif);

366 
diff
 |ğ
	`ROUTE_DIFF
(
PREF_SRC
, 
	`Æ_addr_cmp
(
a
->
¹_´ef_¤c
,

367 
b
->
¹_´ef_¤c
));

369 ià(
æags
 & 
LOOSE_COMPARISON
) {

370 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_b
, &
b
->
¹_Ãxthİs
, 
¹nh_li¡
) {

371 
found
 = 0;

372 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_a
, &
a
->
¹_Ãxthİs
,

373 
¹nh_li¡
) {

374 ià(!
	`¹Æ_rou‹_nh_com·»
(
nh_a
, 
nh_b
,

375 
nh_b
->
û_mask
, 1)) {

376 
found
 = 1;

381 ià(!
found
)

382 
nh_mism©ch
;

385 
i
 = 0; i < 
RTAX_MAX
 - 1; i++) {

386 ià(
a
->
¹_m‘rics_mask
 & (1 << 
i
) &&

387 (!(
b
->
¹_m‘rics_mask
 & (1 << 
i
)) ||

388 
a
->
¹_m‘rics
[
i
] !ğ
b
->rt_metrics[i]))

389 
diff
 |ğ
	`ROUTE_DIFF
(
METRICS
, 1);

392 
diff
 |ğ
	`ROUTE_DIFF
(
FLAGS
,

393 (
a
->
¹_æags
 ^ 
b
->¹_æagsè& b->
¹_æag_mask
);

395 ià(
a
->
¹_Ä_nh
 !ğ
b
->rt_nr_nh)

396 
nh_mism©ch
;

399 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_a
, &
a
->
¹_Ãxthİs
, 
¹nh_li¡
) {

400 
found
 = 0;

401 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_b
, &
b
->
¹_Ãxthİs
,

402 
¹nh_li¡
) {

403 ià(!
	`¹Æ_rou‹_nh_com·»
(
nh_a
, 
nh_b
, ~0, 0)) {

404 
found
 = 1;

408 ià(!
found
)

409 
nh_mism©ch
;

414 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_b
, &
b
->
¹_Ãxthİs
, 
¹nh_li¡
) {

415 
found
 = 0;

416 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh_a
, &
a
->
¹_Ãxthİs
,

417 
¹nh_li¡
) {

418 ià(!
	`¹Æ_rou‹_nh_com·»
(
nh_a
, 
nh_b
, ~0, 0)) {

419 
found
 = 1;

423 ià(!
found
)

424 
nh_mism©ch
;

427 
i
 = 0; i < 
RTAX_MAX
 - 1; i++) {

428 ià((
a
->
¹_m‘rics_mask
 & (1 << 
i
)) ^

429 (
b
->
¹_m‘rics_mask
 & (1 << 
i
)))

430 
diff
 |ğ
	`ROUTE_DIFF
(
METRICS
, 1);

432 
diff
 |ğ
	`ROUTE_DIFF
(
METRICS
,

433 
a
->
¹_m‘rics
[
i
] !ğ
b
->rt_metrics[i]);

436 
diff
 |ğ
	`ROUTE_DIFF
(
FLAGS
, 
a
->
¹_æags
 !ğ
b
->rt_flags);

439 
out
:

440  
diff
;

442 
nh_mism©ch
:

443 
diff
 |ğ
	`ROUTE_DIFF
(
MULTIPATH
, 1);

444 
out
;

446 #undeà
ROUTE_DIFF


447 
	}
}

449 
	$rou‹_upd©e
(
Æ_objeù
 *
Şd_obj
, Æ_objeù *
Ãw_obj
)

451 
¹Æ_rou‹
 *
Ãw_rou‹
 = (¹Æ_rou‹ *è
Ãw_obj
;

452 
¹Æ_rou‹
 *
Şd_rou‹
 = (¹Æ_rou‹ *è
Şd_obj
;

453 
¹Æ_Ãxthİ
 *
Ãw_nh
;

454 
aùiÚ
 = 
Ãw_obj
->
û_msgty³
;

455 #ifdeà
NL_DEBUG


456 
buf
[
INET6_ADDRSTRLEN
+5];

466 ià(
Ãw_rou‹
->
¹_çmy
 !ğ
AF_INET6
 ||

467 
Ãw_rou‹
->
¹_bË
 =ğ
RT_TABLE_LOCAL
)

468  -
NLE_OPNOTSUPP
;

474 ià(
	`¹Æ_rou‹_g‘_Âexthİs
(
Ãw_rou‹
) != 1)

475  -
NLE_OPNOTSUPP
;

482 
Ãw_nh
 = 
	`¹Æ_rou‹_Ãxthİ_n
(
Ãw_rou‹
, 0);

483 ià(!
Ãw_nh
 || !
	`¹Æ_rou‹_nh_g‘_g©eway
(new_nh))

484  -
NLE_OPNOTSUPP
;

486 
aùiÚ
) {

487 
RTM_NEWROUTE
 : {

488 
¹Æ_Ãxthİ
 *
şÚed_nh
;

493 
şÚed_nh
 = 
	`¹Æ_rou‹_nh_şÚe
(
Ãw_nh
);

494 ià(!
şÚed_nh
)

495  -
NLE_NOMEM
;

496 
	`¹Æ_rou‹_add_Ãxthİ
(
Şd_rou‹
, 
şÚed_nh
);

498 
	`NL_DBG
(2, "Route obj %p updated. Added "

499 "Ãxthİ %°vŸ %s\n", 
Şd_rou‹
, 
şÚed_nh
,

500 
	`Æ_addr2¡r
(
şÚed_nh
->
¹nh_g©eway
, 
buf
,

501 (
buf
)));

504 
RTM_DELROUTE
 : {

505 
¹Æ_Ãxthİ
 *
Şd_nh
;

513 ià(
	`¹Æ_rou‹_g‘_Âexthİs
(
Şd_rou‹
) <= 1)

514  -
NLE_OPNOTSUPP
;

519 
	`Æ_li¡_fÜ_—ch_’Œy
(
Şd_nh
, &
Şd_rou‹
->
¹_Ãxthİs
,

520 
¹nh_li¡
) {

521 ià(!
	`¹Æ_rou‹_nh_com·»
(
Şd_nh
, 
Ãw_nh
, ~0, 0)) {

523 
	`¹Æ_rou‹_»move_Ãxthİ
(
Şd_rou‹
, 
Şd_nh
);

525 
	`NL_DBG
(2, "Route obj %p updated. Removed "

526 "Ãxthİ %°vŸ %s\n", 
Şd_rou‹
,

527 
Şd_nh
,

528 
	`Æ_addr2¡r
(
Şd_nh
->
¹nh_g©eway
, 
buf
,

529 (
buf
)));

531 
	`¹Æ_rou‹_nh_ä“
(
Şd_nh
);

538 
	`NL_DBG
(2, "Unknown‡ction‡ssociated "

539 "tØobjeù %°duršg„ou‹ upd©e\n", 
Ãw_obj
);

540  -
NLE_OPNOTSUPP
;

543  
NLE_SUCCESS
;

544 
	}
}

546 cÚ¡ 
Œªs_tbl
 
	grou‹_©Œs
[] = {

547 
__ADD
(
ROUTE_ATTR_FAMILY
, 
çmy
)

548 
__ADD
(
ROUTE_ATTR_TOS
, 
tos
)

549 
__ADD
(
ROUTE_ATTR_TABLE
, 
bË
)

550 
__ADD
(
ROUTE_ATTR_PROTOCOL
, 
´ÙocŞ
)

551 
__ADD
(
ROUTE_ATTR_SCOPE
, 
scİe
)

552 
__ADD
(
ROUTE_ATTR_TYPE
, 
ty³
)

553 
__ADD
(
ROUTE_ATTR_FLAGS
, 
æags
)

554 
__ADD
(
ROUTE_ATTR_DST
, 
d¡
)

555 
__ADD
(
ROUTE_ATTR_SRC
, 
¤c
)

556 
__ADD
(
ROUTE_ATTR_IIF
, 
iif
)

557 
__ADD
(
ROUTE_ATTR_OIF
, 
oif
)

558 
__ADD
(
ROUTE_ATTR_GATEWAY
, 
g©eway
)

559 
__ADD
(
ROUTE_ATTR_PRIO
, 
´io
)

560 
__ADD
(
ROUTE_ATTR_PREF_SRC
, 
´ef_¤c
)

561 
__ADD
(
ROUTE_ATTR_METRICS
, 
m‘rics
)

562 
__ADD
(
ROUTE_ATTR_MULTIPATH
, 
muÉ©h
)

563 
__ADD
(
ROUTE_ATTR_REALMS
, 
»®ms
)

564 
__ADD
(
ROUTE_ATTR_CACHEINFO
, 
ÿchešfo
)

567 *
	$rou‹_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

569  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
rou‹_©Œs
,

570 
	`ARRAY_SIZE
(
rou‹_©Œs
));

571 
	}
}

578 
¹Æ_rou‹
 *
	$¹Æ_rou‹_®loc
()

580  (
¹Æ_rou‹
 *è
	`Æ_objeù_®loc
(&
rou‹_obj_İs
);

581 
	}
}

583 
	$¹Æ_rou‹_g‘
(
¹Æ_rou‹
 *
rou‹
)

585 
	`Æ_objeù_g‘
((
Æ_objeù
 *è
rou‹
);

586 
	}
}

588 
	$¹Æ_rou‹_put
(
¹Æ_rou‹
 *
rou‹
)

590 
	`Æ_objeù_put
((
Æ_objeù
 *è
rou‹
);

591 
	}
}

600 
	$¹Æ_rou‹_£t_bË
(
¹Æ_rou‹
 *
rou‹
, 
ušt32_t
 
bË
)

602 
rou‹
->
¹_bË
 = 
bË
;

603 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_TABLE
;

604 
	}
}

606 
ušt32_t
 
	$¹Æ_rou‹_g‘_bË
(
¹Æ_rou‹
 *
rou‹
)

608  
rou‹
->
¹_bË
;

609 
	}
}

611 
	$¹Æ_rou‹_£t_scİe
(
¹Æ_rou‹
 *
rou‹
, 
ušt8_t
 
scİe
)

613 
rou‹
->
¹_scİe
 = 
scİe
;

614 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_SCOPE
;

615 
	}
}

617 
ušt8_t
 
	$¹Æ_rou‹_g‘_scİe
(
¹Æ_rou‹
 *
rou‹
)

619  
rou‹
->
¹_scİe
;

620 
	}
}

622 
	$¹Æ_rou‹_£t_tos
(
¹Æ_rou‹
 *
rou‹
, 
ušt8_t
 
tos
)

624 
rou‹
->
¹_tos
 = 
tos
;

625 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_TOS
;

626 
	}
}

628 
ušt8_t
 
	$¹Æ_rou‹_g‘_tos
(
¹Æ_rou‹
 *
rou‹
)

630  
rou‹
->
¹_tos
;

631 
	}
}

633 
	$¹Æ_rou‹_£t_´ÙocŞ
(
¹Æ_rou‹
 *
rou‹
, 
ušt8_t
 
´ÙocŞ
)

635 
rou‹
->
¹_´ÙocŞ
 = 
´ÙocŞ
;

636 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_PROTOCOL
;

637 
	}
}

639 
ušt8_t
 
	$¹Æ_rou‹_g‘_´ÙocŞ
(
¹Æ_rou‹
 *
rou‹
)

641  
rou‹
->
¹_´ÙocŞ
;

642 
	}
}

644 
	$¹Æ_rou‹_£t_´iÜ™y
(
¹Æ_rou‹
 *
rou‹
, 
ušt32_t
 
´io
)

646 
rou‹
->
¹_´io
 = 
´io
;

647 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_PRIO
;

648 
	}
}

650 
ušt32_t
 
	$¹Æ_rou‹_g‘_´iÜ™y
(
¹Æ_rou‹
 *
rou‹
)

652  
rou‹
->
¹_´io
;

653 
	}
}

655 
	$¹Æ_rou‹_£t_çmy
(
¹Æ_rou‹
 *
rou‹
, 
ušt8_t
 
çmy
)

657 ià(
çmy
 !ğ
AF_INET
 && famy !ğ
AF_INET6
 && famy !ğ
AF_DECÃt
)

658  -
NLE_AF_NOSUPPORT
;

660 
rou‹
->
¹_çmy
 = 
çmy
;

661 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_FAMILY
;

664 
	}
}

666 
ušt8_t
 
	$¹Æ_rou‹_g‘_çmy
(
¹Æ_rou‹
 *
rou‹
)

668  
rou‹
->
¹_çmy
;

669 
	}
}

671 
	$¹Æ_rou‹_£t_d¡
(
¹Æ_rou‹
 *
rou‹
, 
Æ_addr
 *
addr
)

673 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_FAMILY
) {

674 ià(
addr
->
a_çmy
 !ğ
rou‹
->
¹_çmy
)

675  -
NLE_AF_MISMATCH
;

677 
rou‹
->
¹_çmy
 = 
addr
->
a_çmy
;

679 ià(
rou‹
->
¹_d¡
)

680 
	`Æ_addr_put
(
rou‹
->
¹_d¡
);

682 
	`Æ_addr_g‘
(
addr
);

683 
rou‹
->
¹_d¡
 = 
addr
;

685 
rou‹
->
û_mask
 |ğ(
ROUTE_ATTR_DST
 | 
ROUTE_ATTR_FAMILY
);

688 
	}
}

690 
Æ_addr
 *
	$¹Æ_rou‹_g‘_d¡
(
¹Æ_rou‹
 *
rou‹
)

692  
rou‹
->
¹_d¡
;

693 
	}
}

695 
	$¹Æ_rou‹_£t_¤c
(
¹Æ_rou‹
 *
rou‹
, 
Æ_addr
 *
addr
)

697 ià(
addr
->
a_çmy
 =ğ
AF_INET
)

698  -
NLE_SRCRT_NOSUPPORT
;

700 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_FAMILY
) {

701 ià(
addr
->
a_çmy
 !ğ
rou‹
->
¹_çmy
)

702  -
NLE_AF_MISMATCH
;

704 
rou‹
->
¹_çmy
 = 
addr
->
a_çmy
;

706 ià(
rou‹
->
¹_¤c
)

707 
	`Æ_addr_put
(
rou‹
->
¹_¤c
);

709 
	`Æ_addr_g‘
(
addr
);

710 
rou‹
->
¹_¤c
 = 
addr
;

711 
rou‹
->
û_mask
 |ğ(
ROUTE_ATTR_SRC
 | 
ROUTE_ATTR_FAMILY
);

714 
	}
}

716 
Æ_addr
 *
	$¹Æ_rou‹_g‘_¤c
(
¹Æ_rou‹
 *
rou‹
)

718  
rou‹
->
¹_¤c
;

719 
	}
}

721 
	$¹Æ_rou‹_£t_ty³
(
¹Æ_rou‹
 *
rou‹
, 
ušt8_t
 
ty³
)

723 ià(
ty³
 > 
RTN_MAX
)

724  -
NLE_RANGE
;

726 
rou‹
->
¹_ty³
 = 
ty³
;

727 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_TYPE
;

730 
	}
}

732 
ušt8_t
 
	$¹Æ_rou‹_g‘_ty³
(
¹Æ_rou‹
 *
rou‹
)

734  
rou‹
->
¹_ty³
;

735 
	}
}

737 
	$¹Æ_rou‹_£t_æags
(
¹Æ_rou‹
 *
rou‹
, 
ušt32_t
 
æags
)

739 
rou‹
->
¹_æag_mask
 |ğ
æags
;

740 
rou‹
->
¹_æags
 |ğ
æags
;

741 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_FLAGS
;

742 
	}
}

744 
	$¹Æ_rou‹_un£t_æags
(
¹Æ_rou‹
 *
rou‹
, 
ušt32_t
 
æags
)

746 
rou‹
->
¹_æag_mask
 |ğ
æags
;

747 
rou‹
->
¹_æags
 &ğ~
æags
;

748 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_FLAGS
;

749 
	}
}

751 
ušt32_t
 
	$¹Æ_rou‹_g‘_æags
(
¹Æ_rou‹
 *
rou‹
)

753  
rou‹
->
¹_æags
;

754 
	}
}

756 
	$¹Æ_rou‹_£t_m‘ric
(
¹Æ_rou‹
 *
rou‹
, 
m‘ric
, 
ušt32_t
 
v®ue
)

758 ià(
m‘ric
 > 
RTAX_MAX
 || metric < 1)

759  -
NLE_RANGE
;

761 
rou‹
->
¹_m‘rics
[
m‘ric
 - 1] = 
v®ue
;

763 ià(!(
rou‹
->
¹_m‘rics_mask
 & (1 << (
m‘ric
 - 1)))) {

764 
rou‹
->
¹_nm‘rics
++;

765 
rou‹
->
¹_m‘rics_mask
 |ğ(1 << (
m‘ric
 - 1));

768 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_METRICS
;

771 
	}
}

773 
	$¹Æ_rou‹_un£t_m‘ric
(
¹Æ_rou‹
 *
rou‹
, 
m‘ric
)

775 ià(
m‘ric
 > 
RTAX_MAX
 || metric < 1)

776  -
NLE_RANGE
;

778 ià(
rou‹
->
¹_m‘rics_mask
 & (1 << (
m‘ric
 - 1))) {

779 
rou‹
->
¹_nm‘rics
--;

780 
rou‹
->
¹_m‘rics_mask
 &ğ~(1 << (
m‘ric
 - 1));

784 
	}
}

786 
	$¹Æ_rou‹_g‘_m‘ric
(
¹Æ_rou‹
 *
rou‹
, 
m‘ric
, 
ušt32_t
 *
v®ue
)

788 ià(
m‘ric
 > 
RTAX_MAX
 || metric < 1)

789  -
NLE_RANGE
;

791 ià(!(
rou‹
->
¹_m‘rics_mask
 & (1 << (
m‘ric
 - 1))))

792  -
NLE_OBJ_NOTFOUND
;

794 ià(
v®ue
)

795 *
v®ue
 = 
rou‹
->
¹_m‘rics
[
m‘ric
 - 1];

798 
	}
}

800 
	$¹Æ_rou‹_£t_´ef_¤c
(
¹Æ_rou‹
 *
rou‹
, 
Æ_addr
 *
addr
)

802 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_FAMILY
) {

803 ià(
addr
->
a_çmy
 !ğ
rou‹
->
¹_çmy
)

804  -
NLE_AF_MISMATCH
;

806 
rou‹
->
¹_çmy
 = 
addr
->
a_çmy
;

808 ià(
rou‹
->
¹_´ef_¤c
)

809 
	`Æ_addr_put
(
rou‹
->
¹_´ef_¤c
);

811 
	`Æ_addr_g‘
(
addr
);

812 
rou‹
->
¹_´ef_¤c
 = 
addr
;

813 
rou‹
->
û_mask
 |ğ(
ROUTE_ATTR_PREF_SRC
 | 
ROUTE_ATTR_FAMILY
);

816 
	}
}

818 
Æ_addr
 *
	$¹Æ_rou‹_g‘_´ef_¤c
(
¹Æ_rou‹
 *
rou‹
)

820  
rou‹
->
¹_´ef_¤c
;

821 
	}
}

823 
	$¹Æ_rou‹_£t_iif
(
¹Æ_rou‹
 *
rou‹
, 
ifšdex
)

825 
rou‹
->
¹_iif
 = 
ifšdex
;

826 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_IIF
;

827 
	}
}

829 
	$¹Æ_rou‹_g‘_iif
(
¹Æ_rou‹
 *
rou‹
)

831  
rou‹
->
¹_iif
;

832 
	}
}

834 
	$¹Æ_rou‹_add_Ãxthİ
(
¹Æ_rou‹
 *
rou‹
, 
¹Æ_Ãxthİ
 *
nh
)

836 
	`Æ_li¡_add_
(&
nh
->
¹nh_li¡
, &
rou‹
->
¹_Ãxthİs
);

837 
rou‹
->
¹_Ä_nh
++;

838 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_MULTIPATH
;

839 
	}
}

841 
	$¹Æ_rou‹_»move_Ãxthİ
(
¹Æ_rou‹
 *
rou‹
, 
¹Æ_Ãxthİ
 *
nh
)

843 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
) {

844 
rou‹
->
¹_Ä_nh
--;

845 
	`Æ_li¡_d–
(&
nh
->
¹nh_li¡
);

847 
	}
}

849 
Æ_li¡_h—d
 *
	$¹Æ_rou‹_g‘_Ãxthİs
(
¹Æ_rou‹
 *
rou‹
)

851 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
)

852  &
rou‹
->
¹_Ãxthİs
;

854  
NULL
;

855 
	}
}

857 
	$¹Æ_rou‹_g‘_Âexthİs
(
¹Æ_rou‹
 *
rou‹
)

859 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
)

860  
rou‹
->
¹_Ä_nh
;

863 
	}
}

865 
¹Æ_rou‹_fÜ—ch_Ãxthİ
(
¹Æ_rou‹
 *
r
,

866 (*
cb
)(
¹Æ_Ãxthİ
 *, *),

867 *
¬g
)

869 
¹Æ_Ãxthİ
 *
nh
;

871 ià(
r
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
) {

872 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
r
->
¹_Ãxthİs
, 
¹nh_li¡
) {

873 
	`cb
(
nh
, 
¬g
);

876 
	}
}

878 
¹Æ_Ãxthİ
 *
	$¹Æ_rou‹_Ãxthİ_n
(
¹Æ_rou‹
 *
r
, 
n
)

880 
¹Æ_Ãxthİ
 *
nh
;

881 
ušt32_t
 
i
;

883 ià(
r
->
û_mask
 & 
ROUTE_ATTR_MULTIPATH
 &&„->
¹_Ä_nh
 > 
n
) {

884 
i
 = 0;

885 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
r
->
¹_Ãxthİs
, 
¹nh_li¡
) {

886 ià(
i
 =ğ
n
è 
nh
;

887 
i
++;

890  
NULL
;

891 
	}
}

913 
	$¹Æ_rou‹_guess_scİe
(
¹Æ_rou‹
 *
rou‹
)

915 ià(
rou‹
->
¹_ty³
 =ğ
RTN_LOCAL
)

916  
RT_SCOPE_HOST
;

918 ià(!
	`Æ_li¡_em±y
(&
rou‹
->
¹_Ãxthİs
)) {

919 
¹Æ_Ãxthİ
 *
nh
;

925 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
rou‹
->
¹_Ãxthİs
, 
¹nh_li¡
) {

926 ià(
nh
->
¹nh_g©eway
)

927  
RT_SCOPE_UNIVERSE
;

931  
RT_SCOPE_LINK
;

932 
	}
}

936 
Æa_pŞicy
 
	grou‹_pŞicy
[
RTA_MAX
+1] = {

937 [
RTA_IIF
] = { .
ty³
 = 
NLA_U32
 },

938 [
RTA_OIF
] = { .
ty³
 = 
NLA_U32
 },

939 [
RTA_PRIORITY
] = { .
ty³
 = 
NLA_U32
 },

940 [
RTA_FLOW
] = { .
ty³
 = 
NLA_U32
 },

941 [
RTA_CACHEINFO
] = { .
mšËn
 = (
¹a_ÿchešfo
) },

942 [
RTA_METRICS
] = { .
ty³
 = 
NLA_NESTED
 },

943 [
RTA_MULTIPATH
] = { .
ty³
 = 
NLA_NESTED
 },

946 
	$·r£_muÉ©h
(
¹Æ_rou‹
 *
rou‹
, 
Æ©Œ
 *
©Œ
)

948 
¹Æ_Ãxthİ
 *
nh
 = 
NULL
;

949 
¹Ãxthİ
 *
¹nh
 = 
	`Æa_d©a
(
©Œ
);

950 
size_t
 
’
 = 
	`Æa_Ën
(
©Œ
);

951 
”r
;

953 
’
 >ğ(*
¹nh
è&&ËÀ>ğ¹nh->
¹nh_Ën
) {

954 
nh
 = 
	`¹Æ_rou‹_nh_®loc
();

955 ià(!
nh
)

956  -
NLE_NOMEM
;

958 
	`¹Æ_rou‹_nh_£t_weight
(
nh
, 
¹nh
->
¹nh_hİs
);

959 
	`¹Æ_rou‹_nh_£t_ifšdex
(
nh
, 
¹nh
->
¹nh_ifšdex
);

960 
	`¹Æ_rou‹_nh_£t_æags
(
nh
, 
¹nh
->
¹nh_æags
);

962 ià(
¹nh
->
¹nh_Ën
 > (*rtnh)) {

963 
Æ©Œ
 *
Áb
[
RTA_MAX
 + 1];

965 
”r
 = 
	`Æa_·r£
(
Áb
, 
RTA_MAX
, (
Æ©Œ
 *)

966 
	`RTNH_DATA
(
¹nh
),

967 
¹nh
->
¹nh_Ën
 - (*rtnh),

968 
rou‹_pŞicy
);

969 ià(
”r
 < 0)

970 
”rout
;

972 ià(
Áb
[
RTA_GATEWAY
]) {

973 
Æ_addr
 *
addr
;

975 
addr
 = 
	`Æ_addr_®loc_©Œ
(
Áb
[
RTA_GATEWAY
],

976 
rou‹
->
¹_çmy
);

977 ià(!
addr
) {

978 
”r
 = -
NLE_NOMEM
;

979 
”rout
;

982 
	`¹Æ_rou‹_nh_£t_g©eway
(
nh
, 
addr
);

983 
	`Æ_addr_put
(
addr
);

986 ià(
Áb
[
RTA_FLOW
]) {

987 
ušt32_t
 
»®ms
;

989 
»®ms
 = 
	`Æa_g‘_u32
(
Áb
[
RTA_FLOW
]);

990 
	`¹Æ_rou‹_nh_£t_»®ms
(
nh
, 
»®ms
);

994 
	`¹Æ_rou‹_add_Ãxthİ
(
rou‹
, 
nh
);

995 
’
 -ğ
	`RTNH_ALIGN
(
¹nh
->
¹nh_Ën
);

996 
¹nh
 = 
	`RTNH_NEXT
(rtnh);

999 
”r
 = 0;

1000 
”rout
:

1001 ià(
”r
 && 
nh
)

1002 
	`¹Æ_rou‹_nh_ä“
(
nh
);

1004  
”r
;

1005 
	}
}

1007 
	$¹Æ_rou‹_·r£
(
Æmsghdr
 *
Æh
, 
¹Æ_rou‹
 **
»suÉ
)

1009 
¹msg
 *
¹m
;

1010 
¹Æ_rou‹
 *
rou‹
;

1011 
Æ©Œ
 *
tb
[
RTA_MAX
 + 1];

1012 
Æ_addr
 *
¤c
 = 
NULL
, *
d¡
 = NULL, *
addr
;

1013 
¹Æ_Ãxthİ
 *
Şd_nh
 = 
NULL
;

1014 
”r
, 
çmy
;

1016 
rou‹
 = 
	`¹Æ_rou‹_®loc
();

1017 ià(!
rou‹
) {

1018 
”r
 = -
NLE_NOMEM
;

1019 
”rout
;

1022 
rou‹
->
û_msgty³
 = 
Æh
->
Æmsg_ty³
;

1024 
”r
 = 
	`Æmsg_·r£
(
Æh
, (
¹msg
), 
tb
, 
RTA_MAX
, 
rou‹_pŞicy
);

1025 ià(
”r
 < 0)

1026 
”rout
;

1028 
¹m
 = 
	`Æmsg_d©a
(
Æh
);

1029 
rou‹
->
¹_çmy
 = 
çmy
 = 
¹m
->
¹m_çmy
;

1030 
rou‹
->
¹_tos
 = 
¹m
->
¹m_tos
;

1031 
rou‹
->
¹_bË
 = 
¹m
->
¹m_bË
;

1032 
rou‹
->
¹_ty³
 = 
¹m
->
¹m_ty³
;

1033 
rou‹
->
¹_scİe
 = 
¹m
->
¹m_scİe
;

1034 
rou‹
->
¹_´ÙocŞ
 = 
¹m
->
¹m_´ÙocŞ
;

1035 
rou‹
->
¹_æags
 = 
¹m
->
¹m_æags
;

1036 
rou‹
->
¹_´io
 = 0;

1038 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_FAMILY
 | 
ROUTE_ATTR_TOS
 |

1039 
ROUTE_ATTR_TABLE
 | 
ROUTE_ATTR_TYPE
 |

1040 
ROUTE_ATTR_SCOPE
 | 
ROUTE_ATTR_PROTOCOL
 |

1041 
ROUTE_ATTR_FLAGS
 | 
ROUTE_ATTR_PRIO
;

1043 ià(
tb
[
RTA_DST
]) {

1044 ià(!(
d¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
RTA_DST
], 
çmy
)))

1045 
”rout_nomem
;

1047 ià(!(
d¡
 = 
	`Æ_addr_®loc
(0)))

1048 
”rout_nomem
;

1049 
	`Æ_addr_£t_çmy
(
d¡
, 
¹m
->
¹m_çmy
);

1052 
	`Æ_addr_£t_´efixËn
(
d¡
, 
¹m
->
¹m_d¡_Ën
);

1053 
”r
 = 
	`¹Æ_rou‹_£t_d¡
(
rou‹
, 
d¡
);

1054 ià(
”r
 < 0)

1055 
”rout
;

1057 
	`Æ_addr_put
(
d¡
);

1059 ià(
tb
[
RTA_SRC
]) {

1060 ià(!(
¤c
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
RTA_SRC
], 
çmy
)))

1061 
”rout_nomem
;

1062 } ià(
¹m
->
¹m_¤c_Ën
)

1063 ià(!(
¤c
 = 
	`Æ_addr_®loc
(0)))

1064 
”rout_nomem
;

1066 ià(
¤c
) {

1067 
	`Æ_addr_£t_´efixËn
(
¤c
, 
¹m
->
¹m_¤c_Ën
);

1068 
	`¹Æ_rou‹_£t_¤c
(
rou‹
, 
¤c
);

1069 
	`Æ_addr_put
(
¤c
);

1072 ià(
tb
[
RTA_TABLE
])

1073 
	`¹Æ_rou‹_£t_bË
(
rou‹
, 
	`Æa_g‘_u32
(
tb
[
RTA_TABLE
]));

1075 ià(
tb
[
RTA_IIF
])

1076 
	`¹Æ_rou‹_£t_iif
(
rou‹
, 
	`Æa_g‘_u32
(
tb
[
RTA_IIF
]));

1078 ià(
tb
[
RTA_PRIORITY
])

1079 
	`¹Æ_rou‹_£t_´iÜ™y
(
rou‹
, 
	`Æa_g‘_u32
(
tb
[
RTA_PRIORITY
]));

1081 ià(
tb
[
RTA_PREFSRC
]) {

1082 ià(!(
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
RTA_PREFSRC
], 
çmy
)))

1083 
”rout_nomem
;

1084 
	`¹Æ_rou‹_£t_´ef_¤c
(
rou‹
, 
addr
);

1085 
	`Æ_addr_put
(
addr
);

1088 ià(
tb
[
RTA_METRICS
]) {

1089 
Æ©Œ
 *
mtb
[
RTAX_MAX
 + 1];

1090 
i
;

1092 
”r
 = 
	`Æa_·r£_Ã¡ed
(
mtb
, 
RTAX_MAX
, 
tb
[
RTA_METRICS
], 
NULL
);

1093 ià(
”r
 < 0)

1094 
”rout
;

1096 
i
 = 1; i <ğ
RTAX_MAX
; i++) {

1097 ià(
mtb
[
i
] && 
	`Æa_Ën
(mtb[i]è>ğ(
ušt32_t
)) {

1098 
ušt32_t
 
m
 = 
	`Æa_g‘_u32
(
mtb
[
i
]);

1099 ià(
	`¹Æ_rou‹_£t_m‘ric
(
rou‹
, 
i
, 
m
) < 0)

1100 
”rout
;

1105 ià(
tb
[
RTA_MULTIPATH
])

1106 ià((
”r
 = 
	`·r£_muÉ©h
(
rou‹
, 
tb
[
RTA_MULTIPATH
])) < 0)

1107 
”rout
;

1109 ià(
tb
[
RTA_CACHEINFO
]) {

1110 
	`Æa_memıy
(&
rou‹
->
¹_ÿchešfo
, 
tb
[
RTA_CACHEINFO
],

1111 (
rou‹
->
¹_ÿchešfo
));

1112 
rou‹
->
û_mask
 |ğ
ROUTE_ATTR_CACHEINFO
;

1115 ià(
tb
[
RTA_OIF
]) {

1116 ià(!
Şd_nh
 && !(Şd_nh = 
	`¹Æ_rou‹_nh_®loc
()))

1117 
”rout
;

1119 
	`¹Æ_rou‹_nh_£t_ifšdex
(
Şd_nh
, 
	`Æa_g‘_u32
(
tb
[
RTA_OIF
]));

1122 ià(
tb
[
RTA_GATEWAY
]) {

1123 ià(!
Şd_nh
 && !(Şd_nh = 
	`¹Æ_rou‹_nh_®loc
()))

1124 
”rout
;

1126 ià(!(
addr
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
RTA_GATEWAY
], 
çmy
)))

1127 
”rout_nomem
;

1129 
	`¹Æ_rou‹_nh_£t_g©eway
(
Şd_nh
, 
addr
);

1130 
	`Æ_addr_put
(
addr
);

1133 ià(
tb
[
RTA_FLOW
]) {

1134 ià(!
Şd_nh
 && !(Şd_nh = 
	`¹Æ_rou‹_nh_®loc
()))

1135 
”rout
;

1137 
	`¹Æ_rou‹_nh_£t_»®ms
(
Şd_nh
, 
	`Æa_g‘_u32
(
tb
[
RTA_FLOW
]));

1140 ià(
Şd_nh
) {

1141 
	`¹Æ_rou‹_nh_£t_æags
(
Şd_nh
, 
¹m
->
¹m_æags
 & 0xff);

1142 ià(
rou‹
->
¹_Ä_nh
 == 0) {

1146 
	`¹Æ_rou‹_add_Ãxthİ
(
rou‹
, 
Şd_nh
);

1150 
¹Æ_Ãxthİ
 *
fœ¡
;

1152 
fœ¡
 = 
	`Æ_li¡_fœ¡_’Œy
(&
rou‹
->
¹_Ãxthİs
,

1153 
¹Æ_Ãxthİ
,

1154 
¹nh_li¡
);

1155 ià(!
fœ¡
)

1156 
	`BUG
();

1158 ià(
	`¹Æ_rou‹_nh_com·»
(
Şd_nh
, 
fœ¡
,

1159 
Şd_nh
->
û_mask
, 0)) {

1160 
”r
 = -
NLE_INVAL
;

1161 
”rout
;

1164 
	`¹Æ_rou‹_nh_ä“
(
Şd_nh
);

1168 *
»suÉ
 = 
rou‹
;

1171 
”rout
:

1172 
	`¹Æ_rou‹_put
(
rou‹
);

1173  
”r
;

1175 
”rout_nomem
:

1176 
”r
 = -
NLE_NOMEM
;

1177 
”rout
;

1178 
	}
}

1180 
	$¹Æ_rou‹_bud_msg
(
Æ_msg
 *
msg
, 
¹Æ_rou‹
 *
rou‹
)

1182 
i
;

1183 
Æ©Œ
 *
m‘rics
;

1184 
¹msg
„tmsg = {

1185 .
¹m_çmy
 = 
rou‹
->
¹_çmy
,

1186 .
¹m_tos
 = 
rou‹
->
¹_tos
,

1187 .
¹m_bË
 = 
rou‹
->
¹_bË
,

1188 .
¹m_´ÙocŞ
 = 
rou‹
->
¹_´ÙocŞ
,

1189 .
¹m_scİe
 = 
rou‹
->
¹_scİe
,

1190 .
¹m_ty³
 = 
rou‹
->
¹_ty³
,

1191 .
¹m_æags
 = 
rou‹
->
¹_æags
,

1194 ià(
rou‹
->
¹_d¡
 =ğ
NULL
)

1195  -
NLE_MISSING_ATTR
;

1197 
¹msg
.
¹m_d¡_Ën
 = 
	`Æ_addr_g‘_´efixËn
(
rou‹
->
¹_d¡
);

1198 ià(
rou‹
->
¹_¤c
)

1199 
¹msg
.
¹m_¤c_Ën
 = 
	`Æ_addr_g‘_´efixËn
(
rou‹
->
¹_¤c
);

1201 ià(!(
rou‹
->
û_mask
 & 
ROUTE_ATTR_SCOPE
))

1202 
¹msg
.
¹m_scİe
 = 
	`¹Æ_rou‹_guess_scİe
(
rou‹
);

1204 ià(
	`¹Æ_rou‹_g‘_Âexthİs
(
rou‹
) == 1) {

1205 
¹Æ_Ãxthİ
 *
nh
;

1206 
nh
 = 
	`¹Æ_rou‹_Ãxthİ_n
(
rou‹
, 0);

1207 
¹msg
.
¹m_æags
 |ğ
nh
->
¹nh_æags
;

1210 ià(
	`Æmsg_­³nd
(
msg
, &
¹msg
, Ôtmsg), 
NLMSG_ALIGNTO
) < 0)

1211 
Æa_put_çu»
;

1215 
	`NLA_PUT_U32
(
msg
, 
RTA_TABLE
, 
rou‹
->
¹_bË
);

1217 ià(
	`Æ_addr_g‘_Ën
(
rou‹
->
¹_d¡
))

1218 
	`NLA_PUT_ADDR
(
msg
, 
RTA_DST
, 
rou‹
->
¹_d¡
);

1219 
	`NLA_PUT_U32
(
msg
, 
RTA_PRIORITY
, 
rou‹
->
¹_´io
);

1221 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_SRC
)

1222 
	`NLA_PUT_ADDR
(
msg
, 
RTA_SRC
, 
rou‹
->
¹_¤c
);

1224 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_PREF_SRC
)

1225 
	`NLA_PUT_ADDR
(
msg
, 
RTA_PREFSRC
, 
rou‹
->
¹_´ef_¤c
);

1227 ià(
rou‹
->
û_mask
 & 
ROUTE_ATTR_IIF
)

1228 
	`NLA_PUT_U32
(
msg
, 
RTA_IIF
, 
rou‹
->
¹_iif
);

1230 ià(
rou‹
->
¹_nm‘rics
 > 0) {

1231 
ušt32_t
 
v®
;

1233 
m‘rics
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
RTA_METRICS
);

1234 ià(
m‘rics
 =ğ
NULL
)

1235 
Æa_put_çu»
;

1237 
i
 = 1; i <ğ
RTAX_MAX
; i++) {

1238 ià(!
	`¹Æ_rou‹_g‘_m‘ric
(
rou‹
, 
i
, &
v®
))

1239 
	`NLA_PUT_U32
(
msg
, 
i
, 
v®
);

1242 
	`Æa_Ã¡_’d
(
msg
, 
m‘rics
);

1245 ià(
	`¹Æ_rou‹_g‘_Âexthİs
(
rou‹
) == 1) {

1246 
¹Æ_Ãxthİ
 *
nh
;

1248 
nh
 = 
	`¹Æ_rou‹_Ãxthİ_n
(
rou‹
, 0);

1249 ià(
nh
->
¹nh_g©eway
)

1250 
	`NLA_PUT_ADDR
(
msg
, 
RTA_GATEWAY
, 
nh
->
¹nh_g©eway
);

1251 ià(
nh
->
¹nh_ifšdex
)

1252 
	`NLA_PUT_U32
(
msg
, 
RTA_OIF
, 
nh
->
¹nh_ifšdex
);

1253 ià(
nh
->
¹nh_»®ms
)

1254 
	`NLA_PUT_U32
(
msg
, 
RTA_FLOW
, 
nh
->
¹nh_»®ms
);

1255 } ià(
	`¹Æ_rou‹_g‘_Âexthİs
(
rou‹
) > 1) {

1256 
Æ©Œ
 *
muÉ©h
;

1257 
¹Æ_Ãxthİ
 *
nh
;

1259 ià(!(
muÉ©h
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
RTA_MULTIPATH
)))

1260 
Æa_put_çu»
;

1262 
	`Æ_li¡_fÜ_—ch_’Œy
(
nh
, &
rou‹
->
¹_Ãxthİs
, 
¹nh_li¡
) {

1263 
¹Ãxthİ
 *
¹nh
;

1265 
¹nh
 = 
	`Æmsg_»£rve
(
msg
, (*¹nh), 
NLMSG_ALIGNTO
);

1266 ià(!
¹nh
)

1267 
Æa_put_çu»
;

1269 
¹nh
->
¹nh_æags
 = 
nh
->rtnh_flags;

1270 
¹nh
->
¹nh_hİs
 = 
nh
->
¹nh_weight
;

1271 
¹nh
->
¹nh_ifšdex
 = 
nh
->rtnh_ifindex;

1273 ià(
nh
->
¹nh_g©eway
)

1274 
	`NLA_PUT_ADDR
(
msg
, 
RTA_GATEWAY
,

1275 
nh
->
¹nh_g©eway
);

1277 ià(
nh
->
¹nh_»®ms
)

1278 
	`NLA_PUT_U32
(
msg
, 
RTA_FLOW
, 
nh
->
¹nh_»®ms
);

1280 
¹nh
->
¹nh_Ën
 = 
	`Æmsg_
(
msg
->
nm_Æh
) -

1281 (*è
¹nh
;

1284 
	`Æa_Ã¡_’d
(
msg
, 
muÉ©h
);

1289 
Æa_put_çu»
:

1290  -
NLE_MSGSIZE
;

1291 
	}
}

1294 
Æ_objeù_İs
 
	grou‹_obj_İs
 = {

1295 .
oo_Çme
 = "route/route",

1296 .
	goo_size
 = (
¹Æ_rou‹
),

1297 .
	goo_cÚ¡ruùÜ
 = 
rou‹_cÚ¡ruùÜ
,

1298 .
	goo_ä“_d©a
 = 
rou‹_ä“_d©a
,

1299 .
	goo_şÚe
 = 
rou‹_şÚe
,

1300 .
	goo_dump
 = {

1301 [
NL_DUMP_LINE
] = 
rou‹_dump_lše
,

1302 [
NL_DUMP_DETAILS
] = 
rou‹_dump_d‘as
,

1303 [
NL_DUMP_STATS
] = 
rou‹_dump_¡©s
,

1305 .
	goo_com·»
 = 
rou‹_com·»
,

1306 .
	goo_keyg’
 = 
rou‹_keyg’
,

1307 .
	goo_upd©e
 = 
rou‹_upd©e
,

1308 .
	goo_©Œs2¡r
 = 
rou‹_©Œs2¡r
,

1309 .
	goo_id_©Œs
 = (
ROUTE_ATTR_FAMILY
 | 
ROUTE_ATTR_TOS
 |

1310 
ROUTE_ATTR_TABLE
 | 
ROUTE_ATTR_DST
 |

1311 
ROUTE_ATTR_PRIO
),

	@mylibnl/libnl-3.2.25/lib/route/route_utils.c

40 
	~<Ãšk-´iv©e/Ãšk.h
>

41 
	~<Ãšk/Ãšk.h
>

42 
	~<Ãšk/uts.h
>

43 
	~<Ãšk/rou‹/¹Æ.h
>

44 
	~<Ãšk/rou‹/rou‹.h
>

51 
NL_LIST_HEAD
(
bË_Çmes
);

53 
	$add_routšg_bË_Çme
(
id
, cÚ¡ *
Çme
)

55  
	`__Œªs_li¡_add
(
id
, 
Çme
, &
bË_Çmes
);

56 
	}
}

58 
__š™
 
	$š™_routšg_bË_Çmes
()

60 
	`add_routšg_bË_Çme
(
RT_TABLE_UNSPEC
, "unspec");

61 
	`add_routšg_bË_Çme
(
RT_TABLE_COMPAT
, "compat");

62 
	`add_routšg_bË_Çme
(
RT_TABLE_DEFAULT
, "default");

63 
	`add_routšg_bË_Çme
(
RT_TABLE_MAIN
, "main");

64 
	`add_routšg_bË_Çme
(
RT_TABLE_LOCAL
, "local");

65 
	}
};

67 
__ex™
 
	$»Ëa£_routšg_bË_Çmes
()

69 
	`__Œªs_li¡_ş—r
(&
bË_Çmes
);

70 
	}
}

72 
	$¹Æ_rou‹_»ad_bË_Çmes
(cÚ¡ *
·th
)

74 
	`__Œªs_li¡_ş—r
(&
bË_Çmes
);

76  
	`__Æ_»ad_num_¡r_fe
(
·th
, &
add_routšg_bË_Çme
);

77 
	}
}

79 *
	$¹Æ_rou‹_bË2¡r
(
bË
, *
buf
, 
size_t
 
size
)

81  
	`__li¡_ty³2¡r
(
bË
, 
buf
, 
size
, &
bË_Çmes
);

82 
	}
}

84 
	$¹Æ_rou‹_¡r2bË
(cÚ¡ *
Çme
)

86  
	`__li¡_¡r2ty³
(
Çme
, &
bË_Çmes
);

87 
	}
}

97 
NL_LIST_HEAD
(
´Ùo_Çmes
);

99 
	$add_´Ùo_Çme
(
id
, cÚ¡ *
Çme
)

101  
	`__Œªs_li¡_add
(
id
, 
Çme
, &
´Ùo_Çmes
);

102 
	}
}

104 
__š™
 
	$š™_´Ùo_Çmes
()

106 
	`add_´Ùo_Çme
(
RTPROT_UNSPEC
, "unspec");

107 
	`add_´Ùo_Çme
(
RTPROT_REDIRECT
, "redirect");

108 
	`add_´Ùo_Çme
(
RTPROT_KERNEL
, "kernel");

109 
	`add_´Ùo_Çme
(
RTPROT_BOOT
, "boot");

110 
	`add_´Ùo_Çme
(
RTPROT_STATIC
, "static");

111 
	}
};

113 
__ex™
 
	$»Ëa£_´Ùo_Çmes
()

115 
	`__Œªs_li¡_ş—r
(&
´Ùo_Çmes
);

116 
	}
}

118 
	$¹Æ_rou‹_»ad_´ÙocŞ_Çmes
(cÚ¡ *
·th
)

120 
	`__Œªs_li¡_ş—r
(&
´Ùo_Çmes
);

122  
	`__Æ_»ad_num_¡r_fe
(
·th
, &
add_´Ùo_Çme
);

123 
	}
}

125 *
	$¹Æ_rou‹_´Ùo2¡r
(
´Ùo
, *
buf
, 
size_t
 
size
)

127  
	`__li¡_ty³2¡r
(
´Ùo
, 
buf
, 
size
, &
´Ùo_Çmes
);

128 
	}
}

130 
	$¹Æ_rou‹_¡r2´Ùo
(cÚ¡ *
Çme
)

132  
	`__li¡_¡r2ty³
(
Çme
, &
´Ùo_Çmes
);

133 
	}
}

142 cÚ¡ 
Œªs_tbl
 
	grou‹_m‘riûs
[] = {

143 
__ADD
(
RTAX_UNSPEC
, 
un¥ec
)

144 
__ADD
(
RTAX_LOCK
, 
lock
)

145 
__ADD
(
RTAX_MTU
, 
mtu
)

146 
__ADD
(
RTAX_WINDOW
, 
wšdow
)

147 
__ADD
(
RTAX_RTT
, 
¹t
)

148 
__ADD
(
RTAX_RTTVAR
, 
¹tv¬
)

149 
__ADD
(
RTAX_SSTHRESH
, 
s¡h»sh
)

150 
__ADD
(
RTAX_CWND
, 
cwnd
)

151 
__ADD
(
RTAX_ADVMSS
, 
advmss
)

152 
__ADD
(
RTAX_REORDERING
, 
»Üd”šg
)

153 
__ADD
(
RTAX_HOPLIMIT
, 
hİlim™
)

154 
__ADD
(
RTAX_INITCWND
, 
š™cwnd
)

155 
__ADD
(
RTAX_FEATURES
, 
ã©u»s
)

158 *
	$¹Æ_rou‹_m‘ric2¡r
(
m‘ric
, *
buf
, 
size_t
 
size
)

160  
	`__ty³2¡r
(
m‘ric
, 
buf
, 
size
, 
rou‹_m‘riûs
,

161 
	`ARRAY_SIZE
(
rou‹_m‘riûs
));

162 
	}
}

164 
	$¹Æ_rou‹_¡r2m‘ric
(cÚ¡ *
Çme
)

166  
	`__¡r2ty³
(
Çme
, 
rou‹_m‘riûs
, 
	`ARRAY_SIZE
(route_metrices));

167 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/rtnl.c

17 
	~<Ãšk-´iv©e/Ãšk.h
>

18 
	~<Ãšk/Ãšk.h
>

19 
	~<Ãšk/uts.h
>

20 
	~<Ãšk/rou‹/¹Æ.h
>

41 
	$Æ_¹g’_»que¡
(
Æ_sock
 *
sk
, 
ty³
, 
çmy
, 
æags
)

43 
”r
;

44 
¹g’msg
 
gmsg
 = {

45 .
¹g’_çmy
 = 
çmy
,

48 
”r
 = 
	`Æ_£nd_sim¶e
(
sk
, 
ty³
, 
æags
, &
gmsg
, (gmsg));

50  
”r
 >= 0 ? 0 :ƒrr;

51 
	}
}

60 cÚ¡ 
Œªs_tbl
 
	g¹Áy³s
[] = {

61 
__ADD
(
RTN_UNSPEC
,
un¥ec
)

62 
__ADD
(
RTN_UNICAST
,
uniÿ¡
)

63 
__ADD
(
RTN_LOCAL
,
loÿl
)

64 
__ADD
(
RTN_BROADCAST
,
brßdÿ¡
)

65 
__ADD
(
RTN_ANYCAST
,
ªyÿ¡
)

66 
__ADD
(
RTN_MULTICAST
,
muÉiÿ¡
)

67 
__ADD
(
RTN_BLACKHOLE
,
bÏckhŞe
)

68 
__ADD
(
RTN_UNREACHABLE
,
uÄ—chabË
)

69 
__ADD
(
RTN_PROHIBIT
,
´ohib™
)

70 
__ADD
(
RTN_THROW
,
throw
)

71 
__ADD
(
RTN_NAT
,
Çt
)

72 
__ADD
(
RTN_XRESOLVE
,
x»sŞve
)

75 *
	$Æ_¹Áy³2¡r
(
ty³
, *
buf
, 
size_t
 
size
)

77  
	`__ty³2¡r
(
ty³
, 
buf
, 
size
, 
¹Áy³s
, 
	`ARRAY_SIZE
(rtntypes));

78 
	}
}

80 
	$Æ_¡r2¹Áy³
(cÚ¡ *
Çme
)

82  
	`__¡r2ty³
(
Çme
, 
¹Áy³s
, 
	`ARRAY_SIZE
(rtntypes));

83 
	}
}

92 cÚ¡ 
Œªs_tbl
 
	gscİes
[] = {

93 
__ADD
(255,
nowh”e
)

94 
__ADD
(254,
ho¡
)

95 
__ADD
(253,
lšk
)

96 
__ADD
(200,
s™e
)

97 
__ADD
(0,
glob®
)

100 *
	$¹Æ_scİe2¡r
(
scİe
, *
buf
, 
size_t
 
size
)

102  
	`__ty³2¡r
(
scİe
, 
buf
, 
size
, 
scİes
, 
	`ARRAY_SIZE
(scopes));

103 
	}
}

105 
	$¹Æ_¡r2scİe
(cÚ¡ *
Çme
)

107  
	`__¡r2ty³
(
Çme
, 
scİes
, 
	`ARRAY_SIZE
(scopes));

108 
	}
}

117 * 
	$¹Æ_»®ms2¡r
(
ušt32_t
 
»®ms
, *
buf
, 
size_t
 
Ën
)

119 
äom
 = 
	`RTNL_REALM_FROM
(
»®ms
);

120 
to
 = 
	`RTNL_REALM_TO
(
»®ms
);

122 
	`¢´štf
(
buf
, 
Ën
, "%d/%d", 
äom
, 
to
);

124  
buf
;

125 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/rule.c

19 
	~<Ãšk-´iv©e/Ãšk.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk/rou‹/¹Æ.h
>

23 
	~<Ãšk/rou‹/ruË.h
>

24 
	~<š‰y³s.h
>

27 
	#RULE_ATTR_FAMILY
 0x0001

	)

28 
	#RULE_ATTR_TABLE
 0x0002

	)

29 
	#RULE_ATTR_ACTION
 0x0004

	)

30 
	#RULE_ATTR_FLAGS
 0x0008

	)

31 
	#RULE_ATTR_IIFNAME
 0x0010

	)

32 
	#RULE_ATTR_OIFNAME
 0x0020

	)

33 
	#RULE_ATTR_PRIO
 0x0040

	)

34 
	#RULE_ATTR_MARK
 0x0080

	)

35 
	#RULE_ATTR_MASK
 0x0100

	)

36 
	#RULE_ATTR_GOTO
 0x0200

	)

37 
	#RULE_ATTR_SRC
 0x0400

	)

38 
	#RULE_ATTR_DST
 0x0800

	)

39 
	#RULE_ATTR_DSFIELD
 0x1000

	)

40 
	#RULE_ATTR_FLOW
 0x2000

	)

42 
Æ_ÿche_İs
 
	g¹Æ_ruË_İs
;

43 
Æ_objeù_İs
 
	gruË_obj_İs
;

46 
	$ruË_ä“_d©a
(
Æ_objeù
 *
c
)

48 
¹Æ_ruË
 *
ruË
 = 
	`Æ_objeù_´iv
(
c
);

50 ià(!
ruË
)

53 
	`Æ_addr_put
(
ruË
->
r_¤c
);

54 
	`Æ_addr_put
(
ruË
->
r_d¡
);

55 
	}
}

57 
	$ruË_şÚe
(
Æ_objeù
 *
_d¡
, Æ_objeù *
_¤c
)

59 
¹Æ_ruË
 *
d¡
 = 
	`Æ_objeù_´iv
(
_d¡
);

60 
¹Æ_ruË
 *
¤c
 = 
	`Æ_objeù_´iv
(
_¤c
);

62 ià(
¤c
->
r_¤c
)

63 ià(!(
d¡
->
r_¤c
 = 
	`Æ_addr_şÚe
(
¤c
->r_src)))

64  -
NLE_NOMEM
;

66 ià(
¤c
->
r_d¡
)

67 ià(!(
d¡
->
r_d¡
 = 
	`Æ_addr_şÚe
(
¤c
->r_dst)))

68  -
NLE_NOMEM
;

71 
	}
}

73 
Æa_pŞicy
 
	gruË_pŞicy
[
FRA_MAX
+1] = {

74 [
FRA_TABLE
] = { .
ty³
 = 
NLA_U32
 },

75 [
FRA_IIFNAME
] = { .
ty³
 = 
NLA_STRING
, .
	gmaxËn
 = 
IFNAMSIZ
 },

76 [
FRA_OIFNAME
] = { .
ty³
 = 
NLA_STRING
, .
	gmaxËn
 = 
IFNAMSIZ
 },

77 [
FRA_PRIORITY
] = { .
ty³
 = 
NLA_U32
 },

78 [
FRA_FWMARK
] = { .
ty³
 = 
NLA_U32
 },

79 [
FRA_FWMASK
] = { .
ty³
 = 
NLA_U32
 },

80 [
FRA_GOTO
] = { .
ty³
 = 
NLA_U32
 },

81 [
FRA_FLOW
] = { .
ty³
 = 
NLA_U32
 },

84 
	$ruË_msg_·r£r
(
Æ_ÿche_İs
 *
İs
, 
sockaddr_Æ
 *
who
,

85 
Æmsghdr
 *
n
, 
Æ_·r£r_·¿m
 *
µ
)

87 
¹Æ_ruË
 *
ruË
;

88 
fib_ruË_hdr
 *
äh
;

89 
Æ©Œ
 *
tb
[
FRA_MAX
+1];

90 
”r
 = 1, 
çmy
;

92 
ruË
 = 
	`¹Æ_ruË_®loc
();

93 ià(!
ruË
) {

94 
”r
 = -
NLE_NOMEM
;

95 
”rout
;

98 
ruË
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

99 
äh
 = 
	`Æmsg_d©a
(
n
);

101 
”r
 = 
	`Æmsg_·r£
(
n
, (*
äh
), 
tb
, 
FRA_MAX
, 
ruË_pŞicy
);

102 ià(
”r
 < 0)

103 
”rout
;

105 
ruË
->
r_çmy
 = 
çmy
 = 
äh
->family;

106 
ruË
->
r_bË
 = 
äh
->
bË
;

107 
ruË
->
r_aùiÚ
 = 
äh
->
aùiÚ
;

108 
ruË
->
r_æags
 = 
äh
->
æags
;

110 
ruË
->
û_mask
 = (
RULE_ATTR_FAMILY
 | 
RULE_ATTR_TABLE
 | 
RULE_ATTR_ACTION
 |

111 
RULE_ATTR_FLAGS
);

114 ià(
äh
->
tos
) {

115 
ruË
->
r_dsf›ld
 = 
äh
->
tos
;

116 
ruË
->
û_mask
 |ğ
RULE_ATTR_DSFIELD
;

119 ià(
tb
[
FRA_TABLE
]) {

120 
ruË
->
r_bË
 = 
	`Æa_g‘_u32
(
tb
[
FRA_TABLE
]);

121 
ruË
->
û_mask
 |ğ
RULE_ATTR_TABLE
;

124 ià(
tb
[
FRA_IIFNAME
]) {

125 
	`Æa_¡¾ıy
(
ruË
->
r_iiâame
, 
tb
[
FRA_IIFNAME
], 
IFNAMSIZ
);

126 
ruË
->
û_mask
 |ğ
RULE_ATTR_IIFNAME
;

129 ià(
tb
[
FRA_OIFNAME
]) {

130 
	`Æa_¡¾ıy
(
ruË
->
r_oiâame
, 
tb
[
FRA_OIFNAME
], 
IFNAMSIZ
);

131 
ruË
->
û_mask
 |ğ
RULE_ATTR_OIFNAME
;

134 ià(
tb
[
FRA_PRIORITY
]) {

135 
ruË
->
r_´io
 = 
	`Æa_g‘_u32
(
tb
[
FRA_PRIORITY
]);

136 
ruË
->
û_mask
 |ğ
RULE_ATTR_PRIO
;

139 ià(
tb
[
FRA_FWMARK
]) {

140 
ruË
->
r_m¬k
 = 
	`Æa_g‘_u32
(
tb
[
FRA_FWMARK
]);

141 
ruË
->
û_mask
 |ğ
RULE_ATTR_MARK
;

144 ià(
tb
[
FRA_FWMASK
]) {

145 
ruË
->
r_mask
 = 
	`Æa_g‘_u32
(
tb
[
FRA_FWMASK
]);

146 
ruË
->
û_mask
 |ğ
RULE_ATTR_MASK
;

149 ià(
tb
[
FRA_GOTO
]) {

150 
ruË
->
r_gÙo
 = 
	`Æa_g‘_u32
(
tb
[
FRA_GOTO
]);

151 
ruË
->
û_mask
 |ğ
RULE_ATTR_GOTO
;

154 ià(
tb
[
FRA_SRC
]) {

155 ià(!(
ruË
->
r_¤c
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
FRA_SRC
], 
çmy
)))

156 
”rout_’omem
;

158 
	`Æ_addr_£t_´efixËn
(
ruË
->
r_¤c
, 
äh
->
¤c_Ën
);

159 
ruË
->
û_mask
 |ğ
RULE_ATTR_SRC
;

162 ià(
tb
[
FRA_DST
]) {

163 ià(!(
ruË
->
r_d¡
 = 
	`Æ_addr_®loc_©Œ
(
tb
[
FRA_DST
], 
çmy
)))

164 
”rout_’omem
;

165 
	`Æ_addr_£t_´efixËn
(
ruË
->
r_d¡
, 
äh
->
d¡_Ën
);

166 
ruË
->
û_mask
 |ğ
RULE_ATTR_DST
;

170 ià(
tb
[
FRA_FLOW
]) {

171 
ruË
->
r_æow
 = 
	`Æa_g‘_u32
(
tb
[
FRA_FLOW
]);

172 
ruË
->
û_mask
 |ğ
RULE_ATTR_FLOW
;

175 
”r
 = 
µ
->
	`µ_cb
((
Æ_objeù
 *è
ruË
,…p);

176 
”rout
:

177 
	`¹Æ_ruË_put
(
ruË
);

178  
”r
;

180 
”rout_’omem
:

181 
”r
 = -
NLE_NOMEM
;

182 
”rout
;

183 
	}
}

185 
	$ruË_»que¡_upd©e
(
Æ_ÿche
 *
c
, 
Æ_sock
 *
h
)

187  
	`Æ_¹g’_»que¡
(
h
, 
RTM_GETRULE
, 
AF_UNSPEC
, 
NLM_F_DUMP
);

188 
	}
}

190 
	$ruË_dump_lše
(
Æ_objeù
 *
o
, 
Æ_dump_·¿ms
 *
p
)

192 
¹Æ_ruË
 *
r
 = (¹Æ_ruË *è
o
;

193 
buf
[128];

195 
	`Æ_dump_lše
(
p
, "%8d ", (
r
->
û_mask
 & 
RULE_ATTR_PRIO
è?„->
r_´io
 : 0);

196 
	`Æ_dump
(
p
, "% ", 
	`Æ_af2¡r
(
r
->
r_çmy
, 
buf
, (buf)));

198 ià(
r
->
û_mask
 & 
RULE_ATTR_SRC
)

199 
	`Æ_dump
(
p
, "from %s ",

200 
	`Æ_addr2¡r
(
r
->
r_¤c
, 
buf
, (buf)));

202 ià(
r
->
û_mask
 & 
RULE_ATTR_DST
)

203 
	`Æ_dump
(
p
, "to %s ",

204 
	`Æ_addr2¡r
(
r
->
r_d¡
, 
buf
, (buf)));

206 ià(
r
->
û_mask
 & 
RULE_ATTR_DSFIELD
)

207 
	`Æ_dump
(
p
, "to %u ", 
r
->
r_dsf›ld
);

209 ià(
r
->
û_mask
 & (
RULE_ATTR_MARK
 | 
RULE_ATTR_MASK
))

210 
	`Æ_dump
(
p
, "m¬k %#x/%#x", 
r
->
r_m¬k
,„->
r_mask
);

212 ià(
r
->
û_mask
 & 
RULE_ATTR_IIFNAME
)

213 
	`Æ_dump
(
p
, "iià% ", 
r
->
r_iiâame
);

215 ià(
r
->
û_mask
 & 
RULE_ATTR_OIFNAME
)

216 
	`Æ_dump
(
p
, "oià% ", 
r
->
r_oiâame
);

218 ià(
r
->
û_mask
 & 
RULE_ATTR_TABLE
)

219 
	`Æ_dump
(
p
, "lookup %s ",

220 
	`¹Æ_rou‹_bË2¡r
(
r
->
r_bË
, 
buf
, (buf)));

222 ià(
r
->
û_mask
 & 
RULE_ATTR_FLOW
)

223 
	`Æ_dump
(
p
, "flow %s ",

224 
	`¹Æ_»®ms2¡r
(
r
->
r_æow
, 
buf
, (buf)));

226 ià(
r
->
û_mask
 & 
RULE_ATTR_GOTO
)

227 
	`Æ_dump
(
p
, "gÙØ%u ", 
r
->
r_gÙo
);

229 ià(
r
->
û_mask
 & 
RULE_ATTR_ACTION
)

230 
	`Æ_dump
(
p
, "action %s",

231 
	`Æ_¹Áy³2¡r
(
r
->
r_aùiÚ
, 
buf
, (buf)));

233 
	`Æ_dump
(
p
, "\n");

234 
	}
}

236 
	$ruË_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

238 
	`ruË_dump_lše
(
obj
, 
p
);

239 
	}
}

241 
	$ruË_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

243 
	`ruË_dump_d‘as
(
obj
, 
p
);

244 
	}
}

246 
	#RULE_ATTR_FLAGS
 0x0008

	)

248 
	$ruË_com·»
(
Æ_objeù
 *
_a
, Æ_objeù *
_b
,

249 
ušt32_t
 
©Œs
, 
æags
)

251 
¹Æ_ruË
 *
a
 = (¹Æ_ruË *è
_a
;

252 
¹Æ_ruË
 *
b
 = (¹Æ_ruË *è
_b
;

253 
diff
 = 0;

255 
	#RULE_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
RULE_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

257 
diff
 |ğ
	`RULE_DIFF
(
FAMILY
, 
a
->
r_çmy
 !ğ
b
->r_family);

258 
diff
 |ğ
	`RULE_DIFF
(
TABLE
, 
a
->
r_bË
 !ğ
b
->r_table);

259 
diff
 |ğ
	`RULE_DIFF
(
ACTION
, 
a
->
r_aùiÚ
 !ğ
b
->r_action);

260 
diff
 |ğ
	`RULE_DIFF
(
IIFNAME
, 
	`¡rcmp
(
a
->
r_iiâame
, 
b
->r_iifname));

261 
diff
 |ğ
	`RULE_DIFF
(
OIFNAME
, 
	`¡rcmp
(
a
->
r_oiâame
, 
b
->r_oifname));

262 
diff
 |ğ
	`RULE_DIFF
(
PRIO
, 
a
->
r_´io
 !ğ
b
->r_prio);

263 
diff
 |ğ
	`RULE_DIFF
(
MARK
, 
a
->
r_m¬k
 !ğ
b
->r_mark);

264 
diff
 |ğ
	`RULE_DIFF
(
MASK
, 
a
->
r_mask
 !ğ
b
->r_mask);

265 
diff
 |ğ
	`RULE_DIFF
(
GOTO
, 
a
->
r_gÙo
 !ğ
b
->r_goto);

266 
diff
 |ğ
	`RULE_DIFF
(
SRC
, 
	`Æ_addr_cmp
(
a
->
r_¤c
, 
b
->r_src));

267 
diff
 |ğ
	`RULE_DIFF
(
DST
, 
	`Æ_addr_cmp
(
a
->
r_d¡
, 
b
->r_dst));

268 
diff
 |ğ
	`RULE_DIFF
(
DSFIELD
, 
a
->
r_dsf›ld
 !ğ
b
->r_dsfield);

269 
diff
 |ğ
	`RULE_DIFF
(
FLOW
, 
a
->
r_æow
 !ğ
b
->r_flow);

271 #undeà
RULE_DIFF


273  
diff
;

274 
	}
}

276 cÚ¡ 
Œªs_tbl
 
	gruË_©Œs
[] = {

277 
__ADD
(
RULE_ATTR_FAMILY
, 
çmy
)

278 
__ADD
(
RULE_ATTR_TABLE
, 
bË
)

279 
__ADD
(
RULE_ATTR_ACTION
, 
aùiÚ
)

280 
__ADD
(
RULE_ATTR_IIFNAME
, 
iiâame
)

281 
__ADD
(
RULE_ATTR_OIFNAME
, 
oiâame
)

282 
__ADD
(
RULE_ATTR_PRIO
, 
´io
)

283 
__ADD
(
RULE_ATTR_MARK
, 
m¬k
)

284 
__ADD
(
RULE_ATTR_MASK
, 
mask
)

285 
__ADD
(
RULE_ATTR_GOTO
, )

286 
__ADD
(
RULE_ATTR_SRC
, 
¤c
)

287 
__ADD
(
RULE_ATTR_DST
, 
d¡
)

288 
__ADD
(
RULE_ATTR_DSFIELD
, 
dsf›ld
)

289 
__ADD
(
RULE_ATTR_FLOW
, 
æow
)

292 *
	$ruË_©Œs2¡r
(
©Œs
, *
buf
, 
size_t
 
Ën
)

294  
	`__æags2¡r
(
©Œs
, 
buf
, 
Ën
, 
ruË_©Œs
,

295 
	`ARRAY_SIZE
(
ruË_©Œs
));

296 
	}
}

303 
¹Æ_ruË
 *
	$¹Æ_ruË_®loc
()

305  (
¹Æ_ruË
 *è
	`Æ_objeù_®loc
(&
ruË_obj_İs
);

306 
	}
}

308 
	$¹Æ_ruË_put
(
¹Æ_ruË
 *
ruË
)

310 
	`Æ_objeù_put
((
Æ_objeù
 *è
ruË
);

311 
	}
}

331 
	$¹Æ_ruË_®loc_ÿche
(
Æ_sock
 *
sock
, 
çmy
,

332 
Æ_ÿche
 **
»suÉ
)

334 
Æ_ÿche
 * 
ÿche
;

335 
”r
;

337 ià(!(
ÿche
 = 
	`Æ_ÿche_®loc
(&
¹Æ_ruË_İs
)))

338  -
NLE_NOMEM
;

340 
ÿche
->
c_Ÿrg1
 = 
çmy
;

342 ià(
sock
 && (
”r
 = 
	`Æ_ÿche_»fl
(sock, 
ÿche
)) < 0) {

343 
	`ä“
(
ÿche
);

344  
”r
;

347 *
»suÉ
 = 
ÿche
;

349 
	}
}

358 
	$bud_ruË_msg
(
¹Æ_ruË
 *
tm¶
, 
cmd
, 
æags
,

359 
Æ_msg
 **
»suÉ
)

361 
Æ_msg
 *
msg
;

362 
fib_ruË_hdr
 
äh
 = {

363 .
çmy
 = 
tm¶
->
r_çmy
,

364 .
bË
 = 
tm¶
->
r_bË
,

365 .
aùiÚ
 = 
tm¶
->
r_aùiÚ
,

366 .
æags
 = 
tm¶
->
r_æags
,

367 .
tos
 = 
tm¶
->
r_dsf›ld
,

370 ià(!(
tm¶
->
û_mask
 & 
RULE_ATTR_FAMILY
))

371  -
NLE_MISSING_ATTR
;

373 
msg
 = 
	`Æmsg_®loc_sim¶e
(
cmd
, 
æags
);

374 ià(!
msg
)

375  -
NLE_NOMEM
;

377 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_SRC
)

378 
äh
.
¤c_Ën
 = 
	`Æ_addr_g‘_´efixËn
(
tm¶
->
r_¤c
);

380 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_DST
)

381 
äh
.
d¡_Ën
 = 
	`Æ_addr_g‘_´efixËn
(
tm¶
->
r_d¡
);

383 ià(
	`Æmsg_­³nd
(
msg
, &
äh
, (äh), 
NLMSG_ALIGNTO
) < 0)

384 
Æa_put_çu»
;

388 
	`NLA_PUT_U32
(
msg
, 
FRA_TABLE
, 
tm¶
->
r_bË
);

390 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_SRC
)

391 
	`NLA_PUT_ADDR
(
msg
, 
FRA_SRC
, 
tm¶
->
r_¤c
);

393 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_DST
)

394 
	`NLA_PUT_ADDR
(
msg
, 
FRA_DST
, 
tm¶
->
r_d¡
);

396 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_IIFNAME
)

397 
	`NLA_PUT_STRING
(
msg
, 
FRA_IIFNAME
, 
tm¶
->
r_iiâame
);

399 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_OIFNAME
)

400 
	`NLA_PUT_STRING
(
msg
, 
FRA_OIFNAME
, 
tm¶
->
r_oiâame
);

402 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_PRIO
)

403 
	`NLA_PUT_U32
(
msg
, 
FRA_PRIORITY
, 
tm¶
->
r_´io
);

405 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_MARK
)

406 
	`NLA_PUT_U32
(
msg
, 
FRA_FWMARK
, 
tm¶
->
r_m¬k
);

408 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_MASK
)

409 
	`NLA_PUT_U32
(
msg
, 
FRA_FWMASK
, 
tm¶
->
r_mask
);

411 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_GOTO
)

412 
	`NLA_PUT_U32
(
msg
, 
FRA_GOTO
, 
tm¶
->
r_gÙo
);

414 ià(
tm¶
->
û_mask
 & 
RULE_ATTR_FLOW
)

415 
	`NLA_PUT_U32
(
msg
, 
FRA_FLOW
, 
tm¶
->
r_æow
);

418 *
»suÉ
 = 
msg
;

421 
Æa_put_çu»
:

422 
	`Æmsg_ä“
(
msg
);

423  -
NLE_MSGSIZE
;

424 
	}
}

440 
	$¹Æ_ruË_bud_add_»que¡
(
¹Æ_ruË
 *
tm¶
, 
æags
,

441 
Æ_msg
 **
»suÉ
)

443  
	`bud_ruË_msg
(
tm¶
, 
RTM_NEWRULE
, 
NLM_F_CREATE
 | 
æags
,

444 
»suÉ
);

445 
	}
}

459 
	$¹Æ_ruË_add
(
Æ_sock
 *
sk
, 
¹Æ_ruË
 *
tm¶
, 
æags
)

461 
Æ_msg
 *
msg
;

462 
”r
;

464 ià((
”r
 = 
	`¹Æ_ruË_bud_add_»que¡
(
tm¶
, 
æags
, &
msg
)) < 0)

465  
”r
;

467 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

468 
	`Æmsg_ä“
(
msg
);

469 ià(
”r
 < 0)

470  
”r
;

472  
	`wa™_fÜ_ack
(
sk
);

473 
	}
}

496 
	$¹Æ_ruË_bud_d–‘e_»que¡
(
¹Æ_ruË
 *
ruË
, 
æags
,

497 
Æ_msg
 **
»suÉ
)

499  
	`bud_ruË_msg
(
ruË
, 
RTM_DELRULE
, 
æags
, 
»suÉ
);

500 
	}
}

514 
	$¹Æ_ruË_d–‘e
(
Æ_sock
 *
sk
, 
¹Æ_ruË
 *
ruË
, 
æags
)

516 
Æ_msg
 *
msg
;

517 
”r
;

519 ià((
”r
 = 
	`¹Æ_ruË_bud_d–‘e_»que¡
(
ruË
, 
æags
, &
msg
)) < 0)

520  
”r
;

522 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sk
, 
msg
);

523 
	`Æmsg_ä“
(
msg
);

524 ià(
”r
 < 0)

525  
”r
;

527  
	`wa™_fÜ_ack
(
sk
);

528 
	}
}

537 
	$¹Æ_ruË_£t_çmy
(
¹Æ_ruË
 *
ruË
, 
çmy
)

539 
ruË
->
r_çmy
 = 
çmy
;

540 
ruË
->
û_mask
 |ğ
RULE_ATTR_FAMILY
;

541 
	}
}

543 
	$¹Æ_ruË_g‘_çmy
(
¹Æ_ruË
 *
ruË
)

545 ià(
ruË
->
û_mask
 & 
RULE_ATTR_FAMILY
)

546  
ruË
->
r_çmy
;

548  
AF_UNSPEC
;

549 
	}
}

551 
	$¹Æ_ruË_£t_´io
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
´io
)

553 
ruË
->
r_´io
 = 
´io
;

554 
ruË
->
û_mask
 |ğ
RULE_ATTR_PRIO
;

555 
	}
}

557 
ušt32_t
 
	$¹Æ_ruË_g‘_´io
(
¹Æ_ruË
 *
ruË
)

559  
ruË
->
r_´io
;

560 
	}
}

562 
	$¹Æ_ruË_£t_m¬k
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
m¬k
)

564 
ruË
->
r_m¬k
 = 
m¬k
;

565 
ruË
->
û_mask
 |ğ
RULE_ATTR_MARK
;

566 
	}
}

568 
ušt32_t
 
	$¹Æ_ruË_g‘_m¬k
(
¹Æ_ruË
 *
ruË
)

570  
ruË
->
r_m¬k
;

571 
	}
}

573 
	$¹Æ_ruË_£t_mask
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
mask
)

575 
ruË
->
r_mask
 = 
mask
;

576 
ruË
->
û_mask
 |ğ
RULE_ATTR_MASK
;

577 
	}
}

579 
ušt32_t
 
	$¹Æ_ruË_g‘_mask
(
¹Æ_ruË
 *
ruË
)

581  
ruË
->
r_mask
;

582 
	}
}

584 
	$¹Æ_ruË_£t_bË
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
bË
)

586 
ruË
->
r_bË
 = 
bË
;

587 
ruË
->
û_mask
 |ğ
RULE_ATTR_TABLE
;

588 
	}
}

590 
ušt32_t
 
	$¹Æ_ruË_g‘_bË
(
¹Æ_ruË
 *
ruË
)

592  
ruË
->
r_bË
;

593 
	}
}

595 
	$¹Æ_ruË_£t_dsf›ld
(
¹Æ_ruË
 *
ruË
, 
ušt8_t
 
dsf›ld
)

597 
ruË
->
r_dsf›ld
 = 
dsf›ld
;

598 
ruË
->
û_mask
 |ğ
RULE_ATTR_DSFIELD
;

599 
	}
}

601 
ušt8_t
 
	$¹Æ_ruË_g‘_dsf›ld
(
¹Æ_ruË
 *
ruË
)

603  
ruË
->
r_dsf›ld
;

604 
	}
}

606 
šlše
 
	$__assign_addr
(
¹Æ_ruË
 *
ruË
, 
Æ_addr
 **
pos
,

607 
Æ_addr
 *
Ãw
, 
æag
)

609 ià(
ruË
->
û_mask
 & 
RULE_ATTR_FAMILY
) {

610 ià(
Ãw
->
a_çmy
 !ğ
ruË
->
r_çmy
)

611  -
NLE_AF_MISMATCH
;

613 
ruË
->
r_çmy
 = 
Ãw
->
a_çmy
;

615 ià(*
pos
)

616 
	`Æ_addr_put
(*
pos
);

618 
	`Æ_addr_g‘
(
Ãw
);

619 *
pos
 = 
Ãw
;

621 
ruË
->
û_mask
 |ğ(
æag
 | 
RULE_ATTR_FAMILY
);

624 
	}
}

626 
	$¹Æ_ruË_£t_¤c
(
¹Æ_ruË
 *
ruË
, 
Æ_addr
 *
¤c
)

628  
	`__assign_addr
(
ruË
, &ruË->
r_¤c
, 
¤c
, 
RULE_ATTR_SRC
);

629 
	}
}

631 
Æ_addr
 *
	$¹Æ_ruË_g‘_¤c
(
¹Æ_ruË
 *
ruË
)

633  
ruË
->
r_¤c
;

634 
	}
}

636 
	$¹Æ_ruË_£t_d¡
(
¹Æ_ruË
 *
ruË
, 
Æ_addr
 *
d¡
)

638  
	`__assign_addr
(
ruË
, &ruË->
r_d¡
, 
d¡
, 
RULE_ATTR_DST
);

639 
	}
}

641 
Æ_addr
 *
	$¹Æ_ruË_g‘_d¡
(
¹Æ_ruË
 *
ruË
)

643  
ruË
->
r_d¡
;

644 
	}
}

646 
	$¹Æ_ruË_£t_iif
(
¹Æ_ruË
 *
ruË
, cÚ¡ *
dev
)

648 ià(
	`¡¾’
(
dev
è> 
IFNAMSIZ
-1)

649  -
NLE_RANGE
;

651 
	`¡rıy
(
ruË
->
r_iiâame
, 
dev
);

652 
ruË
->
û_mask
 |ğ
RULE_ATTR_IIFNAME
;

654 
	}
}

656 *
	$¹Æ_ruË_g‘_iif
(
¹Æ_ruË
 *
ruË
)

658 ià(
ruË
->
û_mask
 & 
RULE_ATTR_IIFNAME
)

659  
ruË
->
r_iiâame
;

661  
NULL
;

662 
	}
}

664 
	$¹Æ_ruË_£t_oif
(
¹Æ_ruË
 *
ruË
, cÚ¡ *
dev
)

666 ià(
	`¡¾’
(
dev
è> 
IFNAMSIZ
-1)

667  -
NLE_RANGE
;

669 
	`¡rıy
(
ruË
->
r_oiâame
, 
dev
);

670 
ruË
->
û_mask
 |ğ
RULE_ATTR_OIFNAME
;

672 
	}
}

674 *
	$¹Æ_ruË_g‘_oif
(
¹Æ_ruË
 *
ruË
)

676 ià(
ruË
->
û_mask
 & 
RULE_ATTR_OIFNAME
)

677  
ruË
->
r_oiâame
;

679  
NULL
;

680 
	}
}

682 
	$¹Æ_ruË_£t_aùiÚ
(
¹Æ_ruË
 *
ruË
, 
ušt8_t
 
aùiÚ
)

684 
ruË
->
r_aùiÚ
 = 
aùiÚ
;

685 
ruË
->
û_mask
 |ğ
RULE_ATTR_ACTION
;

686 
	}
}

688 
ušt8_t
 
	$¹Æ_ruË_g‘_aùiÚ
(
¹Æ_ruË
 *
ruË
)

690  
ruË
->
r_aùiÚ
;

691 
	}
}

693 
	$¹Æ_ruË_£t_»®ms
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
»®ms
)

695 
ruË
->
r_æow
 = 
»®ms
;

696 
ruË
->
û_mask
 |ğ
RULE_ATTR_FLOW
;

697 
	}
}

699 
ušt32_t
 
	$¹Æ_ruË_g‘_»®ms
(
¹Æ_ruË
 *
ruË
)

701  
ruË
->
r_æow
;

702 
	}
}

704 
	$¹Æ_ruË_£t_gÙo
(
¹Æ_ruË
 *
ruË
, 
ušt32_t
 
»f
)

706 
ruË
->
r_gÙo
 = 
»f
;

707 
ruË
->
û_mask
 |ğ
RULE_ATTR_GOTO
;

708 
	}
}

710 
ušt32_t
 
	$¹Æ_ruË_g‘_gÙo
(
¹Æ_ruË
 *
ruË
)

712  
ruË
->
r_gÙo
;

713 
	}
}

717 
Æ_objeù_İs
 
	gruË_obj_İs
 = {

718 .
oo_Çme
 = "route/rule",

719 .
	goo_size
 = (
¹Æ_ruË
),

720 .
	goo_ä“_d©a
 = 
ruË_ä“_d©a
,

721 .
	goo_şÚe
 = 
ruË_şÚe
,

722 .
	goo_dump
 = {

723 [
NL_DUMP_LINE
] = 
ruË_dump_lše
,

724 [
NL_DUMP_DETAILS
] = 
ruË_dump_d‘as
,

725 [
NL_DUMP_STATS
] = 
ruË_dump_¡©s
,

727 .
	goo_com·»
 = 
ruË_com·»
,

728 .
	goo_©Œs2¡r
 = 
ruË_©Œs2¡r
,

729 .
	goo_id_©Œs
 = ~0,

732 
Æ_ÿche_İs
 
	g¹Æ_ruË_İs
 = {

733 .
co_Çme
 = "route/rule",

734 .
	gco_hdrsize
 = (
fib_ruË_hdr
),

735 .
	gco_msgty³s
 = {

736 { 
RTM_NEWRULE
, 
NL_ACT_NEW
, "new" },

737 { 
RTM_DELRULE
, 
NL_ACT_DEL
, "del" },

738 { 
RTM_GETRULE
, 
NL_ACT_GET
, "get" },

739 
END_OF_MSGTYPES_LIST
,

741 .
	gco_´ÙocŞ
 = 
NETLINK_ROUTE
,

742 .
	gco_»que¡_upd©e
 = 
ruË_»que¡_upd©e
,

743 .
	gco_msg_·r£r
 = 
ruË_msg_·r£r
,

744 .
	gco_obj_İs
 = &
ruË_obj_İs
,

747 
__š™
 
	$ruË_š™
()

749 
	`Æ_ÿche_mngt_»gi¡”
(&
¹Æ_ruË_İs
);

750 
	}
}

752 
__ex™
 
	$ruË_ex™
()

754 
	`Æ_ÿche_mngt_uÄegi¡”
(&
¹Æ_ruË_İs
);

755 
	}
}

	@mylibnl/libnl-3.2.25/lib/route/tc.c

18 
	~<Ãšk-´iv©e/Ãšk.h
>

19 
	~<Ãšk-´iv©e/tc.h
>

20 
	~<Ãšk/Ãšk.h
>

21 
	~<Ãšk/uts.h
>

22 
	~<Ãšk/rou‹/¹Æ.h
>

23 
	~<Ãšk/rou‹/lšk.h
>

24 
	~<Ãšk/rou‹/tc.h
>

25 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

29 
Æ_li¡_h—d
 
	gtc_İs_li¡
[
__RTNL_TC_TYPE_MAX
];

30 
¹Æ_tc_ty³_İs
 *
	gtc_ty³_İs
[
__RTNL_TC_TYPE_MAX
];

32 
Æa_pŞicy
 
	gtc_pŞicy
[
TCA_MAX
+1] = {

33 [
TCA_KIND
] = { .
ty³
 = 
NLA_STRING
,

34 .
	gmaxËn
 = 
TCKINDSIZ
 },

35 [
TCA_STATS
] = { .
mšËn
 = (
tc_¡©s
) },

36 [
TCA_STATS2
] = { .
ty³
 = 
NLA_NESTED
 },

39 
	$tÿ_·r£
(
Æ©Œ
 **
tb
, 
max©Œ
, 
¹Æ_tc
 *
g
,

40 
Æa_pŞicy
 *
pŞicy
)

43 ià(
g
->
û_mask
 & 
TCA_ATTR_OPTS
)

44  
	`Æa_·r£
(
tb
, 
max©Œ
,

45 (
Æ©Œ
 *è
g
->
tc_İts
->
d_d©a
,

46 
g
->
tc_İts
->
d_size
, 
pŞicy
);

50 
	`mem£t
(
tb
, 0, (
Æ©Œ
 *è* (
max©Œ
 + 1));

53 
	}
}

55 
Æa_pŞicy
 
	gtc_¡©s2_pŞicy
[
TCA_STATS_MAX
+1] = {

56 [
TCA_STATS_BASIC
] = { .
mšËn
 = (
gÃt_¡©s_basic
) },

57 [
TCA_STATS_RATE_EST
] = { .
mšËn
 = (
gÃt_¡©s_¿‹_e¡
) },

58 [
TCA_STATS_QUEUE
] = { .
mšËn
 = (
gÃt_¡©s_queue
) },

61 
	$¹Æ_tc_msg_·r£
(
Æmsghdr
 *
n
, 
¹Æ_tc
 *
tc
)

63 
Æ_ÿche
 *
lšk_ÿche
;

64 
¹Æ_tc_İs
 *
İs
;

65 
Æ©Œ
 *
tb
[
TCA_MAX
 + 1];

66 
kšd
[
TCKINDSIZ
];

67 
tcmsg
 *
tm
;

68 
”r
;

70 
tc
->
û_msgty³
 = 
n
->
Æmsg_ty³
;

72 
”r
 = 
	`Æmsg_·r£
(
n
, (*
tm
), 
tb
, 
TCA_MAX
, 
tc_pŞicy
);

73 ià(
”r
 < 0)

74  
”r
;

76 ià(
tb
[
TCA_KIND
] =ğ
NULL
)

77  -
NLE_MISSING_ATTR
;

79 
	`Æa_¡¾ıy
(
kšd
, 
tb
[
TCA_KIND
], (kind));

80 
	`¹Æ_tc_£t_kšd
(
tc
, 
kšd
);

82 
tm
 = 
	`Æmsg_d©a
(
n
);

83 
tc
->
tc_çmy
 = 
tm
->
tcm_çmy
;

84 
tc
->
tc_ifšdex
 = 
tm
->
tcm_ifšdex
;

85 
tc
->
tc_hªdË
 = 
tm
->
tcm_hªdË
;

86 
tc
->
tc_·»Á
 = 
tm
->
tcm_·»Á
;

87 
tc
->
tc_šfo
 = 
tm
->
tcm_šfo
;

89 
tc
->
û_mask
 |ğ(
TCA_ATTR_FAMILY
 | 
TCA_ATTR_IFINDEX
 | 
TCA_ATTR_HANDLE
|

90 
TCA_ATTR_PARENT
 | 
TCA_ATTR_INFO
);

92 ià(
tb
[
TCA_OPTIONS
]) {

93 
tc
->
tc_İts
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_OPTIONS
]);

94 ià(!
tc
->
tc_İts
)

95  -
NLE_NOMEM
;

96 
tc
->
û_mask
 |ğ
TCA_ATTR_OPTS
;

99 ià(
tb
[
TCA_STATS2
]) {

100 
Æ©Œ
 *
tbs
[
TCA_STATS_MAX
 + 1];

102 
”r
 = 
	`Æa_·r£_Ã¡ed
(
tbs
, 
TCA_STATS_MAX
, 
tb
[
TCA_STATS2
],

103 
tc_¡©s2_pŞicy
);

104 ià(
”r
 < 0)

105  
”r
;

107 ià(
tbs
[
TCA_STATS_BASIC
]) {

108 
gÃt_¡©s_basic
 *
bs
;

110 
bs
 = 
	`Æa_d©a
(
tbs
[
TCA_STATS_BASIC
]);

111 
tc
->
tc_¡©s
[
RTNL_TC_BYTES
] = 
bs
->
by‹s
;

112 
tc
->
tc_¡©s
[
RTNL_TC_PACKETS
] = 
bs
->
·ck‘s
;

115 ià(
tbs
[
TCA_STATS_RATE_EST
]) {

116 
gÃt_¡©s_¿‹_e¡
 *
»
;

118 
»
 = 
	`Æa_d©a
(
tbs
[
TCA_STATS_RATE_EST
]);

119 
tc
->
tc_¡©s
[
RTNL_TC_RATE_BPS
] = 
»
->
bps
;

120 
tc
->
tc_¡©s
[
RTNL_TC_RATE_PPS
] = 
»
->
µs
;

123 ià(
tbs
[
TCA_STATS_QUEUE
]) {

124 
gÃt_¡©s_queue
 *
q
;

126 
q
 = 
	`Æa_d©a
(
tbs
[
TCA_STATS_QUEUE
]);

127 
tc
->
tc_¡©s
[
RTNL_TC_QLEN
] = 
q
->
qËn
;

128 
tc
->
tc_¡©s
[
RTNL_TC_BACKLOG
] = 
q
->
backlog
;

129 
tc
->
tc_¡©s
[
RTNL_TC_DROPS
] = 
q
->
drİs
;

130 
tc
->
tc_¡©s
[
RTNL_TC_REQUEUES
] = 
q
->
»queues
;

131 
tc
->
tc_¡©s
[
RTNL_TC_OVERLIMITS
] = 
q
->
ov”lim™s
;

134 
tc
->
û_mask
 |ğ
TCA_ATTR_STATS
;

136 ià(
tbs
[
TCA_STATS_APP
]) {

137 
tc
->
tc_x¡©s
 = 
	`Æ_d©a_®loc_©Œ
(
tbs
[
TCA_STATS_APP
]);

138 ià(
tc
->
tc_x¡©s
 =ğ
NULL
)

139  -
NLE_NOMEM
;

141 
com·t_x¡©s
;

143 ià(
tb
[
TCA_STATS
]) {

144 
tc_¡©s
 *
¡
 = 
	`Æa_d©a
(
tb
[
TCA_STATS
]);

146 
tc
->
tc_¡©s
[
RTNL_TC_BYTES
] = 
¡
->
by‹s
;

147 
tc
->
tc_¡©s
[
RTNL_TC_PACKETS
] = 
¡
->
·ck‘s
;

148 
tc
->
tc_¡©s
[
RTNL_TC_RATE_BPS
] = 
¡
->
bps
;

149 
tc
->
tc_¡©s
[
RTNL_TC_RATE_PPS
] = 
¡
->
µs
;

150 
tc
->
tc_¡©s
[
RTNL_TC_QLEN
] = 
¡
->
qËn
;

151 
tc
->
tc_¡©s
[
RTNL_TC_BACKLOG
] = 
¡
->
backlog
;

152 
tc
->
tc_¡©s
[
RTNL_TC_DROPS
] = 
¡
->
drİs
;

153 
tc
->
tc_¡©s
[
RTNL_TC_OVERLIMITS
]ğ
¡
->
ov”lim™s
;

155 
tc
->
û_mask
 |ğ
TCA_ATTR_STATS
;

158 
com·t_x¡©s
:

159 ià(
tb
[
TCA_XSTATS
]) {

160 
tc
->
tc_x¡©s
 = 
	`Æ_d©a_®loc_©Œ
(
tb
[
TCA_XSTATS
]);

161 ià(
tc
->
tc_x¡©s
 =ğ
NULL
)

162  -
NLE_NOMEM
;

163 
tc
->
û_mask
 |ğ
TCA_ATTR_XSTATS
;

167 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

168 ià(
İs
 && ops->
to_msg_·r£r
) {

169 *
d©a
 = 
	`¹Æ_tc_d©a
(
tc
);

171 ià(!
d©a
)

172  -
NLE_NOMEM
;

174 
”r
 = 
İs
->
	`to_msg_·r£r
(
tc
, 
d©a
);

175 ià(
”r
 < 0)

176  
”r
;

179 ià((
lšk_ÿche
 = 
	`__Æ_ÿche_mngt_»quœe
("route/link"))) {

180 
¹Æ_lšk
 *
lšk
;

182 ià((
lšk
 = 
	`¹Æ_lšk_g‘
(
lšk_ÿche
, 
tc
->
tc_ifšdex
))) {

183 
	`¹Æ_tc_£t_lšk
(
tc
, 
lšk
);

186 
	`¹Æ_lšk_put
(
lšk
);

191 
	}
}

193 
	$¹Æ_tc_msg_bud
(
¹Æ_tc
 *
tc
, 
ty³
, 
æags
,

194 
Æ_msg
 **
»suÉ
)

196 
Æ_msg
 *
msg
;

197 
¹Æ_tc_İs
 *
İs
;

198 
tcmsg
 
tchdr
 = {

199 .
tcm_çmy
 = 
AF_UNSPEC
,

200 .
tcm_ifšdex
 = 
tc
->
tc_ifšdex
,

201 .
tcm_hªdË
 = 
tc
->
tc_hªdË
,

202 .
tcm_·»Á
 = 
tc
->
tc_·»Á
,

204 
”r
 = -
NLE_MSGSIZE
;

206 
msg
 = 
	`Æmsg_®loc_sim¶e
(
ty³
, 
æags
);

207 ià(!
msg
)

208  -
NLE_NOMEM
;

210 ià(
	`Æmsg_­³nd
(
msg
, &
tchdr
, Ñchdr), 
NLMSG_ALIGNTO
) < 0)

211 
Æa_put_çu»
;

213 ià(
tc
->
û_mask
 & 
TCA_ATTR_KIND
)

214 
	`NLA_PUT_STRING
(
msg
, 
TCA_KIND
, 
tc
->
tc_kšd
);

216 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

217 ià(
İs
 && (İs->
to_msg_fl
 || ops->
to_msg_fl_¿w
)) {

218 
Æ©Œ
 *
İts
;

219 *
d©a
 = 
	`¹Æ_tc_d©a
(
tc
);

221 ià(
İs
->
to_msg_fl
) {

222 ià(!(
İts
 = 
	`Æa_Ã¡_¡¬t
(
msg
, 
TCA_OPTIONS
)))

223 
Æa_put_çu»
;

225 ià((
”r
 = 
İs
->
	`to_msg_fl
(
tc
, 
d©a
, 
msg
)) < 0)

226 
Æa_put_çu»
;

228 
	`Æa_Ã¡_’d
(
msg
, 
İts
);

229 } ià((
”r
 = 
İs
->
	`to_msg_fl_¿w
(
tc
, 
d©a
, 
msg
)) < 0)

230 
Æa_put_çu»
;

233 *
»suÉ
 = 
msg
;

236 
Æa_put_çu»
:

237 
	`Æmsg_ä“
(
msg
);

238  
”r
;

239 
	}
}

241 
	$tÿ_£t_kšd
(
¹Æ_tc
 *
t
, cÚ¡ *
kšd
)

243 
	`¡ºıy
(
t
->
tc_kšd
, 
kšd
, (t->tc_kind) - 1);

244 
t
->
û_mask
 |ğ
TCA_ATTR_KIND
;

245 
	}
}

265 
	$¹Æ_tc_£t_ifšdex
(
¹Æ_tc
 *
tc
, 
ifšdex
)

268 
	`¹Æ_lšk_put
(
tc
->
tc_lšk
);

269 
tc
->
tc_lšk
 = 
NULL
;

270 
tc
->
û_mask
 &ğ~
TCA_ATTR_LINK
;

272 
tc
->
tc_ifšdex
 = 
ifšdex
;

273 
tc
->
û_mask
 |ğ
TCA_ATTR_IFINDEX
;

274 
	}
}

280 
	$¹Æ_tc_g‘_ifšdex
(
¹Æ_tc
 *
tc
)

282  
tc
->
tc_ifšdex
;

283 
	}
}

297 
	$¹Æ_tc_£t_lšk
(
¹Æ_tc
 *
tc
, 
¹Æ_lšk
 *
lšk
)

299 
	`¹Æ_lšk_put
(
tc
->
tc_lšk
);

301 ià(!
lšk
)

303 ià(!
lšk
->
l_šdex
)

304 
	`BUG
();

306 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
lšk
));

307 
tc
->
tc_lšk
 = 
lšk
;

308 
tc
->
tc_ifšdex
 = 
lšk
->
l_šdex
;

309 
tc
->
û_mask
 |ğ
TCA_ATTR_LINK
 | 
TCA_ATTR_IFINDEX
;

310 
	}
}

328 
¹Æ_lšk
 *
	$¹Æ_tc_g‘_lšk
(
¹Æ_tc
 *
tc
)

330 ià(
tc
->
tc_lšk
) {

331 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
tc
->
tc_lšk
));

332  
tc
->
tc_lšk
;

335  
NULL
;

336 
	}
}

351 
	$¹Æ_tc_£t_mtu
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
mtu
)

353 
tc
->
tc_mtu
 = 
mtu
;

354 
tc
->
û_mask
 |ğ
TCA_ATTR_MTU
;

355 
	}
}

366 
ušt32_t
 
	$¹Æ_tc_g‘_mtu
(
¹Æ_tc
 *
tc
)

368 ià(
tc
->
û_mask
 & 
TCA_ATTR_MTU
)

369  
tc
->
tc_mtu
;

370 ià(
tc
->
û_mask
 & 
TCA_ATTR_LINK
)

371  
tc
->
tc_lšk
->
l_mtu
;

374 
	}
}

386 
	$¹Æ_tc_£t_mpu
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
mpu
)

388 
tc
->
tc_mpu
 = 
mpu
;

389 
tc
->
û_mask
 |ğ
TCA_ATTR_MPU
;

390 
	}
}

398 
ušt32_t
 
	$¹Æ_tc_g‘_mpu
(
¹Æ_tc
 *
tc
)

400  
tc
->
tc_mpu
;

401 
	}
}

415 
	$¹Æ_tc_£t_ov”h—d
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
ov”h—d
)

417 
tc
->
tc_ov”h—d
 = 
ov”h—d
;

418 
tc
->
û_mask
 |ğ
TCA_ATTR_OVERHEAD
;

419 
	}
}

427 
ušt32_t
 
	$¹Æ_tc_g‘_ov”h—d
(
¹Æ_tc
 *
tc
)

429  
tc
->
tc_ov”h—d
;

430 
	}
}

443 
	$¹Æ_tc_£t_lškty³
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
ty³
)

445 
tc
->
tc_lškty³
 = 
ty³
;

446 
tc
->
û_mask
 |ğ
TCA_ATTR_LINKTYPE
;

447 
	}
}

458 
ušt32_t
 
	$¹Æ_tc_g‘_lškty³
(
¹Æ_tc
 *
tc
)

460 ià(
tc
->
û_mask
 & 
TCA_ATTR_LINKTYPE
)

461  
tc
->
tc_lškty³
;

462 ià(
tc
->
û_mask
 & 
TCA_ATTR_LINK
)

463  
tc
->
tc_lšk
->
l_¬±y³
;

465  
ARPHRD_ETHER
;

466 
	}
}

473 
	$¹Æ_tc_£t_hªdË
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
id
)

475 
tc
->
tc_hªdË
 = 
id
;

476 
tc
->
û_mask
 |ğ
TCA_ATTR_HANDLE
;

477 
	}
}

483 
ušt32_t
 
	$¹Æ_tc_g‘_hªdË
(
¹Æ_tc
 *
tc
)

485  
tc
->
tc_hªdË
;

486 
	}
}

494 
	$¹Æ_tc_£t_·»Á
(
¹Æ_tc
 *
tc
, 
ušt32_t
 
·»Á
)

496 
tc
->
tc_·»Á
 = 
·»Á
;

497 
tc
->
û_mask
 |ğ
TCA_ATTR_PARENT
;

498 
	}
}

504 
ušt32_t
 
	$¹Æ_tc_g‘_·»Á
(
¹Æ_tc
 *
tc
)

506  
tc
->
tc_·»Á
;

507 
	}
}

516 
	$¹Æ_tc_£t_kšd
(
¹Æ_tc
 *
tc
, cÚ¡ *
kšd
)

518 ià(
tc
->
û_mask
 & 
TCA_ATTR_KIND
)

519  -
NLE_EXIST
;

521 
	`¡ºıy
(
tc
->
tc_kšd
, 
kšd
, (tc->tc_kind) - 1);

522 
tc
->
û_mask
 |ğ
TCA_ATTR_KIND
;

525 
	`¹Æ_tc_d©a
(
tc
);

528 
	}
}

536 *
	$¹Æ_tc_g‘_kšd
(
¹Æ_tc
 *
tc
)

538 ià(
tc
->
û_mask
 & 
TCA_ATTR_KIND
)

539  
tc
->
tc_kšd
;

541  
NULL
;

542 
	}
}

551 
ušt64_t
 
	$¹Æ_tc_g‘_¡©
(
¹Æ_tc
 *
tc
, 
¹Æ_tc_¡©
 
id
)

553 ià(
id
 < 0 || id > 
RTNL_TC_STATS_MAX
)

556  
tc
->
tc_¡©s
[
id
];

557 
	}
}

580 
	$¹Æ_tc_ÿlc_txtime
(
bufsize
, 
¿‹
)

582 
tx_time_£cs
;

584 
tx_time_£cs
 = (è
bufsize
 / (è
¿‹
;

586  
tx_time_£cs
 * 1000000.;

587 
	}
}

603 
	$¹Æ_tc_ÿlc_bufsize
(
txtime
, 
¿‹
)

605 
bufsize
;

607 
bufsize
 = (è
txtime
 * (è
¿‹
;

609  
bufsize
 / 1000000.;

610 
	}
}

617 
	$¹Æ_tc_ÿlc_ûÎ_log
(
ûÎ_size
)

619 
i
;

621 
i
 = 0; i < 32; i++)

622 ià((1 << 
i
è=ğ
ûÎ_size
)

623  
i
;

625  -
NLE_INVAL
;

626 
	}
}

651 
	$®ign_to_©m
(
size
)

653 
lšksize
, 
ûÎs
;

654 
ûÎs
 = 
size
 / 
ATM_CELL_PAYLOAD
;

655 ià((
size
 % 
ATM_CELL_PAYLOAD
) > 0)

656 
ûÎs
++;

658 
lšksize
 = 
ûÎs
 * 
ATM_CELL_SIZE
;

659  
lšksize
;

660 
	}
}

662 
	$adju¡_size
(
size
, 
mpu
,

663 
ušt32_t
 
lškty³
)

665 ià(
size
 < 
mpu
)

666 
size
 = 
mpu
;

668 
lškty³
) {

669 
ARPHRD_ATM
:

670  
	`®ign_to_©m
(
size
);

672 
ARPHRD_ETHER
:

674  
size
;

676 
	}
}

691 
	$¹Æ_tc_bud_¿‹_bË
(
¹Æ_tc
 *
tc
, 
¹Æ_¿‹¥ec
 *
¥ec
,

692 
ušt32_t
 *
d¡
)

694 
ušt32_t
 
mtu
 = 
	`¹Æ_tc_g‘_mtu
(
tc
);

695 
ušt32_t
 
lškty³
 = 
	`¹Æ_tc_g‘_lškty³
(
tc
);

696 
ušt8_t
 
ûÎ_log
 = 
¥ec
->
rs_ûÎ_log
;

697 
size
, 
i
;

699 
¥ec
->
rs_mpu
 = 
	`¹Æ_tc_g‘_mpu
(
tc
);

700 
¥ec
->
rs_ov”h—d
 = 
	`¹Æ_tc_g‘_ov”h—d
(
tc
);

702 ià(
mtu
 == 0)

703 
mtu
 = 2047;

705 ià(
ûÎ_log
 =ğ
UINT8_MAX
) {

711 
ûÎ_log
 = 0;

712 (
mtu
 >> 
ûÎ_log
è>ğ
RTNL_TC_RTABLE_SIZE
)

713 
ûÎ_log
++;

716 
i
 = 0; i < 
RTNL_TC_RTABLE_SIZE
; i++) {

717 
size
 = 
	`adju¡_size
((
i
 + 1è<< 
ûÎ_log
, 
¥ec
->
rs_mpu
, 
lškty³
);

718 
d¡
[
i
] = 
	`Æ_us2ticks
(
	`¹Æ_tc_ÿlc_txtime
(
size
, 
¥ec
->
rs_¿‹
));

721 
¥ec
->
rs_ûÎ_®ign
 = -1;

722 
¥ec
->
rs_ûÎ_log
 = 
ûÎ_log
;

725 
	}
}

733 
	$¹Æ_tc_ä“_d©a
(
Æ_objeù
 *
obj
)

735 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(
obj
);

736 
¹Æ_tc_İs
 *
İs
;

738 
	`¹Æ_lšk_put
(
tc
->
tc_lšk
);

739 
	`Æ_d©a_ä“
(
tc
->
tc_İts
);

740 
	`Æ_d©a_ä“
(
tc
->
tc_x¡©s
);

742 ià(
tc
->
tc_subd©a
) {

743 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

744 ià(
İs
 && ops->
to_ä“_d©a
)

745 
İs
->
	`to_ä“_d©a
(
tc
, 
	`Æ_d©a_g‘
Ñc->
tc_subd©a
));

747 
	`Æ_d©a_ä“
(
tc
->
tc_subd©a
);

749 
	}
}

751 
	$¹Æ_tc_şÚe
(
Æ_objeù
 *
d¡obj
, Æ_objeù *
¤cobj
)

753 
¹Æ_tc
 *
d¡
 = 
	`TC_CAST
(
d¡obj
);

754 
¹Æ_tc
 *
¤c
 = 
	`TC_CAST
(
¤cobj
);

755 
¹Æ_tc_İs
 *
İs
;

757 ià(
¤c
->
tc_lšk
) {

758 
	`Æ_objeù_g‘
(
	`OBJ_CAST
(
¤c
->
tc_lšk
));

759 
d¡
->
tc_lšk
 = 
¤c
->tc_link;

762 ià(
¤c
->
tc_İts
) {

763 
d¡
->
tc_İts
 = 
	`Æ_d©a_şÚe
(
¤c
->tc_opts);

764 ià(!
d¡
->
tc_İts
)

765  -
NLE_NOMEM
;

768 ià(
¤c
->
tc_x¡©s
) {

769 
d¡
->
tc_x¡©s
 = 
	`Æ_d©a_şÚe
(
¤c
->tc_xstats);

770 ià(!
d¡
->
tc_x¡©s
)

771  -
NLE_NOMEM
;

774 ià(
¤c
->
tc_subd©a
) {

775 ià(!(
d¡
->
tc_subd©a
 = 
	`Æ_d©a_şÚe
(
¤c
->tc_subdata))) {

776  -
NLE_NOMEM
;

780 
İs
 = 
	`¹Æ_tc_g‘_İs
(
¤c
);

781 ià(
İs
 && ops->
to_şÚe
) {

782 *
a
 = 
	`¹Æ_tc_d©a
(
d¡
), *
b
 =„Šl_tc_d©a(
¤c
);

784 ià(!
a
)

786 ià(!
b
)

787  -
NLE_NOMEM
;

789  
İs
->
	`to_şÚe
(
a
, 
b
);

793 
	}
}

795 
	$tc_dump
(
¹Æ_tc
 *
tc
, 
Æ_dump_ty³
 
ty³
,

796 
Æ_dump_·¿ms
 *
p
)

798 
¹Æ_tc_ty³_İs
 *
ty³_İs
;

799 
¹Æ_tc_İs
 *
İs
;

800 *
d©a
 = 
	`¹Æ_tc_d©a
(
tc
);

802 
ty³_İs
 = 
tc_ty³_İs
[
tc
->
tc_ty³
];

803 ià(
ty³_İs
 &&y³_İs->
‰_dump
[
ty³
])

804 
ty³_İs
->
‰_dump
[
ty³
](
tc
, 
p
);

806 
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
);

807 ià(
İs
 && ops->
to_dump
[
ty³
]) {

808 
İs
->
to_dump
[
ty³
](
tc
, 
d©a
, 
p
);

813 
	}
}

815 
	$¹Æ_tc_dump_lše
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

817 
¹Æ_tc_ty³_İs
 *
ty³_İs
;

818 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(
obj
);

819 
Æ_ÿche
 *
lšk_ÿche
;

820 
buf
[32];

822 
	`Æ_Ãw_lše
(
p
);

824 
ty³_İs
 = 
tc_ty³_İs
[
tc
->
tc_ty³
];

825 ià(
ty³_İs
 &&y³_İs->
‰_dump_´efix
)

826 
	`Æ_dump
(
p
, "% ", 
ty³_İs
->
‰_dump_´efix
);

828 
	`Æ_dump
(
p
, "% ", 
tc
->
tc_kšd
);

830 ià((
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link"))) {

831 
	`Æ_dump
(
p
, "dev %s ",

832 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
, 
tc
->
tc_ifšdex
,

833 
buf
, (buf)));

835 
	`Æ_dump
(
p
, "dev %u ", 
tc
->
tc_ifšdex
);

837 
	`Æ_dump
(
p
, "id %s ",

838 
	`¹Æ_tc_hªdË2¡r
(
tc
->
tc_hªdË
, 
buf
, (buf)));

840 
	`Æ_dump
(
p
, "parent %s",

841 
	`¹Æ_tc_hªdË2¡r
(
tc
->
tc_·»Á
, 
buf
, (buf)));

843 
	`tc_dump
(
tc
, 
NL_DUMP_LINE
, 
p
);

844 
	`Æ_dump
(
p
, "\n");

846 ià(
lšk_ÿche
)

847 
	`Æ_ÿche_put
(
lšk_ÿche
);

848 
	}
}

850 
	$¹Æ_tc_dump_d‘as
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

852 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(
obj
);

854 
	`¹Æ_tc_dump_lše
(
	`OBJ_CAST
(
tc
), 
p
);

856 
	`Æ_dump_lše
(
p
, " ");

858 ià(
tc
->
û_mask
 & 
TCA_ATTR_MTU
)

859 
	`Æ_dump
(
p
, " mtu %u", 
tc
->
tc_mtu
);

861 ià(
tc
->
û_mask
 & 
TCA_ATTR_MPU
)

862 
	`Æ_dump
(
p
, " mpu %u", 
tc
->
tc_mpu
);

864 ià(
tc
->
û_mask
 & 
TCA_ATTR_OVERHEAD
)

865 
	`Æ_dump
(
p
, " ov”h—d %u", 
tc
->
tc_ov”h—d
);

867 ià(!
	`tc_dump
(
tc
, 
NL_DUMP_DETAILS
, 
p
))

868 
	`Æ_dump
(
p
, "no options");

869 
	`Æ_dump
(
p
, "\n");

870 
	}
}

872 
	$¹Æ_tc_dump_¡©s
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
p
)

874 
¹Æ_tc
 *
tc
 = 
	`TC_CAST
(
obj
);

875 *
un™
, 
fmt
[64];

876 
»s
;

878 
	`¹Æ_tc_dump_d‘as
(
	`OBJ_CAST
(
tc
), 
p
);

880 
	`¡rıy
(
fmt
, " %7.2f %s %10u %10u %10u %10u %10u\n");

882 
	`Æ_dump_lše
(
p
,

886 
»s
 = 
	`Æ_ÿnûl_down_by‹s
(
tc
->
tc_¡©s
[
RTNL_TC_BYTES
], &
un™
);

887 ià(*
un™
 == 'B')

888 
fmt
[11] = '9';

890 
	`Æ_dump_lše
(
p
, 
fmt
, 
»s
, 
un™
,

891 
tc
->
tc_¡©s
[
RTNL_TC_PACKETS
],

892 
tc
->
tc_¡©s
[
RTNL_TC_DROPS
],

893 
tc
->
tc_¡©s
[
RTNL_TC_OVERLIMITS
],

894 
tc
->
tc_¡©s
[
RTNL_TC_QLEN
],

895 
tc
->
tc_¡©s
[
RTNL_TC_BACKLOG
]);

897 
»s
 = 
	`Æ_ÿnûl_down_by‹s
(
tc
->
tc_¡©s
[
RTNL_TC_RATE_BPS
], &
un™
);

899 
	`¡rıy
(
fmt
, " %7.2f %s/s%9u…ps");

901 ià(*
un™
 == 'B')

902 
fmt
[11] = '9';

904 
	`Æ_dump_lše
(
p
, 
fmt
, 
»s
, 
un™
, 
tc
->
tc_¡©s
[
RTNL_TC_RATE_PPS
]);

906 
	`tc_dump
(
tc
, 
NL_DUMP_LINE
, 
p
);

907 
	`Æ_dump
(
p
, "\n");

908 
	}
}

910 
	$¹Æ_tc_com·»
(
Æ_objeù
 *
aobj
, Æ_objeù *
bobj
,

911 
ušt32_t
 
©Œs
, 
æags
)

913 
¹Æ_tc
 *
a
 = 
	`TC_CAST
(
aobj
);

914 
¹Æ_tc
 *
b
 = 
	`TC_CAST
(
bobj
);

915 
diff
 = 0;

917 
	#TC_DIFF
(
ATTR
, 
EXPR
è
	`ATTR_DIFF
(
©Œs
, 
TCA_ATTR_
##ATTR, 
a
, 
b
, EXPR)

	)

919 
diff
 |ğ
	`TC_DIFF
(
HANDLE
, 
a
->
tc_hªdË
 !ğ
b
->tc_handle);

920 
diff
 |ğ
	`TC_DIFF
(
PARENT
, 
a
->
tc_·»Á
 !ğ
b
->tc_parent);

921 
diff
 |ğ
	`TC_DIFF
(
IFINDEX
, 
a
->
tc_ifšdex
 !ğ
b
->tc_ifindex);

922 
diff
 |ğ
	`TC_DIFF
(
KIND
, 
	`¡rcmp
(
a
->
tc_kšd
, 
b
->tc_kind));

924 #undeà
TC_DIFF


926  
diff
;

927 
	}
}

935 
¹Æ_tc_İs
 *
	$¹Æ_tc_lookup_İs
(
¹Æ_tc_ty³
 
ty³
, cÚ¡ *
kšd
)

937 
¹Æ_tc_İs
 *
İs
;

939 
	`Æ_li¡_fÜ_—ch_’Œy
(
İs
, &
tc_İs_li¡
[
ty³
], 
to_li¡
)

940 ià(!
	`¡rcmp
(
kšd
, 
İs
->
to_kšd
))

941  
İs
;

943  
NULL
;

944 
	}
}

946 
¹Æ_tc_İs
 *
	$¹Æ_tc_g‘_İs
(
¹Æ_tc
 *
tc
)

948 ià(!
tc
->
tc_İs
)

949 
tc
->
tc_İs
 = 
	`¹Æ_tc_lookup_İs
Ñc->
tc_ty³
,c->
tc_kšd
);

951  
tc
->
tc_İs
;

952 
	}
}

958 
	$¹Æ_tc_»gi¡”
(
¹Æ_tc_İs
 *
İs
)

960 
š™
 = 0;

968 ià(!
š™
) {

969 
i
;

971 
i
 = 0; i < 
__RTNL_TC_TYPE_MAX
; i++)

972 
	`Æ_š™_li¡_h—d
(&
tc_İs_li¡
[
i
]);

974 
š™
 = 1;

977 ià(!
İs
->
to_kšd
 || ops->
to_ty³
 > 
RTNL_TC_TYPE_MAX
)

978 
	`BUG
();

980 ià(
	`¹Æ_tc_lookup_İs
(
İs
->
to_ty³
, ops->
to_kšd
))

981  -
NLE_EXIST
;

983 
	`Æ_li¡_add_
(&
İs
->
to_li¡
, &
tc_İs_li¡
[İs->
to_ty³
]);

986 
	}
}

992 
	$¹Æ_tc_uÄegi¡”
(
¹Æ_tc_İs
 *
İs
)

994 
	`Æ_li¡_d–
(&
İs
->
to_li¡
);

995 
	}
}

1006 *
	$¹Æ_tc_d©a
(
¹Æ_tc
 *
tc
)

1008 ià(!
tc
->
tc_subd©a
) {

1009 
size_t
 
size
;

1011 ià(!
tc
->
tc_İs
) {

1012 ià(!
tc
->
tc_kšd
)

1013 
	`BUG
();

1015 ià(!
	`¹Æ_tc_g‘_İs
(
tc
))

1016  
NULL
;

1019 ià(!(
size
 = 
tc
->
tc_İs
->
to_size
))

1020 
	`BUG
();

1022 ià(!(
tc
->
tc_subd©a
 = 
	`Æ_d©a_®loc
(
NULL
, 
size
)))

1023  
NULL
;

1026  
	`Æ_d©a_g‘
(
tc
->
tc_subd©a
);

1027 
	}
}

1043 *
	$¹Æ_tc_d©a_check
(
¹Æ_tc
 *
tc
, 
¹Æ_tc_İs
 *
İs
)

1045 ià(
tc
->
tc_İs
 !ğ
İs
) {

1046 
buf
[64];

1048 
	`¢´štf
(
buf
, (buf),

1050 
tc
, 
İs
->
to_kšd
,c->
tc_İs
->to_kind);

1051 
	`APPBUG
(
buf
);

1053  
NULL
;

1056  
	`¹Æ_tc_d©a
(
tc
);

1057 
	}
}

1059 
Æ_af_group
 
	gtc_groups
[] = {

1060 { 
AF_UNSPEC
, 
RTNLGRP_TC
 },

1061 { 
END_OF_GROUP_LIST
 },

1065 
	$¹Æ_tc_ty³_»gi¡”
(
¹Æ_tc_ty³_İs
 *
İs
)

1067 ià(
İs
->
‰_ty³
 > 
RTNL_TC_TYPE_MAX
)

1068 
	`BUG
();

1070 
tc_ty³_İs
[
İs
->
‰_ty³
] = ops;

1071 
	}
}

1073 
	$¹Æ_tc_ty³_uÄegi¡”
(
¹Æ_tc_ty³_İs
 *
İs
)

1075 ià(
İs
->
‰_ty³
 > 
RTNL_TC_TYPE_MAX
)

1076 
	`BUG
();

1078 
tc_ty³_İs
[
İs
->
‰_ty³
] = 
NULL
;

1079 
	}
}

	@mylibnl/libnl-3.2.25/lib/socket.c

30 
	~"defs.h
"

32 
	~<Ãšk-´iv©e/Ãšk.h
>

33 
	~<Ãšk-´iv©e/sock‘.h
>

34 
	~<Ãšk/Ãšk.h
>

35 
	~<Ãšk/uts.h
>

36 
	~<Ãšk/hªdËrs.h
>

37 
	~<Ãšk/msg.h
>

38 
	~<Ãšk/©Œ.h
>

40 
	gdeçuÉ_cb
 = 
NL_CB_DEFAULT
;

42 
__š™
 
	$š™_deçuÉ_cb
()

44 *
Æcb
;

46 ià((
Æcb
 = 
	`g‘’v
("NLCB"))) {

47 ià(!
	`¡rÿ£cmp
(
Æcb
, "default"))

48 
deçuÉ_cb
 = 
NL_CB_DEFAULT
;

49 ià(!
	`¡rÿ£cmp
(
Æcb
, "verbose"))

50 
deçuÉ_cb
 = 
NL_CB_VERBOSE
;

51 ià(!
	`¡rÿ£cmp
(
Æcb
, "debug"))

52 
deçuÉ_cb
 = 
NL_CB_DEBUG
;

54 
	`årštf
(
¡d”r
, "Unknown value for NLCB, valid values: "

58 
	}
}

60 
ušt32_t
 
	gu£d_pÜts_m­
[32];

61 
NL_RW_LOCK
(
pÜt_m­_lock
);

63 
ušt32_t
 
	$g’”©e_loÿl_pÜt
()

65 
i
, 
j
, 
n
, 
m
;

66 
ušt16_t
 
idx_¡©e
 = 0;

67 
ušt32_t
 
pid
 = 
	`g‘pid
() & 0x3FFFFF;

69 
	`Æ_wr™e_lock
(&
pÜt_m­_lock
);

71 ià(
idx_¡©e
 == 0) {

72 
ušt32_t
 
t
 = 
	`time
(
NULL
);

76 
idx_¡©e
 = 
t
 ^ (t >> 16) ^ 0x3047;

78 
idx_¡©e
 = idx_state + 20011;

80 
i
 = 
idx_¡©e
 >> 5;

81 
n
 = 
idx_¡©e
;

82 
j
 = 0; j < 32; j++) {

88 ià(
j
 == 31)

89 
i
 = 0;

91 
i
 = (((i-1) + 7) % 31) + 1;

93 ià(
u£d_pÜts_m­
[
i
] == 0xFFFFFFFF)

96 
m
 = 0; m < 32; m++) {

97 
n
 = (n + 13) % 32;

98 ià(1UL & (
u£d_pÜts_m­
[
i
] >> 
n
))

101 
u£d_pÜts_m­
[
i
] |ğ(1UL << 
n
);

102 
n
 +ğ(
i
 * 32);

107 
	`Æ_wr™e_uÆock
(&
pÜt_m­_lock
);

109  
pid
 + (((
ušt32_t
)
n
) << 22);

113 
	`Æ_wr™e_uÆock
(&
pÜt_m­_lock
);

116 
	`NL_DBG
(1, "Warning: Ran out of unique†ocal…ort‚amespace\n");

117  
UINT32_MAX
;

118 
	}
}

120 
	$»Ëa£_loÿl_pÜt
(
ušt32_t
 
pÜt
)

122 
Ä
;

123 
ušt32_t
 
mask
;

125 ià(
pÜt
 =ğ
UINT32_MAX
)

128 
	`BUG_ON
(
pÜt
 == 0);

130 
Ä
 = 
pÜt
 >> 22;

131 
mask
 = 1UL << (
Ä
 % 32);

132 
Ä
 /= 32;

134 
	`Æ_wr™e_lock
(&
pÜt_m­_lock
);

135 
	`BUG_ON
((
u£d_pÜts_m­
[
Ä
] & 
mask
) != mask);

136 
u£d_pÜts_m­
[
Ä
] &ğ~
mask
;

137 
	`Æ_wr™e_uÆock
(&
pÜt_m­_lock
);

138 
	}
}

141 
	$_Æ_sock‘_u£d_pÜts_»Ëa£_®l
(cÚ¡ 
ušt32_t
 *
u£d_pÜts
)

143 
i
;

145 
i
 = 0; i < 32; i++) {

146 ià(
u£d_pÜts
[
i
] != 0) {

147 
	`Æ_wr™e_lock
(&
pÜt_m­_lock
);

148 ; 
i
 < 32; i++) {

149 
	`BUG_ON
((
u£d_pÜts_m­
[
i
] & 
u£d_pÜts
[i]) != used_ports[i]);

150 
u£d_pÜts_m­
[
i
] &ğ~(
u£d_pÜts
[i]);

152 
	`Æ_wr™e_uÆock
(&
pÜt_m­_lock
);

156 
	}
}

158 
	$_Æ_sock‘_u£d_pÜts_£t
(
ušt32_t
 *
u£d_pÜts
, ušt32_ˆ
pÜt
)

160 
Ä
;

161 
št32_t
 
mask
;

163 
Ä
 = 
pÜt
 >> 22;

164 
mask
 = 1UL << (
Ä
 % 32);

165 
Ä
 /= 32;

172 
u£d_pÜts
[
Ä
] |ğ
mask
;

173 
	}
}

181 
Æ_sock
 *
	$__®loc_sock‘
(
Æ_cb
 *
cb
)

183 
Æ_sock
 *
sk
;

185 
sk
 = 
	`ÿÎoc
(1, (*sk));

186 ià(!
sk
)

187  
NULL
;

189 
sk
->
s_fd
 = -1;

190 
sk
->
s_cb
 = 
	`Æ_cb_g‘
(
cb
);

191 
sk
->
s_loÿl
.
Æ_çmy
 = 
AF_NETLINK
;

192 
sk
->
s_³”
.
Æ_çmy
 = 
AF_NETLINK
;

193 
sk
->
s_£q_ex³ù
 = sk->
s_£q_Ãxt
 = 
	`time
(0);

196 
sk
->
s_æags
 = 
NL_OWN_PORT
;

198  
sk
;

199 
	}
}

206 
Æ_sock
 *
	$Æ_sock‘_®loc
()

208 
Æ_cb
 *
cb
;

209 
Æ_sock
 *
sk
;

211 
cb
 = 
	`Æ_cb_®loc
(
deçuÉ_cb
);

212 ià(!
cb
)

213  
NULL
;

216 
sk
 = 
	`__®loc_sock‘
(
cb
);

218 
	`Æ_cb_put
(
cb
);

220  
sk
;

221 
	}
}

232 
Æ_sock
 *
	$Æ_sock‘_®loc_cb
(
Æ_cb
 *
cb
)

234 ià(
cb
 =ğ
NULL
)

235 
	`BUG
();

237  
	`__®loc_sock‘
(
cb
);

238 
	}
}

244 
	$Æ_sock‘_ä“
(
Æ_sock
 *
sk
)

246 ià(!
sk
)

249 ià(
sk
->
s_fd
 >= 0)

250 
	`şo£
(
sk
->
s_fd
);

252 ià(!(
sk
->
s_æags
 & 
NL_OWN_PORT
))

253 
	`»Ëa£_loÿl_pÜt
(
sk
->
s_loÿl
.
Æ_pid
);

255 
	`Æ_cb_put
(
sk
->
s_cb
);

256 
	`ä“
(
sk
);

257 
	}
}

266 
	$noİ_£q_check
(
Æ_msg
 *
msg
, *
¬g
)

268  
NL_OK
;

269 
	}
}

283 
	$Æ_sock‘_di§bË_£q_check
(
Æ_sock
 *
sk
)

285 
	`Æ_cb_£t
(
sk
->
s_cb
, 
NL_CB_SEQ_CHECK
,

286 
NL_CB_CUSTOM
, 
noİ_£q_check
, 
NULL
);

287 
	}
}

298 
	$Æ_sock‘_u£_£q
(
Æ_sock
 *
sk
)

300  
sk
->
s_£q_Ãxt
++;

301 
	}
}

315 
	$Æ_sock‘_di§bË_auto_ack
(
Æ_sock
 *
sk
)

317 
sk
->
s_æags
 |ğ
NL_NO_AUTO_ACK
;

318 
	}
}

325 
	$Æ_sock‘_’abË_auto_ack
(
Æ_sock
 *
sk
)

327 
sk
->
s_æags
 &ğ~
NL_NO_AUTO_ACK
;

328 
	}
}

333 
	$_Æ_sock‘_is_loÿl_pÜt_un¥ecif›d
(
Æ_sock
 *
sk
)

335  (
sk
->
s_loÿl
.
Æ_pid
 == 0);

336 
	}
}

338 
ušt32_t
 
	$_Æ_sock‘_g’”©e_loÿl_pÜt_no_»Ëa£
(
Æ_sock
 *
sk
)

340 
ušt32_t
 
pÜt
;

345 
pÜt
 = 
	`g’”©e_loÿl_pÜt
();

346 
sk
->
s_æags
 &ğ~
NL_OWN_PORT
;

347 
sk
->
s_loÿl
.
Æ_pid
 = 
pÜt
;

348  
pÜt
;

349 
	}
}

357 
ušt32_t
 
	$Æ_sock‘_g‘_loÿl_pÜt
(cÚ¡ 
Æ_sock
 *
sk
)

359 ià(
sk
->
s_loÿl
.
Æ_pid
 == 0) {

369  
	`_Æ_sock‘_g’”©e_loÿl_pÜt_no_»Ëa£
((
Æ_sock
 *è
sk
);

371  
sk
->
s_loÿl
.
Æ_pid
;

372 
	}
}

386 
	$Æ_sock‘_£t_loÿl_pÜt
(
Æ_sock
 *
sk
, 
ušt32_t
 
pÜt
)

388 ià(!(
sk
->
s_æags
 & 
NL_OWN_PORT
))

389 
	`»Ëa£_loÿl_pÜt
(
sk
->
s_loÿl
.
Æ_pid
);

390 
sk
->
s_æags
 |ğ
NL_OWN_PORT
;

391 
sk
->
s_loÿl
.
Æ_pid
 = 
pÜt
;

392 
	}
}

417 
	$Æ_sock‘_add_memb”shs
(
Æ_sock
 *
sk
, 
group
, ...)

419 
”r
;

420 
va_li¡
 
­
;

422 ià(
sk
->
s_fd
 == -1)

423  -
NLE_BAD_SOCK
;

425 
	`va_¡¬t
(
­
, 
group
);

427 
group
 != 0) {

428 ià(
group
 < 0) {

429 
	`va_’d
(
­
);

430  -
NLE_INVAL
;

433 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_NETLINK
, 
NETLINK_ADD_MEMBERSHIP
,

434 &
group
, (group));

435 ià(
”r
 < 0) {

436 
	`va_’d
(
­
);

437  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

440 
group
 = 
	`va_¬g
(
­
, );

443 
	`va_’d
(
­
);

446 
	}
}

448 
	$Æ_sock‘_add_memb”sh
(
Æ_sock
 *
sk
, 
group
)

450  
	`Æ_sock‘_add_memb”shs
(
sk
, 
group
, 0);

451 
	}
}

465 
	$Æ_sock‘_drİ_memb”shs
(
Æ_sock
 *
sk
, 
group
, ...)

467 
”r
;

468 
va_li¡
 
­
;

470 ià(
sk
->
s_fd
 == -1)

471  -
NLE_BAD_SOCK
;

473 
	`va_¡¬t
(
­
, 
group
);

475 
group
 != 0) {

476 ià(
group
 < 0) {

477 
	`va_’d
(
­
);

478  -
NLE_INVAL
;

481 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_NETLINK
, 
NETLINK_DROP_MEMBERSHIP
,

482 &
group
, (group));

483 ià(
”r
 < 0) {

484 
	`va_’d
(
­
);

485  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

488 
group
 = 
	`va_¬g
(
­
, );

491 
	`va_’d
(
­
);

494 
	}
}

496 
	$Æ_sock‘_drİ_memb”sh
(
Æ_sock
 *
sk
, 
group
)

498  
	`Æ_sock‘_drİ_memb”shs
(
sk
, 
group
, 0);

499 
	}
}

511 
	$Æ_još_groups
(
Æ_sock
 *
sk
, 
groups
)

513 
sk
->
s_loÿl
.
Æ_groups
 |ğ
groups
;

514 
	}
}

524 
ušt32_t
 
	$Æ_sock‘_g‘_³”_pÜt
(cÚ¡ 
Æ_sock
 *
sk
)

526  
sk
->
s_³”
.
Æ_pid
;

527 
	}
}

529 
	$Æ_sock‘_£t_³”_pÜt
(
Æ_sock
 *
sk
, 
ušt32_t
 
pÜt
)

531 
sk
->
s_³”
.
Æ_pid
 = 
pÜt
;

532 
	}
}

534 
ušt32_t
 
	$Æ_sock‘_g‘_³”_groups
(cÚ¡ 
Æ_sock
 *
sk
)

536  
sk
->
s_³”
.
Æ_groups
;

537 
	}
}

539 
	$Æ_sock‘_£t_³”_groups
(
Æ_sock
 *
sk
, 
ušt32_t
 
groups
)

541 
sk
->
s_³”
.
Æ_groups
 = 
groups
;

542 
	}
}

562 
	$Æ_sock‘_g‘_fd
(cÚ¡ 
Æ_sock
 *
sk
)

564  
sk
->
s_fd
;

565 
	}
}

573 
	$Æ_sock‘_£t_nÚblockšg
(cÚ¡ 
Æ_sock
 *
sk
)

575 ià(
sk
->
s_fd
 == -1)

576  -
NLE_BAD_SOCK
;

578 ià(
	`fú
(
sk
->
s_fd
, 
F_SETFL
, 
O_NONBLOCK
) < 0)

579  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

582 
	}
}

588 
	$Æ_sock‘_’abË_msg_³ek
(
Æ_sock
 *
sk
)

590 
sk
->
s_æags
 |ğ
NL_MSG_PEEK
;

591 
	}
}

597 
	$Æ_sock‘_di§bË_msg_³ek
(
Æ_sock
 *
sk
)

599 
sk
->
s_æags
 &ğ~
NL_MSG_PEEK
;

600 
	}
}

609 
Æ_cb
 *
	$Æ_sock‘_g‘_cb
(cÚ¡ 
Æ_sock
 *
sk
)

611  
	`Æ_cb_g‘
(
sk
->
s_cb
);

612 
	}
}

614 
	$Æ_sock‘_£t_cb
(
Æ_sock
 *
sk
, 
Æ_cb
 *
cb
)

616 ià(
cb
 =ğ
NULL
)

617 
	`BUG
();

619 
	`Æ_cb_put
(
sk
->
s_cb
);

620 
sk
->
s_cb
 = 
	`Æ_cb_g‘
(
cb
);

621 
	}
}

633 
	$Æ_sock‘_modify_cb
(
Æ_sock
 *
sk
, 
Æ_cb_ty³
 
ty³
,

634 
Æ_cb_kšd
 
kšd
, 
Æ_»cvmsg_msg_cb_t
 
func
,

635 *
¬g
)

637  
	`Æ_cb_£t
(
sk
->
s_cb
, 
ty³
, 
kšd
, 
func
, 
¬g
);

638 
	}
}

649 
	$Æ_sock‘_modify_”r_cb
(
Æ_sock
 *
sk
, 
Æ_cb_kšd
 
kšd
,

650 
Æ_»cvmsg_”r_cb_t
 
func
, *
¬g
)

652  
	`Æ_cb_”r
(
sk
->
s_cb
, 
kšd
, 
func
, 
¬g
);

653 
	}
}

675 
	$Æ_sock‘_£t_bufãr_size
(
Æ_sock
 *
sk
, 
rxbuf
, 
txbuf
)

677 
”r
;

679 ià(
rxbuf
 <= 0)

680 
rxbuf
 = 32768;

682 ià(
txbuf
 <= 0)

683 
txbuf
 = 32768;

685 ià(
sk
->
s_fd
 == -1)

686  -
NLE_BAD_SOCK
;

688 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_SOCKET
, 
SO_SNDBUF
,

689 &
txbuf
, (txbuf));

690 ià(
”r
 < 0)

691  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

693 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_SOCKET
, 
SO_RCVBUF
,

694 &
rxbuf
, (rxbuf));

695 ià(
”r
 < 0)

696  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

698 
sk
->
s_æags
 |ğ
NL_SOCK_BUFSIZE_SET
;

701 
	}
}

715 
	$Æ_sock‘_£t_msg_buf_size
(
Æ_sock
 *
sk
, 
size_t
 
bufsize
)

717 
sk
->
s_bufsize
 = 
bufsize
;

720 
	}
}

728 
size_t
 
	$Æ_sock‘_g‘_msg_buf_size
(
Æ_sock
 *
sk
)

730  
sk
->
s_bufsize
;

731 
	}
}

740 
	$Æ_sock‘_£t_·ssüed
(
Æ_sock
 *
sk
, 
¡©e
)

742 
”r
;

744 ià(
sk
->
s_fd
 == -1)

745  -
NLE_BAD_SOCK
;

747 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_SOCKET
, 
SO_PASSCRED
,

748 &
¡©e
, (state));

749 ià(
”r
 < 0)

750  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

752 ià(
¡©e
)

753 
sk
->
s_æags
 |ğ
NL_SOCK_PASSCRED
;

755 
sk
->
s_æags
 &ğ~
NL_SOCK_PASSCRED
;

758 
	}
}

767 
	$Æ_sock‘_»cv_pktšfo
(
Æ_sock
 *
sk
, 
¡©e
)

769 
”r
;

771 ià(
sk
->
s_fd
 == -1)

772  -
NLE_BAD_SOCK
;

774 
”r
 = 
	`£tsockİt
(
sk
->
s_fd
, 
SOL_NETLINK
, 
NETLINK_PKTINFO
,

775 &
¡©e
, (state));

776 ià(
”r
 < 0)

777  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

780 
	}
}

	@mylibnl/libnl-3.2.25/lib/utils.c

27 
	~<Ãšk-´iv©e/Ãšk.h
>

28 
	~<Ãšk/Ãšk.h
>

29 
	~<Ãšk/uts.h
>

30 
	~<lšux/sock‘.h
>

31 
	~<¡dlib.h
>

49 
	gÆ_debug
 = 0;

52 #ifdeà
NL_DEBUG


53 
Æ_dump_·¿ms
 
	gÆ_debug_dp
 = {

54 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

57 
__š™
 
	$Æ_debug_š™
()

59 *
Ædbg
, *
’d
;

61 ià((
Ædbg
 = 
	`g‘’v
("NLDBG"))) {

62 
Ëv–
 = 
	`¡¹Ş
(
Ædbg
, &
’d
, 0);

63 ià(
Ædbg
 !ğ
’d
)

64 
Æ_debug
 = 
Ëv–
;

67 
Æ_debug_dp
.
dp_fd
 = 
¡d”r
;

68 
	}
}

71 
__Æ_»ad_num_¡r_fe
(cÚ¡ *
·th
, (*
cb
)(, const *))

73 
FILE
 *
fd
;

74 
buf
[128];

76 
fd
 = 
	`fİ’
(
·th
, "r");

77 ià(
fd
 =ğ
NULL
)

78  -
	`Æ_sy£¼2Æ”r
(
”ºo
);

80 
	`fg‘s
(
buf
, (buf), 
fd
)) {

81 
goodËn
, 
”r
;

82 
num
;

83 *
’d
;

85 ià(*
buf
 == '#' || *buf == '\n' || *buf == '\r')

88 
num
 = 
	`¡¹Ş
(
buf
, &
’d
, 0);

89 ià(
’d
 =ğ
buf
) {

90 
	`fşo£
(
fd
);

91  -
NLE_INVAL
;

94 ià(
num
 =ğ
LONG_MIN
 ||‚um =ğ
LONG_MAX
) {

95 
	`fşo£
(
fd
);

96  -
NLE_RANGE
;

99 *
’d
 == ' ' || *end == '\t')

100 
’d
++;

102 
goodËn
 = 
	`¡rc¥n
(
’d
, "#\r\n\t ");

103 ià(
goodËn
 == 0) {

104 
	`fşo£
(
fd
);

105  -
NLE_INVAL
;

108 
’d
[
goodËn
] = '\0';

110 
”r
 = 
	`cb
(
num
, 
’d
);

111 ià(
”r
 < 0) {

112 
	`fşo£
(
fd
);

113  
”r
;

117 
	`fşo£
(
fd
);

120 
	}
}

139 
	$Æ_ÿnûl_down_by‹s
(
l
, **
un™
)

141 ià(
l
 >= 1099511627776LL) {

142 *
un™
 = "TiB";

143  ((è
l
) / 1099511627776LL;

144 } ià(
l
 >= 1073741824) {

145 *
un™
 = "GiB";

146  ((è
l
) / 1073741824;

147 } ià(
l
 >= 1048576) {

148 *
un™
 = "MiB";

149  ((è
l
) / 1048576;

150 } ià(
l
 >= 1024) {

151 *
un™
 = "KiB";

152  ((è
l
) / 1024;

154 *
un™
 = "B";

155  (è
l
;

157 
	}
}

170 
	$Æ_ÿnûl_down_b™s
(
l
, **
un™
)

172 ià(
l
 >= 1000000000000ULL) {

173 *
un™
 = "Tbit";

174  ((è
l
) / 1000000000000ULL;

177 ià(
l
 >= 1000000000) {

178 *
un™
 = "Gbit";

179  ((è
l
) / 1000000000;

182 ià(
l
 >= 1000000) {

183 *
un™
 = "Mbit";

184  ((è
l
) / 1000000;

187 ià(
l
 >= 1000) {

188 *
un™
 = "Kbit";

189  ((è
l
) / 1000;

192 *
un™
 = "bit";

193  (è
l
;

194 
	}
}

196 
	$Æ_¿‹2¡r
(
¿‹
, 
ty³
, *
buf
, 
size_t
 
Ën
)

198 *
un™
;

199 
äac
;

201 
ty³
) {

202 
NL_BYTE_RATE
:

203 
äac
 = 
	`Æ_ÿnûl_down_by‹s
(
¿‹
, &
un™
);

206 
NL_BIT_RATE
:

207 
äac
 = 
	`Æ_ÿnûl_down_b™s
(
¿‹
, &
un™
);

211 
	`BUG
();

214  
	`¢´štf
(
buf
, 
Ën
, "%.2f%s/s", 
äac
, 
un™
);

215 
	}
}

227 
	$Æ_ÿnûl_down_us
(
ušt32_t
 
l
, **
un™
)

229 ià(
l
 >= 1000000) {

230 *
un™
 = "s";

231  ((è
l
) / 1000000;

232 } ià(
l
 >= 1000) {

233 *
un™
 = "ms";

234  ((è
l
) / 1000;

236 *
un™
 = "us";

237  (è
l
;

239 
	}
}

264 
	$Æ_size2št
(cÚ¡ *
¡r
)

266 *
p
;

267 
l
 = 
	`¡¹Ş
(
¡r
, &
p
, 0);

268 ià(
p
 =ğ
¡r
)

269  -
NLE_INVAL
;

271 ià(*
p
) {

272 ià(!
	`¡rÿ£cmp
(
p
, "kb") || !strcasecmp(p, "k"))

273 
l
 *= 1024;

274 ià(!
	`¡rÿ£cmp
(
p
, "gb") || !strcasecmp(p, "g"))

275 
l
 *= 1024*1024*1024;

276 ià(!
	`¡rÿ£cmp
(
p
, "gbit"))

277 
l
 *= 1000000000L/8;

278 ià(!
	`¡rÿ£cmp
(
p
, "mb") || !strcasecmp(p, "m"))

279 
l
 *= 1024*1024;

280 ià(!
	`¡rÿ£cmp
(
p
, "mbit"))

281 
l
 *= 1000000/8;

282 ià(!
	`¡rÿ£cmp
(
p
, "kbit"))

283 
l
 *= 1000/8;

284 ià(!
	`¡rÿ£cmp
(
p
, "bit"))

285 
l
 /= 8;

286 ià(
	`¡rÿ£cmp
(
p
, "b") != 0)

287  -
NLE_INVAL
;

290  
l
;

291 
	}
}

294 
	mlim™
;

295 cÚ¡ *
	mun™
;

296 } 
	gsize_un™s
[] = {

327 *
	$Æ_size2¡r
(cÚ¡ 
size_t
 
size
, *
buf
, cÚ¡ size_ˆ
Ën
)

329 
size_t
 
i
;

331 ià(
size
 == 0) {

332 
	`¢´štf
(
buf
, 
Ën
, "0B");

333  
buf
;

336 
i
 = 0; i < 
	`ARRAY_SIZE
(
size_un™s
); i++) {

337 ià(
size
 >ğ
size_un™s
[
i
].
lim™
) {

338 
	`¢´štf
(
buf
, 
Ën
, "%.2g%s",

339 (è
size
 / 
size_un™s
[
i
].
lim™
,

340 
size_un™s
[
i
].
un™
);

341  
buf
;

345 
	`BUG
();

346 
	}
}

361 
	$Æ_´ob2št
(cÚ¡ *
¡r
)

363 *
p
;

364 
d
 = 
	`¡¹od
(
¡r
, &
p
);

366 ià(
p
 =ğ
¡r
)

367  -
NLE_INVAL
;

369 ià(
d
 > 1.0)

370 
d
 /= 100.0f;

372 ià(
d
 > 1.0f || d < 0.0f)

373  -
NLE_RANGE
;

375 ià(*
p
 && 
	`¡rcmp
(p, "%") != 0)

376  -
NLE_INVAL
;

378  
	`ršt
(
d
 * 
NL_PROB_MAX
);

379 
	}
}

388 #iâdeà
USER_HZ


389 
	#USER_HZ
 100

	)

392 
ušt32_t
 
	gu£r_hz
 = 
USER_HZ
;

393 
ušt32_t
 
	gpsched_hz
 = 
USER_HZ
;

395 
	gticks_³r_u£c
 = 1.0f;

406 
__š™
 
	$g‘_psched_£‰šgs
()

408 
Çme
[
FILENAME_MAX
];

409 
FILE
 *
fd
;

410 
gÙ_hz
 = 0;

412 ià(
	`g‘’v
("HZ")) {

413 
hz
 = 
	`¡¹Ş
(
	`g‘’v
("HZ"), 
NULL
, 0);

415 ià(
LONG_MIN
 !ğ
hz
 && 
LONG_MAX
 != hz) {

416 
u£r_hz
 = 
hz
;

417 
gÙ_hz
 = 1;

421 ià(!
gÙ_hz
)

422 
u£r_hz
 = 
	`syscÚf
(
_SC_CLK_TCK
);

424 
psched_hz
 = 
u£r_hz
;

426 ià(
	`g‘’v
("TICKS_PER_USEC")) {

427 
t
 = 
	`¡¹od
(
	`g‘’v
("TICKS_PER_USEC"), 
NULL
);

428 
ticks_³r_u£c
 = 
t
;

431 ià(
	`g‘’v
("PROC_NET_PSCHED"))

432 
	`¢´štf
(
Çme
, Òame), "%s", 
	`g‘’v
("PROC_NET_PSCHED"));

433 ià(
	`g‘’v
("PROC_ROOT"))

434 
	`¢´štf
(
Çme
, (name), "%s/net/psched",

435 
	`g‘’v
("PROC_ROOT"));

437 
	`¡ºıy
(
Çme
, "/proc/net/psched", (name) - 1);

439 ià((
fd
 = 
	`fİ’
(
Çme
, "r"))) {

440 
ns_³r_u£c
, 
ns_³r_tick
, 
nom
, 
d’om
;

442 ià(
	`fsÿnf
(
fd
, "%08x %08x %08x %08x",

443 &
ns_³r_u£c
, &
ns_³r_tick
, &
nom
, &
d’om
) != 4) {

444 
	`NL_DBG
(1, "Fatalƒrror: can‚ot„ead…sched settings from \"%s\". " \

446 "’vœÚm’ˆv¬ŸbËs\n", 
Çme
);

447 
	`ex™
(1);

450 
ticks_³r_u£c
 = (è
ns_³r_u£c
 /

451 (è
ns_³r_tick
;

453 ià(
nom
 == 1000000)

454 
psched_hz
 = 
d’om
;

456 
	`fşo£
(
fd
);

459 
	}
}

465 
	$Æ_g‘_u£r_hz
()

467  
u£r_hz
;

468 
	}
}

473 
	$Æ_g‘_psched_hz
()

475  
psched_hz
;

476 
	}
}

483 
ušt32_t
 
	$Æ_us2ticks
(
ušt32_t
 
us
)

485  
us
 * 
ticks_³r_u£c
;

486 
	}
}

494 
ušt32_t
 
	$Æ_ticks2us
(
ušt32_t
 
ticks
)

496  
ticks
 / 
ticks_³r_u£c
;

497 
	}
}

499 
	$Æ_¡r2m£c
(cÚ¡ *
¡r
, 
ušt64_t
 *
»suÉ
)

501 
ušt64_t
 
tÙ®
 = 0, 
l
;

502 
¶’
;

503 *
p
;

506 
l
 = 
	`¡¹oul
(
¡r
, &
p
, 0);

507 ià(
p
 =ğ
¡r
)

508  -
NLE_INVAL
;

509 ià(*
p
) {

510 
¶’
 = 
	`¡rc¥n
(
p
, " \t");

512 ià(!
¶’
)

513 
tÙ®
 +ğ
l
;

514 ià(!
	`¡ºÿ£cmp
(
p
, "£c", 
¶’
))

515 
tÙ®
 +ğ(
l
 * 1000);

516 ià(!
	`¡ºÿ£cmp
(
p
, "mš", 
¶’
))

517 
tÙ®
 +ğ(
l
 * 1000*60);

518 ià(!
	`¡ºÿ£cmp
(
p
, "hour", 
¶’
))

519 
tÙ®
 +ğ(
l
 * 1000*60*60);

520 ià(!
	`¡ºÿ£cmp
(
p
, "day", 
¶’
))

521 
tÙ®
 +ğ(
l
 * 1000*60*60*24);

523  -
NLE_INVAL
;

525 
¡r
 = 
p
 + 
¶’
;

527 
tÙ®
 +ğ
l
;

528 } *
¡r
 && *
p
);

530 *
»suÉ
 = 
tÙ®
;

533 
	}
}

547 * 
	$Æ_m£c2¡r
(
ušt64_t
 
m£c
, *
buf
, 
size_t
 
Ën
)

549 
ušt64_t
 
¥l™
[5];

550 
size_t
 
i
;

551 cÚ¡ *
un™s
[5] = {"d", "h", "m", "s", "msec"};

552 * cÚ¡ 
buf_Üig
 = 
buf
;

554 ià(
m£c
 == 0) {

555 
	`¢´štf
(
buf
, 
Ën
, "0msec");

556  
buf_Üig
;

559 
	#_SPLIT
(
idx
, 
un™
èià((
¥l™
[idx] = 
m£c
 / un™)èm£ø%ğ
	)
un™

560 
	`_SPLIT
(0, 86400000);

561 
	`_SPLIT
(1, 3600000);

562 
	`_SPLIT
(2, 60000);

563 
	`_SPLIT
(3, 1000);

564 #undeà
_SPLIT


565 
¥l™
[4] = 
m£c
;

567 
i
 = 0; i < 
	`ARRAY_SIZE
(
¥l™
è&& 
Ën
; i++) {

568 
l
;

569 ià(
¥l™
[
i
] == 0)

571 
l
 = 
	`¢´štf
(
buf
, 
Ën
, "%s%" 
PRIu64
 "%s",

572 (
buf
==
buf_Üig
è? "" : " ", 
¥l™
[
i
], 
un™s
[i]);

573 
buf
 +ğ
l
;

574 
Ën
 -ğ
l
;

577  
buf_Üig
;

578 
	}
}

587 cÚ¡ 
Œªs_tbl
 
	gÆçm›s
[] = {

588 
__ADD
(
NETLINK_ROUTE
,
rou‹
)

589 
__ADD
(
NETLINK_USERSOCK
,
u£rsock
)

590 
__ADD
(
NETLINK_FIREWALL
,
fœew®l
)

591 
__ADD
(
NETLINK_INET_DIAG
,
š‘dŸg
)

592 
__ADD
(
NETLINK_NFLOG
,
næog
)

593 
__ADD
(
NETLINK_XFRM
,
xäm
)

594 
__ADD
(
NETLINK_SELINUX
,
£lšux
)

595 
__ADD
(
NETLINK_ISCSI
,
iscsi
)

596 
__ADD
(
NETLINK_AUDIT
,
aud™
)

597 
__ADD
(
NETLINK_FIB_LOOKUP
,
fib_lookup
)

598 
__ADD
(
NETLINK_CONNECTOR
,
cÚÃùÜ
)

599 
__ADD
(
NETLINK_NETFILTER
,
Ãtf‹r
)

600 
__ADD
(
NETLINK_IP6_FW
,
6_fw
)

601 
__ADD
(
NETLINK_DNRTMSG
,
dÄtmsg
)

602 
__ADD
(
NETLINK_KOBJECT_UEVENT
,
kobjeù_uev’t
)

603 
__ADD
(
NETLINK_GENERIC
,
g’”ic
)

604 
__ADD
(
NETLINK_SCSITRANSPORT
,
scs™¿n¥Üt
)

605 
__ADD
(
NETLINK_ECRYPTFS
,
eüy±fs
)

608 * 
	$Æ_Æçmy2¡r
(
çmy
, *
buf
, 
size_t
 
size
)

610  
	`__ty³2¡r
(
çmy
, 
buf
, 
size
, 
Æçm›s
,

611 
	`ARRAY_SIZE
(
Æçm›s
));

612 
	}
}

614 
	$Æ_¡r2Æçmy
(cÚ¡ *
Çme
)

616  
	`__¡r2ty³
(
Çme
, 
Æçm›s
, 
	`ARRAY_SIZE
(nlfamilies));

617 
	}
}

628 cÚ¡ 
Œªs_tbl
 
	gÎ´Ùos
[] = {

630 
__ADD
(
ARPHRD_ETHER
,
‘h”
)

631 
__ADD
(
ARPHRD_EETHER
,
“th”
)

632 
__ADD
(
ARPHRD_AX25
,
ax25
)

633 
__ADD
(
ARPHRD_PRONET
,
´Ú‘
)

634 
__ADD
(
ARPHRD_CHAOS
,
chaos
)

635 
__ADD
(
ARPHRD_IEEE802
,
›“802
)

636 
__ADD
(
ARPHRD_ARCNET
,
¬ú‘
)

637 
__ADD
(
ARPHRD_APPLETLK
,
©®k
)

638 
__ADD
(
ARPHRD_DLCI
,
dlci
)

639 
__ADD
(
ARPHRD_ATM
,
©m
)

640 
__ADD
(
ARPHRD_METRICOM
,
m‘ricom
)

641 
__ADD
(
ARPHRD_IEEE1394
,
›“1394
)

642 #ifdeà
ARPHRD_EUI64


643 
__ADD
(
ARPHRD_EUI64
,
eui64
)

645 
__ADD
(
ARPHRD_INFINIBAND
,
šfšibªd
)

646 
__ADD
(
ARPHRD_SLIP
,
¦
)

647 
__ADD
(
ARPHRD_CSLIP
,
c¦
)

648 
__ADD
(
ARPHRD_SLIP6
,
¦6
)

649 
__ADD
(
ARPHRD_CSLIP6
,
c¦6
)

650 
__ADD
(
ARPHRD_RSRVD
,
r¤vd
)

651 
__ADD
(
ARPHRD_ADAPT
,
ad­t
)

652 
__ADD
(
ARPHRD_ROSE
,
ro£
)

653 
__ADD
(
ARPHRD_X25
,
x25
)

654 #ifdeà
ARPHRD_HWX25


655 
__ADD
(
ARPHRD_HWX25
,
hwx25
)

657 
__ADD
(
ARPHRD_CAN
,
ÿn
)

658 
__ADD
(
ARPHRD_PPP
,
µp
)

659 
__ADD
(
ARPHRD_HDLC
,
hdlc
)

660 
__ADD
(
ARPHRD_LAPB
,
Ïpb
)

661 
__ADD
(
ARPHRD_DDCMP
,
ddcmp
)

662 
__ADD
(
ARPHRD_RAWHDLC
,
¿whdlc
)

663 
__ADD
(
ARPHRD_TUNNEL
,

)

664 
__ADD
(
ARPHRD_TUNNEL6
,
tuÂ–6
)

665 
__ADD
(
ARPHRD_FRAD
,
äad
)

666 
__ADD
(
ARPHRD_SKIP
,
sk
)

667 
__ADD
(
ARPHRD_LOOPBACK
,
loİback
)

668 
__ADD
(
ARPHRD_LOCALTLK
,
loÿÉlk
)

669 
__ADD
(
ARPHRD_FDDI
,
fddi
)

670 
__ADD
(
ARPHRD_BIF
,
bif
)

671 
__ADD
(
ARPHRD_SIT
,
s™
)

672 
__ADD
(
ARPHRD_IPDDP
,

/
ddp
)

673 
__ADD
(
ARPHRD_IPGRE
,
g»
)

674 
__ADD
(
ARPHRD_PIMREG
,
pim»g
)

675 
__ADD
(
ARPHRD_HIPPI
,
hpi
)

676 
__ADD
(
ARPHRD_ASH
,
ash
)

677 
__ADD
(
ARPHRD_ECONET
,
ecÚ‘
)

678 
__ADD
(
ARPHRD_IRDA
,
œda
)

679 
__ADD
(
ARPHRD_FCPP
,
fıp
)

680 
__ADD
(
ARPHRD_FCAL
,
fÿl
)

681 
__ADD
(
ARPHRD_FCPL
,
fıl
)

682 
__ADD
(
ARPHRD_FCFABRIC
,
fcfb_0
)

683 
__ADD
(
ARPHRD_FCFABRIC
+1,
fcfb_1
)

684 
__ADD
(
ARPHRD_FCFABRIC
+2,
fcfb_2
)

685 
__ADD
(
ARPHRD_FCFABRIC
+3,
fcfb_3
)

686 
__ADD
(
ARPHRD_FCFABRIC
+4,
fcfb_4
)

687 
__ADD
(
ARPHRD_FCFABRIC
+5,
fcfb_5
)

688 
__ADD
(
ARPHRD_FCFABRIC
+6,
fcfb_6
)

689 
__ADD
(
ARPHRD_FCFABRIC
+7,
fcfb_7
)

690 
__ADD
(
ARPHRD_FCFABRIC
+8,
fcfb_8
)

691 
__ADD
(
ARPHRD_FCFABRIC
+9,
fcfb_9
)

692 
__ADD
(
ARPHRD_FCFABRIC
+10,
fcfb_10
)

693 
__ADD
(
ARPHRD_FCFABRIC
+11,
fcfb_11
)

694 
__ADD
(
ARPHRD_FCFABRIC
+12,
fcfb_12
)

695 
__ADD
(
ARPHRD_IEEE802_TR
,
Œ
)

696 
__ADD
(
ARPHRD_IEEE80211
,
›“802
.11)

697 
__ADD
(
ARPHRD_PHONET
,
phÚ‘
)

698 #ifdeà
ARPHRD_CAIF


699 
__ADD
(
ARPHRD_CAIF
, 
ÿif
)

701 #ifdeà
ARPHRD_IEEE80211_PRISM


702 
__ADD
(
ARPHRD_IEEE80211_PRISM
, 
›“802
.11
_´ism
)

704 #ifdeà
ARPHRD_VOID


705 
__ADD
(
ARPHRD_VOID
,)

707 #ifdeà
ARPHRD_NONE


708 
__ADD
(
ARPHRD_NONE
,
nohdr
)

712 * 
	$Æ_Î´Ùo2¡r
(
Î´Ùo
, *
buf
, 
size_t
 
Ën
)

714  
	`__ty³2¡r
(
Î´Ùo
, 
buf
, 
Ën
, 
Î´Ùos
, 
	`ARRAY_SIZE
(llprotos));

715 
	}
}

717 
	$Æ_¡r2Î´Ùo
(cÚ¡ *
Çme
)

719  
	`__¡r2ty³
(
Çme
, 
Î´Ùos
, 
	`ARRAY_SIZE
(llprotos));

720 
	}
}

730 cÚ¡ 
Œªs_tbl
 
	g‘h”_´Ùos
[] = {

731 
__ADD
(
ETH_P_LOOP
,
loİ
)

732 
__ADD
(
ETH_P_PUP
,
pup
)

733 
__ADD
(
ETH_P_PUPAT
,
pu·t
)

734 
__ADD
(
ETH_P_IP
,

)

735 
__ADD
(
ETH_P_X25
,
x25
)

736 
__ADD
(
ETH_P_ARP
,
¬p
)

737 
__ADD
(
ETH_P_BPQ
,
bpq
)

738 
__ADD
(
ETH_P_IEEEPUP
,
›“pup
)

739 
__ADD
(
ETH_P_IEEEPUPAT
,
›“pu·t
)

740 
__ADD
(
ETH_P_DEC
,
dec
)

741 
__ADD
(
ETH_P_DNA_DL
,
dÇ_dl
)

742 
__ADD
(
ETH_P_DNA_RC
,
dÇ_rc
)

743 
__ADD
(
ETH_P_DNA_RT
,
dÇ_¹
)

744 
__ADD
(
ETH_P_LAT
,
Ït
)

745 
__ADD
(
ETH_P_DIAG
,
dŸg
)

746 
__ADD
(
ETH_P_CUST
,
cu¡
)

747 
__ADD
(
ETH_P_SCA
,
sÿ
)

748 
__ADD
(
ETH_P_TEB
,
‹b
)

749 
__ADD
(
ETH_P_RARP
,
¿½
)

750 
__ADD
(
ETH_P_ATALK
,
©®k
)

751 
__ADD
(
ETH_P_AARP
,
¯½
)

752 #ifdeà
ETH_P_8021Q


753 
__ADD
(
ETH_P_8021Q
,802.1
q
)

755 
__ADD
(
ETH_P_IPX
,
x
)

756 
__ADD
(
ETH_P_IPV6
,
v6
)

757 
__ADD
(
ETH_P_PAUSE
,
·u£
)

758 
__ADD
(
ETH_P_SLOW
,
¦ow
)

759 #ifdeà
ETH_P_WCCP


760 
__ADD
(
ETH_P_WCCP
,
wcı
)

762 
__ADD
(
ETH_P_PPP_DISC
,
µp_disc
)

763 
__ADD
(
ETH_P_PPP_SES
,
µp_£s
)

764 
__ADD
(
ETH_P_MPLS_UC
,
m¶s_uc
)

765 
__ADD
(
ETH_P_MPLS_MC
,
m¶s_mc
)

766 
__ADD
(
ETH_P_ATMMPOA
,
©mmpß
)

767 
__ADD
(
ETH_P_LINK_CTL
,
lšk_ùl
)

768 
__ADD
(
ETH_P_ATMFATE
,
©mç‹
)

769 
__ADD
(
ETH_P_PAE
,
·e
)

770 
__ADD
(
ETH_P_AOE
,
aÛ
)

771 
__ADD
(
ETH_P_TIPC
,
tc
)

772 
__ADD
(
ETH_P_1588
,
›“1588
)

773 
__ADD
(
ETH_P_FCOE
,
fcÛ
)

774 
__ADD
(
ETH_P_FIP
,
f
)

775 
__ADD
(
ETH_P_EDSA
,
ed§
)

776 
__ADD
(
ETH_P_EDP2
,
edp2
)

777 
__ADD
(
ETH_P_802_3
,802.3)

778 
__ADD
(
ETH_P_AX25
,
ax25
)

779 
__ADD
(
ETH_P_ALL
,
®l
)

780 
__ADD
(
ETH_P_802_2
,802.2)

781 
__ADD
(
ETH_P_SNAP
,
¢­
)

782 
__ADD
(
ETH_P_DDCMP
,
ddcmp
)

783 
__ADD
(
ETH_P_WAN_PPP
,
wª_µp
)

784 
__ADD
(
ETH_P_PPP_MP
,
µp_mp
)

785 
__ADD
(
ETH_P_LOCALTALK
,
loÿÉ®k
)

786 
__ADD
(
ETH_P_CAN
,
ÿn
)

787 
__ADD
(
ETH_P_PPPTALK
,
µ±®k
)

788 
__ADD
(
ETH_P_TR_802_2
,
Œ_802
.2)

789 
__ADD
(
ETH_P_MOBITEX
,
mob™ex
)

790 
__ADD
(
ETH_P_CONTROL
,
cÚŒŞ
)

791 
__ADD
(
ETH_P_IRDA
,
œda
)

792 
__ADD
(
ETH_P_ECONET
,
ecÚ‘
)

793 
__ADD
(
ETH_P_HDLC
,
hdlc
)

794 
__ADD
(
ETH_P_ARCNET
,
¬ú‘
)

795 
__ADD
(
ETH_P_DSA
,
d§
)

796 
__ADD
(
ETH_P_TRAILER
,
Œa”
)

797 
__ADD
(
ETH_P_PHONET
,
phÚ‘
)

798 
__ADD
(
ETH_P_IEEE802154
,
›“802154
)

799 
__ADD
(
ETH_P_CAIF
,
ÿif
)

802 *
	$Æ_‘h”_´Ùo2¡r
(
•rÙo
, *
buf
, 
size_t
 
Ën
)

804  
	`__ty³2¡r
(
•rÙo
, 
buf
, 
Ën
, 
‘h”_´Ùos
,

805 
	`ARRAY_SIZE
(
‘h”_´Ùos
));

806 
	}
}

808 
	$Æ_¡r2‘h”_´Ùo
(cÚ¡ *
Çme
)

810  
	`__¡r2ty³
(
Çme
, 
‘h”_´Ùos
, 
	`ARRAY_SIZE
(ether_protos));

811 
	}
}

820 *
	$Æ__´Ùo2¡r
(
´Ùo
, *
buf
, 
size_t
 
Ën
)

822 
´ÙÛÁ
 *
p
 = 
	`g‘´Ùobynumb”
(
´Ùo
);

824 ià(
p
) {

825 
	`¢´štf
(
buf
, 
Ën
, "%s", 
p
->
p_Çme
);

826  
buf
;

829 
	`¢´štf
(
buf
, 
Ën
, "0x%x", 
´Ùo
);

830  
buf
;

831 
	}
}

833 
	$Æ_¡r2_´Ùo
(cÚ¡ *
Çme
)

835 
´ÙÛÁ
 *
p
 = 
	`g‘´ÙobyÇme
(
Çme
);

836 
l
;

837 *
’d
;

839 ià(
p
)

840  
p
->
p_´Ùo
;

842 
l
 = 
	`¡¹oul
(
Çme
, &
’d
, 0);

843 ià(
l
 =ğ
ULONG_MAX
 || *
’d
 != '\0')

844  -
NLE_OBJ_NOTFOUND
;

846  (è
l
;

847 
	}
}

866 
	$Æ_Ãw_lše
(
Æ_dump_·¿ms
 *
·¿ms
)

868 
·¿ms
->
dp_lše
++;

870 ià(
·¿ms
->
dp_´efix
) {

871 
i
;

872 
i
 = 0; i < 
·¿ms
->
dp_´efix
; i++) {

873 ià(
·¿ms
->
dp_fd
)

874 
	`årštf
(
·¿ms
->
dp_fd
, " ");

875 ià(
·¿ms
->
dp_buf
)

876 
	`¡ºÿt
(
·¿ms
->
dp_buf
, " ",

877 
·¿ms
->
dp_buæ’
 -

878 
	`¡¾’
(
·¿ms
->
dp_buf
) - 1);

882 ià(
·¿ms
->
dp_Æ_cb
)

883 
·¿ms
->
	`dp_Æ_cb
Õ¬ams,…¬ams->
dp_lše
);

884 
	}
}

886 
	$dump_Úe
(
Æ_dump_·¿ms
 *
·rms
, cÚ¡ *
fmt
,

887 
va_li¡
 
¬gs
)

889 ià(
·rms
->
dp_fd
)

890 
	`vårštf
(
·rms
->
dp_fd
, 
fmt
, 
¬gs
);

891 ià(
·rms
->
dp_buf
 ||…¬ms->
dp_cb
) {

892 *
buf
 = 
NULL
;

893 ià(
	`va¥rštf
(&
buf
, 
fmt
, 
¬gs
) >= 0) {

894 ià(
·rms
->
dp_cb
)

895 
·rms
->
	`dp_cb
Õ¬ms, 
buf
);

897 
	`¡ºÿt
(
·rms
->
dp_buf
, 
buf
,

898 
·rms
->
dp_buæ’
 -

899 
	`¡¾’
(
·rms
->
dp_buf
) - 1);

900 
	`ä“
(
buf
);

903 
	}
}

915 
	$Æ_dump
(
Æ_dump_·¿ms
 *
·¿ms
, cÚ¡ *
fmt
, ...)

917 
va_li¡
 
¬gs
;

919 
	`va_¡¬t
(
¬gs
, 
fmt
);

920 
	`dump_Úe
(
·¿ms
, 
fmt
, 
¬gs
);

921 
	`va_’d
(
¬gs
);

922 
	}
}

924 
	$Æ_dump_lše
(
Æ_dump_·¿ms
 *
·rms
, cÚ¡ *
fmt
, ...)

926 
va_li¡
 
¬gs
;

928 
	`Æ_Ãw_lše
(
·rms
);

930 
	`va_¡¬t
(
¬gs
, 
fmt
);

931 
	`dump_Úe
(
·rms
, 
fmt
, 
¬gs
);

932 
	`va_’d
(
¬gs
);

933 
	}
}

940 
	$__Œªs_li¡_add
(
i
, cÚ¡ *
a
, 
Æ_li¡_h—d
 *
h—d
)

942 
Œªs_li¡
 *

;

944 

 = 
	`ÿÎoc
(1, (*tl));

945 ià(!

)

946  -
NLE_NOMEM
;

948 

->
i
 = i;

949 

->
a
 = 
	`¡rdup
(a);

951 
	`Æ_li¡_add_
(&

->
li¡
, 
h—d
);

954 
	}
}

956 
	$__Œªs_li¡_ş—r
(
Æ_li¡_h—d
 *
h—d
)

958 
Œªs_li¡
 *

, *
Ãxt
;

960 
	`Æ_li¡_fÜ_—ch_’Œy_§ã
(

, 
Ãxt
, 
h—d
, 
li¡
) {

961 
	`ä“
(

->
a
);

962 
	`ä“
(

);

965 
	`Æ_š™_li¡_h—d
(
h—d
);

966 
	}
}

968 *
	$__ty³2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
,

969 cÚ¡ 
Œªs_tbl
 *
tbl
, 
size_t
 
tbl_Ën
)

971 
size_t
 
i
;

972 
i
 = 0; i < 
tbl_Ën
; i++) {

973 ià(
tbl
[
i
].˜=ğ
ty³
) {

974 
	`¢´štf
(
buf
, 
Ën
, "%s", 
tbl
[
i
].
a
);

975  
buf
;

979 
	`¢´štf
(
buf
, 
Ën
, "0x%x", 
ty³
);

980  
buf
;

981 
	}
}

983 *
	$__li¡_ty³2¡r
(
ty³
, *
buf
, 
size_t
 
Ën
,

984 
Æ_li¡_h—d
 *
h—d
)

986 
Œªs_li¡
 *

;

988 
	`Æ_li¡_fÜ_—ch_’Œy
(

, 
h—d
, 
li¡
) {

989 ià(

->
i
 =ğ
ty³
) {

990 
	`¢´štf
(
buf
, 
Ën
, "%s", 

->
a
);

991  
buf
;

995 
	`¢´štf
(
buf
, 
Ën
, "0x%x", 
ty³
);

996  
buf
;

997 
	}
}

999 *
	$__æags2¡r
(
æags
, *
buf
, 
size_t
 
Ën
,

1000 cÚ¡ 
Œªs_tbl
 *
tbl
, 
size_t
 
tbl_Ën
)

1002 
size_t
 
i
;

1003 
tmp
 = 
æags
;

1005 
	`mem£t
(
buf
, 0, 
Ën
);

1007 
i
 = 0; i < 
tbl_Ën
; i++) {

1008 ià(
tbl
[
i
].˜& 
tmp
) {

1009 
tmp
 &ğ~
tbl
[
i
].i;

1010 
	`¡ºÿt
(
buf
, 
tbl
[
i
].
a
, 
Ën
 - 
	`¡¾’
(buf) - 1);

1011 ià((
tmp
 & 
æags
))

1012 
	`¡ºÿt
(
buf
, ",", 
Ën
 - 
	`¡¾’
(buf) - 1);

1016  
buf
;

1017 
	}
}

1019 
	$__¡r2ty³
(cÚ¡ *
buf
, cÚ¡ 
Œªs_tbl
 *
tbl
, 
size_t
 
tbl_Ën
)

1021 
l
;

1022 *
’d
;

1023 
size_t
 
i
;

1025 ià(*
buf
 == '\0')

1026  -
NLE_INVAL
;

1028 
i
 = 0; i < 
tbl_Ën
; i++)

1029 ià(!
	`¡rÿ£cmp
(
tbl
[
i
].
a
, 
buf
))

1030  
tbl
[
i
].i;

1032 
l
 = 
	`¡¹oul
(
buf
, &
’d
, 0);

1033 ià(
l
 =ğ
ULONG_MAX
 || *
’d
 != '\0')

1034  -
NLE_OBJ_NOTFOUND
;

1036  (è
l
;

1037 
	}
}

1039 
	$__li¡_¡r2ty³
(cÚ¡ *
buf
, 
Æ_li¡_h—d
 *
h—d
)

1041 
Œªs_li¡
 *

;

1042 
l
;

1043 *
’d
;

1045 ià(*
buf
 == '\0')

1046  -
NLE_INVAL
;

1048 
	`Æ_li¡_fÜ_—ch_’Œy
(

, 
h—d
, 
li¡
) {

1049 ià(!
	`¡rÿ£cmp
(

->
a
, 
buf
))

1050  

->
i
;

1053 
l
 = 
	`¡¹oul
(
buf
, &
’d
, 0);

1054 ià(
l
 =ğ
ULONG_MAX
 || *
’d
 != '\0')

1055  -
NLE_OBJ_NOTFOUND
;

1057  (è
l
;

1058 
	}
}

1060 
	$__¡r2æags
(cÚ¡ *
buf
, cÚ¡ 
Œªs_tbl
 *
tbl
, 
size_t
 
tbl_Ën
)

1062 
æags
 = 0;

1063 
size_t
 
i
;

1064 
size_t
 
Ën
;

1065 *
p
 = (*è
buf
, *
t
;

1068 ià(*
p
 == ' ')

1069 
p
++;

1071 
t
 = 
	`¡rchr
(
p
, ',');

1072 
Ën
 = 
t
 ? - 
p
 : 
	`¡¾’
(p);

1073 
i
 = 0; i < 
tbl_Ën
; i++)

1074 ià(
Ën
 =ğ
	`¡¾’
(
tbl
[
i
].
a
) &&

1075 !
	`¡ºÿ£cmp
(
tbl
[
i
].
a
, 
p
, 
Ën
))

1076 
æags
 |ğ
tbl
[
i
].i;

1078 ià(!
t
)

1079  
æags
;

1081 
p
 = ++
t
;

1085 
	}
}

1087 
	$dump_äom_İs
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
·¿ms
)

1089 
ty³
 = 
·¿ms
->
dp_ty³
;

1091 ià(
ty³
 < 0 ||y³ > 
NL_DUMP_MAX
)

1092 
	`BUG
();

1094 
·¿ms
->
dp_lše
 = 0;

1096 ià(
·¿ms
->
dp_dump_msgty³
) {

1099 
buf
[64];

1101 
	`dp_dump_lše
(
·¿ms
, 0, "%s ",

1102 
	`Æ_ÿche_mngt_ty³2Çme
(
obj
->
û_İs
,

1103 
obj
->
û_İs
->
co_´ÙocŞ
,

1104 
obj
->
û_msgty³
,

1105 
buf
, (buf)));

1107 
·¿ms
->
dp_´e_dump
 = 1;

1110 ià(
obj
->
û_İs
->
oo_dump
[
ty³
])

1111 
obj
->
û_İs
->
oo_dump
[
ty³
](obj, 
·¿ms
);

1112 
	}
}

1133 
	$Æ_has_ÿ·b™y
 (
ÿ·b™y
)

1135 cÚ¡ 
ušt8_t
 
ÿps
[ ( 
NL_CAPABILITY_MAX
 + 7 ) / 8 ] = {

1136 
	#_NL_ASSERT
(
ex´
èĞ0 * (¡ruù { 
x
: ( (!!Óx´)è? 1 : -1 ); }è)

	)

1137 
	#_NL_SETV
(
i
, 
r
, 
v
) \

1138 Ğ
	`_NL_ASSERT
Ğ(
v
è=ğ0 || (
i
è* 8 + (
r
) == (v) - 1 ) + \

1139 Ğ(
v
è=ğ0 ? 0 : (1 << (
r
)èè)

	)

1140 
	#_NL_SET
(
i
, 
v0
, 
v1
, 
v2
, 
v3
, 
v4
, 
v5
, 
v6
, 
v7
) \

1141 [(
i
)] = ( \

1142 
	`_NL_SETV
((
i
), 0, (
v0
)è| _NL_SETV((i), 4, (
v4
)) | \

1143 
	`_NL_SETV
((
i
), 1, (
v1
)è| _NL_SETV((i), 5, (
v5
)) | \

1144 
	`_NL_SETV
((
i
), 2, (
v2
)è| _NL_SETV((i), 6, (
v6
)) | \

1145 
	`_NL_SETV
((
i
), 3, (
v3
)è| _NL_SETV((i), 7, (
v7
)è)

	)

1146 
	`_NL_SET
(0,

1147 
NL_CAPABILITY_ROUTE_BUILD_MSG_SET_SCOPE
,

1148 
NL_CAPABILITY_ROUTE_LINK_VETH_GET_PEER_OWN_REFERENCE
,

1149 
NL_CAPABILITY_ROUTE_LINK_CLS_ADD_ACT_OWN_REFERENCE
,

1150 
NL_CAPABILITY_NL_CONNECT_RETRY_GENERATE_PORT_ON_ADDRINUSE
,

1155 #undeà
_NL_SET


1156 #undeà
_NL_SETV


1157 #undeà
_NL_ASSERT


1160 ià(
ÿ·b™y
 <ğ0 || c­ab™y > 
NL_CAPABILITY_MAX
)

1162 
ÿ·b™y
--;

1163  (
ÿps
[
ÿ·b™y
 / 8] & (1 << (capability % 8))) != 0;

1164 
	}
}

	@mylibnl/libnl-3.2.25/lib/version.c

27 
	~<Ãšk/v”siÚ.h
>

29 cÚ¡ 
	gÆ_v”_num
 = 
LIBNL_VER_NUM
;

30 cÚ¡ 
	gÆ_v”_maj
 = 
LIBNL_VER_MAJ
;

31 cÚ¡ 
	gÆ_v”_mš
 = 
LIBNL_VER_MIN
;

32 cÚ¡ 
	gÆ_v”_mic
 = 
LIBNL_VER_MIC
;

	@mylibnl/libnl-3.2.25/python/netlink/fixes.h

1 
	~<¡dšt.h
>

	@mylibnl/libnl-3.2.25/python/netlink/utils.h

1 
	sli¡_h—d
 {

2 
li¡_h—d
 *
	mÃxt
;

5 
	#LIST_HEAD
(
Çme
) \

6 
li¡_h—d
 
Çme
 = { &Òameè}

	)

8 
šlše
 
	$li¡_em±y
(cÚ¡ 
li¡_h—d
 *
h—d
)

10  
h—d
->
Ãxt
 == head;

11 
	}
}

13 
šlše
 
	$li¡_add
(
li¡_h—d
 *
Ãw
, li¡_h—d *
h—d
)

15 
Ãw
->
Ãxt
 = 
h—d
->next;

16 
h—d
->
Ãxt
 = 
Ãw
;

17 
	}
}

19 
šlše
 
	$li¡_d–
(
li¡_h—d
 *
’Œy
, li¡_h—d *
´ev
)

21 
´ev
->
Ãxt
 = 
’Œy
->next;

22 
’Œy
->
Ãxt
 =ƒntry;

23 
	}
}

25 
	#li¡_fÜ_—ch_§ã
(
pos
, 
n
, 
h—d
) \

26 
n
 = (
h—d
), 
pos
 = (h—d)->
Ãxt
;…os != (head); \

27 
n
 = 
pos
,…o ğn->
Ãxt
)

	)

29 #undeà
off£tof


30 
	#off£tof
(
TYPE
, 
MEMBER
è((
size_t
è&((TYPE *)0)->MEMBER)

	)

32 
	#cÚš”_of
(
±r
, 
ty³
, 
memb”
) ({ \

33 cÚ¡ 
	`ty³of
Ğ((
ty³
 *)0)->
memb”
 ) *
__m±r
 = (
±r
); \

34 (
ty³
 *)Ğ(*)
__m±r
 - 
	`off£tof
Ñy³,
memb”
è);})

	)

36 #ifdeà
DEBUG


37 
	#pyÆ_dbg
(
fmt
, ...) \

38 
	`årštf
(
¡d”r
, "%s: " 
fmt
, 
__func__
, 
__VA_ARGS__
)

	)

40 
	#pyÆ_dbg
(
fmt
, ...)

	)

	@mylibnl/libnl-3.2.25/src/genl-ctrl-list.c

12 
	~<Ãšk/şi/uts.h
>

14 
Æ_ÿche
 *
	$®loc_g’l_çmy_ÿche
(
Æ_sock
 *
sk
)

16  
	`Æ_şi_®loc_ÿche
(
sk
, "generic‚etlink family",

17 
g’l_ù¾_®loc_ÿche
);

18 
	}
}

20 
	$´št_u§ge
()

22 
	`´štf
(

30 
	`ex™
(0);

31 
	}
}

33 
	$maš
(
¬gc
, *
¬gv
[])

35 
Æ_sock
 *
sock
;

36 
Æ_ÿche
 *
çmy_ÿche
;

37 
Æ_dump_·¿ms
 
·¿ms
 = {

38 .
dp_ty³
 = 
NL_DUMP_LINE
,

39 .
dp_fd
 = 
¡dout
,

42 
sock
 = 
	`Æ_şi_®loc_sock‘
();

43 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_GENERIC
);

44 
çmy_ÿche
 = 
	`®loc_g’l_çmy_ÿche
(
sock
);

47 
c
, 
İtidx
 = 0;

48 
İtiÚ
 
lÚg_İts
[] = {

56 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "df:hv", 
lÚg_İts
, &
İtidx
);

57 ià(
c
 == -1)

60 
c
) {

61 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

62 'd': 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

63 'h': 
	`´št_u§ge
(); ;

64 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

68 
	`Æ_ÿche_dump
(
çmy_ÿche
, &
·¿ms
);

71 
	}
}

	@mylibnl/libnl-3.2.25/src/idiag-socket-details.c

11 
	~<Ãšk/şi/uts.h
>

12 
	~<Ãšk/idŸg/idŸgÆ.h
>

13 
	~<Ãšk/idŸg/msg.h
>

14 
	~<lšux/Ãšk.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

28 
	`ex™
(0);

29 
	}
}

31 
	$maš
(
¬gc
, *
¬gv
[])

33 
Æ_sock
 *
sock
;

34 
Æ_ÿche
 *
idŸg_ÿche
;

35 
Æ_dump_·¿ms
 
·¿ms
 = {

36 .
dp_ty³
 = 
NL_DUMP_LINE
,

37 .
dp_Æ_cb
 = 
NULL
,

38 .
dp_fd
 = 
¡dout
,

40 
”r
 = 0;

42 
sock
 = 
	`Æ_şi_®loc_sock‘
();

43 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_INET_DIAG
);

45 
c
, 
İtidx
 = 0;

47 
ARG_SUMMARY
 = 257,

48 
ARG_DETAILS
 = 258,

49 
ARG_STATS
 = 259,

50 
ARG_FAMILY
,

52 
İtiÚ
 
lÚg_İts
[] = {

53 { "d‘as", 0, 0, 
ARG_DETAILS
 },

54 { "summ¬y", 0, 0, 
ARG_SUMMARY
 },

55 { "¡©s", 0, 0, 
ARG_STATS
},

61 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hv", 
lÚg_İts
, &
İtidx
);

62 ià(
c
 == -1)

65 
c
) {

66 '?': 
	`ex™
(
NLE_INVAL
);

67 
ARG_SUMMARY
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_LINE
; ;

68 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

69 
ARG_STATS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_STATS
; ;

70 'h': 
	`´št_u§ge
(); ;

71 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

75 ià((
”r
 = 
	`idŸgÆ_msg_®loc_ÿche
(
sock
, 
AF_INET
, 
IDIAG_SS_ALL
,

76 &
idŸg_ÿche
))) {

77 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate idiag msg cache: %s",

78 
	`Æ_g‘”rÜ
(
”r
));

81 
	`Æ_ÿche_mngt_´ovide
(
idŸg_ÿche
);

83 
	`Æ_ÿche_dump_f‹r
(
idŸg_ÿche
, &
·¿ms
, 
NULL
);

85 
	`Æ_ÿche_mngt_uÅrovide
(
idŸg_ÿche
);

86 
	`Æ_ÿche_ä“
(
idŸg_ÿche
);

87 
	`Æ_sock‘_ä“
(
sock
);

90 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/addr.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/addr.h
>

22 
¹Æ_addr
 *
	$Æ_şi_addr_®loc
()

24 
¹Æ_addr
 *
addr
;

26 
addr
 = 
	`¹Æ_addr_®loc
();

27 ià(!
addr
)

28 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate‡ddress object");

30  
addr
;

31 
	}
}

33 
	$Æ_şi_addr_·r£_çmy
(
¹Æ_addr
 *
addr
, *
¬g
)

35 
çmy
;

37 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è!ğ
AF_UNSPEC
)

38 
	`¹Æ_addr_£t_çmy
(
addr
, 
çmy
);

39 
	}
}

41 
	$Æ_şi_addr_·r£_loÿl
(
¹Æ_addr
 *
addr
, *
¬g
)

43 
Æ_addr
 *
a
;

44 
”r
;

46 
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_addr_g‘_çmy
(
addr
));

47 ià((
”r
 = 
	`¹Æ_addr_£t_loÿl
(
addr
, 
a
)) < 0)

48 
	`Æ_şi_çl
(
”r
, "Unableo set†ocal‡ddress: %s",

49 
	`Æ_g‘”rÜ
(
”r
));

51 
	`Æ_addr_put
(
a
);

52 
	}
}

54 
	$Æ_şi_addr_·r£_dev
(
¹Æ_addr
 *
addr
, 
Æ_ÿche
 *
lšk_ÿche
,

55 *
¬g
)

57 
iv®
;

59 ià(!(
iv®
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, 
¬g
)))

60 
	`Æ_şi_çl
(
ENOENT
, "Lšk \"%s\" dÛ nÙƒxi¡", 
¬g
);

62 
	`¹Æ_addr_£t_ifšdex
(
addr
, 
iv®
);

63 
	}
}

65 
	$Æ_şi_addr_·r£_Ïb–
(
¹Æ_addr
 *
addr
, *
¬g
)

67 
”r
;

69 ià((
”r
 = 
	`¹Æ_addr_£t_Ïb–
(
addr
, 
¬g
)) < 0)

70 
	`Æ_şi_çl
(
”r
, "Unableo set‡ddress†abel: %s",

71 
	`Æ_g‘”rÜ
(
”r
));

72 
	}
}

74 
	$Æ_şi_addr_·r£_³”
(
¹Æ_addr
 *
addr
, *
¬g
)

76 
Æ_addr
 *
a
;

77 
”r
;

79 
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_addr_g‘_çmy
(
addr
));

80 ià((
”r
 = 
	`¹Æ_addr_£t_³”
(
addr
, 
a
)) < 0)

81 
	`Æ_şi_çl
(
”r
, "Unableo set…eer‡ddress: %s",

82 
	`Æ_g‘”rÜ
(
”r
));

84 
	`Æ_addr_put
(
a
);

85 
	}
}

87 
	$Æ_şi_addr_·r£_scİe
(
¹Æ_addr
 *
addr
, *
¬g
)

89 
iv®
;

91 ià((
iv®
 = 
	`¹Æ_¡r2scİe
(
¬g
)) < 0)

92 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀadd»s scİ\"%s\"", 
¬g
);

94 
	`¹Æ_addr_£t_scİe
(
addr
, 
iv®
);

95 
	}
}

97 
	$Æ_şi_addr_·r£_brßdÿ¡
(
¹Æ_addr
 *
addr
, *
¬g
)

99 
Æ_addr
 *
a
;

100 
”r
;

102 
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_addr_g‘_çmy
(
addr
));

103 ià((
”r
 = 
	`¹Æ_addr_£t_brßdÿ¡
(
addr
, 
a
)) < 0)

104 
	`Æ_şi_çl
(
”r
, "Unableo set broadcast‡ddress: %s",

105 
	`Æ_g‘”rÜ
(
”r
));

107 
	`Æ_addr_put
(
a
);

108 
	}
}

110 
ušt32_t
 
	$·r£_liãtime
(cÚ¡ *
¬g
)

112 
ušt64_t
 
m£cs
;

113 
”r
;

115 ià(!
	`¡rÿ£cmp
(
¬g
, "forever"))

118 ià((
”r
 = 
	`Æ_¡r2m£c
(
¬g
, &
m£cs
)) < 0)

119 
	`Æ_şi_çl
(
”r
, "Unableo…arseime string \"%s\": %s",

120 
¬g
, 
	`Æ_g‘”rÜ
(
”r
));

122  (
m£cs
 / 1000);

123 
	}
}

125 
	$Æ_şi_addr_·r£_´eã¼ed
(
¹Æ_addr
 *
addr
, *
¬g
)

127 
	`¹Æ_addr_£t_´eã¼ed_liãtime
(
addr
, 
	`·r£_liãtime
(
¬g
));

128 
	}
}

130 
	$Æ_şi_addr_·r£_v®id
(
¹Æ_addr
 *
addr
, *
¬g
)

132 
	`¹Æ_addr_£t_v®id_liãtime
(
addr
, 
	`·r£_liãtime
(
¬g
));

133 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/class.c

18 
	~<Ãšk/şi/uts.h
>

19 
	~<Ãšk/şi/şass.h
>

21 
¹Æ_şass
 *
	$Æ_şi_şass_®loc
()

23 
¹Æ_şass
 *
şass
;

25 ià(!(
şass
 = 
	`¹Æ_şass_®loc
()))

26 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate class object");

28  
şass
;

29 
	}
}

31 
Æ_ÿche
 *
	$Æ_şi_şass_®loc_ÿche
(
Æ_sock
 *
sock
, 
ifšdex
)

33 
Æ_ÿche
 *
ÿche
;

34 
”r
;

36 ià((
”r
 = 
	`¹Æ_şass_®loc_ÿche
(
sock
, 
ifšdex
, &
ÿche
)) < 0)

37 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate class cache: %s",

38 
	`Æ_g‘”rÜ
(
”r
));

40 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

42  
ÿche
;

43 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/cls.c

18 
	~<Ãšk/şi/uts.h
>

19 
	~<Ãšk/şi/şs.h
>

20 
	~<Ãšk/rou‹/şs/em©ch.h
>

22 
¹Æ_şs
 *
	$Æ_şi_şs_®loc
()

24 
¹Æ_şs
 *
şs
;

26 ià(!(
şs
 = 
	`¹Æ_şs_®loc
()))

27 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate classifier object");

29  
şs
;

30 
	}
}

32 
Æ_ÿche
 *
	$Æ_şi_şs_®loc_ÿche
(
Æ_sock
 *
sock
, 
ifšdex
,

33 
ušt32_t
 
·»Á
)

35 
Æ_ÿche
 *
ÿche
;

36 
”r
;

38 ià((
”r
 = 
	`¹Æ_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
, &
ÿche
)) < 0)

39 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate classifier cache: %s",

40 
	`Æ_g‘”rÜ
(
”r
));

42  
ÿche
;

43 
	}
}

45 
	$Æ_şi_şs_·r£_´Ùo
(
¹Æ_şs
 *
şs
, *
¬g
)

47 
´Ùo
;

49 ià((
´Ùo
 = 
	`Æ_¡r2‘h”_´Ùo
(
¬g
)) < 0)

50 
	`Æ_şi_çl
(
´Ùo
, "UnknowÀ´ÙocŞ \"%s\".", 
¬g
);

52 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
´Ùo
);

53 
	}
}

55 
¹Æ_em©ch_Œ“
 *
	$Æ_şi_şs_·r£_em©ch
(
¹Æ_şs
 *
şs
, *
¬g
)

57 
¹Æ_em©ch_Œ“
 *
Œ“
;

58 *
”r¡r
 = 
NULL
;

59 
”r
;

61 ià((
”r
 = 
	`¹Æ_em©ch_·r£_ex´
(
¬g
, &
”r¡r
, &
Œ“
)) < 0)

62 
	`Æ_şi_çl
(
”r
, "Unableo…arseƒmatchƒxpression: %s",

63 
”r¡r
);

65 ià(
”r¡r
)

66 
	`ä“
(
”r¡r
);

68  
Œ“
;

69 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/ct.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/ù.h
>

22 
nâl_ù
 *
	$Æ_şi_ù_®loc
()

24 
nâl_ù
 *
ù
;

26 
ù
 = 
	`nâl_ù_®loc
();

27 ià(!
ù
)

28 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate conntrack object");

30  
ù
;

31 
	}
}

33 
Æ_ÿche
 *
	$Æ_şi_ù_®loc_ÿche
(
Æ_sock
 *
sk
)

35  
	`Æ_şi_®loc_ÿche
(
sk
, "cÚÁ¿ck", 
nâl_ù_®loc_ÿche
);

36 
	}
}

38 
	$Æ_şi_ù_·r£_çmy
(
nâl_ù
 *
ù
, *
¬g
)

40 
çmy
;

42 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è=ğ
AF_UNSPEC
)

43 
	`Æ_şi_çl
(
EINVAL
,

45 
¬g
, 
	`Æ_g‘”rÜ
(
NLE_INVAL
));

47 
	`nâl_ù_£t_çmy
(
ù
, 
çmy
);

48 
	}
}

50 
	$Æ_şi_ù_·r£_´ÙocŞ
(
nâl_ù
 *
ù
, *
¬g
)

52 
´Ùo
;

54 ià((
´Ùo
 = 
	`Æ_¡r2_´Ùo
(
¬g
)) < 0)

55 
	`Æ_şi_çl
(
´Ùo
,

57 
¬g
, 
	`Æ_g‘”rÜ
(
´Ùo
));

59 
	`nâl_ù_£t_´Ùo
(
ù
, 
´Ùo
);

60 
	}
}

62 
	$Æ_şi_ù_·r£_m¬k
(
nâl_ù
 *
ù
, *
¬g
)

64 
ušt32_t
 
m¬k
 = 
	`Æ_şi_·r£_u32
(
¬g
);

65 
	`nâl_ù_£t_m¬k
(
ù
, 
m¬k
);

66 
	}
}

68 
	$Æ_şi_ù_·r£_timeout
(
nâl_ù
 *
ù
, *
¬g
)

70 
ušt32_t
 
timeout
 = 
	`Æ_şi_·r£_u32
(
¬g
);

71 
	`nâl_ù_£t_timeout
(
ù
, 
timeout
);

72 
	}
}

74 
	$Æ_şi_ù_·r£_id
(
nâl_ù
 *
ù
, *
¬g
)

76 
ušt32_t
 
id
 = 
	`Æ_şi_·r£_u32
(
¬g
);

77 
	`nâl_ù_£t_id
(
ù
, 
id
);

78 
	}
}

80 
	$Æ_şi_ù_·r£_u£
(
nâl_ù
 *
ù
, *
¬g
)

82 
ušt32_t
 
u£
 = 
	`Æ_şi_·r£_u32
(
¬g
);

83 
	`nâl_ù_£t_u£
(
ù
, 
u£
);

84 
	}
}

86 
	$Æ_şi_ù_·r£_¤c
(
nâl_ù
 *
ù
, 
»¶y
, *
¬g
)

88 
”r
;

89 
Æ_addr
 *
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`nâl_ù_g‘_çmy
(
ù
));

90 ià((
”r
 = 
	`nâl_ù_£t_¤c
(
ù
, 
»¶y
, 
a
)) < 0)

91 
	`Æ_şi_çl
(
”r
, "Unableo set source‡ddress: %s",

92 
	`Æ_g‘”rÜ
(
”r
));

93 
	}
}

95 
	$Æ_şi_ù_·r£_d¡
(
nâl_ù
 *
ù
, 
»¶y
, *
¬g
)

97 
”r
;

98 
Æ_addr
 *
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`nâl_ù_g‘_çmy
(
ù
));

99 ià((
”r
 = 
	`nâl_ù_£t_d¡
(
ù
, 
»¶y
, 
a
)) < 0)

100 
	`Æ_şi_çl
(
”r
, "Unableo set destination‡ddress: %s",

101 
	`Æ_g‘”rÜ
(
”r
));

102 
	}
}

104 
	$Æ_şi_ù_·r£_¤c_pÜt
(
nâl_ù
 *
ù
, 
»¶y
, *
¬g
)

106 
ušt32_t
 
pÜt
 = 
	`Æ_şi_·r£_u32
(
¬g
);

107 
	`nâl_ù_£t_¤c_pÜt
(
ù
, 
»¶y
, 
pÜt
);

108 
	}
}

110 
	$Æ_şi_ù_·r£_d¡_pÜt
(
nâl_ù
 *
ù
, 
»¶y
, *
¬g
)

112 
ušt32_t
 
pÜt
 = 
	`Æ_şi_·r£_u32
(
¬g
);

113 
	`nâl_ù_£t_d¡_pÜt
(
ù
, 
»¶y
, 
pÜt
);

114 
	}
}

116 
	$Æ_şi_ù_·r£_tı_¡©e
(
nâl_ù
 *
ù
, *
¬g
)

118 
¡©e
;

120 ià((
¡©e
 = 
	`nâl_ù_¡r2tı_¡©e
(
¬g
)) < 0)

121 
	`Æ_şi_çl
(
¡©e
,

123 
¬g
, 
	`Æ_g‘”rÜ
(
¡©e
));

125 
	`nâl_ù_£t_tı_¡©e
(
ù
, 
¡©e
);

126 
	}
}

128 
	$Æ_şi_ù_·r£_¡©us
(
nâl_ù
 *
ù
, *
¬g
)

130 
¡©us
;

132 ià((
¡©us
 = 
	`nâl_ù_¡r2¡©us
(
¬g
)) < 0)

133 
	`Æ_şi_çl
(
¡©us
,

135 
¬g
, 
	`Æ_g‘”rÜ
(
¡©us
));

137 
	`nâl_ù_£t_¡©us
(
ù
, 
¡©us
);

138 
	}
}

140 
	$Æ_şi_ù_·r£_zÚe
(
nâl_ù
 *
ù
, *
¬g
)

142 
ušt32_t
 
zÚe
 = 
	`Æ_şi_·r£_u32
(
¬g
);

143 
	`nâl_ù_£t_zÚe
(
ù
, 
zÚe
);

144 
	}
}

147 } ià(
¬g_m©ch
("origicmpid")) {

148 ià(
	g¬gc
 > ++
	gidx
)

149 
nâl_ù_£t_icmp_id
(
ù
, 0, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

150 } ià(
¬g_m©ch
("origicmptype")) {

151 ià(
	g¬gc
 > ++
	gidx
)

152 
nâl_ù_£t_icmp_ty³
(
ù
, 0, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

153 } ià(
¬g_m©ch
("origicmpcode")) {

154 ià(
	g¬gc
 > ++
	gidx
)

155 
nâl_ù_£t_icmp_code
(
ù
, 0, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

156 } ià(
¬g_m©ch
("replyicmpid")) {

157 ià(
	g¬gc
 > ++
	gidx
)

158 
nâl_ù_£t_icmp_id
(
ù
, 1, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

159 } ià(
¬g_m©ch
("replyicmptype")) {

160 ià(
	g¬gc
 > ++
	gidx
)

161 
nâl_ù_£t_icmp_ty³
(
ù
, 1, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

162 } ià(
¬g_m©ch
("replyicmpcode")) {

163 ià(
	g¬gc
 > ++
	gidx
)

164 
nâl_ù_£t_icmp_code
(
ù
, 1, 
¡¹oul
(
¬gv
[
idx
++], 
NULL
, 0));

	@mylibnl/libnl-3.2.25/src/lib/exp.c

20 
	~<Ãšk/şi/uts.h
>

21 
	~<Ãšk/şi/exp.h
>

23 
nâl_exp
 *
	$Æ_şi_exp_®loc
()

25 
nâl_exp
 *
exp
;

27 
exp
 = 
	`nâl_exp_®loc
();

28 ià(!
exp
)

29 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocateƒxpectation object");

31  
exp
;

32 
	}
}

34 
Æ_ÿche
 *
	$Æ_şi_exp_®loc_ÿche
(
Æ_sock
 *
sk
)

36  
	`Æ_şi_®loc_ÿche
(
sk
, "ex³ù©iÚ", 
nâl_exp_®loc_ÿche
);

37 
	}
}

39 
	$Æ_şi_exp_·r£_çmy
(
nâl_exp
 *
exp
, *
¬g
)

41 
çmy
;

43 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è=ğ
AF_UNSPEC
)

44 
	`Æ_şi_çl
(
EINVAL
,

46 
¬g
, 
	`Æ_g‘”rÜ
(
NLE_INVAL
));

48 
	`nâl_exp_£t_çmy
(
exp
, 
çmy
);

49 
	}
}

51 
	$Æ_şi_exp_·r£_timeout
(
nâl_exp
 *
exp
, *
¬g
)

53 
ušt32_t
 
timeout
 = 
	`Æ_şi_·r£_u32
(
¬g
);

54 
	`nâl_exp_£t_timeout
(
exp
, 
timeout
);

55 
	}
}

57 
	$Æ_şi_exp_·r£_id
(
nâl_exp
 *
exp
, *
¬g
)

59 
ušt32_t
 
id
 = 
	`Æ_şi_·r£_u32
(
¬g
);

60 
	`nâl_exp_£t_id
(
exp
, 
id
);

61 
	}
}

63 
	$Æ_şi_exp_·r£_h–³r_Çme
(
nâl_exp
 *
exp
, *
¬g
)

65 
	`nâl_exp_£t_h–³r_Çme
(
exp
, 
¬g
);

66 
	}
}

68 
	$Æ_şi_exp_·r£_zÚe
(
nâl_exp
 *
exp
, *
¬g
)

70 
ušt32_t
 
zÚe
 = 
	`Æ_şi_·r£_u32
(
¬g
);

71 
	`nâl_exp_£t_zÚe
(
exp
, 
zÚe
);

72 
	}
}

74 
	$Æ_şi_exp_·r£_æags
(
nâl_exp
 *
exp
, *
¬g
)

76 
ušt32_t
 
æags
 = 
	`Æ_şi_·r£_u32
(
¬g
);

77 
	`nâl_exp_£t_æags
(
exp
, 
æags
);

78 
	}
}

80 
	$Æ_şi_exp_·r£_şass
(
nâl_exp
 *
exp
, *
¬g
)

82 
ušt32_t
 
şass
 = 
	`Æ_şi_·r£_u32
(
¬g
);

83 
	`nâl_exp_£t_şass
(
exp
, 
şass
);

84 
	}
}

86 
	$Æ_şi_exp_·r£_Çt_dœ
(
nâl_exp
 *
exp
, *
¬g
)

88 
ušt32_t
 
Çt_dœ
 = 
	`Æ_şi_·r£_u32
(
¬g
);

89 
	`nâl_exp_£t_Çt_dœ
(
exp
, 
Çt_dœ
);

90 
	}
}

92 
	$Æ_şi_exp_·r£_â
(
nâl_exp
 *
exp
, *
¬g
)

94 
	`nâl_exp_£t_â
(
exp
, 
¬g
);

95 
	}
}

97 
	$Æ_şi_exp_·r£_¤c
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

99 
”r
;

100 
Æ_addr
 *
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`nâl_exp_g‘_çmy
(
exp
));

101 ià((
”r
 = 
	`nâl_exp_£t_¤c
(
exp
, 
tu¶e
, 
a
)) < 0)

102 
	`Æ_şi_çl
(
”r
, "Unableo set source‡ddress: %s",

103 
	`Æ_g‘”rÜ
(
”r
));

104 
	}
}

106 
	$Æ_şi_exp_·r£_d¡
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

108 
”r
;

109 
Æ_addr
 *
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`nâl_exp_g‘_çmy
(
exp
));

110 ià((
”r
 = 
	`nâl_exp_£t_d¡
(
exp
, 
tu¶e
, 
a
)) < 0)

111 
	`Æ_şi_çl
(
”r
, "Unableo set destination‡ddress: %s",

112 
	`Æ_g‘”rÜ
(
”r
));

113 
	}
}

115 
	$Æ_şi_exp_·r£_l4´ÙÚum
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

117 
l4´ÙÚum
;

119 ià((
l4´ÙÚum
 = 
	`Æ_¡r2_´Ùo
(
¬g
)) < 0)

120 
	`Æ_şi_çl
(
l4´ÙÚum
,

122 
¬g
, 
	`Æ_g‘”rÜ
(
l4´ÙÚum
));

124 
	`nâl_exp_£t_l4´ÙÚum
(
exp
, 
tu¶e
, 
l4´ÙÚum
);

125 
	}
}

127 
	$Æ_şi_exp_·r£_¤c_pÜt
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

129 
ušt32_t
 
¥Üt
 = 
	`Æ_şi_·r£_u32
(
¬g
);

130 
ušt16_t
 
dpÜt
 = 
	`nâl_exp_g‘_d¡_pÜt
(
exp
, 
tu¶e
);

131 
	`nâl_exp_£t_pÜts
(
exp
, 
tu¶e
, 
¥Üt
, 
dpÜt
);

132 
	}
}

134 
	$Æ_şi_exp_·r£_d¡_pÜt
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

136 
ušt32_t
 
dpÜt
 = 
	`Æ_şi_·r£_u32
(
¬g
);

137 
ušt16_t
 
¥Üt
 = 
	`nâl_exp_g‘_¤c_pÜt
(
exp
, 
tu¶e
);

138 
	`nâl_exp_£t_pÜts
(
exp
, 
tu¶e
, 
¥Üt
, 
dpÜt
);

139 
	}
}

141 
	$Æ_şi_exp_·r£_icmp_id
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

143 
ušt32_t
 
id
 = 
	`Æ_şi_·r£_u32
(
¬g
);

144 
ušt8_t
 
ty³
 = 
	`nâl_exp_g‘_icmp_ty³
(
exp
, 
tu¶e
);

145 
ušt8_t
 
code
 = 
	`nâl_exp_g‘_icmp_code
(
exp
, 
tu¶e
);

146 
	`nâl_exp_£t_icmp
(
exp
, 
tu¶e
, 
id
, 
ty³
, 
code
);

147 
	}
}

149 
	$Æ_şi_exp_·r£_icmp_ty³
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

151 
ušt32_t
 
ty³
 = 
	`Æ_şi_·r£_u32
(
¬g
);

152 
ušt16_t
 
id
 = 
	`nâl_exp_g‘_icmp_id
(
exp
, 
tu¶e
);

153 
ušt8_t
 
code
 = 
	`nâl_exp_g‘_icmp_code
(
exp
, 
tu¶e
);

154 
	`nâl_exp_£t_icmp
(
exp
, 
tu¶e
, 
id
, 
ty³
, 
code
);

155 
	}
}

157 
	$Æ_şi_exp_·r£_icmp_code
(
nâl_exp
 *
exp
, 
tu¶e
, *
¬g
)

159 
ušt32_t
 
code
 = 
	`Æ_şi_·r£_u32
(
¬g
);

160 
ušt16_t
 
id
 = 
	`nâl_exp_g‘_icmp_id
(
exp
, 
tu¶e
);

161 
ušt8_t
 
ty³
 = 
	`nâl_exp_g‘_icmp_ty³
(
exp
, 
tu¶e
);

162 
	`nâl_exp_£t_icmp
(
exp
, 
tu¶e
, 
id
, 
ty³
, 
code
);

163 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/link.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/lšk.h
>

21 
	~<lšux/if.h
>

23 
¹Æ_lšk
 *
	$Æ_şi_lšk_®loc
()

25 
¹Æ_lšk
 *
lšk
;

27 
lšk
 = 
	`¹Æ_lšk_®loc
();

28 ià(!
lšk
)

29 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate†ink object");

31  
lšk
;

32 
	}
}

34 
Æ_ÿche
 *
	$Æ_şi_lšk_®loc_ÿche_çmy
(
Æ_sock
 *
sock
, 
çmy
)

36 
Æ_ÿche
 *
ÿche
;

37 
”r
;

39 ià((
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sock
, 
çmy
, &
ÿche
)) < 0)

40 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate†ink cache: %s",

41 
	`Æ_g‘”rÜ
(
”r
));

43 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

45  
ÿche
;

46 
	}
}

48 
Æ_ÿche
 *
	$Æ_şi_lšk_®loc_ÿche
(
Æ_sock
 *
sock
)

50  
	`Æ_şi_lšk_®loc_ÿche_çmy
(
sock
, 
AF_UNSPEC
);

51 
	}
}

53 
	$Æ_şi_lšk_·r£_çmy
(
¹Æ_lšk
 *
lšk
, *
¬g
)

55 
çmy
;

57 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)) < 0)

58 
	`Æ_şi_çl
(
EINVAL
,

59 "UÇbËØŒª¦©add»s çmy \"%s\"", 
¬g
);

61 
	`¹Æ_lšk_£t_çmy
(
lšk
, 
çmy
);

62 
	}
}

64 
	$Æ_şi_lšk_·r£_Çme
(
¹Æ_lšk
 *
lšk
, *
¬g
)

66 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
¬g
);

67 
	}
}

69 
	$Æ_şi_lšk_·r£_mtu
(
¹Æ_lšk
 *
lšk
, *
¬g
)

71 
ušt32_t
 
mtu
 = 
	`Æ_şi_·r£_u32
(
¬g
);

72 
	`¹Æ_lšk_£t_mtu
(
lšk
, 
mtu
);

73 
	}
}

75 
	$Æ_şi_lšk_·r£_ifšdex
(
¹Æ_lšk
 *
lšk
, *
¬g
)

77 
ušt32_t
 
šdex
 = 
	`Æ_şi_·r£_u32
(
¬g
);

78 
	`¹Æ_lšk_£t_ifšdex
(
lšk
, 
šdex
);

79 
	}
}

81 
	$Æ_şi_lšk_·r£_txqËn
(
¹Æ_lšk
 *
lšk
, *
¬g
)

83 
ušt32_t
 
qËn
 = 
	`Æ_şi_·r£_u32
(
¬g
);

84 
	`¹Æ_lšk_£t_txqËn
(
lšk
, 
qËn
);

85 
	}
}

87 
	$Æ_şi_lšk_·r£_weight
(
¹Æ_lšk
 *
lšk
, *
¬g
)

89 
	}
}

91 
	$Æ_şi_lšk_·r£_içlŸs
(
¹Æ_lšk
 *
lšk
, *
¬g
)

93 ià(
	`¡¾’
(
¬g
è> 
IFALIASZ
)

94 
	`Æ_şi_çl
(
ERANGE
,

96 
IFALIASZ
);

98 
	`¹Æ_lšk_£t_içlŸs
(
lšk
, 
¬g
);

99 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/neigh.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/Ãigh.h
>

22 
¹Æ_Ãigh
 *
	$Æ_şi_Ãigh_®loc
()

24 
¹Æ_Ãigh
 *
Ãigh
;

26 
Ãigh
 = 
	`¹Æ_Ãigh_®loc
();

27 ià(!
Ãigh
)

28 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate‚eighbour object");

30  
Ãigh
;

31 
	}
}

33 
	$Æ_şi_Ãigh_·r£_d¡
(
¹Æ_Ãigh
 *
Ãigh
, *
¬g
)

35 
Æ_addr
 *
a
;

36 
”r
;

38 
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_Ãigh_g‘_çmy
(
Ãigh
));

39 ià((
”r
 = 
	`¹Æ_Ãigh_£t_d¡
(
Ãigh
, 
a
)) < 0)

40 
	`Æ_şi_çl
(
”r
, "Unableo set†ocal‡ddress: %s",

41 
	`Æ_g‘”rÜ
(
”r
));

43 
	`Æ_addr_put
(
a
);

44 
	}
}

46 
	$Æ_şi_Ãigh_·r£_Îaddr
(
¹Æ_Ãigh
 *
Ãigh
, *
¬g
)

48 
Æ_addr
 *
a
;

50 
a
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
AF_UNSPEC
);

51 
	`¹Æ_Ãigh_£t_Îaddr
(
Ãigh
, 
a
);

52 
	`Æ_addr_put
(
a
);

53 
	}
}

55 
	$Æ_şi_Ãigh_·r£_dev
(
¹Æ_Ãigh
 *
Ãigh
,

56 
Æ_ÿche
 *
lšk_ÿche
, *
¬g
)

58 
iv®
;

60 ià(!(
iv®
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, 
¬g
)))

61 
	`Æ_şi_çl
(
ENOENT
, "Lšk \"%s\" dÛ nÙƒxi¡", 
¬g
);

63 
	`¹Æ_Ãigh_£t_ifšdex
(
Ãigh
, 
iv®
);

64 
	}
}

66 
	$Æ_şi_Ãigh_·r£_çmy
(
¹Æ_Ãigh
 *
Ãigh
, *
¬g
)

68 
çmy
;

70 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è=ğ
AF_UNSPEC
)

71 
	`Æ_şi_çl
(
EINVAL
,

72 "UÇbËØŒª¦©add»s çmy \"%s\"", 
¬g
);

74 
	`¹Æ_Ãigh_£t_çmy
(
Ãigh
, 
çmy
);

75 
	}
}

77 
	$Æ_şi_Ãigh_·r£_¡©e
(
¹Æ_Ãigh
 *
Ãigh
, *
¬g
)

79 
¡©e
;

81 ià((
¡©e
 = 
	`¹Æ_Ãigh_¡r2¡©e
(
¬g
)) < 0)

82 
	`Æ_şi_çl
(
¡©e
, "Unableoranslate state \"%s\": %s",

83 
¬g
, 
¡©e
);

85 
	`¹Æ_Ãigh_£t_¡©e
(
Ãigh
, 
¡©e
);

86 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/qdisc.c

18 
	~<Ãšk/şi/uts.h
>

19 
	~<Ãšk/şi/qdisc.h
>

20 
	~<Ãšk/rou‹/şass.h
>

22 
¹Æ_qdisc
 *
	$Æ_şi_qdisc_®loc
()

24 
¹Æ_qdisc
 *
qdisc
;

26 ià(!(
qdisc
 = 
	`¹Æ_qdisc_®loc
()))

27 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate qdisc object");

29  
qdisc
;

30 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/route.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/rou‹.h
>

22 
¹Æ_rou‹
 *
	$Æ_şi_rou‹_®loc
()

24 
¹Æ_rou‹
 *
rou‹
;

26 
rou‹
 = 
	`¹Æ_rou‹_®loc
();

27 ià(!
rou‹
)

28 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate„oute object");

30  
rou‹
;

31 
	}
}

33 
Æ_ÿche
 *
	$Æ_şi_rou‹_®loc_ÿche
(
Æ_sock
 *
sk
, 
æags
)

35 
Æ_ÿche
 *
ÿche
;

36 
”r
;

38 ià((
”r
 = 
	`¹Æ_rou‹_®loc_ÿche
(
sk
, 
AF_UNSPEC
, 
æags
, &
ÿche
)) < 0)

39 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate„oute cache: %s\n",

40 
	`Æ_g‘”rÜ
(
”r
));

42 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

44  
ÿche
;

45 
	}
}

47 
	$Æ_şi_rou‹_·r£_çmy
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

49 
çmy
;

51 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è!ğ
AF_UNSPEC
)

52 
	`¹Æ_rou‹_£t_çmy
(
rou‹
, 
çmy
);

53 
	}
}

55 
	$Æ_şi_rou‹_·r£_d¡
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

57 
Æ_addr
 *
addr
;

58 
”r
;

60 
addr
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_rou‹_g‘_çmy
(
rou‹
));

61 ià((
”r
 = 
	`¹Æ_rou‹_£t_d¡
(
rou‹
, 
addr
)) < 0)

62 
	`Æ_şi_çl
(
”r
, "Unableo set destination‡ddress: %s",

63 
	`Æ_g‘”rÜ
(
”r
));

65 
	`Æ_addr_put
(
addr
);

66 
	}
}

68 
	$Æ_şi_rou‹_·r£_¤c
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

70 
Æ_addr
 *
addr
;

71 
”r
;

73 
addr
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_rou‹_g‘_çmy
(
rou‹
));

74 ià((
”r
 = 
	`¹Æ_rou‹_£t_¤c
(
rou‹
, 
addr
)) < 0)

75 
	`Æ_şi_çl
(
”r
, "Unableo set source‡ddress: %s",

76 
	`Æ_g‘”rÜ
(
”r
));

78 
	`Æ_addr_put
(
addr
);

79 
	}
}

81 
	$Æ_şi_rou‹_·r£_´ef_¤c
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

83 
Æ_addr
 *
addr
;

84 
”r
;

86 
addr
 = 
	`Æ_şi_addr_·r£
(
¬g
, 
	`¹Æ_rou‹_g‘_çmy
(
rou‹
));

87 ià((
”r
 = 
	`¹Æ_rou‹_£t_´ef_¤c
(
rou‹
, 
addr
)) < 0)

88 
	`Æ_şi_çl
(
”r
, "Unableo set…referred source‡ddress: %s",

89 
	`Æ_g‘”rÜ
(
”r
));

91 
	`Æ_addr_put
(
addr
);

92 
	}
}

94 
	$Æ_şi_rou‹_·r£_m‘ric
(
¹Æ_rou‹
 *
rou‹
, *
subİts
)

97 *cÚ¡ 
tok’s
[] = {

111 
NULL
,

113 
lv®
;

114 *
¬g
, *
’d±r
;

116 *
subİts
 != '\0') {

117 
»t
 = 
	`g‘subİt
(&
subİts
, 
tok’s
, &
¬g
);

118 ià(
»t
 == -1)

119 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀm‘riøtok’ \"%s\"", 
¬g
);

121 ià(
»t
 == 0)

122 
	`Æ_şi_çl
(
EINVAL
, "Inv®id m‘riø\"%s\"", 
tok’s
[
»t
]);

124 ià(
¬g
 =ğ
NULL
)

125 
	`Æ_şi_çl
(
EINVAL
, "M‘riø\"%s\",‚Øv®ugiv’", 
tok’s
[
»t
]);

127 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

128 ià(
’d±r
 =ğ
¬g
)

129 
	`Æ_şi_çl
(
EINVAL
, "M‘riø\"%s\", v®unÙ‚um”ic", 
tok’s
[
»t
]);

131 ià((
»t
 = 
	`¹Æ_rou‹_£t_m‘ric
(
rou‹
,„‘, 
lv®
)) < 0)

132 
	`Æ_şi_çl
(
»t
, "Unableo set metric: %s",

133 
	`Æ_g‘”rÜ
(
»t
));

135 
	}
}

137 
	$Æ_şi_rou‹_·r£_Ãxthİ
(
¹Æ_rou‹
 *
rou‹
, *
subİts
,

138 
Æ_ÿche
 *
lšk_ÿche
)

141 
NH_DEV
,

142 
NH_VIA
,

143 
NH_WEIGHT
,

145 *cÚ¡ 
tok’s
[] = {

149 
NULL
,

151 
¹Æ_Ãxthİ
 *
nh
;

152 
lv®
;

153 
Æ_addr
 *
addr
;

154 
iv®
;

155 *
¬g
, *
’d±r
;

157 ià(!(
nh
 = 
	`¹Æ_rou‹_nh_®loc
()))

158 
	`Æ_şi_çl
(
ENOMEM
, "Out of memory");

160 *
subİts
 != '\0') {

161 
»t
 = 
	`g‘subİt
(&
subİts
, 
tok’s
, &
¬g
);

162 ià(
»t
 == -1)

163 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀÃxthİok’ \"%s\"", 
¬g
);

165 ià(
¬g
 =ğ
NULL
)

166 
	`Æ_şi_çl
(
EINVAL
, "Missing‡rgumento option \"%s\"\n",

167 
tok’s
[
»t
]);

169 
»t
) {

170 
NH_DEV
:

171 ià(!(
iv®
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, 
¬g
)))

172 
	`Æ_şi_çl
(
ENOENT
,"Lšk \"%s\" dÛ nÙƒxi¡", 
¬g
);

174 
	`¹Æ_rou‹_nh_£t_ifšdex
(
nh
, 
iv®
);

177 
NH_VIA
:

178 
addr
 = 
	`Æ_şi_addr_·r£
(
¬g
,
	`¹Æ_rou‹_g‘_çmy
(
rou‹
));

179 
	`¹Æ_rou‹_nh_£t_g©eway
(
nh
, 
addr
);

180 
	`Æ_addr_put
(
addr
);

183 
NH_WEIGHT
:

184 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

185 ià(
’d±r
 =ğ
¬g
)

186 
	`Æ_şi_çl
(
EINVAL
,

188 
¬g
);

189 
	`¹Æ_rou‹_nh_£t_weight
(
nh
, 
lv®
);

194 
	`¹Æ_rou‹_add_Ãxthİ
(
rou‹
, 
nh
);

195 
	}
}

197 
	$Æ_şi_rou‹_·r£_bË
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

199 
lv®
;

200 *
’d±r
;

201 
bË
;

203 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

204 ià(
’d±r
 =ğ
¬g
) {

205 ià((
bË
 = 
	`¹Æ_rou‹_¡r2bË
(
¬g
)) < 0)

206 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀbË‚am\"%s\"", 
¬g
);

209 
bË
 = 
lv®
;

212 
	`¹Æ_rou‹_£t_bË
(
rou‹
, 
bË
);

213 
	}
}

215 
	$Æ_şi_rou‹_·r£_´io
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

217 
lv®
;

218 *
’d±r
;

220 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

221 ià(
’d±r
 =ğ
¬g
)

222 
	`Æ_şi_çl
(
EINVAL
, "Invalid…riority value,‚ot‚umeric");

223 
	`¹Æ_rou‹_£t_´iÜ™y
(
rou‹
, 
lv®
);

224 
	}
}

226 
	$Æ_şi_rou‹_·r£_scİe
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

228 
iv®
;

230 ià((
iv®
 = 
	`¹Æ_¡r2scİe
(
¬g
)) < 0)

231 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀroutšg scİ\"%s\"", 
¬g
);

233 
	`¹Æ_rou‹_£t_scİe
(
rou‹
, 
iv®
);

234 
	}
}

236 
	$Æ_şi_rou‹_·r£_´ÙocŞ
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

238 
lv®
;

239 *
’d±r
;

240 
´Ùo
;

242 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

243 ià(
’d±r
 =ğ
¬g
) {

244 ià((
´Ùo
 = 
	`¹Æ_rou‹_¡r2´Ùo
(
¬g
)) < 0)

245 
	`Æ_şi_çl
(
EINVAL
,

247 
¬g
);

250 
´Ùo
 = 
lv®
;

253 
	`¹Æ_rou‹_£t_´ÙocŞ
(
rou‹
, 
´Ùo
);

254 
	}
}

256 
	$Æ_şi_rou‹_·r£_ty³
(
¹Æ_rou‹
 *
rou‹
, *
¬g
)

258 
iv®
;

260 ià((
iv®
 = 
	`Æ_¡r2¹Áy³
(
¬g
)) < 0)

261 
	`Æ_şi_çl
(
EINVAL
, "UnknowÀroutšgy³ \"%s\"", 
¬g
);

263 ià((
iv®
 = 
	`¹Æ_rou‹_£t_ty³
(
rou‹
, ival)) < 0)

264 
	`Æ_şi_çl
(
iv®
, "Unableo set„outingype: %s",

265 
	`Æ_g‘”rÜ
(
iv®
));

266 
	}
}

268 
	$Æ_şi_rou‹_·r£_iif
(
¹Æ_rou‹
 *
rou‹
, *
¬g
, 
Æ_ÿche
 *
lšk_ÿche
)

270 
iv®
;

272 ià(!(
iv®
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, 
¬g
)))

273 
	`Æ_şi_çl
(
ENOENT
, "Lšk \"%s\" dÛ nÙƒxi¡", 
¬g
);

275 
	`¹Æ_rou‹_£t_iif
(
rou‹
, 
iv®
);

276 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/rule.c

19 
	~<Ãšk/şi/uts.h
>

20 
	~<Ãšk/şi/ruË.h
>

22 
¹Æ_ruË
 *
	$Æ_şi_ruË_®loc
()

24 
¹Æ_ruË
 *
ruË
;

26 
ruË
 = 
	`¹Æ_ruË_®loc
();

27 ià(!
ruË
)

28 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate„ule object");

30  
ruË
;

31 
	}
}

33 
Æ_ÿche
 *
	$Æ_şi_ruË_®loc_ÿche
(
Æ_sock
 *
sk
)

35 
Æ_ÿche
 *
ÿche
;

36 
”r
;

38 ià((
”r
 = 
	`¹Æ_ruË_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
ÿche
)) < 0)

39 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate„outing„ule cache: %s\n",

40 
	`Æ_g‘”rÜ
(
”r
));

42 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

44  
ÿche
;

45 
	}
}

47 
	$Æ_şi_ruË_·r£_çmy
(
¹Æ_ruË
 *
ruË
, *
¬g
)

49 
çmy
;

51 ià((
çmy
 = 
	`Æ_¡r2af
(
¬g
)è!ğ
AF_UNSPEC
)

52 
	`¹Æ_ruË_£t_çmy
(
ruË
, 
çmy
);

53 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/tc.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

21 
	$Æ_şi_tc_·r£_dev
(
¹Æ_tc
 *
tc
, 
Æ_ÿche
 *
lšk_ÿche
, *
Çme
)

23 
¹Æ_lšk
 *
lšk
;

25 
lšk
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
Çme
);

26 ià(!
lšk
)

27 
	`Æ_şi_çl
(
ENOENT
, "Lšk \"%s\" dÛ nÙƒxi¡.", 
Çme
);

29 
	`¹Æ_tc_£t_lšk
(
tc
, 
lšk
);

30 
	`¹Æ_lšk_put
(
lšk
);

31 
	}
}

33 
	$Æ_şi_tc_·r£_·»Á
(
¹Æ_tc
 *
tc
, *
¬g
)

35 
ušt32_t
 
·»Á
;

36 
”r
;

38 ià((
”r
 = 
	`¹Æ_tc_¡r2hªdË
(
¬g
, &
·»Á
)) < 0)

39 
	`Æ_şi_çl
(
”r
, "Unableo…arse handle \"%s\": %s",

40 
¬g
, 
	`Æ_g‘”rÜ
(
”r
));

42 
	`¹Æ_tc_£t_·»Á
(
tc
, 
·»Á
);

43 
	}
}

45 
	$Æ_şi_tc_·r£_hªdË
(
¹Æ_tc
 *
tc
, *
¬g
, 
ü—‹
)

47 
ušt32_t
 
hªdË
, 
·»Á
;

48 
”r
;

50 
·»Á
 = 
	`¹Æ_tc_g‘_·»Á
(
tc
);

52 ià((
”r
 = 
	`¹Æ_tc_¡r2hªdË
(
¬g
, &
hªdË
)) < 0) {

53 ià(
”r
 =ğ-
NLE_OBJ_NOTFOUND
 && 
ü—‹
)

54 
”r
 = 
	`¹Æ_şassid_g’”©e
(
¬g
, &
hªdË
, 
·»Á
);

56 ià(
”r
 < 0)

57 
	`Æ_şi_çl
(
”r
, "Unableo…arse handle \"%s\": %s",

58 
¬g
, 
	`Æ_g‘”rÜ
(
”r
));

61 
	`¹Æ_tc_£t_hªdË
(
tc
, 
hªdË
);

62 
	}
}

64 
	$Æ_şi_tc_·r£_mtu
(
¹Æ_tc
 *
tc
, *
¬g
)

66 
	`¹Æ_tc_£t_mtu
(
tc
, 
	`Æ_şi_·r£_u32
(
¬g
));

67 
	}
}

69 
	$Æ_şi_tc_·r£_mpu
(
¹Æ_tc
 *
tc
, *
¬g
)

71 
	`¹Æ_tc_£t_mpu
(
tc
, 
	`Æ_şi_·r£_u32
(
¬g
));

72 
	}
}

74 
	$Æ_şi_tc_·r£_ov”h—d
(
¹Æ_tc
 *
tc
, *
¬g
)

76 
	`¹Æ_tc_£t_ov”h—d
(
tc
, 
	`Æ_şi_·r£_u32
(
¬g
));

77 
	}
}

79 
	$Æ_şi_tc_·r£_kšd
(
¹Æ_tc
 *
tc
, *
¬g
)

81 
	`¹Æ_tc_£t_kšd
(
tc
, 
¬g
);

82 
	}
}

84 
	$Æ_şi_tc_·r£_lškty³
(
¹Æ_tc
 *
tc
, *
¬g
)

86 
ty³
;

88 ià((
ty³
 = 
	`Æ_¡r2Î´Ùo
(
¬g
)) < 0)

89 
	`Æ_şi_çl
(
ty³
, "Unableo…arse†inktype \"%s\": %s",

90 
¬g
, 
	`Æ_g‘”rÜ
(
ty³
));

92 
	`¹Æ_tc_£t_lškty³
(
tc
, 
ty³
);

93 
	}
}

95 
NL_LIST_HEAD
(
tc_moduËs
);

97 
Æ_şi_tc_moduË
 *
	$__Æ_şi_tc_lookup
(
¹Æ_tc_İs
 *
İs
)

99 
Æ_şi_tc_moduË
 *
tm
;

101 
	`Æ_li¡_fÜ_—ch_’Œy
(
tm
, &
tc_moduËs
, 
tm_li¡
)

102 ià(
tm
->
tm_İs
 =ğ
İs
)

103  
tm
;

105  
NULL
;

106 
	}
}

108 
Æ_şi_tc_moduË
 *
	$Æ_şi_tc_lookup
(
¹Æ_tc_İs
 *
İs
)

110 
Æ_şi_tc_moduË
 *
tm
;

112 ià((
tm
 = 
	`__Æ_şi_tc_lookup
(
İs
)))

113  
tm
;

115 
İs
->
to_ty³
) {

116 
RTNL_TC_TYPE_QDISC
:

117 
RTNL_TC_TYPE_CLASS
:

118 
	`Æ_şi_lßd_moduË
("şi/qdisc", 
İs
->
to_kšd
);

121 
RTNL_TC_TYPE_CLS
:

122 
	`Æ_şi_lßd_moduË
("şi/şs", 
İs
->
to_kšd
);

126 
	`Æ_şi_çl
(
EINVAL
, "BUG: unhandled TC objectype %d",

127 
İs
->
to_ty³
);

130 ià(!(
tm
 = 
	`__Æ_şi_tc_lookup
(
İs
))) {

131 
	`Æ_şi_çl
(
EINVAL
, "Application bug: The shared†ibrary for "

134 
İs
->
to_kšd
);

137  
tm
;

138 
	}
}

140 
	$Æ_şi_tc_»gi¡”
(
Æ_şi_tc_moduË
 *
tm
)

142 
¹Æ_tc_İs
 *
İs
;

144 ià(!(
İs
 = 
	`¹Æ_tc_lookup_İs
(
tm
->
tm_ty³
,m->
tm_Çme
))) {

145 
	`Æ_şi_çl
(
ENOENT
, "Unableo„egister CLI TC module "

146 "\"%s\": NØm©chšg†ibÆ TC moduË found.", 
tm
->
tm_Çme
);

149 ià(
	`__Æ_şi_tc_lookup
(
İs
)) {

150 
	`Æ_şi_çl
(
EEXIST
, "Unableo„egister CLI TC module "

151 "\"%s\": ModuË‡Ì—dy„egi¡”ed.", 
tm
->
tm_Çme
);

154 
tm
->
tm_İs
 = 
İs
;

156 
	`Æ_li¡_add_
(&
tm
->
tm_li¡
, &
tc_moduËs
);

157 
	}
}

159 
	$Æ_şi_tc_uÄegi¡”
(
Æ_şi_tc_moduË
 *
tm
)

161 
	`Æ_li¡_d–
(&
tm
->
tm_li¡
);

162 
	}
}

	@mylibnl/libnl-3.2.25/src/lib/utils.c

24 
	~<Ãšk/şi/uts.h
>

35 
ušt32_t
 
	$Æ_şi_·r£_u32
(cÚ¡ *
¬g
)

37 
lv®
;

38 *
’d±r
;

40 
lv®
 = 
	`¡¹oul
(
¬g
, &
’d±r
, 0);

41 ià(
’d±r
 =ğ
¬g
 || 
lv®
 =ğ
ULONG_MAX
)

42 
	`Æ_şi_çl
(
EINVAL
, "Unableo…arse \"%s\",‚ot‡‚umber.",

43 
¬g
);

45  (
ušt32_t
è
lv®
;

46 
	}
}

48 
	$Æ_şi_´št_v”siÚ
()

50 
	`´štf
("libÆoŞ v”siÚ %s\n", 
LIBNL_VERSION
);

51 
	`´štf
(

59 
	`ex™
(0);

60 
	}
}

70 
	$Æ_şi_çl
(
”r
, cÚ¡ *
fmt
, ...)

72 
va_li¡
 
­
;

73 
buf
[256];

75 
	`årštf
(
¡d”r
, "Error: ");

77 ià(
fmt
) {

78 
	`va_¡¬t
(
­
, 
fmt
);

79 
	`vårštf
(
¡d”r
, 
fmt
, 
­
);

80 
	`va_’d
(
­
);

81 
	`årštf
(
¡d”r
, "\n");

83 
	`årštf
(
¡d”r
, "%s\n", 
	`¡»¼Ü_r
(
”r
, 
buf
, (buf)));

85 
	`ex™
(
	`abs
(
”r
));

86 
	}
}

88 
	$Æ_şi_cÚÃù
(
Æ_sock
 *
sk
, 
´ÙocŞ
)

90 
”r
;

92 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
´ÙocŞ
)) < 0)

93 
	`Æ_şi_çl
(
”r
, "Unableo connect‚etlink socket: %s",

94 
	`Æ_g‘”rÜ
(
”r
));

96  
”r
;

97 
	}
}

99 
Æ_sock
 *
	$Æ_şi_®loc_sock‘
()

101 
Æ_sock
 *
sock
;

103 ià(!(
sock
 = 
	`Æ_sock‘_®loc
()))

104 
	`Æ_şi_çl
(
ENOBUFS
, "Unableo‡llocate‚etlink socket");

106  
sock
;

107 
	}
}

109 
Æ_addr
 *
	$Æ_şi_addr_·r£
(cÚ¡ *
¡r
, 
çmy
)

111 
Æ_addr
 *
addr
;

112 
”r
;

114 ià((
”r
 = 
	`Æ_addr_·r£
(
¡r
, 
çmy
, &
addr
)) < 0)

115 
	`Æ_şi_çl
(
”r
, "Unableo…arse‡ddress \"%s\": %s",

116 
¡r
, 
	`Æ_g‘”rÜ
(
”r
));

118  
addr
;

119 
	}
}

121 
	$Æ_şi_·r£_dum±y³
(cÚ¡ *
¡r
)

123 ià(!
	`¡rÿ£cmp
(
¡r
, "brief"))

124  
NL_DUMP_LINE
;

125 ià(!
	`¡rÿ£cmp
(
¡r
, "details") || !strcasecmp(str, "detailed"))

126  
NL_DUMP_DETAILS
;

127 ià(!
	`¡rÿ£cmp
(
¡r
, "stats"))

128  
NL_DUMP_STATS
;

130 
	`Æ_şi_çl
(
EINVAL
, "Inv®id dum°ty³ \"%s\".\n", 
¡r
);

133 
	}
}

135 
	$Æ_şi_cÚfœm
(
Æ_objeù
 *
obj
, 
Æ_dump_·¿ms
 *
·¿ms
,

136 
deçuÉ_yes
)

138 
	`Æ_objeù_dump
(
obj
, 
·¿ms
);

141 
buf
[32] = { 0 };

142 
ªsw”
;

144 
	`´štf
("Delete? (%c/%c) ",

145 
deçuÉ_yes
 ? 'Y' : 'y',

146 
deçuÉ_yes
 ? 'n' : 'N');

148 ià(!
	`fg‘s
(
buf
, (buf), 
¡dš
)) {

149 
	`årštf
(
¡d”r
, "Error while„eading\n.");

153 (
ªsw”
 = 
	`tŞow”
(
buf
[0]))) {

155 
ªsw”
 = 
deçuÉ_yes
 ? 'y' : 'n';

158  
ªsw”
 == 'y';

161 
	`årštf
(
¡d”r
, "Invalid input,ry‡gain.\n");

166 
	}
}

168 
Æ_ÿche
 *
Æ_şi_®loc_ÿche
(
Æ_sock
 *
sock
, cÚ¡ *
Çme
,

169 (*
ac
)(
Æ_sock
 *, 
Æ_ÿche
 **))

171 
Æ_ÿche
 *
ÿche
;

172 
”r
;

174 ià((
”r
 = 
	`ac
(
sock
, &
ÿche
)) < 0)

175 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate %s cache: %s",

176 
Çme
, 
	`Æ_g‘”rÜ
(
”r
));

178 
	`Æ_ÿche_mngt_´ovide
(
ÿche
);

180  
ÿche
;

181 
	}
}

183 
	$Æ_şi_lßd_moduË
(cÚ¡ *
´efix
, cÚ¡ *
Çme
)

185 
·th
[
FILENAME_MAX
+1];

186 *
hªdË
;

188 
	`¢´štf
(
·th
, (path), "%s/%s/%s.so",

189 
PKGLIBDIR
, 
´efix
, 
Çme
);

191 ià(!(
hªdË
 = 
	`dlİ’
(
·th
, 
RTLD_NOW
)))

192 
	`Æ_şi_çl
(
ENOENT
, "Unableo†oad module \"%s\": %s\n",

193 
·th
, 
	`dË¼Ü
());

194 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-ct-add.c

14 
	~<Ãšk/şi/uts.h
>

15 
	~<Ãšk/şi/ù.h
>

17 
	gqu›t
 = 0;

19 
	$´št_u§ge
()

21 
	`´štf
(

45 
	`ex™
(0);

46 
	}
}

48 
	$maš
(
¬gc
, *
¬gv
[])

50 
Æ_sock
 *
sock
;

51 
nâl_ù
 *
ù
;

52 
Æ_dump_·¿ms
 
·¿ms
 = {

53 .
dp_ty³
 = 
NL_DUMP_LINE
,

54 .
dp_fd
 = 
¡dout
,

56 
”r
, 
Ææags
 = 
NLM_F_CREATE
;

58 
ù
 = 
	`Æ_şi_ù_®loc
();

61 
c
, 
İtidx
 = 0;

63 
ARG_ORIG_SRC
 = 257,

64 
ARG_ORIG_SPORT
 = 258,

65 
ARG_ORIG_DST
,

66 
ARG_ORIG_DPORT
,

67 
ARG_REPLY_SRC
,

68 
ARG_REPLY_SPORT
,

69 
ARG_REPLY_DST
,

70 
ARG_REPLY_DPORT
,

71 
ARG_MARK
,

72 
ARG_TIMEOUT
,

73 
ARG_STATUS
,

74 
ARG_ZONE
,

76 
İtiÚ
 
lÚg_İts
[] = {

81 { "Üig-¤c", 1, 0, 
ARG_ORIG_SRC
 },

82 { "Üig-¥Üt", 1, 0, 
ARG_ORIG_SPORT
 },

83 { "Üig-d¡", 1, 0, 
ARG_ORIG_DST
 },

84 { "Üig-dpÜt", 1, 0, 
ARG_ORIG_DPORT
 },

85 { "»¶y-¤c", 1, 0, 
ARG_REPLY_SRC
 },

86 { "»¶y-¥Üt", 1, 0, 
ARG_REPLY_SPORT
 },

87 { "»¶y-d¡", 1, 0, 
ARG_REPLY_DST
 },

88 { "»¶y-dpÜt", 1, 0, 
ARG_REPLY_DPORT
 },

90 { "m¬k", 1, 0, 
ARG_MARK
 },

91 { "timeout", 1, 0, 
ARG_TIMEOUT
 },

92 { "¡©us", 1, 0, 
ARG_STATUS
 },

93 { "zÚe", 1, 0, 
ARG_ZONE
 },

97 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46q:hv:p:F:", 
lÚg_İts
, &
İtidx
);

98 ià(
c
 == -1)

101 
c
) {

102 '?': 
	`ex™
(
NLE_INVAL
);

103 'q': 
qu›t
 = 1; ;

104 '4': 
	`nâl_ù_£t_çmy
(
ù
, 
AF_INET
); ;

105 '6': 
	`nâl_ù_£t_çmy
(
ù
, 
AF_INET6
); ;

106 'h': 
	`´št_u§ge
(); ;

107 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

108 'p': 
	`Æ_şi_ù_·r£_´ÙocŞ
(
ù
, 
İrg
); ;

109 
ARG_ORIG_SRC
: 
	`Æ_şi_ù_·r£_¤c
(
ù
, 0, 
İrg
); ;

110 
ARG_ORIG_SPORT
: 
	`Æ_şi_ù_·r£_¤c_pÜt
(
ù
, 0, 
İrg
); ;

111 
ARG_ORIG_DST
: 
	`Æ_şi_ù_·r£_d¡
(
ù
, 0, 
İrg
); ;

112 
ARG_ORIG_DPORT
: 
	`Æ_şi_ù_·r£_d¡_pÜt
(
ù
, 0, 
İrg
); ;

113 
ARG_REPLY_SRC
: 
	`Æ_şi_ù_·r£_¤c
(
ù
, 1, 
İrg
); ;

114 
ARG_REPLY_SPORT
: 
	`Æ_şi_ù_·r£_¤c_pÜt
(
ù
, 1, 
İrg
); ;

115 
ARG_REPLY_DST
: 
	`Æ_şi_ù_·r£_d¡
(
ù
, 1, 
İrg
); ;

116 
ARG_REPLY_DPORT
: 
	`Æ_şi_ù_·r£_d¡_pÜt
(
ù
, 1, 
İrg
); ;

117 'F': 
	`Æ_şi_ù_·r£_çmy
(
ù
, 
İrg
); ;

118 
ARG_MARK
: 
	`Æ_şi_ù_·r£_m¬k
(
ù
, 
İrg
); ;

119 
ARG_TIMEOUT
: 
	`Æ_şi_ù_·r£_timeout
(
ù
, 
İrg
); ;

120 
ARG_STATUS
: 
	`Æ_şi_ù_·r£_¡©us
(
ù
, 
İrg
); ;

121 
ARG_ZONE
: 
	`Æ_şi_ù_·r£_zÚe
(
ù
, 
İrg
); ;

125 ià(!
qu›t
) {

126 
	`´štf
("Adding ");

127 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
ù
), &
·¿ms
);

130 
sock
 = 
	`Æ_şi_®loc_sock‘
();

131 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

133 ià((
”r
 = 
	`nâl_ù_add
(
sock
, 
ù
, 
Ææags
)) < 0)

134 
	`Æ_şi_çl
(
”r
, "UÇbËØadd cÚÁ¿ck: %s", 
	`Æ_g‘”rÜ
(err));

136 ià(!
qu›t
) {

137 
	`´štf
("Added ");

138 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
ù
), &
·¿ms
);

142 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-ct-list.c

14 
	~<Ãšk/şi/uts.h
>

15 
	~<Ãšk/şi/ù.h
>

17 
	$´št_u§ge
()

19 
	`´štf
(

45 
	`ex™
(0);

46 
	}
}

48 
	$maš
(
¬gc
, *
¬gv
[])

50 
Æ_sock
 *
sock
;

51 
Æ_ÿche
 *
ù_ÿche
;

52 
nâl_ù
 *
ù
;

53 
Æ_dump_·¿ms
 
·¿ms
 = {

54 .
dp_ty³
 = 
NL_DUMP_LINE
,

55 .
dp_fd
 = 
¡dout
,

58 
ù
 = 
	`Æ_şi_ù_®loc
();

61 
c
, 
İtidx
 = 0;

63 
ARG_MARK
 = 257,

64 
ARG_TCP_STATE
 = 258,

65 
ARG_ORIG_SRC
,

66 
ARG_ORIG_SPORT
,

67 
ARG_ORIG_DST
,

68 
ARG_ORIG_DPORT
,

69 
ARG_REPLY_SRC
,

70 
ARG_REPLY_SPORT
,

71 
ARG_REPLY_DST
,

72 
ARG_REPLY_DPORT
,

73 
ARG_TIMEOUT
,

74 
ARG_REFCNT
,

75 
ARG_FLAGS
,

77 
İtiÚ
 
lÚg_İts
[] = {

83 { "tı-¡©e", 1, 0, 
ARG_TCP_STATE
 },

84 { "Üig-¤c", 1, 0, 
ARG_ORIG_SRC
 },

85 { "Üig-¥Üt", 1, 0, 
ARG_ORIG_SPORT
 },

86 { "Üig-d¡", 1, 0, 
ARG_ORIG_DST
 },

87 { "Üig-dpÜt", 1, 0, 
ARG_ORIG_DPORT
 },

88 { "»¶y-¤c", 1, 0, 
ARG_REPLY_SRC
 },

89 { "»¶y-¥Üt", 1, 0, 
ARG_REPLY_SPORT
 },

90 { "»¶y-d¡", 1, 0, 
ARG_REPLY_DST
 },

91 { "»¶y-dpÜt", 1, 0, 
ARG_REPLY_DPORT
 },

93 { "m¬k", 1, 0, 
ARG_MARK
 },

94 { "timeout", 1, 0, 
ARG_TIMEOUT
 },

95 { "»fút", 1, 0, 
ARG_REFCNT
 },

99 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46f:hvi:p:F:", 
lÚg_İts
, &
İtidx
);

100 ià(
c
 == -1)

103 
c
) {

104 '?': 
	`ex™
(
NLE_INVAL
);

105 '4': 
	`nâl_ù_£t_çmy
(
ù
, 
AF_INET
); ;

106 '6': 
	`nâl_ù_£t_çmy
(
ù
, 
AF_INET6
); ;

107 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

108 'h': 
	`´št_u§ge
(); ;

109 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

110 'i': 
	`Æ_şi_ù_·r£_id
(
ù
, 
İrg
); ;

111 'p': 
	`Æ_şi_ù_·r£_´ÙocŞ
(
ù
, 
İrg
); ;

112 
ARG_TCP_STATE
: 
	`Æ_şi_ù_·r£_tı_¡©e
(
ù
, 
İrg
); ;

113 
ARG_ORIG_SRC
: 
	`Æ_şi_ù_·r£_¤c
(
ù
, 0, 
İrg
); ;

114 
ARG_ORIG_SPORT
: 
	`Æ_şi_ù_·r£_¤c_pÜt
(
ù
, 0, 
İrg
); ;

115 
ARG_ORIG_DST
: 
	`Æ_şi_ù_·r£_d¡
(
ù
, 0, 
İrg
); ;

116 
ARG_ORIG_DPORT
: 
	`Æ_şi_ù_·r£_d¡_pÜt
(
ù
, 0, 
İrg
); ;

117 
ARG_REPLY_SRC
: 
	`Æ_şi_ù_·r£_¤c
(
ù
, 1, 
İrg
); ;

118 
ARG_REPLY_SPORT
: 
	`Æ_şi_ù_·r£_¤c_pÜt
(
ù
, 1, 
İrg
); ;

119 
ARG_REPLY_DST
: 
	`Æ_şi_ù_·r£_d¡
(
ù
, 1, 
İrg
); ;

120 
ARG_REPLY_DPORT
: 
	`Æ_şi_ù_·r£_d¡_pÜt
(
ù
, 1, 
İrg
); ;

121 'F': 
	`Æ_şi_ù_·r£_çmy
(
ù
, 
İrg
); ;

122 
ARG_MARK
: 
	`Æ_şi_ù_·r£_m¬k
(
ù
, 
İrg
); ;

123 
ARG_TIMEOUT
: 
	`Æ_şi_ù_·r£_timeout
(
ù
, 
İrg
); ;

124 
ARG_REFCNT
: 
	`Æ_şi_ù_·r£_u£
(
ù
, 
İrg
); ;

125 
ARG_FLAGS
: 
	`Æ_şi_ù_·r£_¡©us
(
ù
, 
İrg
); ;

129 
sock
 = 
	`Æ_şi_®loc_sock‘
();

130 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

131 
ù_ÿche
 = 
	`Æ_şi_ù_®loc_ÿche
(
sock
);

133 
	`Æ_ÿche_dump_f‹r
(
ù_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
ù
));

136 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-exp-add.c

16 
	~<Ãšk/şi/uts.h
>

17 
	~<Ãšk/şi/exp.h
>

19 
	gqu›t
 = 0;

21 
	$´št_u§ge
()

23 
	`´štf
(

54 
	`ex™
(0);

55 
	}
}

57 
	$maš
(
¬gc
, *
¬gv
[])

59 
Æ_sock
 *
sock
;

60 
nâl_exp
 *
exp
;

61 
Æ_dump_·¿ms
 
·¿ms
 = {

62 .
dp_ty³
 = 
NL_DUMP_LINE
,

63 .
dp_fd
 = 
¡dout
,

65 
”r
, 
Ææags
 = 
NLM_F_CREATE
;

67 
exp
 = 
	`Æ_şi_exp_®loc
();

70 
c
, 
İtidx
 = 0;

72 
ARG_MARK
 = 270,

73 
ARG_TCP_STATE
 = 271,

74 
ARG_EXPECT_PROTO
,

75 
ARG_EXPECT_SRC
,

76 
ARG_EXPECT_SPORT
,

77 
ARG_EXPECT_DST
,

78 
ARG_EXPECT_DPORT
,

79 
ARG_MASTER_PROTO
,

80 
ARG_MASTER_SRC
,

81 
ARG_MASTER_SPORT
,

82 
ARG_MASTER_DST
,

83 
ARG_MASTER_DPORT
,

84 
ARG_MASK_PROTO
,

85 
ARG_MASK_SRC
,

86 
ARG_MASK_SPORT
,

87 
ARG_MASK_DST
,

88 
ARG_MASK_DPORT
,

89 
ARG_NAT_PROTO
,

90 
ARG_NAT_SRC
,

91 
ARG_NAT_SPORT
,

92 
ARG_NAT_DST
,

93 
ARG_NAT_DPORT
,

94 
ARG_NAT_DIR
,

95 
ARG_TIMEOUT
,

96 
ARG_HELPER_NAME
,

97 
ARG_REPLACE
,

98 
ARG_FLAGS
,

100 
İtiÚ
 
lÚg_İts
[] = {

101 { "»¶aû", 1, 0, 
ARG_REPLACE
 },

106 { "ex³ù-´Ùo", 1, 0, 
ARG_EXPECT_PROTO
 },

107 { "ex³ù-¤c", 1, 0, 
ARG_EXPECT_SRC
 },

108 { "ex³ù-¥Üt", 1, 0, 
ARG_EXPECT_SPORT
 },

109 { "ex³ù-d¡", 1, 0, 
ARG_EXPECT_DST
 },

110 { "ex³ù-dpÜt", 1, 0, 
ARG_EXPECT_DPORT
 },

111 { "ma¡”-´Ùo", 1, 0, 
ARG_MASTER_PROTO
 },

112 { "ma¡”-¤c", 1, 0, 
ARG_MASTER_SRC
 },

113 { "ma¡”-¥Üt", 1, 0, 
ARG_MASTER_SPORT
 },

114 { "ma¡”-d¡", 1, 0, 
ARG_MASTER_DST
 },

115 { "ma¡”-dpÜt", 1, 0, 
ARG_MASTER_DPORT
 },

116 { "mask-´Ùo", 1, 0, 
ARG_MASK_PROTO
 },

117 { "mask-¤c", 1, 0, 
ARG_MASK_SRC
 },

118 { "mask-¥Üt", 1, 0, 
ARG_MASK_SPORT
 },

119 { "mask-d¡", 1, 0, 
ARG_MASK_DST
 },

120 { "mask-dpÜt", 1, 0, 
ARG_MASK_DPORT
 },

121 { "Çt-´Ùo", 1, 0, 
ARG_NAT_PROTO
 },

122 { "Çt-¤c", 1, 0, 
ARG_NAT_SRC
 },

123 { "Çt-¥Üt", 1, 0, 
ARG_NAT_SPORT
 },

124 { "Çt-d¡", 1, 0, 
ARG_NAT_DST
 },

125 { "Çt-dpÜt", 1, 0, 
ARG_NAT_DPORT
 },

126 { "Çt-dœ", 1, 0, 
ARG_NAT_DIR
 },

128 { "timeout", 1, 0, 
ARG_TIMEOUT
 },

129 { "h–³r", 1, 0, 
ARG_HELPER_NAME
 },

130 { "æags", 1, 0, 
ARG_FLAGS
},

134 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46f:hvi:p:F:", 
lÚg_İts
, &
İtidx
);

135 ià(
c
 == -1)

138 
c
) {

139 '?': 
	`ex™
(
NLE_INVAL
);

140 
ARG_REPLACE
: 
Ææags
 |ğ
NLM_F_REPLACE
; ;

141 'q': 
qu›t
 = 1; ;

142 '4': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET
); ;

143 '6': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET6
); ;

144 'h': 
	`´št_u§ge
(); ;

145 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

146 'i': 
	`Æ_şi_exp_·r£_id
(
exp
, 
İrg
); ;

147 
ARG_EXPECT_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

148 
ARG_EXPECT_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

149 
ARG_EXPECT_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

150 
ARG_EXPECT_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

151 
ARG_EXPECT_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

152 
ARG_MASTER_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

153 
ARG_MASTER_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

154 
ARG_MASTER_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

155 
ARG_MASTER_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

156 
ARG_MASTER_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

157 
ARG_MASK_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

158 
ARG_MASK_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

159 
ARG_MASK_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

160 
ARG_MASK_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

161 
ARG_MASK_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

162 
ARG_NAT_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
İrg
); ;

163 
ARG_NAT_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
İrg
); ;

164 
ARG_NAT_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
İrg
); ;

165 
ARG_NAT_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
İrg
); ;

166 
ARG_NAT_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_NAT
, 
İrg
); ;

167 
ARG_NAT_DIR
: 
	`Æ_şi_exp_·r£_Çt_dœ
(
exp
, 
İrg
); ;

168 'F': 
	`Æ_şi_exp_·r£_çmy
(
exp
, 
İrg
); ;

169 
ARG_TIMEOUT
: 
	`Æ_şi_exp_·r£_timeout
(
exp
, 
İrg
); ;

170 
ARG_HELPER_NAME
: 
	`Æ_şi_exp_·r£_h–³r_Çme
(
exp
, 
İrg
); ;

171 
ARG_FLAGS
: 
	`Æ_şi_exp_·r£_æags
(
exp
, 
İrg
); ;

175 
sock
 = 
	`Æ_şi_®loc_sock‘
();

176 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

178 ià((
”r
 = 
	`nâl_exp_add
(
sock
, 
exp
, 
Ææags
)) < 0)

179 
	`Æ_şi_çl
(
”r
, "UÇbËØaddƒx³ù©iÚ: %s", 
	`Æ_g‘”rÜ
(err));

181 ià(!
qu›t
) {

182 
	`´štf
("Added ");

183 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
exp
), &
·¿ms
);

187 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-exp-delete.c

15 
	~<Ãšk/şi/uts.h
>

16 
	~<Ãšk/şi/exp.h
>

18 
	gqu›t
 = 0;

20 
	$´št_u§ge
()

22 
	`´štf
(

53 
	`ex™
(0);

54 
	}
}

56 
	$maš
(
¬gc
, *
¬gv
[])

58 
Æ_sock
 *
sock
;

59 
nâl_exp
 *
exp
;

60 
Æ_dump_·¿ms
 
·¿ms
 = {

61 .
dp_ty³
 = 
NL_DUMP_LINE
,

62 .
dp_fd
 = 
¡dout
,

64 
”r
, 
Ææags
 = 0;

66 
exp
 = 
	`Æ_şi_exp_®loc
();

69 
c
, 
İtidx
 = 0;

71 
ARG_MARK
 = 270,

72 
ARG_TCP_STATE
 = 271,

73 
ARG_EXPECT_PROTO
,

74 
ARG_EXPECT_SRC
,

75 
ARG_EXPECT_SPORT
,

76 
ARG_EXPECT_DST
,

77 
ARG_EXPECT_DPORT
,

78 
ARG_MASTER_PROTO
,

79 
ARG_MASTER_SRC
,

80 
ARG_MASTER_SPORT
,

81 
ARG_MASTER_DST
,

82 
ARG_MASTER_DPORT
,

83 
ARG_MASK_PROTO
,

84 
ARG_MASK_SRC
,

85 
ARG_MASK_SPORT
,

86 
ARG_MASK_DST
,

87 
ARG_MASK_DPORT
,

88 
ARG_TIMEOUT
,

89 
ARG_HELPER_NAME
,

90 
ARG_FLAGS
,

92 
İtiÚ
 
lÚg_İts
[] = {

97 { "ex³ù-´Ùo", 1, 0, 
ARG_EXPECT_PROTO
 },

98 { "ex³ù-¤c", 1, 0, 
ARG_EXPECT_SRC
 },

99 { "ex³ù-¥Üt", 1, 0, 
ARG_EXPECT_SPORT
 },

100 { "ex³ù-d¡", 1, 0, 
ARG_EXPECT_DST
 },

101 { "ex³ù-dpÜt", 1, 0, 
ARG_EXPECT_DPORT
 },

102 { "ma¡”-´Ùo", 1, 0, 
ARG_MASTER_PROTO
 },

103 { "ma¡”-¤c", 1, 0, 
ARG_MASTER_SRC
 },

104 { "ma¡”-¥Üt", 1, 0, 
ARG_MASTER_SPORT
 },

105 { "ma¡”-d¡", 1, 0, 
ARG_MASTER_DST
 },

106 { "ma¡”-dpÜt", 1, 0, 
ARG_MASTER_DPORT
 },

107 { "mask-´Ùo", 1, 0, 
ARG_MASK_PROTO
 },

108 { "mask-¤c", 1, 0, 
ARG_MASK_SRC
 },

109 { "mask-¥Üt", 1, 0, 
ARG_MASK_SPORT
 },

110 { "mask-d¡", 1, 0, 
ARG_MASK_DST
 },

111 { "mask-dpÜt", 1, 0, 
ARG_MASK_DPORT
 },

113 { "timeout", 1, 0, 
ARG_TIMEOUT
 },

114 { "h–³r", 1, 0, 
ARG_HELPER_NAME
 },

115 { "æags", 1, 0, 
ARG_FLAGS
},

119 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46f:hvi:p:F:", 
lÚg_İts
, &
İtidx
);

120 ià(
c
 == -1)

123 
c
) {

124 '?': 
	`ex™
(
NLE_INVAL
);

125 'q': 
qu›t
 = 1; ;

126 '4': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET
); ;

127 '6': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET6
); ;

128 'h': 
	`´št_u§ge
(); ;

129 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

130 'i': 
	`Æ_şi_exp_·r£_id
(
exp
, 
İrg
); ;

131 
ARG_EXPECT_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

132 
ARG_EXPECT_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

133 
ARG_EXPECT_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

134 
ARG_EXPECT_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

135 
ARG_EXPECT_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

136 
ARG_MASTER_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

137 
ARG_MASTER_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

138 
ARG_MASTER_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

139 
ARG_MASTER_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

140 
ARG_MASTER_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

141 
ARG_MASK_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

142 
ARG_MASK_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

143 
ARG_MASK_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

144 
ARG_MASK_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

145 
ARG_MASK_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASK
, 
İrg
); ;

146 'F': 
	`Æ_şi_exp_·r£_çmy
(
exp
, 
İrg
); ;

147 
ARG_TIMEOUT
: 
	`Æ_şi_exp_·r£_timeout
(
exp
, 
İrg
); ;

148 
ARG_HELPER_NAME
: 
	`Æ_şi_exp_·r£_h–³r_Çme
(
exp
, 
İrg
); ;

149 
ARG_FLAGS
: 
	`Æ_şi_exp_·r£_æags
(
exp
, 
İrg
); ;

153 
sock
 = 
	`Æ_şi_®loc_sock‘
();

154 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

156 ià((
”r
 = 
	`nâl_exp_d–
(
sock
, 
exp
, 
Ææags
)) < 0)

157 
	`Æ_şi_çl
(
”r
, "UÇbËØd–‘ex³ù©iÚ: %s", 
	`Æ_g‘”rÜ
(err));

159 ià(!
qu›t
) {

160 
	`´štf
("Deleted ");

161 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
exp
), &
·¿ms
);

165 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-exp-list.c

15 
	~<Ãšk/şi/uts.h
>

16 
	~<Ãšk/şi/exp.h
>

18 
	$´št_u§ge
()

20 
	`´štf
(

45 
	`ex™
(0);

46 
	}
}

48 
	$maš
(
¬gc
, *
¬gv
[])

50 
Æ_sock
 *
sock
;

51 
Æ_ÿche
 *
exp_ÿche
;

52 
nâl_exp
 *
exp
;

53 
Æ_dump_·¿ms
 
·¿ms
 = {

54 .
dp_ty³
 = 
NL_DUMP_LINE
,

55 .
dp_fd
 = 
¡dout
,

58 
exp
 = 
	`Æ_şi_exp_®loc
();

61 
c
, 
İtidx
 = 0;

63 
ARG_MARK
 = 270,

64 
ARG_TCP_STATE
 = 271,

65 
ARG_EXPECT_PROTO
,

66 
ARG_EXPECT_SRC
,

67 
ARG_EXPECT_SPORT
,

68 
ARG_EXPECT_DST
,

69 
ARG_EXPECT_DPORT
,

70 
ARG_MASTER_PROTO
,

71 
ARG_MASTER_SRC
,

72 
ARG_MASTER_SPORT
,

73 
ARG_MASTER_DST
,

74 
ARG_MASTER_DPORT
,

75 
ARG_TIMEOUT
,

76 
ARG_HELPER_NAME
,

77 
ARG_FLAGS
,

79 
İtiÚ
 
lÚg_İts
[] = {

84 { "ex³ù-´Ùo", 1, 0, 
ARG_EXPECT_PROTO
 },

85 { "ex³ù-¤c", 1, 0, 
ARG_EXPECT_SRC
 },

86 { "ex³ù-¥Üt", 1, 0, 
ARG_EXPECT_SPORT
 },

87 { "ex³ù-d¡", 1, 0, 
ARG_EXPECT_DST
 },

88 { "ex³ù-dpÜt", 1, 0, 
ARG_EXPECT_DPORT
 },

89 { "ma¡”-´Ùo", 1, 0, 
ARG_MASTER_PROTO
 },

90 { "ma¡”-¤c", 1, 0, 
ARG_MASTER_SRC
 },

91 { "ma¡”-¥Üt", 1, 0, 
ARG_MASTER_SPORT
 },

92 { "ma¡”-d¡", 1, 0, 
ARG_MASTER_DST
 },

93 { "ma¡”-dpÜt", 1, 0, 
ARG_MASTER_DPORT
 },

95 { "timeout", 1, 0, 
ARG_TIMEOUT
 },

96 { "h–³r", 1, 0, 
ARG_HELPER_NAME
 },

97 { "æags", 1, 0, 
ARG_FLAGS
},

101 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46f:hvi:p:F:", 
lÚg_İts
, &
İtidx
);

102 ià(
c
 == -1)

105 
c
) {

106 '?': 
	`ex™
(
NLE_INVAL
);

107 '4': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET
); ;

108 '6': 
	`nâl_exp_£t_çmy
(
exp
, 
AF_INET6
); ;

109 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

110 'h': 
	`´št_u§ge
(); ;

111 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

112 'i': 
	`Æ_şi_exp_·r£_id
(
exp
, 
İrg
); ;

113 
ARG_EXPECT_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

114 
ARG_EXPECT_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

115 
ARG_EXPECT_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

116 
ARG_EXPECT_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

117 
ARG_EXPECT_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_EXPECT
, 
İrg
); ;

118 
ARG_MASTER_PROTO
: 
	`Æ_şi_exp_·r£_l4´ÙÚum
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

119 
ARG_MASTER_SRC
: 
	`Æ_şi_exp_·r£_¤c
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

120 
ARG_MASTER_SPORT
: 
	`Æ_şi_exp_·r£_¤c_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

121 
ARG_MASTER_DST
: 
	`Æ_şi_exp_·r£_d¡
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

122 
ARG_MASTER_DPORT
: 
	`Æ_şi_exp_·r£_d¡_pÜt
(
exp
, 
NFNL_EXP_TUPLE_MASTER
, 
İrg
); ;

123 'F': 
	`Æ_şi_exp_·r£_çmy
(
exp
, 
İrg
); ;

124 
ARG_TIMEOUT
: 
	`Æ_şi_exp_·r£_timeout
(
exp
, 
İrg
); ;

125 
ARG_HELPER_NAME
: 
	`Æ_şi_exp_·r£_h–³r_Çme
(
exp
, 
İrg
); ;

126 
ARG_FLAGS
: 
	`Æ_şi_exp_·r£_æags
(
exp
, 
İrg
); ;

130 
sock
 = 
	`Æ_şi_®loc_sock‘
();

131 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

132 
exp_ÿche
 = 
	`Æ_şi_exp_®loc_ÿche
(
sock
);

134 
	`Æ_ÿche_dump_f‹r
(
exp_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
exp
));

137 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-log.c

14 
	~<Ãšk/şi/uts.h
>

15 
	~<Ãšk/şi/lšk.h
>

16 
	~<lšux/Ãtf‹r/nâ‘lšk_log.h
>

17 
	~<Ãšk/Ãtf‹r/nâl.h
>

18 
	~<Ãšk/Ãtf‹r/log.h
>

20 
nâl_log
 *
	$®loc_log
()

22 
nâl_log
 *
log
;

24 
log
 = 
	`nâl_log_®loc
();

25 ià(!
log
)

26 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate†og object");

28  
log
;

29 
	}
}

31 
	$obj_šput
(
Æ_objeù
 *
obj
, *
¬g
)

33 
Æ_dump_·¿ms
 
dp
 = {

34 .
dp_ty³
 = 
NL_DUMP_STATS
,

35 .
dp_fd
 = 
¡dout
,

36 .
dp_dump_msgty³
 = 1,

39 
	`Æ_objeù_dump
(
obj
, &
dp
);

40 
	}
}

42 
	$ev’t_šput
(
Æ_msg
 *
msg
, *
¬g
)

44 ià(
	`Æ_msg_·r£
(
msg
, &
obj_šput
, 
NULL
) < 0)

45 
	`årštf
(
¡d”r
, "<<EVENT>> Unknown messageype\n");

48  
NL_STOP
;

49 
	}
}

51 
	$maš
(
¬gc
, *
¬gv
[])

53 
Æ_sock
 *
nf_sock
;

54 
Æ_sock
 *
¹_sock
;

55 
Æ_ÿche
 *
lšk_ÿche
;

56 
nâl_log
 *
log
;

57 
nâl_log_cİy_mode
 
cİy_mode
;

58 
ušt32_t
 
cİy_¿nge
;

59 
”r
;

60 
çmy
;

62 
nf_sock
 = 
	`Æ_şi_®loc_sock‘
();

63 
	`Æ_sock‘_di§bË_£q_check
(
nf_sock
);

64 
	`Æ_sock‘_modify_cb
(
nf_sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ev’t_šput
, 
NULL
);

66 ià((
¬gc
 > 1 && !
	`¡rÿ£cmp
(
¬gv
[1], "-h")) ||‡rgc < 3) {

67 
	`´štf
("Usage:‚f-log family group [ copy_mode ] "

72 
	`Æ_şi_cÚÃù
(
nf_sock
, 
NETLINK_NETFILTER
);

74 
çmy
 = 
	`Æ_¡r2af
(
¬gv
[1]);

75 ià(
çmy
 =ğ
AF_UNSPEC
)

76 
	`Æ_şi_çl
(
NLE_INVAL
, "Unknown family \"%s\": %s",

77 
¬gv
[1], 
	`Æ_g‘”rÜ
(
çmy
));

79 
	`nâl_log_pf_unbšd
(
nf_sock
, 
çmy
);

80 ià((
”r
 = 
	`nâl_log_pf_bšd
(
nf_sock
, 
çmy
)) < 0)

81 
	`Æ_şi_çl
(
”r
, "Unableo bind†ogger: %s",

82 
	`Æ_g‘”rÜ
(
”r
));

84 
log
 = 
	`®loc_log
();

85 
	`nâl_log_£t_group
(
log
, 
	`©oi
(
¬gv
[2]));

87 
cİy_mode
 = 
NFNL_LOG_COPY_META
;

88 ià(
¬gc
 > 3) {

89 
cİy_mode
 = 
	`nâl_log_¡r2cİy_mode
(
¬gv
[3]);

90 ià(
cİy_mode
 < 0)

91 
	`Æ_şi_çl
(
cİy_mode
,

93 
¬gv
[3], 
	`Æ_g‘”rÜ
(
cİy_mode
));

95 
	`nâl_log_£t_cİy_mode
(
log
, 
cİy_mode
);

97 
cİy_¿nge
 = 0xFFFF;

98 ià(
¬gc
 > 4)

99 
cİy_¿nge
 = 
	`©oi
(
¬gv
[4]);

100 
	`nâl_log_£t_cİy_¿nge
(
log
, 
cİy_¿nge
);

102 ià((
”r
 = 
	`nâl_log_ü—‹
(
nf_sock
, 
log
)) < 0)

103 
	`Æ_şi_çl
(
”r
, "Unableo bind instance: %s",

104 
	`Æ_g‘”rÜ
(
”r
));

107 
Æ_dump_·¿ms
 
dp
 = {

108 .
dp_ty³
 = 
NL_DUMP_STATS
,

109 .
dp_fd
 = 
¡dout
,

110 .
dp_dump_msgty³
 = 1,

113 
	`´štf
("log…arams: ");

114 
	`Æ_objeù_dump
((
Æ_objeù
 *è
log
, &
dp
);

117 
¹_sock
 = 
	`Æ_şi_®loc_sock‘
();

118 
	`Æ_şi_cÚÃù
(
¹_sock
, 
NETLINK_ROUTE
);

119 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
¹_sock
);

122 
fd_£t
 
rfds
;

123 
nffd
, 
¹fd
, 
maxfd
, 
»tv®
;

125 
	`FD_ZERO
(&
rfds
);

127 
maxfd
 = 
nffd
 = 
	`Æ_sock‘_g‘_fd
(
nf_sock
);

128 
	`FD_SET
(
nffd
, &
rfds
);

130 
¹fd
 = 
	`Æ_sock‘_g‘_fd
(
¹_sock
);

131 
	`FD_SET
(
¹fd
, &
rfds
);

132 ià(
maxfd
 < 
¹fd
)

133 
maxfd
 = 
¹fd
;

136 
»tv®
 = 
	`£Ëù
(
maxfd
+1, &
rfds
, 
NULL
, NULL, NULL);

138 ià(
»tv®
) {

139 ià(
	`FD_ISSET
(
nffd
, &
rfds
))

140 
	`Æ_»cvmsgs_deçuÉ
(
nf_sock
);

141 ià(
	`FD_ISSET
(
¹fd
, &
rfds
))

142 
	`Æ_»cvmsgs_deçuÉ
(
¹_sock
);

147 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-monitor.c

14 
	~<Ãšk/şi/uts.h
>

15 
	~<Ãšk/Ãtf‹r/nâl.h
>

17 
	$obj_šput
(
Æ_objeù
 *
obj
, *
¬g
)

19 
Æ_dump_·¿ms
 
dp
 = {

20 .
dp_ty³
 = 
NL_DUMP_STATS
,

21 .
dp_fd
 = 
¡dout
,

22 .
dp_dump_msgty³
 = 1,

25 
	`Æ_objeù_dump
(
obj
, &
dp
);

26 
	}
}

28 
	$ev’t_šput
(
Æ_msg
 *
msg
, *
¬g
)

30 ià(
	`Æ_msg_·r£
(
msg
, &
obj_šput
, 
NULL
) < 0)

31 
	`årštf
(
¡d”r
, "<<EVENT>> Unknown messageype\n");

34  
NL_STOP
;

35 
	}
}

37 
	$maš
(
¬gc
, *
¬gv
[])

39 
Æ_sock
 *
sock
;

40 
”r
;

41 
i
, 
idx
;

44 
nâ‘lšk_groups
 
gr_id
;

45 cÚ¡ * 
gr_Çme
;

46 } 
groups
[] = {

47 { 
NFNLGRP_CONNTRACK_NEW
, "ct-new" },

48 { 
NFNLGRP_CONNTRACK_UPDATE
, "ct-update" },

49 { 
NFNLGRP_CONNTRACK_DESTROY
, "ct-destroy" },

50 { 
NFNLGRP_NONE
, 
NULL
 }

53 
sock
 = 
	`Æ_şi_®loc_sock‘
();

54 
	`Æ_sock‘_di§bË_£q_check
(
sock
);

55 
	`Æ_sock‘_modify_cb
(
sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ev’t_šput
, 
NULL
);

57 ià(
¬gc
 > 1 && !
	`¡rÿ£cmp
(
¬gv
[1], "-h")) {

58 
	`´štf
("Usage:‚f-monitor [<groups>]\n");

60 
	`´štf
("Known groups:");

61 
i
 = 0; 
groups
[i].
gr_id
 !ğ
NFNLGRP_NONE
; i++)

62 
	`´štf
(" %s", 
groups
[
i
].
gr_Çme
);

63 
	`´štf
("\n");

67 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_NETFILTER
);

69 
idx
 = 1; 
¬gc
 > idx; idx++) {

70 
i
 = 0; 
groups
[i].
gr_id
 !ğ
NFNLGRP_NONE
; i++) {

71 ià(
	`¡rcmp
(
¬gv
[
idx
], 
groups
[
i
].
gr_Çme
))

74 
”r
 = 
	`Æ_sock‘_add_memb”sh
(
sock
, 
groups
[
i
].
gr_id
);

75 ià(
”r
 < 0)

76 
	`Æ_şi_çl
(
”r
,

78 
	`Æ_g‘”rÜ
(
”r
));

82 ià(
groups
[
i
].
gr_id
 =ğ
NFNLGRP_NONE
)

83 
	`Æ_şi_çl
(
NLE_OBJ_NOTFOUND
, "Unknown group: \"%s\"",

84 
¬gv
[
idx
]);

88 
fd_£t
 
rfds
;

89 
fd
, 
»tv®
;

91 
fd
 = 
	`Æ_sock‘_g‘_fd
(
sock
);

93 
	`FD_ZERO
(&
rfds
);

94 
	`FD_SET
(
fd
, &
rfds
);

96 
»tv®
 = 
	`£Ëù
(
fd
+1, &
rfds
, 
NULL
, NULL, NULL);

98 ià(
»tv®
) {

100 
	`Æ_»cvmsgs_deçuÉ
(
sock
);

105 
	}
}

	@mylibnl/libnl-3.2.25/src/nf-queue.c

14 
	~<Ãšk/şi/uts.h
>

15 
	~<Ãšk/şi/lšk.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<lšux/Ãtf‹r.h
>

18 
	~<lšux/Ãtf‹r/nâ‘lšk_queue.h
>

19 
	~<Ãšk/Ãtf‹r/nâl.h
>

20 
	~<Ãšk/Ãtf‹r/queue.h
>

21 
	~<Ãšk/Ãtf‹r/queue_msg.h
>

23 
Æ_sock
 *
	gnf_sock
;

25 
nâl_queue
 *
	$®loc_queue
()

27 
nâl_queue
 *
queue
;

29 
queue
 = 
	`nâl_queue_®loc
();

30 ià(!
queue
)

31 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate queue object");

33  
queue
;

34 
	}
}

37 
	$obj_šput
(
Æ_objeù
 *
obj
, *
¬g
)

39 
nâl_queue_msg
 *
msg
 = (nâl_queue_msg *è
obj
;

40 
Æ_dump_·¿ms
 
dp
 = {

41 .
dp_ty³
 = 
NL_DUMP_STATS
,

42 .
dp_fd
 = 
¡dout
,

43 .
dp_dump_msgty³
 = 1,

46 
	`nâl_queue_msg_£t_v”diù
(
msg
, 
NF_ACCEPT
);

47 
	`Æ_objeù_dump
(
obj
, &
dp
);

48 
	`nâl_queue_msg_£nd_v”diù
(
nf_sock
, 
msg
);

49 
	}
}

51 
	$ev’t_šput
(
Æ_msg
 *
msg
, *
¬g
)

53 ià(
	`Æ_msg_·r£
(
msg
, &
obj_šput
, 
NULL
) < 0)

54 
	`årštf
(
¡d”r
, "<<EVENT>> Unknown messageype\n");

57  
NL_STOP
;

58 
	}
}

60 
	$maš
(
¬gc
, *
¬gv
[])

62 
Æ_sock
 *
¹_sock
;

63 
Æ_ÿche
 *
lšk_ÿche
;

64 
nâl_queue
 *
queue
;

65 
nâl_queue_cİy_mode
 
cİy_mode
;

66 
ušt32_t
 
cİy_¿nge
;

67 
”r
 = 1;

68 
çmy
;

70 
nf_sock
 = 
	`nâl_queue_sock‘_®loc
();

71 ià(
nf_sock
 =ğ
NULL
)

72 
	`Æ_şi_çl
(
ENOBUFS
, "Unableo‡llocate‚etlink socket");

74 
	`Æ_sock‘_di§bË_£q_check
(
nf_sock
);

75 
	`Æ_sock‘_modify_cb
(
nf_sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ev’t_šput
, 
NULL
);

77 ià((
¬gc
 > 1 && !
	`¡rÿ£cmp
(
¬gv
[1], "-h")) ||‡rgc < 3) {

78 
	`´štf
("Usage:‚f-queue family group [ copy_mode ] "

80 
	`´štf
("family: [ inet | inet6 | ... ] \n");

81 
	`´štf
("group:he --queue-num‡rghat you gaveo iptables\n");

82 
	`´štf
("copy_mode: [‚one | meta |…acket ] \n");

86 
	`Æ_şi_cÚÃù
(
nf_sock
, 
NETLINK_NETFILTER
);

88 ià((
çmy
 = 
	`Æ_¡r2af
(
¬gv
[1])è=ğ
AF_UNSPEC
)

89 
	`Æ_şi_çl
(
NLE_INVAL
, "UnknowÀçmy \"%s\"", 
¬gv
[1]);

91 
	`nâl_queue_pf_unbšd
(
nf_sock
, 
çmy
);

92 ià((
”r
 = 
	`nâl_queue_pf_bšd
(
nf_sock
, 
çmy
)) < 0)

93 
	`Æ_şi_çl
(
”r
, "Unableo bind†ogger: %s",

94 
	`Æ_g‘”rÜ
(
”r
));

96 
queue
 = 
	`®loc_queue
();

97 
	`nâl_queue_£t_group
(
queue
, 
	`©oi
(
¬gv
[2]));

99 
cİy_mode
 = 
NFNL_QUEUE_COPY_PACKET
;

100 ià(
¬gc
 > 3) {

101 
cİy_mode
 = 
	`nâl_queue_¡r2cİy_mode
(
¬gv
[3]);

102 ià(
cİy_mode
 < 0)

103 
	`Æ_şi_çl
(
cİy_mode
,

105 
¬gv
[3], 
	`Æ_g‘”rÜ
(
cİy_mode
));

107 
	`nâl_queue_£t_cİy_mode
(
queue
, 
cİy_mode
);

109 
cİy_¿nge
 = 0xFFFF;

110 ià(
¬gc
 > 4)

111 
cİy_¿nge
 = 
	`©oi
(
¬gv
[4]);

112 
	`nâl_queue_£t_cİy_¿nge
(
queue
, 
cİy_¿nge
);

114 ià((
”r
 = 
	`nâl_queue_ü—‹
(
nf_sock
, 
queue
)) < 0)

115 
	`Æ_şi_çl
(
”r
, "UÇbËØbšd queue: %s", 
	`Æ_g‘”rÜ
(err));

117 
¹_sock
 = 
	`Æ_şi_®loc_sock‘
();

118 
	`Æ_şi_cÚÃù
(
¹_sock
, 
NETLINK_ROUTE
);

119 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
¹_sock
);

121 
	`Æ_sock‘_£t_bufãr_size
(
nf_sock
, 1024*127, 1024*127);

124 
fd_£t
 
rfds
;

125 
nffd
, 
¹fd
, 
maxfd
, 
»tv®
;

127 
	`FD_ZERO
(&
rfds
);

129 
maxfd
 = 
nffd
 = 
	`Æ_sock‘_g‘_fd
(
nf_sock
);

130 
	`FD_SET
(
nffd
, &
rfds
);

132 
¹fd
 = 
	`Æ_sock‘_g‘_fd
(
¹_sock
);

133 
	`FD_SET
(
¹fd
, &
rfds
);

134 ià(
maxfd
 < 
¹fd
)

135 
maxfd
 = 
¹fd
;

138 
»tv®
 = 
	`£Ëù
(
maxfd
+1, &
rfds
, 
NULL
, NULL, NULL);

140 ià(
»tv®
) {

141 ià(
	`FD_ISSET
(
nffd
, &
rfds
))

142 
	`Æ_»cvmsgs_deçuÉ
(
nf_sock
);

143 ià(
	`FD_ISSET
(
¹fd
, &
rfds
))

144 
	`Æ_»cvmsgs_deçuÉ
(
¹_sock
);

149 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-addr-add.c

11 
	~<Ãšk/şi/uts.h
>

12 
	~<Ãšk/şi/addr.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	gqu›t
 = 0;

17 
	$´št_u§ge
()

19 
	`´štf
(

40 
	`ex™
(0);

41 
	}
}

43 
	$maš
(
¬gc
, *
¬gv
[])

45 
Æ_sock
 *
sock
;

46 
¹Æ_addr
 *
addr
;

47 
Æ_ÿche
 *
lšk_ÿche
;

48 
Æ_dump_·¿ms
 
dp
 = {

49 .
dp_ty³
 = 
NL_DUMP_LINE
,

50 .
dp_fd
 = 
¡dout
,

52 
”r
, 
Ææags
 = 
NLM_F_CREATE
;

54 
sock
 = 
	`Æ_şi_®loc_sock‘
();

55 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

56 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

57 
addr
 = 
	`Æ_şi_addr_®loc
();

60 
c
, 
İtidx
 = 0;

62 
ARG_FAMILY
 = 257,

63 
ARG_LABEL
 = 258,

64 
ARG_PEER
,

65 
ARG_SCOPE
,

66 
ARG_BROADCAST
,

67 
ARG_REPLACE
,

68 
ARG_PREFERRED
,

69 
ARG_VALID
,

71 
İtiÚ
 
lÚg_İts
[] = {

72 { "»¶aû", 0, 0, 
ARG_REPLACE
 },

78 { "çmy", 1, 0, 
ARG_FAMILY
 },

79 { "Ïb–", 1, 0, 
ARG_LABEL
 },

80 { "³”", 1, 0, 
ARG_PEER
 },

81 { "scİe", 1, 0, 
ARG_SCOPE
 },

82 { "brßdÿ¡", 1, 0, 
ARG_BROADCAST
 },

83 { "´eã¼ed", 1, 0, 
ARG_PREFERRED
 },

84 { "v®id", 1, 0, 
ARG_VALID
 },

88 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhva:d:", 
lÚg_İts
, &
İtidx
);

89 ià(
c
 == -1)

92 
c
) {

93 '?': 
	`ex™
(
NLE_INVAL
);

94 
ARG_REPLACE
: 
Ææags
 |ğ
NLM_F_REPLACE
; ;

95 'q': 
qu›t
 = 1; ;

96 'h': 
	`´št_u§ge
(); ;

97 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

98 'a': 
	`Æ_şi_addr_·r£_loÿl
(
addr
, 
İrg
); ;

99 'd': 
	`Æ_şi_addr_·r£_dev
(
addr
, 
lšk_ÿche
, 
İrg
); ;

100 
ARG_FAMILY
: 
	`Æ_şi_addr_·r£_çmy
(
addr
, 
İrg
); ;

101 
ARG_LABEL
: 
	`Æ_şi_addr_·r£_Ïb–
(
addr
, 
İrg
); ;

102 
ARG_PEER
: 
	`Æ_şi_addr_·r£_³”
(
addr
, 
İrg
); ;

103 
ARG_SCOPE
: 
	`Æ_şi_addr_·r£_scİe
(
addr
, 
İrg
); ;

104 
ARG_BROADCAST
: 
	`Æ_şi_addr_·r£_brßdÿ¡
(
addr
, 
İrg
); ;

105 
ARG_PREFERRED
: 
	`Æ_şi_addr_·r£_´eã¼ed
(
addr
, 
İrg
); ;

106 
ARG_VALID
: 
	`Æ_şi_addr_·r£_v®id
(
addr
, 
İrg
); ;

110 ià((
”r
 = 
	`¹Æ_addr_add
(
sock
, 
addr
, 
Ææags
)) < 0)

111 
	`Æ_şi_çl
(
”r
, "Unableo‡dd‡ddress: %s",

112 
	`Æ_g‘”rÜ
(
”r
));

114 ià(!
qu›t
) {

115 
	`´štf
("Added ");

116 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
addr
), &
dp
);

120 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-addr-delete.c

11 
	~<Ãšk/şi/uts.h
>

12 
	~<Ãšk/şi/addr.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
Æ_sock
 *
	gsock
;

16 
	gš‹¿ùive
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gqu›t
 = 0;

17 
	gd–‘ed
 = 0;

19 
	$´št_u§ge
()

21 
	`´štf
(

44 
	`ex™
(0);

45 
	}
}

47 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

49 
¹Æ_addr
 *
addr
 = 
	`Æ_objeù_´iv
(
obj
);

50 
Æ_dump_·¿ms
 
·¿ms
 = {

51 .
dp_ty³
 = 
NL_DUMP_LINE
,

52 .
dp_fd
 = 
¡dout
,

54 
”r
;

56 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

59 ià((
”r
 = 
	`¹Æ_addr_d–‘e
(
sock
, 
addr
, 0)) < 0)

60 
	`Æ_şi_çl
(
”r
, "Unableo delete‡ddress: %s\n",

61 
	`Æ_g‘”rÜ
(
”r
));

63 ià(!
qu›t
) {

64 
	`´štf
("Deleted ");

65 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

68 
d–‘ed
++;

69 
	}
}

71 
	$maš
(
¬gc
, *
¬gv
[])

73 
¹Æ_addr
 *
addr
;

74 
Æ_ÿche
 *
lšk_ÿche
, *
addr_ÿche
;

76 
sock
 = 
	`Æ_şi_®loc_sock‘
();

77 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

78 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

79 
addr_ÿche
 = 
	`Æ_şi_addr_®loc_ÿche
(
sock
);

80 
addr
 = 
	`Æ_şi_addr_®loc
();

83 
c
, 
İtidx
 = 0;

85 
ARG_FAMILY
 = 257,

86 
ARG_LABEL
 = 258,

87 
ARG_YES
,

88 
ARG_PEER
,

89 
ARG_SCOPE
,

90 
ARG_BROADCAST
,

91 
ARG_PREFERRED
,

92 
ARG_VALID
,

94 
İtiÚ
 
lÚg_İts
[] = {

96 { "yes", 0, 0, 
ARG_YES
 },

102 { "çmy", 1, 0, 
ARG_FAMILY
 },

103 { "Ïb–", 1, 0, 
ARG_LABEL
 },

104 { "³”", 1, 0, 
ARG_PEER
 },

105 { "scİe", 1, 0, 
ARG_SCOPE
 },

106 { "brßdÿ¡", 1, 0, 
ARG_BROADCAST
 },

107 { "´eã¼ed", 1, 0, 
ARG_PREFERRED
 },

108 { "v®id", 1, 0, 
ARG_VALID
 },

112 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "iqhva:d:", 
lÚg_İts
, &
İtidx
);

113 ià(
c
 == -1)

116 
c
) {

117 'i': 
š‹¿ùive
 = 1; ;

118 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

119 'q': 
qu›t
 = 1; ;

120 'h': 
	`´št_u§ge
(); ;

121 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

122 'a': 
	`Æ_şi_addr_·r£_loÿl
(
addr
, 
İrg
); ;

123 'd': 
	`Æ_şi_addr_·r£_dev
(
addr
, 
lšk_ÿche
, 
İrg
); ;

124 
ARG_FAMILY
: 
	`Æ_şi_addr_·r£_çmy
(
addr
, 
İrg
); ;

125 
ARG_LABEL
: 
	`Æ_şi_addr_·r£_Ïb–
(
addr
, 
İrg
); ;

126 
ARG_PEER
: 
	`Æ_şi_addr_·r£_³”
(
addr
, 
İrg
); ;

127 
ARG_SCOPE
: 
	`Æ_şi_addr_·r£_scİe
(
addr
, 
İrg
); ;

128 
ARG_BROADCAST
: 
	`Æ_şi_addr_·r£_brßdÿ¡
(
addr
, 
İrg
); ;

129 
ARG_PREFERRED
: 
	`Æ_şi_addr_·r£_´eã¼ed
(
addr
, 
İrg
); ;

130 
ARG_VALID
: 
	`Æ_şi_addr_·r£_v®id
(
addr
, 
İrg
); ;

134 
	`Æ_ÿche_fÜ—ch_f‹r
(
addr_ÿche
, 
	`OBJ_CAST
(
addr
), 
d–‘e_cb
, 
NULL
);

136 ià(!
qu›t
)

137 
	`´štf
("D–‘ed %d‡dd»s£s\n", 
d–‘ed
);

140 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-addr-list.c

11 
	~<Ãšk/şi/uts.h
>

12 
	~<Ãšk/şi/addr.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

39 
	`ex™
(0);

40 
	}
}

42 *
	g´efix
;

44 
	$´št_´efix
(
Æ_dump_·¿ms
 *
p
, 
lše
)

46 ià(
´efix
)

47 
	`Æ_dump
(
p
, "%s", 
´efix
);

48 
	}
}

50 
	$’v_dump
(
Æ_objeù
 *
obj
, *
¬g
)

52 
Æ_dump_·¿ms
 *
p
 = 
¬g
;

53 
¹Æ_addr
 *
addr
 = (¹Æ_add¸*è
obj
;

54 
Æ_ÿche
 *
lšk_ÿche
;

55 
Æ_addr
 *
a
;

56 
šdex
 = 0;

57 
buf
[128], 
pfx
[32], *
s
;

59 
	`¢´štf
(
pfx
, Õfx), "ADDR%d", 
šdex
++);

61 
	`Æ_dump_lše
(
p
, "%s_FAMILY=%s\n", 
pfx
,

62 
	`Æ_af2¡r
(
	`¹Æ_addr_g‘_çmy
(
addr
), 
buf
, (buf)));

64 
	`Æ_dump_lše
(
p
, "%s_LOCAL=%s\n", 
pfx
,

65 
	`Æ_addr2¡r
(
	`¹Æ_addr_g‘_loÿl
(
addr
), 
buf
, (buf)));

67 
	`Æ_dump_lše
(
p
, "%s_IFINDEX=%u\n", 
pfx
, 
	`¹Æ_addr_g‘_ifšdex
(
addr
));

68 
lšk_ÿche
 = 
	`Æ_ÿche_mngt_»quœe_§ã
("route/link");

69 ià(
lšk_ÿche
)

70 
	`Æ_dump_lše
(
p
, "%s_IFNAME=%s\n", 
pfx
,

71 
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
,

72 
	`¹Æ_addr_g‘_ifšdex
(
addr
),

73 
buf
, (buf)));

75 ià((
a
 = 
	`¹Æ_addr_g‘_³”
(
addr
)))

76 
	`Æ_dump_lše
(
p
, "%s_PEER=%s\n", 
pfx
,

77 
	`Æ_addr2¡r
(
a
, 
buf
, (buf)));

79 ià((
a
 = 
	`¹Æ_addr_g‘_brßdÿ¡
(
addr
)))

80 
	`Æ_dump_lše
(
p
, "%s_BROADCAST=%s\n", 
pfx
,

81 
	`Æ_addr2¡r
(
a
, 
buf
, (buf)));

83 
	`Æ_dump_lše
(
p
, "%s_SCOPE=%s\n", 
pfx
,

84 
	`¹Æ_scİe2¡r
(
	`¹Æ_addr_g‘_scİe
(
addr
),

85 
buf
, (buf)));

87 ià((
s
 = 
	`¹Æ_addr_g‘_Ïb–
(
addr
)))

88 
	`Æ_dump_lše
(
p
, "%s_LABEL=%s\n", 
pfx
, 
s
);

90 
	`¹Æ_addr_æags2¡r
(
	`¹Æ_addr_g‘_æags
(
addr
), 
buf
, (buf));

91 ià(
buf
[0])

92 
	`Æ_dump_lše
(
p
, "%s_FLAGS=%s\n", 
pfx
, 
buf
);

94 
	`Æ_dump_lše
(
p
, "%s_CACHEINFO_VALID=%u\n", 
pfx
,

95 
	`¹Æ_addr_g‘_v®id_liãtime
(
addr
));

97 ià(
lšk_ÿche
)

98 
	`Æ_ÿche_put
(
lšk_ÿche
);

101 ià(
addr
->
û_mask
 & 
ADDR_ATTR_CACHEINFO
) {

102 
¹Æ_addr_ÿchešfo
 *
ci
 = &
addr
->
a_ÿchešfo
;

104 
	`Æ_dump_lše
(
p
, "ADDR_CACHEINFO_PREFERRED=%u\n",

105 
ci
->
aci_´eã»d
);

107 
	`Æ_dump_lše
(
p
, "ADDR_CACHEINFO_CREATED=%u\n", 
ci
->
aci_c¡amp
);

108 
	`Æ_dump_lše
(
p
, "ADDR_CACHEINFO_LASTUPDATE=%u\n",

109 
ci
->
aci_t¡amp
);

112 
	}
}

114 
	$maš
(
¬gc
, *
¬gv
[])

116 
Æ_sock
 *
sock
;

117 
¹Æ_addr
 *
addr
;

118 
Æ_ÿche
 *
lšk_ÿche
, *
addr_ÿche
;

119 
Æ_dump_·¿ms
 
·¿ms
 = {

120 .
dp_ty³
 = 
NL_DUMP_LINE
,

121 .
dp_Æ_cb
 = 
´št_´efix
,

122 .
dp_fd
 = 
¡dout
,

124 
dump_’v
 = 0;

126 
sock
 = 
	`Æ_şi_®loc_sock‘
();

127 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

128 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

129 
addr_ÿche
 = 
	`Æ_şi_addr_®loc_ÿche
(
sock
);

130 
addr
 = 
	`Æ_şi_addr_®loc
();

133 
c
, 
İtidx
 = 0;

135 
ARG_FAMILY
 = 257,

136 
ARG_LABEL
 = 258,

137 
ARG_PEER
,

138 
ARG_SCOPE
,

139 
ARG_BROADCAST
,

140 
ARG_DETAILS
,

141 
ARG_ENV
,

142 
ARG_PREFIX
,

143 
ARG_PREFERRED
,

144 
ARG_VALID
,

146 
İtiÚ
 
lÚg_İts
[] = {

147 { "d‘as", 0, 0, 
ARG_DETAILS
 },

148 { "’v", 0, 0, 
ARG_ENV
 },

149 { "´efix", 1, 0, 
ARG_PREFIX
 },

154 { "çmy", 1, 0, 
ARG_FAMILY
 },

155 { "Ïb–", 1, 0, 
ARG_LABEL
 },

156 { "³”", 1, 0, 
ARG_PEER
 },

157 { "scİe", 1, 0, 
ARG_SCOPE
 },

158 { "brßdÿ¡", 1, 0, 
ARG_BROADCAST
 },

159 { "´eã¼ed", 1, 0, 
ARG_PREFERRED
 },

160 { "v®id", 1, 0, 
ARG_VALID
 },

164 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "46hva:d:", 
lÚg_İts
, &
İtidx
);

165 ià(
c
 == -1)

168 
c
) {

169 '?': 
	`ex™
(
NLE_INVAL
);

170 '4': 
	`¹Æ_addr_£t_çmy
(
addr
, 
AF_INET
); ;

171 '6': 
	`¹Æ_addr_£t_çmy
(
addr
, 
AF_INET6
); ;

172 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

173 
ARG_ENV
: 
dump_’v
 = 1; ;

174 
ARG_PREFIX
: 
´efix
 = 
	`¡rdup
(
İrg
); ;

175 'h': 
	`´št_u§ge
(); ;

176 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

177 'a': 
	`Æ_şi_addr_·r£_loÿl
(
addr
, 
İrg
); ;

178 'd': 
	`Æ_şi_addr_·r£_dev
(
addr
, 
lšk_ÿche
, 
İrg
); ;

179 
ARG_FAMILY
: 
	`Æ_şi_addr_·r£_çmy
(
addr
, 
İrg
); ;

180 
ARG_LABEL
: 
	`Æ_şi_addr_·r£_Ïb–
(
addr
, 
İrg
); ;

181 
ARG_PEER
: 
	`Æ_şi_addr_·r£_³”
(
addr
, 
İrg
); ;

182 
ARG_SCOPE
: 
	`Æ_şi_addr_·r£_scİe
(
addr
, 
İrg
); ;

183 
ARG_BROADCAST
: 
	`Æ_şi_addr_·r£_brßdÿ¡
(
addr
, 
İrg
); ;

184 
ARG_PREFERRED
: 
	`Æ_şi_addr_·r£_´eã¼ed
(
addr
, 
İrg
); ;

185 
ARG_VALID
: 
	`Æ_şi_addr_·r£_v®id
(
addr
, 
İrg
); ;

189 ià(
dump_’v
)

190 
	`Æ_ÿche_fÜ—ch_f‹r
(
addr_ÿche
, 
	`OBJ_CAST
(
addr
), 
’v_dump
,

191 &
·¿ms
);

193 
	`Æ_ÿche_dump_f‹r
(
addr_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
addr
));

196 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-class-add.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/qdisc.h
>

15 
	~<Ãšk/şi/şass.h
>

16 
	~<Ãšk/şi/lšk.h
>

18 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

20 
	gqu›t
 = 0;

22 
	$´št_u§ge
()

24 
	`´štf
(

48 
	`ex™
(0);

49 
	}
}

51 
	$maš
(
¬gc
, *
¬gv
[])

53 
Æ_sock
 *
sock
;

54 
¹Æ_şass
 *
şass
;

55 
¹Æ_tc
 *
tc
;

56 
Æ_ÿche
 *
lšk_ÿche
;

57 
Æ_dump_·¿ms
 
dp
 = {

58 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

59 .
dp_fd
 = 
¡dout
,

61 
Æ_şi_tc_moduË
 *
tm
;

62 
¹Æ_tc_İs
 *
İs
;

63 
”r
, 
æags
 = 
NLM_F_CREATE
 | 
NLM_F_EXCL
;

64 *
kšd
, *
id
 = 
NULL
;

66 
sock
 = 
	`Æ_şi_®loc_sock‘
();

67 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

69 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

71 
şass
 = 
	`Æ_şi_şass_®loc
();

72 
tc
 = (
¹Æ_tc
 *è
şass
;

75 
c
, 
İtidx
 = 0;

77 
ARG_UPDATE
 = 257,

78 
ARG_UPDATE_ONLY
 = 258,

79 
ARG_MTU
,

80 
ARG_MPU
,

81 
ARG_OVERHEAD
,

82 
ARG_LINKTYPE
,

84 
İtiÚ
 
lÚg_İts
[] = {

91 { "upd©e", 0, 0, 
ARG_UPDATE
 },

92 { "upd©e-Úly", 0, 0, 
ARG_UPDATE_ONLY
 },

93 { "mtu", 1, 0, 
ARG_MTU
 },

94 { "mpu", 1, 0, 
ARG_MPU
 },

95 { "ov”h—d", 1, 0, 
ARG_OVERHEAD
 },

96 { "lškty³", 1, 0, 
ARG_LINKTYPE
 },

100 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "+qhvd:p:i:",

101 
lÚg_İts
, &
İtidx
);

102 ià(
c
 == -1)

105 
c
) {

106 'q': 
qu›t
 = 1; ;

107 'h': 
	`´št_u§ge
(); ;

108 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

109 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

110 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

111 'i': 
id
 = 
	`¡rdup
(
İrg
); ;

112 
ARG_UPDATE
: 
æags
 = 
NLM_F_CREATE
; ;

113 
ARG_UPDATE_ONLY
: 
æags
 = 0; ;

114 
ARG_MTU
: 
	`Æ_şi_tc_·r£_mtu
(
tc
, 
İrg
); ;

115 
ARG_MPU
: 
	`Æ_şi_tc_·r£_mpu
(
tc
, 
İrg
); ;

116 
ARG_OVERHEAD
: 
	`Æ_şi_tc_·r£_ov”h—d
(
tc
, 
İrg
); ;

117 
ARG_LINKTYPE
: 
	`Æ_şi_tc_·r£_lškty³
(
tc
, 
İrg
); ;

121 ià(
İtšd
 >ğ
¬gc
)

122 
	`´št_u§ge
();

124 ià(!
	`¹Æ_tc_g‘_ifšdex
(
tc
))

125 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡‚etwork device (--dev=XXX)");

127 ià(!
	`¹Æ_tc_g‘_·»Á
(
tc
))

128 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡…arent (--parent=XXX)");

130 ià(
id
) {

131 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
id
, 1);

132 
	`ä“
(
id
);

135 
kšd
 = 
¬gv
[
İtšd
++];

136 
	`¹Æ_tc_£t_kšd
(
tc
, 
kšd
);

138 ià(!(
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
)))

139 
	`Æ_şi_çl
(
ENOENT
, "UnknowÀşas \"%s\"", 
kšd
);

141 ià(!(
tm
 = 
	`Æ_şi_tc_lookup
(
İs
)))

142 
	`Æ_şi_çl
(
ENOTSUP
, "şas ty³ \"%s\"‚Ù suµÜ‹d.", 
kšd
);

144 
tm
->
	`tm_·r£_¬gv
(
tc
, 
¬gc
, 
¬gv
);

146 ià(!
qu›t
) {

147 
	`´štf
("Adding ");

148 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
şass
), &
dp
);

151 ià((
”r
 = 
	`¹Æ_şass_add
(
sock
, 
şass
, 
æags
)) < 0)

152 
	`Æ_şi_çl
(
EINVAL
, "UÇbËØadd cÏss: %s", 
	`Æ_g‘”rÜ
(
”r
));

155 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-class-delete.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/şass.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gqu›t
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gd–‘ed
 = 0, 
	gš‹¿ùive
 = 0;

17 
Æ_sock
 *
	gsock
;

19 
	$´št_u§ge
()

21 
	`´štf
(

42 
	`ex™
(0);

43 
	}
}

45 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

47 
¹Æ_şass
 *
şass
 = 
	`Æ_objeù_´iv
(
obj
);

48 
Æ_dump_·¿ms
 
·¿ms
 = {

49 .
dp_ty³
 = 
NL_DUMP_LINE
,

50 .
dp_fd
 = 
¡dout
,

52 
”r
;

54 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

57 ià((
”r
 = 
	`¹Æ_şass_d–‘e
(
sock
, 
şass
)) < 0)

58 
	`Æ_şi_çl
(
”r
, "UÇbËØd–‘şass: %s\n", 
	`Æ_g‘”rÜ
(err));

60 ià(!
qu›t
) {

61 
	`´štf
("Deleted ");

62 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

65 
d–‘ed
++;

66 
	}
}

68 
	$maš
(
¬gc
, *
¬gv
[])

70 
¹Æ_şass
 *
şass
;

71 
¹Æ_tc
 *
tc
;

72 
Æ_ÿche
 *
lšk_ÿche
, *
şass_ÿche
;

74 
sock
 = 
	`Æ_şi_®loc_sock‘
();

75 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

76 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

77 
şass
 = 
	`Æ_şi_şass_®loc
();

78 
tc
 = (
¹Æ_tc
 *è
şass
;

81 
c
, 
İtidx
 = 0;

83 
ARG_YES
 = 257,

84 
ARG_INTERACTIVE
 = 258,

86 
İtiÚ
 
lÚg_İts
[] = {

87 { "š‹¿ùive", 0, 0, 
ARG_INTERACTIVE
 },

88 { "yes", 0, 0, 
ARG_YES
 },

99 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

100 ià(
c
 == -1)

103 
c
) {

104 '?': 
	`Æ_şi_çl
(
EINVAL
, "Invalid options");

105 
ARG_INTERACTIVE
: 
š‹¿ùive
 = 1; ;

106 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

107 'q': 
qu›t
 = 1; ;

108 'h': 
	`´št_u§ge
(); ;

109 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

110 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

111 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

112 'i': 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0); ;

113 'k': 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
); ;

117 ià(!
	`¹Æ_tc_g‘_ifšdex
(
tc
))

118 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡‚etwork device (--dev=XXX)");

120 
şass_ÿche
 = 
	`Æ_şi_şass_®loc_ÿche
(
sock
, 
	`¹Æ_tc_g‘_ifšdex
(
tc
));

122 
	`Æ_ÿche_fÜ—ch_f‹r
(
şass_ÿche
, 
	`OBJ_CAST
(
şass
), 
d–‘e_cb
, 
NULL
);

124 ià(!
qu›t
)

125 
	`´štf
("D–‘ed %d cÏsss\n", 
d–‘ed
);

128 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-class-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/şass.h
>

15 
	~<Ãšk/şi/lšk.h
>

17 
Æ_sock
 *
	gsock
;

19 
Æ_dump_·¿ms
 
	g·¿ms
 = {

20 .
dp_ty³
 = 
NL_DUMP_LINE
,

23 
	$´št_u§ge
()

25 
	`´štf
(

44 
	`ex™
(0);

45 
	}
}

47 
	$__dump_şass
(
ifšdex
, 
¹Æ_şass
 *
f‹r
)

49 
Æ_ÿche
 *
ÿche
;

51 
ÿche
 = 
	`Æ_şi_şass_®loc_ÿche
(
sock
, 
ifšdex
);

52 
	`Æ_ÿche_dump_f‹r
(
ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
f‹r
));

53 
	}
}

55 
	$dump_şass
(
Æ_objeù
 *
obj
, *
¬g
)

57 
¹Æ_lšk
 *
lšk
 = 
	`Æ_objeù_´iv
(
obj
);

59 
	`__dump_şass
(
	`¹Æ_lšk_g‘_ifšdex
(
lšk
), 
¬g
);

60 
	}
}

62 
	$maš
(
¬gc
, *
¬gv
[])

64 
¹Æ_şass
 *
şass
;

65 
¹Æ_tc
 *
tc
;

66 
Æ_ÿche
 *
lšk_ÿche
;

67 
ifšdex
;

69 
sock
 = 
	`Æ_şi_®loc_sock‘
();

70 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

71 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

72 
şass
 = 
	`Æ_şi_şass_®loc
();

73 
tc
 = (
¹Æ_tc
 *è
şass
;

75 
·¿ms
.
dp_fd
 = 
¡dout
;

78 
c
, 
İtidx
 = 0;

80 
ARG_DETAILS
 = 257,

81 
ARG_STATS
 = 258,

83 
İtiÚ
 
lÚg_İts
[] = {

84 { "d‘as", 0, 0, 
ARG_DETAILS
 },

85 { "¡©s", 0, 0, 
ARG_STATS
 },

95 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

96 ià(
c
 == -1)

99 
c
) {

100 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

101 
ARG_STATS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_STATS
; ;

102 'h': 
	`´št_u§ge
(); ;

103 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

104 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

105 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

106 'i': 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0); ;

107 'k': 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
); ;

111 ià((
ifšdex
 = 
	`¹Æ_tc_g‘_ifšdex
(
tc
)))

112 
	`__dump_şass
(
ifšdex
, 
şass
);

114 
	`Æ_ÿche_fÜ—ch
(
lšk_ÿche
, 
dump_şass
, 
şass
);

117 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-classid-lookup.c

12 
	~<Ãšk/şi/uts.h
>

14 
	$´št_u§ge
()

16 
	`´štf
(

30 
	`ex™
(0);

31 
	}
}

33 
	$maš
(
¬gc
, *
¬gv
[])

35 
ušt32_t
 
şassid
;

36 *
Çme
;

37 
”r
, 
»v”£
 = 0, 
¿w
 = 0;

40 
c
, 
İtidx
 = 0;

42 
ARG_RAW
 = 257,

44 
İtiÚ
 
lÚg_İts
[] = {

48 { "¿w", 0, 0, 
ARG_RAW
 },

52 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hvr", 
lÚg_İts
, &
İtidx
);

53 ià(
c
 == -1)

56 
c
) {

57 'h': 
	`´št_u§ge
(); ;

58 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

59 'r': 
»v”£
 = 1; ;

60 
ARG_RAW
: 
¿w
 = 1; ;

64 ià(
İtšd
 >ğ
¬gc
)

65 
	`´št_u§ge
();

67 
Çme
 = 
¬gv
[
İtšd
++];

74 ià((
”r
 = 
	`¹Æ_tc_¡r2hªdË
(
Çme
, &
şassid
)) < 0)

75 
	`Æ_şi_çl
(
”r
, "Unableo†ookup classid \"%s\": %s",

76 
Çme
, 
	`Æ_g‘”rÜ
(
”r
));

78 ià(
»v”£
) {

79 
buf
[64];

80 
	`´štf
("%s\n", 
	`¹Æ_tc_hªdË2¡r
(
şassid
, 
buf
, (buf)));

81 } ià(
¿w
)

82 
	`´štf
("%#x\n", 
şassid
);

84 
	`´štf
("%x:%x\n", 
	`TC_H_MAJ
(
şassid
è>> 16, 
	`TC_H_MIN
(classid));

87 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-cls-add.c

11 
	~<Ãšk/şi/uts.h
>

12 
	~<Ãšk/şi/tc.h
>

13 
	~<Ãšk/şi/şs.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

18 
	gqu›t
 = 0;

20 
	$´št_u§ge
()

22 
	`´štf
(

48 
	`ex™
(0);

49 
	}
}

51 
	$maš
(
¬gc
, *
¬gv
[])

53 
Æ_sock
 *
sock
;

54 
¹Æ_şs
 *
şs
;

55 
¹Æ_tc
 *
tc
;

56 
Æ_ÿche
 *
lšk_ÿche
;

57 
Æ_dump_·¿ms
 
dp
 = {

58 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

59 .
dp_fd
 = 
¡dout
,

61 
Æ_şi_tc_moduË
 *
tm
;

62 
¹Æ_tc_İs
 *
İs
;

63 
”r
, 
æags
 = 
NLM_F_CREATE
 | 
NLM_F_EXCL
;

64 *
kšd
, *
id
 = 
NULL
;

66 
sock
 = 
	`Æ_şi_®loc_sock‘
();

67 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

69 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

71 
şs
 = 
	`Æ_şi_şs_®loc
();

72 
tc
 = (
¹Æ_tc
 *è
şs
;

75 
c
, 
İtidx
 = 0;

77 
ARG_UPDATE
 = 257,

78 
ARG_UPDATE_ONLY
 = 258,

79 
ARG_MTU
,

80 
ARG_MPU
,

81 
ARG_OVERHEAD
,

82 
ARG_LINKTYPE
,

83 
ARG_PROTO
,

84 
ARG_PRIO
,

86 
İtiÚ
 
lÚg_İts
[] = {

93 { "´Ùo", 1, 0, 
ARG_PROTO
 },

94 { "´io", 1, 0, 
ARG_PRIO
 },

95 { "upd©e", 0, 0, 
ARG_UPDATE
 },

96 { "upd©e-Úly", 0, 0, 
ARG_UPDATE_ONLY
 },

97 { "mtu", 1, 0, 
ARG_MTU
 },

98 { "mpu", 1, 0, 
ARG_MPU
 },

99 { "ov”h—d", 1, 0, 
ARG_OVERHEAD
 },

100 { "lškty³", 1, 0, 
ARG_LINKTYPE
 },

104 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "+qhvd:p:i:",

105 
lÚg_İts
, &
İtidx
);

106 ià(
c
 == -1)

109 
c
) {

110 'q': 
qu›t
 = 1; ;

111 'h': 
	`´št_u§ge
(); ;

112 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

113 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

114 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

115 'i': 
id
 = 
	`¡rdup
(
İrg
); ;

116 
ARG_UPDATE
: 
æags
 = 
NLM_F_CREATE
; ;

117 
ARG_UPDATE_ONLY
: 
æags
 = 0; ;

118 
ARG_MTU
: 
	`Æ_şi_tc_·r£_mtu
(
tc
, 
İrg
); ;

119 
ARG_MPU
: 
	`Æ_şi_tc_·r£_mpu
(
tc
, 
İrg
); ;

120 
ARG_OVERHEAD
: 
	`Æ_şi_tc_·r£_ov”h—d
(
tc
, 
İrg
); ;

121 
ARG_LINKTYPE
: 
	`Æ_şi_tc_·r£_lškty³
(
tc
, 
İrg
); ;

122 
ARG_PROTO
: 
	`Æ_şi_şs_·r£_´Ùo
(
şs
, 
İrg
); ;

123 
ARG_PRIO
:

124 
	`¹Æ_şs_£t_´io
(
şs
, 
	`Æ_şi_·r£_u32
(
İrg
));

129 ià(
İtšd
 >ğ
¬gc
)

130 
	`´št_u§ge
();

132 ià(!
	`¹Æ_tc_g‘_ifšdex
(
tc
))

133 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡‚etwork device (--dev=XXX)");

135 ià(!
	`¹Æ_tc_g‘_·»Á
(
tc
))

136 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡…arent (--parent=XXX)");

138 ià(
id
) {

139 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
id
, 1);

140 
	`ä“
(
id
);

143 
kšd
 = 
¬gv
[
İtšd
++];

144 
	`¹Æ_tc_£t_kšd
(
tc
, 
kšd
);

146 ià(!(
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
)))

147 
	`Æ_şi_çl
(
ENOENT
, "UnknowÀşassif›¸\"%s\".", 
kšd
);

149 ià(!(
tm
 = 
	`Æ_şi_tc_lookup
(
İs
)))

150 
	`Æ_şi_çl
(
ENOTSUP
, "CÏssif›¸ty³ \"%s\"‚Ù suµÜ‹d.", 
kšd
);

152 
tm
->
	`tm_·r£_¬gv
(
tc
, 
¬gc
, 
¬gv
);

154 ià(!
qu›t
) {

155 
	`´štf
("Adding ");

156 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
şs
), &
dp
);

159 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
æags
)) < 0)

160 
	`Æ_şi_çl
(
EINVAL
, "UÇbËØadd cÏssif›r: %s", 
	`Æ_g‘”rÜ
(
”r
));

163 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-cls-delete.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/şs.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gqu›t
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gd–‘ed
 = 0, 
	gš‹¿ùive
 = 0;

17 
Æ_sock
 *
	gsock
;

19 
	$´št_u§ge
()

21 
	`´štf
(

44 
	`ex™
(0);

45 
	}
}

47 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

49 
¹Æ_şs
 *
şs
 = 
	`Æ_objeù_´iv
(
obj
);

50 
Æ_dump_·¿ms
 
·¿ms
 = {

51 .
dp_ty³
 = 
NL_DUMP_LINE
,

52 .
dp_fd
 = 
¡dout
,

54 
”r
;

56 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

59 ià((
”r
 = 
	`¹Æ_şs_d–‘e
(
sock
, 
şs
, 0)) < 0)

60 
	`Æ_şi_çl
(
”r
, "Unableo delete classifier: %s\n",

61 
	`Æ_g‘”rÜ
(
”r
));

63 ià(!
qu›t
) {

64 
	`´štf
("Deleted ");

65 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

68 
d–‘ed
++;

69 
	}
}

71 
	$__d–‘e_lšk
(
ifšdex
, 
¹Æ_şs
 *
f‹r
)

73 
Æ_ÿche
 *
ÿche
;

74 
ušt32_t
 
·»Á
 = 
	`¹Æ_tc_g‘_·»Á
((
¹Æ_tc
 *è
f‹r
);

76 
ÿche
 = 
	`Æ_şi_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
);

77 
	`Æ_ÿche_fÜ—ch_f‹r
(
ÿche
, 
	`OBJ_CAST
(
f‹r
), 
d–‘e_cb
, 
NULL
);

78 
	`Æ_ÿche_ä“
(
ÿche
);

79 
	}
}

81 
	$d–‘e_lšk
(
Æ_objeù
 *
obj
, *
¬g
)

83 
¹Æ_lšk
 *
lšk
 = 
	`Æ_objeù_´iv
(
obj
);

85 
	`__d–‘e_lšk
(
	`¹Æ_lšk_g‘_ifšdex
(
lšk
), 
¬g
);

86 
	}
}

88 
	$maš
(
¬gc
, *
¬gv
[])

90 
¹Æ_şs
 *
şs
;

91 
¹Æ_tc
 *
tc
;

92 
Æ_ÿche
 *
lšk_ÿche
;

93 
ifšdex
;

95 
sock
 = 
	`Æ_şi_®loc_sock‘
();

96 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

97 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

98 
şs
 = 
	`Æ_şi_şs_®loc
();

99 
tc
 = (
¹Æ_tc
 *è
şs
;

102 
c
, 
İtidx
 = 0;

104 
ARG_YES
 = 257,

105 
ARG_INTERACTIVE
 = 258,

106 
ARG_PROTO
,

107 
ARG_PRIO
,

109 
İtiÚ
 
lÚg_İts
[] = {

110 { "š‹¿ùive", 0, 0, 
ARG_INTERACTIVE
 },

111 { "yes", 0, 0, 
ARG_YES
 },

119 { "´Ùo", 1, 0, 
ARG_PROTO
 },

120 { "´io", 1, 0, 
ARG_PRIO
 },

124 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

125 ià(
c
 == -1)

128 
c
) {

129 '?': 
	`Æ_şi_çl
(
EINVAL
, "Invalid options");

130 
ARG_INTERACTIVE
: 
š‹¿ùive
 = 1; ;

131 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

132 'q': 
qu›t
 = 1; ;

133 'h': 
	`´št_u§ge
(); ;

134 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

135 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

136 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

137 'i': 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0); ;

138 'k': 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
); ;

139 
ARG_PROTO
: 
	`Æ_şi_şs_·r£_´Ùo
(
şs
, 
İrg
); ;

140 
ARG_PRIO
:

141 
	`¹Æ_şs_£t_´io
(
şs
, 
	`Æ_şi_·r£_u32
(
İrg
));

146 ià((
ifšdex
 = 
	`¹Æ_tc_g‘_ifšdex
(
tc
)))

147 
	`__d–‘e_lšk
(
ifšdex
, 
şs
);

149 
	`Æ_ÿche_fÜ—ch
(
lšk_ÿche
, 
d–‘e_lšk
, 
şs
);

151 ià(!
qu›t
)

152 
	`´štf
("D–‘ed %d cÏsss\n", 
d–‘ed
);

155 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-cls-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/şs.h
>

15 
	~<Ãšk/şi/lšk.h
>

17 
Æ_sock
 *
	gsock
;

19 
Æ_dump_·¿ms
 
	g·¿ms
 = {

20 .
dp_ty³
 = 
NL_DUMP_LINE
,

23 
	$´št_u§ge
()

25 
	`´štf
(

46 
	`ex™
(0);

47 
	}
}

49 
	$__dump_lšk
(
ifšdex
, 
¹Æ_şs
 *
f‹r
)

51 
Æ_ÿche
 *
ÿche
;

52 
ušt32_t
 
·»Á
 = 
	`¹Æ_tc_g‘_·»Á
((
¹Æ_tc
 *è
f‹r
);

54 
ÿche
 = 
	`Æ_şi_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
);

55 
	`Æ_ÿche_dump_f‹r
(
ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
f‹r
));

56 
	`Æ_ÿche_ä“
(
ÿche
);

57 
	}
}

59 
	$dump_lšk
(
Æ_objeù
 *
obj
, *
¬g
)

61 
¹Æ_lšk
 *
lšk
 = 
	`Æ_objeù_´iv
(
obj
);

63 
	`__dump_lšk
(
	`¹Æ_lšk_g‘_ifšdex
(
lšk
), 
¬g
);

64 
	}
}

66 
	$maš
(
¬gc
, *
¬gv
[])

68 
¹Æ_şs
 *
şs
;

69 
¹Æ_tc
 *
tc
;

70 
Æ_ÿche
 *
lšk_ÿche
;

71 
ifšdex
;

73 
sock
 = 
	`Æ_şi_®loc_sock‘
();

74 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

75 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

76 
şs
 = 
	`Æ_şi_şs_®loc
();

77 
tc
 = (
¹Æ_tc
 *è
şs
;

79 
·¿ms
.
dp_fd
 = 
¡dout
;

82 
c
, 
İtidx
 = 0;

84 
ARG_DETAILS
 = 257,

85 
ARG_STATS
 = 258,

86 
ARG_PROTO
,

87 
ARG_PRIO
,

89 
İtiÚ
 
lÚg_İts
[] = {

90 { "d‘as", 0, 0, 
ARG_DETAILS
 },

91 { "¡©s", 0, 0, 
ARG_STATS
 },

98 { "´Ùo", 1, 0, 
ARG_PROTO
 },

99 { "´io", 1, 0, 
ARG_PRIO
 },

103 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

104 ià(
c
 == -1)

107 
c
) {

108 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

109 
ARG_STATS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_STATS
; ;

110 'h': 
	`´št_u§ge
(); ;

111 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

112 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

113 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

114 'i': 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0); ;

115 'k': 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
); ;

116 
ARG_PROTO
: 
	`Æ_şi_şs_·r£_´Ùo
(
şs
, 
İrg
); ;

117 
ARG_PRIO
:

118 
	`¹Æ_şs_£t_´io
(
şs
, 
	`Æ_şi_·r£_u32
(
İrg
));

123 ià((
ifšdex
 = 
	`¹Æ_tc_g‘_ifšdex
(
tc
)))

124 
	`__dump_lšk
(
ifšdex
, 
şs
);

126 
	`Æ_ÿche_fÜ—ch
(
lšk_ÿche
, 
dump_lšk
, 
şs
);

129 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-fib-lookup.c

12 
	~<Ãšk/şi/uts.h
>

14 
	$´št_u§ge
()

16 
	`´štf
(

23 
	`ex™
(1);

24 
	}
}

26 
	$maš
(
¬gc
, *
¬gv
[])

28 
Æ_sock
 *
Æh
;

29 
Æ_ÿche
 *
»suÉ
;

30 
æÆ_»que¡
 *
»que¡
;

31 
Æ_addr
 *
addr
;

32 
Æ_dump_·¿ms
 
·¿ms
 = {

33 .
dp_fd
 = 
¡dout
,

34 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

36 
bË
 = 
RT_TABLE_UNSPEC
, 
scİe
 = 
RT_SCOPE_UNIVERSE
;

37 
tos
 = 0, 
”r
 = 1;

38 
ušt64_t
 
fwm¬k
 = 0;

41 
İtiÚ
 
lÚg_İts
[] = {

49 
c
, 
idx
 = 0;

51 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "t:f:s:T:h", 
lÚg_İts
, &
idx
);

52 ià(
c
 == -1)

55 
c
) {

57 
bË
 = 
	`¡¹oul
(
İrg
, 
NULL
, 0);

60 
fwm¬k
 = 
	`¡¹oul
(
İrg
, 
NULL
, 0);

63 
scİe
 = 
	`¡¹oul
(
İrg
, 
NULL
, 0);

66 
tos
 = 
	`¡¹oul
(
İrg
, 
NULL
, 0);

69 
	`´št_u§ge
();

73 ià(
İtšd
 >ğ
¬gc
)

74 
	`´št_u§ge
();

76 
Æh
 = 
	`Æ_şi_®loc_sock‘
();

78 ià((
”r
 = 
	`Æ_addr_·r£
(
¬gv
[
İtšd
], 
AF_INET
, &
addr
)) < 0)

79 
	`Æ_şi_çl
(
”r
, "Unableo…arse‡ddress \"%s\": %s\n",

80 
¬gv
[
İtšd
], 
	`Æ_g‘”rÜ
(
”r
));

82 
»suÉ
 = 
	`æÆ_»suÉ_®loc_ÿche
();

83 ià(!
»suÉ
)

84 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate cache");

86 
»que¡
 = 
	`æÆ_»que¡_®loc
();

87 ià(!
»que¡
)

88 
	`Æ_şi_çl
(
ENOMEM
, "Unableo‡llocate„equest");

90 
	`æÆ_»que¡_£t_bË
(
»que¡
, 
bË
);

91 
	`æÆ_»que¡_£t_fwm¬k
(
»que¡
, 
fwm¬k
);

92 
	`æÆ_»que¡_£t_scİe
(
»que¡
, 
scİe
);

93 
	`æÆ_»que¡_£t_tos
(
»que¡
, 
tos
);

95 
”r
 = 
	`æÆ_»que¡_£t_addr
(
»que¡
, 
addr
);

96 
	`Æ_addr_put
(
addr
);

97 ià(
”r
 < 0)

98 
	`Æ_şi_çl
(
”r
, "UÇbËØ£nd„eque¡: %s", 
	`Æ_g‘”rÜ
(err));

100 
	`Æ_şi_cÚÃù
(
Æh
, 
NETLINK_FIB_LOOKUP
);

102 
”r
 = 
	`æÆ_lookup
(
Æh
, 
»que¡
, 
»suÉ
);

103 ià(
”r
 < 0)

104 
	`Æ_şi_çl
(
”r
, "UÇbËØlookup: %s\n", 
	`Æ_g‘”rÜ
(err));

106 
	`Æ_ÿche_dump
(
»suÉ
, &
·¿ms
);

109 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-enslave.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

14 
	~<Ãšk/rou‹/lšk/bÚdšg.h
>

16 
	$maš
(
¬gc
, *
¬gv
[])

18 
Æ_sock
 *
sock
;

19 
Æ_ÿche
 *
lšk_ÿche
;

20 
¹Æ_lšk
 *
ma¡”
, *
¦ave
;

21 
”r
;

23 ià(
¬gc
 < 3) {

24 
	`årštf
(
¡d”r
, "Usage:‚l-link-enslave master slave\n");

28 
sock
 = 
	`Æ_şi_®loc_sock‘
();

29 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

30 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

32 ià(!(
ma¡”
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
¬gv
[1]))) {

33 
	`årštf
(
¡d”r
, "UnknowÀlšk: %s\n", 
¬gv
[1]);

37 ià(!(
¦ave
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
¬gv
[2]))) {

38 
	`årštf
(
¡d”r
, "UnknowÀlšk: %s\n", 
¬gv
[2]);

42 ià((
”r
 = 
	`¹Æ_lšk_bÚd_’¦ave
(
sock
, 
ma¡”
, 
¦ave
)) < 0) {

43 
	`årštf
(
¡d”r
, "Unableoƒnslave %so %s: %s\n",

44 
¬gv
[2],‡rgv[1], 
	`Æ_g‘”rÜ
(
”r
));

49 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-ifindex2name.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
("Usage:‚l-link-ifindex2name <ifindex>\n");

18 
	`ex™
(0);

19 
	}
}

21 
	$maš
(
¬gc
, *
¬gv
[])

23 
Æ_sock
 *
sock
;

24 
Æ_ÿche
 *
lšk_ÿche
;

25 
Çme
[
IFNAMSIZ
];

26 
ušt32_t
 
ifšdex
;

28 ià(
¬gc
 < 2)

29 
	`´št_u§ge
();

31 
sock
 = 
	`Æ_şi_®loc_sock‘
();

32 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

33 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

35 
ifšdex
 = 
	`Æ_şi_·r£_u32
(
¬gv
[1]);

37 ià(!
	`¹Æ_lšk_i2Çme
(
lšk_ÿche
, 
ifšdex
, 
Çme
, (name)))

38 
	`Æ_şi_çl
(
ENOENT
, "Interface index %d does‚otƒxist",

39 
ifšdex
);

41 
	`´štf
("%s\n", 
Çme
);

44 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

33 
	`ex™
(0);

34 
	}
}

36 
	$maš
(
¬gc
, *
¬gv
[])

38 
Æ_sock
 *
sock
;

39 
Æ_ÿche
 *
lšk_ÿche
;

40 
¹Æ_lšk
 *
lšk
;

41 
Æ_dump_·¿ms
 
·¿ms
 = {

42 .
dp_ty³
 = 
NL_DUMP_LINE
,

43 .
dp_fd
 = 
¡dout
,

46 
sock
 = 
	`Æ_şi_®loc_sock‘
();

47 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

48 
lšk
 = 
	`Æ_şi_lšk_®loc
();

51 
c
, 
İtidx
 = 0;

53 
ARG_FAMILY
 = 257,

54 
ARG_MTU
 = 258,

55 
ARG_TXQLEN
,

56 
ARG_WEIGHT
,

57 
ARG_DETAILS
,

58 
ARG_STATS
,

60 
İtiÚ
 
lÚg_İts
[] = {

61 { "d‘as", 0, 0, 
ARG_DETAILS
 },

62 { "¡©s", 0, 0, 
ARG_STATS
 },

67 { "çmy", 1, 0, 
ARG_FAMILY
 },

68 { "mtu", 1, 0, 
ARG_MTU
 },

69 { "txqËn", 1, 0, 
ARG_TXQLEN
 },

70 { "weight", 1, 0, 
ARG_WEIGHT
 },

74 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hvn:i:", 
lÚg_İts
, &
İtidx
);

75 ià(
c
 == -1)

78 
c
) {

79 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

80 
ARG_STATS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_STATS
; ;

81 'h': 
	`´št_u§ge
(); ;

82 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

83 'n': 
	`Æ_şi_lšk_·r£_Çme
(
lšk
, 
İrg
); ;

84 'i': 
	`Æ_şi_lšk_·r£_ifšdex
(
lšk
, 
İrg
); ;

85 
ARG_FAMILY
: 
	`Æ_şi_lšk_·r£_çmy
(
lšk
, 
İrg
); ;

86 
ARG_MTU
: 
	`Æ_şi_lšk_·r£_mtu
(
lšk
, 
İrg
); ;

87 
ARG_TXQLEN
: 
	`Æ_şi_lšk_·r£_txqËn
(
lšk
, 
İrg
); ;

88 
ARG_WEIGHT
: 
	`Æ_şi_lšk_·r£_weight
(
lšk
, 
İrg
); ;

92 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche_çmy
(
sock
,

93 
	`¹Æ_lšk_g‘_çmy
(
lšk
));

95 
	`Æ_ÿche_dump_f‹r
(
lšk_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
lšk
));

98 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-name2ifindex.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
("Usage:‚l-link-name2ifindex <name>\n");

18 
	`ex™
(0);

19 
	}
}

21 
	$maš
(
¬gc
, *
¬gv
[])

23 
Æ_sock
 *
sock
;

24 
Æ_ÿche
 *
lšk_ÿche
;

25 
ušt32_t
 
ifšdex
;

27 ià(
¬gc
 < 2)

28 
	`´št_u§ge
();

30 
sock
 = 
	`Æ_şi_®loc_sock‘
();

31 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

32 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

34 ià(!(
ifšdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, 
¬gv
[1])))

35 
	`Æ_şi_çl
(
ENOENT
, "Interface \"%s\" does‚otƒxist",

36 
¬gv
[1]);

38 
	`´štf
("%u\n", 
ifšdex
);

41 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-release.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

14 
	~<Ãšk/rou‹/lšk/bÚdšg.h
>

16 
	$maš
(
¬gc
, *
¬gv
[])

18 
Æ_sock
 *
sock
;

19 
Æ_ÿche
 *
lšk_ÿche
;

20 
¹Æ_lšk
 *
¦ave
;

21 
”r
;

23 ià(
¬gc
 < 2) {

24 
	`årštf
(
¡d”r
, "Usage:‚l-link-release slave\n");

28 
sock
 = 
	`Æ_şi_®loc_sock‘
();

29 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

30 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

32 ià(!(
¦ave
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
¬gv
[1]))) {

33 
	`årštf
(
¡d”r
, "UnknowÀlšk: %s\n", 
¬gv
[1]);

37 ià((
”r
 = 
	`¹Æ_lšk_bÚd_»Ëa£
(
sock
, 
¦ave
)) < 0) {

38 
	`årštf
(
¡d”r
, "Unableo„elease slave %s: %s\n",

39 
¬gv
[1], 
	`Æ_g‘”rÜ
(
”r
));

44 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-set.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
Æ_sock
 *
	gsock
;

16 
	gqu›t
 = 0;

26 
	$´št_u§ge
()

28 
	`´štf
(

47 
	`ex™
(0);

48 
	}
}

50 
	$£t_cb
(
Æ_objeù
 *
obj
, *
¬g
)

52 
¹Æ_lšk
 *
lšk
 = 
	`Æ_objeù_´iv
(
obj
);

53 
¹Æ_lšk
 *
chªge
 = 
¬g
;

54 
Æ_dump_·¿ms
 
·¿ms
 = {

55 .
dp_ty³
 = 
NL_DUMP_LINE
,

56 .
dp_fd
 = 
¡dout
,

58 
”r
;

60 ià((
”r
 = 
	`¹Æ_lšk_chªge
(
sock
, 
lšk
, 
chªge
, 0)) < 0)

61 
	`Æ_şi_çl
(
”r
, "Unableo change†ink: %s",

62 
	`Æ_g‘”rÜ
(
”r
));

64 ià(!
qu›t
) {

65 
	`´štf
("Changed ");

66 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
lšk
), &
·¿ms
);

68 
	}
}

70 
	$maš
(
¬gc
, *
¬gv
[])

72 
Æ_ÿche
 *
lšk_ÿche
;

73 
¹Æ_lšk
 *
lšk
, *
chªge
;

74 
ok
 = 0;

76 
sock
 = 
	`Æ_şi_®loc_sock‘
();

77 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

78 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

79 
lšk
 = 
	`Æ_şi_lšk_®loc
();

80 
chªge
 = 
	`Æ_şi_lšk_®loc
();

83 
c
, 
İtidx
 = 0;

85 
ARG_RENAME
 = 257,

86 
ARG_MTU
 = 258,

87 
ARG_TXQLEN
,

88 
ARG_WEIGHT
,

89 
ARG_IFALIAS
,

90 
ARG_STATE
,

92 
İtiÚ
 
lÚg_İts
[] = {

98 { "»Çme", 1, 0, 
ARG_RENAME
 },

99 { "mtu", 1, 0, 
ARG_MTU
 },

100 { "txqËn", 1, 0, 
ARG_TXQLEN
 },

101 { "weight", 1, 0, 
ARG_WEIGHT
 },

102 { "içlŸs", 1, 0, 
ARG_IFALIAS
 },

103 { "¡©e", 1, 0, 
ARG_STATE
 },

107 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhvn:i:", 
lÚg_İts
, &
İtidx
);

108 ià(
c
 == -1)

111 
c
) {

112 'q': 
qu›t
 = 1; ;

113 'h': 
	`´št_u§ge
(); ;

114 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

115 'n': 
ok
++; 
	`Æ_şi_lšk_·r£_Çme
(
lšk
, 
İrg
); ;

116 'i': 
ok
++; 
	`Æ_şi_lšk_·r£_ifšdex
(
lšk
, 
İrg
); ;

117 
ARG_RENAME
: 
	`Æ_şi_lšk_·r£_Çme
(
chªge
, 
İrg
); ;

118 
ARG_MTU
: 
	`Æ_şi_lšk_·r£_mtu
(
chªge
, 
İrg
); ;

119 
ARG_TXQLEN
: 
	`Æ_şi_lšk_·r£_txqËn
(
chªge
, 
İrg
); ;

120 
ARG_WEIGHT
: 
	`Æ_şi_lšk_·r£_weight
(
chªge
, 
İrg
); ;

121 
ARG_IFALIAS
: 
	`Æ_şi_lšk_·r£_içlŸs
(
chªge
, 
İrg
); ;

122 
ARG_STATE
:

123 if(!
	`¡rcmp
(
İrg
, "up"))

124 
	`¹Æ_lšk_£t_æags
(
chªge
, 
IFF_UP
);

125 if(!
	`¡rcmp
(
İrg
, "down"))

126 
	`¹Æ_lšk_un£t_æags
(
chªge
, 
IFF_UP
);

131 ià(!
ok
)

132 
	`´št_u§ge
();

134 
	`Æ_ÿche_fÜ—ch_f‹r
(
lšk_ÿche
, 
	`OBJ_CAST
(
lšk
), 
£t_cb
, 
chªge
);

137 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-link-stats.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

29 
	`ex™
(0);

30 
	}
}

32 
	$li¡_¡©_Çmes
()

34 
buf
[64];

35 
i
;

37 
i
 = 0; i < 
RTNL_LINK_STATS_MAX
; i++)

38 
	`´štf
("%s\n", 
	`¹Æ_lšk_¡©2¡r
(
i
, 
buf
, (buf)));

40 
	`ex™
(0);

41 
	}
}

43 
	gg¬gc
;

45 
	$dump_¡©
(
¹Æ_lšk
 *
lšk
, 
id
)

47 
ušt64_t
 
¡
 = 
	`¹Æ_lšk_g‘_¡©
(
lšk
, 
id
);

48 
buf
[64];

50 
	`´štf
("%s.% %" 
PRIu64
 "\n", 
	`¹Æ_lšk_g‘_Çme
(
lšk
),

51 
	`¹Æ_lšk_¡©2¡r
(
id
, 
buf
, (buf)), 
¡
);

52 
	}
}

54 
	$dump_¡©s
(
Æ_objeù
 *
obj
, *
¬g
)

56 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

57 **
¬gv
 = 
¬g
;

59 ià(
İtšd
 >ğ
g¬gc
) {

60 
i
;

62 
i
 = 0; i < 
RTNL_LINK_STATS_MAX
; i++)

63 
	`dump_¡©
(
lšk
, 
i
);

65 
İtšd
 < 
g¬gc
) {

66 
id
 = 
	`¹Æ_lšk_¡r2¡©
(
¬gv
[
İtšd
]);

68 ià(
id
 < 0)

69 
	`årštf
(
¡d”r
, "Warning: Unknown statistic "

70 "\"%s\"\n", 
¬gv
[
İtšd
]);

72 
	`dump_¡©
(
lšk
, 
id
);

74 
İtšd
++;

77 
	}
}

79 
	$maš
(
¬gc
, *
¬gv
[])

81 
Æ_sock
 *
sock
;

82 
Æ_ÿche
 *
lšk_ÿche
;

83 
¹Æ_lšk
 *
lšk
;

85 
sock
 = 
	`Æ_şi_®loc_sock‘
();

86 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

87 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

88 
lšk
 = 
	`Æ_şi_lšk_®loc
();

91 
c
, 
İtidx
 = 0;

92 
İtiÚ
 
lÚg_İts
[] = {

101 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "lhvn:i:", 
lÚg_İts
, &
İtidx
);

102 ià(
c
 == -1)

105 
c
) {

106 'l': 
	`li¡_¡©_Çmes
(); ;

107 'h': 
	`´št_u§ge
(); ;

108 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

109 'n': 
	`Æ_şi_lšk_·r£_Çme
(
lšk
, 
İrg
); ;

110 'i': 
	`Æ_şi_lšk_·r£_ifšdex
(
lšk
, 
İrg
); ;

114 
g¬gc
 = 
¬gc
;

115 
	`Æ_ÿche_fÜ—ch_f‹r
(
lšk_ÿche
, 
	`OBJ_CAST
(
lšk
), 
dump_¡©s
, 
¬gv
);

118 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-list-caches.c

12 
	~<Ãšk-´iv©e/Ãšk.h
>

13 
	~<Ãšk/şi/uts.h
>

15 
	$´št_u§ge
()

17 
	`årštf
(
¡d”r
, "Usage:‚l-list-caches\n");

18 
	`ex™
(1);

19 
	}
}

21 *
	$id_©Œ_li¡
(
Æ_objeù_İs
 *
İs
, *
buf
, 
size_t
 
Ën
)

23 ià(
İs
->
oo_©Œs2¡r
 !ğ
NULL
)

24  
İs
->
	`oo_©Œs2¡r
(İs->
oo_id_©Œs
, 
buf
, 
Ën
);

26 
	`mem£t
(
buf
, 0, 
Ën
);

27  
buf
;

29 
	}
}

31 
	$´št
(
Æ_ÿche_İs
 *
İs
, *
¬g
)

33 
buf
[64];

35 
	`´štf
("%s:\n" \

40 
İs
->
co_Çme
, ops->
co_hdrsize
,

41 
	`Æ_Æçmy2¡r
(
İs
->
co_´ÙocŞ
, 
buf
, (buf)),

42 
İs
->
co_»que¡_upd©e
 ? "yes" : "no",

43 
İs
->
co_msg_·r£r
 ? "yes" : "no");

45 ià(
İs
->
co_obj_İs
) {

46 
Æ_objeù_İs
 *
obj_İs
 = 
İs
->
co_obj_İs
;

47 cÚ¡ *
dump_Çmes
[
NL_DUMP_MAX
+1] = {

52 
i
;

54 
	`´štf
(" cacheable object:\n" \

63 
obj_İs
->
oo_Çme
, obj_İs->
oo_size
,

64 
obj_İs
->
oo_cÚ¡ruùÜ
 ? "yes" : "no",

65 
obj_İs
->
oo_ä“_d©a
 ? "yes" : "no",

66 
obj_İs
->
oo_şÚe
 ? "yes" : "no",

67 
obj_İs
->
oo_com·»
 ? "yes" : "no",

68 
	`id_©Œ_li¡
(
obj_İs
, 
buf
, (buf)));

70 
i
 = 0; i <ğ
NL_DUMP_MAX
; i++)

71 ià(
obj_İs
->
oo_dump
[
i
])

72 
	`´štf
("%s%s",

73 
i
 == 0 ? "" : ", ",

74 
dump_Çmes
[
i
]);

76 
	`´štf
("\n");

79 ià(
İs
->
co_g’l
) {

80 
g’l_İs
 *g’l_İ ğ
İs
->
co_g’l
;

82 
	`´štf
(" genl:\n" \

86 
g’l_İs
->
o_Çme
, g’l_İs->
o_hdrsize
, g’l_İs->
o_id
);

88 ià(
g’l_İs
->
o_ncmds
) {

89 
i
;

91 
	`´štf
(" cmds:\n");

93 
i
 = 0; i < 
g’l_İs
->
o_ncmds
; i++) {

94 
g’l_cmd
 *
cmd
 = &
g’l_İs
->
o_cmds
[
i
];

96 
	`´štf
(" %s:\n"

101 
cmd
->
c_Çme
, cmd->
c_id
, cmd->
c_max©Œ
,

102 
cmd
->
c_msg_·r£r
 ? "yes" : "no",

103 
cmd
->
c_©Œ_pŞicy
 ? "yes" : "no");

107 
	}
}

109 
	$maš
(
¬gc
, *
¬gv
[])

111 ià(
¬gc
 > 1 && !
	`¡rÿ£cmp
(
¬gv
[1], "-h"))

112 
	`´št_u§ge
();

114 
	`Æ_ÿche_İs_fÜ—ch
(
´št
, 
NULL
);

117 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-list-sockets.c

12 
	~<Ãšk/şi/uts.h
>

14 
	#PROC_NETLINK
 "/´oc/Ãt/Ãšk"

	)

16 
	$maš
(
¬gc
, *
¬gv
[])

18 
FILE
 *
fd
;

19 
buf
[2048], 
p
[64];

21 
fd
 = 
	`fİ’
(
PROC_NETLINK
, "r");

22 ià(
fd
 =ğ
NULL
) {

23 
	`³¼Ü
("fopen");

27 
	`´štf
("Address Family PID Groups„mem "

30 
	`fg‘s
(
buf
, (buf), 
fd
)) {

31 
sk
, 
cb
;

32 
»t
, 
´Ùo
, 
pid
, 
rmem
, 
wmem
, 
»fút
;

33 
groups
;

35 
»t
 = 
	`ssÿnf
(
buf
, "%lx %d %d %08x %d %d %lx %d\n",

36 &
sk
, &
´Ùo
, &
pid
, &
groups
, &
rmem
, &
wmem
,

37 &
cb
, &
»fút
);

38 ià(
»t
 != 8)

41 
	`´štf
("0x%016lx %-16s %-6d %08x %-6d %-6d 0x%08lx %d\n",

42 
sk
, 
	`Æ_Æçmy2¡r
(
´Ùo
, 
p
, Õ)), 
pid
,

43 
groups
, 
rmem
, 
wmem
, 
cb
, 
»fút
);

46 
	`fşo£
(
fd
);

49 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-monitor.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$obj_šput
(
Æ_objeù
 *
obj
, *
¬g
)

17 
Æ_dump_·¿ms
 
dp
 = {

18 .
dp_ty³
 = 
NL_DUMP_STATS
,

19 .
dp_fd
 = 
¡dout
,

20 .
dp_dump_msgty³
 = 1,

23 
	`Æ_objeù_dump
(
obj
, &
dp
);

24 
	}
}

26 
	$ev’t_šput
(
Æ_msg
 *
msg
, *
¬g
)

28 ià(
	`Æ_msg_·r£
(
msg
, &
obj_šput
, 
NULL
) < 0)

29 
	`årštf
(
¡d”r
, "<<EVENT>> Unknown messageype\n");

32  
NL_STOP
;

33 
	}
}

35 
	$maš
(
¬gc
, *
¬gv
[])

37 
Æ_sock
 *
sock
;

38 
Æ_ÿche
 *
lšk_ÿche
;

39 
”r
 = 1;

40 
i
, 
idx
;

43 
¹Ãšk_groups
 
gr_id
;

44 cÚ¡ * 
gr_Çme
;

45 } 
known_groups
[] = {

46 { 
RTNLGRP_LINK
, "link" },

47 { 
RTNLGRP_NOTIFY
, "notify" },

48 { 
RTNLGRP_NEIGH
, "neigh" },

49 { 
RTNLGRP_TC
, "tc" },

50 { 
RTNLGRP_IPV4_IFADDR
, "ipv4-ifaddr" },

51 { 
RTNLGRP_IPV4_MROUTE
, "ipv4-mroute" },

52 { 
RTNLGRP_IPV4_ROUTE
, "ipv4-route" },

53 { 
RTNLGRP_IPV6_IFADDR
, "ipv6-ifaddr" },

54 { 
RTNLGRP_IPV6_MROUTE
, "ipv6-mroute" },

55 { 
RTNLGRP_IPV6_ROUTE
, "ipv6-route" },

56 { 
RTNLGRP_IPV6_IFINFO
, "ipv6-ifinfo" },

57 { 
RTNLGRP_DECÃt_IFADDR
, "decnet-ifaddr" },

58 { 
RTNLGRP_DECÃt_ROUTE
, "decnet-route" },

59 { 
RTNLGRP_IPV6_PREFIX
, "ipv6-prefix" },

60 { 
RTNLGRP_NONE
, 
NULL
 }

63 
sock
 = 
	`Æ_şi_®loc_sock‘
();

64 
	`Æ_sock‘_di§bË_£q_check
(
sock
);

65 
	`Æ_sock‘_modify_cb
(
sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
ev’t_šput
, 
NULL
);

67 ià(
¬gc
 > 1 && !
	`¡rÿ£cmp
(
¬gv
[1], "-h")) {

68 
	`´štf
("Usage:‚l-monitor [<groups>]\n");

70 
	`´štf
("Known groups:");

71 
i
 = 0; 
known_groups
[i].
gr_id
 !ğ
RTNLGRP_NONE
; i++)

72 
	`´štf
(" %s", 
known_groups
[
i
].
gr_Çme
);

73 
	`´štf
("\n");

77 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

79 
idx
 = 1; 
¬gc
 > idx; idx++) {

80 
i
 = 0; 
known_groups
[i].
gr_id
 !ğ
RTNLGRP_NONE
; i++) {

81 ià(!
	`¡rcmp
(
¬gv
[
idx
], 
known_groups
[
i
].
gr_Çme
)) {

83 ià((
”r
 = 
	`Æ_sock‘_add_memb”sh
(
sock
, 
known_groups
[
i
].
gr_id
)) < 0) {

84 
	`Æ_şi_çl
(
”r
, "%s: %s\n", 
¬gv
[
idx
],

85 
	`Æ_g‘”rÜ
(
”r
));

91 ià(
known_groups
[
i
].
gr_id
 =ğ
RTNLGRP_NONE
)

92 
	`årštf
(
¡d”r
, "W¬nšg: UnknowÀgroup: %s\n", 
¬gv
[
idx
]);

95 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

98 
fd_£t
 
rfds
;

99 
fd
, 
»tv®
;

101 
fd
 = 
	`Æ_sock‘_g‘_fd
(
sock
);

103 
	`FD_ZERO
(&
rfds
);

104 
	`FD_SET
(
fd
, &
rfds
);

106 
»tv®
 = 
	`£Ëù
(
fd
+1, &
rfds
, 
NULL
, NULL, NULL);

108 ià(
»tv®
) {

110 
	`Æ_»cvmsgs_deçuÉ
(
sock
);

115 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-neigh-add.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/Ãigh.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gqu›t
 = 0;

18 
	$´št_u§ge
()

20 
	`´štf
(

41 
	`ex™
(0);

42 
	}
}

44 
	$maš
(
¬gc
, *
¬gv
[])

46 
Æ_sock
 *
sock
;

47 
¹Æ_Ãigh
 *
Ãigh
;

48 
Æ_ÿche
 *
lšk_ÿche
;

49 
Æ_dump_·¿ms
 
dp
 = {

50 .
dp_ty³
 = 
NL_DUMP_LINE
,

51 .
dp_fd
 = 
¡dout
,

53 
”r
, 
ok
 = 0, 
Ææags
 = 
NLM_F_REPLACE
 | 
NLM_F_CREATE
;

55 
sock
 = 
	`Æ_şi_®loc_sock‘
();

56 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

57 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

58 
Ãigh
 = 
	`Æ_şi_Ãigh_®loc
();

61 
c
, 
İtidx
 = 0;

63 
ARG_UPDATE_ONLY
 = 257,

64 
ARG_CREATE_ONLY
 = 258,

65 
ARG_STATE
,

67 
İtiÚ
 
lÚg_İts
[] = {

68 { "upd©e-Úly", 0, 0, 
ARG_UPDATE_ONLY
 },

69 { "ü—‹-Úly", 0, 0, 
ARG_CREATE_ONLY
 },

76 { "¡©e", 1, 0, 
ARG_STATE
 },

80 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhva:l:d:", 
lÚg_İts
, &
İtidx
);

81 ià(
c
 == -1)

84 
c
) {

85 
ARG_UPDATE_ONLY
: 
Ææags
 &ğ~
NLM_F_CREATE
; ;

86 
ARG_CREATE_ONLY
: 
Ææags
 |ğ
NLM_F_EXCL
; ;

87 'q': 
qu›t
 = 1; ;

88 'h': 
	`´št_u§ge
(); ;

89 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

90 'a': 
ok
++; 
	`Æ_şi_Ãigh_·r£_d¡
(
Ãigh
, 
İrg
); ;

91 'l': 
	`Æ_şi_Ãigh_·r£_Îaddr
(
Ãigh
, 
İrg
); ;

92 'd': 
	`Æ_şi_Ãigh_·r£_dev
(
Ãigh
, 
lšk_ÿche
, 
İrg
); ;

93 
ARG_STATE
: 
	`Æ_şi_Ãigh_·r£_¡©e
(
Ãigh
, 
İrg
); ;

97 ià(!
ok
)

98 
	`´št_u§ge
();

100 ià((
”r
 = 
	`¹Æ_Ãigh_add
(
sock
, 
Ãigh
, 
Ææags
)) < 0)

101 
	`Æ_şi_çl
(
”r
, "Unableo‡dd‚eighbour: %s",

102 
	`Æ_g‘”rÜ
(
”r
));

104 ià(!
qu›t
) {

105 
	`´štf
("Added ");

106 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
Ãigh
), &
dp
);

110 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-neigh-delete.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/Ãigh.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gqu›t
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gd–‘ed
 = 0, 
	gš‹¿ùive
 = 0;

17 
Æ_sock
 *
	gsock
;

19 
	$´št_u§ge
()

21 
	`´štf
(

39 
	`ex™
(0);

40 
	}
}

42 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

44 
¹Æ_Ãigh
 *
Ãigh
 = 
	`Æ_objeù_´iv
(
obj
);

45 
Æ_dump_·¿ms
 
·¿ms
 = {

46 .
dp_ty³
 = 
NL_DUMP_LINE
,

47 .
dp_fd
 = 
¡dout
,

49 
”r
;

51 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

54 ià((
”r
 = 
	`¹Æ_Ãigh_d–‘e
(
sock
, 
Ãigh
, 0)) < 0)

55 
	`Æ_şi_çl
(
”r
, "Unableo delete‚eighbour: %s\n",

56 
	`Æ_g‘”rÜ
(
”r
));

58 ià(!
qu›t
) {

59 
	`´štf
("Deleted ");

60 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

63 
d–‘ed
++;

64 
	}
}

66 
	$maš
(
¬gc
, *
¬gv
[])

68 
¹Æ_Ãigh
 *
Ãigh
;

69 
Æ_ÿche
 *
lšk_ÿche
, *
Ãigh_ÿche
;

71 
sock
 = 
	`Æ_şi_®loc_sock‘
();

72 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

73 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

74 
Ãigh_ÿche
 = 
	`Æ_şi_Ãigh_®loc_ÿche
(
sock
);

75 
Ãigh
 = 
	`Æ_şi_Ãigh_®loc
();

78 
c
, 
İtidx
 = 0;

80 
ARG_FAMILY
 = 257,

81 
ARG_STATE
 = 258,

82 
ARG_YES
,

84 
İtiÚ
 
lÚg_İts
[] = {

86 { "yes", 0, 0, 
ARG_YES
 },

93 { "çmy", 1, 0, 
ARG_FAMILY
 },

94 { "¡©e", 1, 0, 
ARG_STATE
 },

98 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhva:l:d:", 
lÚg_İts
, &
İtidx
);

99 ià(
c
 == -1)

102 
c
) {

103 'i': 
š‹¿ùive
 = 1; ;

104 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

105 'q': 
qu›t
 = 1; ;

106 'h': 
	`´št_u§ge
(); ;

107 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

108 'a': 
	`Æ_şi_Ãigh_·r£_d¡
(
Ãigh
, 
İrg
); ;

109 'l': 
	`Æ_şi_Ãigh_·r£_Îaddr
(
Ãigh
, 
İrg
); ;

110 'd': 
	`Æ_şi_Ãigh_·r£_dev
(
Ãigh
, 
lšk_ÿche
, 
İrg
); ;

111 
ARG_FAMILY
: 
	`Æ_şi_Ãigh_·r£_çmy
(
Ãigh
, 
İrg
); ;

112 
ARG_STATE
: 
	`Æ_şi_Ãigh_·r£_¡©e
(
Ãigh
, 
İrg
); ;

116 
	`Æ_ÿche_fÜ—ch_f‹r
(
Ãigh_ÿche
, 
	`OBJ_CAST
(
Ãigh
), 
d–‘e_cb
, 
NULL
);

118 ià(!
qu›t
)

119 
	`´štf
("D–‘ed %d‚eighbours\n", 
d–‘ed
);

122 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-neigh-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/Ãigh.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

33 
	`ex™
(0);

34 
	}
}

36 
	$maš
(
¬gc
, *
¬gv
[])

38 
Æ_sock
 *
sock
;

39 
¹Æ_Ãigh
 *
Ãigh
;

40 
Æ_ÿche
 *
lšk_ÿche
, *
Ãigh_ÿche
;

41 
Æ_dump_·¿ms
 
·¿ms
 = {

42 .
dp_ty³
 = 
NL_DUMP_LINE
,

43 .
dp_fd
 = 
¡dout
,

46 
sock
 = 
	`Æ_şi_®loc_sock‘
();

47 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

48 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

49 
Ãigh_ÿche
 = 
	`Æ_şi_Ãigh_®loc_ÿche
(
sock
);

50 
Ãigh
 = 
	`Æ_şi_Ãigh_®loc
();

53 
c
, 
İtidx
 = 0;

55 
ARG_FAMILY
 = 257,

56 
ARG_STATE
 = 258,

58 
İtiÚ
 
lÚg_İts
[] = {

65 { "çmy", 1, 0, 
ARG_FAMILY
 },

66 { "¡©e", 1, 0, 
ARG_STATE
 },

70 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "f:hva:l:d:", 
lÚg_İts
, &
İtidx
);

71 ià(
c
 == -1)

74 
c
) {

75 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

76 'h': 
	`´št_u§ge
(); ;

77 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

78 'a': 
	`Æ_şi_Ãigh_·r£_d¡
(
Ãigh
, 
İrg
); ;

79 'l': 
	`Æ_şi_Ãigh_·r£_Îaddr
(
Ãigh
, 
İrg
); ;

80 'd': 
	`Æ_şi_Ãigh_·r£_dev
(
Ãigh
, 
lšk_ÿche
, 
İrg
); ;

81 
ARG_FAMILY
: 
	`Æ_şi_Ãigh_·r£_çmy
(
Ãigh
, 
İrg
); ;

82 
ARG_STATE
: 
	`Æ_şi_Ãigh_·r£_¡©e
(
Ãigh
, 
İrg
); ;

86 
	`Æ_ÿche_dump_f‹r
(
Ãigh_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
Ãigh
));

89 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-neightbl-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

25 
	`ex™
(0);

26 
	}
}

28 
	$maš
(
¬gc
, *
¬gv
[])

30 
Æ_sock
 *
sock
;

31 
Æ_ÿche
 *
lšk_ÿche
, *
Ãightbl_ÿche
;

32 
Æ_dump_·¿ms
 
·¿ms
 = {

33 .
dp_ty³
 = 
NL_DUMP_LINE
,

34 .
dp_fd
 = 
¡dout
,

37 
sock
 = 
	`Æ_şi_®loc_sock‘
();

38 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

39 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

40 
Ãightbl_ÿche
 = 
	`Æ_şi_®loc_ÿche
(
sock
, "neighbourable",

41 
¹Æ_Ãightbl_®loc_ÿche
);

44 
c
, 
İtidx
 = 0;

45 
İtiÚ
 
lÚg_İts
[] = {

52 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "f:hv", 
lÚg_İts
, &
İtidx
);

53 ià(
c
 == -1)

56 
c
) {

57 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

58 'h': 
	`´št_u§ge
(); ;

59 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

63 
	`Æ_ÿche_dump
(
Ãightbl_ÿche
, &
·¿ms
);

66 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-pktloc-lookup.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/rou‹/pkoc.h
>

15 
	$´št_u§ge
()

17 
	`´štf
(

32 
	`ex™
(0);

33 
	}
}

35 cÚ¡ *
	g®ign_txt
[] = {

36 [
TCF_EM_ALIGN_U8
] = "u8",

37 [
TCF_EM_ALIGN_U16
] = "u16",

38 [
TCF_EM_ALIGN_U32
] = "u32"

41 
ušt32_t
 
	g®ign_mask
[] = {

42 [
TCF_EM_ALIGN_U8
] = 0xff,

43 [
TCF_EM_ALIGN_U16
] = 0xffff,

44 [
TCF_EM_ALIGN_U32
] = 0xffffffff,

47 cÚ¡ *
	gÏy”_txt
[] = {

48 [
TCF_LAYER_LINK
] = "eth",

49 [
TCF_LAYER_NETWORK
] = "ip",

50 [
TCF_LAYER_TRANSPORT
] = "tcp"

53 
	$dump_u32_¡yË
(
¹Æ_pkoc
 *
loc
, 
ušt32_t
 
v®ue
)

55 ià(
loc
->
®ign
 > 4)

56 
	`Æ_şi_çl
(
EINVAL
, "u32 only supports‡lignments u8|u16|u32.");

58 ià(
loc
->
Ïy”
 =ğ
TCF_LAYER_LINK
)

59 
	`Æ_şi_çl
(
EINVAL
, "u32 does‚ot support†ink "

62 ià(
loc
->
shiá
 > 0)

63 
	`Æ_şi_çl
(
EINVAL
, "u32 does‚ot support shifting.");

65 
	`´štf
("%s %x %x‡t %s%u\n",

66 
®ign_txt
[
loc
->
®ign
],

67 
v®ue
, 
loc
->
mask
 ?†oc->mask : 
®ign_mask
[loc->
®ign
],

68 
loc
->
Ïy”
 =ğ
TCF_LAYER_TRANSPORT
 ? "nexthdr+" : "",

69 
loc
->
off£t
);

70 
	}
}

72 *
	$g‘_®ign_txt
(
¹Æ_pkoc
 *
loc
)

74 
buf
[16];

76 ià(
loc
->
®ign
 <= 4)

77 
	`¡rıy
(
buf
, 
®ign_txt
[
loc
->
®ign
]);

79 
	`¢´štf
(
buf
, (buf), "%u", 
loc
->
®ign
);

81  
buf
;

82 
	}
}

84 
	$dump_loc
(
¹Æ_pkoc
 *
loc
)

86 
	`´štf
("%s = %s‡t %s+%u & %#x >> %u\n",

87 
loc
->
Çme
, 
	`g‘_®ign_txt
Öoc), 
Ïy”_txt
[loc->
Ïy”
],

88 
loc
->
off£t
,†oc->
mask
,†oc->
shiá
);

89 
	}
}

91 
	$li¡_cb
(
¹Æ_pkoc
 *
loc
, *
¬g
)

93 
	`´štf
("%-26s %-5s %3s+%-4u %#-10x %-8u %u\n",

94 
loc
->
Çme
, 
	`g‘_®ign_txt
Öoc), 
Ïy”_txt
[loc->
Ïy”
],

95 
loc
->
off£t
,†oc->
mask
,†oc->
shiá
,†oc->
»fút
);

96 
	}
}

98 
	$do_li¡
()

100 
	`´štf
(

102 
	`´štf
("---------------------------------------------------------\n");

104 
	`¹Æ_pkoc_fÜ—ch
(&
li¡_cb
, 
NULL
);

105 
	}
}

107 
	$maš
(
¬gc
, *
¬gv
[])

109 
¹Æ_pkoc
 *
loc
;

110 
”r
, 
u¡yË
 = 0;

111 
ušt32_t
 
uv®ue
 = 0;

114 
c
, 
İtidx
 = 0;

116 
ARG_U32
 = 257,

118 
İtiÚ
 
lÚg_İts
[] = {

122 { "u32", 1, 0, 
ARG_U32
 },

126 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "hvl", 
lÚg_İts
, &
İtidx
);

127 ià(
c
 == -1)

130 
c
) {

131 'h': 
	`´št_u§ge
(); ;

132 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

133 'l': 
	`do_li¡
(); 
	`ex™
(0);

134 
ARG_U32
:

135 
u¡yË
 = 1;

136 
uv®ue
 = 
	`Æ_şi_·r£_u32
(
İrg
);

141 ià(
İtšd
 >ğ
¬gc
)

142 
	`´št_u§ge
();

144 ià((
”r
 = 
	`¹Æ_pkoc_lookup
(
¬gv
[
İtšd
++], &
loc
)) < 0)

145 
	`Æ_şi_çl
(
”r
, "Unableo†ookup…acket†ocation: %s",

146 
	`Æ_g‘”rÜ
(
”r
));

148 ià(
u¡yË
)

149 
	`dump_u32_¡yË
(
loc
, 
uv®ue
);

151 
	`dump_loc
(
loc
);

154 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-qdisc-add.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/qdisc.h
>

15 
	~<Ãšk/şi/lšk.h
>

17 
	~<Ãšk-´iv©e/rou‹/tc-­i.h
>

19 
	gqu›t
 = 0;

21 
	$´št_u§ge
()

23 
	`´štf
(

45 
	`ex™
(0);

46 
	}
}

48 
	$maš
(
¬gc
, *
¬gv
[])

50 
Æ_sock
 *
sock
;

51 
¹Æ_qdisc
 *
qdisc
;

52 
¹Æ_tc
 *
tc
;

53 
Æ_ÿche
 *
lšk_ÿche
;

54 
Æ_dump_·¿ms
 
dp
 = {

55 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

56 .
dp_fd
 = 
¡dout
,

58 
Æ_şi_tc_moduË
 *
tm
;

59 
¹Æ_tc_İs
 *
İs
;

60 
”r
, 
æags
 = 
NLM_F_CREATE
 | 
NLM_F_EXCL
;

61 *
kšd
, *
id
 = 
NULL
;

63 
sock
 = 
	`Æ_şi_®loc_sock‘
();

64 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

66 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

68 
qdisc
 = 
	`Æ_şi_qdisc_®loc
();

69 
tc
 = (
¹Æ_tc
 *è
qdisc
;

72 
c
, 
İtidx
 = 0;

74 
ARG_REPLACE
 = 257,

75 
ARG_UPDATE
 = 258,

76 
ARG_REPLACE_ONLY
,

77 
ARG_UPDATE_ONLY
,

79 
İtiÚ
 
lÚg_İts
[] = {

86 { "»¶aû", 0, 0, 
ARG_REPLACE
 },

87 { "upd©e", 0, 0, 
ARG_UPDATE
 },

88 { "»¶aû-Úly", 0, 0, 
ARG_REPLACE_ONLY
 },

89 { "upd©e-Úly", 0, 0, 
ARG_UPDATE_ONLY
 },

93 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "+qhvd:p:i:",

94 
lÚg_İts
, &
İtidx
);

95 ià(
c
 == -1)

98 
c
) {

99 'q': 
qu›t
 = 1; ;

100 'h': 
	`´št_u§ge
(); ;

101 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

102 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

103 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

104 'i': 
id
 = 
	`¡rdup
(
İrg
); ;

105 
ARG_UPDATE
: 
æags
 = 
NLM_F_CREATE
; ;

106 
ARG_REPLACE
: 
æags
 = 
NLM_F_CREATE
 | 
NLM_F_REPLACE
; ;

107 
ARG_UPDATE_ONLY
: 
æags
 = 0; ;

108 
ARG_REPLACE_ONLY
: 
æags
 = 
NLM_F_REPLACE
; ;

112 ià(
İtšd
 >ğ
¬gc
)

113 
	`´št_u§ge
();

115 ià(!
	`¹Æ_tc_g‘_ifšdex
(
tc
))

116 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡‚etwork device (--dev=XXX)");

118 ià(!
	`¹Æ_tc_g‘_·»Á
(
tc
))

119 
	`Æ_şi_çl
(
EINVAL
, "You must specify‡…arent");

121 ià(
id
) {

122 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
id
, 1);

123 
	`ä“
(
id
);

126 
kšd
 = 
¬gv
[
İtšd
++];

127 
	`¹Æ_tc_£t_kšd
(
tc
, 
kšd
);

129 ià(!(
İs
 = 
	`¹Æ_tc_g‘_İs
(
tc
)))

130 
	`Æ_şi_çl
(
ENOENT
, "UnknowÀqdisø\"%s\"", 
kšd
);

132 ià(!(
tm
 = 
	`Æ_şi_tc_lookup
(
İs
)))

133 
	`Æ_şi_çl
(
ENOTSUP
, "Qdisøty³ \"%s\"‚Ù suµÜ‹d.", 
kšd
);

135 
tm
->
	`tm_·r£_¬gv
(
tc
, 
¬gc
, 
¬gv
);

137 ià(!
qu›t
) {

138 
	`´štf
("Adding ");

139 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
qdisc
), &
dp
);

142 ià((
”r
 = 
	`¹Æ_qdisc_add
(
sock
, 
qdisc
, 
æags
)) < 0)

143 
	`Æ_şi_çl
(
EINVAL
, "UÇbËØadd qdisc: %s", 
	`Æ_g‘”rÜ
(
”r
));

146 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-qdisc-delete.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/qdisc.h
>

15 
	~<Ãšk/şi/lšk.h
>

17 
	gqu›t
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gd–‘ed
 = 0, 
	gš‹¿ùive
 = 0;

18 
Æ_sock
 *
	gsock
;

20 
	$´št_u§ge
()

22 
	`´štf
(

38 
	`ex™
(0);

39 
	}
}

41 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

43 
¹Æ_qdisc
 *
qdisc
 = 
	`Æ_objeù_´iv
(
obj
);

44 
Æ_dump_·¿ms
 
·¿ms
 = {

45 .
dp_ty³
 = 
NL_DUMP_LINE
,

46 .
dp_fd
 = 
¡dout
,

48 
”r
;

51 ià(
	`¹Æ_tc_g‘_hªdË
((
¹Æ_tc
 *è
qdisc
) == 0)

54 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

57 ià((
”r
 = 
	`¹Æ_qdisc_d–‘e
(
sock
, 
qdisc
)) < 0)

58 
	`Æ_şi_çl
(
”r
, "UÇbËØd–‘qdisc: %s\n", 
	`Æ_g‘”rÜ
(err));

60 ià(!
qu›t
) {

61 
	`´štf
("Deleted ");

62 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

65 
d–‘ed
++;

66 
	}
}

68 
	$maš
(
¬gc
, *
¬gv
[])

70 
¹Æ_qdisc
 *
qdisc
;

71 
¹Æ_tc
 *
tc
;

72 
Æ_ÿche
 *
lšk_ÿche
, *
qdisc_ÿche
;

73 
nf‹r
 = 0;

75 
sock
 = 
	`Æ_şi_®loc_sock‘
();

76 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

77 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

78 
qdisc_ÿche
 = 
	`Æ_şi_qdisc_®loc_ÿche
(
sock
);

79 
qdisc
 = 
	`Æ_şi_qdisc_®loc
();

80 
tc
 = (
¹Æ_tc
 *è
qdisc
;

83 
c
, 
İtidx
 = 0;

85 
ARG_YES
 = 257,

86 
ARG_INTERACTIVE
 = 258,

88 
İtiÚ
 
lÚg_İts
[] = {

89 { "š‹¿ùive", 0, 0, 
ARG_INTERACTIVE
 },

90 { "yes", 0, 0, 
ARG_YES
 },

101 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

102 ià(
c
 == -1)

105 
c
) {

106 '?': 
	`Æ_şi_çl
(
EINVAL
, "Invalid options");

107 
ARG_INTERACTIVE
: 
š‹¿ùive
 = 1; ;

108 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

109 'q': 
qu›t
 = 1; ;

110 'h': 
	`´št_u§ge
(); ;

111 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

113 
nf‹r
++;

114 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
);

117 
nf‹r
++;

118 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
);

121 
nf‹r
++;

122 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0);

125 
nf‹r
++;

126 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
);

131 ià(
nf‹r
 =ğ0 && !
š‹¿ùive
 && !
deçuÉ_yes
) {

132 
	`Æ_şi_çl
(
EINVAL
,

138 
	`Æ_ÿche_fÜ—ch_f‹r
(
qdisc_ÿche
, 
	`OBJ_CAST
(
qdisc
), 
d–‘e_cb
, 
NULL
);

140 ià(!
qu›t
)

141 
	`´štf
("D–‘ed %d qdiscs\n", 
d–‘ed
);

144 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-qdisc-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/tc.h
>

14 
	~<Ãšk/şi/qdisc.h
>

15 
	~<Ãšk/şi/şass.h
>

16 
	~<Ãšk/şi/şs.h
>

17 
	~<Ãšk/şi/lšk.h
>

19 
	#NUM_INDENT
 4

	)

21 
Æ_sock
 *
	gsock
;

22 
	g»cursive
 = 0;

23 
Æ_dump_·¿ms
 
	g·¿ms
 = {

24 .
dp_ty³
 = 
NL_DUMP_LINE
,

27 
	$´št_u§ge
()

29 
	`´štf
(

49 
	`ex™
(0);

50 
	}
}

52 
li¡_şas£s
(
ifšdex
, 
ušt32_t
 
·»Á
);

53 
li¡_qdiscs
(
ifšdex
, 
ušt32_t
 
·»Á
);

55 
	$li¡_şass
(
Æ_objeù
 *
obj
, *
¬g
)

57 
¹Æ_tc
 *
tc
 = 
	`Æ_objeù_´iv
(
obj
);

58 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

60 
	`li¡_şas£s
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
	`¹Æ_tc_g‘_hªdË
(tc));

61 
	`li¡_qdiscs
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
	`¹Æ_tc_g‘_hªdË
(tc));

62 
	}
}

64 
	$li¡_şas£s
(
ifšdex
, 
ušt32_t
 
·»Á
)

66 
Æ_ÿche
 *
şass_ÿche
;

67 
¹Æ_şass
 *
f‹r
 = 
	`Æ_şi_şass_®loc
();

69 
şass_ÿche
 = 
	`Æ_şi_şass_®loc_ÿche
(
sock
, 
ifšdex
);

71 
	`¹Æ_tc_£t_·»Á
((
¹Æ_tc
 *è
f‹r
, 
·»Á
);

72 
·¿ms
.
dp_´efix
 +ğ
NUM_INDENT
;

73 
	`Æ_ÿche_fÜ—ch_f‹r
(
şass_ÿche
, 
	`OBJ_CAST
(
f‹r
), 
li¡_şass
, 
NULL
);

74 
·¿ms
.
dp_´efix
 -ğ
NUM_INDENT
;

76 
	`¹Æ_şass_put
(
f‹r
);

77 
	`Æ_ÿche_ä“
(
şass_ÿche
);

78 
	}
}

80 
	$li¡_şs
(
ifšdex
, 
ušt32_t
 
·»Á
)

82 
Æ_ÿche
 *
şs_ÿche
;

84 
şs_ÿche
 = 
	`Æ_şi_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
);

86 
·¿ms
.
dp_´efix
 +ğ
NUM_INDENT
;

87 
	`Æ_ÿche_dump
(
şs_ÿche
, &
·¿ms
);

88 
·¿ms
.
dp_´efix
 -ğ
NUM_INDENT
;

90 
	`Æ_ÿche_ä“
(
şs_ÿche
);

91 
	}
}

93 
	$li¡_qdisc
(
Æ_objeù
 *
obj
, *
¬g
)

95 
¹Æ_qdisc
 *
qdisc
 = 
	`Æ_objeù_´iv
(
obj
);

96 
¹Æ_tc
 *
tc
 = (¹Æ_tø*è
qdisc
;

98 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

100 
	`li¡_şs
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
	`¹Æ_tc_g‘_hªdË
(tc));

102 ià(
	`¹Æ_tc_g‘_·»Á
(
tc
è=ğ
TC_H_ROOT
) {

103 
	`li¡_şs
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
TC_H_ROOT
);

104 
	`li¡_şas£s
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
TC_H_ROOT
);

107 
	`li¡_şas£s
(
	`¹Æ_tc_g‘_ifšdex
(
tc
), 
	`¹Æ_tc_g‘_hªdË
(tc));

108 
	}
}

110 
	$li¡_qdiscs
(
ifšdex
, 
ušt32_t
 
·»Á
)

112 
Æ_ÿche
 *
qdisc_ÿche
;

113 
¹Æ_qdisc
 *
f‹r
 = 
	`Æ_şi_qdisc_®loc
();

115 
qdisc_ÿche
 = 
	`Æ_şi_qdisc_®loc_ÿche
(
sock
);

117 
	`¹Æ_tc_£t_ifšdex
((
¹Æ_tc
 *è
f‹r
, 
ifšdex
);

118 
	`¹Æ_tc_£t_·»Á
((
¹Æ_tc
 *è
f‹r
, 
·»Á
);

119 
·¿ms
.
dp_´efix
 +ğ
NUM_INDENT
;

120 
	`Æ_ÿche_fÜ—ch_f‹r
(
qdisc_ÿche
, 
	`OBJ_CAST
(
f‹r
), 
li¡_qdisc
, 
NULL
);

121 
·¿ms
.
dp_´efix
 -ğ
NUM_INDENT
;

123 
	`¹Æ_qdisc_put
(
f‹r
);

124 
	`Æ_ÿche_ä“
(
qdisc_ÿche
);

125 
	}
}

127 
	$maš
(
¬gc
, *
¬gv
[])

129 
¹Æ_qdisc
 *
qdisc
;

130 
¹Æ_tc
 *
tc
;

131 
Æ_ÿche
 *
lšk_ÿche
, *
qdisc_ÿche
;

133 
·¿ms
.
dp_fd
 = 
¡dout
;

134 
sock
 = 
	`Æ_şi_®loc_sock‘
();

135 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

136 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

137 
qdisc_ÿche
 = 
	`Æ_şi_qdisc_®loc_ÿche
(
sock
);

138 
qdisc
 = 
	`Æ_şi_qdisc_®loc
();

139 
tc
 = (
¹Æ_tc
 *è
qdisc
;

142 
c
, 
İtidx
 = 0;

144 
ARG_DETAILS
 = 257,

145 
ARG_STATS
 = 258,

147 
İtiÚ
 
lÚg_İts
[] = {

148 { "d‘as", 0, 0, 
ARG_DETAILS
 },

149 { "¡©s", 0, 0, 
ARG_STATS
 },

160 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "rhvd:p:i:k:", 
lÚg_İts
, &
İtidx
);

161 ià(
c
 == -1)

164 
c
) {

165 
ARG_DETAILS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_DETAILS
; ;

166 
ARG_STATS
: 
·¿ms
.
dp_ty³
 = 
NL_DUMP_STATS
; ;

167 'r': 
»cursive
 = 1; ;

168 'h': 
	`´št_u§ge
(); ;

169 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

170 'd': 
	`Æ_şi_tc_·r£_dev
(
tc
, 
lšk_ÿche
, 
İrg
); ;

171 'p': 
	`Æ_şi_tc_·r£_·»Á
(
tc
, 
İrg
); ;

172 'i': 
	`Æ_şi_tc_·r£_hªdË
(
tc
, 
İrg
, 0); ;

173 'k': 
	`Æ_şi_tc_·r£_kšd
(
tc
, 
İrg
); ;

177 ià(
»cursive
)

178 
	`Æ_ÿche_fÜ—ch_f‹r
(
qdisc_ÿche
, 
	`OBJ_CAST
(
qdisc
), 
li¡_qdisc
, 
NULL
);

180 
	`Æ_ÿche_dump_f‹r
(
qdisc_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
qdisc
));

183 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-route-add.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/rou‹.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gqu›t
 = 0;

17 
Æ_ÿche
 *
	glšk_ÿche
, *
	grou‹_ÿche
;

19 
	$´št_u§ge
()

21 
	`´štf
(

49 
	`ex™
(0);

50 
	}
}

52 
	$maš
(
¬gc
, *
¬gv
[])

54 
Æ_sock
 *
sock
;

55 
¹Æ_rou‹
 *
rou‹
;

56 
Æ_dump_·¿ms
 
dp
 = {

57 .
dp_ty³
 = 
NL_DUMP_LINE
,

58 .
dp_fd
 = 
¡dout
,

60 
”r
 = 1;

62 
sock
 = 
	`Æ_şi_®loc_sock‘
();

63 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

64 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

65 
rou‹_ÿche
 = 
	`Æ_şi_rou‹_®loc_ÿche
(
sock
, 0);

66 
rou‹
 = 
	`Æ_şi_rou‹_®loc
();

69 
c
, 
İtidx
 = 0;

71 
ARG_FAMILY
 = 257,

72 
ARG_SRC
 = 258,

73 
ARG_IIF
,

74 
ARG_PREF_SRC
,

75 
ARG_METRICS
,

76 
ARG_PRIORITY
,

77 
ARG_SCOPE
,

78 
ARG_PROTOCOL
,

79 
ARG_TYPE
,

81 
İtiÚ
 
lÚg_İts
[] = {

88 { "çmy", 1, 0, 
ARG_FAMILY
 },

89 { "¤c", 1, 0, 
ARG_SRC
 },

90 { "iif", 1, 0, 
ARG_IIF
 },

91 { "´ef-¤c", 1, 0, 
ARG_PREF_SRC
 },

92 { "m‘rics", 1, 0, 
ARG_METRICS
 },

93 { "´iÜ™y", 1, 0, 
ARG_PRIORITY
 },

94 { "scİe", 1, 0, 
ARG_SCOPE
 },

95 { "´ÙocŞ", 1, 0, 
ARG_PROTOCOL
 },

96 { "ty³", 1, 0, 
ARG_TYPE
 },

100 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "qhvd:n:t:", 
lÚg_İts
, &
İtidx
);

101 ià(
c
 == -1)

104 
c
) {

105 'q': 
qu›t
 = 1; ;

106 'h': 
	`´št_u§ge
(); ;

107 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

108 'd': 
	`Æ_şi_rou‹_·r£_d¡
(
rou‹
, 
İrg
); ;

109 'n': 
	`Æ_şi_rou‹_·r£_Ãxthİ
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

110 't': 
	`Æ_şi_rou‹_·r£_bË
(
rou‹
, 
İrg
); ;

111 
ARG_FAMILY
: 
	`Æ_şi_rou‹_·r£_çmy
(
rou‹
, 
İrg
); ;

112 
ARG_SRC
: 
	`Æ_şi_rou‹_·r£_¤c
(
rou‹
, 
İrg
); ;

113 
ARG_IIF
: 
	`Æ_şi_rou‹_·r£_iif
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

114 
ARG_PREF_SRC
: 
	`Æ_şi_rou‹_·r£_´ef_¤c
(
rou‹
, 
İrg
); ;

115 
ARG_METRICS
: 
	`Æ_şi_rou‹_·r£_m‘ric
(
rou‹
, 
İrg
); ;

116 
ARG_PRIORITY
: 
	`Æ_şi_rou‹_·r£_´io
(
rou‹
, 
İrg
); ;

117 
ARG_SCOPE
: 
	`Æ_şi_rou‹_·r£_scİe
(
rou‹
, 
İrg
); ;

118 
ARG_PROTOCOL
: 
	`Æ_şi_rou‹_·r£_´ÙocŞ
(
rou‹
, 
İrg
); ;

119 
ARG_TYPE
: 
	`Æ_şi_rou‹_·r£_ty³
(
rou‹
, 
İrg
); ;

123 ià((
”r
 = 
	`¹Æ_rou‹_add
(
sock
, 
rou‹
, 
NLM_F_EXCL
)) < 0)

124 
	`Æ_şi_çl
(
”r
, "UÇbËØadd„ou‹: %s", 
	`Æ_g‘”rÜ
(err));

126 ià(!
qu›t
) {

127 
	`´štf
("Added ");

128 
	`Æ_objeù_dump
(
	`OBJ_CAST
(
rou‹
), &
dp
);

132 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-route-delete.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/rou‹.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	gš‹¿ùive
 = 0, 
	gdeçuÉ_yes
 = 0, 
	gqu›t
 = 0;

17 
	gd–‘ed
 = 0;

18 
Æ_sock
 *
	gsock
;

20 
	$´št_v”siÚ
()

22 
	`årštf
(
¡d”r
, "%s\n", 
LIBNL_STRING
);

23 
	`ex™
(0);

24 
	}
}

26 
	$´št_u§ge
()

28 
	`´štf
(

58 
	`ex™
(0);

59 
	}
}

61 
	$d–‘e_cb
(
Æ_objeù
 *
obj
, *
¬g
)

63 
¹Æ_rou‹
 *
rou‹
 = (¹Æ_rou‹ *è
obj
;

64 
Æ_dump_·¿ms
 
·¿ms
 = {

65 .
dp_ty³
 = 
NL_DUMP_LINE
,

66 .
dp_fd
 = 
¡dout
,

68 
”r
;

70 ià(
š‹¿ùive
 && !
	`Æ_şi_cÚfœm
(
obj
, &
·¿ms
, 
deçuÉ_yes
))

73 ià((
”r
 = 
	`¹Æ_rou‹_d–‘e
(
sock
, 
rou‹
, 0)) < 0)

74 
	`Æ_şi_çl
(
”r
, "UÇbËØd–‘rou‹: %s", 
	`Æ_g‘”rÜ
(err));

76 ià(!
qu›t
) {

77 
	`´štf
("Deleted ");

78 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

81 
d–‘ed
++;

82 
	}
}

84 
	$maš
(
¬gc
, *
¬gv
[])

86 
Æ_ÿche
 *
lšk_ÿche
, *
rou‹_ÿche
;

87 
¹Æ_rou‹
 *
rou‹
;

88 
nf
 = 0;

90 
sock
 = 
	`Æ_şi_®loc_sock‘
();

91 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

92 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

93 
rou‹_ÿche
 = 
	`Æ_şi_rou‹_®loc_ÿche
(
sock
, 0);

94 
rou‹
 = 
	`Æ_şi_rou‹_®loc
();

97 
c
, 
İtidx
 = 0;

99 
ARG_FAMILY
 = 257,

100 
ARG_SRC
 = 258,

101 
ARG_IIF
,

102 
ARG_PREF_SRC
,

103 
ARG_METRICS
,

104 
ARG_PRIORITY
,

105 
ARG_SCOPE
,

106 
ARG_PROTOCOL
,

107 
ARG_TYPE
,

108 
ARG_YES
,

110 
İtiÚ
 
lÚg_İts
[] = {

112 { "yes", 0, 0, 
ARG_YES
 },

119 { "çmy", 1, 0, 
ARG_FAMILY
 },

120 { "¤c", 1, 0, 
ARG_SRC
 },

121 { "iif", 1, 0, 
ARG_IIF
 },

122 { "´ef-¤c", 1, 0, 
ARG_PREF_SRC
 },

123 { "m‘rics", 1, 0, 
ARG_METRICS
 },

124 { "´iÜ™y", 1, 0, 
ARG_PRIORITY
 },

125 { "scİe", 1, 0, 
ARG_SCOPE
 },

126 { "´ÙocŞ", 1, 0, 
ARG_PROTOCOL
 },

127 { "ty³", 1, 0, 
ARG_TYPE
 },

131 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "iqhvd:n:t:", 
lÚg_İts
, &
İtidx
);

132 ià(
c
 == -1)

135 
c
) {

136 'i': 
š‹¿ùive
 = 1; ;

137 
ARG_YES
: 
deçuÉ_yes
 = 1; ;

138 'q': 
qu›t
 = 1; ;

139 'h': 
	`´št_u§ge
(); ;

140 'v': 
	`´št_v”siÚ
(); ;

141 'd': 
nf
++; 
	`Æ_şi_rou‹_·r£_d¡
(
rou‹
, 
İrg
); ;

142 'n': 
nf
++; 
	`Æ_şi_rou‹_·r£_Ãxthİ
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

143 't': 
nf
++; 
	`Æ_şi_rou‹_·r£_bË
(
rou‹
, 
İrg
); ;

144 
ARG_FAMILY
: 
nf
++; 
	`Æ_şi_rou‹_·r£_çmy
(
rou‹
, 
İrg
); ;

145 
ARG_SRC
: 
nf
++; 
	`Æ_şi_rou‹_·r£_¤c
(
rou‹
, 
İrg
); ;

146 
ARG_IIF
: 
nf
++; 
	`Æ_şi_rou‹_·r£_iif
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

147 
ARG_PREF_SRC
: 
nf
++; 
	`Æ_şi_rou‹_·r£_´ef_¤c
(
rou‹
, 
İrg
); ;

148 
ARG_METRICS
: 
nf
++; 
	`Æ_şi_rou‹_·r£_m‘ric
(
rou‹
, 
İrg
); ;

149 
ARG_PRIORITY
: 
nf
++; 
	`Æ_şi_rou‹_·r£_´io
(
rou‹
, 
İrg
); ;

150 
ARG_SCOPE
: 
nf
++; 
	`Æ_şi_rou‹_·r£_scİe
(
rou‹
, 
İrg
); ;

151 
ARG_PROTOCOL
: 
nf
++; 
	`Æ_şi_rou‹_·r£_´ÙocŞ
(
rou‹
, 
İrg
); ;

152 
ARG_TYPE
: 
nf
++; 
	`Æ_şi_rou‹_·r£_ty³
(
rou‹
, 
İrg
); ;

156 ià(
nf
 =ğ0 && !
š‹¿ùive
 && !
deçuÉ_yes
) {

157 
	`årštf
(
¡d”r
, "You‡ttemptedo delete‡ll„outes in "

159 
	`ex™
(0);

162 
	`Æ_ÿche_fÜ—ch_f‹r
(
rou‹_ÿche
, 
	`OBJ_CAST
(
rou‹
), 
d–‘e_cb
, 
NULL
);

164 ià(!
qu›t
)

165 
	`´štf
("D–‘ed %d„ou‹s\n", 
d–‘ed
);

168 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-route-get.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/rou‹.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	$´št_u§ge
()

18 
	`´štf
("Usage:‚l-route-get <addr>\n");

19 
	`ex™
(1);

20 
	}
}

22 
	$·r£_cb
(
Æ_objeù
 *
obj
, *
¬g
)

25 
Æ_dump_·¿ms
 
·¿ms
 = {

26 .
dp_fd
 = 
¡dout
,

27 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

30 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

31 
	}
}

33 
	$cb
(
Æ_msg
 *
msg
, *
¬g
)

35 
”r
;

37 ià((
”r
 = 
	`Æ_msg_·r£
(
msg
, &
·r£_cb
, 
NULL
)) < 0)

38 
	`Æ_şi_çl
(
”r
, "UÇbËØ·r£ objeù: %s", 
	`Æ_g‘”rÜ
(err));

41 
	}
}

43 
	$maš
(
¬gc
, *
¬gv
[])

45 
Æ_sock
 *
sock
;

46 
Æ_ÿche
 *
lšk_ÿche
, *
rou‹_ÿche
;

47 
Æ_addr
 *
d¡
;

48 
”r
 = 1;

50 ià(
¬gc
 < 2 || !
	`¡rcmp
(
¬gv
[1], "-h"))

51 
	`´št_u§ge
();

53 
sock
 = 
	`Æ_şi_®loc_sock‘
();

54 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

55 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

56 
rou‹_ÿche
 = 
	`Æ_şi_rou‹_®loc_ÿche
(
sock
, 0);

58 
d¡
 = 
	`Æ_şi_addr_·r£
(
¬gv
[1], 
AF_INET
);

61 
Æ_msg
 *
m
;

62 
¹msg
 
rmsg
 = {

63 .
¹m_çmy
 = 
	`Æ_addr_g‘_çmy
(
d¡
),

64 .
¹m_d¡_Ën
 = 
	`Æ_addr_g‘_´efixËn
(
d¡
),

67 
m
 = 
	`Æmsg_®loc_sim¶e
(
RTM_GETROUTE
, 0);

68 ià(!
m
)

69 
	`Æ_şi_çl
(
ENOMEM
, "out of memory");

70 ià(
	`Æmsg_­³nd
(
m
, &
rmsg
, Ômsg), 
NLMSG_ALIGNTO
) < 0)

71 
	`Æ_şi_çl
(
ENOMEM
, "out of memory");

72 ià(
	`Æa_put_addr
(
m
, 
RTA_DST
, 
d¡
) < 0)

73 
	`Æ_şi_çl
(
ENOMEM
, "out of memory");

75 
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sock
, 
m
);

76 
	`Æmsg_ä“
(
m
);

77 ià(
”r
 < 0)

78 
	`Æ_şi_çl
(
”r
, "%s", 
	`Æ_g‘”rÜ
(err));

80 
	`Æ_sock‘_modify_cb
(
sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
, 
cb
, 
NULL
);

82 ià(
	`Æ_»cvmsgs_deçuÉ
(
sock
) < 0)

83 
	`Æ_şi_çl
(
”r
, "%s", 
	`Æ_g‘”rÜ
(err));

89 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-route-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/rou‹.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

47 
	`ex™
(0);

48 
	}
}

50 
	$maš
(
¬gc
, *
¬gv
[])

52 
Æ_sock
 *
sock
;

53 
Æ_ÿche
 *
lšk_ÿche
, *
rou‹_ÿche
;

54 
¹Æ_rou‹
 *
rou‹
;

55 
Æ_dump_·¿ms
 
·¿ms
 = {

56 .
dp_fd
 = 
¡dout
,

57 .
dp_ty³
 = 
NL_DUMP_LINE
,

59 
´št_ÿche
 = 0;

61 
sock
 = 
	`Æ_şi_®loc_sock‘
();

62 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

63 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

64 
rou‹
 = 
	`Æ_şi_rou‹_®loc
();

67 
c
, 
İtidx
 = 0;

69 
ARG_FAMILY
 = 257,

70 
ARG_SRC
 = 258,

71 
ARG_IIF
,

72 
ARG_PREF_SRC
,

73 
ARG_METRICS
,

74 
ARG_PRIORITY
,

75 
ARG_SCOPE
,

76 
ARG_PROTOCOL
,

77 
ARG_TYPE
,

79 
İtiÚ
 
lÚg_İts
[] = {

87 { "çmy", 1, 0, 
ARG_FAMILY
 },

88 { "¤c", 1, 0, 
ARG_SRC
 },

89 { "iif", 1, 0, 
ARG_IIF
 },

90 { "´ef-¤c", 1, 0, 
ARG_PREF_SRC
 },

91 { "m‘rics", 1, 0, 
ARG_METRICS
 },

92 { "´iÜ™y", 1, 0, 
ARG_PRIORITY
 },

93 { "scİe", 1, 0, 
ARG_SCOPE
 },

94 { "´ÙocŞ", 1, 0, 
ARG_PROTOCOL
 },

95 { "ty³", 1, 0, 
ARG_TYPE
 },

99 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "cf:hvd:n:t:", 
lÚg_İts
, &
İtidx
);

100 ià(
c
 == -1)

103 
c
) {

104 'c': 
´št_ÿche
 = 1; ;

105 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

106 'h': 
	`´št_u§ge
(); ;

107 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

108 'd': 
	`Æ_şi_rou‹_·r£_d¡
(
rou‹
, 
İrg
); ;

109 'n': 
	`Æ_şi_rou‹_·r£_Ãxthİ
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

110 't': 
	`Æ_şi_rou‹_·r£_bË
(
rou‹
, 
İrg
); ;

111 
ARG_FAMILY
: 
	`Æ_şi_rou‹_·r£_çmy
(
rou‹
, 
İrg
); ;

112 
ARG_SRC
: 
	`Æ_şi_rou‹_·r£_¤c
(
rou‹
, 
İrg
); ;

113 
ARG_IIF
: 
	`Æ_şi_rou‹_·r£_iif
(
rou‹
, 
İrg
, 
lšk_ÿche
); ;

114 
ARG_PREF_SRC
: 
	`Æ_şi_rou‹_·r£_´ef_¤c
(
rou‹
, 
İrg
); ;

115 
ARG_METRICS
: 
	`Æ_şi_rou‹_·r£_m‘ric
(
rou‹
, 
İrg
); ;

116 
ARG_PRIORITY
: 
	`Æ_şi_rou‹_·r£_´io
(
rou‹
, 
İrg
); ;

117 
ARG_SCOPE
: 
	`Æ_şi_rou‹_·r£_scİe
(
rou‹
, 
İrg
); ;

118 
ARG_PROTOCOL
: 
	`Æ_şi_rou‹_·r£_´ÙocŞ
(
rou‹
, 
İrg
); ;

119 
ARG_TYPE
: 
	`Æ_şi_rou‹_·r£_ty³
(
rou‹
, 
İrg
); ;

123 
rou‹_ÿche
 = 
	`Æ_şi_rou‹_®loc_ÿche
(
sock
,

124 
´št_ÿche
 ? 
ROUTE_CACHE_CONTENT
 : 0);

126 
	`Æ_ÿche_dump_f‹r
(
rou‹_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
rou‹
));

129 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-rule-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/ruË.h
>

14 
	~<Ãšk/şi/lšk.h
>

16 
	$´št_u§ge
()

18 
	`´štf
(

30 
	`ex™
(0);

31 
	}
}

33 
	$maš
(
¬gc
, *
¬gv
[])

35 
Æ_sock
 *
sock
;

36 
¹Æ_ruË
 *
ruË
;

37 
Æ_ÿche
 *
lšk_ÿche
, *
ruË_ÿche
;

38 
Æ_dump_·¿ms
 
·¿ms
 = {

39 .
dp_fd
 = 
¡dout
,

40 .
dp_ty³
 = 
NL_DUMP_LINE
,

43 
sock
 = 
	`Æ_şi_®loc_sock‘
();

44 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

45 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

46 
ruË_ÿche
 = 
	`Æ_şi_ruË_®loc_ÿche
(
sock
);

47 
ruË
 = 
	`Æ_şi_ruË_®loc
();

50 
c
, 
İtidx
 = 0;

52 
ARG_FAMILY
 = 257,

54 
İtiÚ
 
lÚg_İts
[] = {

58 { "çmy", 1, 0, 
ARG_FAMILY
 },

62 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "f:hv", 
lÚg_İts
, &
İtidx
);

63 ià(
c
 == -1)

66 
c
) {

67 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

68 'h': 
	`´št_u§ge
(); ;

69 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

70 
ARG_FAMILY
: 
	`Æ_şi_ruË_·r£_çmy
(
ruË
, 
İrg
); ;

74 
	`Æ_ÿche_dump_f‹r
(
ruË_ÿche
, &
·¿ms
, 
	`OBJ_CAST
(
ruË
));

77 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-tctree-list.c

12 
	~<Ãšk/şi/uts.h
>

13 
	~<Ãšk/şi/lšk.h
>

14 
	~<Ãšk/şi/qdisc.h
>

15 
	~<Ãšk/şi/şass.h
>

16 
	~<lšux/pkt_sched.h
>

18 
Æ_sock
 *
	gsock
;

19 
Æ_ÿche
 *
	gqdisc_ÿche
, *
	gşass_ÿche
;

20 
Æ_dump_·¿ms
 
	g·¿ms
 = {

21 .
dp_ty³
 = 
NL_DUMP_DETAILS
,

24 
	gifšdex
;

25 
´št_qdisc
(
Æ_objeù
 *, *);

26 
´št_tc_chds
(
¹Æ_tc
 *, *);

28 
	$´št_u§ge
()

30 
	`´štf
(

38 
	`ex™
(0);

39 
	}
}

41 
	$´št_şass
(
Æ_objeù
 *
obj
, *
¬g
)

43 
¹Æ_qdisc
 *
Ëaf
;

44 
¹Æ_şass
 *
şass
 = (¹Æ_şas *è
obj
;

45 
Æ_ÿche
 *
şs_ÿche
;

46 
ušt32_t
 
·»Á
 = 
	`¹Æ_tc_g‘_hªdË
((
¹Æ_tc
 *è
şass
);

48 
·¿ms
.
dp_´efix
 = ()(è
¬g
;

49 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

51 
Ëaf
 = 
	`¹Æ_şass_Ëaf_qdisc
(
şass
, 
qdisc_ÿche
);

52 ià(
Ëaf
)

53 
	`´št_qdisc
((
Æ_objeù
 *è
Ëaf
, 
¬g
 + 2);

55 
	`´št_tc_chds
(
	`TC_CAST
(
şass
), 
¬g
 + 2);

57 ià(
	`¹Æ_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
, &
şs_ÿche
) < 0)

60 
·¿ms
.
dp_´efix
 = ()(è
¬g
 + 2;

61 
	`Æ_ÿche_dump
(
şs_ÿche
, &
·¿ms
);

62 
	`Æ_ÿche_ä“
(
şs_ÿche
);

63 
	}
}

65 
	$´št_tc_chds
(
¹Æ_tc
 *
tc
, *
¬g
)

67 
¹Æ_şass
 *
f‹r
;

69 
f‹r
 = 
	`Æ_şi_şass_®loc
();

71 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
f‹r
), 
	`¹Æ_tc_g‘_hªdË
(
tc
));

72 
	`¹Æ_tc_£t_ifšdex
(
	`TC_CAST
(
f‹r
), 
	`¹Æ_tc_g‘_ifšdex
(
tc
));

74 
	`Æ_ÿche_fÜ—ch_f‹r
(
şass_ÿche
, 
	`OBJ_CAST
(
f‹r
), &
´št_şass
, 
¬g
);

76 
	`¹Æ_şass_put
(
f‹r
);

77 
	}
}

79 
	$´št_qdisc
(
Æ_objeù
 *
obj
, *
¬g
)

81 
¹Æ_qdisc
 *
qdisc
 = (¹Æ_qdisø*è
obj
;

82 
Æ_ÿche
 *
şs_ÿche
;

83 
ušt32_t
 
·»Á
 = 
	`¹Æ_tc_g‘_hªdË
((
¹Æ_tc
 *è
qdisc
);

85 
·¿ms
.
dp_´efix
 = ()(è
¬g
;

86 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

88 
	`´št_tc_chds
(
	`TC_CAST
(
qdisc
), 
¬g
 + 2);

90 ià(
	`¹Æ_şs_®loc_ÿche
(
sock
, 
ifšdex
, 
·»Á
, &
şs_ÿche
) < 0)

93 
·¿ms
.
dp_´efix
 = ()(è
¬g
 + 2;

94 
	`Æ_ÿche_dump
(
şs_ÿche
, &
·¿ms
);

95 
	`Æ_ÿche_ä“
(
şs_ÿche
);

96 
	}
}

98 
	$´št_lšk
(
Æ_objeù
 *
obj
, *
¬g
)

100 
¹Æ_lšk
 *
lšk
 = (¹Æ_lšk *è
obj
;

101 
¹Æ_qdisc
 *
qdisc
;

103 
ifšdex
 = 
	`¹Æ_lšk_g‘_ifšdex
(
lšk
);

104 
·¿ms
.
dp_´efix
 = 0;

105 
	`Æ_objeù_dump
(
obj
, &
·¿ms
);

107 ià(
	`¹Æ_şass_®loc_ÿche
(
sock
, 
ifšdex
, &
şass_ÿche
) < 0)

110 
qdisc
 = 
	`¹Æ_qdisc_g‘_by_·»Á
(
qdisc_ÿche
, 
ifšdex
, 
TC_H_ROOT
);

111 ià(
qdisc
) {

112 
	`´št_qdisc
((
Æ_objeù
 *è
qdisc
, (*) 2);

113 
	`¹Æ_qdisc_put
(
qdisc
);

116 
qdisc
 = 
	`¹Æ_qdisc_g‘_by_·»Á
(
qdisc_ÿche
, 
ifšdex
, 0);

117 ià(
qdisc
) {

118 
	`´št_qdisc
((
Æ_objeù
 *è
qdisc
, (*) 2);

119 
	`¹Æ_qdisc_put
(
qdisc
);

122 
qdisc
 = 
	`¹Æ_qdisc_g‘_by_·»Á
(
qdisc_ÿche
, 
ifšdex
, 
TC_H_INGRESS
);

123 ià(
qdisc
) {

124 
	`´št_qdisc
((
Æ_objeù
 *è
qdisc
, (*) 2);

125 
	`¹Æ_qdisc_put
(
qdisc
);

128 
	`Æ_ÿche_ä“
(
şass_ÿche
);

129 
	}
}

131 
	$maš
(
¬gc
, *
¬gv
[])

133 
Æ_ÿche
 *
lšk_ÿche
;

135 
sock
 = 
	`Æ_şi_®loc_sock‘
();

136 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_ROUTE
);

137 
lšk_ÿche
 = 
	`Æ_şi_lšk_®loc_ÿche
(
sock
);

138 
qdisc_ÿche
 = 
	`Æ_şi_qdisc_®loc_ÿche
(
sock
);

140 
·¿ms
.
dp_fd
 = 
¡dout
;

143 
c
, 
İtidx
 = 0;

144 
İtiÚ
 
lÚg_İts
[] = {

151 
c
 = 
	`g‘İt_lÚg
(
¬gc
, 
¬gv
, "f:hv", 
lÚg_İts
, &
İtidx
);

152 ià(
c
 == -1)

155 
c
) {

156 'f': 
·¿ms
.
dp_ty³
 = 
	`Æ_şi_·r£_dum±y³
(
İrg
); ;

157 'h': 
	`´št_u§ge
(); ;

158 'v': 
	`Æ_şi_´št_v”siÚ
(); ;

162 
	`Æ_ÿche_fÜ—ch
(
lšk_ÿche
, &
´št_lšk
, 
NULL
);

165 
	}
}

	@mylibnl/libnl-3.2.25/src/nl-util-addr.c

12 
	~<Ãšk/şi/uts.h
>

14 
	$maš
(
¬gc
, *
¬gv
[])

16 
”r
;

17 
ho¡
[256];

18 
Æ_addr
 *
a
;

20 ià(
¬gc
 < 2) {

21 
	`årštf
(
¡d”r
, "Usage:‚l-util-addr <address>\n");

25 
a
 = 
	`Æ_şi_addr_·r£
(
¬gv
[1], 
AF_UNSPEC
);

26 
”r
 = 
	`Æ_addr_»sŞve
(
a
, 
ho¡
, (host));

27 ià(
”r
 != 0)

28 
	`Æ_şi_çl
(
”r
, "Unableo„esolve‡ddress \"%s\": %s",

29 
¬gv
[1], 
	`Æ_g‘”rÜ
(
”r
));

31 
	`´štf
("%s\n", 
ho¡
);

34 
	}
}

	@mylibnl/libnl-3.2.25/tests/check-addr.c

12 
	~<check.h
>

13 
	~<Ãšk/addr.h
>

15 
	$START_TEST
(
addr_®loc
)

17 
Æ_addr
 *
addr
;

19 
addr
 = 
	`Æ_addr_®loc
(16);

20 
	`ç_if
(
addr
 =ğ
NULL
,

23 
	`ç_if
(
	`Æ_addr_isz”o
(
addr
) == 0,

26 
	`ç_if
(
	`Æ_addr_g‘_çmy
(
addr
è!ğ
AF_UNSPEC
,

29 
	`ç_if
(
	`Æ_addr_g‘_´efixËn
(
addr
) != 0,

32 
	`ç_if
(
	`Æ_addr_sh¬ed
(
addr
),

35 
	`ç_if
(
	`Æ_addr_g‘
(
addr
) !=‡ddr,

38 
	`ç_if
(
	`Æ_addr_sh¬ed
(
addr
) == 0,

41 
	`Æ_addr_put
(
addr
);

43 
	`ç_if
(
	`Æ_addr_sh¬ed
(
addr
),

46 
	`ç_if
(
	`Æ_addr_fl_sockaddr
(
addr
, 
NULL
, 0) == 0,

49 
	`Æ_addr_put
(
addr
);

50 
	}
}

51 
END_TEST


53 
	$START_TEST
(
addr_bš¬y_addr
)

55 
Æ_addr
 *
addr
, *
addr2
;

56 
baddr
[4] = { 0x1, 0x2, 0x3, 0x4 };

57 
baddr2
[6] = { 0x1, 0x2, 0x3, 0x4, 0x5, 0x6 };

59 
addr
 = 
	`Æ_addr_®loc
(4);

60 
	`ç_if
(
addr
 =ğ
NULL
,

63 
	`ç_if
(
	`Æ_addr_£t_bš¬y_addr
(
addr
, 
baddr
, 4) < 0,

66 
	`ç_if
(
	`Æ_addr_g‘_´efixËn
(
addr
) != 0,

69 
	`ç_if
(
	`Æ_addr_g‘_Ën
(
addr
) != 4,

72 
	`ç_if
(
	`Æ_addr_£t_bš¬y_addr
(
addr
, 
baddr2
, 6) == 0,

75 
	`ç_if
(
	`Æ_addr_g‘_Ën
(
addr
) != 4,

78 
	`ç_if
(
	`Æ_addr_guess_çmy
(
addr
è!ğ
AF_INET
,

81 
	`ç_if
(
	`memcmp
(
baddr
, 
	`Æ_addr_g‘_bš¬y_addr
(
addr
), 4) != 0,

84 
addr2
 = 
	`Æ_addr_bud
(
AF_UNSPEC
, 
baddr
, 4);

85 
	`ç_if
(
addr2
 =ğ
NULL
,

88 
	`Æ_addr_£t_´efixËn
(
addr
, 32);

89 
	`ç_if
(
	`Æ_addr_g‘_´efixËn
(
addr
) != 32,

92 
	`ç_if
(
	`Æ_addr_cmp
(
addr
, 
addr2
),

95 
	`Æ_addr_put
(
addr
);

96 
	`Æ_addr_put
(
addr2
);

97 
	}
}

98 
END_TEST


100 
	$START_TEST
(
addr_·r£4
)

102 
Æ_addr
 *
addr4
, *
şÚe
;

103 
sockaddr_š
 
sš
;

104 
sockËn_t
 
Ën
 = (
sš
);

105 *
addr_¡r
 = "10.0.0.1/16";

106 
buf
[128];

108 
	`ç_if
(
	`Æ_addr_·r£
(
addr_¡r
, 
AF_INET6
, &
addr4
) == 0,

111 
	`ç_if
(
	`Æ_addr_·r£
(
addr_¡r
, 
AF_UNSPEC
, &
addr4
) != 0,

112 "Should babËØ·r£ \"%s\"", 
addr_¡r
);

114 
	`ç_if
(
	`Æ_addr_g‘_çmy
(
addr4
è!ğ
AF_INET
,

117 
	`ç_if
(
	`Æ_addr_g‘_´efixËn
(
addr4
) != 16,

120 
	`ç_if
(
	`Æ_addr_isz”o
(
addr4
),

123 
şÚe
 = 
	`Æ_addr_şÚe
(
addr4
);

124 
	`ç_if
(
şÚe
 =ğ
NULL
,

127 
	`ç_if
(
	`Æ_addr_cmp
(
addr4
, 
şÚe
) != 0,

130 
	`ç_if
(
	`Æ_addr_fl_sockaddr
(
addr4
, (
sockaddr
 *è&
sš
, &
Ën
) != 0,

133 
	`ç_if
(
	`¡rcmp
(
	`Æ_addr2¡r
(
addr4
, 
buf
, (buf)), 
addr_¡r
),

136 
	`Æ_addr_put
(
addr4
);

137 
	`Æ_addr_put
(
şÚe
);

138 
	}
}

139 
END_TEST


141 
	$START_TEST
(
addr_·r£6
)

143 
Æ_addr
 *
addr6
, *
şÚe
;

144 
sockaddr_š6
 
sš
;

145 
sockËn_t
 
Ën
 = (
sš
);

146 *
addr_¡r
 = "2001:1:2::3/64";

147 
buf
[128];

149 
	`ç_if
(
	`Æ_addr_·r£
(
addr_¡r
, 
AF_INET
, &
addr6
) == 0,

152 
	`ç_if
(
	`Æ_addr_·r£
(
addr_¡r
, 
AF_UNSPEC
, &
addr6
) != 0,

153 "Should babËØ·r£ \"%s\"", 
addr_¡r
);

155 
	`ç_if
(
	`Æ_addr_g‘_çmy
(
addr6
è!ğ
AF_INET6
,

158 
	`ç_if
(
	`Æ_addr_g‘_´efixËn
(
addr6
) != 64,

161 
	`ç_if
(
	`Æ_addr_isz”o
(
addr6
),

164 
şÚe
 = 
	`Æ_addr_şÚe
(
addr6
);

165 
	`ç_if
(
şÚe
 =ğ
NULL
,

168 
	`ç_if
(
	`Æ_addr_cmp
(
addr6
, 
şÚe
) != 0,

171 
	`ç_if
(
	`Æ_addr_fl_sockaddr
(
addr6
, (
sockaddr
 *è&
sš
, &
Ën
) != 0,

174 
	`ç_if
(
	`¡rcmp
(
	`Æ_addr2¡r
(
addr6
, 
buf
, (buf)), 
addr_¡r
),

177 
	`Æ_addr_put
(
addr6
);

178 
	`Æ_addr_put
(
şÚe
);

179 
	}
}

180 
END_TEST


182 
	$START_TEST
(
addr_šfo
)

184 
Æ_addr
 *
addr
;

185 *
addr_¡r
 = "127.0.0.1";

186 
addršfo
 *
»suÉ
;

188 
	`ç_if
(
	`Æ_addr_·r£
(
addr_¡r
, 
AF_UNSPEC
, &
addr
) != 0,

191 
	`ç_if
(
	`Æ_addr_šfo
(
addr
, &
»suÉ
) != 0,

194 
	`ä“addršfo
(
»suÉ
);

195 
	`Æ_addr_put
(
addr
);

196 
	}
}

197 
END_TEST


199 
Su™e
 *
	$make_Æ_addr_su™e
()

201 
Su™e
 *
su™e
 = 
	`su™e_ü—‹
("Abstract‡ddresses");

203 
TCa£
 *
tc_addr
 = 
	`tÿ£_ü—‹
("Core");

204 
	`tÿ£_add_‹¡
(
tc_addr
, 
addr_®loc
);

205 
	`tÿ£_add_‹¡
(
tc_addr
, 
addr_bš¬y_addr
);

206 
	`tÿ£_add_‹¡
(
tc_addr
, 
addr_·r£4
);

207 
	`tÿ£_add_‹¡
(
tc_addr
, 
addr_·r£6
);

208 
	`tÿ£_add_‹¡
(
tc_addr
, 
addr_šfo
);

209 
	`su™e_add_tÿ£
(
su™e
, 
tc_addr
);

211  
su™e
;

212 
	}
}

	@mylibnl/libnl-3.2.25/tests/check-all.c

12 
	~<check.h
>

14 
Su™e
 *
make_Æ_addr_su™e
();

15 
Su™e
 *
make_Æ_©Œ_su™e
();

17 
Su™e
 *
	$maš_su™e
()

19 
Su™e
 *
su™e
 = 
	`su™e_ü—‹
("main");

21  
su™e
;

22 
	}
}

24 
	$maš
(
¬gc
, *
¬gv
[])

26 
SRuÂ”
 *
ruÂ”
;

27 
nçed
;

29 
ruÂ”
 = 
	`¤uÂ”_ü—‹
(
	`maš_su™e
());

33 
	`¤uÂ”_add_su™e
(
ruÂ”
, 
	`make_Æ_addr_su™e
());

34 
	`¤uÂ”_add_su™e
(
ruÂ”
, 
	`make_Æ_©Œ_su™e
());

38 
	`¤uÂ”_run_®l
(
ruÂ”
, 
CK_ENV
);

40 
nçed
 = 
	`¤uÂ”_Áe¡s_çed
(
ruÂ”
);

41 
	`¤uÂ”_ä“
(
ruÂ”
);

43  
nçed
 != 0;

44 
	}
}

	@mylibnl/libnl-3.2.25/tests/check-attr.c

12 
	~"ut.h
"

13 
	~<Ãšk/©Œ.h
>

14 
	~<Ãšk/msg.h
>

16 
	$START_TEST
(
©Œ_size
)

18 
	`ç_if
(
	`Æa_©Œ_size
(0è!ğ
NLA_HDRLEN
,

20 
	`ç_if
(
	`Æa_©Œ_size
(1è!ğ
NLA_HDRLEN
 + 1,

22 
	`ç_if
(
	`Æa_©Œ_size
(2è!ğ
NLA_HDRLEN
 + 2,

24 
	`ç_if
(
	`Æa_©Œ_size
(3è!ğ
NLA_HDRLEN
 + 3,

26 
	`ç_if
(
	`Æa_©Œ_size
(4è!ğ
NLA_HDRLEN
 + 4,

29 
	`ç_if
(
	`Æa_tÙ®_size
(1è!ğ
NLA_HDRLEN
 + 4,

31 
	`ç_if
(
	`Æa_tÙ®_size
(2è!ğ
NLA_HDRLEN
 + 4,

33 
	`ç_if
(
	`Æa_tÙ®_size
(3è!ğ
NLA_HDRLEN
 + 4,

35 
	`ç_if
(
	`Æa_tÙ®_size
(4è!ğ
NLA_HDRLEN
 + 4,

38 
	`ç_if
(
	`Æa_·dËn
(1) != 3,

40 
	`ç_if
(
	`Æa_·dËn
(2) != 2,

42 
	`ç_if
(
	`Æa_·dËn
(3) != 1,

44 
	`ç_if
(
	`Æa_·dËn
(4) != 0,

46 
	`ç_if
(
	`Æa_·dËn
(5) != 3,

48 
	}
}

49 
END_TEST


51 
	$START_TEST
(
msg_cÚ¡ruù
)

53 
Æ_msg
 *
msg
;

54 
Æmsghdr
 *
Æh
;

55 
Æ©Œ
 *
a
;

56 
i
, 
»m
;

58 
msg
 = 
	`Æmsg_®loc
();

59 
	`ç_if
(!
msg
, "Unableo‡llocate‚etlink message");

61 
i
 = 1; i < 256; i++) {

62 
	`ç_if
(
	`Æa_put_u32
(
msg
, 
i
, i+1) != 0,

63 "UÇbËØadd‡‰ribu‹ %d", 
i
);

66 
Æh
 = 
	`Æmsg_hdr
(
msg
);

67 
i
 = 1;

68 
	`Æmsg_fÜ_—ch_©Œ
(
a
, 
Æh
, 0, 
»m
) {

69 
	`ç_if
(
	`Æa_ty³
(
a
è!ğ
i
, "Expected‡ttribute %d", i);

70 
i
++;

71 
	`ç_if
(
	`Æa_g‘_u32
(
a
è!ğ
i
, "Expected‡ttribute value %d", i);

74 
	`Æmsg_ä“
(
msg
);

75 
	}
}

76 
END_TEST


78 
Su™e
 *
	$make_Æ_©Œ_su™e
()

80 
Su™e
 *
su™e
 = 
	`su™e_ü—‹
("Netlink‡ttributes");

82 
TCa£
 *
Æ_©Œ
 = 
	`tÿ£_ü—‹
("Core");

83 
	`tÿ£_add_‹¡
(
Æ_©Œ
, 
©Œ_size
);

84 
	`tÿ£_add_‹¡
(
Æ_©Œ
, 
msg_cÚ¡ruù
);

85 
	`su™e_add_tÿ£
(
su™e
, 
Æ_©Œ
);

87  
su™e
;

88 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-cache-mngr.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/ÿche.h
>

3 
	~<Ãšk/şi/uts.h
>

4 
	~<sigÇl.h
>

6 
	~<Ãšk-´iv©e/ÿche-­i.h
>

8 
	gqu™
 = 0;

10 
Æ_dump_·¿ms
 
	gdp
 = {

11 .
dp_ty³
 = 
NL_DUMP_LINE
,

15 
	$chªge_cb
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
,

16 
aùiÚ
, *
d©a
)

18 ià(
aùiÚ
 =ğ
NL_ACT_NEW
)

19 
	`´štf
("NEW ");

20 ià(
aùiÚ
 =ğ
NL_ACT_DEL
)

21 
	`´štf
("DEL ");

22 ià(
aùiÚ
 =ğ
NL_ACT_CHANGE
)

23 
	`´štf
("CHANGE ");

25 
	`Æ_objeù_dump
(
obj
, &
dp
);

26 
	}
}

28 
	$sigšt
(
¬g
)

30 
qu™
 = 1;

31 
	}
}

33 
	$maš
(
¬gc
, *
¬gv
[])

35 
Æ_ÿche_mngr
 *
mngr
;

36 
Æ_ÿche
 *
ÿche
;

37 
”r
, 
i
;

39 
dp
.
dp_fd
 = 
¡dout
;

41 
	`sigÇl
(
SIGINT
, 
sigšt
);

43 
”r
 = 
	`Æ_ÿche_mngr_®loc
(
NULL
, 
NETLINK_ROUTE
, 
NL_AUTO_PROVIDE
, &
mngr
);

44 ià(
”r
 < 0)

45 
	`Æ_şi_çl
(
”r
, "Unableo‡llocate cache manager: %s",

46 
	`Æ_g‘”rÜ
(
”r
));

48 
i
 = 1; i < 
¬gc
; i++) {

49 
”r
 = 
	`Æ_ÿche_mngr_add
(
mngr
, 
¬gv
[
i
], &
chªge_cb
, 
NULL
, &
ÿche
);

50 ià(
”r
 < 0)

51 
	`Æ_şi_çl
(
”r
, "Unableo‡dd cache %s: %s",

52 
¬gv
[
i
], 
	`Æ_g‘”rÜ
(
”r
));

55 !
qu™
) {

56 
”r
 = 
	`Æ_ÿche_mngr_pŞl
(
mngr
, 1000);

57 ià(
”r
 < 0 &&ƒ¼ !ğ-
NLE_INTR
)

58 
	`Æ_şi_çl
(
”r
, "PŞlšg faed: %s", 
	`Æ_g‘”rÜ
(err));

60 
	`Æ_ÿche_mngr_šfo
(
mngr
, &
dp
);

63 
	`Æ_ÿche_mngr_ä“
(
mngr
);

66 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-complex-HTB-with-hash-filters.c

12 
	~<Ãšk/rou‹/lšk.h
>

13 
	~<Ãšk/rou‹/tc.h
>

14 
	~<Ãšk/rou‹/qdisc.h
>

15 
	~<Ãšk/rou‹/qdisc/htb.h
>

16 
	~<Ãšk/rou‹/qdisc/sfq.h
>

17 
	~<Ãšk/rou‹/şs/u32.h
>

18 
	~<Ãšk/rou‹/şassif›r.h
>

19 
	~<Ãšk/rou‹/şass.h
>

20 
	~<lšux/if_‘h”.h
>

22 
	~<Ãšk/©Œ.h
>

25 
	~<¡dio.h
>

26 
	~<¡ršg.h
>

29 
	#TC_HANDLE
(
maj
, 
mš
è(
	`TC_H_MAJ
((majè<< 16è| 
	`TC_H_MIN
(mš))

	)

32 
	$g‘_u32
(
__u32
 *
v®
, cÚ¡ *
¬g
, 
ba£
)

34 
»s
;

35 *
±r
;

37 ià(!
¬g
 || !*arg)

39 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

40 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0xFFFFFFFFUL)

42 *
v®
 = 
»s
;

44 
	}
}

46 
	$g‘_u32_hªdË
(
__u32
 *
hªdË
, cÚ¡ *
¡r
)

48 
__u32
 
htid
=0, 
hash
=0, 
nodeid
=0;

49 *
tmp
 = 
	`¡rchr
(
¡r
, ':');

51 ià(
tmp
 =ğ
NULL
) {

52 ià(
	`memcmp
("0x", 
¡r
, 2) == 0)

53  
	`g‘_u32
(
hªdË
, 
¡r
, 16);

56 
htid
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

57 ià(
tmp
 =ğ
¡r
 && *str != ':' && *str != 0)

59 ià(
htid
>=0x1000)

61 ià(*
tmp
) {

62 
¡r
 = 
tmp
+1;

63 
hash
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

64 ià(
tmp
 =ğ
¡r
 && *str != ':' && *str != 0)

66 ià(
hash
>=0x100)

68 ià(*
tmp
) {

69 
¡r
 = 
tmp
+1;

70 
nodeid
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

71 ià(
tmp
 =ğ
¡r
 && *str != 0)

73 ià(
nodeid
>=0x1000)

77 *
hªdË
 = (
htid
<<20)|(
hash
<<12)|
nodeid
;

79 
	}
}

81 
ušt32_t
 
	$g‘_u32_·r£_hªdË
(cÚ¡ *
cHªdË
)

83 
ušt32_t
 
hªdË
=0;

85 if(
	`g‘_u32_hªdË
(&
hªdË
, 
cHªdË
)) {

86 
	`´štf
 ("Illegal \"ht\"\n");

90 ià(
hªdË
 && 
	`TC_U32_NODE
(handle)) {

91 
	`´štf
("\"link\" must be‡ hashable.\n");

94  
hªdË
;

95 
	}
}

97 
	$g‘_tc_şassid
(
__u32
 *
h
, cÚ¡ *
¡r
)

99 
__u32
 
maj
, 
mš
;

100 *
p
;

102 
maj
 = 
TC_H_ROOT
;

103 ià(
	`¡rcmp
(
¡r
, "root") == 0)

104 
ok
;

105 
maj
 = 
TC_H_UNSPEC
;

106 ià(
	`¡rcmp
(
¡r
, "none") == 0)

107 
ok
;

108 
maj
 = 
	`¡¹oul
(
¡r
, &
p
, 16);

109 ià(
p
 =ğ
¡r
) {

110 
maj
 = 0;

111 ià(*
p
 != ':')

114 ià(*
p
 == ':') {

115 ià(
maj
 >= (1<<16))

117 
maj
 <<= 16;

118 
¡r
 = 
p
+1;

119 
mš
 = 
	`¡¹oul
(
¡r
, &
p
, 16);

120 ià(*
p
 != 0)

122 ià(
mš
 >= (1<<16))

124 
maj
 |ğ
mš
;

125 } ià(*
p
 != 0)

128 
ok
:

129 *
h
 = 
maj
;

131 
	}
}

137 
	$u32_add_f‹r_Ú_ht
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
´io
,

138 
ušt32_t
 
keyv®
, ušt32_ˆ
keymask
, 
keyoff
, 
keyoffmask
,

139 
ušt32_t
 
htid
, ušt32_ˆ
şassid


142 
¹Æ_şs
 *
şs
;

143 
”r
;

148 
şs
=
	`¹Æ_şs_®loc
();

149 ià(!(
şs
)) {

150 
	`´štf
("Can‚ot‡llocate classifier\n");

151 
	`Æ_sock‘_ä“
(
sock
);

152 
	`ex™
(1);

155 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şs
), 
¹ÆLšk
);

157 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şs
), "u32"))) {

158 
	`´štf
("Can‚ot set classifier‡s u32\n");

162 
	`¹Æ_şs_£t_´io
(
şs
, 
´io
);

163 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
ETH_P_IP
);

165 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şs
), 
	`TC_HANDLE
(1, 0));

167 
	`¹Æ_u32_£t_hashbË
(
şs
, 
htid
);

169 
	`¹Æ_u32_add_key_ušt32
(
şs
, 
keyv®
, 
keymask
, 
keyoff
, 
keyoffmask
);

171 
	`¹Æ_u32_£t_şassid
(
şs
, 
şassid
);

173 
	`¹Æ_u32_£t_şs_‹rmš®
(
şs
);

175 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
NLM_F_CREATE
))) {

176 
	`´štf
("Cª‚Ù‡dd cÏssif›r: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

179 
	`¹Æ_şs_put
(
şs
);

182 
	}
}

189 
	$u32_add_f‹r_Ú_ht_w™h_hashmask
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
´io
,

190 
ušt32_t
 
keyv®
, ušt32_ˆ
keymask
, 
keyoff
, 
keyoffmask
,

191 
ušt32_t
 
htid
, ušt32_ˆ
hšk
, ušt32_ˆ
hmask
, ušt32_ˆ
hoff£t


194 
¹Æ_şs
 *
şs
;

195 
”r
;

200 
şs
=
	`¹Æ_şs_®loc
();

201 ià(!(
şs
)) {

202 
	`´štf
("Can‚ot‡llocate classifier\n");

203 
	`Æ_sock‘_ä“
(
sock
);

204 
	`ex™
(1);

207 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şs
), 
¹ÆLšk
);

209 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şs
), "u32"))) {

210 
	`´štf
("Can‚ot set classifier‡s u32\n");

214 
	`¹Æ_şs_£t_´io
(
şs
, 
´io
);

215 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
ETH_P_IP
);

217 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şs
), 
	`TC_HANDLE
(1, 0));

219 ià(
htid
)

220 
	`¹Æ_u32_£t_hashbË
(
şs
, 
htid
);

222 
	`¹Æ_u32_add_key_ušt32
(
şs
, 
keyv®
, 
keymask
, 
keyoff
, 
keyoffmask
);

224 
	`¹Æ_u32_£t_hashmask
(
şs
, 
hmask
, 
hoff£t
);

226 
	`¹Æ_u32_£t_lšk
(
şs
, 
hšk
);

229 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
NLM_F_CREATE
))) {

230 
	`´štf
("Cª‚Ù‡dd cÏssif›r: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

233 
	`¹Æ_şs_put
(
şs
);

235 
	}
}

240 
	$u32_add_ht
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
´io
, ušt32_ˆ
htid
, ušt32_ˆ
divisÜ
)

243 
”r
;

244 
¹Æ_şs
 *
şs
;

246 
şs
=
	`¹Æ_şs_®loc
();

247 ià(!(
şs
)) {

248 
	`´štf
("Can‚ot‡llocate classifier\n");

249 
	`Æ_sock‘_ä“
(
sock
);

250 
	`ex™
(1);

253 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şs
), 
¹ÆLšk
);

255 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şs
), "u32"))) {

256 
	`´štf
("Can‚ot set classifier‡s u32\n");

260 
	`¹Æ_şs_£t_´io
(
şs
, 
´io
);

261 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
ETH_P_IP
);

262 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şs
), 
	`TC_HANDLE
(1, 0));

264 
	`¹Æ_u32_£t_hªdË
(
şs
, 
htid
, 0x0, 0x0);

266 
	`¹Æ_u32_£t_divisÜ
(
şs
, 
divisÜ
);

268 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
NLM_F_CREATE
))) {

269 
	`´štf
("Cª‚Ù‡dd cÏssif›r: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

272 
	`¹Æ_şs_put
(
şs
);

274 
	}
}

279 
	$qdisc_add_HTB
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
deçuÉCÏss
)

282 
¹Æ_qdisc
 *
qdisc
;

283 
”r
;

286 ià(!(
qdisc
 = 
	`¹Æ_qdisc_®loc
())) {

287 
	`´štf
("Can‚ot‡llocate Qdisc\n");

292 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
qdisc
), 
¹ÆLšk
);

293 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
qdisc
), 
TC_H_ROOT
);

297 
	`¹Æ_qdisc_d–‘e
(
sock
, 
qdisc
);

302 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
qdisc
), 
	`TC_HANDLE
(1,0));

304 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
qdisc
), "htb"))) {

305 
	`´štf
("Can‚ot‡llocate HTB\n");

311 
	`¹Æ_htb_£t_defşs
(
qdisc
, 
	`TC_HANDLE
(1, 
deçuÉCÏss
));

312 
	`¹Æ_htb_£t_¿‹2quªtum
(
qdisc
, 1);

315 ià((
”r
 = 
	`¹Æ_qdisc_add
(
sock
, 
qdisc
, 
NLM_F_CREATE
))) {

316 
	`´štf
("Can‚ot‡llocate HTB Qdisc\n");

321 
	`¹Æ_qdisc_put
(
qdisc
);

324 
	}
}

329 
	$şass_add_HTB
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
,

330 
ušt32_t
 
·»ÁMaj
, ušt32_ˆ
·»ÁMš
,

331 
ušt32_t
 
chdMaj
, ušt32_ˆ
chdMš
,

332 
ušt64_t
 
¿‹
, ušt64_ˆ
û
,

333 
ušt32_t
 
bur¡
, ušt32_ˆ
cbur¡
,

334 
ušt32_t
 
´io


337 
”r
;

338 
¹Æ_şass
 *
şass
;

343 ià(!(
şass
 = 
	`¹Æ_şass_®loc
())) {

344 
	`´štf
("Can‚ot‡llocate class object\n");

348 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şass
), 
¹ÆLšk
);

351 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şass
), 
	`TC_HANDLE
(
·»ÁMaj
, 
·»ÁMš
));

352 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
şass
), 
	`TC_HANDLE
(
chdMaj
, 
chdMš
));

354 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şass
), "htb"))) {

355 
	`´štf
("Can‚ot set HTBo class\n");

360 
	`¹Æ_htb_£t_´io
((
¹Æ_şass
 *)
şass
, 
´io
);

362 ià(
¿‹
) {

364 
	`¹Æ_htb_£t_¿‹
(
şass
, 
¿‹
);

366 ià(
û
) {

368 
	`¹Æ_htb_£t_û
(
şass
, 
û
);

371 ià(
bur¡
) {

373 
	`¹Æ_htb_£t_rbufãr
(
şass
, 
bur¡
);

375 ià(
cbur¡
) {

377 
	`¹Æ_htb_£t_cbufãr
(
şass
, 
cbur¡
);

380 ià((
”r
 = 
	`¹Æ_şass_add
(
sock
, 
şass
, 
NLM_F_CREATE
))) {

381 
	`´štf
("Can‚ot‡llocate HTB Qdisc\n");

384 
	`¹Æ_şass_put
(
şass
);

386 
	}
}

391 
	$şass_add_HTB_roÙ
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
,

392 
ušt64_t
 
¿‹
, ušt64_ˆ
û
,

393 
ušt32_t
 
bur¡
, ušt32_ˆ
cbur¡


396 
”r
;

397 
¹Æ_şass
 *
şass
;

400 
şass
 = (
¹Æ_şass
 *)
	`¹Æ_şass_®loc
();

402 ià(!
şass
) {

403 
	`´štf
("Can‚ot‡llocate class object\n");

407 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şass
), 
¹ÆLšk
);

408 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şass
), 
TC_H_ROOT
);

411 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
şass
), 1);

413 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şass
), "htb"))) {

414 
	`´štf
("Can‚ot set HTBo class\n");

418 ià(
¿‹
) {

420 
	`¹Æ_htb_£t_¿‹
(
şass
, 
¿‹
);

422 ià(
û
) {

424 
	`¹Æ_htb_£t_û
(
şass
, 
û
);

427 ià(
bur¡
) {

428 
	`¹Æ_htb_£t_rbufãr
(
şass
, 
bur¡
);

430 ià(
cbur¡
) {

431 
	`¹Æ_htb_£t_cbufãr
(
şass
, 
cbur¡
);

435 ià((
”r
 = 
	`¹Æ_şass_add
(
sock
, 
şass
, 
NLM_F_CREATE
))) {

436 
	`´štf
("Can‚ot‡llocate HTB Qdisc\n");

439 
	`¹Æ_şass_put
(
şass
);

441 
	}
}

446 
	$qdisc_add_SFQ_Ëaf
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
,

447 
ušt32_t
 
·»ÁMaj
, ušt32_ˆ
·»ÁMš
,

448 
quªtum
, 
lim™
, 
³¹urb


451 
”r
;

452 
¹Æ_qdisc
 *
qdisc
;

454 ià(!(
qdisc
 = 
	`¹Æ_qdisc_®loc
())) {

455 
	`´štf
("Can‚ot‡llocate qdisc object\n");

458 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
qdisc
), 
¹ÆLšk
);

459 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
qdisc
), 
	`TC_HANDLE
(
·»ÁMaj
, 
·»ÁMš
));

461 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
qdisc
), 
	`TC_HANDLE
(
·»ÁMš
,0));

463 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
qdisc
), "sfq"))) {

464 
	`´štf
("Can‚ot set SQF class\n");

468 if(
quªtum
) {

469 
	`¹Æ_sfq_£t_quªtum
(
qdisc
, 
quªtum
);

471 
	`¹Æ_sfq_£t_quªtum
(
qdisc
, 16000);

473 if(
lim™
) {

474 
	`¹Æ_sfq_£t_lim™
(
qdisc
, 
lim™
);

476 if(
³¹urb
) {

477 
	`¹Æ_sfq_£t_³¹urb
(
qdisc
, 
³¹urb
);

481 ià((
”r
 = 
	`¹Æ_qdisc_add
(
sock
, 
qdisc
, 
NLM_F_CREATE
))) {

482 
	`´štf
("Can‚ot‡llocate SFQ qdisc\n");

487 
	`¹Æ_qdisc_put
(
qdisc
);

489 
	}
}

494 
	$maš
() {

496 
Æ_sock
 *
sock
;

497 
¹Æ_lšk
 *
lšk
;

503 
ušt32_t
 
ht
, 
hšk
, 
htid
, 
dœeùiÚ
, 
şassid
;

506 
chashlšk
[16]="";

511 
”r
;

515 
Æ_ÿche
 *
lšk_ÿche
;

517 ià(!(
sock
 = 
	`Æ_sock‘_®loc
())) {

518 
	`´štf
("Unableo‡llocate‚etlink socket\n");

519 
	`ex™
(1);

522 ià((
”r
 = 
	`Æ_cÚÃù
(
sock
, 
NETLINK_ROUTE
)) < 0 ) {

523 
	`´štf
("Nu s-a…utut conecta†a NETLINK!\n");

524 
	`Æ_sock‘_ä“
(
sock
);

525 
	`ex™
(1);

529 ià((
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sock
, 
AF_UNSPEC
, &
lšk_ÿche
)) < 0) {

530 
	`´štf
("Unableo‡llocate†ink cache: %s\n",

531 
	`Æ_g‘”rÜ
(
”r
));

532 
	`Æ_sock‘_ä“
(
sock
);

533 
	`ex™
(1);

537 ià(!(
lšk
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, "imq0"))) {

539 
	`´štf
("Interface‚ot found\n");

540 
	`Æ_sock‘_ä“
(
sock
);

541 
	`ex™
(1);

544 
”r
=
	`qdisc_add_HTB
(
sock
, 
lšk
, 0xffff);

548 
”r
=
	`şass_add_HTB_roÙ
(
sock
, 
lšk
, 12500000, 12500000, 25000, 25000);

549 
”r
=
	`şass_add_HTB
(
sock
, 
lšk
, 1, 0, 1, 0xffff, 1250000, 12500000, 25000, 25000, 5);

550 
”r
=
	`qdisc_add_SFQ_Ëaf
(
sock
, 
lšk
, 1, 0xffff, 16000, 0, 10);

551 
”r
=
	`şass_add_HTB
(
sock
, 
lšk
, 1, 1, 1, 0x5, 2000000, 2000000, 25000, 25000, 5);

552 
”r
=
	`qdisc_add_SFQ_Ëaf
(
sock
, 
lšk
, 1, 0x5, 16000, 0, 10);

553 
”r
=
	`şass_add_HTB
(
sock
, 
lšk
, 1, 1, 1, 0x6, 1000000, 1000000, 25000, 25000, 5);

554 
”r
=
	`qdisc_add_SFQ_Ëaf
(
sock
, 
lšk
, 1, 0x6, 16000, 0, 10);

579 
ušt32_t
 
i
;

580 
i
 = 1; i <= 0xf; i++)

581 
	`u32_add_ht
(
sock
, 
lšk
, 1, 
i
, 256);

598 
dœeùiÚ
 = 16;

610 
	`¡rıy
(
chashlšk
, "1:");

613 
hšk
 = 0x0;

615 if(
	`g‘_u32_hªdË
(&
hšk
, 
chashlšk
)) {

616 
	`´štf
 ("Illegal \"link\"");

617 
	`Æ_sock‘_ä“
(
sock
);

618 
	`ex™
(1);

623 ià(
hšk
 && 
	`TC_U32_NODE
(htlink)) {

624 
	`´štf
("\"link\" must be‡ hashable.\n");

625 
	`Æ_sock‘_ä“
(
sock
);

626 
	`ex™
(1);

646 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

647 0x0, 0x0, 
dœeùiÚ
, 0,

648 0, 
hšk
, 0xff000000, 
dœeùiÚ
);

679 
ht
=
	`g‘_u32_·r£_hªdË
("1:a:");

680 
htid
 = (
ht
&0xFFFFF000);

681 
hšk
=
	`g‘_u32_·r£_hªdË
("2:");

683 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

684 0x0a000000, 0xff000000, 
dœeùiÚ
, 0,

685 
htid
, 
hšk
, 0x00ff0000, 
dœeùiÚ
);

688 
ht
=
	`g‘_u32_·r£_hªdË
("1:ac:");

689 
htid
 = (
ht
&0xFFFFF000);

690 
hšk
=
	`g‘_u32_·r£_hªdË
("3:");

692 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

693 0xac000000, 0xff000000, 
dœeùiÚ
, 0,

694 
htid
, 
hšk
, 0x00ff0000, 
dœeùiÚ
);

699 
ht
=
	`g‘_u32_·r£_hªdË
("2:0:");

700 
htid
 = (
ht
&0xFFFFF000);

701 
hšk
=
	`g‘_u32_·r£_hªdË
("4:");

703 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

704 0x0a000000, 0xffff0000, 
dœeùiÚ
, 0,

705 
htid
, 
hšk
, 0x0000ff00, 
dœeùiÚ
);

708 
ht
=
	`g‘_u32_·r£_hªdË
("3:11:");

709 
htid
 = (
ht
&0xFFFFF000);

710 
hšk
=
	`g‘_u32_·r£_hªdË
("5:");

712 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

713 0xac110000, 0xffff0000, 
dœeùiÚ
, 0,

714 
htid
, 
hšk
, 0x0000ff00, 
dœeùiÚ
);

718 
ht
=
	`g‘_u32_·r£_hªdË
("4:9:");

719 
htid
 = (
ht
&0xFFFFF000);

720 
hšk
=
	`g‘_u32_·r£_hªdË
("6:");

722 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

723 0x0a000900, 0xffffff00, 
dœeùiÚ
, 0,

724 
htid
, 
hšk
, 0x000000ff, 
dœeùiÚ
);

727 
ht
=
	`g‘_u32_·r£_hªdË
("5:2:");

728 
htid
 = (
ht
&0xFFFFF000);

729 
hšk
=
	`g‘_u32_·r£_hªdË
("7:");

731 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

732 0xac110200, 0xffffff00, 
dœeùiÚ
, 0,

733 
htid
, 
hšk
, 0x000000ff, 
dœeùiÚ
);

738 
ht
=
	`g‘_u32_·r£_hªdË
("6:14:");

739 
htid
 = (
ht
&0xFFFFF000);

741 
”r
 = 
	`g‘_tc_şassid
(&
şassid
, "1:5");

743 
	`u32_add_f‹r_Ú_ht
(
sock
, 
lšk
, 1,

744 0x0a000914, 0xffffffff, 
dœeùiÚ
, 0,

745 
htid
, 
şassid
);

748 
ht
=
	`g‘_u32_·r£_hªdË
("7:78:");

749 
htid
 = (
ht
&0xFFFFF000);

751 
”r
 = 
	`g‘_tc_şassid
(&
şassid
, "1:6");

753 
	`u32_add_f‹r_Ú_ht
(
sock
, 
lšk
, 1,

754 0xac110278, 0xffffffff, 
dœeùiÚ
, 0,

755 
htid
, 
şassid
);

759 
	`Æ_sock‘_ä“
(
sock
);

761 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-bond.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

3 
	~<Ãšk/rou‹/lšk/bÚdšg.h
>

5 
	$maš
(
¬gc
, *
¬gv
[])

7 
¹Æ_lšk
 *
lšk
;

8 
Æ_sock
 *
sk
;

9 
”r
;

11 
sk
 = 
	`Æ_sock‘_®loc
();

12 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

13 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

14  
”r
;

17 
lšk
 = 
	`¹Æ_lšk_bÚd_®loc
();

18 
	`¹Æ_lšk_£t_Çme
(
lšk
, "my_bond");

20 ià((
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
)) < 0) {

21 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

22  
”r
;

25 
	`¹Æ_lšk_put
(
lšk
);

26 
	`Æ_şo£
(
sk
);

29 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-bridge.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

3 
	~<Ãšk/rou‹/lšk/bridge.h
>

5 
	#TEST_BRIDGE_NAME
 "‹¡bridge"

	)

6 
	#TEST_INTERFACE_NAME
 "‹¡p1"

	)

8 
	$ü—‹_bridge
(
Æ_sock
 *
sk
, 
Æ_ÿche
 *
lšk_ÿche
, cÚ¡ *
Çme
) {

9 
¹Æ_lšk
 *
lšk
;

10 
”r
;

12 
lšk
 = 
	`¹Æ_lšk_®loc
();

13 ià((
”r
 = 
	`¹Æ_lšk_£t_ty³
(
lšk
, "bridge")) < 0) {

14 
	`¹Æ_lšk_put
(
lšk
);

15  
”r
;

17 
	`¹Æ_lšk_£t_Çme
(
lšk
, 
Çme
);

19 ià((
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
)) < 0) {

20  
”r
;

22 
	`¹Æ_lšk_put
(
lšk
);

25 
	}
}

27 
	$maš
(
¬gc
, *
¬gv
[])

29 
¹Æ_lšk
 *
lšk
;

30 
Æ_ÿche
 *
lšk_ÿche
;

31 
Æ_sock
 *
sk
;

32 
”r
;

34 
sk
 = 
	`Æ_sock‘_®loc
();

35 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

36 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

37  
”r
;

40 ià((
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
)) < 0) {

41 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

42  
”r
;

45 ià((
”r
 = 
	`ü—‹_bridge
(
sk
, 
lšk_ÿche
, 
TEST_BRIDGE_NAME
)) < 0) {

46 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocateestbridge");

47  
”r
;

50 
	`Æ_ÿche_»fl
(
sk
, 
lšk_ÿche
);

52 
lšk
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
TEST_BRIDGE_NAME
);

53 
¹Æ_lšk
 *
É­
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, 
TEST_INTERFACE_NAME
);

54 ià(!
É­
) {

55 
	`årštf
(
¡d”r
, "You should c»©¨°š‹rçû befÜlunchhi ‹¡ (#unùÈ-ˆ%s)\n", 
TEST_INTERFACE_NAME
);

59 ià((
”r
 = 
	`¹Æ_lšk_’¦ave
(
sk
, 
lšk
, 
É­
)) < 0) {

60 
	`Æ_³¼Ü
(
”r
, "Unableoƒnslave interfaceo his bridge\n");

61  
”r
;

64 if(
	`¹Æ_lšk_is_bridge
(
lšk
) == 0) {

65 
	`årštf
(
¡d”r
, "Link is‚ot‡ bridge\n");

68 if(
	`¹Æ_lšk_g‘_ma¡”
(
É­
) <= 0) {

69 
	`årštf
(
¡d”r
, "Interface is‚ot‡ttachedo‡ bridge\n");

73 
	`¹Æ_lšk_put
(
É­
);

74 
	`¹Æ_lšk_put
(
lšk
);

76 
	`Æ_ÿche_ä“
(
lšk_ÿche
);

77 
	`Æ_sock‘_ä“
(
sk
);

80 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-ip6tnl.c

1 
	~<Ãšk/rou‹/lšk/6Šl.h
>

2 
	~<Ãšk-´iv©e/Ãšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_ÿche
 *
lšk_ÿche
;

7 
¹Æ_lšk
 *
lšk
;

8 
š6_addr
 
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
if_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
);

19 iàĞ
”r
 < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

21  
”r
;

24 
if_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "ens33");

25 ià(!
if_šdex
) {

26 
	`årštf
(
¡d”r
, "Unableo†ookupƒns33");

30 
lšk
 = 
	`¹Æ_lšk_6_Šl_®loc
();

31 if(!
lšk
) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate†ink");

36 
	`¹Æ_lšk_£t_Çme
(
lšk
, "ip6tnl-tun");

37 
	`¹Æ_lšk_6_Šl_£t_lšk
(
lšk
, 
if_šdex
);

39 
	`š‘_±Ú
(
AF_INET6
, "2607:f0d0:1002:51::4", &
addr
);

40 
	`¹Æ_lšk_6_Šl_£t_loÿl
(
lšk
, &
addr
);

42 
	`š‘_±Ú
(
AF_INET6
, "2607:f0d0:1002:52::5", &
addr
);

43 
	`¹Æ_lšk_6_Šl_£t_»mÙe
(
lšk
, &
addr
);

45 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

46 ià(
”r
 < 0) {

47 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

48  
”r
;

51 
	`¹Æ_lšk_put
(
lšk
);

52 
	`Æ_şo£
(
sk
);

55 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-ipgre.c

1 
	~<Ãšk/rou‹/lšk/g».h
>

2 
	~<Ãšk-´iv©e/Ãšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_ÿche
 *
lšk_ÿche
;

7 
¹Æ_lšk
 *
lšk
;

8 
š_addr
 
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
if_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
);

19 iàĞ
”r
 < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

21  
”r
;

24 
if_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "eno16777736");

25 ià(!
if_šdex
) {

26 
	`årštf
(
¡d”r
, "Unableo†ookupƒno16777736");

30 
lšk
 = 
	`¹Æ_lšk_g»_®loc
();

31 if(!
lšk
) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate†ink");

36 
	`¹Æ_lšk_£t_Çme
(
lšk
, "ipgre-tun");

37 
	`¹Æ_lšk_g»_£t_lšk
(
lšk
, 
if_šdex
);

39 
	`š‘_±Ú
(
AF_INET
, "192.168.254.12", &
addr
.
s_addr
);

40 
	`¹Æ_lšk_g»_£t_loÿl
(
lšk
, 
addr
.
s_addr
);

42 
	`š‘_±Ú
(
AF_INET
, "192.168.254.13", &
addr
.
s_addr
);

43 
	`¹Æ_lšk_g»_£t_»mÙe
(
lšk
, 
addr
.
s_addr
);

45 
	`¹Æ_lšk_g»_£t_‰l
(
lšk
, 64);

46 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

47 ià(
”r
 < 0) {

48 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

49  
”r
;

52 
	`¹Æ_lšk_put
(
lšk
);

53 
	`Æ_şo£
(
sk
);

56 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-ipip.c

1 
	~<Ãšk/rou‹/lšk/.h
>

2 
	~<Ãšk-´iv©e/Ãšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_ÿche
 *
lšk_ÿche
;

7 
¹Æ_lšk
 *
lšk
;

8 
š_addr
 
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
if_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
);

19 iàĞ
”r
 < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

21  
”r
;

24 
if_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "eno16777736");

25 ià(!
if_šdex
) {

26 
	`årštf
(
¡d”r
, "Unableo†ookupƒno16777736");

30 
lšk
 = 
	`¹Æ_lšk__®loc
();

31 if(!
lšk
) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate†ink");

36 
	`¹Æ_lšk_£t_Çme
(
lšk
, "ipip-tun");

37 
	`¹Æ_lšk__£t_lšk
(
lšk
, 
if_šdex
);

39 
	`š‘_±Ú
(
AF_INET
, "192.168.254.12", &
addr
.
s_addr
);

40 
	`¹Æ_lšk__£t_loÿl
(
lšk
, 
addr
.
s_addr
);

42 
	`š‘_±Ú
(
AF_INET
, "192.168.254.13", &
addr
.
s_addr
);

43 
	`¹Æ_lšk__£t_»mÙe
(
lšk
, 
addr
.
s_addr
);

45 
	`¹Æ_lšk__£t_‰l
(
lšk
, 64);

46 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

47 ià(
”r
 < 0) {

48 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

49  
”r
;

52 
	`¹Æ_lšk_put
(
lšk
);

53 
	`Æ_şo£
(
sk
);

56 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-ipvti.c

1 
	~<Ãšk/rou‹/lšk/vti.h
>

2 
	~<Ãšk-´iv©e/Ãšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_ÿche
 *
lšk_ÿche
;

7 
¹Æ_lšk
 *
lšk
;

8 
š_addr
 
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
if_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
);

19 iàĞ
”r
 < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

21  
”r
;

24 
if_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "ens33");

25 ià(!
if_šdex
) {

26 
	`årštf
(
¡d”r
, "Unableo†ookupƒns33");

30 
lšk
 = 
	`¹Æ_lšk_vti_®loc
();

31 if(!
lšk
) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate†ink");

36 
	`¹Æ_lšk_£t_Çme
(
lšk
, "ipvti-tun");

37 
	`¹Æ_lšk_vti_£t_lšk
(
lšk
, 
if_šdex
);

39 
	`š‘_±Ú
(
AF_INET
, "192.168.254.12", &
addr
.
s_addr
);

40 
	`¹Æ_lšk_vti_£t_loÿl
(
lšk
, 
addr
.
s_addr
);

42 
	`š‘_±Ú
(
AF_INET
, "192.168.254.13", &
addr
.
s_addr
);

43 
	`¹Æ_lšk_vti_£t_»mÙe
(
lšk
, 
addr
.
s_addr
);

45 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

46 ià(
”r
 < 0) {

47 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

48  
”r
;

51 
	`¹Æ_lšk_put
(
lšk
);

52 
	`Æ_şo£
(
sk
);

55 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-sit.c

1 
	~<Ãšk/rou‹/lšk/s™.h
>

2 
	~<Ãšk-´iv©e/Ãšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_ÿche
 *
lšk_ÿche
;

7 
¹Æ_lšk
 *
lšk
;

8 
š_addr
 
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
if_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
);

19 iàĞ
”r
 < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

21  
”r
;

24 
if_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "eno16777736");

25 ià(!
if_šdex
) {

26 
	`årštf
(
¡d”r
, "Unableo†ookupƒno16777736");

30 
lšk
 = 
	`¹Æ_lšk_s™_®loc
();

31 if(!
lšk
) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate†ink");

36 
	`¹Æ_lšk_£t_Çme
(
lšk
, "sit-tun");

37 
	`¹Æ_lšk_s™_£t_lšk
(
lšk
, 
if_šdex
);

39 
	`š‘_±Ú
(
AF_INET
, "192.168.254.12", &
addr
.
s_addr
);

40 
	`¹Æ_lšk_s™_£t_loÿl
(
lšk
, 
addr
.
s_addr
);

42 
	`š‘_±Ú
(
AF_INET
, "192.168.254.13", &
addr
.
s_addr
);

43 
	`¹Æ_lšk_s™_£t_»mÙe
(
lšk
, 
addr
.
s_addr
);

45 
	`¹Æ_lšk_s™_£t_‰l
(
lšk
, 64);

46 
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
);

47 ià(
”r
 < 0) {

48 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

49  
”r
;

52 
	`¹Æ_lšk_put
(
lšk
);

53 
	`Æ_şo£
(
sk
);

56 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-veth.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

3 
	~<Ãšk/rou‹/lšk/v‘h.h
>

5 
	$maš
(
¬gc
, *
¬gv
[])

7 
¹Æ_lšk
 *
lšk
;

8 
Æ_sock
 *
sk
;

9 
”r
;

10 
¹Æ_lšk
 *
³”
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

19 
	`¹Æ_lšk_v‘h_add
(
sk
, "v‘h2", "v‘h3", 
	`g‘pid
());

21 
lšk
 = 
	`¹Æ_lšk_v‘h_®loc
();

22 ià(!
lšk
) {

23 
	`Æ_³¼Ü
(
”r
, "Unableo‡lloc†ink");

24  
”r
;

27 
	`¹Æ_lšk_£t_Çme
(
lšk
, "veth8");

28 
³”
 = 
	`¹Æ_lšk_v‘h_g‘_³”
(
lšk
);

29 
	`¹Æ_lšk_£t_Çme
(
³”
, "veth9");

31 ià((
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
)) < 0) {

32 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

33  
”r
;

35 
	`´štf
("³” i %s\n", 
	`¹Æ_lšk_g‘_Çme
(
³”
));

36 
	`¹Æ_lšk_put
(
³”
);

37 
	`¹Æ_lšk_put
(
lšk
);

39 
	`Æ_şo£
(
sk
);

42 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-vlan.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

3 
	~<Ãšk/rou‹/lšk/vÏn.h
>

5 
	$maš
(
¬gc
, *
¬gv
[])

7 
¹Æ_lšk
 *
lšk
;

8 
Æ_ÿche
 *
lšk_ÿche
;

9 
Æ_sock
 *
sk
;

10 
”r
, 
ma¡”_šdex
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 ià((
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sk
, 
AF_UNSPEC
, &
lšk_ÿche
)) < 0) {

19 
	`Æ_³¼Ü
(
”r
, "Unableo‡llocate cache");

20  
”r
;

23 ià(!(
ma¡”_šdex
 = 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "eth0"))) {

24 
	`årštf
(
¡d”r
, "Unableo†ookupƒth0");

28 
lšk
 = 
	`¹Æ_lšk_vÏn_®loc
();

30 
	`¹Æ_lšk_£t_lšk
(
lšk
, 
ma¡”_šdex
);

32 
	`¹Æ_lšk_vÏn_£t_id
(
lšk
, 10);

34 ià((
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
)) < 0) {

35 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

36  
”r
;

39 
	`¹Æ_lšk_put
(
lšk
);

40 
	`Æ_şo£
(
sk
);

43 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-create-vxlan.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

3 
	~<Ãšk/rou‹/lšk/vxÏn.h
>

5 
	$maš
(
¬gc
, *
¬gv
[])

7 
¹Æ_lšk
 *
lšk
;

8 
Æ_addr
 *
addr
;

9 
Æ_sock
 *
sk
;

10 
”r
;

12 
sk
 = 
	`Æ_sock‘_®loc
();

13 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

14 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

15  
”r
;

18 
lšk
 = 
	`¹Æ_lšk_vxÏn_®loc
();

20 
	`¹Æ_lšk_£t_Çme
(
lšk
, "vxlan128");

22 ià((
”r
 = 
	`¹Æ_lšk_vxÏn_£t_id
(
lšk
, 128)) < 0) {

23 
	`Æ_³¼Ü
(
”r
, "Unableo set VXLAN‚etwork identifier");

24  
”r
;

27 ià((
”r
 = 
	`Æ_addr_·r£
("239.0.0.1", 
AF_INET
, &
addr
)) < 0) {

28 
	`Æ_³¼Ü
(
”r
, "Unableo…arse IP‡ddress");

29  
”r
;

32 ià((
”r
 = 
	`¹Æ_lšk_vxÏn_£t_group
(
lšk
, 
addr
)) < 0) {

33 
	`Æ_³¼Ü
(
”r
, "Unableo set multicast IP‡ddress");

34  
”r
;

36 
	`Æ_addr_put
(
addr
);

38 ià((
”r
 = 
	`¹Æ_lšk_add
(
sk
, 
lšk
, 
NLM_F_CREATE
)) < 0) {

39 
	`Æ_³¼Ü
(
”r
, "Unableo‡dd†ink");

40  
”r
;

43 
	`¹Æ_lšk_put
(
lšk
);

44 
	`Æ_şo£
(
sk
);

47 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-delete-link.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<Ãšk/rou‹/lšk.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
¹Æ_lšk
 *
lšk
;

7 
Æ_sock
 *
sk
;

8 
”r
;

10 
sk
 = 
	`Æ_sock‘_®loc
();

11 ià((
”r
 = 
	`Æ_cÚÃù
(
sk
, 
NETLINK_ROUTE
)) < 0) {

12 
	`Æ_³¼Ü
(
”r
, "Unableo connect socket");

13  
”r
;

16 
lšk
 = 
	`¹Æ_lšk_®loc
();

17 
	`¹Æ_lšk_£t_Çme
(
lšk
, "my_bond");

19 ià((
”r
 = 
	`¹Æ_lšk_d–‘e
(
sk
, 
lšk
)) < 0) {

20 
	`Æ_³¼Ü
(
”r
, "Unableo delete†ink");

21  
”r
;

24 
	`¹Æ_lšk_put
(
lšk
);

25 
	`Æ_şo£
(
sk
);

28 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-genl.c

1 
	~<Ãšk/şi/uts.h
>

2 
	~<lšux/sk¡©s.h
>

4 
Æa_pŞicy
 
	g©Œ_pŞicy
[
TASKSTATS_TYPE_MAX
+1] = {

5 [
TASKSTATS_TYPE_PID
] = { .
ty³
 = 
NLA_U32
 },

6 [
TASKSTATS_TYPE_TGID
] = { .
ty³
 = 
NLA_U32
 },

7 [
TASKSTATS_TYPE_STATS
] = { .
mšËn
 = (
sk¡©s
) },

8 [
TASKSTATS_TYPE_AGGR_PID
] = { .
ty³
 = 
NLA_NESTED
 },

9 [
TASKSTATS_TYPE_AGGR_TGID
] = { .
ty³
 = 
NLA_NESTED
 },

13 
	$·r£_cmd_Ãw
(
Æ_ÿche_İs
 *
unu£d
, 
g’l_cmd
 *
cmd
,

14 
g’l_šfo
 *
šfo
, *
¬g
)

16 
Æ©Œ
 *
©Œs
[
TASKSTATS_TYPE_MAX
+1];

17 
Æ©Œ
 *
Ã¡ed
;

18 
”r
;

20 ià(
šfo
->
©Œs
[
TASKSTATS_TYPE_AGGR_PID
])

21 
Ã¡ed
 = 
šfo
->
©Œs
[
TASKSTATS_TYPE_AGGR_PID
];

22 ià(
šfo
->
©Œs
[
TASKSTATS_TYPE_AGGR_TGID
])

23 
Ã¡ed
 = 
šfo
->
©Œs
[
TASKSTATS_TYPE_AGGR_TGID
];

25 
	`årštf
(
¡d”r
, "Invalidaskstats message: Unableo find "

27  
NL_SKIP
;

30 
”r
 = 
	`Æa_·r£_Ã¡ed
(
©Œs
, 
TASKSTATS_TYPE_MAX
, 
Ã¡ed
, 
©Œ_pŞicy
);

31 ià(
”r
 < 0) {

32 
	`Æ_³¼Ü
(
”r
, "Error while…arsing generic‚etlink message");

33  
”r
;

37 ià(
©Œs
[
TASKSTATS_TYPE_STATS
]) {

38 
sk¡©s
 *
¡©s
 = 
	`Æa_d©a
(
©Œs
[
TASKSTATS_TYPE_STATS
]);

40 
	`´štf
("%s…id %u uid %u gid %u…arent %u\n",

41 
¡©s
->
ac_comm
, sts->
ac_pid
, sts->
ac_uid
,

42 
¡©s
->
ac_gid
, sts->
ac_µid
);

46 
	}
}

48 
	$·r£_cb
(
Æ_msg
 *
msg
, *
¬g
)

50  
	`g’l_hªdË_msg
(
msg
, 
NULL
);

51 
	}
}

53 
g’l_cmd
 
	gcmds
[] = {

55 .
c_id
 = 
TASKSTATS_CMD_NEW
,

56 .
	gc_Çme
 = "taskstats_new()",

57 .
	gc_max©Œ
 = 
TASKSTATS_TYPE_MAX
,

58 .
	gc_©Œ_pŞicy
 = 
©Œ_pŞicy
,

59 .
	gc_msg_·r£r
 = &
·r£_cmd_Ãw
,

63 
	#ARRAY_SIZE
(
X
è((Xè/ ((X)[0]))

	)

65 
g’l_İs
 
	gİs
 = {

66 .
o_Çme
 = 
TASKSTATS_GENL_NAME
,

67 .
	go_cmds
 = 
cmds
,

68 .
	go_ncmds
 = 
ARRAY_SIZE
(
cmds
),

71 
	$maš
(
¬gc
, *
¬gv
[])

73 
Æ_sock
 *
sock
;

74 
Æ_msg
 *
msg
;

75 *
hdr
;

76 
”r
;

78 
sock
 = 
	`Æ_şi_®loc_sock‘
();

79 
	`Æ_şi_cÚÃù
(
sock
, 
NETLINK_GENERIC
);

81 ià((
”r
 = 
	`g’l_»gi¡”_çmy
(&
İs
)) < 0)

82 
	`Æ_şi_çl
(
”r
, "Unableo„egister Generic Netlink family");

84 ià((
”r
 = 
	`g’l_İs_»sŞve
(
sock
, &
İs
)) < 0)

85 
	`Æ_şi_çl
(
”r
, "Unableo„esolve family‚ame");

87 ià(
	`g’l_ù¾_»sŞve
(
sock
, "Æù¾"è!ğ
GENL_ID_CTRL
)

88 
	`Æ_şi_çl
(
NLE_INVAL
, "Resolving of \"nlctrl\" failed");

90 
msg
 = 
	`Æmsg_®loc
();

91 ià(
msg
 =ğ
NULL
)

92 
	`Æ_şi_çl
(
NLE_NOMEM
, "Unableo‡llocate‚etlink message");

94 
hdr
 = 
	`g’lmsg_put
(
msg
, 
NL_AUTO_PORT
, 
NL_AUTO_SEQ
, 
İs
.
o_id
,

95 0, 0, 
TASKSTATS_CMD_GET
, 
TASKSTATS_GENL_VERSION
);

96 ià(
hdr
 =ğ
NULL
)

97 
	`Æ_şi_çl
(
ENOMEM
, "Unableo write genl header");

99 ià((
”r
 = 
	`Æa_put_u32
(
msg
, 
TASKSTATS_CMD_ATTR_PID
, 1)) < 0)

100 
	`Æ_şi_çl
(
”r
, "UÇbËØadd‡‰ribu‹: %s", 
	`Æ_g‘”rÜ
(err));

102 ià((
”r
 = 
	`Æ_£nd_auto_com¶‘e
(
sock
, 
msg
)) < 0)

103 
	`Æ_şi_çl
(
”r
, "UÇbËØ£nd mes§ge: %s", 
	`Æ_g‘”rÜ
(err));

105 
	`Æmsg_ä“
(
msg
);

107 ià((
”r
 = 
	`Æ_sock‘_modify_cb
(
sock
, 
NL_CB_VALID
, 
NL_CB_CUSTOM
,

108 
·r£_cb
, 
NULL
)) < 0)

109 
	`Æ_şi_çl
(
”r
, "Unableo modify valid message callback");

111 ià((
”r
 = 
	`Æ_»cvmsgs_deçuÉ
(
sock
)) < 0)

112 
	`Æ_şi_çl
(
”r
, "UÇbËØ»ûivmes§ge: %s", 
	`Æ_g‘”rÜ
(err));

114 
	`Æ_şo£
(
sock
);

115 
	`Æ_sock‘_ä“
(
sock
);

118 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-nf-cache-mngr.c

1 
	~<Ãšk/şi/uts.h
>

3 
	$chªge_cb
(
Æ_ÿche
 *
ÿche
, 
Æ_objeù
 *
obj
,

4 
aùiÚ
, *
d©a
)

6 
nâl_ù
 *
ù
 = (nâl_ù *è
obj
;

7 
Æ_addr
 *
hack
 = 
NULL
;

9 ià(!
hack
)

10 
	`Æ_addr_·r£
("194.88.212.233", 
AF_INET
, &
hack
);

12 ià(!
	`Æ_addr_cmp
(
hack
, 
	`nâl_ù_g‘_¤c
(
ù
, 1)) ||

13 !
	`Æ_addr_cmp
(
hack
, 
	`nâl_ù_g‘_d¡
(
ù
, 1))) {

14 
Æ_dump_·¿ms
 
dp
 = {

15 .
dp_ty³
 = 
NL_DUMP_LINE
,

16 .
dp_fd
 = 
¡dout
,

19 
	`´štf
("UPDATE ");

20 
	`Æ_objeù_dump
(
obj
, &
dp
);

22 
	}
}

24 
	$maš
(
¬gc
, *
¬gv
[])

26 
Æ_ÿche_mngr
 *
mngr
;

27 
Æ_sock
 *
sock
;

28 
Æ_ÿche
 *
ù
;

29 
”r
;

31 
sock
 = 
	`Æ_şi_®loc_sock‘
();

33 
”r
 = 
	`Æ_ÿche_mngr_®loc
(
sock
, 
NETLINK_NETFILTER
, 
NL_AUTO_PROVIDE
, &
mngr
);

34 ià(
”r
 < 0) {

35 
	`Æ_³¼Ü
(
”r
, "nl_cache_mngr_alloc");

39 
”r
 = 
	`Æ_ÿche_mngr_add
(
mngr
, "Ãtf‹r/ù", &
chªge_cb
, 
NULL
, &
ù
);

40 ià(
”r
 < 0) {

41 
	`Æ_³¼Ü
(
”r
, "nl_cache_mngr_add(netfilter/ct)");

46 
”r
 = 
	`Æ_ÿche_mngr_pŞl
(
mngr
, 5000);

47 ià(
”r
 < 0) {

48 
	`Æ_³¼Ü
(
”r
, "nl_cache_mngr_poll()");

54 
	`Æ_ÿche_mngr_ä“
(
mngr
);

57 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-socket-creation.c

1 
	~<Ãšk/Ãšk.h
>

2 
	~<”ºo.h
>

4 
	$maš
(
¬gc
, *
¬gv
[])

6 
Æ_sock
 *
h
[1025];

7 
i
;

9 
h
[0] = 
	`Æ_sock‘_®loc
();

10 
	`´štf
("Created handle with…ort 0x%x\n",

11 
	`Æ_sock‘_g‘_loÿl_pÜt
(
h
[0]));

12 
	`Æ_sock‘_ä“
(
h
[0]);

13 
h
[0] = 
	`Æ_sock‘_®loc
();

14 
	`´štf
("Created handle with…ort 0x%x\n",

15 
	`Æ_sock‘_g‘_loÿl_pÜt
(
h
[0]));

16 
	`Æ_sock‘_ä“
(
h
[0]);

18 
i
 = 0; i < 1025; i++) {

19 
h
[
i
] = 
	`Æ_sock‘_®loc
();

20 ià(
h
[
i
] =ğ
NULL
)

21 
	`Æ_³¼Ü
(
ENOMEM
, "Unableo‡llocate socket");

23 
	`´štf
("Created handle with…ort 0x%x\n",

24 
	`Æ_sock‘_g‘_loÿl_pÜt
(
h
[
i
]));

28 
	}
}

	@mylibnl/libnl-3.2.25/tests/test-u32-filter-with-actions.c

14 
	~<Ãšk/rou‹/lšk.h
>

15 
	~<Ãšk/rou‹/tc.h
>

16 
	~<Ãšk/rou‹/qdisc.h
>

17 
	~<Ãšk/rou‹/şs/u32.h
>

18 
	~<Ãšk/rou‹/şassif›r.h
>

19 
	~<Ãšk/rou‹/aùiÚ.h
>

20 
	~<Ãšk/rou‹/aù/mœ»d.h
>

21 
	~<Ãšk/rou‹/şass.h
>

22 
	~<lšux/if_‘h”.h
>

24 
	~<Ãšk/©Œ.h
>

25 
	~<¡dio.h
>

26 
	~<¡ršg.h
>

28 
	#TC_HANDLE
(
maj
, 
mš
è(
	`TC_H_MAJ
((majè<< 16è| 
	`TC_H_MIN
(mš))

	)

31 
	$g‘_u32
(
__u32
 *
v®
, cÚ¡ *
¬g
, 
ba£
)

33 
»s
;

34 *
±r
;

36 ià(!
¬g
 || !*arg)

38 
»s
 = 
	`¡¹oul
(
¬g
, &
±r
, 
ba£
);

39 ià(!
±r
 ||…Œ =ğ
¬g
 || *±¸|| 
»s
 > 0xFFFFFFFFUL)

41 *
v®
 = 
»s
;

43 
	}
}

45 
	$g‘_u32_hªdË
(
__u32
 *
hªdË
, cÚ¡ *
¡r
)

47 
__u32
 
htid
=0, 
hash
=0, 
nodeid
=0;

48 *
tmp
 = 
	`¡rchr
(
¡r
, ':');

50 ià(
tmp
 =ğ
NULL
) {

51 ià(
	`memcmp
("0x", 
¡r
, 2) == 0)

52  
	`g‘_u32
(
hªdË
, 
¡r
, 16);

55 
htid
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

56 ià(
tmp
 =ğ
¡r
 && *str != ':' && *str != 0)

58 ià(
htid
>=0x1000)

60 ià(*
tmp
) {

61 
¡r
 = 
tmp
+1;

62 
hash
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

63 ià(
tmp
 =ğ
¡r
 && *str != ':' && *str != 0)

65 ià(
hash
>=0x100)

67 ià(*
tmp
) {

68 
¡r
 = 
tmp
+1;

69 
nodeid
 = 
	`¡¹oul
(
¡r
, &
tmp
, 16);

70 ià(
tmp
 =ğ
¡r
 && *str != 0)

72 ià(
nodeid
>=0x1000)

76 *
hªdË
 = (
htid
<<20)|(
hash
<<12)|
nodeid
;

78 
	}
}

80 
ušt32_t
 
	$g‘_u32_·r£_hªdË
(cÚ¡ *
cHªdË
)

82 
ušt32_t
 
hªdË
=0;

84 if(
	`g‘_u32_hªdË
(&
hªdË
, 
cHªdË
)) {

85 
	`´štf
 ("Illegal \"ht\"\n");

89 ià(
hªdË
 && 
	`TC_U32_NODE
(handle)) {

90 
	`´štf
("\"link\" must be‡ hashable.\n");

93  
hªdË
;

94 
	}
}

102 
	$u32_add_f‹r_Ú_ht_w™h_hashmask
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
´io
,

103 
ušt32_t
 
keyv®
, ušt32_ˆ
keymask
, 
keyoff
, 
keyoffmask
,

104 
ušt32_t
 
htid
, ušt32_ˆ
hšk
, ušt32_ˆ
hmask
, ušt32_ˆ
hoff£t
, 
¹Æ_aù
 *
aù
)

106 
¹Æ_şs
 *
şs
;

107 
”r
;

109 
şs
=
	`¹Æ_şs_®loc
();

110 ià(!(
şs
)) {

111 
	`´štf
("Can‚ot‡llocate classifier\n");

112 
	`Æ_sock‘_ä“
(
sock
);

113 
	`ex™
(1);

116 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şs
), 
¹ÆLšk
);

118 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şs
), "u32"))) {

119 
	`´štf
("Can‚ot set classifier‡s u32\n");

123 
	`¹Æ_şs_£t_´io
(
şs
, 
´io
);

124 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
ETH_P_IP
);

126 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şs
), 
	`TC_HANDLE
(0xffff, 0));

128 ià(
htid
)

129 
	`¹Æ_u32_£t_hashbË
(
şs
, 
htid
);

131 
	`¹Æ_u32_add_key_ušt32
(
şs
, 
keyv®
, 
keymask
, 
keyoff
, 
keyoffmask
);

133 
	`¹Æ_u32_£t_hashmask
(
şs
, 
hmask
, 
hoff£t
);

135 
	`¹Æ_u32_£t_lšk
(
şs
, 
hšk
);

137 
	`¹Æ_u32_add_aùiÚ
(
şs
, 
aù
);

140 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
NLM_F_CREATE
))) {

141 
	`´štf
("Cª‚Ù‡dd cÏssif›r: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

144 
	`¹Æ_şs_put
(
şs
);

146 
	}
}

152 
	$u32_add_ht
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
, 
ušt32_t
 
´io
, ušt32_ˆ
htid
, ušt32_ˆ
divisÜ
)

155 
”r
;

156 
¹Æ_şs
 *
şs
;

158 
şs
=
	`¹Æ_şs_®loc
();

159 ià(!(
şs
)) {

160 
	`´štf
("Can‚ot‡llocate classifier\n");

161 
	`Æ_sock‘_ä“
(
sock
);

162 
	`ex™
(1);

165 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
şs
), 
¹ÆLšk
);

167 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
şs
), "u32"))) {

168 
	`´štf
("Can‚ot set classifier‡s u32\n");

172 
	`¹Æ_şs_£t_´io
(
şs
, 
´io
);

173 
	`¹Æ_şs_£t_´ÙocŞ
(
şs
, 
ETH_P_IP
);

174 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
şs
), 
	`TC_HANDLE
(0xffff, 0));

176 
	`¹Æ_u32_£t_hªdË
(
şs
, 
htid
, 0x0, 0x0);

178 
	`¹Æ_u32_£t_divisÜ
(
şs
, 
divisÜ
);

180 ià((
”r
 = 
	`¹Æ_şs_add
(
sock
, 
şs
, 
NLM_F_CREATE
))) {

181 
	`´štf
("Cª‚Ù‡dd cÏssif›r: %s\n", 
	`Æ_g‘”rÜ
(
”r
));

184 
	`¹Æ_şs_put
(
şs
);

186 
	}
}

192 
	$qdisc_add_šg»ss
(
Æ_sock
 *
sock
, 
¹Æ_lšk
 *
¹ÆLšk
)

195 
¹Æ_qdisc
 *
qdisc
;

196 
”r
;

199 ià(!(
qdisc
 = 
	`¹Æ_qdisc_®loc
())) {

200 
	`´štf
("Can‚ot‡llocate Qdisc\n");

205 
	`¹Æ_tc_£t_lšk
(
	`TC_CAST
(
qdisc
), 
¹ÆLšk
);

206 
	`¹Æ_tc_£t_·»Á
(
	`TC_CAST
(
qdisc
), 
TC_H_ROOT
);

209 
	`¹Æ_qdisc_d–‘e
(
sock
, 
qdisc
);

212 
	`¹Æ_tc_£t_hªdË
(
	`TC_CAST
(
qdisc
), 
	`TC_HANDLE
(0xffff, 0));

214 ià((
”r
 = 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
qdisc
), "ingress"))) {

215 
	`´štf
("Can‚ot‡llocate ingress\n");

220 ià((
”r
 = 
	`¹Æ_qdisc_add
(
sock
, 
qdisc
, 
NLM_F_CREATE
))) {

221 
	`´štf
("Can‚ot‡llocate ingress Qdisc\n");

226 
	`¹Æ_qdisc_put
(
qdisc
);

229 
	}
}

231 
	$maš
()

233 
Æ_sock
 *
sock
;

234 
¹Æ_lšk
 *
lšk
;

235 
ušt32_t
 
ht
, 
hšk
, 
htid
, 
dœeùiÚ
;

236 
chashlšk
[16]="";

237 
”r
;

238 
Æ_ÿche
 *
lšk_ÿche
;

239 
¹Æ_aù
 *
aù
;

241 ià(!(
sock
 = 
	`Æ_sock‘_®loc
())) {

242 
	`´štf
("Unableo‡llocate‚etlink socket\n");

243 
	`ex™
(1);

246 ià((
”r
 = 
	`Æ_cÚÃù
(
sock
, 
NETLINK_ROUTE
)) < 0 ) {

247 
	`´štf
("Nu s-a…utut conecta†a NETLINK!\n");

248 
	`Æ_sock‘_ä“
(
sock
);

249 
	`ex™
(1);

252 ià((
”r
 = 
	`¹Æ_lšk_®loc_ÿche
(
sock
, 
AF_UNSPEC
, &
lšk_ÿche
)) < 0) {

253 
	`´štf
("Unableo‡llocate†ink cache: %s\n",

254 
	`Æ_g‘”rÜ
(
”r
));

255 
	`Æ_sock‘_ä“
(
sock
);

256 
	`ex™
(1);

260 ià(!(
lšk
 = 
	`¹Æ_lšk_g‘_by_Çme
(
lšk_ÿche
, "eth0"))) {

262 
	`´štf
("Interface‚ot found\n");

263 
	`Æ_sock‘_ä“
(
sock
);

264 
	`ex™
(1);

267 
”r
=
	`qdisc_add_šg»ss
(
sock
, 
lšk
);

287 
ušt32_t
 
i
;

288 
i
 = 1; i <= 0xf; i++)

289 
	`u32_add_ht
(
sock
, 
lšk
, 1, 
i
, 256);

306 
dœeùiÚ
 = 16;

318 
	`¡rıy
(
chashlšk
, "1:");

321 
hšk
 = 0x0;

323 if(
	`g‘_u32_hªdË
(&
hšk
, 
chashlšk
)) {

324 
	`´štf
 ("Illegal \"link\"");

325 
	`Æ_sock‘_ä“
(
sock
);

326 
	`ex™
(1);

331 ià(
hšk
 && 
	`TC_U32_NODE
(htlink)) {

332 
	`´štf
("\"link\" must be‡ hashable.\n");

333 
	`Æ_sock‘_ä“
(
sock
);

334 
	`ex™
(1);

355 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

356 0x0, 0x0, 
dœeùiÚ
, 0,

357 0, 
hšk
, 0xff000000, 
dœeùiÚ
, 
NULL
);

377 
aù
 = 
	`¹Æ_aù_®loc
();

378 ià(!
aù
) {

379 
	`´štf
("¹Æ_aù_®loc(è»tuº %p\n", 
aù
);

382 
	`¹Æ_tc_£t_kšd
(
	`TC_CAST
(
aù
), "mirred");

383 
	`¹Æ_mœ»d_£t_aùiÚ
(
aù
, 
TCA_EGRESS_REDIR
);

384 
	`¹Æ_mœ»d_£t_pŞicy
(
aù
, 
TC_ACT_STOLEN
);

385 
	`¹Æ_mœ»d_£t_ifšdex
(
aù
, 
	`¹Æ_lšk_Çme2i
(
lšk_ÿche
, "eth1"));

389 
ht
=
	`g‘_u32_·r£_hªdË
("1:a:");

390 
htid
 = (
ht
&0xFFFFF000);

391 
hšk
=
	`g‘_u32_·r£_hªdË
("2:");

393 
	`u32_add_f‹r_Ú_ht_w™h_hashmask
(
sock
, 
lšk
, 1,

394 0x0a000000, 0xff000000, 
dœeùiÚ
, 0,

395 
htid
, 
hšk
, 0x00ff0000, 
dœeùiÚ
, 
aù
);

397 
	`¹Æ_aù_put
(
aù
);

398 
	`Æ_sock‘_ä“
(
sock
);

400 
	}
}

	@mylibnl/libnl-3.2.25/tests/util.h

1 
	~<check.h
>

3 
	#Æ_ç_if
(
cÚd™iÚ
, 
”rÜ
, 
mes§ge
) \

4 
	`ç_if
((
cÚd™iÚ
), "nlerr=%d (%s): %s", \

5 (
”rÜ
), 
	`Æ_g‘”rÜ
Ó¼Ü), (
mes§ge
))

	)

	@net_interface/interface.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

12 
	~<sys/ty³s.h
>

13 
	~<sys/sock‘.h
>

15 
	~<Ãtš‘/š.h
>

16 
	~"š‹rçû.h
"

17 
	#DEFAULT_CMD_SIZE
 128

	)

19 
	$Ãt¥aû_ü—‹
(cÚ¡ * 
Çme
)

21 
»t
 = 0;

22 
cmd
[
DEFAULT_CMD_SIZE
]={0};

23 if(!
Çme
)

25 
	`¥rštf
(
cmd
, "‚‘n add %s", 
Çme
);

26 
»t
 = 
	`sy¡em
(
cmd
);

27  
»t
;

28 
	}
}

29 
	$Ãt¥aû_d–
(cÚ¡ * 
Çme
)

31 
»t
 = 0;

32 
cmd
[
DEFAULT_CMD_SIZE
]={0};

33 if(!
Çme
)

35 
	`¥rštf
(
cmd
, "‚‘n d–‘%s", 
Çme
);

36 
»t
 = 
	`sy¡em
(
cmd
);

37  
»t
;

38 
	}
}

40 
	$Ãt¥aû_g‘
(cÚ¡ * 
Çme
)

43 
	}
}

51 
	$vœtu®_š‹rçû_ü—‹
(cÚ¡ * 
if_e
, cÚ¡ *
if_v
)

53 
»t
 = 0;

54 
cmd
[
DEFAULT_CMD_SIZE
]={0};

55 if(!
if_e
 || !
if_v
)

57 
	`¥rštf
(
cmd
, "†šk‡dd % ty³ v‘h…“¸Çm%s", 
if_e
, 
if_v
);

58 
»t
 = 
	`sy¡em
(
cmd
);

59  
»t
;

60 
	}
}

74 
	$vœtu®_š‹rçû_d–
(cÚ¡ * 
if_e
)

76 
»t
 = 0;

77 
cmd
[
DEFAULT_CMD_SIZE
]={0};

78 if(!
if_e
)

80 
	`¥rštf
(
cmd
, "†šk d–‘%s", 
if_e
);

81 
»t
 = 
	`sy¡em
(
cmd
);

82  
»t
;

83 
	}
}

96 
	$š‹rçû_£t_addr
(cÚ¡ * 
š‹rçû
, 
š_addr
 
addr
)

98 
»t
;

99 
cmd
[
DEFAULT_CMD_SIZE
]={0};

100 * 
add»ss
 = 
NULL
;

101 
add»ss
 = 
	`š‘_Áß
(
addr
);

102 
	`¥rštf
(
cmd
, "‡dd»s add %s/24 dev %s", 
add»ss
, 
š‹rçû
);

103 
»t
 = 
	`sy¡em
(
cmd
);

105 
	}
}

116 
	$š‹rçû_d–_addr
(cÚ¡ * 
š‹rçû
)

118 
»t
;

119 
cmd
[
DEFAULT_CMD_SIZE
]={0};

120 if(!
š‹rçû
)

122 
	`¥rštf
(
cmd
, "‡dd»s æush dev %s", 
š‹rçû
);

123 
»t
 = 
	`sy¡em
(
cmd
);

124  
»t
;

125 
	}
}

138 
	$š‹rçû_to_Çme¥aû
(cÚ¡ * 
Çme_¥aû
, cÚ¡ * 
š‹rçû
)

140 
»t
 = 0;

141 
cmd
[
DEFAULT_CMD_SIZE
]={0};

142 if(!
Çme_¥aû
 || !
š‹rçû
)

144 
	`¥rštf
(
cmd
, "†šk s‘ dev % ÃŠ %s", 
š‹rçû
, 
Çme_¥aû
);

145 
»t
 = 
	`sy¡em
(
cmd
);

146  
»t
;

149 
	}
}

160 
	$š‹rçû_£t_up
(cÚ¡ * 
š‹rçû
)

162 
»t
;

163 
cmd
[
DEFAULT_CMD_SIZE
]={0};

164 if(!
š‹rçû
)

166 
	`¥rštf
(
cmd
, "†šk s‘ % up", 
š‹rçû
);

167 
»t
 = 
	`sy¡em
(
cmd
);

168  
»t
;

169 
	}
}

182 
	$def_rou‹r_£t
(
š_addr
 
addr
)

184 
»t
;

185 
cmd
[
DEFAULT_CMD_SIZE
]={0};

186 * 
add»ss
 = 
NULL
;

187 
add»ss
 = 
	`š‘_Áß
(
addr
);

188 if(!
add»ss
)

190 
	`¥rštf
(
cmd
, "„ou‹‡dd deçuÉ vŸ %s", 
add»ss
);

191 
»t
 = 
	`sy¡em
(
cmd
);

193 
	}
}

206 
to
 do

208 
	eÇt_ruË


210 
¢©_ruË
 
	m¢©
;

211 
dÇt_ruË
 
	mdÇt
;

212 }
	tÇt_ruË
;

214 *
	$dÇt_make_cmd
(
dÇt_ruË
 *
ruË
)

216 *
cmd
;

217 *
c
;

218 
c
 = 
	`š‘_Áß
(
ruË
->
addr
);

219 if(!
c
)

220  
NULL
;

221 
cmd
 = (*)
	`ÿÎoc
(
DEFAULT_CMD_SIZE
, ());

222 if(!
cmd
)

223  
NULL
;

224 
	`¥rštf
(
cmd
," PREROUTING -pcp --dport %d -i %s -j DNAT --to %s:%d",

225 
ruË
->
dpÜt
,„uË->
dev_Çme
, 
c
,„uË->
ıÜt
);

226  
cmd
;

227 
	}
}

229 *
	$¢©_make_cmd
(
¢©_ruË
 *
ruË
)

231 *
cmd
;

232 *
s
;

233 
cmd
 = (*)
	`ÿÎoc
(
DEFAULT_CMD_SIZE
, ());

234 if(!
cmd
)

235  
NULL
;

236 
s
 = 
	`š‘_Áß
(
ruË
->
addr
);

237 
	`¥rštf
(
cmd
," POSTROUTING -s %s -o %s -j MASQUERADE",

238 
s
, 
ruË
->
š‹rçû
);

239  
cmd
;

240 
	}
}

243 
	$dÇt_ruË_£t
(
dÇt_ruË
 *
ruË
, ** 
cmd_d©a
, *
Ën
)

245 
»t
;

246 *
d©a
;

247 
cmd
[
DEFAULT_CMD_SIZE
]={0};

248 if(!
ruË
 || !
cmd_d©a
)

250 
d©a
 = 
	`dÇt_make_cmd
(
ruË
);

251 if(!
d©a
)

253 
	`¥rštf
(
cmd
,"bË -ˆÇˆ-A %s", 
d©a
);

254 
»t
 = 
	`sy¡em
(
cmd
);

255 if(
»t
 > 0)

257 *
cmd_d©a
 = 
d©a
;

258 *
Ën
 = 
	`¡¾’
(
d©a
);

262 
	}
}

264 
	$¢©_ruË_£t
(
¢©_ruË
 * 
ruË
, **
cmd_d©a
, *
Ën
)

266 
»t
;

267 *
d©a
;

268 
cmd
[
DEFAULT_CMD_SIZE
]={0};

269 if(!
ruË
 || !
cmd_d©a
)

271 
d©a
 = 
	`¢©_make_cmd
(
ruË
);

272 if(!
d©a
)

274 
	`¥rštf
(
cmd
,"bË -ˆÇˆ-A %s", 
d©a
);

275 
»t
 = 
	`sy¡em
(
cmd
);

276 if(
»t
 > 0)

278 *
cmd_d©a
 = 
d©a
;

279 *
Ën
 = 
	`¡¾’
(
d©a
);

283 
	}
}

285 
	$Çt_ruË_d–
(cÚ¡ * 
cmd_d©a
)

287 
»t
;

288 
cmd
[
DEFAULT_CMD_SIZE
]={0};

289 if(!
cmd_d©a
)

291 
	`¥rštf
(
cmd
, "bË -ˆÇˆ-D %s",
cmd_d©a
);

292 
»t
 = 
	`sy¡em
(
cmd
);

293  
»t
;

294 
	}
}

	@net_interface/interface.h

7 #iâdeà
MATRIX_INTERFACE_H


8 
	#MATRIX_INTERFACE_H


	)

9 
	~<¬·/š‘.h
>

10 
	sdÇt_ruË


12 cÚ¡ * 
	mdev_Çme
;

13 
	mdpÜt
;

14 
š_addr
 
	maddr
;

15 
	mıÜt
;

16 }
	tdÇt_ruË
;

18 
	s¢©_ruË


20 cÚ¡ * 
	mš‹rçû
;

21 
š_addr
 
	maddr
;

22 
š_addr
 
	mmask
;

23 }
	t¢©_ruË
;

25 
Ãt¥aû_ü—‹
(cÚ¡ * 
Çme
);

26 
Ãt¥aû_d–
(cÚ¡ * 
Çme
);

27 
vœtu®_š‹rçû_ü—‹
(cÚ¡ * 
if_e
, cÚ¡ *
if_v
);

28 
vœtu®_š‹rçû_d–
(cÚ¡ * 
if_e
);

29 
š‹rçû_£t_addr
(cÚ¡ * 
š‹rçû
, 
š_addr
 
addr
);

30 
š‹rçû_d–_addr
(cÚ¡ * 
š‹rçû
);

31 
š‹rçû_to_Çme¥aû
(cÚ¡ * 
Çme_¥aû
, cÚ¡ * 
š‹rçû
);

32 
š‹rçû_£t_up
(cÚ¡ * 
š‹rçû
);

33 
def_rou‹r_£t
(
š_addr
 
addr
);

34 *
dÇt_make_cmd
(
dÇt_ruË
 *
ruË
);

35 *
¢©_make_cmd
(
¢©_ruË
 *
ruË
);

36 
dÇt_ruË_£t
(
dÇt_ruË
 *
ruË
, ** 
cmd_d©a
, *
Ën
);

37 
¢©_ruË_£t
(
¢©_ruË
 * 
ruË
, **
cmd_d©a
, *
Ën
);

38 
Çt_ruË_d–
(cÚ¡ * 
cmd_d©a
);

	@net_interface/main.c

7 
	#_GNU_SOURCE


	)

8 
	~<sys/ty³s.h
>

9 
	~<sys/wa™.h
>

10 
	~<sys/mouÁ.h
>

11 
	~<¡dio.h
>

12 
	~<sched.h
>

13 
	~<sigÇl.h
>

14 
	~<uni¡d.h
>

15 
	~<¡dlib.h
>

17 
	~<sys/sock‘.h
>

18 
	~<Ãtš‘/š.h
>

19 
	~<¬·/š‘.h
>

20 
	~"š‹rçû.h
"

21 
	#STACK_SIZE
 (1024 * 1024)

	)

24 
	gcheckpošt
[2];

26 
	gchd_¡ack
[
STACK_SIZE
];

27 * cÚ¡ 
	gchd_¬gs
[] = {

29 
NULL


31 
	schd_¬gv


33 * 
	mš‹rçû_Çme
;

34 
š_addr
 
	madd»ss
;

35 
š_addr
 
	mrou‹r
;

36 }
	tchd_¬gv
;

39 
	$chd_maš
(* 
¬g
)

41 
c
;

42 
chd_¬gv
 *
·¿m
 = (chd_¬gv *)
¬g
;

44 
	`şo£
(
checkpošt
[1]);

47 
	`´štf
(" - [%5d] WÜld !\n", 
	`g‘pid
());

48 
	`£tho¡Çme
("In Namespace", 12);

51 
	`mouÁ
("´oc", "/´oc", "´oc", 0, 
NULL
);

54 
	`»ad
(
checkpošt
[0], &
c
, 1);

57 
	`š‹rçû_£t_up
("lo");

58 
	`š‹rçû_£t_addr
(
·¿m
->
š‹rçû_Çme
,…¬am->
add»ss
);

59 
	`š‹rçû_£t_up
(
·¿m
->
š‹rçû_Çme
);

60 
	`def_rou‹r_£t
(
·¿m
->
rou‹r
);

62 
	`sy¡em
("ip†ink set†o up");

63 
	`sy¡em
("ip†ink set veth11 up");

64 
	`sy¡em
("ip‡ddr‡dd 169.254.1.2/30 dev veth11");

66 
	`execv
(
chd_¬gs
[0], child_args);

67 
	`´štf
("Ooops\n");

69 
	}
}

70 
	$maš
()

72 
chd_¬gv
 
c_¬gv
;

73 
¥aû_Çme
[10]={0};

74 *
ve_Çme
 = "veth0";

75 *
vv_Çme
 = "vveth0";

76 *
vv‘h0_addr
 = "192.168.8.2";

77 *
v‘h0_addr
 = "192.168.8.1";

79 
¢©_ruË
 
s_ruË
;

80 
dÇt_ruË
 
d_ruË
;

81 *
¢©_¡r
 = 
NULL
, *
dÇt_¡r
 = NULL;

82 
¢©_Ën
, 
dÇt_Ën
;

83 
š_addr
 
ve_
, 
vve_
;

87 if(
	`š‘_©Ú
(
vv‘h0_addr
, &
vve_
) == 0)

89 
	`´štf
("addressƒrror\r\n");

92 if(
	`š‘_©Ú
(
v‘h0_addr
, &
ve_
) == 0)

94 
	`´štf
("addressƒrror\r\n");

97 
s_ruË
.
š‹rçû
 = 
d_ruË
.
dev_Çme
 = "eth0";

98 
s_ruË
.
addr
 = 
vve_
;

100 
d_ruË
.
dpÜt
 = d_ruË.
ıÜt
 = 9999;

101 
d_ruË
.
addr
 = 
vve_
;

103 
c_¬gv
.
š‹rçû_Çme
 = 
vv_Çme
;

104 
c_¬gv
.
add»ss
 = 
vve_
;

105 
c_¬gv
.
rou‹r
 = 
ve_
;

107 
	`pe
(
checkpošt
);

109 
	`´štf
(" - [%5d] H–lØ?\n", 
	`g‘pid
());

111 
chd_pid
 = 
	`şÚe
(
chd_maš
, 
chd_¡ack
+
STACK_SIZE
,

112 
CLONE_NEWUTS
 | 
CLONE_NEWIPC
 | 
CLONE_NEWPID
 | 
CLONE_NEWNS
 | 
CLONE_NEWNET
 | 
SIGCHLD
, &
c_¬gv
);

114 
	`¥rštf
(
¥aû_Çme
, "%d", ()
chd_pid
);

115 
	`´štf
("chd…id i %s\r\n", 
¥aû_Çme
);

118 
	`vœtu®_š‹rçû_ü—‹
(
ve_Çme
, 
vv_Çme
);

120 
	`š‹rçû_to_Çme¥aû
(
¥aû_Çme
, 
vv_Çme
);

122 
	`š‹rçû_£t_addr
(
ve_Çme
, 
ve_
);

123 
	`š‹rçû_£t_up
(
ve_Çme
);

126 
	`dÇt_ruË_£t
(&
d_ruË
, &
dÇt_¡r
, &
dÇt_Ën
);

127 
	`¢©_ruË_£t
(&
s_ruË
, &
¢©_¡r
, &
¢©_Ën
);

130 
	`şo£
(
checkpošt
[1]);

132 
	`wa™pid
(
chd_pid
, 
NULL
, 0);

133 if(!
dÇt_¡r
)

134 
	`Çt_ruË_d–
(
dÇt_¡r
);

135 if(!
¢©_¡r
)

136 
	`Çt_ruË_d–
(
¢©_¡r
);

137 
	`vœtu®_š‹rçû_d–
(
ve_Çme
);

140 
	}
}

	@net_interface/process_manager.h

7 #iâdeà
MARTIX_PROCESS_MANAGER_H


8 
	#MARTIX_PROCESS_MANAGER_H


	)

9 
´oûss_cÚfig_g‘
();

10 
´oûss_¡¬t
();

11 
´oûss_¡İ
();

12 
´oûss_¡©us_g‘
();

	@net_space/net_space.c

7 
	#_GNU_SOURCE


	)

8 
	~<sys/ty³s.h
>

9 
	~<sys/wa™.h
>

10 
	~<sys/mouÁ.h
>

11 
	~<¡dio.h
>

12 
	~<sched.h
>

13 
	~<sigÇl.h
>

14 
	~<uni¡d.h
>

15 
	~<¡dlib.h
>

17 
	#STACK_SIZE
 (1024 * 1024)

	)

20 
	gcheckpošt
[2];

22 
	gchd_¡ack
[
STACK_SIZE
];

23 * cÚ¡ 
	gchd_¬gs
[] = {

25 
NULL


28 
	$chd_maš
(* 
¬g
)

30 
c
;

33 
	`şo£
(
checkpošt
[1]);

36 
	`´štf
(" - [%5d] WÜld !\n", 
	`g‘pid
());

37 
	`£tho¡Çme
("In Namespace", 12);

40 
	`mouÁ
("´oc", "/´oc", "´oc", 0, 
NULL
);

43 
	`»ad
(
checkpošt
[0], &
c
, 1);

46 
	`sy¡em
("ip†ink set†o up");

47 
	`sy¡em
("ip†ink set veth11 up");

48 
	`sy¡em
("ip‡ddr‡dd 169.254.1.2/30 dev veth11");

50 
	`execv
(
chd_¬gs
[0], child_args);

51 
	`´štf
("Ooops\n");

53 
	}
}

55 
	$maš
()

58 
	`pe
(
checkpošt
);

60 
	`´štf
(" - [%5d] H–lØ?\n", 
	`g‘pid
());

62 
chd_pid
 = 
	`şÚe
(
chd_maš
, 
chd_¡ack
+
STACK_SIZE
,

63 
CLONE_NEWUTS
 | 
CLONE_NEWIPC
 | 
CLONE_NEWPID
 | 
CLONE_NEWNS
 | 
CLONE_NEWNET
 | 
SIGCHLD
, 
NULL
);

66 * 
cmd
;

67 
	`a¥rštf
(&
cmd
, "†šk s‘ v‘h11‚‘n %d", 
chd_pid
);

68 
	`sy¡em
("ip†ink‡dd veth01ype veth…eer‚ame veth11");

69 
	`sy¡em
(
cmd
);

70 
	`sy¡em
("ip†ink set veth01 up");

71 
	`sy¡em
("ip‡ddr‡dd 169.254.1.1/30 dev veth01");

72 
	`ä“
(
cmd
);

75 
	`şo£
(
checkpošt
[1]);

77 
	`wa™pid
(
chd_pid
, 
NULL
, 0);

79 
	}
}

	@route.c

36 
	~<Ãt/rou‹.h
>

37 
	~<Ãt/if.h
>

39 
	~"libbb.h
"

40 
	~"š‘_commÚ.h
"

43 #iâdeà
RTF_UP


45 
	#RTF_UP
 0x0001

	)

46 
	#RTF_GATEWAY
 0x0002

	)

47 
	#RTF_HOST
 0x0004

	)

48 
	#RTF_REINSTATE
 0x0008

	)

49 
	#RTF_DYNAMIC
 0x0010

	)

50 
	#RTF_MODIFIED
 0x0020

	)

51 
	#RTF_MTU
 0x0040

	)

52 #iâdeà
RTF_MSS


53 
	#RTF_MSS
 
RTF_MTU


	)

55 
	#RTF_WINDOW
 0x0080

	)

56 
	#RTF_IRTT
 0x0100

	)

57 
	#RTF_REJECT
 0x0200

	)

60 #ià
defšed
(
SIOCADDRTOLD
è|| defšed(
RTF_IRTT
)

61 
	#HAVE_NEW_ADDRT
 1

	)

64 #ià
HAVE_NEW_ADDRT


65 
	#mask_š_addr
(
x
è(((
sockaddr_š
 *)&((x).
¹_g’mask
))->
sš_addr
.
s_addr
)

	)

66 
	#fuÎ_mask
(
x
è(x)

	)

68 
	#mask_š_addr
(
x
è((x).
¹_g’mask
)

	)

69 
	#fuÎ_mask
(
x
è(((
sockaddr_š
 *)&(x))->
sš_addr
.
s_addr
)

	)

73 
	#RTACTION_ADD
 1

	)

74 
	#RTACTION_DEL
 2

	)

79 
	#NET_FLAG
 1

	)

80 
	#HOST_FLAG
 2

	)

83 cÚ¡ 
	gtbl_hash_Ãt_ho¡
[] 
	gALIGN1
 =

89 
	#KW_TAKES_ARG
 020

	)

90 
	#KW_SETS_FLAG
 040

	)

92 
	#KW_IPVx_METRIC
 020

	)

93 
	#KW_IPVx_NETMASK
 021

	)

94 
	#KW_IPVx_GATEWAY
 022

	)

95 
	#KW_IPVx_MSS
 023

	)

96 
	#KW_IPVx_WINDOW
 024

	)

97 
	#KW_IPVx_IRTT
 025

	)

98 
	#KW_IPVx_DEVICE
 026

	)

100 
	#KW_IPVx_FLAG_ONLY
 040

	)

101 
	#KW_IPVx_REJECT
 040

	)

102 
	#KW_IPVx_MOD
 041

	)

103 
	#KW_IPVx_DYN
 042

	)

104 
	#KW_IPVx_REINSTATE
 043

	)

106 cÚ¡ 
	gtbl_vx
[] 
	gALIGN1
 =

108 #ià
HAVE_NEW_ADDRT


116 #ifdeà
RTF_IRTT


122 #ifdeà
RTF_REJECT


131 cÚ¡ 
	gæags_vx
[] = {

132 #ifdeà
RTF_REJECT


133 
RTF_REJECT
,

135 
RTF_MODIFIED
,

136 
RTF_DYNAMIC
,

137 
RTF_REINSTATE


140 
	$kw_lookup
(cÚ¡ *
kwtbl
, ***
·rgs
)

142 ià(**
·rgs
) {

144 ià(
	`¡rcmp
(
kwtbl
+2, **
·rgs
) == 0) {

145 *
·rgs
 += 1;

146 ià(
kwtbl
[1] & 
KW_TAKES_ARG
) {

147 ià(!**
·rgs
) {

148 
	`bb_show_u§ge
();

150 *
·rgs
 += 1;

152  
kwtbl
[1];

154 
kwtbl
 += *kwtbl;

155 } *
kwtbl
);

158 
	}
}

163 
	$add_deçuÉ_rou‹
(
š_addr
 
addr
)

165 
skfd
;

166 
»t
;

167 
¹_buf
[(
¹’Œy
)];

168 
¹’Œy
 *cÚ¡ 
¹
 = (*)
¹_buf
;

169 
	`mem£t
(
¹
, 0, (*rt));

171 
¹
->
¹_d¡
.
sš_çmy
 = 
AF_INET
;

172 
¹
->
¹_d¡
.
sš_pÜt
 = 0;

173 
¹
->
¹_d¡
.
sš_addr
.
s_addr
 = 
INADDR_ANY
;

176 
¹
->
¹_g©eway
.
sš_çmy
 = 
AF_INET
;

177 
¹
->
¹_g©eway
.
sš_pÜt
 = 0;

178 
¹
->
¹_d¡
.
sš_addr
 = 
addr
;

181 
¹
->
¹_æags
 = 
RTF_HOST
;

182 
¹
->
¹_æags
 |ğ
RTF_GATEWAY
;

184 
	`mask_š_addr
(*
¹
) = 0xffffffff;

187 
skfd
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

188 if(
skfd
 < 0)

190 
	`´štf
("create socket failed\r\n");

193 
»t
 = 
	`ioùl
(
skfd
, 
SIOCADDRT
, 
¹
);

194 if(
»t
 == -1)

196 
	`´štf
("£ˆdeçuÉ„ou‹ faed,%s\r\n", 
	`¡»¼Ü
(
”ºo
));

198 
	`şo£
(
skfd
);

199 
	}
}

200 
NOINLINE
 
	$INET_£Œou‹
(
aùiÚ
, **
¬gs
)

203 
¹_buf
[(
¹’Œy
)];

204 
¹’Œy
 *cÚ¡ 
¹
 = (*)
¹_buf
;

206 cÚ¡ *
Ãtmask
 = 
NULL
;

207 
skfd
, 
i¢‘
, 
xæag
;

210 
xæag
 = 
	`kw_lookup
(
tbl_hash_Ãt_ho¡
, &
¬gs
);

213 ià(*
¬gs
 =ğ
NULL
) {

214 
	`bb_show_u§ge
();

218 
	`mem£t
(
¹
, 0, (*rt));

221 cÚ¡ *
rg‘
 = *
¬gs
++;

222 *
´efix
;

226 
Ãtmask
 = "default";

228 
i¢‘
 = 
	`INET_»sŞve
(
rg‘
, (
sockaddr_š
 *è&
¹
->
¹_d¡
,

229 (
xæag
 & 
HOST_FLAG
));

230 ià(
i¢‘
 < 0) {

231 
	`bb_”rÜ_msg_ªd_d›
("»sŞvšg %s", 
rg‘
);

235 ià(
xæag
) {

236 
i¢‘
 = (
xæag
 & 
NET_FLAG
);

240 
¹
->
¹_æags
 = ((
i¢‘
è? 
RTF_UP
 : (RTF_UP | 
RTF_HOST
));

242 *
¬gs
) {

243 
k
 = 
	`kw_lookup
(
tbl_vx
, &
¬gs
);

244 cÚ¡ *
¬gs_m1
 = 
¬gs
[-1];

246 ià(
k
 & 
KW_IPVx_FLAG_ONLY
) {

247 
¹
->
¹_æags
 |ğ
æags_vx
[
k
 & 3];

252 ià(
k
 =ğ
KW_IPVx_GATEWAY
) {

253 ià(
¹
->
¹_æags
 & 
RTF_GATEWAY
) {

254 
	`bb_show_u§ge
();

257 
i¢‘
 = 
	`INET_»sŞve
(
¬gs_m1
,

258 (
sockaddr_š
 *è&
¹
->
¹_g©eway
, 1);

259 
¹
->
¹_æags
 |ğ
RTF_GATEWAY
;

261 ià(
i¢‘
) {

262 ià(
i¢‘
 < 0) {

263 
	`bb_”rÜ_msg_ªd_d›
("»sŞvšg %s", 
¬gs_m1
);

265 
	`bb_”rÜ_msg_ªd_d›
("g©eway % i ¨NETWORK", 
¬gs_m1
);

274 ià(
	`mask_š_addr
(*
¹
)) {

275 
ušt32_t
 
mask
 = 
	`mask_š_addr
(*
¹
);

277 
mask
 = ~
	`Áohl
(mask);

278 ià((
¹
->
¹_æags
 & 
RTF_HOST
è&& 
mask
 != 0xffffffff) {

279 
	`bb_”rÜ_msg_ªd_d›
("netmask %.8x‡nd host„oute conflict",

280 (è
mask
);

282 ià(
mask
 & (mask + 1)) {

283 
	`bb_”rÜ_msg_ªd_d›
("bogu Ãtmask %s", 
Ãtmask
);

285 
mask
 = ((
sockaddr_š
 *è&
¹
->
¹_d¡
)->
sš_addr
.
s_addr
;

286 ià(
mask
 & ~(
ušt32_t
)
	`mask_š_addr
(*
¹
)) {

287 
	`bb_”rÜ_msg_ªd_d›
("netmask‡nd„oute‡ddress conflict");

292 ià((
aùiÚ
 =ğ
RTACTION_ADD
è&& (
¹
->
¹_æags
 & 
RTF_HOST
)) {

293 
	`mask_š_addr
(*
¹
) = 0xffffffff;

297 
skfd
 = 
	`xsock‘
(
AF_INET
, 
SOCK_DGRAM
, 0);

299 ià(
aùiÚ
 =ğ
RTACTION_ADD
)

300 
	`xioùl
(
skfd
, 
SIOCADDRT
, 
¹
);

302 
	`xioùl
(
skfd
, 
SIOCDELRT
, 
¹
);

304 ià(
ENABLE_FEATURE_CLEAN_UP
è
	`şo£
(
skfd
);

305 
	}
}

307 #ià
ENABLE_FEATURE_IPV6


309 
NOINLINE
 
	$INET6_£Œou‹
(
aùiÚ
, **
¬gs
)

311 
sockaddr_š6
 
§6
;

312 
š6_¹msg
 
¹
;

313 
´efix_Ën
, 
skfd
;

314 cÚ¡ *
devÇme
;

317 cÚ¡ *
rg‘
 = *
¬gs
++;

319 ià(
	`¡rcmp
(
rg‘
, "default") == 0) {

320 
´efix_Ën
 = 0;

321 
	`mem£t
(&
§6
, 0, (sa6));

323 *
ı
;

324 
ı
 = 
	`¡rchr
(
rg‘
, '/');

325 ià(
ı
) {

326 *
ı
 = '\0';

327 
´efix_Ën
 = 
	`x©oul_¿nge
(
ı
 + 1, 0, 128);

329 
´efix_Ën
 = 128;

331 ià(
	`INET6_»sŞve
(
rg‘
, (
sockaddr_š6
 *è&
§6
) < 0) {

332 
	`bb_”rÜ_msg_ªd_d›
("»sŞvšg %s", 
rg‘
);

337 
	`mem£t
(&
¹
, 0, (rt));

339 
	`memıy
(&
¹
.
¹msg_d¡
, 
§6
.
sš6_addr
.
s6_addr
, (
š6_addr
));

342 
¹
.
¹msg_d¡_Ën
 = 
´efix_Ën
;

343 
¹
.
¹msg_æags
 = ((
´efix_Ën
 =ğ128è? (
RTF_UP
|
RTF_HOST
) : RTF_UP);

344 
¹
.
¹msg_m‘ric
 = 1;

346 
devÇme
 = 
NULL
;

348 *
¬gs
) {

349 
k
 = 
	`kw_lookup
(
tbl_vx
, &
¬gs
);

350 cÚ¡ *
¬gs_m1
 = 
¬gs
[-1];

352 ià((
k
 =ğ
KW_IPVx_MOD
è|| (k =ğ
KW_IPVx_DYN
)) {

353 
¹
.
¹msg_æags
 |ğ
æags_vx
[
k
 & 3];

357 ià(
k
 =ğ
KW_IPVx_METRIC
) {

358 
¹
.
¹msg_m‘ric
 = 
	`x©oul
(
¬gs_m1
);

362 ià(
k
 =ğ
KW_IPVx_GATEWAY
) {

363 ià(
¹
.
¹msg_æags
 & 
RTF_GATEWAY
) {

364 
	`bb_show_u§ge
();

367 ià(
	`INET6_»sŞve
(
¬gs_m1
, (
sockaddr_š6
 *è&
§6
) < 0) {

368 
	`bb_”rÜ_msg_ªd_d›
("»sŞvšg %s", 
¬gs_m1
);

370 
	`memıy
(&
¹
.
¹msg_g©eway
, 
§6
.
sš6_addr
.
s6_addr
,

371 (
š6_addr
));

372 
¹
.
¹msg_æags
 |ğ
RTF_GATEWAY
;

378 ià(!
devÇme
 && ((
k
 =ğ
KW_IPVx_DEVICE
è|| (!k && !*++
¬gs
))) {

380 
devÇme
 = 
¬gs
[-1];

385 
	`bb_show_u§ge
();

389 
skfd
 = 
	`xsock‘
(
AF_INET6
, 
SOCK_DGRAM
, 0);

391 
¹
.
¹msg_ifšdex
 = 0;

393 ià(
devÇme
) {

394 
iäeq
 
iä
;

395 
	`mem£t
(&
iä
, 0, (ifr));

396 
	`¡ºıy_IFNAMSIZ
(
iä
.
iä_Çme
, 
devÇme
);

397 
	`xioùl
(
skfd
, 
SIOCGIFINDEX
, &
iä
);

398 
¹
.
¹msg_ifšdex
 = 
iä
.
iä_ifšdex
;

402 ià(
aùiÚ
 =ğ
RTACTION_ADD
)

403 
	`xioùl
(
skfd
, 
SIOCADDRT
, &
¹
);

405 
	`xioùl
(
skfd
, 
SIOCDELRT
, &
¹
);

407 ià(
ENABLE_FEATURE_CLEAN_UP
è
	`şo£
(
skfd
);

408 
	}
}

411 cÚ¡ 
	gæagv®s
[] = {

412 
RTF_GATEWAY
,

413 
RTF_HOST
,

414 
RTF_REINSTATE
,

415 
RTF_DYNAMIC
,

416 
RTF_MODIFIED
,

417 #ià
ENABLE_FEATURE_IPV6


418 
RTF_DEFAULT
,

419 
RTF_ADDRCONF
,

420 
RTF_CACHE


424 
	#IPV4_MASK
 (
RTF_GATEWAY
|
RTF_HOST
|
RTF_REINSTATE
|
RTF_DYNAMIC
|
RTF_MODIFIED
)

	)

425 
	#IPV6_MASK
 (
RTF_GATEWAY
|
RTF_HOST
|
RTF_DEFAULT
|
RTF_ADDRCONF
|
RTF_CACHE
)

	)

428 cÚ¡ 
	gæagch¬s
[] 
	gALIGN1
 =

430 #ià
ENABLE_FEATURE_IPV6


435 
	$£t_æags
(*
æag¡r
, 
æags
)

437 
i
;

439 *
æag¡r
++ = 'U';

441 
i
 = 0; (*
æag¡r
 = 
æagch¬s
[i]) != 0; i++) {

442 ià(
æags
 & 
æagv®s
[
i
]) {

443 ++
æag¡r
;

446 
	}
}

449 
FAST_FUNC
 
	$bb_di¥Ïyrou‹s
(
nÜesŞve
, 
Ãt¡©fmt
)

451 
devÇme
[64], 
æags
[16], *
sde¡
, *
sgw
;

452 
d
, 
g
, 
m
;

453 
ægs
, 
»f
, 
u£
, 
m‘ric
, 
mtu
, 
wš
, 
œ
;

454 
sockaddr_š
 
s_addr
;

455 
š_addr
 
mask
;

457 
FILE
 *
å
 = 
	`xfİ’_fÜ_»ad
("/proc/net/route");

459 
	`´štf
("Kernel IP„outingable\n"

461 
Ãt¡©fmt
 ? " MSS Window irtt" : "Metric Ref Use");

463 ià(
	`fsÿnf
(
å
, "%*[^\n]\n") < 0) {

464 
ERROR
;

467 
r
;

468 
r
 = 
	`fsÿnf
(
å
, "%63s%lx%lx%X%d%d%d%lx%d%d%d\n",

469 
devÇme
, &
d
, &
g
, &
ægs
, &
»f
, &
u£
, &
m‘ric
, &
m
,

470 &
mtu
, &
wš
, &
œ
);

471 ià(
r
 != 11) {

472 ià((
r
 < 0è&& 
	`ãof
(
å
)) {

475 
ERROR
:

476 
	`bb_”rÜ_msg_ªd_d›
("fscanf");

479 ià(!(
ægs
 & 
RTF_UP
)) {

483 
	`£t_æags
(
æags
, (
ægs
 & 
IPV4_MASK
));

484 #ifdeà
RTF_REJECT


485 ià(
ægs
 & 
RTF_REJECT
) {

486 
æags
[0] = '!';

490 
	`mem£t
(&
s_addr
, 0, (
sockaddr_š
));

491 
s_addr
.
sš_çmy
 = 
AF_INET
;

492 
s_addr
.
sš_addr
.s_add¸ğ
d
;

493 
sde¡
 = 
	`INET_¼esŞve
(&
s_addr
, (
nÜesŞve
 | 0x8000), 
m
);

494 
s_addr
.
sš_addr
.s_add¸ğ
g
;

495 
sgw
 = 
	`INET_¼esŞve
(&
s_addr
, (
nÜesŞve
 | 0x4000), 
m
);

496 
mask
.
s_addr
 = 
m
;

498 
	`´štf
("%-15.15 %-15.15 %-16s%-6s", 
sde¡
, 
sgw
, 
	`š‘_Áß
(
mask
), 
æags
);

499 
	`ä“
(
sde¡
);

500 
	`ä“
(
sgw
);

501 ià(
Ãt¡©fmt
) {

502 
	`´štf
("%5d %-5d %6d %s\n", 
mtu
, 
wš
, 
œ
, 
devÇme
);

504 
	`´štf
("%-6d %-2d %7d %s\n", 
m‘ric
, 
»f
, 
u£
, 
devÇme
);

507 
	`fşo£
(
å
);

508 
	}
}

510 #ià
ENABLE_FEATURE_IPV6


512 
	$INET6_di¥Ïyrou‹s
()

514 
addr6
[128], *
Çddr6
;

521 
addr6x
[80];

522 
içû
[16], 
æags
[16];

523 
iæags
, 
m‘ric
, 
»fút
, 
u£
, 
´efix_Ën
, 
¦’
;

524 
sockaddr_š6
 
¢addr6
;

526 
FILE
 *
å
 = 
	`xfİ’_fÜ_»ad
("/proc/net/ipv6_route");

528 
	`´štf
("Kernel IPv6„outingable\n%-44s%-40s"

533 
r
;

534 
r
 = 
	`fsÿnf
(
å
, "%32s%x%*s%x%32s%x%x%x%x%s\n",

535 
addr6x
+14, &
´efix_Ën
, &
¦’
,‡ddr6x+40+7,

536 &
m‘ric
, &
u£
, &
»fút
, &
iæags
, 
içû
);

537 ià(
r
 != 9) {

538 ià((
r
 < 0è&& 
	`ãof
(
å
)) {

541 
ERROR
:

542 
	`bb_”rÜ_msg_ªd_d›
("fscanf");

549 
i
 = 0;

550 *
p
 = 
addr6x
+14;

553 ià(!*
p
) {

554 ià(
i
 == 40) {

555 
addr6x
[39] = 0;

556 ++
p
;

559 
ERROR
;

561 
addr6x
[
i
++] = *
p
++;

562 ià(!((
i
+1) % 5)) {

563 
addr6x
[
i
++] = ':';

565 } 
i
 < 40+28+7);

568 ià(!(
iæags
 & 
RTF_UP
)) {

572 
	`£t_æags
(
æags
, (
iæags
 & 
IPV6_MASK
));

574 
r
 = 0;

576 
	`š‘_±Ú
(
AF_INET6
, 
addr6x
 + 
r
,

577 (
sockaddr
 *è&
¢addr6
.
sš6_addr
);

578 
¢addr6
.
sš6_çmy
 = 
AF_INET6
;

579 
Çddr6
 = 
	`INET6_¼esŞve
((
sockaddr_š6
 *è&
¢addr6
,

583 ià(!
r
) {

584 
	`¢´štf
(
addr6
, ×ddr6), "%s/%d", 
Çddr6
, 
´efix_Ën
);

585 
r
 += 40;

586 
	`ä“
(
Çddr6
);

589 
	`´štf
("%-43s %-39s %-5s %-6d %-2d %7d %-8s\n",

590 
addr6
, 
Çddr6
, 
æags
, 
m‘ric
, 
»fút
, 
u£
, 
içû
);

591 
	`ä“
(
Çddr6
);

596 
	`fşo£
(
å
);

597 
	}
}

601 
	#ROUTE_OPT_A
 0x01

	)

602 
	#ROUTE_OPT_n
 0x02

	)

603 
	#ROUTE_OPT_e
 0x04

	)

604 
	#ROUTE_OPT_INET6
 0x08

	)

608 cÚ¡ 
	gtbl_v”b
[] 
	gALIGN1
 =

615 
	$rou‹_maš
(
¬gc
, **
¬gv
è
MAIN_EXTERNALLY_VISIBLE
;

616 
	$rou‹_maš
(
¬gc
 
UNUSED_PARAM
, **
¬gv
)

618 
İt
;

619 
wh©
;

620 *
çmy
;

621 **
p
;

624 
p
 = 
¬gv
;

625 *++
p
) {

626 ià(
	`¡rcmp
(*
p
, "-net") == 0 || strcmp(*p, "-host") == 0) {

627 
p
[0][0] = '#';

631 
İt
 = 
	`g‘İt32
(
¬gv
, "A:Ã", &
çmy
);

633 ià((
İt
 & 
ROUTE_OPT_A
è&& 
	`¡rcmp
(
çmy
, "inet") != 0) {

634 #ià
ENABLE_FEATURE_IPV6


635 ià(
	`¡rcmp
(
çmy
, "inet6") == 0) {

636 
İt
 |ğ
ROUTE_OPT_INET6
;

639 
	`bb_show_u§ge
();

642 
¬gv
 +ğ
İtšd
;

645 ià(!*
¬gv
) {

646 
nÜesŞve
 = (
İt
 & 
ROUTE_OPT_n
) ? 0x0fff : 0;

647 #ià
ENABLE_FEATURE_IPV6


648 ià(
İt
 & 
ROUTE_OPT_INET6
)

649 
	`INET6_di¥Ïyrou‹s
();

652 
	`bb_di¥Ïyrou‹s
(
nÜesŞve
, 
İt
 & 
ROUTE_OPT_e
);

654 
	`fæush_¡dout_ªd_ex™
(
EXIT_SUCCESS
);

658 
wh©
 = 
	`kw_lookup
(
tbl_v”b
, &
¬gv
);

659 ià(!
wh©
 || !*
¬gv
) {

660 
	`bb_show_u§ge
();

663 #ià
ENABLE_FEATURE_IPV6


664 ià(
İt
 & 
ROUTE_OPT_INET6
)

665 
	`INET6_£Œou‹
(
wh©
, 
¬gv
);

668 
	`INET_£Œou‹
(
wh©
, 
¬gv
);

670  
EXIT_SUCCESS
;

671 
	}
}

	@server/network.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<”ºo.h
>

12 
	~<”ºo.h
>

13 
	~<uni¡d.h
>

14 
	~<ev’t2/ev’t.h
>

15 
	~<sys/sock‘.h
>

16 
	~<Ãtš‘/š.h
>

17 
	~<¬·/š‘.h
>

18 
	~<sys/sock‘.h
>

19 
	~<sys/ty³s.h
>

20 
	$tı_£rv”_š™
(
pÜt
, 
li¡’_num
)

22 
”ºo_§ve
;

23 
evut_sock‘_t
 
li¡’”
;

25 
li¡’”
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0);

26 ifĞ
li¡’”
 == -1 )

29 
	`evut_make_li¡’_sock‘_»u£abË
(
li¡’”
);

31 
sockaddr_š
 
sš
;

32 
sš
.
sš_çmy
 = 
AF_INET
;

33 
sš
.
sš_addr
.
s_addr
 = 0;

34 
sš
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

36 if(
	`bšd
(
li¡’”
, (
sockaddr
 *)&
sš
, (sin)) < 0 )

37 
”rÜ
;

39 if(
	`li¡’
(
li¡’”
, 
li¡’_num
) < 0)

40 
”rÜ
;

42 
	`evut_make_sock‘_nÚblockšg
(
li¡’”
);

43  
li¡’”
;

45 
”rÜ
:

46 
”ºo_§ve
 = 
”ºo
;

47 
	`evut_şo£sock‘
(
li¡’”
);

48 
”ºo
 = 
”ºo_§ve
;

50 
	}
}

55 
	$maš
()

58 
”ºo_§ve
;

59 
evut_sock‘_t
 
li¡’”
;

61 
li¡’”
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0);

62 ifĞ
li¡’”
 == -1 )

65 
	`evut_make_li¡’_sock‘_»u£abË
(
li¡’”
);

67 
sockaddr_š
 
sš
;

68 
sš
.
sš_çmy
 = 
AF_INET
;

69 
sš
.
sš_addr
.
s_addr
 = 0;

70 
sš
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

72 if(
	`bšd
(
li¡’”
, (
sockaddr
 *)&
sš
, (sin)) < 0 )

73 
”rÜ
;

75 if(
	`li¡’
(
li¡’”
, 
li¡’_num
) < 0)

76 
”rÜ
;

78 
	`evut_make_sock‘_nÚblockšg
(
li¡’”
);

79  
li¡’”
;

81 
”rÜ
:

82 
”ºo_§ve
 = 
”ºo
;

83 
	`evut_şo£sock‘
(
li¡’”
);

84 
”ºo
 = 
”ºo_§ve
;

	@server/queue.h

35 #iâdef 
_SYS_QUEUE_H_


36 
	#_SYS_QUEUE_H_


	)

85 #ià
defšed
(
QUEUE_MACRO_DEBUG
è|| (defšed(
_KERNEL
è&& defšed(
DIAGNOSTIC
))

86 
	#_Q_INVALIDATE
(
a
è×èğ((*)-1)

	)

88 
	#_Q_INVALIDATE
(
a
)

	)

94 
	#SLIST_HEAD
(
Çme
, 
ty³
) \

95 
	sÇme
 { \

96 
ty³
 *
¦h_fœ¡
; \

97 }

	)

99 
	#SLIST_HEAD_INITIALIZER
(
h—d
) \

100 { 
NULL
 }

	)

102 
	#SLIST_ENTRY
(
ty³
) \

104 
ty³
 *
¦e_Ãxt
; \

105 }

	)

110 
	#SLIST_FIRST
(
h—d
è((h—d)->
¦h_fœ¡
)

	)

111 
	#SLIST_END
(
h—d
è
NULL


	)

112 
	#SLIST_EMPTY
(
h—d
è(
	`SLIST_FIRST
(h—dè=ğ
	`SLIST_END
(h—d))

	)

113 
	#SLIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
¦e_Ãxt
)

	)

115 
	#SLIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

116 (
v¬
èğ
	`SLIST_FIRST
(
h—d
); \

117 (
v¬
è!ğ
	`SLIST_END
(
h—d
); \

118 (
v¬
èğ
	`SLIST_NEXT
(v¬, 
f›ld
))

	)

120 
	#SLIST_FOREACH_PREVPTR
(
v¬
, 
v¬p
, 
h—d
, 
f›ld
) \

121 (
v¬p
èğ&
	`SLIST_FIRST
((
h—d
)); \

122 ((
v¬
èğ*(
v¬p
)è!ğ
	`SLIST_END
(
h—d
); \

123 (
v¬p
èğ&
	`SLIST_NEXT
((
v¬
), 
f›ld
))

	)

128 
	#SLIST_INIT
(
h—d
) { \

129 
	`SLIST_FIRST
(
h—d
èğ
	`SLIST_END
(head); \

130 }

	)

132 
	#SLIST_INSERT_AFTER
(
¦i¡–m
, 
–m
, 
f›ld
) do { \

133 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
¦i¡–m
)->field.sle_next; \

134 (
¦i¡–m
)->
f›ld
.
¦e_Ãxt
 = (
–m
); \

135 } 0)

	)

137 
	#SLIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

138 (
–m
)->
f›ld
.
¦e_Ãxt
 = (
h—d
)->
¦h_fœ¡
; \

139 (
h—d
)->
¦h_fœ¡
 = (
–m
); \

140 } 0)

	)

142 
	#SLIST_REMOVE_NEXT
(
h—d
, 
–m
, 
f›ld
) do { \

143 (
–m
)->
f›ld
.
¦e_Ãxt
 = (elm)->field.sle_next->field.sle_next; \

144 } 0)

	)

146 
	#SLIST_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

147 (
h—d
)->
¦h_fœ¡
 = (h—d)->¦h_fœ¡->
f›ld
.
¦e_Ãxt
; \

148 } 0)

	)

150 
	#SLIST_REMOVE
(
h—d
, 
–m
, 
ty³
, 
f›ld
) do { \

151 ià((
h—d
)->
¦h_fœ¡
 =ğ(
–m
)) { \

152 
	`SLIST_REMOVE_HEAD
((
h—d
), 
f›ld
); \

154 
ty³
 *
cu»lm
 = (
h—d
)->
¦h_fœ¡
; \

156 
cu»lm
->
f›ld
.
¦e_Ãxt
 !ğ(
–m
)) \

157 
cu»lm
 = cu»lm->
f›ld
.
¦e_Ãxt
; \

158 
cu»lm
->
f›ld
.
¦e_Ãxt
 = \

159 
cu»lm
->
f›ld
.
¦e_Ãxt
->field.sle_next; \

160 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
¦e_Ãxt
); \

162 } 0)

	)

167 
	#LIST_HEAD
(
Çme
, 
ty³
) \

168 
	sÇme
 { \

169 
ty³
 *
lh_fœ¡
; \

170 }

	)

172 
	#LIST_HEAD_INITIALIZER
(
h—d
) \

173 { 
NULL
 }

	)

175 
	#LIST_ENTRY
(
ty³
) \

177 
ty³
 *
Ë_Ãxt
; \

178 
ty³
 **
Ë_´ev
; \

179 }

	)

184 
	#LIST_FIRST
(
h—d
è((h—d)->
lh_fœ¡
)

	)

185 
	#LIST_END
(
h—d
è
NULL


	)

186 
	#LIST_EMPTY
(
h—d
è(
	`LIST_FIRST
(h—dè=ğ
	`LIST_END
(h—d))

	)

187 
	#LIST_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
Ë_Ãxt
)

	)

189 
	#LIST_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

190 (
v¬
èğ
	`LIST_FIRST
(
h—d
); \

191 (
v¬
)!ğ
	`LIST_END
(
h—d
); \

192 (
v¬
èğ
	`LIST_NEXT
(v¬, 
f›ld
))

	)

197 
	#LIST_INIT
(
h—d
) do { \

198 
	`LIST_FIRST
(
h—d
èğ
	`LIST_END
(head); \

199 } 0)

	)

201 
	#LIST_INSERT_AFTER
(
li¡–m
, 
–m
, 
f›ld
) do { \

202 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
)->f›ld.Ë_Ãxtè!ğ
NULL
) \

203 (
li¡–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

204 &(
–m
)->
f›ld
.
Ë_Ãxt
; \

205 (
li¡–m
)->
f›ld
.
Ë_Ãxt
 = (
–m
); \

206 (
–m
)->
f›ld
.
Ë_´ev
 = &(
li¡–m
)->f›ld.
Ë_Ãxt
; \

207 } 0)

	)

209 
	#LIST_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

210 (
–m
)->
f›ld
.
Ë_´ev
 = (
li¡–m
)->field.le_prev; \

211 (
–m
)->
f›ld
.
Ë_Ãxt
 = (
li¡–m
); \

212 *(
li¡–m
)->
f›ld
.
Ë_´ev
 = (
–m
); \

213 (
li¡–m
)->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
; \

214 } 0)

	)

216 
	#LIST_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

217 ià(((
–m
)->
f›ld
.
Ë_Ãxt
 = (
h—d
)->
lh_fœ¡
è!ğ
NULL
) \

218 (
h—d
)->
lh_fœ¡
->
f›ld
.
Ë_´ev
 = &(
–m
)->f›ld.
Ë_Ãxt
;\

219 (
h—d
)->
lh_fœ¡
 = (
–m
); \

220 (
–m
)->
f›ld
.
Ë_´ev
 = &(
h—d
)->
lh_fœ¡
; \

221 } 0)

	)

223 
	#LIST_REMOVE
(
–m
, 
f›ld
) do { \

224 ià((
–m
)->
f›ld
.
Ë_Ãxt
 !ğ
NULL
) \

225 (
–m
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

226 (
–m
)->
f›ld
.
Ë_´ev
; \

227 *(
–m
)->
f›ld
.
Ë_´ev
 = (–m)->f›ld.
Ë_Ãxt
; \

228 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_´ev
); \

229 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_Ãxt
); \

230 } 0)

	)

232 
	#LIST_REPLACE
(
–m
, 
–m2
, 
f›ld
) do { \

233 ià(((
–m2
)->
f›ld
.
Ë_Ãxt
 = (
–m
)->f›ld.Ë_Ãxtè!ğ
NULL
) \

234 (
–m2
)->
f›ld
.
Ë_Ãxt
->f›ld.
Ë_´ev
 = \

235 &(
–m2
)->
f›ld
.
Ë_Ãxt
; \

236 (
–m2
)->
f›ld
.
Ë_´ev
 = (
–m
)->field.le_prev; \

237 *(
–m2
)->
f›ld
.
Ë_´ev
 = (elm2); \

238 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_´ev
); \

239 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
Ë_Ãxt
); \

240 } 0)

	)

245 
	#SIMPLEQ_HEAD
(
Çme
, 
ty³
) \

246 
	sÇme
 { \

247 
ty³
 *
sqh_fœ¡
; \

248 
ty³
 **
sqh_Ï¡
; \

249 }

	)

251 
	#SIMPLEQ_HEAD_INITIALIZER
(
h—d
) \

252 { 
NULL
, &(
h—d
).
sqh_fœ¡
 }

	)

254 
	#SIMPLEQ_ENTRY
(
ty³
) \

256 
ty³
 *
sqe_Ãxt
; \

257 }

	)

262 
	#SIMPLEQ_FIRST
(
h—d
è((h—d)->
sqh_fœ¡
)

	)

263 
	#SIMPLEQ_END
(
h—d
è
NULL


	)

264 
	#SIMPLEQ_EMPTY
(
h—d
è(
	`SIMPLEQ_FIRST
(h—dè=ğ
	`SIMPLEQ_END
(h—d))

	)

265 
	#SIMPLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
sqe_Ãxt
)

	)

267 
	#SIMPLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

268 (
v¬
èğ
	`SIMPLEQ_FIRST
(
h—d
); \

269 (
v¬
è!ğ
	`SIMPLEQ_END
(
h—d
); \

270 (
v¬
èğ
	`SIMPLEQ_NEXT
(v¬, 
f›ld
))

	)

275 
	#SIMPLEQ_INIT
(
h—d
) do { \

276 (
h—d
)->
sqh_fœ¡
 = 
NULL
; \

277 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

278 } 0)

	)

280 
	#SIMPLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

281 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
h—d
)->
sqh_fœ¡
è=ğ
NULL
) \

282 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

283 (
h—d
)->
sqh_fœ¡
 = (
–m
); \

284 } 0)

	)

286 
	#SIMPLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

287 (
–m
)->
f›ld
.
sqe_Ãxt
 = 
NULL
; \

288 *(
h—d
)->
sqh_Ï¡
 = (
–m
); \

289 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

290 } 0)

	)

292 
	#SIMPLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

293 ià(((
–m
)->
f›ld
.
sqe_Ãxt
 = (
li¡–m
)->f›ld.sqe_Ãxtè=ğ
NULL
)\

294 (
h—d
)->
sqh_Ï¡
 = &(
–m
)->
f›ld
.
sqe_Ãxt
; \

295 (
li¡–m
)->
f›ld
.
sqe_Ãxt
 = (
–m
); \

296 } 0)

	)

298 
	#SIMPLEQ_REMOVE_HEAD
(
h—d
, 
f›ld
) do { \

299 ià(((
h—d
)->
sqh_fœ¡
 = (h—d)->sqh_fœ¡->
f›ld
.
sqe_Ãxt
è=ğ
NULL
) \

300 (
h—d
)->
sqh_Ï¡
 = &(h—d)->
sqh_fœ¡
; \

301 } 0)

	)

306 
	#TAILQ_HEAD
(
Çme
, 
ty³
) \

307 
	sÇme
 { \

308 
ty³
 *
tqh_fœ¡
; \

309 
ty³
 **
tqh_Ï¡
; \

310 }

	)

312 
	#TAILQ_HEAD_INITIALIZER
(
h—d
) \

313 { 
NULL
, &(
h—d
).
tqh_fœ¡
 }

	)

315 
	#TAILQ_ENTRY
(
ty³
) \

317 
ty³
 *
tqe_Ãxt
; \

318 
ty³
 **
tqe_´ev
; \

319 }

	)

324 
	#TAILQ_FIRST
(
h—d
è((h—d)->
tqh_fœ¡
)

	)

325 
	#TAILQ_END
(
h—d
è
NULL


	)

326 
	#TAILQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
tqe_Ãxt
)

	)

327 
	#TAILQ_LAST
(
h—d
, 
h—dÇme
) \

328 (*(((
h—dÇme
 *)((
h—d
)->
tqh_Ï¡
))->tqh_Ï¡))

	)

330 
	#TAILQ_PREV
(
–m
, 
h—dÇme
, 
f›ld
) \

331 (*(((
h—dÇme
 *)((
–m
)->
f›ld
.
tqe_´ev
))->
tqh_Ï¡
))

	)

332 
	#TAILQ_EMPTY
(
h—d
) \

333 (
	`TAILQ_FIRST
(
h—d
è=ğ
	`TAILQ_END
(h—d))

	)

335 
	#TAILQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

336 (
v¬
èğ
	`TAILQ_FIRST
(
h—d
); \

337 (
v¬
è!ğ
	`TAILQ_END
(
h—d
); \

338 (
v¬
èğ
	`TAILQ_NEXT
(v¬, 
f›ld
))

	)

340 
	#TAILQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
h—dÇme
, 
f›ld
) \

341 (
v¬
èğ
	`TAILQ_LAST
(
h—d
, 
h—dÇme
); \

342 (
v¬
è!ğ
	`TAILQ_END
(
h—d
); \

343 (
v¬
èğ
	`TAILQ_PREV
(v¬, 
h—dÇme
, 
f›ld
))

	)

348 
	#TAILQ_INIT
(
h—d
) do { \

349 (
h—d
)->
tqh_fœ¡
 = 
NULL
; \

350 (
h—d
)->
tqh_Ï¡
 = &(h—d)->
tqh_fœ¡
; \

351 } 0)

	)

353 
	#TAILQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

354 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
h—d
)->
tqh_fœ¡
è!ğ
NULL
) \

355 (
h—d
)->
tqh_fœ¡
->
f›ld
.
tqe_´ev
 = \

356 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

358 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

359 (
h—d
)->
tqh_fœ¡
 = (
–m
); \

360 (
–m
)->
f›ld
.
tqe_´ev
 = &(
h—d
)->
tqh_fœ¡
; \

361 } 0)

	)

363 
	#TAILQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

364 (
–m
)->
f›ld
.
tqe_Ãxt
 = 
NULL
; \

365 (
–m
)->
f›ld
.
tqe_´ev
 = (
h—d
)->
tqh_Ï¡
; \

366 *(
h—d
)->
tqh_Ï¡
 = (
–m
); \

367 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

368 } 0)

	)

370 
	#TAILQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

371 ià(((
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
)->f›ld.tqe_Ãxtè!ğ
NULL
)\

372 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

373 &(
–m
)->
f›ld
.
tqe_Ãxt
; \

375 (
h—d
)->
tqh_Ï¡
 = &(
–m
)->
f›ld
.
tqe_Ãxt
; \

376 (
li¡–m
)->
f›ld
.
tqe_Ãxt
 = (
–m
); \

377 (
–m
)->
f›ld
.
tqe_´ev
 = &(
li¡–m
)->f›ld.
tqe_Ãxt
; \

378 } 0)

	)

380 
	#TAILQ_INSERT_BEFORE
(
li¡–m
, 
–m
, 
f›ld
) do { \

381 (
–m
)->
f›ld
.
tqe_´ev
 = (
li¡–m
)->field.tqe_prev; \

382 (
–m
)->
f›ld
.
tqe_Ãxt
 = (
li¡–m
); \

383 *(
li¡–m
)->
f›ld
.
tqe_´ev
 = (
–m
); \

384 (
li¡–m
)->
f›ld
.
tqe_´ev
 = &(
–m
)->f›ld.
tqe_Ãxt
; \

385 } 0)

	)

387 
	#TAILQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

388 ià(((
–m
)->
f›ld
.
tqe_Ãxt
è!ğ
NULL
) \

389 (
–m
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

390 (
–m
)->
f›ld
.
tqe_´ev
; \

392 (
h—d
)->
tqh_Ï¡
 = (
–m
)->
f›ld
.
tqe_´ev
; \

393 *(
–m
)->
f›ld
.
tqe_´ev
 = (–m)->f›ld.
tqe_Ãxt
; \

394 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_´ev
); \

395 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_Ãxt
); \

396 } 0)

	)

398 
	#TAILQ_REPLACE
(
h—d
, 
–m
, 
–m2
, 
f›ld
) do { \

399 ià(((
–m2
)->
f›ld
.
tqe_Ãxt
 = (
–m
)->f›ld.tqe_Ãxtè!ğ
NULL
) \

400 (
–m2
)->
f›ld
.
tqe_Ãxt
->f›ld.
tqe_´ev
 = \

401 &(
–m2
)->
f›ld
.
tqe_Ãxt
; \

403 (
h—d
)->
tqh_Ï¡
 = &(
–m2
)->
f›ld
.
tqe_Ãxt
; \

404 (
–m2
)->
f›ld
.
tqe_´ev
 = (
–m
)->field.tqe_prev; \

405 *(
–m2
)->
f›ld
.
tqe_´ev
 = (elm2); \

406 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_´ev
); \

407 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
tqe_Ãxt
); \

408 } 0)

	)

413 
	#CIRCLEQ_HEAD
(
Çme
, 
ty³
) \

414 
	sÇme
 { \

415 
ty³
 *
cqh_fœ¡
; \

416 
ty³
 *
cqh_Ï¡
; \

417 }

	)

419 
	#CIRCLEQ_HEAD_INITIALIZER
(
h—d
) \

420 { 
	`CIRCLEQ_END
(&
h—d
), CIRCLEQ_END(&h—dè}

	)

422 
	#CIRCLEQ_ENTRY
(
ty³
) \

424 
ty³
 *
cqe_Ãxt
; \

425 
ty³
 *
cqe_´ev
; \

426 }

	)

431 
	#CIRCLEQ_FIRST
(
h—d
è((h—d)->
cqh_fœ¡
)

	)

432 
	#CIRCLEQ_LAST
(
h—d
è((h—d)->
cqh_Ï¡
)

	)

433 
	#CIRCLEQ_END
(
h—d
è((*)(h—d))

	)

434 
	#CIRCLEQ_NEXT
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_Ãxt
)

	)

435 
	#CIRCLEQ_PREV
(
–m
, 
f›ld
è(Ólm)->f›ld.
cqe_´ev
)

	)

436 
	#CIRCLEQ_EMPTY
(
h—d
) \

437 (
	`CIRCLEQ_FIRST
(
h—d
è=ğ
	`CIRCLEQ_END
(h—d))

	)

439 
	#CIRCLEQ_FOREACH
(
v¬
, 
h—d
, 
f›ld
) \

440 (
v¬
èğ
	`CIRCLEQ_FIRST
(
h—d
); \

441 (
v¬
è!ğ
	`CIRCLEQ_END
(
h—d
); \

442 (
v¬
èğ
	`CIRCLEQ_NEXT
(v¬, 
f›ld
))

	)

444 
	#CIRCLEQ_FOREACH_REVERSE
(
v¬
, 
h—d
, 
f›ld
) \

445 (
v¬
èğ
	`CIRCLEQ_LAST
(
h—d
); \

446 (
v¬
è!ğ
	`CIRCLEQ_END
(
h—d
); \

447 (
v¬
èğ
	`CIRCLEQ_PREV
(v¬, 
f›ld
))

	)

452 
	#CIRCLEQ_INIT
(
h—d
) do { \

453 (
h—d
)->
cqh_fœ¡
 = 
	`CIRCLEQ_END
(head); \

454 (
h—d
)->
cqh_Ï¡
 = 
	`CIRCLEQ_END
(head); \

455 } 0)

	)

457 
	#CIRCLEQ_INSERT_AFTER
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

458 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
)->field.cqe_next; \

459 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
); \

460 ià((
li¡–m
)->
f›ld
.
cqe_Ãxt
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

461 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

463 (
li¡–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = (
–m
); \

464 (
li¡–m
)->
f›ld
.
cqe_Ãxt
 = (
–m
); \

465 } 0)

	)

467 
	#CIRCLEQ_INSERT_BEFORE
(
h—d
, 
li¡–m
, 
–m
, 
f›ld
) do { \

468 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
li¡–m
); \

469 (
–m
)->
f›ld
.
cqe_´ev
 = (
li¡–m
)->field.cqe_prev; \

470 ià((
li¡–m
)->
f›ld
.
cqe_´ev
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

471 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

473 (
li¡–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = (
–m
); \

474 (
li¡–m
)->
f›ld
.
cqe_´ev
 = (
–m
); \

475 } 0)

	)

477 
	#CIRCLEQ_INSERT_HEAD
(
h—d
, 
–m
, 
f›ld
) do { \

478 (
–m
)->
f›ld
.
cqe_Ãxt
 = (
h—d
)->
cqh_fœ¡
; \

479 (
–m
)->
f›ld
.
cqe_´ev
 = 
	`CIRCLEQ_END
(
h—d
); \

480 ià((
h—d
)->
cqh_Ï¡
 =ğ
	`CIRCLEQ_END
(head)) \

481 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

483 (
h—d
)->
cqh_fœ¡
->
f›ld
.
cqe_´ev
 = (
–m
); \

484 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

485 } 0)

	)

487 
	#CIRCLEQ_INSERT_TAIL
(
h—d
, 
–m
, 
f›ld
) do { \

488 (
–m
)->
f›ld
.
cqe_Ãxt
 = 
	`CIRCLEQ_END
(
h—d
); \

489 (
–m
)->
f›ld
.
cqe_´ev
 = (
h—d
)->
cqh_Ï¡
; \

490 ià((
h—d
)->
cqh_fœ¡
 =ğ
	`CIRCLEQ_END
(head)) \

491 (
h—d
)->
cqh_fœ¡
 = (
–m
); \

493 (
h—d
)->
cqh_Ï¡
->
f›ld
.
cqe_Ãxt
 = (
–m
); \

494 (
h—d
)->
cqh_Ï¡
 = (
–m
); \

495 } 0)

	)

497 
	#CIRCLEQ_REMOVE
(
h—d
, 
–m
, 
f›ld
) do { \

498 ià((
–m
)->
f›ld
.
cqe_Ãxt
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

499 (
h—d
)->
cqh_Ï¡
 = (
–m
)->
f›ld
.
cqe_´ev
; \

501 (
–m
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = \

502 (
–m
)->
f›ld
.
cqe_´ev
; \

503 ià((
–m
)->
f›ld
.
cqe_´ev
 =ğ
	`CIRCLEQ_END
(
h—d
)) \

504 (
h—d
)->
cqh_fœ¡
 = (
–m
)->
f›ld
.
cqe_Ãxt
; \

506 (
–m
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = \

507 (
–m
)->
f›ld
.
cqe_Ãxt
; \

508 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_´ev
); \

509 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_Ãxt
); \

510 } 0)

	)

512 
	#CIRCLEQ_REPLACE
(
h—d
, 
–m
, 
–m2
, 
f›ld
) do { \

513 ià(((
–m2
)->
f›ld
.
cqe_Ãxt
 = (
–m
)->field.cqe_next) == \

514 
	`CIRCLEQ_END
(
h—d
)) \

515 (
h—d
).
cqh_Ï¡
 = (
–m2
); \

517 (
–m2
)->
f›ld
.
cqe_Ãxt
->f›ld.
cqe_´ev
 = (elm2); \

518 ià(((
–m2
)->
f›ld
.
cqe_´ev
 = (
–m
)->field.cqe_prev) == \

519 
	`CIRCLEQ_END
(
h—d
)) \

520 (
h—d
).
cqh_fœ¡
 = (
–m2
); \

522 (
–m2
)->
f›ld
.
cqe_´ev
->f›ld.
cqe_Ãxt
 = (elm2); \

523 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_´ev
); \

524 
	`_Q_INVALIDATE
((
–m
)->
f›ld
.
cqe_Ãxt
); \

525 } 0)

	)

	@server/server.c

7 
	~<¡dio.h
>

8 
	~<¡dlib.h
>

9 
	~<¡ršg.h
>

10 
	~<”ºo.h
>

11 
	~<”ºo.h
>

12 
	~<uni¡d.h
>

13 
	~<ev’t2/ev’t.h
>

14 
	~<sys/sock‘.h
>

15 
	~<Ãtš‘/š.h
>

16 
	~<¬·/š‘.h
>

17 
	~<sys/sock‘.h
>

18 
	~<sys/ty³s.h
>

19 
	~"queue.h
"

20 
	sş›Á
{

21 
sockaddr_š
 
	maddr
;

22 
	mfd
;

23 
TAILQ_ENTRY
(
ş›Á
è
	mlšk
;

24 }
	tş›Á
;

25 
	$TAILQ_HEAD
(
queue
, 
ş›Á
è
h—d
;

27 
	`acû±_cb
(
fd
, 
ev’ts
, * 
¬g
);

28 
	`sock‘_»ad_cb
(
fd
, 
ev’ts
, *
¬g
);

29 
	`tı_£rv”_š™
(
pÜt
, 
li¡’_num
);

31 
	$Œim
(*
¤c
)

33 *
begš
 = 
¤c
;

34 *
’d
 = 
¤c
;

36  *
’d
++ ) {

40 iàĞ
begš
 =ğ
’d
 ) ;

42  *
begš
 == ' ' || *begin == '\t' )

43 ++
begš
;

44  (*
’d
) == '\0' || *end == ' ' || *end == '\t' || *end == '\n' )

45 --
’d
;

47 iàĞ
begš
 > 
’d
 ) {

48 *
¤c
 = '\0'; ;

51  
begš
 !ğ
’d
 ) {

52 *
¤c
++ = *
begš
++;

55 *
¤c
++ = *
’d
;

56 *
¤c
 = '\0';

59 
	}
}

60 
	$ş›Á_ä“
()

62 
ş›Á
 * 
pc
;

63 
	`TAILQ_FOREACH
(
pc
, &
h—d
, 
lšk
)

65 
	`TAILQ_REMOVE
(&
h—d
, 
pc
, 
lšk
);

67 
	}
}

69 
ev’t
 * 
	$fe_ev’t_add
(
ev’t_ba£
 * 
ba£
, 
ev’t_ÿÎback_â
 
cb
)

71 
ev’t
 *
ev
;

72 
ev
 = 
	`ev’t_Ãw
(
ba£
, 1, 
EV_READ
| 
EV_PERSIST
, 
cb
, 
NULL
);

73 if(!
ev
)

74  
NULL
;

75 
	`ev’t_add
(
ev
, 
NULL
);

76  
ev
;

77 
	}
}

79 
	$maš
(
¬gc
, ** 
¬gv
)

81 
	`TAILQ_INIT
(&
h—d
);

82 
li¡’”
 = 
	`tı_£rv”_š™
(9999, 10);

83 ifĞ
li¡’”
 == -1 )

85 
	`³¼Ü
("cp_server_initƒrror ");

88 
	`´štf
("Init server .........\r\n");

89 
ev’t_ba£
* 
ba£
 = 
	`ev’t_ba£_Ãw
();

90 
ev’t
* 
ev_li¡’
 = 
	`ev’t_Ãw
(
ba£
, 
li¡’”
, 
EV_READ
 | 
EV_PERSIST
, 
acû±_cb
, base);

91 
	`ev’t_add
(
ev_li¡’
, 
NULL
);

92 
	`ev’t_ba£_di¥©ch
(
ba£
);

93 
	`ş›Á_ä“
();

95 
	}
}

97 
	$acû±_cb
(
fd
, 
ev’ts
, * 
¬g
)

99 
ş›Á
 *
pc
;

100 
ev’t_ba£
* 
ba£
 = (ev’t_ba£*)
¬g
;

101 
ev’t
 *
ev
 = 
NULL
;

102 
evut_sock‘_t
 
sockfd
;

103 
sockËn_t
 
Ën
;

105 
pc
 = (
ş›Á
 *)
	`ÿÎoc
(1, (client));

106 if(!
pc
)

108 
	`´štf
("create clientƒrror\r\n");

111 
sockfd
 = 
	`acû±
(
fd
, (
sockaddr
*)&
pc
->
addr
, &
Ën
 );

112 if(
sockfd
 == -1)

114 
	`´štf
("acû±ƒ¼Ü:%s", 
	`¡»¼Ü
(
”ºo
));

115 
	`ä“
(
pc
);

118 
	`´štf
("acû± sock %d cÚÂeù\r\n", 
sockfd
);

119 
	`evut_make_sock‘_nÚblockšg
(
sockfd
);

120 
pc
->
fd
 = 
sockfd
;

121 
	`´štf
("%s:%d\r\n", 
__FUNCTION__
, 
__LINE__
);

122 
	`TAILQ_INSERT_HEAD
(&
h—d
, 
pc
, 
lšk
);

123 
ev
 = 
	`ev’t_Ãw
(
NULL
, -1, 0, NULL, NULL);

124 
	`ev’t_assign
(
ev
, 
ba£
, 
sockfd
, 
EV_READ
 | 
EV_PERSIST
, 
sock‘_»ad_cb
, (*)ev);

125 
	`ev’t_add
(
ev
, 
NULL
);

126 
	`´štf
("%s:%d\r\n", 
__FUNCTION__
, 
__LINE__
);

127 
	}
}

130 
	$sock‘_»ad_cb
(
fd
, 
ev’ts
, *
¬g
)

132 
msg
[1024];

133 
ş›Á
 *
pc
;

134 
ev’t
 *
ev
 = (ev’t*)
¬g
;

135 
	`´štf
("have message\r\n");

136 
	`´štf
("%s:%d\r\n", 
__FUNCTION__
, 
__LINE__
);

137 
Ën
 = 
	`»ad
(
fd
, 
msg
, (msg) - 1);

138 ifĞ
Ën
 < 0 )

140 
	`´štf
("som”rÜ h­³Àwh’„—d,„‘ i %d\n", 
Ën
);

141 
	`´štf
("”ºØi %d, %s\r\n", 
”ºo
, 
	`¡»¼Ü
(errno));

142 
	`şo£
(
	`ev’t_g‘_fd
(
ev
));

143 
	`TAILQ_FOREACH
(
pc
,&
h—d
, 
lšk
)

145 if(
pc
->
fd
 == fd)

147 
	`TAILQ_REMOVE
(&
h—d
, 
pc
, 
lšk
);

150 
	`ev’t_ä“
(
ev
);

154 
msg
[
Ën
] = '\0';

155 
	`´štf
("»cv msg: %s\r\n", 
msg
);

156 ifĞ
	`¡ºcmp
("ex™", 
msg
, 4) == 0)

158 
	`şo£
(
	`ev’t_g‘_fd
(
ev
));

159 
	`TAILQ_FOREACH
(
pc
,&
h—d
, 
lšk
)

161 if(
pc
->
fd
 == fd)

163 
	`TAILQ_REMOVE
(&
h—d
, 
pc
, 
lšk
);

166 
	`´štf
("childƒxit\n");

167 
	`ex™
(0);

171 
	}
}

174 
	$tı_£rv”_š™
(
pÜt
, 
li¡’_num
)

176 
”ºo_§ve
;

177 
evut_sock‘_t
 
li¡’”
;

179 
li¡’”
 = 
	`sock‘
(
AF_INET
, 
SOCK_STREAM
, 0);

180 ifĞ
li¡’”
 == -1 )

183 
	`evut_make_li¡’_sock‘_»u£abË
(
li¡’”
);

185 
sockaddr_š
 
sš
;

186 
sš
.
sš_çmy
 = 
AF_INET
;

187 
sš
.
sš_addr
.
s_addr
 = 0;

188 
sš
.
sš_pÜt
 = 
	`htÚs
(
pÜt
);

190 if(
	`bšd
(
li¡’”
, (
sockaddr
 *)&
sš
, (sin)) < 0 )

191 
”rÜ
;

193 if(
	`li¡’
(
li¡’”
, 
li¡’_num
) < 0)

194 
”rÜ
;

196 
	`evut_make_sock‘_nÚblockšg
(
li¡’”
);

197  
li¡’”
;

199 
”rÜ
:

200 
”ºo_§ve
 = 
”ºo
;

201 
	`evut_şo£sock‘
(
li¡’”
);

202 
”ºo
 = 
”ºo_§ve
;

204 
	}
}

	@/usr/include/alloca.h

18 #iâdef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

26 
	g__BEGIN_DECLS


29 #undeà
®loÿ


32 *
	$®loÿ
 (
size_t
 
__size
è
__THROW
;

34 #ifdef 
__GNUC__


35 
	#®loÿ
(
size
è
	`__butš_®loÿ
 (size)

	)

38 
__END_DECLS


	@/usr/include/arpa/inet.h

18 #iâdeà
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<Ãtš‘/š.h
>

25 #iâdeà
__sockËn_t_defšed


26 
__sockËn_t
 
	tsockËn_t
;

27 
	#__sockËn_t_defšed


	)

30 
__BEGIN_DECLS


34 
š_addr_t
 
	$š‘_addr
 (cÚ¡ *
__ı
è
__THROW
;

37 
š_addr_t
 
	$š‘_Êaof
 (
š_addr
 
__š
è
__THROW
;

41 
š_addr
 
	$š‘_mak—ddr
 (
š_addr_t
 
__Ãt
, in_addr_ˆ
__ho¡
)

42 
__THROW
;

45 
š_addr_t
 
	$š‘_Ãtof
 (
š_addr
 
__š
è
__THROW
;

49 
š_addr_t
 
	$š‘_ÃtwÜk
 (cÚ¡ *
__ı
è
__THROW
;

53 *
	$š‘_Áß
 (
š_addr
 
__š
è
__THROW
;

58 
	$š‘_±Ú
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

59 *
__»¡riù
 
__buf
è
__THROW
;

64 cÚ¡ *
	$š‘_Áİ
 (
__af
, cÚ¡ *
__»¡riù
 
__ı
,

65 *
__»¡riù
 
__buf
, 
sockËn_t
 
__Ën
)

66 
__THROW
;

70 #ifdeà
__USE_MISC


73 
	$š‘_©Ú
 (cÚ¡ *
__ı
, 
š_addr
 *
__šp
è
__THROW
;

77 *
	$š‘_Ã
 (
š_addr_t
 
__Ãt
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

82 *
	$š‘_Ãt_Áİ
 (
__af
, cÚ¡ *
__ı
, 
__b™s
,

83 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

88 
	$š‘_Ãt_±Ú
 (
__af
, cÚ¡ *
__ı
,

89 *
__buf
, 
size_t
 
__Ën
è
__THROW
;

94 
	$š‘_n§p_addr
 (cÚ¡ *
__ı
,

95 *
__buf
, 
__Ën
è
__THROW
;

99 *
	$š‘_n§p_Áß
 (
__Ën
, cÚ¡ *
__ı
,

100 *
__buf
è
__THROW
;

103 
__END_DECLS


	@/usr/include/arpa/nameser.h

52 #iâdeà
_ARPA_NAMESER_H_


53 
	#_ARPA_NAMESER_H_


	)

57 
	#BIND_4_COMPAT


	)

59 
	~<sys/·¿m.h
>

60 #ià(!
defšed
(
BSD
)) || (BSD < 199306)

61 
	~<sys/b™y³s.h
>

63 
	~<sys/ty³s.h
>

65 
	~<sys/cdefs.h
>

75 
	#__NAMESER
 19991006

	)

79 
	#NS_PACKETSZ
 512

	)

80 
	#NS_MAXDNAME
 1025

	)

81 
	#NS_MAXMSG
 65535

	)

82 
	#NS_MAXCDNAME
 255

	)

83 
	#NS_MAXLABEL
 63

	)

84 
	#NS_HFIXEDSZ
 12

	)

85 
	#NS_QFIXEDSZ
 4

	)

86 
	#NS_RRFIXEDSZ
 10

	)

87 
	#NS_INT32SZ
 4

	)

88 
	#NS_INT16SZ
 2

	)

89 
	#NS_INT8SZ
 1

	)

90 
	#NS_INADDRSZ
 4

	)

91 
	#NS_IN6ADDRSZ
 16

	)

92 
	#NS_CMPRSFLGS
 0xc0

	)

93 
	#NS_DEFAULTPORT
 53

	)

98 
	e__ns_£ù
 {

99 
	mns_s_qd
 = 0,

100 
	mns_s_zn
 = 0,

101 
	mns_s_ª
 = 1,

102 
	mns_s_´
 = 1,

103 
	mns_s_ns
 = 2,

104 
	mns_s_ud
 = 2,

105 
	mns_s_¬
 = 3,

106 
	mns_s_max
 = 4

107 } 
	tns_£ù
;

114 
	s__ns_msg
 {

115 cÚ¡ 
u_ch¬
 *
	m_msg
, *
	m_eom
;

116 
u_št16_t
 
	m_id
, 
	m_æags
, 
	m_couÁs
[
ns_s_max
];

117 cÚ¡ 
u_ch¬
 *
	m_£ùiÚs
[
ns_s_max
];

118 
ns_£ù
 
	m_£ù
;

119 
	m_¼num
;

120 cÚ¡ 
u_ch¬
 *
	m_msg_±r
;

121 } 
	tns_msg
;

124 
	s_ns_æagd©a
 { 
	mmask
, 
	mshiá
; };

125 cÚ¡ 
_ns_æagd©a
 _ns_flagdata[];

129 
	#ns_msg_id
(
hªdË
è((hªdË).
_id
 + 0)

	)

130 
	#ns_msg_ba£
(
hªdË
è((hªdË).
_msg
 + 0)

	)

131 
	#ns_msg_’d
(
hªdË
è((hªdË).
_eom
 + 0)

	)

132 
	#ns_msg_size
(
hªdË
è((hªdË).
_eom
 - (hªdË).
_msg
)

	)

133 
	#ns_msg_couÁ
(
hªdË
, 
£ùiÚ
è((hªdË).
_couÁs
[£ùiÚ] + 0)

	)

138 
	s__ns_¼
 {

139 
	mÇme
[
NS_MAXDNAME
];

140 
u_št16_t
 
	mty³
;

141 
u_št16_t
 
	m¼_şass
;

142 
u_št32_t
 
	m‰l
;

143 
u_št16_t
 
	mrdËngth
;

144 cÚ¡ 
u_ch¬
 * 
	mrd©a
;

145 } 
	tns_¼
;

148 
	#ns_¼_Çme
(
¼
è((Ôr).
Çme
[0] !ğ'\0'è? (¼).Çm: ".")

	)

149 
	#ns_¼_ty³
(
¼
è((
ns_ty³
)(Ôr).
ty³
 + 0))

	)

150 
	#ns_¼_şass
(
¼
è((
ns_şass
)(Ôr).
¼_şass
 + 0))

	)

151 
	#ns_¼_‰l
(
¼
è(Ôr).
‰l
 + 0)

	)

152 
	#ns_¼_rdËn
(
¼
è(Ôr).
rdËngth
 + 0)

	)

153 
	#ns_¼_rd©a
(
¼
è(Ôr).
rd©a
 + 0)

	)

160 
	e__ns_æag
 {

161 
	mns_f_qr
,

162 
	mns_f_İcode
,

163 
	mns_f_¯
,

164 
	mns_f_tc
,

165 
	mns_f_rd
,

166 
	mns_f_¿
,

167 
	mns_f_z
,

168 
	mns_f_ad
,

169 
	mns_f_cd
,

170 
	mns_f_rcode
,

171 
	mns_f_max


172 } 
	tns_æag
;

177 
	e__ns_İcode
 {

178 
	mns_o_qu”y
 = 0,

179 
	mns_o_iqu”y
 = 1,

180 
	mns_o_¡©us
 = 2,

182 
	mns_o_nÙify
 = 4,

183 
	mns_o_upd©e
 = 5,

184 
	mns_o_max
 = 6

185 } 
	tns_İcode
;

190 
	e__ns_rcode
 {

191 
	mns_r_nÛ¼Ü
 = 0,

192 
	mns_r_fÜm”r
 = 1,

193 
	mns_r_£rvç
 = 2,

194 
	mns_r_nxdomaš
 = 3,

195 
	mns_r_nÙim¶
 = 4,

196 
	mns_r_»fu£d
 = 5,

198 
	mns_r_yxdomaš
 = 6,

199 
	mns_r_yx¼£t
 = 7,

200 
	mns_r_nx¼£t
 = 8,

201 
	mns_r_nÙauth
 = 9,

202 
	mns_r_nÙzÚe
 = 10,

203 
	mns_r_max
 = 11,

205 
	mns_r_badv”s
 = 16,

207 
	mns_r_badsig
 = 16,

208 
	mns_r_badkey
 = 17,

209 
	mns_r_badtime
 = 18

210 } 
	tns_rcode
;

213 
	e__ns_upd©e_İ”©iÚ
 {

214 
	mns_uİ_d–‘e
 = 0,

215 
	mns_uİ_add
 = 1,

216 
	mns_uİ_max
 = 2

217 } 
	tns_upd©e_İ”©iÚ
;

222 
	sns_tsig_key
 {

223 
	mÇme
[
NS_MAXDNAME
], 
	m®g
[NS_MAXDNAME];

224 *
	md©a
;

225 
	mËn
;

227 
ns_tsig_key
 
	tns_tsig_key
;

232 
	sns_tı_tsig_¡©e
 {

233 
	mcouÁ”
;

234 
d¡_key
 *
	mkey
;

235 *
	mùx
;

236 
	msig
[
NS_PACKETSZ
];

237 
	msigËn
;

239 
ns_tı_tsig_¡©e
 
	tns_tı_tsig_¡©e
;

241 
	#NS_TSIG_FUDGE
 300

	)

242 
	#NS_TSIG_TCP_COUNT
 100

	)

243 
	#NS_TSIG_ALG_HMAC_MD5
 "HMAC-MD5.SIG-ALG.REG.INT"

	)

245 
	#NS_TSIG_ERROR_NO_TSIG
 -10

	)

246 
	#NS_TSIG_ERROR_NO_SPACE
 -11

	)

247 
	#NS_TSIG_ERROR_FORMERR
 -12

	)

252 
	e__ns_ty³
 {

253 
	mns_t_šv®id
 = 0,

254 
	mns_t_a
 = 1,

255 
	mns_t_ns
 = 2,

256 
	mns_t_md
 = 3,

257 
	mns_t_mf
 = 4,

258 
	mns_t_úame
 = 5,

259 
	mns_t_sß
 = 6,

260 
	mns_t_mb
 = 7,

261 
	mns_t_mg
 = 8,

262 
	mns_t_mr
 = 9,

263 
	mns_t_nuÎ
 = 10,

264 
	mns_t_wks
 = 11,

265 
	mns_t_±r
 = 12,

266 
	mns_t_hšfo
 = 13,

267 
	mns_t_mšfo
 = 14,

268 
	mns_t_mx
 = 15,

269 
	mns_t_txt
 = 16,

270 
	mns_t_½
 = 17,

271 
	mns_t_afsdb
 = 18,

272 
	mns_t_x25
 = 19,

273 
	mns_t_isdn
 = 20,

274 
	mns_t_¹
 = 21,

275 
	mns_t_n§p
 = 22,

276 
	mns_t_n§p_±r
 = 23,

277 
	mns_t_sig
 = 24,

278 
	mns_t_key
 = 25,

279 
	mns_t_px
 = 26,

280 
	mns_t_gpos
 = 27,

281 
	mns_t_¯¯
 = 28,

282 
	mns_t_loc
 = 29,

283 
	mns_t_nxt
 = 30,

284 
	mns_t_eid
 = 31,

285 
	mns_t_nimloc
 = 32,

286 
	mns_t_¤v
 = 33,

287 
	mns_t_©ma
 = 34,

288 
	mns_t_Ç±r
 = 35,

289 
	mns_t_kx
 = 36,

290 
	mns_t_û¹
 = 37,

291 
	mns_t_a6
 = 38,

292 
	mns_t_dÇme
 = 39,

293 
	mns_t_sšk
 = 40,

294 
	mns_t_İt
 = 41,

295 
	mns_t_­l
 = 42,

296 
	mns_t_tkey
 = 249,

297 
	mns_t_tsig
 = 250,

298 
	mns_t_ixä
 = 251,

299 
	mns_t_axä
 = 252,

300 
	mns_t_mab
 = 253,

301 
	mns_t_maa
 = 254,

302 
	mns_t_ªy
 = 255,

303 
	mns_t_zxä
 = 256,

304 
	mns_t_max
 = 65536

305 } 
	tns_ty³
;

308 
	#ns_t_qt_p
(
t
è(
	`ns_t_xä_p
Ñè|| (tè=ğ
ns_t_ªy
 || \

309 (
t
è=ğ
ns_t_mab
 || (tè=ğ
ns_t_maa
)

	)

311 
	#ns_t_m¼_p
(
t
è(Ñè=ğ
ns_t_tsig
 || (tè=ğ
ns_t_İt
)

	)

313 
	#ns_t_¼_p
(
t
è(!
	`ns_t_qt_p
Ñè&& !
	`ns_t_m¼_p
Ñ))

	)

314 
	#ns_t_udp_p
(
t
è(Ñè!ğ
ns_t_axä
 && (tè!ğ
ns_t_zxä
)

	)

315 
	#ns_t_xä_p
(
t
è(Ñè=ğ
ns_t_axä
 || (tè=ğ
ns_t_ixä
 || \

316 (
t
è=ğ
ns_t_zxä
)

	)

321 
	e__ns_şass
 {

322 
	mns_c_šv®id
 = 0,

323 
	mns_c_š
 = 1,

324 
	mns_c_2
 = 2,

325 
	mns_c_chaos
 = 3,

326 
	mns_c_hs
 = 4,

328 
	mns_c_nÚe
 = 254,

329 
	mns_c_ªy
 = 255,

330 
	mns_c_max
 = 65536

331 } 
	tns_şass
;

335 
	e__ns_key_ty³s
 {

336 
	mns_kt_r§
 = 1,

337 
	mns_kt_dh
 = 2,

338 
	mns_kt_d§
 = 3,

339 
	mns_kt_´iv©e
 = 254

340 } 
	tns_key_ty³s
;

342 
	e__ns_û¹_ty³s
 {

343 
	mû¹_t_pkix
 = 1,

344 
	mû¹_t_¥ki
 = 2,

345 
	mû¹_t_pgp
 = 3,

346 
	mû¹_t_u¾
 = 253,

347 
	mû¹_t_oid
 = 254

348 } 
	tns_û¹_ty³s
;

351 
	#NS_KEY_TYPEMASK
 0xC000

	)

352 
	#NS_KEY_TYPE_AUTH_CONF
 0x0000

	)

353 
	#NS_KEY_TYPE_CONF_ONLY
 0x8000

	)

354 
	#NS_KEY_TYPE_AUTH_ONLY
 0x4000

	)

355 
	#NS_KEY_TYPE_NO_KEY
 0xC000

	)

357 
	#NS_KEY_NO_AUTH
 0x8000

	)

358 
	#NS_KEY_NO_CONF
 0x4000

	)

359 
	#NS_KEY_RESERVED2
 0x2000

	)

360 
	#NS_KEY_EXTENDED_FLAGS
 0x1000

	)

361 
	#NS_KEY_RESERVED4
 0x0800

	)

362 
	#NS_KEY_RESERVED5
 0x0400

	)

363 
	#NS_KEY_NAME_TYPE
 0x0300

	)

364 
	#NS_KEY_NAME_USER
 0x0000

	)

365 
	#NS_KEY_NAME_ENTITY
 0x0200

	)

366 
	#NS_KEY_NAME_ZONE
 0x0100

	)

367 
	#NS_KEY_NAME_RESERVED
 0x0300

	)

368 
	#NS_KEY_RESERVED8
 0x0080

	)

369 
	#NS_KEY_RESERVED9
 0x0040

	)

370 
	#NS_KEY_RESERVED10
 0x0020

	)

371 
	#NS_KEY_RESERVED11
 0x0010

	)

372 
	#NS_KEY_SIGNATORYMASK
 0x000F

	)

373 
	#NS_KEY_RESERVED_BITMASK
 ( 
NS_KEY_RESERVED2
 | \

374 
NS_KEY_RESERVED4
 | \

375 
NS_KEY_RESERVED5
 | \

376 
NS_KEY_RESERVED8
 | \

377 
NS_KEY_RESERVED9
 | \

378 
NS_KEY_RESERVED10
 | \

379 
NS_KEY_RESERVED11
 )

	)

380 
	#NS_KEY_RESERVED_BITMASK2
 0xFFFF

	)

382 
	#NS_ALG_MD5RSA
 1

	)

383 
	#NS_ALG_DH
 2

	)

384 
	#NS_ALG_DSA
 3

	)

385 
	#NS_ALG_DSS
 
NS_ALG_DSA


	)

386 
	#NS_ALG_EXPIRE_ONLY
 253

	)

387 
	#NS_ALG_PRIVATE_OID
 254

	)

390 
	#NS_KEY_PROT_TLS
 1

	)

391 
	#NS_KEY_PROT_EMAIL
 2

	)

392 
	#NS_KEY_PROT_DNSSEC
 3

	)

393 
	#NS_KEY_PROT_IPSEC
 4

	)

394 
	#NS_KEY_PROT_ANY
 255

	)

397 
	#NS_MD5RSA_MIN_BITS
 512

	)

398 
	#NS_MD5RSA_MAX_BITS
 4096

	)

400 
	#NS_MD5RSA_MAX_BYTES
 ((
NS_MD5RSA_MAX_BITS
+7/8)*2+3)

	)

402 
	#NS_MD5RSA_MAX_BASE64
 (((
NS_MD5RSA_MAX_BYTES
+2)/3)*4)

	)

403 
	#NS_MD5RSA_MIN_SIZE
 ((
NS_MD5RSA_MIN_BITS
+7)/8)

	)

404 
	#NS_MD5RSA_MAX_SIZE
 ((
NS_MD5RSA_MAX_BITS
+7)/8)

	)

406 
	#NS_DSA_SIG_SIZE
 41

	)

407 
	#NS_DSA_MIN_SIZE
 213

	)

408 
	#NS_DSA_MAX_BYTES
 405

	)

411 
	#NS_SIG_TYPE
 0

	)

412 
	#NS_SIG_ALG
 2

	)

413 
	#NS_SIG_LABELS
 3

	)

414 
	#NS_SIG_OTTL
 4

	)

415 
	#NS_SIG_EXPIR
 8

	)

416 
	#NS_SIG_SIGNED
 12

	)

417 
	#NS_SIG_FOOT
 16

	)

418 
	#NS_SIG_SIGNER
 18

	)

420 
	#NS_NXT_BITS
 8

	)

421 
	#NS_NXT_BIT_SET
Ğ
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] |ğ(0x80>>(Ò)%NS_NXT_BITS)))

	)

422 
	#NS_NXT_BIT_CLEAR
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] &ğ~(0x80>>(Ò)%NS_NXT_BITS)))

	)

423 
	#NS_NXT_BIT_ISSET
(
n
,
p
èÕ[Ò)/
NS_NXT_BITS
] & (0x80>>(Ò)%NS_NXT_BITS)))

	)

424 
	#NS_NXT_MAX
 127

	)

429 
	#NS_OPT_DNSSEC_OK
 0x8000U

	)

430 
	#NS_OPT_NSID
 3

	)

435 
	#NS_GET16
(
s
, 
ı
) do { \

436 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

437 (
s
èğ((
u_št16_t
)
t_ı
[0] << 8) \

438 | ((
u_št16_t
)
t_ı
[1]) \

440 (
ı
è+ğ
NS_INT16SZ
; \

441 } 0)

	)

443 
	#NS_GET32
(
l
, 
ı
) do { \

444 cÚ¡ 
u_ch¬
 *
t_ı
 = (cÚ¡ u_ch¬ *)(
ı
); \

445 (
l
èğ((
u_št32_t
)
t_ı
[0] << 24) \

446 | ((
u_št32_t
)
t_ı
[1] << 16) \

447 | ((
u_št32_t
)
t_ı
[2] << 8) \

448 | ((
u_št32_t
)
t_ı
[3]) \

450 (
ı
è+ğ
NS_INT32SZ
; \

451 } 0)

	)

453 
	#NS_PUT16
(
s
, 
ı
) do { \

454 
u_št16_t
 
t_s
 = (u_št16_t)(
s
); \

455 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

456 *
t_ı
++ = 
t_s
 >> 8; \

457 *
t_ı
 = 
t_s
; \

458 (
ı
è+ğ
NS_INT16SZ
; \

459 } 0)

	)

461 
	#NS_PUT32
(
l
, 
ı
) do { \

462 
u_št32_t
 
t_l
 = (u_št32_t)(
l
); \

463 
u_ch¬
 *
t_ı
 = (u_ch¬ *)(
ı
); \

464 *
t_ı
++ = 
t_l
 >> 24; \

465 *
t_ı
++ = 
t_l
 >> 16; \

466 *
t_ı
++ = 
t_l
 >> 8; \

467 *
t_ı
 = 
t_l
; \

468 (
ı
è+ğ
NS_INT32SZ
; \

469 } 0)

	)

471 
__BEGIN_DECLS


472 
	$ns_msg_g‘æag
 (
ns_msg
, è
__THROW
;

473 
u_št
 
	$ns_g‘16
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

474 
u_lÚg
 
	$ns_g‘32
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

475 
	$ns_put16
 (
u_št
, 
u_ch¬
 *è
__THROW
;

476 
	$ns_put32
 (
u_lÚg
, 
u_ch¬
 *è
__THROW
;

477 
	$ns_š™·r£
 (cÚ¡ 
u_ch¬
 *, , 
ns_msg
 *è
__THROW
;

478 
	$ns_sk¼
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
ns_£ù
, )

479 
__THROW
;

480 
	$ns_·r£¼
 (
ns_msg
 *, 
ns_£ù
, , 
ns_¼
 *è
__THROW
;

481 
	$ns_¥ršŒr
 (cÚ¡ 
ns_msg
 *, cÚ¡ 
ns_¼
 *,

482 cÚ¡ *, cÚ¡ *, *, 
size_t
)

483 
__THROW
;

484 
	$ns_¥ršŒrf
 (cÚ¡ 
u_ch¬
 *, 
size_t
, const *,

485 
ns_şass
, 
ns_ty³
, 
u_lÚg
, cÚ¡ 
u_ch¬
 *,

486 
size_t
, const *, const *,

487 *, 
size_t
è
__THROW
;

488 
	$ns_fÜm©_‰l
 (
u_lÚg
, *, 
size_t
è
__THROW
;

489 
	$ns_·r£_‰l
 (cÚ¡ *, 
u_lÚg
 *è
__THROW
;

490 
u_št32_t
 
	$ns_d©‘o£cs
 (cÚ¡ *, *è
__THROW
;

491 
	$ns_Çme_ÁŞ
 (cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

492 
	$ns_Çme_Áİ
 (cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

493 
	$ns_Çme_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

494 
	$ns_Çme_uÅack
 (cÚ¡ 
u_ch¬
 *, const u_char *,

495 cÚ¡ 
u_ch¬
 *, u_ch¬ *, 
size_t
è
__THROW
;

496 
	$ns_Çme_·ck
 (cÚ¡ 
u_ch¬
 *, u_char *, ,

497 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

498 
	$ns_Çme_uncom´ess
 (cÚ¡ 
u_ch¬
 *, const u_char *,

499 cÚ¡ 
u_ch¬
 *, *, 
size_t
è
__THROW
;

500 
	$ns_Çme_com´ess
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
,

501 cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ **è
__THROW
;

502 
	$ns_Çme_sk
 (cÚ¡ 
u_ch¬
 **, cÚ¡ u_ch¬ *è
__THROW
;

503 
	$ns_Çme_rŞlback
 (cÚ¡ 
u_ch¬
 *, const u_char **,

504 cÚ¡ 
u_ch¬
 **è
__THROW
;

505 
	$ns_sign
 (
u_ch¬
 *, *, , , *,

506 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
è
__THROW
;

507 
	$ns_sign2
 (
u_ch¬
 *, *, , , *,

508 cÚ¡ 
u_ch¬
 *, , u_ch¬ *, *, 
time_t
,

509 
u_ch¬
 **, u_ch¬ **è
__THROW
;

510 
	$ns_sign_tı
 (
u_ch¬
 *, *, , ,

511 
ns_tı_tsig_¡©e
 *, è
__THROW
;

512 
	$ns_sign_tı2
 (
u_ch¬
 *, *, , ,

513 
ns_tı_tsig_¡©e
 *, ,

514 
u_ch¬
 **, u_ch¬ **è
__THROW
;

515 
	$ns_sign_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

516 
ns_tı_tsig_¡©e
 *è
__THROW
;

517 
u_ch¬
 *
	$ns_fšd_tsig
 (
u_ch¬
 *, u_ch¬ *è
__THROW
;

518 
	$ns_v”ify
 (
u_ch¬
 *, *, *, const u_char *, ,

519 
u_ch¬
 *, *, 
time_t
 *, è
__THROW
;

520 
	$ns_v”ify_tı
 (
u_ch¬
 *, *, 
ns_tı_tsig_¡©e
 *, )

521 
__THROW
;

522 
	$ns_v”ify_tı_š™
 (*, cÚ¡ 
u_ch¬
 *, ,

523 
ns_tı_tsig_¡©e
 *è
__THROW
;

524 
	$ns_§medomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

525 
	$ns_subdomaš
 (cÚ¡ *, cÚ¡ *è
__THROW
;

526 
	$ns_makeÿnÚ
 (cÚ¡ *, *, 
size_t
è
__THROW
;

527 
	$ns_§m’ame
 (cÚ¡ *, cÚ¡ *è
__THROW
;

528 
__END_DECLS


530 #ifdeà
BIND_4_COMPAT


531 
	~<¬·/Çme£r_com·t.h
>

	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #undeà
_ASSERT_H


25 #undeà
as£¹


26 #undeà
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #undeà
as£¹_³¼Ü


34 
	#_ASSERT_H
 1

	)

35 
	~<ã©u»s.h
>

37 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
¡©ic_ÿ¡
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as£¹
(
ex´
è(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as£¹_³¼Ü
(
”ºum
è(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #iâdeà
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as£¹_ç
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
,

70 
__lše
, cÚ¡ *
__funùiÚ
)

71 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

74 
	$__as£¹_³¼Ü_ç
 (
__”ºum
, cÚ¡ *
__fe
,

75 
__lše
, cÚ¡ *
__funùiÚ
)

76 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

81 
	$__as£¹
 (cÚ¡ *
__as£¹iÚ
, cÚ¡ *
__fe
, 
__lše
)

82 
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

85 
__END_DECLS


88 
	#as£¹
(
ex´
) \

89 ((
ex´
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as£¹_ç
 (
	`__STRING
(
ex´
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as£¹_³¼Ü
(
”ºum
) \

95 (!(
”ºum
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as£¹_³¼Ü_ç
 ((
”ºum
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #ià
defšed
 
__ılu¥lus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cÚ¡ *è0)

	)

118 #ià
defšed
 
__USE_ISOC11
 && !defšed 
__ılu¥lus


120 #undeà
¡©ic_as£¹


121 
	#¡©ic_as£¹
 
_Stic_as£¹


	)

	@/usr/include/byteswap.h

18 #iâdeà
_BYTESWAP_H


19 
	#_BYTESWAP_H
 1

	)

21 
	~<ã©u»s.h
>

24 
	~<b™s/by‹sw­.h
>

31 
	#bsw­_16
(
x
è
	`__bsw­_16
 (x)

	)

34 
	#bsw­_32
(
x
è
	`__bsw­_32
 (x)

	)

37 
	#bsw­_64
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/ctype.h

22 #iâdef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 
	g__BEGIN_DECLS


30 #iâdeà
_ISb™


39 
	~<’dŸn.h
>

40 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


41 
	#_ISb™
(
b™
è(1 << (b™))

	)

43 
	#_ISb™
(
b™
è((b™è< 8 ? ((1 << (b™)è<< 8è: ((1 << (b™)è>> 8))

	)

48 
	m_ISuµ”
 = 
_ISb™
 (0),

49 
	m_ISlow”
 = 
_ISb™
 (1),

50 
	m_IS®pha
 = 
_ISb™
 (2),

51 
	m_ISdig™
 = 
_ISb™
 (3),

52 
	m_ISxdig™
 = 
_ISb™
 (4),

53 
	m_IS¥aû
 = 
_ISb™
 (5),

54 
	m_IS´št
 = 
_ISb™
 (6),

55 
	m_ISg¿ph
 = 
_ISb™
 (7),

56 
	m_ISbÏnk
 = 
_ISb™
 (8),

57 
	m_ISúŒl
 = 
_ISb™
 (9),

58 
	m_ISpunù
 = 
_ISb™
 (10),

59 
	m_IS®num
 = 
_ISb™
 (11)

79 cÚ¡ **
	$__ùy³_b_loc
 ()

80 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

81 cÚ¡ 
__št32_t
 **
	$__ùy³_tŞow”_loc
 ()

82 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

83 cÚ¡ 
__št32_t
 **
	$__ùy³_touµ”_loc
 ()

84 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

87 #iâdeà
__ılu¥lus


88 
	#__isùy³
(
c
, 
ty³
) \

89 ((*
	`__ùy³_b_loc
 ())[(è(
c
)] & (è
ty³
)

	)

90 #–ià
defšed
 
__USE_EXTERN_INLINES


91 
	#__isùy³_f
(
ty³
) \

92 
__ex‹º_šlše
 \

93 
is
##
	`ty³
 (
__c
è
__THROW
 \

95  (*
	`__ùy³_b_loc
 ())[(è(
__c
)] & (è
_IS
##
ty³
; \

96 
	}

	)
}

99 
	#__i§scii
(
c
è(((cè& ~0x7fè=ğ0è

	)

100 
	#__tßscii
(
c
è((cè& 0x7fè

	)

102 
	#__exùy³
(
Çme
è
	`Çme
 (è
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exùy³
 (
i§Êum
);

111 
__exùy³
 (
i§Íha
);

112 
__exùy³
 (
isúŒl
);

113 
__exùy³
 (
isdig™
);

114 
__exùy³
 (
i¦ow”
);

115 
__exùy³
 (
isg¿ph
);

116 
__exùy³
 (
i¥ršt
);

117 
__exùy³
 (
i¥unù
);

118 
__exùy³
 (
is¥aû
);

119 
__exùy³
 (
isuµ”
);

120 
__exùy³
 (
isxdig™
);

124 
	$tŞow”
 (
__c
è
__THROW
;

127 
	$touµ”
 (
__c
è
__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exùy³
 (
isbÏnk
);

138 
__END_NAMESPACE_C99


141 #ifdeà
__USE_GNU


143 
	$isùy³
 (
__c
, 
__mask
è
__THROW
;

146 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


150 
	$i§scii
 (
__c
è
__THROW
;

154 
	$tßscii
 (
__c
è
__THROW
;

158 
	`__exùy³
 (
_touµ”
);

159 
	`__exùy³
 (
_tŞow”
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
¬gs
) \

164 (
__ex‹nsiÚ__
 \

165 ({ 
__»s
; \

166 ià( (
c
) > 1) \

168 ià(
	`__butš_cÚ¡ªt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__»s
 = 
__c
 < -128 || __ø> 255 ? __ø: (
a
)[__c]; \

174 
__»s
 = 
f
 
¬gs
; \

177 
__»s
 = (
a
)[(è(
c
)]; \

178 
__»s
; 
	}
}))

	)

180 #ià!
defšed
 
__NO_CTYPE


181 #ifdeà
__isùy³_f


182 
	$__isùy³_f
 (
®num
)

183 
	$__isùy³_f
 (
®pha
)

184 
	$__isùy³_f
 (
úŒl
)

185 
	$__isùy³_f
 (
dig™
)

186 
	$__isùy³_f
 (
low”
)

187 
	$__isùy³_f
 (
g¿ph
)

188 
	$__isùy³_f
 (
´št
)

189 
	$__isùy³_f
 (
punù
)

190 
	$__isùy³_f
 (
¥aû
)

191 
	$__isùy³_f
 (
uµ”
)

192 
	$__isùy³_f
 (
xdig™
)

193 #ifdeà
__USE_ISOC99


194 
	$__isùy³_f
 (
bÏnk
)

196 #–ià
defšed
 
__isùy³


197 
	#i§Êum
(
c
è
	`__isùy³
((c), 
_IS®num
)

	)

198 
	#i§Íha
(
c
è
	`__isùy³
((c), 
_IS®pha
)

	)

199 
	#isúŒl
(
c
è
	`__isùy³
((c), 
_ISúŒl
)

	)

200 
	#isdig™
(
c
è
	`__isùy³
((c), 
_ISdig™
)

	)

201 
	#i¦ow”
(
c
è
	`__isùy³
((c), 
_ISlow”
)

	)

202 
	#isg¿ph
(
c
è
	`__isùy³
((c), 
_ISg¿ph
)

	)

203 
	#i¥ršt
(
c
è
	`__isùy³
((c), 
_IS´št
)

	)

204 
	#i¥unù
(
c
è
	`__isùy³
((c), 
_ISpunù
)

	)

205 
	#is¥aû
(
c
è
	`__isùy³
((c), 
_IS¥aû
)

	)

206 
	#isuµ”
(
c
è
	`__isùy³
((c), 
_ISuµ”
)

	)

207 
	#isxdig™
(
c
è
	`__isùy³
((c), 
_ISxdig™
)

	)

208 #ifdeà
__USE_ISOC99


209 
	#isbÏnk
(
c
è
	`__isùy³
((c), 
_ISbÏnk
)

	)

213 #ifdeà
__USE_EXTERN_INLINES


214 
__ex‹º_šlše
 

215 
	`__NTH
 (
	$tŞow”
 (
__c
))

217  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_tŞow”_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex‹º_šlše
 

221 
__NTH
 (
	$touµ”
 (
__c
))

223  
__c
 >ğ-128 && __ø< 256 ? (*
	`__ùy³_touµ”_loc
 ())[__c] : __c;

224 
	}
}

227 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


228 
	#tŞow”
(
c
è
	`__tobody
 (c, 
tŞow”
, *
	`__ùy³_tŞow”_loc
 (), (c))

	)

229 
	#touµ”
(
c
è
	`__tobody
 (c, 
touµ”
, *
	`__ùy³_touµ”_loc
 (), (c))

	)

232 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


233 
	#i§scii
(
c
è
	`__i§scii
 (c)

	)

234 
	#tßscii
(
c
è
	`__tßscii
 (c)

	)

236 
	#_tŞow”
(
c
è((è(*
	`__ùy³_tŞow”_loc
 ())[(è(c)])

	)

237 
	#_touµ”
(
c
è((è(*
	`__ùy³_touµ”_loc
 ())[(è(c)])

	)

243 #ifdeà
__USE_XOPEN2K8


257 
	~<xloÿË.h
>

261 
	#__isùy³_l
(
c
, 
ty³
, 
loÿË
) \

262 ((
loÿË
)->
__ùy³_b
[(è(
c
)] & (è
ty³
)

	)

264 
	#__exùy³_l
(
Çme
) \

265 
	`Çme
 (, 
__loÿË_t
è
__THROW


	)

271 
__exùy³_l
 (
i§Êum_l
);

272 
__exùy³_l
 (
i§Íha_l
);

273 
__exùy³_l
 (
isúŒl_l
);

274 
__exùy³_l
 (
isdig™_l
);

275 
__exùy³_l
 (
i¦ow”_l
);

276 
__exùy³_l
 (
isg¿ph_l
);

277 
__exùy³_l
 (
i¥ršt_l
);

278 
__exùy³_l
 (
i¥unù_l
);

279 
__exùy³_l
 (
is¥aû_l
);

280 
__exùy³_l
 (
isuµ”_l
);

281 
__exùy³_l
 (
isxdig™_l
);

283 
__exùy³_l
 (
isbÏnk_l
);

287 
	$__tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

288 
	$tŞow”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

291 
	$__touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

292 
	$touµ”_l
 (
__c
, 
__loÿË_t
 
__l
è
__THROW
;

294 #ià
__GNUC__
 >ğ2 && 
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


295 
	#__tŞow”_l
(
c
, 
loÿË
) \

296 
	`__tobody
 (
c
, 
__tŞow”_l
, (
loÿË
)->
__ùy³_tŞow”
, (c,†oÿË))

	)

297 
	#__touµ”_l
(
c
, 
loÿË
) \

298 
	`__tobody
 (
c
, 
__touµ”_l
, (
loÿË
)->
__ùy³_touµ”
, (c,†oÿË))

	)

299 
	#tŞow”_l
(
c
, 
loÿË
è
	`__tŞow”_l
 ((c), (loÿË))

	)

300 
	#touµ”_l
(
c
, 
loÿË
è
	`__touµ”_l
 ((c), (loÿË))

	)

304 #iâdeà
__NO_CTYPE


305 
	#__i§Êum_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®num
, (l))

	)

306 
	#__i§Íha_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS®pha
, (l))

	)

307 
	#__isúŒl_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISúŒl
, (l))

	)

308 
	#__isdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISdig™
, (l))

	)

309 
	#__i¦ow”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISlow”
, (l))

	)

310 
	#__isg¿ph_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISg¿ph
, (l))

	)

311 
	#__i¥ršt_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS´št
, (l))

	)

312 
	#__i¥unù_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISpunù
, (l))

	)

313 
	#__is¥aû_l
(
c
,
l
è
	`__isùy³_l
((c), 
_IS¥aû
, (l))

	)

314 
	#__isuµ”_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISuµ”
, (l))

	)

315 
	#__isxdig™_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISxdig™
, (l))

	)

317 
	#__isbÏnk_l
(
c
,
l
è
	`__isùy³_l
((c), 
_ISbÏnk
, (l))

	)

319 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


320 
	#__i§scii_l
(
c
,
l
è(Ö), 
	`__i§scii
 (c))

	)

321 
	#__tßscii_l
(
c
,
l
è(Ö), 
	`__tßscii
 (c))

	)

324 
	#i§Êum_l
(
c
,
l
è
	`__i§Êum_l
 ((c), (l))

	)

325 
	#i§Íha_l
(
c
,
l
è
	`__i§Íha_l
 ((c), (l))

	)

326 
	#isúŒl_l
(
c
,
l
è
	`__isúŒl_l
 ((c), (l))

	)

327 
	#isdig™_l
(
c
,
l
è
	`__isdig™_l
 ((c), (l))

	)

328 
	#i¦ow”_l
(
c
,
l
è
	`__i¦ow”_l
 ((c), (l))

	)

329 
	#isg¿ph_l
(
c
,
l
è
	`__isg¿ph_l
 ((c), (l))

	)

330 
	#i¥ršt_l
(
c
,
l
è
	`__i¥ršt_l
 ((c), (l))

	)

331 
	#i¥unù_l
(
c
,
l
è
	`__i¥unù_l
 ((c), (l))

	)

332 
	#is¥aû_l
(
c
,
l
è
	`__is¥aû_l
 ((c), (l))

	)

333 
	#isuµ”_l
(
c
,
l
è
	`__isuµ”_l
 ((c), (l))

	)

334 
	#isxdig™_l
(
c
,
l
è
	`__isxdig™_l
 ((c), (l))

	)

336 
	#isbÏnk_l
(
c
,
l
è
	`__isbÏnk_l
 ((c), (l))

	)

338 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


339 
	#i§scii_l
(
c
,
l
è
	`__i§scii_l
 ((c), (l))

	)

340 
	#tßscii_l
(
c
,
l
è
	`__tßscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #iâdef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 #ifdeà
__USE_XOPEN


32 #iâdeà
__šo_t_defšed


33 #iâdeà
__USE_FILE_OFFSET64


34 
__šo_t
 
	tšo_t
;

36 
__šo64_t
 
	tšo_t
;

38 
	#__šo_t_defšed


	)

40 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__šo64_t_defšed


41 
__šo64_t
 
	tšo64_t
;

42 
	#__šo64_t_defšed


	)

61 
	~<b™s/dœ’t.h
>

63 #ià(
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
è&& !defšed 
d_f’o


64 
	#d_šo
 
d_f’o


	)

81 #ifdeà
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
è((d)->
d_ÇmËn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
è(
	`_D_EXACT_NAMLEN
 (dè+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
è(
	`¡¾’
 ((d)->
d_Çme
))

	)

86 #ifdeà
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
è(((*è(dè+ (d)->
d_»ş’
è- &(d)->
d_Çme
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
è( (d)->
d_Çme
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
è+ 1)

	)

95 #ifdeà
__USE_BSD


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
è(((modeè& 0170000è>> 12)

	)

121 
	#DTTOIF
(
dœty³
è((dœty³è<< 12)

	)

127 
__dœ¡»am
 
	tDIR
;

134 
DIR
 *
	$İ’dœ
 (cÚ¡ *
__Çme
è
	`__nÚnuÎ
 ((1));

136 #ifdeà
__USE_XOPEN2K8


141 
DIR
 *
	`fdİ’dœ
 (
__fd
);

149 
	$şo£dœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

161 #iâdeà
__USE_FILE_OFFSET64


162 
dœ’t
 *
	$»addœ
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

164 #ifdeà
__REDIRECT


165 
dœ’t
 *
	`__REDIRECT
 (
»addœ
, (
DIR
 *
__dœp
), 
»addœ64
)

166 
	`__nÚnuÎ
 ((1));

168 
	#»addœ
 
»addœ64


	)

172 #ifdeà
__USE_LARGEFILE64


173 
dœ’t64
 *
	$»addœ64
 (
DIR
 *
__dœp
è
	`__nÚnuÎ
 ((1));

176 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


182 #iâdeà
__USE_FILE_OFFSET64


183 
	$»addœ_r
 (
DIR
 *
__»¡riù
 
__dœp
,

184 
dœ’t
 *
__»¡riù
 
__’Œy
,

185 
dœ’t
 **
__»¡riù
 
__»suÉ
)

186 
	`__nÚnuÎ
 ((1, 2, 3));

188 #ifdeà
__REDIRECT


189 
	`__REDIRECT
 (
»addœ_r
,

190 (
DIR
 *
__»¡riù
 
__dœp
,

191 
dœ’t
 *
__»¡riù
 
__’Œy
,

192 
dœ’t
 **
__»¡riù
 
__»suÉ
),

193 
»addœ64_r
è
	`__nÚnuÎ
 ((1, 2, 3));

195 
	#»addœ_r
 
»addœ64_r


	)

199 #ifdeà
__USE_LARGEFILE64


200 
	$»addœ64_r
 (
DIR
 *
__»¡riù
 
__dœp
,

201 
dœ’t64
 *
__»¡riù
 
__’Œy
,

202 
dœ’t64
 **
__»¡riù
 
__»suÉ
)

203 
	`__nÚnuÎ
 ((1, 2, 3));

208 
	$»wšddœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

210 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


211 
	~<b™s/ty³s.h
>

214 
	$£ekdœ
 (
DIR
 *
__dœp
, 
__pos
è
__THROW
 
	`__nÚnuÎ
 ((1));

217 
	$‹Îdœ
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

220 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN2K8


223 
	$dœfd
 (
DIR
 *
__dœp
è
__THROW
 
	`__nÚnuÎ
 ((1));

225 #ià
defšed
 
__OPTIMIZE__
 && defšed 
_DIR_dœfd


226 
	#dœfd
(
dœp
è
	`_DIR_dœfd
 (dœp)

	)

229 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


230 #iâdeà
MAXNAMLEN


232 
	~<b™s/posix1_lim.h
>

235 #ifdeà
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__Ãed_size_t


	)

244 
	~<¡ddef.h
>

253 #iâdeà
__USE_FILE_OFFSET64


254 
	`sÿndœ
 (cÚ¡ *
__»¡riù
 
__dœ
,

255 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

256 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

257 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

258 cÚ¡ 
dœ’t
 **))

259 
	`__nÚnuÎ
 ((1, 2));

261 #ifdeà
__REDIRECT


262 
	`__REDIRECT
 (
sÿndœ
,

263 (cÚ¡ *
__»¡riù
 
__dœ
,

264 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

265 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

266 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

267 cÚ¡ 
dœ’t
 **)),

268 
sÿndœ64
è
	`__nÚnuÎ
 ((1, 2));

270 
	#sÿndœ
 
sÿndœ64


	)

274 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


277 
	`sÿndœ64
 (cÚ¡ *
__»¡riù
 
__dœ
,

278 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

279 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

280 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

281 cÚ¡ 
dœ’t64
 **))

282 
	`__nÚnuÎ
 ((1, 2));

285 #ifdeà
__USE_GNU


291 #iâdeà
__USE_FILE_OFFSET64


292 
	`sÿndœ©
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

293 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

294 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

295 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

296 cÚ¡ 
dœ’t
 **))

297 
	`__nÚnuÎ
 ((2, 3));

299 #ifdeà
__REDIRECT


300 
	`__REDIRECT
 (
sÿndœ©
,

301 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

302 
dœ’t
 ***
__»¡riù
 
__Çm–i¡
,

303 (*
__£ËùÜ
è(cÚ¡ 
dœ’t
 *),

304 (*
__cmp
è(cÚ¡ 
dœ’t
 **,

305 cÚ¡ 
dœ’t
 **)),

306 
sÿndœ©64
è
	`__nÚnuÎ
 ((2, 3));

308 
	#sÿndœ©
 
sÿndœ©64


	)

314 
	`sÿndœ©64
 (
__dfd
, cÚ¡ *
__»¡riù
 
__dœ
,

315 
dœ’t64
 ***
__»¡riù
 
__Çm–i¡
,

316 (*
__£ËùÜ
è(cÚ¡ 
dœ’t64
 *),

317 (*
__cmp
è(cÚ¡ 
dœ’t64
 **,

318 cÚ¡ 
dœ’t64
 **))

319 
	`__nÚnuÎ
 ((2, 3));

323 #iâdeà
__USE_FILE_OFFSET64


324 
	$®phasÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

325 cÚ¡ 
dœ’t
 **
__e2
)

326 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

328 #ifdeà
__REDIRECT


329 
	`__REDIRECT_NTH
 (
®phasÜt
,

330 (cÚ¡ 
dœ’t
 **
__e1
,

331 cÚ¡ 
dœ’t
 **
__e2
),

332 
®phasÜt64
è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

334 
	#®phasÜt
 
®phasÜt64


	)

338 #ià
defšed
 
__USE_GNU
 && defšed 
__USE_LARGEFILE64


339 
	$®phasÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

340 cÚ¡ 
dœ’t64
 **
__e2
)

341 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

346 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC


351 #iâdeà
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$g‘dœ’Œ›s
 (
__fd
, *
__»¡riù
 
__buf
,

353 
size_t
 
__nby‹s
,

354 
__off_t
 *
__»¡riù
 
__ba£p
)

355 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

357 #ifdeà
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
g‘dœ’Œ›s
,

359 (
__fd
, *
__»¡riù
 
__buf
,

360 
size_t
 
__nby‹s
,

361 
__off64_t
 *
__»¡riù
 
__ba£p
),

362 
g‘dœ’Œ›s64
è
	`__nÚnuÎ
 ((2, 4));

364 
	#g‘dœ’Œ›s
 
g‘dœ’Œ›s64


	)

368 #ifdeà
__USE_LARGEFILE64


369 
__ssize_t
 
	$g‘dœ’Œ›s64
 (
__fd
, *
__»¡riù
 
__buf
,

370 
size_t
 
__nby‹s
,

371 
__off64_t
 *
__»¡riù
 
__ba£p
)

372 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

376 #ifdeà
__USE_GNU


378 #iâdeà
__USE_FILE_OFFSET64


379 
	$v”siÚsÜt
 (cÚ¡ 
dœ’t
 **
__e1
,

380 cÚ¡ 
dœ’t
 **
__e2
)

381 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

383 #ifdeà
__REDIRECT


384 
	`__REDIRECT_NTH
 (
v”siÚsÜt
,

385 (cÚ¡ 
dœ’t
 **
__e1
,

386 cÚ¡ 
dœ’t
 **
__e2
),

387 
v”siÚsÜt64
)

388 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

390 
	#v”siÚsÜt
 
v”siÚsÜt64


	)

394 #ifdeà
__USE_LARGEFILE64


395 
	$v”siÚsÜt64
 (cÚ¡ 
dœ’t64
 **
__e1
,

396 cÚ¡ 
dœ’t64
 **
__e2
)

397 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

401 
__END_DECLS


	@/usr/include/dlfcn.h

19 #iâdef 
_DLFCN_H


20 
	#_DLFCN_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	#__Ãed_size_t


	)

24 
	~<¡ddef.h
>

27 
	~<b™s/dlfú.h
>

30 #ifdeà
__USE_GNU


35 
	#RTLD_NEXT
 ((*è-1l)

	)

40 
	#RTLD_DEFAULT
 ((*è0)

	)

44 
	tLmid_t
;

47 
	#LM_ID_BASE
 0

	)

48 
	#LM_ID_NEWLM
 -1

	)

52 
__BEGIN_DECLS


56 *
	$dlİ’
 (cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

60 
	$dlşo£
 (*
__hªdË
è
__THROWNL
 
	`__nÚnuÎ
 ((1));

64 *
	$dlsym
 (*
__»¡riù
 
__hªdË
,

65 cÚ¡ *
__»¡riù
 
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((2));

67 #ifdeà
__USE_GNU


69 *
	$dlmİ’
 (
Lmid_t
 
__nsid
, cÚ¡ *
__fe
, 
__mode
è
__THROWNL
;

73 *
	$dlvsym
 (*
__»¡riù
 
__hªdË
,

74 cÚ¡ *
__»¡riù
 
__Çme
,

75 cÚ¡ *
__»¡riù
 
__v”siÚ
)

76 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

82 *
	$dË¼Ü
 (è
__THROW
;

85 #ifdeà
__USE_GNU


90 cÚ¡ *
dli_âame
;

91 *
dli_fba£
;

92 cÚ¡ *
dli_¢ame
;

93 *
dli_§ddr
;

94 } 
	tDl_šfo
;

98 
	$dÏddr
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
)

99 
__THROW
 
	`__nÚnuÎ
 ((2));

102 
	$dÏddr1
 (cÚ¡ *
__add»ss
, 
Dl_šfo
 *
__šfo
,

103 **
__exŒa_šfo
, 
__æags
è
__THROW
 
	`__nÚnuÎ
 ((2));

111 
RTLD_DL_SYMENT
 = 1,

114 
RTLD_DL_LINKMAP
 = 2

123 
	$dlšfo
 (*
__»¡riù
 
__hªdË
,

124 
__»que¡
, *
__»¡riù
 
__¬g
)

125 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

131 
RTLD_DI_LMID
 = 1,

135 
RTLD_DI_LINKMAP
 = 2,

137 
RTLD_DI_CONFIGADDR
 = 3,

144 
RTLD_DI_SERINFO
 = 4,

145 
RTLD_DI_SERINFOSIZE
 = 5,

149 
RTLD_DI_ORIGIN
 = 6,

151 
RTLD_DI_PROFILENAME
 = 7,

152 
RTLD_DI_PROFILEOUT
 = 8,

157 
RTLD_DI_TLS_MODID
 = 9,

163 
RTLD_DI_TLS_DATA
 = 10,

165 
RTLD_DI_MAX
 = 10

173 *
dls_Çme
;

174 
dls_æags
;

175 } 
	tDl_£½©h
;

181 
size_t
 
dls_size
;

182 
dls_út
;

183 
Dl_£½©h
 
dls_£½©h
[1];

184 } 
	tDl_£ršfo
;

188 
__END_DECLS


	@/usr/include/endian.h

18 #iâdef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<ã©u»s.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<b™s/’dŸn.h
>

40 #iâdeà
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_BSD


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èLO, 
	)
HI

53 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
èHI, 
	)
LO

58 #ià
defšed
 
__USE_BSD
 && !defšed 
__ASSEMBLER__


60 
	~<b™s/by‹sw­.h
>

62 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


63 
	#htobe16
(
x
è
	`__bsw­_16
 (x)

	)

64 
	#htŞe16
(
x
è(x)

	)

65 
	#be16toh
(
x
è
	`__bsw­_16
 (x)

	)

66 
	#Ë16toh
(
x
è(x)

	)

68 
	#htobe32
(
x
è
	`__bsw­_32
 (x)

	)

69 
	#htŞe32
(
x
è(x)

	)

70 
	#be32toh
(
x
è
	`__bsw­_32
 (x)

	)

71 
	#Ë32toh
(
x
è(x)

	)

73 
	#htobe64
(
x
è
	`__bsw­_64
 (x)

	)

74 
	#htŞe64
(
x
è(x)

	)

75 
	#be64toh
(
x
è
	`__bsw­_64
 (x)

	)

76 
	#Ë64toh
(
x
è(x)

	)

79 
	#htobe16
(
x
è(x)

	)

80 
	#htŞe16
(
x
è
	`__bsw­_16
 (x)

	)

81 
	#be16toh
(
x
è(x)

	)

82 
	#Ë16toh
(
x
è
	`__bsw­_16
 (x)

	)

84 
	#htobe32
(
x
è(x)

	)

85 
	#htŞe32
(
x
è
	`__bsw­_32
 (x)

	)

86 
	#be32toh
(
x
è(x)

	)

87 
	#Ë32toh
(
x
è
	`__bsw­_32
 (x)

	)

89 
	#htobe64
(
x
è(x)

	)

90 
	#htŞe64
(
x
è
	`__bsw­_64
 (x)

	)

91 
	#be64toh
(
x
è(x)

	)

92 
	#Ë64toh
(
x
è
	`__bsw­_64
 (x)

	)

	@/usr/include/errno.h

22 #iâdef 
_ERRNO_H


26 #iâdef 
__Ãed_Em©h


27 
	#_ERRNO_H
 1

	)

28 
	~<ã©u»s.h
>

31 
	g__BEGIN_DECLS


35 
	~<b™s/”ºo.h
>

36 #undeà
__Ãed_Em©h


38 #ifdef 
_ERRNO_H


45 #iâdef 
”ºo


46 
”ºo
;

49 #ifdeà
__USE_GNU


54 *
´og¿m_švoÿtiÚ_Çme
, *
´og¿m_švoÿtiÚ_shÜt_Çme
;

58 
	g__END_DECLS


66 #ià
defšed
 
__USE_GNU
 || defšed 
__Ãed_”rÜ_t


67 #iâdeà
__”rÜ_t_defšed


68 
	t”rÜ_t
;

69 
	#__”rÜ_t_defšed
 1

	)

71 #undeà
__Ãed_”rÜ_t


	@/usr/include/fcntl.h

22 #iâdef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


31 
	~<b™s/ty³s.h
>

35 
	~<b™s/fú.h
>

40 #iâdeà
__mode_t_defšed


41 
__mode_t
 
	tmode_t
;

42 
	#__mode_t_defšed


	)

45 #iâdeà
__off_t_defšed


46 #iâdeà
__USE_FILE_OFFSET64


47 
__off_t
 
	toff_t
;

49 
__off64_t
 
	toff_t
;

51 
	#__off_t_defšed


	)

54 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


55 
__off64_t
 
	toff64_t
;

56 
	#__off64_t_defšed


	)

59 #iâdeà
__pid_t_defšed


60 
__pid_t
 
	tpid_t
;

61 
	#__pid_t_defšed


	)

65 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


66 
	#__Ãed_time¥ec


	)

67 
	~<time.h
>

68 
	~<b™s/¡©.h
>

70 
	#S_IFMT
 
__S_IFMT


	)

71 
	#S_IFDIR
 
__S_IFDIR


	)

72 
	#S_IFCHR
 
__S_IFCHR


	)

73 
	#S_IFBLK
 
__S_IFBLK


	)

74 
	#S_IFREG
 
__S_IFREG


	)

75 #ifdeà
__S_IFIFO


76 
	#S_IFIFO
 
__S_IFIFO


	)

78 #ifdeà
__S_IFLNK


79 
	#S_IFLNK
 
__S_IFLNK


	)

81 #ià(
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8
è&& defšed 
__S_IFSOCK


82 
	#S_IFSOCK
 
__S_IFSOCK


	)

87 
	#S_ISUID
 
__S_ISUID


	)

88 
	#S_ISGID
 
__S_ISGID


	)

90 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN


92 
	#S_ISVTX
 
__S_ISVTX


	)

95 
	#S_IRUSR
 
__S_IREAD


	)

96 
	#S_IWUSR
 
__S_IWRITE


	)

97 
	#S_IXUSR
 
__S_IEXEC


	)

99 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

101 
	#S_IRGRP
 (
S_IRUSR
 >> 3è

	)

102 
	#S_IWGRP
 (
S_IWUSR
 >> 3è

	)

103 
	#S_IXGRP
 (
S_IXUSR
 >> 3è

	)

105 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

107 
	#S_IROTH
 (
S_IRGRP
 >> 3è

	)

108 
	#S_IWOTH
 (
S_IWGRP
 >> 3è

	)

109 
	#S_IXOTH
 (
S_IXGRP
 >> 3è

	)

111 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

114 #ifdef 
__USE_MISC


115 #iâdeà
R_OK


118 
	#R_OK
 4

	)

119 
	#W_OK
 2

	)

120 
	#X_OK
 1

	)

121 
	#F_OK
 0

	)

126 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


127 
	#SEEK_SET
 0

	)

128 
	#SEEK_CUR
 1

	)

129 
	#SEEK_END
 2

	)

137 
fú
 (
__fd
, 
__cmd
, ...);

145 #iâdeà
__USE_FILE_OFFSET64


146 
	$İ’
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

148 #ifdeà
__REDIRECT


149 
	`__REDIRECT
 (
İ’
, (cÚ¡ *
__fe
, 
__oæag
, ...), 
İ’64
)

150 
	`__nÚnuÎ
 ((1));

152 
	#İ’
 
İ’64


	)

155 #ifdeà
__USE_LARGEFILE64


156 
	$İ’64
 (cÚ¡ *
__fe
, 
__oæag
, ...è
	`__nÚnuÎ
 ((1));

159 #ifdeà
__USE_ATFILE


169 #iâdeà
__USE_FILE_OFFSET64


170 
	$İ’©
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

171 
	`__nÚnuÎ
 ((2));

173 #ifdeà
__REDIRECT


174 
	`__REDIRECT
 (
İ’©
, (
__fd
, cÚ¡ *
__fe
, 
__oæag
,

175 ...), 
İ’©64
è
	`__nÚnuÎ
 ((2));

177 
	#İ’©
 
İ’©64


	)

180 #ifdeà
__USE_LARGEFILE64


181 
	$İ’©64
 (
__fd
, cÚ¡ *
__fe
, 
__oæag
, ...)

182 
	`__nÚnuÎ
 ((2));

191 #iâdeà
__USE_FILE_OFFSET64


192 
	$ü—t
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

194 #ifdeà
__REDIRECT


195 
	`__REDIRECT
 (
ü—t
, (cÚ¡ *
__fe
, 
mode_t
 
__mode
),

196 
ü—t64
è
	`__nÚnuÎ
 ((1));

198 
	#ü—t
 
ü—t64


	)

201 #ifdeà
__USE_LARGEFILE64


202 
	$ü—t64
 (cÚ¡ *
__fe
, 
mode_t
 
__mode
è
	`__nÚnuÎ
 ((1));

205 #ià!
defšed
 
F_LOCK
 && (defšed 
__USE_MISC
 || (defšed 
__USE_XOPEN_EXTENDED
 \

206 && !
defšed
 
__USE_POSIX
))

215 
	#F_ULOCK
 0

	)

216 
	#F_LOCK
 1

	)

217 
	#F_TLOCK
 2

	)

218 
	#F_TEST
 3

	)

220 #iâdeà
__USE_FILE_OFFSET64


221 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__Ën
);

223 #ifdeà
__REDIRECT


224 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
), 
lockf64
);

226 
	#lockf
 
lockf64


	)

229 #ifdeà
__USE_LARGEFILE64


230 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__Ën
);

234 #ifdeà
__USE_XOPEN2K


237 #iâdeà
__USE_FILE_OFFSET64


238 
	$posix_çdvi£
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
,

239 
__advi£
è
__THROW
;

241 #ifdeà
__REDIRECT_NTH


242 
	`__REDIRECT_NTH
 (
posix_çdvi£
, (
__fd
, 
__off64_t
 
__off£t
,

243 
__off64_t
 
__Ën
, 
__advi£
),

244 
posix_çdvi£64
);

246 
	#posix_çdvi£
 
posix_çdvi£64


	)

249 #ifdeà
__USE_LARGEFILE64


250 
	$posix_çdvi£64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
,

251 
__advi£
è
__THROW
;

259 #iâdeà
__USE_FILE_OFFSET64


260 
	`posix_çÎoÿ‹
 (
__fd
, 
off_t
 
__off£t
, off_ˆ
__Ën
);

262 #ifdeà
__REDIRECT


263 
	`__REDIRECT
 (
posix_çÎoÿ‹
, (
__fd
, 
__off64_t
 
__off£t
,

264 
__off64_t
 
__Ën
),

265 
posix_çÎoÿ‹64
);

267 
	#posix_çÎoÿ‹
 
posix_çÎoÿ‹64


	)

270 #ifdeà
__USE_LARGEFILE64


271 
	`posix_çÎoÿ‹64
 (
__fd
, 
off64_t
 
__off£t
, off64_ˆ
__Ën
);

277 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ
 \

278 && 
defšed
 
__va_¬g_·ck_Ën


279 
	~<b™s/fú2.h
>

282 
__END_DECLS


	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

101 #undeà
__USE_ISOC11


102 #undeà
__USE_ISOC99


103 #undeà
__USE_ISOC95


104 #undeà
__USE_ISOCXX11


105 #undeà
__USE_POSIX


106 #undeà
__USE_POSIX2


107 #undeà
__USE_POSIX199309


108 #undeà
__USE_POSIX199506


109 #undeà
__USE_XOPEN


110 #undeà
__USE_XOPEN_EXTENDED


111 #undeà
__USE_UNIX98


112 #undeà
__USE_XOPEN2K


113 #undeà
__USE_XOPEN2KXSI


114 #undeà
__USE_XOPEN2K8


115 #undeà
__USE_XOPEN2K8XSI


116 #undeà
__USE_LARGEFILE


117 #undeà
__USE_LARGEFILE64


118 #undeà
__USE_FILE_OFFSET64


119 #undeà
__USE_BSD


120 #undeà
__USE_SVID


121 #undeà
__USE_MISC


122 #undeà
__USE_ATFILE


123 #undeà
__USE_GNU


124 #undeà
__USE_REENTRANT


125 #undeà
__USE_FORTIFY_LEVEL


126 #undeà
__KERNEL_STRICT_NAMES


130 #iâdeà
_LOOSE_KERNEL_NAMES


131 
	#__KERNEL_STRICT_NAMES


	)

141 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


142 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

143 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

145 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

150 #ifdeà
_GNU_SOURCE


151 #undeà
_ISOC95_SOURCE


152 
	#_ISOC95_SOURCE
 1

	)

153 #undeà
_ISOC99_SOURCE


154 
	#_ISOC99_SOURCE
 1

	)

155 #undeà
_ISOC11_SOURCE


156 
	#_ISOC11_SOURCE
 1

	)

157 #undeà
_POSIX_SOURCE


158 
	#_POSIX_SOURCE
 1

	)

159 #undeà
_POSIX_C_SOURCE


160 
	#_POSIX_C_SOURCE
 200809L

	)

161 #undeà
_XOPEN_SOURCE


162 
	#_XOPEN_SOURCE
 700

	)

163 #undeà
_XOPEN_SOURCE_EXTENDED


164 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

165 #undeà
_LARGEFILE64_SOURCE


166 
	#_LARGEFILE64_SOURCE
 1

	)

167 #undeà
_DEFAULT_SOURCE


168 
	#_DEFAULT_SOURCE
 1

	)

169 #undeà
_BSD_SOURCE


170 
	#_BSD_SOURCE
 1

	)

171 #undeà
_SVID_SOURCE


172 
	#_SVID_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
 \

184 && !
defšed
 
	g_BSD_SOURCE
 && !defšed 
	g_SVID_SOURCE
))

185 #undeà
_DEFAULT_SOURCE


186 
	#_DEFAULT_SOURCE
 1

	)

187 #undeà
_BSD_SOURCE


188 
	#_BSD_SOURCE
 1

	)

189 #undeà
_SVID_SOURCE


190 
	#_SVID_SOURCE
 1

	)

194 #ià(
defšed
 
_ISOC11_SOURCE
 \

195 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

196 
	#__USE_ISOC11
 1

	)

200 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

201 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

202 
	#__USE_ISOC99
 1

	)

206 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

207 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

208 
	#__USE_ISOC95
 1

	)

215 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

216 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

217 
	#__USE_ISOCXX11
 1

	)

223 #ifdeà
_DEFAULT_SOURCE


224 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


225 
	#__USE_POSIX_IMPLICITLY
 1

	)

227 #undeà
_POSIX_SOURCE


228 
	#_POSIX_SOURCE
 1

	)

229 #undeà
_POSIX_C_SOURCE


230 
	#_POSIX_C_SOURCE
 200809L

	)

232 #ià((!
defšed
 
__STRICT_ANSI__
 || (
_XOPEN_SOURCE
 - 0) >= 500) && \

233 !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

234 
	#_POSIX_SOURCE
 1

	)

235 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

236 
	#_POSIX_C_SOURCE
 2

	)

237 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

238 
	#_POSIX_C_SOURCE
 199506L

	)

239 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

240 
	#_POSIX_C_SOURCE
 200112L

	)

242 
	#_POSIX_C_SOURCE
 200809L

	)

244 
	#__USE_POSIX_IMPLICITLY
 1

	)

247 #ià
defšed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >ğ1 || defšed 
_XOPEN_SOURCE


248 
	#__USE_POSIX
 1

	)

251 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


252 
	#__USE_POSIX2
 1

	)

255 #ià(
_POSIX_C_SOURCE
 - 0) >= 199309L

256 
	#__USE_POSIX199309
 1

	)

259 #ià(
_POSIX_C_SOURCE
 - 0) >= 199506L

260 
	#__USE_POSIX199506
 1

	)

263 #ià(
_POSIX_C_SOURCE
 - 0) >= 200112L

264 
	#__USE_XOPEN2K
 1

	)

265 #undeà
__USE_ISOC95


266 
	#__USE_ISOC95
 1

	)

267 #undeà
__USE_ISOC99


268 
	#__USE_ISOC99
 1

	)

271 #ià(
_POSIX_C_SOURCE
 - 0) >= 200809L

272 
	#__USE_XOPEN2K8
 1

	)

273 #undeà
_ATFILE_SOURCE


274 
	#_ATFILE_SOURCE
 1

	)

277 #ifdef 
_XOPEN_SOURCE


278 
	#__USE_XOPEN
 1

	)

279 #ià(
_XOPEN_SOURCE
 - 0) >= 500

280 
	#__USE_XOPEN_EXTENDED
 1

	)

281 
	#__USE_UNIX98
 1

	)

282 #undeà
_LARGEFILE_SOURCE


283 
	#_LARGEFILE_SOURCE
 1

	)

284 #ià(
_XOPEN_SOURCE
 - 0) >= 600

285 #ià(
_XOPEN_SOURCE
 - 0) >= 700

286 
	#__USE_XOPEN2K8
 1

	)

287 
	#__USE_XOPEN2K8XSI
 1

	)

289 
	#__USE_XOPEN2K
 1

	)

290 
	#__USE_XOPEN2KXSI
 1

	)

291 #undeà
__USE_ISOC95


292 
	#__USE_ISOC95
 1

	)

293 #undeà
__USE_ISOC99


294 
	#__USE_ISOC99
 1

	)

297 #ifdeà
_XOPEN_SOURCE_EXTENDED


298 
	#__USE_XOPEN_EXTENDED
 1

	)

303 #ifdeà
_LARGEFILE_SOURCE


304 
	#__USE_LARGEFILE
 1

	)

307 #ifdeà
_LARGEFILE64_SOURCE


308 
	#__USE_LARGEFILE64
 1

	)

311 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

312 
	#__USE_FILE_OFFSET64
 1

	)

315 #ià
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE


316 
	#__USE_MISC
 1

	)

319 #ifdef 
_BSD_SOURCE


320 
	#__USE_BSD
 1

	)

323 #ifdef 
_SVID_SOURCE


324 
	#__USE_SVID
 1

	)

327 #ifdef 
_ATFILE_SOURCE


328 
	#__USE_ATFILE
 1

	)

331 #ifdef 
_GNU_SOURCE


332 
	#__USE_GNU
 1

	)

335 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


336 
	#__USE_REENTRANT
 1

	)

339 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

340 && 
__GNUC_PREREQ
 (4, 1è&& 
defšed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

341 #ià
_FORTIFY_SOURCE
 > 1

342 
	#__USE_FORTIFY_LEVEL
 2

	)

344 
	#__USE_FORTIFY_LEVEL
 1

	)

347 
	#__USE_FORTIFY_LEVEL
 0

	)

352 
	~<¡dc-´edef.h
>

360 #undeà
__GNU_LIBRARY__


361 
	#__GNU_LIBRARY__
 6

	)

365 
	#__GLIBC__
 2

	)

366 
	#__GLIBC_MINOR__
 19

	)

368 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

369 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

372 #iâdeà
__ASSEMBLER__


373 #iâdeà
_SYS_CDEFS_H


374 
	~<sys/cdefs.h
>

379 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


380 
	#__USE_LARGEFILE
 1

	)

381 
	#__USE_LARGEFILE64
 1

	)

387 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

388 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

389 && 
defšed
 
	g__ex‹º_šlše


390 
	#__USE_EXTERN_INLINES
 1

	)

398 
	~<gnu/¡ubs.h
>

	@/usr/include/fnmatch.h

18 #iâdef 
_FNMATCH_H


19 
	#_FNMATCH_H
 1

	)

21 #ifdef 
__ılu¥lus


27 #undeà
FNM_PATHNAME


28 #undeà
FNM_NOESCAPE


29 #undeà
FNM_PERIOD


32 
	#FNM_PATHNAME
 (1 << 0è

	)

33 
	#FNM_NOESCAPE
 (1 << 1è

	)

34 
	#FNM_PERIOD
 (1 << 2è

	)

36 #ià!
defšed
 
_POSIX_C_SOURCE
 || _POSIX_C_SOURCE < 2 || defšed 
_GNU_SOURCE


37 
	#FNM_FILE_NAME
 
FNM_PATHNAME


	)

38 
	#FNM_LEADING_DIR
 (1 << 3è

	)

39 
	#FNM_CASEFOLD
 (1 << 4è

	)

40 
	#FNM_EXTMATCH
 (1 << 5è

	)

44 
	#FNM_NOMATCH
 1

	)

50 #ifdeà
_XOPEN_SOURCE


51 
	#FNM_NOSYS
 (-1)

	)

56 
âm©ch
 (cÚ¡ *
__·‰”n
, cÚ¡ *
__Çme
, 
__æags
);

58 #ifdef 
__ılu¥lus


	@/usr/include/getopt.h

19 #iâdeà
_GETOPT_H


21 #iâdeà
__Ãed_g‘İt


22 
	#_GETOPT_H
 1

	)

32 #ià!
defšed
 
__GNU_LIBRARY__


33 
	~<ùy³.h
>

36 #iâdeà
__THROW


37 #iâdeà
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
mš
è(0)

	)

40 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__ılu¥lus


57 *
İrg
;

71 
İtšd
;

76 
İ‹¼
;

80 
İtİt
;

82 #iâdeà
__Ãed_g‘İt


104 
	sİtiÚ


106 cÚ¡ *
	gÇme
;

109 
	ghas_¬g
;

110 *
	gæag
;

111 
	gv®
;

116 
	#no_¬gum’t
 0

	)

117 
	#»quœed_¬gum’t
 1

	)

118 
	#İtiÚ®_¬gum’t
 2

	)

146 #ifdeà
__GNU_LIBRARY__


150 
g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
, cÚ¡ *
__shÜtİts
)

151 
__THROW
;

153 #ià
defšed
 
__Ãed_g‘İt
 && defšed 
__USE_POSIX2
 \

154 && !
defšed
 
	g__USE_POSIX_IMPLICITLY
 && !defšed 
	g__USE_GNU


158 #ifdeà
__REDIRECT


159 
__REDIRECT_NTH
 (
g‘İt
, (
___¬gc
, *cÚ¡ *
___¬gv
,

160 cÚ¡ *
__shÜtİts
),

161 
__posix_g‘İt
);

163 
__posix_g‘İt
 (
___¬gc
, *cÚ¡ *
___¬gv
,

164 cÚ¡ *
__shÜtİts
è
__THROW
;

165 
	#g‘İt
 
__posix_g‘İt


	)

169 
g‘İt
 ();

172 #iâdeà
__Ãed_g‘İt


173 
g‘İt_lÚg
 (
___¬gc
, *cÚ¡ *
___¬gv
,

174 cÚ¡ *
__shÜtİts
,

175 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

176 
__THROW
;

177 
g‘İt_lÚg_Úly
 (
___¬gc
, *cÚ¡ *
___¬gv
,

178 cÚ¡ *
__shÜtİts
,

179 cÚ¡ 
İtiÚ
 *
__lÚgİts
, *
__lÚgšd
)

180 
__THROW
;

184 #ifdef 
__ılu¥lus


189 #undeà
__Ãed_g‘İt


	@/usr/include/ifaddrs.h

19 #iâdeà
_IFADDRS_H


20 
	#_IFADDRS_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<sys/sock‘.h
>

25 
__BEGIN_DECLS


29 
	siçddrs


31 
içddrs
 *
	miç_Ãxt
;

33 *
	miç_Çme
;

34 
	miç_æags
;

36 
sockaddr
 *
	miç_addr
;

37 
sockaddr
 *
	miç_Ãtmask
;

44 
sockaddr
 *
	mifu_brßdaddr
;

45 
sockaddr
 *
	mifu_d¡addr
;

46 } 
	miç_ifu
;

49 #iâdeà
iç_brßdaddr


50 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

52 #iâdeà
iç_d¡addr


53 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

56 *
	miç_d©a
;

66 
	$g‘içddrs
 (
içddrs
 **
__içp
è
__THROW
;

69 
	$ä“içddrs
 (
içddrs
 *
__iç
è
__THROW
;

71 
__END_DECLS


	@/usr/include/inttypes.h

22 #iâdeà
_INTTYPES_H


23 
	#_INTTYPES_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<¡dšt.h
>

30 #iâdeà
____gwch¬_t_defšed


31 #ifdeà
__ılu¥lus


32 
	#__gwch¬_t
 
wch¬_t


	)

33 #–ià
defšed
 
__WCHAR_TYPE__


34 
__WCHAR_TYPE__
 
	t__gwch¬_t
;

36 
	#__Ãed_wch¬_t


	)

37 
	~<¡ddef.h
>

38 
wch¬_t
 
	t__gwch¬_t
;

40 
	#____gwch¬_t_defšed
 1

	)

43 #ià
__WORDSIZE
 == 64

44 
	#__PRI64_PREFIX
 "l"

	)

45 
	#__PRIPTR_PREFIX
 "l"

	)

47 
	#__PRI64_PREFIX
 "Î"

	)

48 
	#__PRIPTR_PREFIX


	)

54 
	#PRId8
 "d"

	)

55 
	#PRId16
 "d"

	)

56 
	#PRId32
 "d"

	)

57 
	#PRId64
 
__PRI64_PREFIX
 "d"

	)

59 
	#PRIdLEAST8
 "d"

	)

60 
	#PRIdLEAST16
 "d"

	)

61 
	#PRIdLEAST32
 "d"

	)

62 
	#PRIdLEAST64
 
__PRI64_PREFIX
 "d"

	)

64 
	#PRIdFAST8
 "d"

	)

65 
	#PRIdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

66 
	#PRIdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

67 
	#PRIdFAST64
 
__PRI64_PREFIX
 "d"

	)

70 
	#PRIi8
 "i"

	)

71 
	#PRIi16
 "i"

	)

72 
	#PRIi32
 "i"

	)

73 
	#PRIi64
 
__PRI64_PREFIX
 "i"

	)

75 
	#PRIiLEAST8
 "i"

	)

76 
	#PRIiLEAST16
 "i"

	)

77 
	#PRIiLEAST32
 "i"

	)

78 
	#PRIiLEAST64
 
__PRI64_PREFIX
 "i"

	)

80 
	#PRIiFAST8
 "i"

	)

81 
	#PRIiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

82 
	#PRIiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

83 
	#PRIiFAST64
 
__PRI64_PREFIX
 "i"

	)

86 
	#PRIo8
 "o"

	)

87 
	#PRIo16
 "o"

	)

88 
	#PRIo32
 "o"

	)

89 
	#PRIo64
 
__PRI64_PREFIX
 "o"

	)

91 
	#PRIoLEAST8
 "o"

	)

92 
	#PRIoLEAST16
 "o"

	)

93 
	#PRIoLEAST32
 "o"

	)

94 
	#PRIoLEAST64
 
__PRI64_PREFIX
 "o"

	)

96 
	#PRIoFAST8
 "o"

	)

97 
	#PRIoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

98 
	#PRIoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

99 
	#PRIoFAST64
 
__PRI64_PREFIX
 "o"

	)

102 
	#PRIu8
 "u"

	)

103 
	#PRIu16
 "u"

	)

104 
	#PRIu32
 "u"

	)

105 
	#PRIu64
 
__PRI64_PREFIX
 "u"

	)

107 
	#PRIuLEAST8
 "u"

	)

108 
	#PRIuLEAST16
 "u"

	)

109 
	#PRIuLEAST32
 "u"

	)

110 
	#PRIuLEAST64
 
__PRI64_PREFIX
 "u"

	)

112 
	#PRIuFAST8
 "u"

	)

113 
	#PRIuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

114 
	#PRIuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

115 
	#PRIuFAST64
 
__PRI64_PREFIX
 "u"

	)

118 
	#PRIx8
 "x"

	)

119 
	#PRIx16
 "x"

	)

120 
	#PRIx32
 "x"

	)

121 
	#PRIx64
 
__PRI64_PREFIX
 "x"

	)

123 
	#PRIxLEAST8
 "x"

	)

124 
	#PRIxLEAST16
 "x"

	)

125 
	#PRIxLEAST32
 "x"

	)

126 
	#PRIxLEAST64
 
__PRI64_PREFIX
 "x"

	)

128 
	#PRIxFAST8
 "x"

	)

129 
	#PRIxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

130 
	#PRIxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

131 
	#PRIxFAST64
 
__PRI64_PREFIX
 "x"

	)

134 
	#PRIX8
 "X"

	)

135 
	#PRIX16
 "X"

	)

136 
	#PRIX32
 "X"

	)

137 
	#PRIX64
 
__PRI64_PREFIX
 "X"

	)

139 
	#PRIXLEAST8
 "X"

	)

140 
	#PRIXLEAST16
 "X"

	)

141 
	#PRIXLEAST32
 "X"

	)

142 
	#PRIXLEAST64
 
__PRI64_PREFIX
 "X"

	)

144 
	#PRIXFAST8
 "X"

	)

145 
	#PRIXFAST16
 
__PRIPTR_PREFIX
 "X"

	)

146 
	#PRIXFAST32
 
__PRIPTR_PREFIX
 "X"

	)

147 
	#PRIXFAST64
 
__PRI64_PREFIX
 "X"

	)

151 
	#PRIdMAX
 
__PRI64_PREFIX
 "d"

	)

152 
	#PRIiMAX
 
__PRI64_PREFIX
 "i"

	)

153 
	#PRIoMAX
 
__PRI64_PREFIX
 "o"

	)

154 
	#PRIuMAX
 
__PRI64_PREFIX
 "u"

	)

155 
	#PRIxMAX
 
__PRI64_PREFIX
 "x"

	)

156 
	#PRIXMAX
 
__PRI64_PREFIX
 "X"

	)

160 
	#PRIdPTR
 
__PRIPTR_PREFIX
 "d"

	)

161 
	#PRIiPTR
 
__PRIPTR_PREFIX
 "i"

	)

162 
	#PRIoPTR
 
__PRIPTR_PREFIX
 "o"

	)

163 
	#PRIuPTR
 
__PRIPTR_PREFIX
 "u"

	)

164 
	#PRIxPTR
 
__PRIPTR_PREFIX
 "x"

	)

165 
	#PRIXPTR
 
__PRIPTR_PREFIX
 "X"

	)

171 
	#SCNd8
 "hhd"

	)

172 
	#SCNd16
 "hd"

	)

173 
	#SCNd32
 "d"

	)

174 
	#SCNd64
 
__PRI64_PREFIX
 "d"

	)

176 
	#SCNdLEAST8
 "hhd"

	)

177 
	#SCNdLEAST16
 "hd"

	)

178 
	#SCNdLEAST32
 "d"

	)

179 
	#SCNdLEAST64
 
__PRI64_PREFIX
 "d"

	)

181 
	#SCNdFAST8
 "hhd"

	)

182 
	#SCNdFAST16
 
__PRIPTR_PREFIX
 "d"

	)

183 
	#SCNdFAST32
 
__PRIPTR_PREFIX
 "d"

	)

184 
	#SCNdFAST64
 
__PRI64_PREFIX
 "d"

	)

187 
	#SCNi8
 "hhi"

	)

188 
	#SCNi16
 "hi"

	)

189 
	#SCNi32
 "i"

	)

190 
	#SCNi64
 
__PRI64_PREFIX
 "i"

	)

192 
	#SCNiLEAST8
 "hhi"

	)

193 
	#SCNiLEAST16
 "hi"

	)

194 
	#SCNiLEAST32
 "i"

	)

195 
	#SCNiLEAST64
 
__PRI64_PREFIX
 "i"

	)

197 
	#SCNiFAST8
 "hhi"

	)

198 
	#SCNiFAST16
 
__PRIPTR_PREFIX
 "i"

	)

199 
	#SCNiFAST32
 
__PRIPTR_PREFIX
 "i"

	)

200 
	#SCNiFAST64
 
__PRI64_PREFIX
 "i"

	)

203 
	#SCNu8
 "hhu"

	)

204 
	#SCNu16
 "hu"

	)

205 
	#SCNu32
 "u"

	)

206 
	#SCNu64
 
__PRI64_PREFIX
 "u"

	)

208 
	#SCNuLEAST8
 "hhu"

	)

209 
	#SCNuLEAST16
 "hu"

	)

210 
	#SCNuLEAST32
 "u"

	)

211 
	#SCNuLEAST64
 
__PRI64_PREFIX
 "u"

	)

213 
	#SCNuFAST8
 "hhu"

	)

214 
	#SCNuFAST16
 
__PRIPTR_PREFIX
 "u"

	)

215 
	#SCNuFAST32
 
__PRIPTR_PREFIX
 "u"

	)

216 
	#SCNuFAST64
 
__PRI64_PREFIX
 "u"

	)

219 
	#SCNo8
 "hho"

	)

220 
	#SCNo16
 "ho"

	)

221 
	#SCNo32
 "o"

	)

222 
	#SCNo64
 
__PRI64_PREFIX
 "o"

	)

224 
	#SCNoLEAST8
 "hho"

	)

225 
	#SCNoLEAST16
 "ho"

	)

226 
	#SCNoLEAST32
 "o"

	)

227 
	#SCNoLEAST64
 
__PRI64_PREFIX
 "o"

	)

229 
	#SCNoFAST8
 "hho"

	)

230 
	#SCNoFAST16
 
__PRIPTR_PREFIX
 "o"

	)

231 
	#SCNoFAST32
 
__PRIPTR_PREFIX
 "o"

	)

232 
	#SCNoFAST64
 
__PRI64_PREFIX
 "o"

	)

235 
	#SCNx8
 "hhx"

	)

236 
	#SCNx16
 "hx"

	)

237 
	#SCNx32
 "x"

	)

238 
	#SCNx64
 
__PRI64_PREFIX
 "x"

	)

240 
	#SCNxLEAST8
 "hhx"

	)

241 
	#SCNxLEAST16
 "hx"

	)

242 
	#SCNxLEAST32
 "x"

	)

243 
	#SCNxLEAST64
 
__PRI64_PREFIX
 "x"

	)

245 
	#SCNxFAST8
 "hhx"

	)

246 
	#SCNxFAST16
 
__PRIPTR_PREFIX
 "x"

	)

247 
	#SCNxFAST32
 
__PRIPTR_PREFIX
 "x"

	)

248 
	#SCNxFAST64
 
__PRI64_PREFIX
 "x"

	)

252 
	#SCNdMAX
 
__PRI64_PREFIX
 "d"

	)

253 
	#SCNiMAX
 
__PRI64_PREFIX
 "i"

	)

254 
	#SCNoMAX
 
__PRI64_PREFIX
 "o"

	)

255 
	#SCNuMAX
 
__PRI64_PREFIX
 "u"

	)

256 
	#SCNxMAX
 
__PRI64_PREFIX
 "x"

	)

259 
	#SCNdPTR
 
__PRIPTR_PREFIX
 "d"

	)

260 
	#SCNiPTR
 
__PRIPTR_PREFIX
 "i"

	)

261 
	#SCNoPTR
 
__PRIPTR_PREFIX
 "o"

	)

262 
	#SCNuPTR
 
__PRIPTR_PREFIX
 "u"

	)

263 
	#SCNxPTR
 
__PRIPTR_PREFIX
 "x"

	)

266 
	g__BEGIN_DECLS


268 #ià
__WORDSIZE
 == 64

273 
	mquÙ
;

274 
	m»m
;

275 } 
	timaxdiv_t
;

282 
__ex‹nsiÚ__
 
	mquÙ
;

283 
__ex‹nsiÚ__
 
	m»m
;

284 } 
	timaxdiv_t
;

290 
štmax_t
 
	$imaxabs
 (
štmax_t
 
__n
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

293 
imaxdiv_t
 
	$imaxdiv
 (
štmax_t
 
__num”
, iÁmax_ˆ
__d’om
)

294 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

297 
štmax_t
 
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

298 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

301 
uštmax_t
 
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

302 ** 
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

305 
štmax_t
 
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

306 
__gwch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

307 
__THROW
;

310 
uštmax_t
 
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

311 
__gwch¬_t
 ** 
__»¡riù
 
__’d±r
, 
__ba£
)

312 
__THROW
;

314 #ifdeà
__USE_EXTERN_INLINES


316 #ià
__WORDSIZE
 == 64

318 
	$__¡¹Ş_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

319 **
__»¡riù
 
__’d±r
,

320 
__ba£
, 
__group
)

321 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

323 
__ex‹º_šlše
 
štmax_t


324 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

325 
ba£
))

327  
	`__¡¹Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

328 
	}
}

330 
	$__¡¹oul_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

331 ** 
__»¡riù
 
__’d±r
,

332 
__ba£
, 
__group
)

333 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

335 
__ex‹º_šlše
 
uštmax_t


336 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

337 
ba£
))

339  
	`__¡¹oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

340 
	}
}

342 
	$__wc¡Ş_š‹º®
 (cÚ¡ 
__gwch¬_t
 * 
__»¡riù
 
__ÅŒ
,

343 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

344 
__ba£
, 
__group
)

345 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

347 
__ex‹º_šlše
 
štmax_t


348 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

349 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

351  
	`__wc¡Ş_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

352 
	}
}

354 
	$__wc¡oul_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

355 
__»¡riù
 
__ÅŒ
,

356 
__gwch¬_t
 **

357 
__»¡riù
 
__’d±r
,

358 
__ba£
, 
__group
)

359 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

361 
__ex‹º_šlše
 
uštmax_t


362 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

363 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

365  
	`__wc¡oul_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

366 
	}
}

370 
__ex‹nsiÚ__


371 
	$__¡¹Şl_š‹º®
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

372 **
__»¡riù
 
__’d±r
,

373 
__ba£
, 
__group
)

374 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

376 
__ex‹º_šlše
 
štmax_t


377 
	`__NTH
 (
	$¡¹oimax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

378 
ba£
))

380  
	`__¡¹Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

381 
	}
}

383 
__ex‹nsiÚ__


384 
	$__¡¹ouÎ_š‹º®
 (const *

385 
__»¡riù
 
__ÅŒ
,

387 
__»¡riù
 
__’d±r
,

388 
__ba£
,

389 
__group
)

390 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

392 
__ex‹º_šlše
 
uštmax_t


393 
	`__NTH
 (
	$¡¹oumax
 (cÚ¡ *
__»¡riù
 
ÅŒ
, **__»¡riù 
’d±r
,

394 
ba£
))

396  
	`__¡¹ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

397 
	}
}

399 
__ex‹nsiÚ__


400 
	$__wc¡Şl_š‹º®
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
__ÅŒ
,

401 
__gwch¬_t
 **
__»¡riù
 
__’d±r
,

402 
__ba£
, 
__group
)

403 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

405 
__ex‹º_šlše
 
štmax_t


406 
	`__NTH
 (
	$wc¡oimax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

407 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

409  
	`__wc¡Şl_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

410 
	}
}

413 
__ex‹nsiÚ__


414 
	$__wc¡ouÎ_š‹º®
 (cÚ¡ 
__gwch¬_t
 *

415 
__»¡riù
 
__ÅŒ
,

416 
__gwch¬_t
 **

417 
__»¡riù
 
__’d±r
,

418 
__ba£
,

419 
__group
)

420 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

422 
__ex‹º_šlše
 
uštmax_t


423 
	`__NTH
 (
	$wc¡oumax
 (cÚ¡ 
__gwch¬_t
 *
__»¡riù
 
ÅŒ
,

424 
__gwch¬_t
 **
__»¡riù
 
’d±r
, 
ba£
))

426  
	`__wc¡ouÎ_š‹º®
 (
ÅŒ
, 
’d±r
, 
ba£
, 0);

427 
	}
}

432 
	g__END_DECLS


	@/usr/include/libintl.h

20 #iâdeà
_LIBINTL_H


21 
	#_LIBINTL_H
 1

	)

23 
	~<ã©u»s.h
>

27 
	#__USE_GNU_GETTEXT
 1

	)

31 
	#__GNU_GETTEXT_SUPPORTED_REVISION
(
majÜ
) \

32 ((
majÜ
è=ğ0 ? 1 : -1)

	)

34 
__BEGIN_DECLS


39 *
	$g‘‹xt
 (cÚ¡ *
__msgid
)

40 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (1);

44 *
	$dg‘‹xt
 (cÚ¡ *
__domašÇme
, cÚ¡ *
__msgid
)

45 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

46 *
	$__dg‘‹xt
 (cÚ¡ *
__domašÇme
, cÚ¡ *
__msgid
)

47 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

51 *
	$dcg‘‹xt
 (cÚ¡ *
__domašÇme
,

52 cÚ¡ *
__msgid
, 
__ÿ‹gÜy
)

53 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

54 *
	$__dcg‘‹xt
 (cÚ¡ *
__domašÇme
,

55 cÚ¡ *
__msgid
, 
__ÿ‹gÜy
)

56 
__THROW
 
	`__©Œibu‹_fÜm©_¬g__
 (2);

61 *
	$ng‘‹xt
 (cÚ¡ *
__msgid1
, cÚ¡ *
__msgid2
,

62 
__n
)

63 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (1è
	`__©Œibu‹_fÜm©_¬g__
 (2);

67 *
	$dng‘‹xt
 (cÚ¡ *
__domašÇme
, cÚ¡ *
__msgid1
,

68 cÚ¡ *
__msgid2
, 
__n
)

69 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

73 *
	$dúg‘‹xt
 (cÚ¡ *
__domašÇme
, cÚ¡ *
__msgid1
,

74 cÚ¡ *
__msgid2
, 
__n
,

75 
__ÿ‹gÜy
)

76 
__THROW
 
	$__©Œibu‹_fÜm©_¬g__
 (2è
	`__©Œibu‹_fÜm©_¬g__
 (3);

82 *
	$‹xtdomaš
 (cÚ¡ *
__domašÇme
è
__THROW
;

86 *
	$bšd‹xtdomaš
 (cÚ¡ *
__domašÇme
,

87 cÚ¡ *
__dœÇme
è
__THROW
;

91 *
	$bšd_‹xtdomaš_code£t
 (cÚ¡ *
__domašÇme
,

92 cÚ¡ *
__code£t
è
__THROW
;

96 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__ılu¥lus


99 
	#__Ãed_NULL


	)

100 
	~<¡ddef.h
>

103 
	~<loÿË.h
>

109 
	#g‘‹xt
(
msgid
è
	`dg‘‹xt
 (
NULL
, msgid)

	)

111 
	#dg‘‹xt
(
domašÇme
, 
msgid
) \

112 
	`dcg‘‹xt
 (
domašÇme
, 
msgid
, 
LC_MESSAGES
)

	)

114 
	#ng‘‹xt
(
msgid1
, 
msgid2
, 
n
è
	`dng‘‹xt
 (
NULL
, msgid1, msgid2,‚)

	)

116 
	#dng‘‹xt
(
domašÇme
, 
msgid1
, 
msgid2
, 
n
) \

117 
	`dúg‘‹xt
 (
domašÇme
, 
msgid1
, 
msgid2
, 
n
, 
LC_MESSAGES
)

	)

121 
__END_DECLS


	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/atalk.h

1 #iâdeà
__LINUX_ATALK_H__


2 
	#__LINUX_ATALK_H__


	)

4 
	~<lšux/ty³s.h
>

5 
	~<asm/by‹Üd”.h
>

6 
	~<lšux/sock‘.h
>

14 
	#ATPORT_FIRST
 1

	)

15 
	#ATPORT_RESERVED
 128

	)

16 
	#ATPORT_LAST
 254

	)

17 
	#ATADDR_ANYNET
 (
__u16
)0

	)

18 
	#ATADDR_ANYNODE
 (
__u8
)0

	)

19 
	#ATADDR_ANYPORT
 (
__u8
)0

	)

20 
	#ATADDR_BCAST
 (
__u8
)255

	)

21 
	#DDP_MAXSZ
 587

	)

22 
	#DDP_MAXHOPS
 15

	)

24 
	#SIOCATALKDIFADDR
 (
SIOCPROTOPRIVATE
 + 0)

	)

26 
	s©®k_addr
 {

27 
__be16
 
	ms_Ãt
;

28 
__u8
 
	ms_node
;

31 
	ssockaddr_©
 {

32 
__k”Ãl_§_çmy_t
 
	m§t_çmy
;

33 
__u8
 
	m§t_pÜt
;

34 
©®k_addr
 
	m§t_addr
;

35 
	m§t_z”o
[8];

38 
	s©®k_ÃŒªge
 {

39 
__u8
 
	mÄ_pha£
;

40 
__be16
 
	mÄ_fœ¡Ãt
;

41 
__be16
 
	mÄ_Ï¡Ãt
;

	@/usr/include/linux/atm.h

11 #iâdeà
_LINUX_ATM_H


12 
	#_LINUX_ATM_H


	)

20 
	~<lšux/©m­i.h
>

21 
	~<lšux/©m§p.h
>

22 
	~<lšux/©mioc.h
>

23 
	~<lšux/ty³s.h
>

27 
	#ATM_CELL_SIZE
 53

	)

28 
	#ATM_CELL_PAYLOAD
 48

	)

29 
	#ATM_AAL0_SDU
 52

	)

30 
	#ATM_MAX_AAL34_PDU
 65535

	)

31 
	#ATM_AAL5_TRAILER
 8

	)

32 
	#ATM_MAX_AAL5_PDU
 65535

	)

33 
	#ATM_MAX_CDV
 9999

	)

34 
	#ATM_NOT_RSV_VCI
 32

	)

36 
	#ATM_MAX_VPI
 255

	)

37 
	#ATM_MAX_VPI_NNI
 4096

	)

38 
	#ATM_MAX_VCI
 65535

	)

42 
	#ATM_NO_AAL
 0

	)

43 
	#ATM_AAL0
 13

	)

44 
	#ATM_AAL1
 1

	)

45 
	#ATM_AAL2
 2

	)

46 
	#ATM_AAL34
 3

	)

47 
	#ATM_AAL5
 5

	)

57 
	#__SO_ENCODE
(
l
,
n
,
t
) ((((l) & 0x1FF) << 22) | ((n) << 16) | \

58 (
t
))

	)

59 
	#__SO_LEVEL_MATCH
(
c
,
m
è(((cè>> 22è=ğ((mè& 0x1FF))

	)

60 
	#__SO_NUMBER
(
c
è(((cè>> 16è& 0x3f)

	)

61 
	#__SO_SIZE
(
c
è((cè& 0x3fff)

	)

67 
	#SO_SETCLP
 
	`__SO_ENCODE
(
SOL_ATM
,0,)

	)

69 
	#SO_CIRANGE
 
	`__SO_ENCODE
(
SOL_ATM
,1,
©m_cœªge
)

	)

72 
	#SO_ATMQOS
 
	`__SO_ENCODE
(
SOL_ATM
,2,
©m_qos
)

	)

74 
	#SO_ATMSAP
 
	`__SO_ENCODE
(
SOL_ATM
,3,
©m_§p
)

	)

76 
	#SO_ATMPVC
 
	`__SO_ENCODE
(
SOL_ATM
,4,
sockaddr_©mpvc
)

	)

78 
	#SO_MULTIPOINT
 
	`__SO_ENCODE
(
SOL_ATM
, 5, )

	)

93 
	#ATM_HDR_GFC_MASK
 0xf0000000

	)

94 
	#ATM_HDR_GFC_SHIFT
 28

	)

95 
	#ATM_HDR_VPI_MASK
 0x0ff00000

	)

96 
	#ATM_HDR_VPI_SHIFT
 20

	)

97 
	#ATM_HDR_VCI_MASK
 0x000ffff0

	)

98 
	#ATM_HDR_VCI_SHIFT
 4

	)

99 
	#ATM_HDR_PTI_MASK
 0x0000000e

	)

100 
	#ATM_HDR_PTI_SHIFT
 1

	)

101 
	#ATM_HDR_CLP
 0x00000001

	)

108 
	#ATM_PTI_US0
 0

	)

109 
	#ATM_PTI_US1
 1

	)

110 
	#ATM_PTI_UCES0
 2

	)

111 
	#ATM_PTI_UCES1
 3

	)

112 
	#ATM_PTI_SEGF5
 4

	)

113 
	#ATM_PTI_E2EF5
 5

	)

114 
	#ATM_PTI_RSV_RM
 6

	)

115 
	#ATM_PTI_RSV
 7

	)

126 
	#ATM_NONE
 0

	)

127 
	#ATM_UBR
 1

	)

128 
	#ATM_CBR
 2

	)

129 
	#ATM_VBR
 3

	)

130 
	#ATM_ABR
 4

	)

131 
	#ATM_ANYCLASS
 5

	)

133 
	#ATM_MAX_PCR
 -1

	)

135 
	s©m_Œaårm
 {

136 
	mŒaffic_şass
;

137 
	mmax_pü
;

138 
	mpü
;

139 
	mmš_pü
;

140 
	mmax_cdv
;

141 
	mmax_sdu
;

143 
	miü
;

144 
	mtbe
;

145 
	mä‰
 : 24;

146 
	mrif
 : 4;

147 
	mrdf
 : 4;

148 
	mÄm_´es
 :1;

149 
	mŒm_´es
 :1;

150 
	madtf_´es
 :1;

151 
	mcdf_´es
 :1;

152 
	mÄm
 :3;

153 
	mŒm
 :3;

154 
	madtf
 :10;

155 
	mcdf
 :3;

156 
	m¥¬e
 :9;

159 
	s©m_qos
 {

160 
©m_Œaårm
 
	mtx
;

161 
©m_Œaårm
 
rx
 
	m__ATM_API_ALIGN
;

163 
¯l
 
	m__ATM_API_ALIGN
;

168 
	#ATM_ITF_ANY
 -1

	)

169 
	#ATM_VPI_ANY
 -1

	)

170 
	#ATM_VCI_ANY
 -1

	)

171 
	#ATM_VPI_UNSPEC
 -2

	)

172 
	#ATM_VCI_UNSPEC
 -2

	)

175 
	ssockaddr_©mpvc
 {

176 
	m§p_çmy
;

178 
	m™f
;

179 
	mvpi
;

180 
	mvci
;

181 } 
§p_addr
 
	m__ATM_API_ALIGN
;

186 
	#ATM_ESA_LEN
 20

	)

187 
	#ATM_E164_LEN
 12

	)

189 
	#ATM_AFI_DCC
 0x39

	)

190 
	#ATM_AFI_ICD
 0x47

	)

191 
	#ATM_AFI_E164
 0x45

	)

192 
	#ATM_AFI_LOCAL
 0x49

	)

194 
	#ATM_AFI_DCC_GROUP
 0xBD

	)

195 
	#ATM_AFI_ICD_GROUP
 0xC5

	)

196 
	#ATM_AFI_E164_GROUP
 0xC3

	)

197 
	#ATM_AFI_LOCAL_GROUP
 0xC7

	)

199 
	#ATM_LIJ_NONE
 0

	)

200 
	#ATM_LIJ
 1

	)

201 
	#ATM_LIJ_RPJ
 2

	)

202 
	#ATM_LIJ_NJ
 3

	)

205 
	ssockaddr_©msvc
 {

206 
	m§s_çmy
;

208 
	m´v
[
ATM_ESA_LEN
];

209 
	mpub
[
ATM_E164_LEN
+1];

211 
	mlij_ty³
;

212 
__u32
 
	mlij_id
;

213 } 
§s_addr
 
	m__ATM_API_ALIGN
;

217 
__šlše__
 
	$©msvc_addr_š_u£
(
sockaddr_©msvc
 
addr
)

219  *
addr
.
§s_addr
.
´v
 || *addr.§s_addr.
pub
;

220 
	}
}

223 
__šlše__
 
	$©mpvc_addr_š_u£
(
sockaddr_©mpvc
 
addr
)

225  
addr
.
§p_addr
.
™f
 ||‡ddr.§p_addr.
vpi
 ||‡ddr.§p_addr.
vci
;

226 
	}
}

233 
	s©mif_sioc
 {

234 
	mnumb”
;

235 
	mËngth
;

236 *
	m¬g
;

240 
	t©m_back’d_t
;

	@/usr/include/linux/ax25.h

6 #iâdef 
AX25_KERNEL_H


7 
	#AX25_KERNEL_H


	)

9 
	~<lšux/sock‘.h
>

11 
	#AX25_MTU
 256

	)

12 
	#AX25_MAX_DIGIS
 8

	)

14 
	#AX25_WINDOW
 1

	)

15 
	#AX25_T1
 2

	)

16 
	#AX25_N2
 3

	)

17 
	#AX25_T3
 4

	)

18 
	#AX25_T2
 5

	)

19 
	#AX25_BACKOFF
 6

	)

20 
	#AX25_EXTSEQ
 7

	)

21 
	#AX25_PIDINCL
 8

	)

22 
	#AX25_IDLE
 9

	)

23 
	#AX25_PACLEN
 10

	)

24 
	#AX25_IAMDIGI
 12

	)

26 
	#AX25_KILL
 99

	)

28 
	#SIOCAX25GETUID
 (
SIOCPROTOPRIVATE
+0)

	)

29 
	#SIOCAX25ADDUID
 (
SIOCPROTOPRIVATE
+1)

	)

30 
	#SIOCAX25DELUID
 (
SIOCPROTOPRIVATE
+2)

	)

31 
	#SIOCAX25NOUID
 (
SIOCPROTOPRIVATE
+3)

	)

32 
	#SIOCAX25OPTRT
 (
SIOCPROTOPRIVATE
+7)

	)

33 
	#SIOCAX25CTLCON
 (
SIOCPROTOPRIVATE
+8)

	)

34 
	#SIOCAX25GETINFOOLD
 (
SIOCPROTOPRIVATE
+9)

	)

35 
	#SIOCAX25ADDFWD
 (
SIOCPROTOPRIVATE
+10)

	)

36 
	#SIOCAX25DELFWD
 (
SIOCPROTOPRIVATE
+11)

	)

37 
	#SIOCAX25DEVCTL
 (
SIOCPROTOPRIVATE
+12)

	)

38 
	#SIOCAX25GETINFO
 (
SIOCPROTOPRIVATE
+13)

	)

40 
	#AX25_SET_RT_IPMODE
 2

	)

42 
	#AX25_NOUID_DEFAULT
 0

	)

43 
	#AX25_NOUID_BLOCK
 1

	)

46 
	max25_ÿÎ
[7];

47 } 
	tax25_add»ss
;

49 
	ssockaddr_ax25
 {

50 
__k”Ãl_§_çmy_t
 
	m§x25_çmy
;

51 
ax25_add»ss
 
	m§x25_ÿÎ
;

52 
	m§x25_ndigis
;

56 
	#§x25_uid
 
§x25_ndigis


	)

58 
	sfuÎ_sockaddr_ax25
 {

59 
sockaddr_ax25
 
	mf§_ax25
;

60 
ax25_add»ss
 
	mf§_dig—‹r
[
AX25_MAX_DIGIS
];

63 
	sax25_rou‹s_¡ruù
 {

64 
ax25_add»ss
 
	mpÜt_addr
;

65 
ax25_add»ss
 
	mde¡_addr
;

66 
	mdigi_couÁ
;

67 
ax25_add»ss
 
	mdigi_addr
[
AX25_MAX_DIGIS
];

70 
	sax25_rou‹_İt_¡ruù
 {

71 
ax25_add»ss
 
	mpÜt_addr
;

72 
ax25_add»ss
 
	mde¡_addr
;

73 
	mcmd
;

74 
	m¬g
;

77 
	sax25_ùl_¡ruù
 {

78 
ax25_add»ss
 
	mpÜt_addr
;

79 
ax25_add»ss
 
	msourû_addr
;

80 
ax25_add»ss
 
	mde¡_addr
;

81 
	mcmd
;

82 
	m¬g
;

83 
	mdigi_couÁ
;

84 
ax25_add»ss
 
	mdigi_addr
[
AX25_MAX_DIGIS
];

88 
	sax25_šfo_¡ruù_d•»ÿ‹d
 {

89 
	mn2
, 
	mn2couÁ
;

90 
	mt1
, 
	mt1tim”
;

91 
	mt2
, 
	mt2tim”
;

92 
	mt3
, 
	mt3tim”
;

93 
	midË
, 
	midËtim”
;

94 
	m¡©e
;

95 
	mrcv_q
, 
	m¢d_q
;

98 
	sax25_šfo_¡ruù
 {

99 
	mn2
, 
	mn2couÁ
;

100 
	mt1
, 
	mt1tim”
;

101 
	mt2
, 
	mt2tim”
;

102 
	mt3
, 
	mt3tim”
;

103 
	midË
, 
	midËtim”
;

104 
	m¡©e
;

105 
	mrcv_q
, 
	m¢d_q
;

106 
	mvs
, 
	mvr
, 
	mva
, 
	mvs_max
;

107 
	m·ş’
;

108 
	mwšdow
;

111 
	sax25_fwd_¡ruù
 {

112 
ax25_add»ss
 
	mpÜt_äom
;

113 
ax25_add»ss
 
	mpÜt_to
;

	@/usr/include/linux/can/netlink.h

18 #iâdeà
_CAN_NETLINK_H


19 
	#_CAN_NETLINK_H


	)

21 
	~<lšux/ty³s.h
>

30 
	sÿn_b™timšg
 {

31 
__u32
 
	mb™¿‹
;

32 
__u32
 
	m§m¶e_pošt
;

33 
__u32
 
	mtq
;

34 
__u32
 
	m´İ_£g
;

35 
__u32
 
	mpha£_£g1
;

36 
__u32
 
	mpha£_£g2
;

37 
__u32
 
	msjw
;

38 
__u32
 
	mb½
;

46 
	sÿn_b™timšg_cÚ¡
 {

47 
	mÇme
[16];

48 
__u32
 
	mt£g1_mš
;

49 
__u32
 
	mt£g1_max
;

50 
__u32
 
	mt£g2_mš
;

51 
__u32
 
	mt£g2_max
;

52 
__u32
 
	msjw_max
;

53 
__u32
 
	mb½_mš
;

54 
__u32
 
	mb½_max
;

55 
__u32
 
	mb½_šc
;

61 
	sÿn_şock
 {

62 
__u32
 
	mäeq
;

68 
	eÿn_¡©e
 {

69 
	mCAN_STATE_ERROR_ACTIVE
 = 0,

70 
	mCAN_STATE_ERROR_WARNING
,

71 
	mCAN_STATE_ERROR_PASSIVE
,

72 
	mCAN_STATE_BUS_OFF
,

73 
	mCAN_STATE_STOPPED
,

74 
	mCAN_STATE_SLEEPING
,

75 
	mCAN_STATE_MAX


81 
	sÿn_b”r_couÁ”
 {

82 
__u16
 
	mtx”r
;

83 
__u16
 
	mrx”r
;

89 
	sÿn_ù¾mode
 {

90 
__u32
 
	mmask
;

91 
__u32
 
	mæags
;

94 
	#CAN_CTRLMODE_LOOPBACK
 0x01

	)

95 
	#CAN_CTRLMODE_LISTENONLY
 0x02

	)

96 
	#CAN_CTRLMODE_3_SAMPLES
 0x04

	)

97 
	#CAN_CTRLMODE_ONE_SHOT
 0x08

	)

98 
	#CAN_CTRLMODE_BERR_REPORTING
 0x10

	)

99 
	#CAN_CTRLMODE_FD
 0x20

	)

100 
	#CAN_CTRLMODE_PRESUME_ACK
 0x40

	)

101 
	#CAN_CTRLMODE_FD_NON_ISO
 0x80

	)

106 
	sÿn_deviû_¡©s
 {

107 
__u32
 
	mbus_”rÜ
;

108 
__u32
 
	m”rÜ_w¬nšg
;

109 
__u32
 
	m”rÜ_·ssive
;

110 
__u32
 
	mbus_off
;

111 
__u32
 
	m¬b™¿tiÚ_lo¡
;

112 
__u32
 
	m»¡¬ts
;

119 
	mIFLA_CAN_UNSPEC
,

120 
	mIFLA_CAN_BITTIMING
,

121 
	mIFLA_CAN_BITTIMING_CONST
,

122 
	mIFLA_CAN_CLOCK
,

123 
	mIFLA_CAN_STATE
,

124 
	mIFLA_CAN_CTRLMODE
,

125 
	mIFLA_CAN_RESTART_MS
,

126 
	mIFLA_CAN_RESTART
,

127 
	mIFLA_CAN_BERR_COUNTER
,

128 
	mIFLA_CAN_DATA_BITTIMING
,

129 
	mIFLA_CAN_DATA_BITTIMING_CONST
,

130 
	m__IFLA_CAN_MAX


133 
	#IFLA_CAN_MAX
 (
__IFLA_CAN_MAX
 - 1)

	)

	@/usr/include/linux/ethtool.h

13 #iâdeà
_LINUX_ETHTOOL_H


14 
	#_LINUX_ETHTOOL_H


	)

16 
	~<lšux/ty³s.h
>

17 
	~<lšux/if_‘h”.h
>

19 
	~<lim™s.h
>

96 
	s‘htoŞ_cmd
 {

97 
__u32
 
	mcmd
;

98 
__u32
 
	msuµÜ‹d
;

99 
__u32
 
	madv”tisšg
;

100 
__u16
 
	m¥“d
;

101 
__u8
 
	mdu¶ex
;

102 
__u8
 
	mpÜt
;

103 
__u8
 
	mphy_add»ss
;

104 
__u8
 
	mŒªsûiv”
;

105 
__u8
 
	mautÚeg
;

106 
__u8
 
	mmdio_suµÜt
;

107 
__u32
 
	mmaxtxpkt
;

108 
__u32
 
	mmaxrxpkt
;

109 
__u16
 
	m¥“d_hi
;

110 
__u8
 
	m‘h__mdix
;

111 
__u8
 
	m‘h__mdix_ù¾
;

112 
__u32
 
	mÍ_adv”tisšg
;

113 
__u32
 
	m»£rved
[2];

116 
__šlše__
 
	$‘htoŞ_cmd_¥“d_£t
(
‘htoŞ_cmd
 *
•
,

117 
__u32
 
¥“d
)

120 
•
->
¥“d
 = (
__u16
)speed;

121 
•
->
¥“d_hi
 = (
__u16
)(
¥“d
 >> 16);

122 
	}
}

124 
__šlše__
 
__u32
 
	$‘htoŞ_cmd_¥“d
(cÚ¡ 
‘htoŞ_cmd
 *
•
)

126  (
•
->
¥“d_hi
 << 16è|ƒp->
¥“d
;

127 
	}
}

134 
	#ETH_MDIO_SUPPORTS_C22
 1

	)

141 
	#ETH_MDIO_SUPPORTS_C45
 2

	)

143 
	#ETHTOOL_FWVERS_LEN
 32

	)

144 
	#ETHTOOL_BUSINFO_LEN
 32

	)

145 
	#ETHTOOL_EROMVERS_LEN
 32

	)

178 
	s‘htoŞ_drvšfo
 {

179 
__u32
 
	mcmd
;

180 
	mdriv”
[32];

181 
	mv”siÚ
[32];

182 
	mfw_v”siÚ
[
ETHTOOL_FWVERS_LEN
];

183 
	mbus_šfo
[
ETHTOOL_BUSINFO_LEN
];

184 
	m”om_v”siÚ
[
ETHTOOL_EROMVERS_LEN
];

185 
	m»£rved2
[12];

186 
__u32
 
	mn_´iv_æags
;

187 
__u32
 
	mn_¡©s
;

188 
__u32
 
	m‹¡šfo_Ën
;

189 
__u32
 
	m“dump_Ën
;

190 
__u32
 
	m»gdump_Ën
;

193 
	#SOPASS_MAX
 6

	)

204 
	s‘htoŞ_wŞšfo
 {

205 
__u32
 
	mcmd
;

206 
__u32
 
	msuµÜ‹d
;

207 
__u32
 
	mwŞİts
;

208 
__u8
 
	msİass
[
SOPASS_MAX
];

212 
	s‘htoŞ_v®ue
 {

213 
__u32
 
	mcmd
;

214 
__u32
 
	md©a
;

217 
	etuÇbË_id
 {

218 
	mETHTOOL_ID_UNSPEC
,

219 
	mETHTOOL_RX_COPYBREAK
,

220 
	mETHTOOL_TX_COPYBREAK
,

225 
	m__ETHTOOL_TUNABLE_COUNT
,

228 
	etuÇbË_ty³_id
 {

229 
	mETHTOOL_TUNABLE_UNSPEC
,

230 
	mETHTOOL_TUNABLE_U8
,

231 
	mETHTOOL_TUNABLE_U16
,

232 
	mETHTOOL_TUNABLE_U32
,

233 
	mETHTOOL_TUNABLE_U64
,

234 
	mETHTOOL_TUNABLE_STRING
,

235 
	mETHTOOL_TUNABLE_S8
,

236 
	mETHTOOL_TUNABLE_S16
,

237 
	mETHTOOL_TUNABLE_S32
,

238 
	mETHTOOL_TUNABLE_S64
,

241 
	s‘htoŞ_tuÇbË
 {

242 
__u32
 
	mcmd
;

243 
__u32
 
	mid
;

244 
__u32
 
	mty³_id
;

245 
__u32
 
	mËn
;

246 *
	md©a
[0];

264 
	s‘htoŞ_»gs
 {

265 
__u32
 
	mcmd
;

266 
__u32
 
	mv”siÚ
;

267 
__u32
 
	mËn
;

268 
__u8
 
	md©a
[0];

289 
	s‘htoŞ_“´om
 {

290 
__u32
 
	mcmd
;

291 
__u32
 
	mmagic
;

292 
__u32
 
	moff£t
;

293 
__u32
 
	mËn
;

294 
__u8
 
	md©a
[0];

314 
	s‘htoŞ_“e
 {

315 
__u32
 
	mcmd
;

316 
__u32
 
	msuµÜ‹d
;

317 
__u32
 
	madv”ti£d
;

318 
__u32
 
	mÍ_adv”ti£d
;

319 
__u32
 
	m“e_aùive
;

320 
__u32
 
	m“e_’abËd
;

321 
__u32
 
	mtx_Íi_’abËd
;

322 
__u32
 
	mtx_Íi_tim”
;

323 
__u32
 
	m»£rved
[2];

336 
	s‘htoŞ_modšfo
 {

337 
__u32
 
	mcmd
;

338 
__u32
 
	mty³
;

339 
__u32
 
	m“´om_Ën
;

340 
__u32
 
	m»£rved
[8];

416 
	s‘htoŞ_cßËsû
 {

417 
__u32
 
	mcmd
;

418 
__u32
 
	mrx_cßËsû_u£cs
;

419 
__u32
 
	mrx_max_cßËsûd_äames
;

420 
__u32
 
	mrx_cßËsû_u£cs_œq
;

421 
__u32
 
	mrx_max_cßËsûd_äames_œq
;

422 
__u32
 
	mtx_cßËsû_u£cs
;

423 
__u32
 
	mtx_max_cßËsûd_äames
;

424 
__u32
 
	mtx_cßËsû_u£cs_œq
;

425 
__u32
 
	mtx_max_cßËsûd_äames_œq
;

426 
__u32
 
	m¡©s_block_cßËsû_u£cs
;

427 
__u32
 
	mu£_ad­tive_rx_cßËsû
;

428 
__u32
 
	mu£_ad­tive_tx_cßËsû
;

429 
__u32
 
	mpkt_¿‹_low
;

430 
__u32
 
	mrx_cßËsû_u£cs_low
;

431 
__u32
 
	mrx_max_cßËsûd_äames_low
;

432 
__u32
 
	mtx_cßËsû_u£cs_low
;

433 
__u32
 
	mtx_max_cßËsûd_äames_low
;

434 
__u32
 
	mpkt_¿‹_high
;

435 
__u32
 
	mrx_cßËsû_u£cs_high
;

436 
__u32
 
	mrx_max_cßËsûd_äames_high
;

437 
__u32
 
	mtx_cßËsû_u£cs_high
;

438 
__u32
 
	mtx_max_cßËsûd_äames_high
;

439 
__u32
 
	m¿‹_§m¶e_š‹rv®
;

467 
	s‘htoŞ_ršg·¿m
 {

468 
__u32
 
	mcmd
;

469 
__u32
 
	mrx_max_³ndšg
;

470 
__u32
 
	mrx_mši_max_³ndšg
;

471 
__u32
 
	mrx_jumbo_max_³ndšg
;

472 
__u32
 
	mtx_max_³ndšg
;

473 
__u32
 
	mrx_³ndšg
;

474 
__u32
 
	mrx_mši_³ndšg
;

475 
__u32
 
	mrx_jumbo_³ndšg
;

476 
__u32
 
	mtx_³ndšg
;

495 
	s‘htoŞ_chªÃls
 {

496 
__u32
 
	mcmd
;

497 
__u32
 
	mmax_rx
;

498 
__u32
 
	mmax_tx
;

499 
__u32
 
	mmax_Ùh”
;

500 
__u32
 
	mmax_combšed
;

501 
__u32
 
	mrx_couÁ
;

502 
__u32
 
	mtx_couÁ
;

503 
__u32
 
	mÙh”_couÁ
;

504 
__u32
 
	mcombšed_couÁ
;

529 
	s‘htoŞ_·u£·¿m
 {

530 
__u32
 
	mcmd
;

531 
__u32
 
	mautÚeg
;

532 
__u32
 
	mrx_·u£
;

533 
__u32
 
	mtx_·u£
;

536 
	#ETH_GSTRING_LEN
 32

	)

549 
	e‘htoŞ_¡ršg£t
 {

550 
	mETH_SS_TEST
 = 0,

551 
	mETH_SS_STATS
,

552 
	mETH_SS_PRIV_FLAGS
,

553 
	mETH_SS_NTUPLE_FILTERS
,

554 
	mETH_SS_FEATURES
,

555 
	mETH_SS_RSS_HASH_FUNCS
,

556 
	mETH_SS_TUNABLES
,

571 
	s‘htoŞ_g¡ršgs
 {

572 
__u32
 
	mcmd
;

573 
__u32
 
	m¡ršg_£t
;

574 
__u32
 
	mËn
;

575 
__u8
 
	md©a
[0];

595 
	s‘htoŞ_s£t_šfo
 {

596 
__u32
 
	mcmd
;

597 
__u32
 
	m»£rved
;

598 
__u64
 
	ms£t_mask
;

599 
__u32
 
	md©a
[0];

612 
	e‘htoŞ_‹¡_æags
 {

613 
	mETH_TEST_FL_OFFLINE
 = (1 << 0),

614 
	mETH_TEST_FL_FAILED
 = (1 << 1),

615 
	mETH_TEST_FL_EXTERNAL_LB
 = (1 << 2),

616 
	mETH_TEST_FL_EXTERNAL_LB_DONE
 = (1 << 3),

633 
	s‘htoŞ_‹¡
 {

634 
__u32
 
	mcmd
;

635 
__u32
 
	mæags
;

636 
__u32
 
	m»£rved
;

637 
__u32
 
	mËn
;

638 
__u64
 
	md©a
[0];

652 
	s‘htoŞ_¡©s
 {

653 
__u32
 
	mcmd
;

654 
__u32
 
	mn_¡©s
;

655 
__u64
 
	md©a
[0];

669 
	s‘htoŞ_³rm_addr
 {

670 
__u32
 
	mcmd
;

671 
__u32
 
	msize
;

672 
__u8
 
	md©a
[0];

684 
	e‘htoŞ_æags
 {

685 
	mETH_FLAG_TXVLAN
 = (1 << 7),

686 
	mETH_FLAG_RXVLAN
 = (1 << 8),

687 
	mETH_FLAG_LRO
 = (1 << 15),

688 
	mETH_FLAG_NTUPLE
 = (1 << 27),

689 
	mETH_FLAG_RXHASH
 = (1 << 28),

708 
	s‘htoŞ_tı4_¥ec
 {

709 
__be32
 
	m4¤c
;

710 
__be32
 
	m4d¡
;

711 
__be16
 
	mp¤c
;

712 
__be16
 
	mpd¡
;

713 
__u8
 
	mtos
;

725 
	s‘htoŞ_ah_e¥4_¥ec
 {

726 
__be32
 
	m4¤c
;

727 
__be32
 
	m4d¡
;

728 
__be32
 
	m¥i
;

729 
__u8
 
	mtos
;

732 
	#ETH_RX_NFC_IP4
 1

	)

743 
	s‘htoŞ_u¤4_¥ec
 {

744 
__be32
 
	m4¤c
;

745 
__be32
 
	m4d¡
;

746 
__be32
 
	ml4_4_by‹s
;

747 
__u8
 
	mtos
;

748 
__u8
 
	m_v”
;

749 
__u8
 
	m´Ùo
;

752 
	u‘htoŞ_æow_uniÚ
 {

753 
‘htoŞ_tı4_¥ec
 
	mtı_4_¥ec
;

754 
‘htoŞ_tı4_¥ec
 
	mudp_4_¥ec
;

755 
‘htoŞ_tı4_¥ec
 
	msùp_4_¥ec
;

756 
‘htoŞ_ah_e¥4_¥ec
 
	mah_4_¥ec
;

757 
‘htoŞ_ah_e¥4_¥ec
 
	me¥_4_¥ec
;

758 
‘htoŞ_u¤4_¥ec
 
	mu¤_4_¥ec
;

759 
‘hhdr
 
	m‘h”_¥ec
;

760 
__u8
 
	mhd©a
[52];

774 
	s‘htoŞ_æow_ext
 {

775 
__u8
 
	m·ddšg
[2];

776 
	mh_de¡
[
ETH_ALEN
];

777 
__be16
 
	mvÏn_‘y³
;

778 
__be16
 
	mvÏn_tci
;

779 
__be32
 
	md©a
[2];

798 
	s‘htoŞ_rx_æow_¥ec
 {

799 
__u32
 
	mæow_ty³
;

800 
‘htoŞ_æow_uniÚ
 
	mh_u
;

801 
‘htoŞ_æow_ext
 
	mh_ext
;

802 
‘htoŞ_æow_uniÚ
 
	mm_u
;

803 
‘htoŞ_æow_ext
 
	mm_ext
;

804 
__u64
 
	mršg_cook›
;

805 
__u32
 
	mloÿtiÚ
;

819 
	#ETHTOOL_RX_FLOW_SPEC_RING
 0x00000000FFFFFFFFLL

	)

820 
	#ETHTOOL_RX_FLOW_SPEC_RING_VF
 0x000000FF00000000LL

	)

821 
	#ETHTOOL_RX_FLOW_SPEC_RING_VF_OFF
 32

	)

822 
__šlše__
 
__u64
 
	$‘htoŞ_g‘_æow_¥ec_ršg
(
__u64
 
ršg_cook›
)

824  
ETHTOOL_RX_FLOW_SPEC_RING
 & 
ršg_cook›
;

825 
	}
};

827 
__šlše__
 
__u64
 
	$‘htoŞ_g‘_æow_¥ec_ršg_vf
(
__u64
 
ršg_cook›
)

829  (
ETHTOOL_RX_FLOW_SPEC_RING_VF
 & 
ršg_cook›
) >>

830 
ETHTOOL_RX_FLOW_SPEC_RING_VF_OFF
;

831 
	}
};

885 
	s‘htoŞ_rxnfc
 {

886 
__u32
 
	mcmd
;

887 
__u32
 
	mæow_ty³
;

888 
__u64
 
	md©a
;

889 
‘htoŞ_rx_æow_¥ec
 
	mfs
;

890 
__u32
 
	mruË_út
;

891 
__u32
 
	mruË_locs
[0];

908 
	s‘htoŞ_rxfh_šdœ
 {

909 
__u32
 
	mcmd
;

910 
__u32
 
	msize
;

911 
__u32
 
	mršg_šdex
[0];

938 
	s‘htoŞ_rxfh
 {

939 
__u32
 
	mcmd
;

940 
__u32
 
	mrss_cÚ‹xt
;

941 
__u32
 
	mšdœ_size
;

942 
__u32
 
	mkey_size
;

943 
__u8
 
	mhfunc
;

944 
__u8
 
	mrsvd8
[3];

945 
__u32
 
	mrsvd32
;

946 
__u32
 
	mrss_cÚfig
[0];

948 
	#ETH_RXFH_INDIR_NO_CHANGE
 0xffffffff

	)

966 
	s‘htoŞ_rx_Áu¶e_æow_¥ec
 {

967 
__u32
 
	mæow_ty³
;

969 
‘htoŞ_tı4_¥ec
 
	mtı_4_¥ec
;

970 
‘htoŞ_tı4_¥ec
 
	mudp_4_¥ec
;

971 
‘htoŞ_tı4_¥ec
 
	msùp_4_¥ec
;

972 
‘htoŞ_ah_e¥4_¥ec
 
	mah_4_¥ec
;

973 
‘htoŞ_ah_e¥4_¥ec
 
	me¥_4_¥ec
;

974 
‘htoŞ_u¤4_¥ec
 
	mu¤_4_¥ec
;

975 
‘hhdr
 
	m‘h”_¥ec
;

976 
__u8
 
	mhd©a
[72];

977 } 
	mh_u
, 
	mm_u
;

979 
__u16
 
	mvÏn_g
;

980 
__u16
 
	mvÏn_g_mask
;

981 
__u64
 
	md©a
;

982 
__u64
 
	md©a_mask
;

984 
__s32
 
	maùiÚ
;

985 
	#ETHTOOL_RXNTUPLE_ACTION_DROP
 (-1è

	)

986 
	#ETHTOOL_RXNTUPLE_ACTION_CLEAR
 (-2è

	)

994 
	s‘htoŞ_rx_Áu¶e
 {

995 
__u32
 
	mcmd
;

996 
‘htoŞ_rx_Áu¶e_æow_¥ec
 
	mfs
;

999 
	#ETHTOOL_FLASH_MAX_FILENAME
 128

	)

1000 
	e‘htoŞ_æash_İ_ty³
 {

1001 
	mETHTOOL_FLASH_ALL_REGIONS
 = 0,

1005 
	s‘htoŞ_æash
 {

1006 
__u32
 
	mcmd
;

1007 
__u32
 
	m»giÚ
;

1008 
	md©a
[
ETHTOOL_FLASH_MAX_FILENAME
];

1025 
	s‘htoŞ_dump
 {

1026 
__u32
 
	mcmd
;

1027 
__u32
 
	mv”siÚ
;

1028 
__u32
 
	mæag
;

1029 
__u32
 
	mËn
;

1030 
__u8
 
	md©a
[0];

1033 
	#ETH_FW_DUMP_DISABLE
 0

	)

1044 
	s‘htoŞ_g‘_ã©u»s_block
 {

1045 
__u32
 
	mavaabË
;

1046 
__u32
 
	m»que¡ed
;

1047 
__u32
 
	maùive
;

1048 
__u32
 
	mÃv”_chªged
;

1059 
	s‘htoŞ_gã©u»s
 {

1060 
__u32
 
	mcmd
;

1061 
__u32
 
	msize
;

1062 
‘htoŞ_g‘_ã©u»s_block
 
	mã©u»s
[0];

1070 
	s‘htoŞ_£t_ã©u»s_block
 {

1071 
__u32
 
	mv®id
;

1072 
__u32
 
	m»que¡ed
;

1081 
	s‘htoŞ_sã©u»s
 {

1082 
__u32
 
	mcmd
;

1083 
__u32
 
	msize
;

1084 
‘htoŞ_£t_ã©u»s_block
 
	mã©u»s
[0];

1105 
	s‘htoŞ_ts_šfo
 {

1106 
__u32
 
	mcmd
;

1107 
__u32
 
	mso_time¡ampšg
;

1108 
__s32
 
	mphc_šdex
;

1109 
__u32
 
	mtx_ty³s
;

1110 
__u32
 
	mtx_»£rved
[3];

1111 
__u32
 
	mrx_f‹rs
;

1112 
__u32
 
	mrx_»£rved
[3];

1140 
	e‘htoŞ_sã©u»s_»tv®_b™s
 {

1141 
	mETHTOOL_F_UNSUPPORTED__BIT
,

1142 
	mETHTOOL_F_WISH__BIT
,

1143 
	mETHTOOL_F_COMPAT__BIT
,

1146 
	#ETHTOOL_F_UNSUPPORTED
 (1 << 
ETHTOOL_F_UNSUPPORTED__BIT
)

	)

1147 
	#ETHTOOL_F_WISH
 (1 << 
ETHTOOL_F_WISH__BIT
)

	)

1148 
	#ETHTOOL_F_COMPAT
 (1 << 
ETHTOOL_F_COMPAT__BIT
)

	)

1152 
	#ETHTOOL_GSET
 0x00000001

	)

1155 
	#ETHTOOL_SSET
 0x00000002

	)

1158 
	#ETHTOOL_GDRVINFO
 0x00000003

	)

1159 
	#ETHTOOL_GREGS
 0x00000004

	)

1160 
	#ETHTOOL_GWOL
 0x00000005

	)

1161 
	#ETHTOOL_SWOL
 0x00000006

	)

1162 
	#ETHTOOL_GMSGLVL
 0x00000007

	)

1163 
	#ETHTOOL_SMSGLVL
 0x00000008

	)

1164 
	#ETHTOOL_NWAY_RST
 0x00000009

	)

1167 
	#ETHTOOL_GLINK
 0x0000000a

	)

1168 
	#ETHTOOL_GEEPROM
 0x0000000b

	)

1169 
	#ETHTOOL_SEEPROM
 0x0000000ø

	)

1170 
	#ETHTOOL_GCOALESCE
 0x0000000

	)

1171 
	#ETHTOOL_SCOALESCE
 0x0000000à

	)

1172 
	#ETHTOOL_GRINGPARAM
 0x00000010

	)

1173 
	#ETHTOOL_SRINGPARAM
 0x00000011

	)

1174 
	#ETHTOOL_GPAUSEPARAM
 0x00000012

	)

1175 
	#ETHTOOL_SPAUSEPARAM
 0x00000013

	)

1176 
	#ETHTOOL_GRXCSUM
 0x00000014

	)

1177 
	#ETHTOOL_SRXCSUM
 0x00000015

	)

1178 
	#ETHTOOL_GTXCSUM
 0x00000016

	)

1179 
	#ETHTOOL_STXCSUM
 0x00000017

	)

1180 
	#ETHTOOL_GSG
 0x00000018

	)

1182 
	#ETHTOOL_SSG
 0x00000019

	)

1184 
	#ETHTOOL_TEST
 0x0000001¨

	)

1185 
	#ETHTOOL_GSTRINGS
 0x0000001b

	)

1186 
	#ETHTOOL_PHYS_ID
 0x0000001ø

	)

1187 
	#ETHTOOL_GSTATS
 0x0000001d

	)

1188 
	#ETHTOOL_GTSO
 0x0000001

	)

1189 
	#ETHTOOL_STSO
 0x0000001à

	)

1190 
	#ETHTOOL_GPERMADDR
 0x00000020

	)

1191 
	#ETHTOOL_GUFO
 0x00000021

	)

1192 
	#ETHTOOL_SUFO
 0x00000022

	)

1193 
	#ETHTOOL_GGSO
 0x00000023

	)

1194 
	#ETHTOOL_SGSO
 0x00000024

	)

1195 
	#ETHTOOL_GFLAGS
 0x00000025

	)

1196 
	#ETHTOOL_SFLAGS
 0x00000026

	)

1197 
	#ETHTOOL_GPFLAGS
 0x00000027

	)

1198 
	#ETHTOOL_SPFLAGS
 0x00000028

	)

1200 
	#ETHTOOL_GRXFH
 0x00000029

	)

1201 
	#ETHTOOL_SRXFH
 0x0000002¨

	)

1202 
	#ETHTOOL_GGRO
 0x0000002b

	)

1203 
	#ETHTOOL_SGRO
 0x0000002ø

	)

1204 
	#ETHTOOL_GRXRINGS
 0x0000002d

	)

1205 
	#ETHTOOL_GRXCLSRLCNT
 0x0000002

	)

1206 
	#ETHTOOL_GRXCLSRULE
 0x0000002à

	)

1207 
	#ETHTOOL_GRXCLSRLALL
 0x00000030

	)

1208 
	#ETHTOOL_SRXCLSRLDEL
 0x00000031

	)

1209 
	#ETHTOOL_SRXCLSRLINS
 0x00000032

	)

1210 
	#ETHTOOL_FLASHDEV
 0x00000033

	)

1211 
	#ETHTOOL_RESET
 0x00000034

	)

1212 
	#ETHTOOL_SRXNTUPLE
 0x00000035

	)

1213 
	#ETHTOOL_GRXNTUPLE
 0x00000036

	)

1214 
	#ETHTOOL_GSSET_INFO
 0x00000037

	)

1215 
	#ETHTOOL_GRXFHINDIR
 0x00000038

	)

1216 
	#ETHTOOL_SRXFHINDIR
 0x00000039

	)

1218 
	#ETHTOOL_GFEATURES
 0x0000003¨

	)

1219 
	#ETHTOOL_SFEATURES
 0x0000003b

	)

1220 
	#ETHTOOL_GCHANNELS
 0x0000003ø

	)

1221 
	#ETHTOOL_SCHANNELS
 0x0000003d

	)

1222 
	#ETHTOOL_SET_DUMP
 0x0000003

	)

1223 
	#ETHTOOL_GET_DUMP_FLAG
 0x0000003à

	)

1224 
	#ETHTOOL_GET_DUMP_DATA
 0x00000040

	)

1225 
	#ETHTOOL_GET_TS_INFO
 0x00000041

	)

1226 
	#ETHTOOL_GMODULEINFO
 0x00000042

	)

1227 
	#ETHTOOL_GMODULEEEPROM
 0x00000043

	)

1228 
	#ETHTOOL_GEEE
 0x00000044

	)

1229 
	#ETHTOOL_SEEE
 0x00000045

	)

1231 
	#ETHTOOL_GRSSH
 0x00000046

	)

1232 
	#ETHTOOL_SRSSH
 0x00000047

	)

1233 
	#ETHTOOL_GTUNABLE
 0x00000048

	)

1234 
	#ETHTOOL_STUNABLE
 0x00000049

	)

1236 
	#ETHTOOL_GLINKSETTINGS
 0x0000004ø

	)

1237 
	#ETHTOOL_SLINKSETTINGS
 0x0000004d

	)

1241 
	#SPARC_ETH_GSET
 
ETHTOOL_GSET


	)

1242 
	#SPARC_ETH_SSET
 
ETHTOOL_SSET


	)

1245 
	e‘htoŞ_lšk_mode_b™_šdiûs
 {

1246 
	mETHTOOL_LINK_MODE_10ba£T_H®f_BIT
 = 0,

1247 
	mETHTOOL_LINK_MODE_10ba£T_FuÎ_BIT
 = 1,

1248 
	mETHTOOL_LINK_MODE_100ba£T_H®f_BIT
 = 2,

1249 
	mETHTOOL_LINK_MODE_100ba£T_FuÎ_BIT
 = 3,

1250 
	mETHTOOL_LINK_MODE_1000ba£T_H®f_BIT
 = 4,

1251 
	mETHTOOL_LINK_MODE_1000ba£T_FuÎ_BIT
 = 5,

1252 
	mETHTOOL_LINK_MODE_AutÚeg_BIT
 = 6,

1253 
	mETHTOOL_LINK_MODE_TP_BIT
 = 7,

1254 
	mETHTOOL_LINK_MODE_AUI_BIT
 = 8,

1255 
	mETHTOOL_LINK_MODE_MII_BIT
 = 9,

1256 
	mETHTOOL_LINK_MODE_FIBRE_BIT
 = 10,

1257 
	mETHTOOL_LINK_MODE_BNC_BIT
 = 11,

1258 
	mETHTOOL_LINK_MODE_10000ba£T_FuÎ_BIT
 = 12,

1259 
	mETHTOOL_LINK_MODE_Pau£_BIT
 = 13,

1260 
	mETHTOOL_LINK_MODE_Asym_Pau£_BIT
 = 14,

1261 
	mETHTOOL_LINK_MODE_2500ba£X_FuÎ_BIT
 = 15,

1262 
	mETHTOOL_LINK_MODE_Back¶ªe_BIT
 = 16,

1263 
	mETHTOOL_LINK_MODE_1000ba£KX_FuÎ_BIT
 = 17,

1264 
	mETHTOOL_LINK_MODE_10000ba£KX4_FuÎ_BIT
 = 18,

1265 
	mETHTOOL_LINK_MODE_10000ba£KR_FuÎ_BIT
 = 19,

1266 
	mETHTOOL_LINK_MODE_10000ba£R_FEC_BIT
 = 20,

1267 
	mETHTOOL_LINK_MODE_20000ba£MLD2_FuÎ_BIT
 = 21,

1268 
	mETHTOOL_LINK_MODE_20000ba£KR2_FuÎ_BIT
 = 22,

1269 
	mETHTOOL_LINK_MODE_40000ba£KR4_FuÎ_BIT
 = 23,

1270 
	mETHTOOL_LINK_MODE_40000ba£CR4_FuÎ_BIT
 = 24,

1271 
	mETHTOOL_LINK_MODE_40000ba£SR4_FuÎ_BIT
 = 25,

1272 
	mETHTOOL_LINK_MODE_40000ba£LR4_FuÎ_BIT
 = 26,

1273 
	mETHTOOL_LINK_MODE_56000ba£KR4_FuÎ_BIT
 = 27,

1274 
	mETHTOOL_LINK_MODE_56000ba£CR4_FuÎ_BIT
 = 28,

1275 
	mETHTOOL_LINK_MODE_56000ba£SR4_FuÎ_BIT
 = 29,

1276 
	mETHTOOL_LINK_MODE_56000ba£LR4_FuÎ_BIT
 = 30,

1284 
	m__ETHTOOL_LINK_MODE_LAST


1285 ğ
ETHTOOL_LINK_MODE_56000ba£LR4_FuÎ_BIT
,

1288 
	#__ETHTOOL_LINK_MODE_LEGACY_MASK
(
ba£_Çme
) \

1289 (1UL << (
ETHTOOL_LINK_MODE_
 ## 
ba£_Çme
 ## 
_BIT
))

	)

1295 
	#SUPPORTED_10ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_H®f
)

	)

1296 
	#SUPPORTED_10ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_FuÎ
)

	)

1297 
	#SUPPORTED_100ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_H®f
)

	)

1298 
	#SUPPORTED_100ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_FuÎ
)

	)

1299 
	#SUPPORTED_1000ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_H®f
)

	)

1300 
	#SUPPORTED_1000ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_FuÎ
)

	)

1301 
	#SUPPORTED_AutÚeg
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AutÚeg
)

	)

1302 
	#SUPPORTED_TP
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
TP
)

	)

1303 
	#SUPPORTED_AUI
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AUI
)

	)

1304 
	#SUPPORTED_MII
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
MII
)

	)

1305 
	#SUPPORTED_FIBRE
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
FIBRE
)

	)

1306 
	#SUPPORTED_BNC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
BNC
)

	)

1307 
	#SUPPORTED_10000ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£T_FuÎ
)

	)

1308 
	#SUPPORTED_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Pau£
)

	)

1309 
	#SUPPORTED_Asym_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Asym_Pau£
)

	)

1310 
	#SUPPORTED_2500ba£X_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(2500ba
£X_FuÎ
)

	)

1311 
	#SUPPORTED_Back¶ªe
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Back¶ªe
)

	)

1312 
	#SUPPORTED_1000ba£KX_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£KX_FuÎ
)

	)

1313 
	#SUPPORTED_10000ba£KX4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KX4_FuÎ
)

	)

1314 
	#SUPPORTED_10000ba£KR_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KR_FuÎ
)

	)

1315 
	#SUPPORTED_10000ba£R_FEC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£R_FEC
)

	)

1316 
	#SUPPORTED_20000ba£MLD2_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£MLD2_FuÎ
)

	)

1317 
	#SUPPORTED_20000ba£KR2_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£KR2_FuÎ
)

	)

1318 
	#SUPPORTED_40000ba£KR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£KR4_FuÎ
)

	)

1319 
	#SUPPORTED_40000ba£CR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£CR4_FuÎ
)

	)

1320 
	#SUPPORTED_40000ba£SR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£SR4_FuÎ
)

	)

1321 
	#SUPPORTED_40000ba£LR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£LR4_FuÎ
)

	)

1322 
	#SUPPORTED_56000ba£KR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£KR4_FuÎ
)

	)

1323 
	#SUPPORTED_56000ba£CR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£CR4_FuÎ
)

	)

1324 
	#SUPPORTED_56000ba£SR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£SR4_FuÎ
)

	)

1325 
	#SUPPORTED_56000ba£LR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£LR4_FuÎ
)

	)

1335 
	#ADVERTISED_10ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_H®f
)

	)

1336 
	#ADVERTISED_10ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10ba
£T_FuÎ
)

	)

1337 
	#ADVERTISED_100ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_H®f
)

	)

1338 
	#ADVERTISED_100ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(100ba
£T_FuÎ
)

	)

1339 
	#ADVERTISED_1000ba£T_H®f
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_H®f
)

	)

1340 
	#ADVERTISED_1000ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£T_FuÎ
)

	)

1341 
	#ADVERTISED_AutÚeg
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AutÚeg
)

	)

1342 
	#ADVERTISED_TP
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
TP
)

	)

1343 
	#ADVERTISED_AUI
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
AUI
)

	)

1344 
	#ADVERTISED_MII
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
MII
)

	)

1345 
	#ADVERTISED_FIBRE
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
FIBRE
)

	)

1346 
	#ADVERTISED_BNC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
BNC
)

	)

1347 
	#ADVERTISED_10000ba£T_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£T_FuÎ
)

	)

1348 
	#ADVERTISED_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Pau£
)

	)

1349 
	#ADVERTISED_Asym_Pau£
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Asym_Pau£
)

	)

1350 
	#ADVERTISED_2500ba£X_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(2500ba
£X_FuÎ
)

	)

1351 
	#ADVERTISED_Back¶ªe
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(
Back¶ªe
)

	)

1352 
	#ADVERTISED_1000ba£KX_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(1000ba
£KX_FuÎ
)

	)

1353 
	#ADVERTISED_10000ba£KX4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KX4_FuÎ
)

	)

1354 
	#ADVERTISED_10000ba£KR_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£KR_FuÎ
)

	)

1355 
	#ADVERTISED_10000ba£R_FEC
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(10000ba
£R_FEC
)

	)

1356 
	#ADVERTISED_20000ba£MLD2_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£MLD2_FuÎ
)

	)

1357 
	#ADVERTISED_20000ba£KR2_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(20000ba
£KR2_FuÎ
)

	)

1358 
	#ADVERTISED_40000ba£KR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£KR4_FuÎ
)

	)

1359 
	#ADVERTISED_40000ba£CR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£CR4_FuÎ
)

	)

1360 
	#ADVERTISED_40000ba£SR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£SR4_FuÎ
)

	)

1361 
	#ADVERTISED_40000ba£LR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(40000ba
£LR4_FuÎ
)

	)

1362 
	#ADVERTISED_56000ba£KR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£KR4_FuÎ
)

	)

1363 
	#ADVERTISED_56000ba£CR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£CR4_FuÎ
)

	)

1364 
	#ADVERTISED_56000ba£SR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£SR4_FuÎ
)

	)

1365 
	#ADVERTISED_56000ba£LR4_FuÎ
 
	`__ETHTOOL_LINK_MODE_LEGACY_MASK
(56000ba
£LR4_FuÎ
)

	)

1377 
	#SPEED_10
 10

	)

1378 
	#SPEED_100
 100

	)

1379 
	#SPEED_1000
 1000

	)

1380 
	#SPEED_2500
 2500

	)

1381 
	#SPEED_5000
 5000

	)

1382 
	#SPEED_10000
 10000

	)

1383 
	#SPEED_20000
 20000

	)

1384 
	#SPEED_25000
 25000

	)

1385 
	#SPEED_40000
 40000

	)

1386 
	#SPEED_50000
 50000

	)

1387 
	#SPEED_56000
 56000

	)

1388 
	#SPEED_100000
 100000

	)

1390 
	#SPEED_UNKNOWN
 -1

	)

1392 
__šlše__
 
	$‘htoŞ_v®id©e_¥“d
(
__u32
 
¥“d
)

1394  
¥“d
 <ğ
INT_MAX
 || s³ed =ğ
SPEED_UNKNOWN
;

1395 
	}
}

1398 
	#DUPLEX_HALF
 0x00

	)

1399 
	#DUPLEX_FULL
 0x01

	)

1400 
	#DUPLEX_UNKNOWN
 0xff

	)

1402 
__šlše__
 
	$‘htoŞ_v®id©e_du¶ex
(
__u8
 
du¶ex
)

1404 
du¶ex
) {

1405 
DUPLEX_HALF
:

1406 
DUPLEX_FULL
:

1407 
DUPLEX_UNKNOWN
:

1412 
	}
}

1415 
	#PORT_TP
 0x00

	)

1416 
	#PORT_AUI
 0x01

	)

1417 
	#PORT_MII
 0x02

	)

1418 
	#PORT_FIBRE
 0x03

	)

1419 
	#PORT_BNC
 0x04

	)

1420 
	#PORT_DA
 0x05

	)

1421 
	#PORT_NONE
 0xef

	)

1422 
	#PORT_OTHER
 0xff

	)

1425 
	#XCVR_INTERNAL
 0x00

	)

1426 
	#XCVR_EXTERNAL
 0x01

	)

1427 
	#XCVR_DUMMY1
 0x02

	)

1428 
	#XCVR_DUMMY2
 0x03

	)

1429 
	#XCVR_DUMMY3
 0x04

	)

1432 
	#AUTONEG_DISABLE
 0x00

	)

1433 
	#AUTONEG_ENABLE
 0x01

	)

1438 
	#ETH_TP_MDI_INVALID
 0x00

	)

1439 
	#ETH_TP_MDI
 0x01

	)

1440 
	#ETH_TP_MDI_X
 0x02

	)

1441 
	#ETH_TP_MDI_AUTO
 0x03

	)

1444 
	#WAKE_PHY
 (1 << 0)

	)

1445 
	#WAKE_UCAST
 (1 << 1)

	)

1446 
	#WAKE_MCAST
 (1 << 2)

	)

1447 
	#WAKE_BCAST
 (1 << 3)

	)

1448 
	#WAKE_ARP
 (1 << 4)

	)

1449 
	#WAKE_MAGIC
 (1 << 5)

	)

1450 
	#WAKE_MAGICSECURE
 (1 << 6è

	)

1453 
	#TCP_V4_FLOW
 0x01

	)

1454 
	#UDP_V4_FLOW
 0x02

	)

1455 
	#SCTP_V4_FLOW
 0x03

	)

1456 
	#AH_ESP_V4_FLOW
 0x04

	)

1457 
	#TCP_V6_FLOW
 0x05

	)

1458 
	#UDP_V6_FLOW
 0x06

	)

1459 
	#SCTP_V6_FLOW
 0x07

	)

1460 
	#AH_ESP_V6_FLOW
 0x08

	)

1461 
	#AH_V4_FLOW
 0x09

	)

1462 
	#ESP_V4_FLOW
 0x0¨

	)

1463 
	#AH_V6_FLOW
 0x0b

	)

1464 
	#ESP_V6_FLOW
 0x0ø

	)

1465 
	#IP_USER_FLOW
 0x0d

	)

1466 
	#IPV4_FLOW
 0x10

	)

1467 
	#IPV6_FLOW
 0x11

	)

1468 
	#ETHER_FLOW
 0x12

	)

1470 
	#FLOW_EXT
 0x80000000

	)

1471 
	#FLOW_MAC_EXT
 0x40000000

	)

1474 
	#RXH_L2DA
 (1 << 1)

	)

1475 
	#RXH_VLAN
 (1 << 2)

	)

1476 
	#RXH_L3_PROTO
 (1 << 3)

	)

1477 
	#RXH_IP_SRC
 (1 << 4)

	)

1478 
	#RXH_IP_DST
 (1 << 5)

	)

1479 
	#RXH_L4_B_0_1
 (1 << 6è

	)

1480 
	#RXH_L4_B_2_3
 (1 << 7è

	)

1481 
	#RXH_DISCARD
 (1 << 31)

	)

1483 
	#RX_CLS_FLOW_DISC
 0xffffffffffffffffULL

	)

1486 
	#RX_CLS_LOC_SPECIAL
 0x80000000

	)

1487 
	#RX_CLS_LOC_ANY
 0xffffffff

	)

1488 
	#RX_CLS_LOC_FIRST
 0xffffffã

	)

1489 
	#RX_CLS_LOC_LAST
 0xfffffffd

	)

1492 
	#ETH_MODULE_SFF_8079
 0x1

	)

1493 
	#ETH_MODULE_SFF_8079_LEN
 256

	)

1494 
	#ETH_MODULE_SFF_8472
 0x2

	)

1495 
	#ETH_MODULE_SFF_8472_LEN
 512

	)

1496 
	#ETH_MODULE_SFF_8636
 0x3

	)

1497 
	#ETH_MODULE_SFF_8636_LEN
 256

	)

1498 
	#ETH_MODULE_SFF_8436
 0x4

	)

1499 
	#ETH_MODULE_SFF_8436_LEN
 256

	)

1508 
	e‘htoŞ_»£t_æags
 {

1514 
	mETH_RESET_MGMT
 = 1 << 0,

1515 
	mETH_RESET_IRQ
 = 1 << 1,

1516 
	mETH_RESET_DMA
 = 1 << 2,

1517 
	mETH_RESET_FILTER
 = 1 << 3,

1518 
	mETH_RESET_OFFLOAD
 = 1 << 4,

1519 
	mETH_RESET_MAC
 = 1 << 5,

1520 
	mETH_RESET_PHY
 = 1 << 6,

1521 
	mETH_RESET_RAM
 = 1 << 7,

1524 
	mETH_RESET_DEDICATED
 = 0x0000ffff,

1526 
	mETH_RESET_ALL
 = 0xffffffff,

1529 
	#ETH_RESET_SHARED_SHIFT
 16

	)

1631 
	s‘htoŞ_lšk_£‰šgs
 {

1632 
__u32
 
	mcmd
;

1633 
__u32
 
	m¥“d
;

1634 
__u8
 
	mdu¶ex
;

1635 
__u8
 
	mpÜt
;

1636 
__u8
 
	mphy_add»ss
;

1637 
__u8
 
	mautÚeg
;

1638 
__u8
 
	mmdio_suµÜt
;

1639 
__u8
 
	m‘h__mdix
;

1640 
__u8
 
	m‘h__mdix_ù¾
;

1641 
__s8
 
	mlšk_mode_masks_nwÜds
;

1642 
__u32
 
	m»£rved
[8];

1643 
__u32
 
	mlšk_mode_masks
[0];

	@/usr/include/linux/fib_rules.h

1 #iâdeà
__LINUX_FIB_RULES_H


2 
	#__LINUX_FIB_RULES_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/¹Ãšk.h
>

8 
	#FIB_RULE_PERMANENT
 0x00000001

	)

9 
	#FIB_RULE_INVERT
 0x00000002

	)

10 
	#FIB_RULE_UNRESOLVED
 0x00000004

	)

11 
	#FIB_RULE_IIF_DETACHED
 0x00000008

	)

12 
	#FIB_RULE_DEV_DETACHED
 
FIB_RULE_IIF_DETACHED


	)

13 
	#FIB_RULE_OIF_DETACHED
 0x00000010

	)

16 
	#FIB_RULE_FIND_SADDR
 0x00010000

	)

18 
	sfib_ruË_hdr
 {

19 
__u8
 
	mçmy
;

20 
__u8
 
	md¡_Ën
;

21 
__u8
 
	m¤c_Ën
;

22 
__u8
 
	mtos
;

24 
__u8
 
	mbË
;

25 
__u8
 
	m»s1
;

26 
__u8
 
	m»s2
;

27 
__u8
 
	maùiÚ
;

29 
__u32
 
	mæags
;

33 
	mFRA_UNSPEC
,

34 
	mFRA_DST
,

35 
	mFRA_SRC
,

36 
	mFRA_IIFNAME
,

37 
	#FRA_IFNAME
 
FRA_IIFNAME


	)

38 
	mFRA_GOTO
,

39 
	mFRA_UNUSED2
,

40 
	mFRA_PRIORITY
,

41 
	mFRA_UNUSED3
,

42 
	mFRA_UNUSED4
,

43 
	mFRA_UNUSED5
,

44 
	mFRA_FWMARK
,

45 
	mFRA_FLOW
,

46 
	mFRA_TUN_ID
,

47 
	mFRA_SUPPRESS_IFGROUP
,

48 
	mFRA_SUPPRESS_PREFIXLEN
,

49 
	mFRA_TABLE
,

50 
	mFRA_FWMASK
,

51 
	mFRA_OIFNAME
,

52 
	m__FRA_MAX


55 
	#FRA_MAX
 (
__FRA_MAX
 - 1)

	)

58 
	mFR_ACT_UNSPEC
,

59 
	mFR_ACT_TO_TBL
,

60 
	mFR_ACT_GOTO
,

61 
	mFR_ACT_NOP
,

62 
	mFR_ACT_RES3
,

63 
	mFR_ACT_RES4
,

64 
	mFR_ACT_BLACKHOLE
,

65 
	mFR_ACT_UNREACHABLE
,

66 
	mFR_ACT_PROHIBIT
,

67 
	m__FR_ACT_MAX
,

70 
	#FR_ACT_MAX
 (
__FR_ACT_MAX
 - 1)

	)

	@/usr/include/linux/gen_stats.h

1 #iâdeà
__LINUX_GEN_STATS_H


2 
	#__LINUX_GEN_STATS_H


	)

4 
	~<lšux/ty³s.h
>

7 
	mTCA_STATS_UNSPEC
,

8 
	mTCA_STATS_BASIC
,

9 
	mTCA_STATS_RATE_EST
,

10 
	mTCA_STATS_QUEUE
,

11 
	mTCA_STATS_APP
,

12 
	mTCA_STATS_RATE_EST64
,

13 
	m__TCA_STATS_MAX
,

15 
	#TCA_STATS_MAX
 (
__TCA_STATS_MAX
 - 1)

	)

22 
	sgÃt_¡©s_basic
 {

23 
__u64
 
	mby‹s
;

24 
__u32
 
	m·ck‘s
;

26 
	sgÃt_¡©s_basic_·cked
 {

27 
__u64
 
	mby‹s
;

28 
__u32
 
	m·ck‘s
;

29 } 
__©Œibu‹__
 ((
·cked
));

36 
	sgÃt_¡©s_¿‹_e¡
 {

37 
__u32
 
	mbps
;

38 
__u32
 
	mµs
;

46 
	sgÃt_¡©s_¿‹_e¡64
 {

47 
__u64
 
	mbps
;

48 
__u64
 
	mµs
;

59 
	sgÃt_¡©s_queue
 {

60 
__u32
 
	mqËn
;

61 
__u32
 
	mbacklog
;

62 
__u32
 
	mdrİs
;

63 
__u32
 
	m»queues
;

64 
__u32
 
	mov”lim™s
;

72 
	sgÃt_e¡im©Ü
 {

73 sigÃd 
	mš‹rv®
;

74 
	mewma_log
;

	@/usr/include/linux/genetlink.h

1 #iâdeà
__LINUX_GENERIC_NETLINK_H


2 
	#__LINUX_GENERIC_NETLINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	#GENL_NAMSIZ
 16

	)

9 
	#GENL_MIN_ID
 
NLMSG_MIN_TYPE


	)

10 
	#GENL_MAX_ID
 1023

	)

12 
	sg’lmsghdr
 {

13 
__u8
 
	mcmd
;

14 
__u8
 
	mv”siÚ
;

15 
__u16
 
	m»£rved
;

18 
	#GENL_HDRLEN
 
	`NLMSG_ALIGN
((
g’lmsghdr
))

	)

20 
	#GENL_ADMIN_PERM
 0x01

	)

21 
	#GENL_CMD_CAP_DO
 0x02

	)

22 
	#GENL_CMD_CAP_DUMP
 0x04

	)

23 
	#GENL_CMD_CAP_HASPOL
 0x08

	)

24 
	#GENL_UNS_ADMIN_PERM
 0x10

	)

29 
	#GENL_ID_GENERATE
 0

	)

30 
	#GENL_ID_CTRL
 
NLMSG_MIN_TYPE


	)

31 
	#GENL_ID_VFS_DQUOT
 (
NLMSG_MIN_TYPE
 + 1)

	)

32 
	#GENL_ID_PMCRAID
 (
NLMSG_MIN_TYPE
 + 2)

	)

39 
	mCTRL_CMD_UNSPEC
,

40 
	mCTRL_CMD_NEWFAMILY
,

41 
	mCTRL_CMD_DELFAMILY
,

42 
	mCTRL_CMD_GETFAMILY
,

43 
	mCTRL_CMD_NEWOPS
,

44 
	mCTRL_CMD_DELOPS
,

45 
	mCTRL_CMD_GETOPS
,

46 
	mCTRL_CMD_NEWMCAST_GRP
,

47 
	mCTRL_CMD_DELMCAST_GRP
,

48 
	mCTRL_CMD_GETMCAST_GRP
,

49 
	m__CTRL_CMD_MAX
,

52 
	#CTRL_CMD_MAX
 (
__CTRL_CMD_MAX
 - 1)

	)

55 
	mCTRL_ATTR_UNSPEC
,

56 
	mCTRL_ATTR_FAMILY_ID
,

57 
	mCTRL_ATTR_FAMILY_NAME
,

58 
	mCTRL_ATTR_VERSION
,

59 
	mCTRL_ATTR_HDRSIZE
,

60 
	mCTRL_ATTR_MAXATTR
,

61 
	mCTRL_ATTR_OPS
,

62 
	mCTRL_ATTR_MCAST_GROUPS
,

63 
	m__CTRL_ATTR_MAX
,

66 
	#CTRL_ATTR_MAX
 (
__CTRL_ATTR_MAX
 - 1)

	)

69 
	mCTRL_ATTR_OP_UNSPEC
,

70 
	mCTRL_ATTR_OP_ID
,

71 
	mCTRL_ATTR_OP_FLAGS
,

72 
	m__CTRL_ATTR_OP_MAX
,

75 
	#CTRL_ATTR_OP_MAX
 (
__CTRL_ATTR_OP_MAX
 - 1)

	)

78 
	mCTRL_ATTR_MCAST_GRP_UNSPEC
,

79 
	mCTRL_ATTR_MCAST_GRP_NAME
,

80 
	mCTRL_ATTR_MCAST_GRP_ID
,

81 
	m__CTRL_ATTR_MCAST_GRP_MAX
,

84 
	#CTRL_ATTR_MCAST_GRP_MAX
 (
__CTRL_ATTR_MCAST_GRP_MAX
 - 1)

	)

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/libc-com·t.h
>

23 
	~<lšux/ty³s.h
>

24 
	~<lšux/sock‘.h
>

27 #ià
__UAPI_DEF_IF_IFNAMSIZ


28 
	#IFNAMSIZ
 16

	)

30 
	#IFALIASZ
 256

	)

31 
	~<lšux/hdlc/ioùl.h
>

34 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 && \

35 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

76 
	eÃt_deviû_æags
 {

78 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


79 
IFF_UP
 = 1<<0,

80 
	mIFF_BROADCAST
 = 1<<1,

81 
	mIFF_DEBUG
 = 1<<2,

82 
	mIFF_LOOPBACK
 = 1<<3,

83 
	mIFF_POINTOPOINT
 = 1<<4,

84 
	mIFF_NOTRAILERS
 = 1<<5,

85 
	mIFF_RUNNING
 = 1<<6,

86 
	mIFF_NOARP
 = 1<<7,

87 
	mIFF_PROMISC
 = 1<<8,

88 
	mIFF_ALLMULTI
 = 1<<9,

89 
	mIFF_MASTER
 = 1<<10,

90 
	mIFF_SLAVE
 = 1<<11,

91 
	mIFF_MULTICAST
 = 1<<12,

92 
	mIFF_PORTSEL
 = 1<<13,

93 
	mIFF_AUTOMEDIA
 = 1<<14,

94 
	mIFF_DYNAMIC
 = 1<<15,

96 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


97 
	mIFF_LOWER_UP
 = 1<<16,

98 
	mIFF_DORMANT
 = 1<<17,

99 
	mIFF_ECHO
 = 1<<18,

105 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


106 
	#IFF_UP
 
IFF_UP


	)

107 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

108 
	#IFF_DEBUG
 
IFF_DEBUG


	)

109 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

110 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

111 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

112 
	#IFF_RUNNING
 
IFF_RUNNING


	)

113 
	#IFF_NOARP
 
IFF_NOARP


	)

114 
	#IFF_PROMISC
 
IFF_PROMISC


	)

115 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

116 
	#IFF_MASTER
 
IFF_MASTER


	)

117 
	#IFF_SLAVE
 
IFF_SLAVE


	)

118 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

119 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

120 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

121 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

124 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


125 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

126 
	#IFF_DORMANT
 
IFF_DORMANT


	)

127 
	#IFF_ECHO
 
IFF_ECHO


	)

130 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

131 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

133 
	#IF_GET_IFACE
 0x0001

	)

134 
	#IF_GET_PROTO
 0x0002

	)

137 
	#IF_IFACE_V35
 0x1000

	)

138 
	#IF_IFACE_V24
 0x1001

	)

139 
	#IF_IFACE_X21
 0x1002

	)

140 
	#IF_IFACE_T1
 0x1003

	)

141 
	#IF_IFACE_E1
 0x1004

	)

142 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

143 
	#IF_IFACE_X21D
 0x1006

	)

146 
	#IF_PROTO_HDLC
 0x2000

	)

147 
	#IF_PROTO_PPP
 0x2001

	)

148 
	#IF_PROTO_CISCO
 0x2002

	)

149 
	#IF_PROTO_FR
 0x2003

	)

150 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

151 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

152 
	#IF_PROTO_X25
 0x2006

	)

153 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

154 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

155 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

156 
	#IF_PROTO_FR_PVC
 0x200A

	)

157 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

158 
	#IF_PROTO_RAW
 0x200C

	)

162 
	mIF_OPER_UNKNOWN
,

163 
	mIF_OPER_NOTPRESENT
,

164 
	mIF_OPER_DOWN
,

165 
	mIF_OPER_LOWERLAYERDOWN
,

166 
	mIF_OPER_TESTING
,

167 
	mIF_OPER_DORMANT
,

168 
	mIF_OPER_UP
,

173 
	mIF_LINK_MODE_DEFAULT
,

174 
	mIF_LINK_MODE_DORMANT
,

188 #ià
__UAPI_DEF_IF_IFMAP


189 
	sifm­
 {

190 
	mmem_¡¬t
;

191 
	mmem_’d
;

192 
	mba£_addr
;

193 
	mœq
;

194 
	mdma
;

195 
	mpÜt
;

200 
	sif_£‰šgs
 {

201 
	mty³
;

202 
	msize
;

205 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

206 
cisco_´Ùo
 *
	mcisco
;

207 
ä_´Ùo
 *
	mä
;

208 
ä_´Ùo_pvc
 *
	mä_pvc
;

209 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

212 
sync_£rŸl_£‰šgs
 *
	msync
;

213 
‹1_£‰šgs
 *
	m‹1
;

214 } 
	mifs_ifsu
;

225 #ià
__UAPI_DEF_IF_IFREQ


226 
	siäeq
 {

227 
	#IFHWADDRLEN
 6

	)

230 
	miän_Çme
[
IFNAMSIZ
];

231 } 
	miä_iän
;

234 
sockaddr
 
	miäu_addr
;

235 
sockaddr
 
	miäu_d¡addr
;

236 
sockaddr
 
	miäu_brßdaddr
;

237 
sockaddr
 
	miäu_Ãtmask
;

238 
sockaddr
 
	miäu_hwaddr
;

239 
	miäu_æags
;

240 
	miäu_iv®ue
;

241 
	miäu_mtu
;

242 
ifm­
 
	miäu_m­
;

243 
	miäu_¦ave
[
IFNAMSIZ
];

244 
	miäu_ÃwÇme
[
IFNAMSIZ
];

245 * 
	miäu_d©a
;

246 
if_£‰šgs
 
	miäu_£‰šgs
;

247 } 
	miä_iäu
;

251 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

252 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

253 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

254 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

255 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

256 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

257 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

258 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

259 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

260 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

261 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

262 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

263 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

264 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

265 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

266 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

267 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

277 #ià
__UAPI_DEF_IF_IFCONF


278 
	sifcÚf
 {

279 
	mifc_Ën
;

281 *
	mifcu_buf
;

282 
iäeq
 *
	mifcu_»q
;

283 } 
	mifc_ifcu
;

287 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

288 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_addr.h

1 #iâdeà
__LINUX_IF_ADDR_H


2 
	#__LINUX_IF_ADDR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	siçddrmsg
 {

8 
__u8
 
	miç_çmy
;

9 
__u8
 
	miç_´efixËn
;

10 
__u8
 
	miç_æags
;

11 
__u8
 
	miç_scİe
;

12 
__u32
 
	miç_šdex
;

26 
	mIFA_UNSPEC
,

27 
	mIFA_ADDRESS
,

28 
	mIFA_LOCAL
,

29 
	mIFA_LABEL
,

30 
	mIFA_BROADCAST
,

31 
	mIFA_ANYCAST
,

32 
	mIFA_CACHEINFO
,

33 
	mIFA_MULTICAST
,

34 
	mIFA_FLAGS
,

35 
	m__IFA_MAX
,

38 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

41 
	#IFA_F_SECONDARY
 0x01

	)

42 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

44 
	#IFA_F_NODAD
 0x02

	)

45 
	#IFA_F_OPTIMISTIC
 0x04

	)

46 
	#IFA_F_DADFAILED
 0x08

	)

47 
	#IFA_F_HOMEADDRESS
 0x10

	)

48 
	#IFA_F_DEPRECATED
 0x20

	)

49 
	#IFA_F_TENTATIVE
 0x40

	)

50 
	#IFA_F_PERMANENT
 0x80

	)

51 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

52 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

53 
	#IFA_F_MCAUTOJOIN
 0x400

	)

54 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

56 
	siç_ÿchešfo
 {

57 
__u32
 
	miç_´eã»d
;

58 
__u32
 
	miç_v®id
;

59 
__u32
 
	mc¡amp
;

60 
__u32
 
	mt¡amp
;

64 
	#IFA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
içddrmsg
))))

	)

65 
	#IFA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
içddrmsg
))

	)

	@/usr/include/linux/if_arp.h

23 #iâdeà
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<lšux/Ãtdeviû.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

89 
	#ARPHRD_IEEE802154
 804

	)

90 
	#ARPHRD_IEEE802154_MONITOR
 805

	)

92 
	#ARPHRD_PHONET
 820

	)

93 
	#ARPHRD_PHONET_PIPE
 821

	)

94 
	#ARPHRD_CAIF
 822

	)

95 
	#ARPHRD_IP6GRE
 823

	)

96 
	#ARPHRD_NETLINK
 824

	)

97 
	#ARPHRD_6LOWPAN
 825

	)

99 
	#ARPHRD_VOID
 0xFFFF

	)

100 
	#ARPHRD_NONE
 0xFFFE

	)

103 
	#ARPOP_REQUEST
 1

	)

104 
	#ARPOP_REPLY
 2

	)

105 
	#ARPOP_RREQUEST
 3

	)

106 
	#ARPOP_RREPLY
 4

	)

107 
	#ARPOP_InREQUEST
 8

	)

108 
	#ARPOP_InREPLY
 9

	)

109 
	#ARPOP_NAK
 10

	)

113 
	s¬´eq
 {

114 
sockaddr
 
	m¬p_·
;

115 
sockaddr
 
	m¬p_ha
;

116 
	m¬p_æags
;

117 
sockaddr
 
	m¬p_Ãtmask
;

118 
	m¬p_dev
[16];

121 
	s¬´eq_Şd
 {

122 
sockaddr
 
	m¬p_·
;

123 
sockaddr
 
	m¬p_ha
;

124 
	m¬p_æags
;

125 
sockaddr
 
	m¬p_Ãtmask
;

129 
	#ATF_COM
 0x02

	)

130 
	#ATF_PERM
 0x04

	)

131 
	#ATF_PUBL
 0x08

	)

132 
	#ATF_USETRAILERS
 0x10

	)

133 
	#ATF_NETMASK
 0x20

	)

135 
	#ATF_DONTPUB
 0x40

	)

141 
	s¬phdr
 {

142 
__be16
 
	m¬_hrd
;

143 
__be16
 
	m¬_´o
;

144 
	m¬_hÊ
;

145 
	m¬_¶n
;

146 
__be16
 
	m¬_İ
;

152 
	m¬_sha
[
ETH_ALEN
];

153 
	m¬_s
[4];

154 
	m¬_tha
[
ETH_ALEN
];

155 
	m¬_t
[4];

	@/usr/include/linux/if_bridge.h

13 #iâdeà
_LINUX_IF_BRIDGE_H


14 
	#_LINUX_IF_BRIDGE_H


	)

16 
	~<lšux/ty³s.h
>

17 
	~<lšux/if_‘h”.h
>

18 
	~<lšux/š6.h
>

20 
	#SYSFS_BRIDGE_ATTR
 "bridge"

	)

21 
	#SYSFS_BRIDGE_FDB
 "brfÜw¬d"

	)

22 
	#SYSFS_BRIDGE_PORT_SUBDIR
 "brif"

	)

23 
	#SYSFS_BRIDGE_PORT_ATTR
 "b½Üt"

	)

24 
	#SYSFS_BRIDGE_PORT_LINK
 "bridge"

	)

26 
	#BRCTL_VERSION
 1

	)

28 
	#BRCTL_GET_VERSION
 0

	)

29 
	#BRCTL_GET_BRIDGES
 1

	)

30 
	#BRCTL_ADD_BRIDGE
 2

	)

31 
	#BRCTL_DEL_BRIDGE
 3

	)

32 
	#BRCTL_ADD_IF
 4

	)

33 
	#BRCTL_DEL_IF
 5

	)

34 
	#BRCTL_GET_BRIDGE_INFO
 6

	)

35 
	#BRCTL_GET_PORT_LIST
 7

	)

36 
	#BRCTL_SET_BRIDGE_FORWARD_DELAY
 8

	)

37 
	#BRCTL_SET_BRIDGE_HELLO_TIME
 9

	)

38 
	#BRCTL_SET_BRIDGE_MAX_AGE
 10

	)

39 
	#BRCTL_SET_AGEING_TIME
 11

	)

40 
	#BRCTL_SET_GC_INTERVAL
 12

	)

41 
	#BRCTL_GET_PORT_INFO
 13

	)

42 
	#BRCTL_SET_BRIDGE_STP_STATE
 14

	)

43 
	#BRCTL_SET_BRIDGE_PRIORITY
 15

	)

44 
	#BRCTL_SET_PORT_PRIORITY
 16

	)

45 
	#BRCTL_SET_PATH_COST
 17

	)

46 
	#BRCTL_GET_FDB_ENTRIES
 18

	)

48 
	#BR_STATE_DISABLED
 0

	)

49 
	#BR_STATE_LISTENING
 1

	)

50 
	#BR_STATE_LEARNING
 2

	)

51 
	#BR_STATE_FORWARDING
 3

	)

52 
	#BR_STATE_BLOCKING
 4

	)

54 
	s__bridge_šfo
 {

55 
__u64
 
	mdesigÇ‹d_roÙ
;

56 
__u64
 
	mbridge_id
;

57 
__u32
 
	mroÙ_·th_co¡
;

58 
__u32
 
	mmax_age
;

59 
__u32
 
	mh–lo_time
;

60 
__u32
 
	mfÜw¬d_d–ay
;

61 
__u32
 
	mbridge_max_age
;

62 
__u32
 
	mbridge_h–lo_time
;

63 
__u32
 
	mbridge_fÜw¬d_d–ay
;

64 
__u8
 
	mtİŞogy_chªge
;

65 
__u8
 
	mtİŞogy_chªge_d‘eùed
;

66 
__u8
 
	mroÙ_pÜt
;

67 
__u8
 
	m¡p_’abËd
;

68 
__u32
 
	magešg_time
;

69 
__u32
 
	mgc_š‹rv®
;

70 
__u32
 
	mh–lo_tim”_v®ue
;

71 
__u32
 
	mtú_tim”_v®ue
;

72 
__u32
 
	mtİŞogy_chªge_tim”_v®ue
;

73 
__u32
 
	mgc_tim”_v®ue
;

76 
	s__pÜt_šfo
 {

77 
__u64
 
	mdesigÇ‹d_roÙ
;

78 
__u64
 
	mdesigÇ‹d_bridge
;

79 
__u16
 
	mpÜt_id
;

80 
__u16
 
	mdesigÇ‹d_pÜt
;

81 
__u32
 
	m·th_co¡
;

82 
__u32
 
	mdesigÇ‹d_co¡
;

83 
__u8
 
	m¡©e
;

84 
__u8
 
	mtİ_chªge_ack
;

85 
__u8
 
	mcÚfig_³ndšg
;

86 
__u8
 
	munu£d0
;

87 
__u32
 
	mmes§ge_age_tim”_v®ue
;

88 
__u32
 
	mfÜw¬d_d–ay_tim”_v®ue
;

89 
__u32
 
	mhŞd_tim”_v®ue
;

92 
	s__fdb_’Œy
 {

93 
__u8
 
	mmac_addr
[
ETH_ALEN
];

94 
__u8
 
	mpÜt_no
;

95 
__u8
 
	mis_loÿl
;

96 
__u32
 
	magešg_tim”_v®ue
;

97 
__u8
 
	mpÜt_hi
;

98 
__u8
 
	m·d0
;

99 
__u16
 
	munu£d
;

103 
	#BRIDGE_FLAGS_MASTER
 1

	)

104 
	#BRIDGE_FLAGS_SELF
 2

	)

106 
	#BRIDGE_MODE_VEB
 0

	)

107 
	#BRIDGE_MODE_VEPA
 1

	)

108 
	#BRIDGE_MODE_UNDEF
 0xFFFF

	)

118 
	mIFLA_BRIDGE_FLAGS
,

119 
	mIFLA_BRIDGE_MODE
,

120 
	mIFLA_BRIDGE_VLAN_INFO
,

121 
	m__IFLA_BRIDGE_MAX
,

123 
	#IFLA_BRIDGE_MAX
 (
__IFLA_BRIDGE_MAX
 - 1)

	)

125 
	#BRIDGE_VLAN_INFO_MASTER
 (1<<0è

	)

126 
	#BRIDGE_VLAN_INFO_PVID
 (1<<1è

	)

127 
	#BRIDGE_VLAN_INFO_UNTAGGED
 (1<<2è

	)

128 
	#BRIDGE_VLAN_INFO_RANGE_BEGIN
 (1<<3è

	)

129 
	#BRIDGE_VLAN_INFO_RANGE_END
 (1<<4è

	)

130 
	#BRIDGE_VLAN_INFO_BRENTRY
 (1<<5è

	)

132 
	sbridge_vÏn_šfo
 {

133 
__u16
 
	mæags
;

134 
__u16
 
	mvid
;

148 
	mMDBA_UNSPEC
,

149 
	mMDBA_MDB
,

150 
	mMDBA_ROUTER
,

151 
	m__MDBA_MAX
,

153 
	#MDBA_MAX
 (
__MDBA_MAX
 - 1)

	)

156 
	mMDBA_MDB_UNSPEC
,

157 
	mMDBA_MDB_ENTRY
,

158 
	m__MDBA_MDB_MAX
,

160 
	#MDBA_MDB_MAX
 (
__MDBA_MDB_MAX
 - 1)

	)

163 
	mMDBA_MDB_ENTRY_UNSPEC
,

164 
	mMDBA_MDB_ENTRY_INFO
,

165 
	m__MDBA_MDB_ENTRY_MAX
,

167 
	#MDBA_MDB_ENTRY_MAX
 (
__MDBA_MDB_ENTRY_MAX
 - 1)

	)

170 
	mMDBA_ROUTER_UNSPEC
,

171 
	mMDBA_ROUTER_PORT
,

172 
	m__MDBA_ROUTER_MAX
,

174 
	#MDBA_ROUTER_MAX
 (
__MDBA_ROUTER_MAX
 - 1)

	)

176 
	sbr_pÜt_msg
 {

177 
__u8
 
	mçmy
;

178 
__u32
 
	mifšdex
;

181 
	sbr_mdb_’Œy
 {

182 
__u32
 
	mifšdex
;

183 
	#MDB_TEMPORARY
 0

	)

184 
	#MDB_PERMANENT
 1

	)

185 
__u8
 
	m¡©e
;

186 
__u16
 
	mvid
;

189 
__be32
 
	m4
;

190 
š6_addr
 
	m6
;

191 } 
	mu
;

192 
__be16
 
	m´Ùo
;

193 } 
	maddr
;

197 
	mMDBA_SET_ENTRY_UNSPEC
,

198 
	mMDBA_SET_ENTRY
,

199 
	m__MDBA_SET_ENTRY_MAX
,

201 
	#MDBA_SET_ENTRY_MAX
 (
__MDBA_SET_ENTRY_MAX
 - 1)

	)

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

42 
	#ETH_P_LOOP
 0x0060

	)

43 
	#ETH_P_PUP
 0x0200

	)

44 
	#ETH_P_PUPAT
 0x0201

	)

45 
	#ETH_P_TSN
 0x22F0

	)

46 
	#ETH_P_IP
 0x0800

	)

47 
	#ETH_P_X25
 0x0805

	)

48 
	#ETH_P_ARP
 0x0806

	)

49 
	#ETH_P_BPQ
 0x08FF

	)

50 
	#ETH_P_IEEEPUP
 0x0a00

	)

51 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

52 
	#ETH_P_BATMAN
 0x4305

	)

53 
	#ETH_P_DEC
 0x6000

	)

54 
	#ETH_P_DNA_DL
 0x6001

	)

55 
	#ETH_P_DNA_RC
 0x6002

	)

56 
	#ETH_P_DNA_RT
 0x6003

	)

57 
	#ETH_P_LAT
 0x6004

	)

58 
	#ETH_P_DIAG
 0x6005

	)

59 
	#ETH_P_CUST
 0x6006

	)

60 
	#ETH_P_SCA
 0x6007

	)

61 
	#ETH_P_TEB
 0x6558

	)

62 
	#ETH_P_RARP
 0x8035

	)

63 
	#ETH_P_ATALK
 0x809B

	)

64 
	#ETH_P_AARP
 0x80F3

	)

65 
	#ETH_P_8021Q
 0x8100

	)

66 
	#ETH_P_IPX
 0x8137

	)

67 
	#ETH_P_IPV6
 0x86DD

	)

68 
	#ETH_P_PAUSE
 0x8808

	)

69 
	#ETH_P_SLOW
 0x8809

	)

70 
	#ETH_P_WCCP
 0x883E

	)

72 
	#ETH_P_MPLS_UC
 0x8847

	)

73 
	#ETH_P_MPLS_MC
 0x8848

	)

74 
	#ETH_P_ATMMPOA
 0x884ø

	)

75 
	#ETH_P_PPP_DISC
 0x8863

	)

76 
	#ETH_P_PPP_SES
 0x8864

	)

77 
	#ETH_P_LINK_CTL
 0x886ø

	)

78 
	#ETH_P_ATMFATE
 0x8884

	)

81 
	#ETH_P_PAE
 0x888E

	)

82 
	#ETH_P_AOE
 0x88A2

	)

83 
	#ETH_P_8021AD
 0x88A8

	)

84 
	#ETH_P_802_EX1
 0x88B5

	)

85 
	#ETH_P_TIPC
 0x88CA

	)

86 
	#ETH_P_8021AH
 0x88E7

	)

87 
	#ETH_P_MVRP
 0x88F5

	)

88 
	#ETH_P_1588
 0x88F7

	)

89 
	#ETH_P_PRP
 0x88FB

	)

90 
	#ETH_P_FCOE
 0x8906

	)

91 
	#ETH_P_TDLS
 0x890D

	)

92 
	#ETH_P_FIP
 0x8914

	)

93 
	#ETH_P_80221
 0x8917

	)

94 
	#ETH_P_LOOPBACK
 0x9000

	)

95 
	#ETH_P_QINQ1
 0x9100

	)

96 
	#ETH_P_QINQ2
 0x9200

	)

97 
	#ETH_P_QINQ3
 0x9300

	)

98 
	#ETH_P_EDSA
 0xDADA

	)

99 
	#ETH_P_AF_IUCV
 0xFBFB

	)

101 
	#ETH_P_802_3_MIN
 0x0600

	)

108 
	#ETH_P_802_3
 0x0001

	)

109 
	#ETH_P_AX25
 0x0002

	)

110 
	#ETH_P_ALL
 0x0003

	)

111 
	#ETH_P_802_2
 0x0004

	)

112 
	#ETH_P_SNAP
 0x0005

	)

113 
	#ETH_P_DDCMP
 0x0006

	)

114 
	#ETH_P_WAN_PPP
 0x0007

	)

115 
	#ETH_P_PPP_MP
 0x0008

	)

116 
	#ETH_P_LOCALTALK
 0x0009

	)

117 
	#ETH_P_CAN
 0x000C

	)

118 
	#ETH_P_CANFD
 0x000D

	)

119 
	#ETH_P_PPPTALK
 0x0010

	)

120 
	#ETH_P_TR_802_2
 0x0011

	)

121 
	#ETH_P_MOBITEX
 0x0015

	)

122 
	#ETH_P_CONTROL
 0x0016

	)

123 
	#ETH_P_IRDA
 0x0017

	)

124 
	#ETH_P_ECONET
 0x0018

	)

125 
	#ETH_P_HDLC
 0x0019

	)

126 
	#ETH_P_ARCNET
 0x001A

	)

127 
	#ETH_P_DSA
 0x001B

	)

128 
	#ETH_P_TRAILER
 0x001C

	)

129 
	#ETH_P_PHONET
 0x00F5

	)

130 
	#ETH_P_IEEE802154
 0x00F6

	)

131 
	#ETH_P_CAIF
 0x00F7

	)

132 
	#ETH_P_XDSA
 0x00F8

	)

138 
	s‘hhdr
 {

139 
	mh_de¡
[
ETH_ALEN
];

140 
	mh_sourû
[
ETH_ALEN
];

141 
__be16
 
	mh_´Ùo
;

142 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_fddi.h

24 #iâdeà
_LINUX_IF_FDDI_H


25 
	#_LINUX_IF_FDDI_H


	)

27 
	~<lšux/ty³s.h
>

33 
	#FDDI_K_ALEN
 6

	)

34 
	#FDDI_K_8022_HLEN
 16

	)

35 
	#FDDI_K_SNAP_HLEN
 21

	)

36 
	#FDDI_K_8022_ZLEN
 16

	)

38 
	#FDDI_K_SNAP_ZLEN
 21

	)

40 
	#FDDI_K_8022_DLEN
 4475

	)

41 
	#FDDI_K_SNAP_DLEN
 4470

	)

42 
	#FDDI_K_LLC_ZLEN
 13

	)

43 
	#FDDI_K_LLC_LEN
 4491

	)

44 
	#FDDI_K_OUI_LEN
 3

	)

48 
	#FDDI_FC_K_VOID
 0x00

	)

49 
	#FDDI_FC_K_NON_RESTRICTED_TOKEN
 0x80

	)

50 
	#FDDI_FC_K_RESTRICTED_TOKEN
 0xC0

	)

51 
	#FDDI_FC_K_SMT_MIN
 0x41

	)

52 
	#FDDI_FC_K_SMT_MAX
 0x4F

	)

53 
	#FDDI_FC_K_MAC_MIN
 0xC1

	)

54 
	#FDDI_FC_K_MAC_MAX
 0xCF

	)

55 
	#FDDI_FC_K_ASYNC_LLC_MIN
 0x50

	)

56 
	#FDDI_FC_K_ASYNC_LLC_DEF
 0x54

	)

57 
	#FDDI_FC_K_ASYNC_LLC_MAX
 0x5F

	)

58 
	#FDDI_FC_K_SYNC_LLC_MIN
 0xD0

	)

59 
	#FDDI_FC_K_SYNC_LLC_MAX
 0xD7

	)

60 
	#FDDI_FC_K_IMPLEMENTOR_MIN
 0x60

	)

61 
	#FDDI_FC_K_IMPLEMENTOR_MAX
 0x6F

	)

62 
	#FDDI_FC_K_RESERVED_MIN
 0x70

	)

63 
	#FDDI_FC_K_RESERVED_MAX
 0x7F

	)

66 
	#FDDI_EXTENDED_SAP
 0xAA

	)

67 
	#FDDI_UI_CMD
 0x03

	)

70 
	sfddi_8022_1_hdr
 {

71 
__u8
 
	md§p
;

72 
__u8
 
	ms§p
;

73 
__u8
 
	mù¾
;

74 } 
__©Œibu‹__
((
·cked
));

77 
	sfddi_8022_2_hdr
 {

78 
__u8
 
	md§p
;

79 
__u8
 
	ms§p
;

80 
__u8
 
	mù¾_1
;

81 
__u8
 
	mù¾_2
;

82 } 
__©Œibu‹__
((
·cked
));

85 
	sfddi_¢­_hdr
 {

86 
__u8
 
	md§p
;

87 
__u8
 
	ms§p
;

88 
__u8
 
	mù¾
;

89 
__u8
 
	moui
[
FDDI_K_OUI_LEN
];

90 
__be16
 
	m‘h”ty³
;

91 } 
__©Œibu‹__
((
·cked
));

94 
	sfddihdr
 {

95 
__u8
 
	mfc
;

96 
__u8
 
	mdaddr
[
FDDI_K_ALEN
];

97 
__u8
 
	m§ddr
[
FDDI_K_ALEN
];

99 
fddi_8022_1_hdr
 
	mÎc_8022_1
;

100 
fddi_8022_2_hdr
 
	mÎc_8022_2
;

101 
fddi_¢­_hdr
 
	mÎc_¢­
;

102 } 
	mhdr
;

103 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_infiniband.h

24 #iâdeà
_LINUX_IF_INFINIBAND_H


25 
	#_LINUX_IF_INFINIBAND_H


	)

27 
	#INFINIBAND_ALEN
 20

	)

	@/usr/include/linux/if_link.h

1 #iâdeà
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

41 
	s¹Æ_lšk_¡©s64
 {

42 
__u64
 
	mrx_·ck‘s
;

43 
__u64
 
	mtx_·ck‘s
;

44 
__u64
 
	mrx_by‹s
;

45 
__u64
 
	mtx_by‹s
;

46 
__u64
 
	mrx_”rÜs
;

47 
__u64
 
	mtx_”rÜs
;

48 
__u64
 
	mrx_drİ³d
;

49 
__u64
 
	mtx_drİ³d
;

50 
__u64
 
	mmuÉiÿ¡
;

51 
__u64
 
	mcŞlisiÚs
;

54 
__u64
 
	mrx_Ëngth_”rÜs
;

55 
__u64
 
	mrx_ov”_”rÜs
;

56 
__u64
 
	mrx_üc_”rÜs
;

57 
__u64
 
	mrx_äame_”rÜs
;

58 
__u64
 
	mrx_fifo_”rÜs
;

59 
__u64
 
	mrx_mis£d_”rÜs
;

62 
__u64
 
	mtx_abÜ‹d_”rÜs
;

63 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

64 
__u64
 
	mtx_fifo_”rÜs
;

65 
__u64
 
	mtx_h—¹b—t_”rÜs
;

66 
__u64
 
	mtx_wšdow_”rÜs
;

69 
__u64
 
	mrx_com´es£d
;

70 
__u64
 
	mtx_com´es£d
;

74 
	s¹Æ_lšk_ifm­
 {

75 
__u64
 
	mmem_¡¬t
;

76 
__u64
 
	mmem_’d
;

77 
__u64
 
	mba£_addr
;

78 
__u16
 
	mœq
;

79 
__u8
 
	mdma
;

80 
__u8
 
	mpÜt
;

102 
	mIFLA_UNSPEC
,

103 
	mIFLA_ADDRESS
,

104 
	mIFLA_BROADCAST
,

105 
	mIFLA_IFNAME
,

106 
	mIFLA_MTU
,

107 
	mIFLA_LINK
,

108 
	mIFLA_QDISC
,

109 
	mIFLA_STATS
,

110 
	mIFLA_COST
,

111 
	#IFLA_COST
 
IFLA_COST


	)

112 
	mIFLA_PRIORITY
,

113 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

114 
	mIFLA_MASTER
,

115 
	#IFLA_MASTER
 
IFLA_MASTER


	)

116 
	mIFLA_WIRELESS
,

117 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

118 
	mIFLA_PROTINFO
,

119 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

120 
	mIFLA_TXQLEN
,

121 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

122 
	mIFLA_MAP
,

123 
	#IFLA_MAP
 
IFLA_MAP


	)

124 
	mIFLA_WEIGHT
,

125 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

126 
	mIFLA_OPERSTATE
,

127 
	mIFLA_LINKMODE
,

128 
	mIFLA_LINKINFO
,

129 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

130 
	mIFLA_NET_NS_PID
,

131 
	mIFLA_IFALIAS
,

132 
	mIFLA_NUM_VF
,

133 
	mIFLA_VFINFO_LIST
,

134 
	mIFLA_STATS64
,

135 
	mIFLA_VF_PORTS
,

136 
	mIFLA_PORT_SELF
,

137 
	mIFLA_AF_SPEC
,

138 
	mIFLA_GROUP
,

139 
	mIFLA_NET_NS_FD
,

140 
	mIFLA_EXT_MASK
,

141 
	mIFLA_PROMISCUITY
,

142 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

143 
	mIFLA_NUM_TX_QUEUES
,

144 
	mIFLA_NUM_RX_QUEUES
,

145 
	mIFLA_CARRIER
,

146 
	mIFLA_PHYS_PORT_ID
,

147 
	mIFLA_CARRIER_CHANGES
,

148 
	mIFLA_PHYS_SWITCH_ID
,

149 
	mIFLA_LINK_NETNSID
,

150 
	mIFLA_PHYS_PORT_NAME
,

151 
	mIFLA_PROTO_DOWN
,

152 
	m__IFLA_MAX


156 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

159 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

160 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

163 
	mIFLA_INET_UNSPEC
,

164 
	mIFLA_INET_CONF
,

165 
	m__IFLA_INET_MAX
,

168 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

201 
	mIFLA_INET6_UNSPEC
,

202 
	mIFLA_INET6_FLAGS
,

203 
	mIFLA_INET6_CONF
,

204 
	mIFLA_INET6_STATS
,

205 
	mIFLA_INET6_MCAST
,

206 
	mIFLA_INET6_CACHEINFO
,

207 
	mIFLA_INET6_ICMP6STATS
,

208 
	mIFLA_INET6_TOKEN
,

209 
	mIFLA_INET6_ADDR_GEN_MODE
,

210 
	m__IFLA_INET6_MAX


213 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

215 
	eš6_addr_g’_mode
 {

216 
	mIN6_ADDR_GEN_MODE_EUI64
,

217 
	mIN6_ADDR_GEN_MODE_NONE
,

218 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

224 
	mIFLA_BR_UNSPEC
,

225 
	mIFLA_BR_FORWARD_DELAY
,

226 
	mIFLA_BR_HELLO_TIME
,

227 
	mIFLA_BR_MAX_AGE
,

228 
	mIFLA_BR_AGEING_TIME
,

229 
	mIFLA_BR_STP_STATE
,

230 
	mIFLA_BR_PRIORITY
,

231 
	mIFLA_BR_VLAN_FILTERING
,

232 
	mIFLA_BR_VLAN_PROTOCOL
,

233 
	mIFLA_BR_GROUP_FWD_MASK
,

234 
	mIFLA_BR_ROOT_ID
,

235 
	mIFLA_BR_BRIDGE_ID
,

236 
	mIFLA_BR_ROOT_PORT
,

237 
	mIFLA_BR_ROOT_PATH_COST
,

238 
	mIFLA_BR_TOPOLOGY_CHANGE
,

239 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

240 
	mIFLA_BR_HELLO_TIMER
,

241 
	mIFLA_BR_TCN_TIMER
,

242 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

243 
	mIFLA_BR_GC_TIMER
,

244 
	mIFLA_BR_GROUP_ADDR
,

245 
	mIFLA_BR_FDB_FLUSH
,

246 
	mIFLA_BR_MCAST_ROUTER
,

247 
	mIFLA_BR_MCAST_SNOOPING
,

248 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

249 
	mIFLA_BR_MCAST_QUERIER
,

250 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

251 
	mIFLA_BR_MCAST_HASH_MAX
,

252 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

253 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

254 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

255 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

256 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

257 
	mIFLA_BR_MCAST_QUERY_INTVL
,

258 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

259 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

260 
	mIFLA_BR_NF_CALL_IPTABLES
,

261 
	mIFLA_BR_NF_CALL_IP6TABLES
,

262 
	mIFLA_BR_NF_CALL_ARPTABLES
,

263 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

264 
	m__IFLA_BR_MAX
,

267 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

269 
	siæa_bridge_id
 {

270 
__u8
 
	m´io
[2];

271 
__u8
 
	maddr
[6];

275 
	mBRIDGE_MODE_UNSPEC
,

276 
	mBRIDGE_MODE_HAIRPIN
,

280 
	mIFLA_BRPORT_UNSPEC
,

281 
	mIFLA_BRPORT_STATE
,

282 
	mIFLA_BRPORT_PRIORITY
,

283 
	mIFLA_BRPORT_COST
,

284 
	mIFLA_BRPORT_MODE
,

285 
	mIFLA_BRPORT_GUARD
,

286 
	mIFLA_BRPORT_PROTECT
,

287 
	mIFLA_BRPORT_FAST_LEAVE
,

288 
	mIFLA_BRPORT_LEARNING
,

289 
	mIFLA_BRPORT_UNICAST_FLOOD
,

290 
	mIFLA_BRPORT_PROXYARP
,

291 
	mIFLA_BRPORT_LEARNING_SYNC
,

292 
	mIFLA_BRPORT_PROXYARP_WIFI
,

293 
	mIFLA_BRPORT_ROOT_ID
,

294 
	mIFLA_BRPORT_BRIDGE_ID
,

295 
	mIFLA_BRPORT_DESIGNATED_PORT
,

296 
	mIFLA_BRPORT_DESIGNATED_COST
,

297 
	mIFLA_BRPORT_ID
,

298 
	mIFLA_BRPORT_NO
,

299 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

300 
	mIFLA_BRPORT_CONFIG_PENDING
,

301 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

302 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

303 
	mIFLA_BRPORT_HOLD_TIMER
,

304 
	mIFLA_BRPORT_FLUSH
,

305 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

306 
	m__IFLA_BRPORT_MAX


308 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

310 
	siæa_ÿchešfo
 {

311 
__u32
 
	mmax_»asm_Ën
;

312 
__u32
 
	mt¡amp
;

313 
__u32
 
	m»achabË_time
;

314 
__u32
 
	m»Œªs_time
;

318 
	mIFLA_INFO_UNSPEC
,

319 
	mIFLA_INFO_KIND
,

320 
	mIFLA_INFO_DATA
,

321 
	mIFLA_INFO_XSTATS
,

322 
	mIFLA_INFO_SLAVE_KIND
,

323 
	mIFLA_INFO_SLAVE_DATA
,

324 
	m__IFLA_INFO_MAX
,

327 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

332 
	mIFLA_VLAN_UNSPEC
,

333 
	mIFLA_VLAN_ID
,

334 
	mIFLA_VLAN_FLAGS
,

335 
	mIFLA_VLAN_EGRESS_QOS
,

336 
	mIFLA_VLAN_INGRESS_QOS
,

337 
	mIFLA_VLAN_PROTOCOL
,

338 
	m__IFLA_VLAN_MAX
,

341 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

343 
	siæa_vÏn_æags
 {

344 
__u32
 
	mæags
;

345 
__u32
 
	mmask
;

349 
	mIFLA_VLAN_QOS_UNSPEC
,

350 
	mIFLA_VLAN_QOS_MAPPING
,

351 
	m__IFLA_VLAN_QOS_MAX


354 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

356 
	siæa_vÏn_qos_m­pšg
 {

357 
__u32
 
	mäom
;

358 
__u32
 
	mto
;

363 
	mIFLA_MACVLAN_UNSPEC
,

364 
	mIFLA_MACVLAN_MODE
,

365 
	mIFLA_MACVLAN_FLAGS
,

366 
	mIFLA_MACVLAN_MACADDR_MODE
,

367 
	mIFLA_MACVLAN_MACADDR
,

368 
	mIFLA_MACVLAN_MACADDR_DATA
,

369 
	mIFLA_MACVLAN_MACADDR_COUNT
,

370 
	m__IFLA_MACVLAN_MAX
,

373 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

375 
	emacvÏn_mode
 {

376 
	mMACVLAN_MODE_PRIVATE
 = 1,

377 
	mMACVLAN_MODE_VEPA
 = 2,

378 
	mMACVLAN_MODE_BRIDGE
 = 4,

379 
	mMACVLAN_MODE_PASSTHRU
 = 8,

380 
	mMACVLAN_MODE_SOURCE
 = 16,

383 
	emacvÏn_maÿddr_mode
 {

384 
	mMACVLAN_MACADDR_ADD
,

385 
	mMACVLAN_MACADDR_DEL
,

386 
	mMACVLAN_MACADDR_FLUSH
,

387 
	mMACVLAN_MACADDR_SET
,

390 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

394 
	mIFLA_VRF_UNSPEC
,

395 
	mIFLA_VRF_TABLE
,

396 
	m__IFLA_VRF_MAX


399 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

403 
	mIFLA_IPVLAN_UNSPEC
,

404 
	mIFLA_IPVLAN_MODE
,

405 
	m__IFLA_IPVLAN_MAX


408 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

410 
	evÏn_mode
 {

411 
	mIPVLAN_MODE_L2
 = 0,

412 
	mIPVLAN_MODE_L3
,

413 
	mIPVLAN_MODE_MAX


418 
	mIFLA_VXLAN_UNSPEC
,

419 
	mIFLA_VXLAN_ID
,

420 
	mIFLA_VXLAN_GROUP
,

421 
	mIFLA_VXLAN_LINK
,

422 
	mIFLA_VXLAN_LOCAL
,

423 
	mIFLA_VXLAN_TTL
,

424 
	mIFLA_VXLAN_TOS
,

425 
	mIFLA_VXLAN_LEARNING
,

426 
	mIFLA_VXLAN_AGEING
,

427 
	mIFLA_VXLAN_LIMIT
,

428 
	mIFLA_VXLAN_PORT_RANGE
,

429 
	mIFLA_VXLAN_PROXY
,

430 
	mIFLA_VXLAN_RSC
,

431 
	mIFLA_VXLAN_L2MISS
,

432 
	mIFLA_VXLAN_L3MISS
,

433 
	mIFLA_VXLAN_PORT
,

434 
	mIFLA_VXLAN_GROUP6
,

435 
	mIFLA_VXLAN_LOCAL6
,

436 
	mIFLA_VXLAN_UDP_CSUM
,

437 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

438 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

439 
	mIFLA_VXLAN_REMCSUM_TX
,

440 
	mIFLA_VXLAN_REMCSUM_RX
,

441 
	mIFLA_VXLAN_GBP
,

442 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

443 
	mIFLA_VXLAN_COLLECT_METADATA
,

444 
	mIFLA_VXLAN_FAN_MAP
 = 33,

445 
	m__IFLA_VXLAN_MAX


447 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

449 
	siæa_vxÏn_pÜt_¿nge
 {

450 
__be16
 
	mlow
;

451 
__be16
 
	mhigh
;

456 
	mIFLA_GENEVE_UNSPEC
,

457 
	mIFLA_GENEVE_ID
,

458 
	mIFLA_GENEVE_REMOTE
,

459 
	mIFLA_GENEVE_TTL
,

460 
	mIFLA_GENEVE_TOS
,

461 
	mIFLA_GENEVE_PORT
,

462 
	mIFLA_GENEVE_COLLECT_METADATA
,

463 
	mIFLA_GENEVE_REMOTE6
,

464 
	mIFLA_GENEVE_UDP_CSUM
,

465 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

466 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

467 
	m__IFLA_GENEVE_MAX


469 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

474 
	mIFLA_BOND_UNSPEC
,

475 
	mIFLA_BOND_MODE
,

476 
	mIFLA_BOND_ACTIVE_SLAVE
,

477 
	mIFLA_BOND_MIIMON
,

478 
	mIFLA_BOND_UPDELAY
,

479 
	mIFLA_BOND_DOWNDELAY
,

480 
	mIFLA_BOND_USE_CARRIER
,

481 
	mIFLA_BOND_ARP_INTERVAL
,

482 
	mIFLA_BOND_ARP_IP_TARGET
,

483 
	mIFLA_BOND_ARP_VALIDATE
,

484 
	mIFLA_BOND_ARP_ALL_TARGETS
,

485 
	mIFLA_BOND_PRIMARY
,

486 
	mIFLA_BOND_PRIMARY_RESELECT
,

487 
	mIFLA_BOND_FAIL_OVER_MAC
,

488 
	mIFLA_BOND_XMIT_HASH_POLICY
,

489 
	mIFLA_BOND_RESEND_IGMP
,

490 
	mIFLA_BOND_NUM_PEER_NOTIF
,

491 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

492 
	mIFLA_BOND_MIN_LINKS
,

493 
	mIFLA_BOND_LP_INTERVAL
,

494 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

495 
	mIFLA_BOND_AD_LACP_RATE
,

496 
	mIFLA_BOND_AD_SELECT
,

497 
	mIFLA_BOND_AD_INFO
,

498 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

499 
	mIFLA_BOND_AD_USER_PORT_KEY
,

500 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

501 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

502 
	m__IFLA_BOND_MAX
,

505 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

508 
	mIFLA_BOND_AD_INFO_UNSPEC
,

509 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

510 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

511 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

512 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

513 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

514 
	m__IFLA_BOND_AD_INFO_MAX
,

517 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

520 
	mIFLA_BOND_SLAVE_UNSPEC
,

521 
	mIFLA_BOND_SLAVE_STATE
,

522 
	mIFLA_BOND_SLAVE_MII_STATUS
,

523 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

524 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

525 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

526 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

527 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

528 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

529 
	m__IFLA_BOND_SLAVE_MAX
,

532 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

537 
	mIFLA_VF_INFO_UNSPEC
,

538 
	mIFLA_VF_INFO
,

539 
	m__IFLA_VF_INFO_MAX
,

542 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

545 
	mIFLA_VF_UNSPEC
,

546 
	mIFLA_VF_MAC
,

547 
	mIFLA_VF_VLAN
,

548 
	mIFLA_VF_TX_RATE
,

549 
	mIFLA_VF_SPOOFCHK
,

550 
	mIFLA_VF_LINK_STATE
,

551 
	mIFLA_VF_RATE
,

552 
	mIFLA_VF_RSS_QUERY_EN
,

555 
	mIFLA_VF_STATS
,

556 
	mIFLA_VF_TRUST
,

557 
	m__IFLA_VF_MAX
,

560 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

562 
	siæa_vf_mac
 {

563 
__u32
 
	mvf
;

564 
__u8
 
	mmac
[32];

567 
	siæa_vf_vÏn
 {

568 
__u32
 
	mvf
;

569 
__u32
 
	mvÏn
;

570 
__u32
 
	mqos
;

573 
	siæa_vf_tx_¿‹
 {

574 
__u32
 
	mvf
;

575 
__u32
 
	m¿‹
;

578 
	siæa_vf_¿‹
 {

579 
__u32
 
	mvf
;

580 
__u32
 
	mmš_tx_¿‹
;

581 
__u32
 
	mmax_tx_¿‹
;

584 
	siæa_vf_¥oofchk
 {

585 
__u32
 
	mvf
;

586 
__u32
 
	m£‰šg
;

590 
	mIFLA_VF_LINK_STATE_AUTO
,

591 
	mIFLA_VF_LINK_STATE_ENABLE
,

592 
	mIFLA_VF_LINK_STATE_DISABLE
,

593 
	m__IFLA_VF_LINK_STATE_MAX
,

596 
	siæa_vf_lšk_¡©e
 {

597 
__u32
 
	mvf
;

598 
__u32
 
	mlšk_¡©e
;

601 
	siæa_vf_rss_qu”y_’
 {

602 
__u32
 
	mvf
;

603 
__u32
 
	m£‰šg
;

607 
	mIFLA_VF_STATS_RX_PACKETS
,

608 
	mIFLA_VF_STATS_TX_PACKETS
,

609 
	mIFLA_VF_STATS_RX_BYTES
,

610 
	mIFLA_VF_STATS_TX_BYTES
,

611 
	mIFLA_VF_STATS_BROADCAST
,

612 
	mIFLA_VF_STATS_MULTICAST
,

613 
	m__IFLA_VF_STATS_MAX
,

616 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

618 
	siæa_vf_Œu¡
 {

619 
__u32
 
	mvf
;

620 
__u32
 
	m£‰šg
;

639 
	mIFLA_VF_PORT_UNSPEC
,

640 
	mIFLA_VF_PORT
,

641 
	m__IFLA_VF_PORT_MAX
,

644 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

647 
	mIFLA_PORT_UNSPEC
,

648 
	mIFLA_PORT_VF
,

649 
	mIFLA_PORT_PROFILE
,

650 
	mIFLA_PORT_VSI_TYPE
,

651 
	mIFLA_PORT_INSTANCE_UUID
,

652 
	mIFLA_PORT_HOST_UUID
,

653 
	mIFLA_PORT_REQUEST
,

654 
	mIFLA_PORT_RESPONSE
,

655 
	m__IFLA_PORT_MAX
,

658 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

660 
	#PORT_PROFILE_MAX
 40

	)

661 
	#PORT_UUID_MAX
 16

	)

662 
	#PORT_SELF_VF
 -1

	)

665 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

666 
	mPORT_REQUEST_PREASSOCIATE_RR
,

667 
	mPORT_REQUEST_ASSOCIATE
,

668 
	mPORT_REQUEST_DISASSOCIATE
,

672 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

673 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

674 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

675 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

676 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

677 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

678 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

680 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

681 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

682 
	mPORT_PROFILE_RESPONSE_INVALID
,

683 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

684 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

685 
	mPORT_PROFILE_RESPONSE_ERROR
,

688 
	siæa_pÜt_vsi
 {

689 
__u8
 
	mvsi_mgr_id
;

690 
__u8
 
	mvsi_ty³_id
[3];

691 
__u8
 
	mvsi_ty³_v”siÚ
;

692 
__u8
 
	m·d
[3];

699 
	mIFLA_IPOIB_UNSPEC
,

700 
	mIFLA_IPOIB_PKEY
,

701 
	mIFLA_IPOIB_MODE
,

702 
	mIFLA_IPOIB_UMCAST
,

703 
	m__IFLA_IPOIB_MAX


707 
	mIPOIB_MODE_DATAGRAM
 = 0,

708 
	mIPOIB_MODE_CONNECTED
 = 1,

711 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

717 
	mIFLA_HSR_UNSPEC
,

718 
	mIFLA_HSR_SLAVE1
,

719 
	mIFLA_HSR_SLAVE2
,

720 
	mIFLA_HSR_MULTICAST_SPEC
,

721 
	mIFLA_HSR_SUPERVISION_ADDR
,

722 
	mIFLA_HSR_SEQ_NR
,

723 
	m__IFLA_HSR_MAX
,

726 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

	@/usr/include/linux/if_plip.h

11 #iâdeà
_LINUX_IF_PLIP_H


12 
	#_LINUX_IF_PLIP_H


	)

14 
	~<lšux/sockios.h
>

16 
	#SIOCDEVPLIP
 
SIOCDEVPRIVATE


	)

18 
	s¶cÚf
 {

19 
	mpcmd
;

20 
	mnibbË
;

21 
	mŒigg”
;

24 
	#PLIP_GET_TIMEOUT
 0x1

	)

25 
	#PLIP_SET_TIMEOUT
 0x2

	)

	@/usr/include/linux/if_slip.h

8 #iâdeà
__LINUX_SLIP_H


9 
	#__LINUX_SLIP_H


	)

11 
	#SL_MODE_SLIP
 0

	)

12 
	#SL_MODE_CSLIP
 1

	)

13 
	#SL_MODE_KISS
 4

	)

15 
	#SL_OPT_SIXBIT
 2

	)

16 
	#SL_OPT_ADAPTIVE
 8

	)

22 
	#SIOCSKEEPALIVE
 (
SIOCDEVPRIVATE
è

	)

23 
	#SIOCGKEEPALIVE
 (
SIOCDEVPRIVATE
+1è

	)

24 
	#SIOCSOUTFILL
 (
SIOCDEVPRIVATE
+2è

	)

25 
	#SIOCGOUTFILL
 (
SIOCDEVPRIVATE
+3è

	)

26 
	#SIOCSLEASE
 (
SIOCDEVPRIVATE
+4è

	)

27 
	#SIOCGLEASE
 (
SIOCDEVPRIVATE
+5è

	)

	@/usr/include/linux/if_tunnel.h

1 #iâdeà
_IF_TUNNEL_H_


2 
	#_IF_TUNNEL_H_


	)

4 
	~<lšux/ty³s.h
>

5 
	~<asm/by‹Üd”.h
>

8 
	#SIOCGETTUNNEL
 (
SIOCDEVPRIVATE
 + 0)

	)

9 
	#SIOCADDTUNNEL
 (
SIOCDEVPRIVATE
 + 1)

	)

10 
	#SIOCDELTUNNEL
 (
SIOCDEVPRIVATE
 + 2)

	)

11 
	#SIOCCHGTUNNEL
 (
SIOCDEVPRIVATE
 + 3)

	)

12 
	#SIOCGETPRL
 (
SIOCDEVPRIVATE
 + 4)

	)

13 
	#SIOCADDPRL
 (
SIOCDEVPRIVATE
 + 5)

	)

14 
	#SIOCDELPRL
 (
SIOCDEVPRIVATE
 + 6)

	)

15 
	#SIOCCHGPRL
 (
SIOCDEVPRIVATE
 + 7)

	)

16 
	#SIOCGET6RD
 (
SIOCDEVPRIVATE
 + 8)

	)

17 
	#SIOCADD6RD
 (
SIOCDEVPRIVATE
 + 9)

	)

18 
	#SIOCDEL6RD
 (
SIOCDEVPRIVATE
 + 10)

	)

19 
	#SIOCCHG6RD
 (
SIOCDEVPRIVATE
 + 11)

	)

21 
	#GRE_CSUM
 
	`__ıu_to_be16
(0x8000)

	)

22 
	#GRE_ROUTING
 
	`__ıu_to_be16
(0x4000)

	)

23 
	#GRE_KEY
 
	`__ıu_to_be16
(0x2000)

	)

24 
	#GRE_SEQ
 
	`__ıu_to_be16
(0x1000)

	)

25 
	#GRE_STRICT
 
	`__ıu_to_be16
(0x0800)

	)

26 
	#GRE_REC
 
	`__ıu_to_be16
(0x0700)

	)

27 
	#GRE_FLAGS
 
	`__ıu_to_be16
(0x00F8)

	)

28 
	#GRE_VERSION
 
	`__ıu_to_be16
(0x0007)

	)

30 
	s_tuÂ–_·rm
 {

31 
	mÇme
[
IFNAMSIZ
];

32 
	mlšk
;

33 
__be16
 
	mi_æags
;

34 
__be16
 
	mo_æags
;

35 
__be32
 
	mi_key
;

36 
__be32
 
	mo_key
;

37 
hdr
 
	mh
;

41 
	mIFLA_IPTUN_UNSPEC
,

42 
	mIFLA_IPTUN_LINK
,

43 
	mIFLA_IPTUN_LOCAL
,

44 
	mIFLA_IPTUN_REMOTE
,

45 
	mIFLA_IPTUN_TTL
,

46 
	mIFLA_IPTUN_TOS
,

47 
	mIFLA_IPTUN_ENCAP_LIMIT
,

48 
	mIFLA_IPTUN_FLOWINFO
,

49 
	mIFLA_IPTUN_FLAGS
,

50 
	mIFLA_IPTUN_PROTO
,

51 
	mIFLA_IPTUN_PMTUDISC
,

52 
	mIFLA_IPTUN_6RD_PREFIX
,

53 
	mIFLA_IPTUN_6RD_RELAY_PREFIX
,

54 
	mIFLA_IPTUN_6RD_PREFIXLEN
,

55 
	mIFLA_IPTUN_6RD_RELAY_PREFIXLEN
,

56 
	mIFLA_IPTUN_ENCAP_TYPE
,

57 
	mIFLA_IPTUN_ENCAP_FLAGS
,

58 
	mIFLA_IPTUN_ENCAP_SPORT
,

59 
	mIFLA_IPTUN_ENCAP_DPORT
,

61 
	m__IFLA_IPTUN_VENDOR_BREAK
,

62 
	mIFLA_IPTUN_FAN_MAP
 = 33,

64 
	m__IFLA_IPTUN_MAX
,

66 
	#IFLA_IPTUN_MAX
 (
__IFLA_IPTUN_MAX
 - 1)

	)

68 
	etuÂ–_’ÿp_ty³s
 {

69 
	mTUNNEL_ENCAP_NONE
,

70 
	mTUNNEL_ENCAP_FOU
,

71 
	mTUNNEL_ENCAP_GUE
,

74 
	#TUNNEL_ENCAP_FLAG_CSUM
 (1<<0)

	)

75 
	#TUNNEL_ENCAP_FLAG_CSUM6
 (1<<1)

	)

76 
	#TUNNEL_ENCAP_FLAG_REMCSUM
 (1<<2)

	)

79 
	#SIT_ISATAP
 0x0001

	)

81 
	s_tuÂ–_´l
 {

82 
__be32
 
	maddr
;

83 
__u16
 
	mæags
;

84 
__u16
 
	m__»£rved
;

85 
__u32
 
	md©®’
;

86 
__u32
 
	m__»£rved2
;

91 
	#PRL_DEFAULT
 0x0001

	)

93 
	s_tuÂ–_6rd
 {

94 
š6_addr
 
	m´efix
;

95 
__be32
 
	m»Ïy_´efix
;

96 
__u16
 
	m´efixËn
;

97 
__u16
 
	m»Ïy_´efixËn
;

101 
	mIFLA_GRE_UNSPEC
,

102 
	mIFLA_GRE_LINK
,

103 
	mIFLA_GRE_IFLAGS
,

104 
	mIFLA_GRE_OFLAGS
,

105 
	mIFLA_GRE_IKEY
,

106 
	mIFLA_GRE_OKEY
,

107 
	mIFLA_GRE_LOCAL
,

108 
	mIFLA_GRE_REMOTE
,

109 
	mIFLA_GRE_TTL
,

110 
	mIFLA_GRE_TOS
,

111 
	mIFLA_GRE_PMTUDISC
,

112 
	mIFLA_GRE_ENCAP_LIMIT
,

113 
	mIFLA_GRE_FLOWINFO
,

114 
	mIFLA_GRE_FLAGS
,

115 
	mIFLA_GRE_ENCAP_TYPE
,

116 
	mIFLA_GRE_ENCAP_FLAGS
,

117 
	mIFLA_GRE_ENCAP_SPORT
,

118 
	mIFLA_GRE_ENCAP_DPORT
,

119 
	mIFLA_GRE_COLLECT_METADATA
,

120 
	m__IFLA_GRE_MAX
,

123 
	#IFLA_GRE_MAX
 (
__IFLA_GRE_MAX
 - 1)

	)

126 
	#VTI_ISVTI
 ((
__be16
)0x0001)

	)

129 
	mIFLA_VTI_UNSPEC
,

130 
	mIFLA_VTI_LINK
,

131 
	mIFLA_VTI_IKEY
,

132 
	mIFLA_VTI_OKEY
,

133 
	mIFLA_VTI_LOCAL
,

134 
	mIFLA_VTI_REMOTE
,

135 
	m__IFLA_VTI_MAX
,

138 
	#IFLA_VTI_MAX
 (
__IFLA_VTI_MAX
 - 1)

	)

141 
	mIFLA_FAN_UNSPEC
,

142 
	mIFLA_FAN_MAPPING
,

143 
	m__IFLA_FAN_MAX
,

146 
	#IFLA_FAN_MAX
 (
__IFLA_FAN_MAX
 - 1)

	)

148 
	siæa_çn_m­
 {

149 
__be32
 
	mund”Ïy
;

150 
__be32
 
	mov”Ïy
;

151 
__u16
 
	mund”Ïy_´efix
;

152 
__u16
 
	mov”Ïy_´efix
;

	@/usr/include/linux/if_vlan.h

13 #iâdeà
_LINUX_IF_VLAN_H_


14 
	#_LINUX_IF_VLAN_H_


	)

20 
	evÏn_ioùl_cmds
 {

21 
	mADD_VLAN_CMD
,

22 
	mDEL_VLAN_CMD
,

23 
	mSET_VLAN_INGRESS_PRIORITY_CMD
,

24 
	mSET_VLAN_EGRESS_PRIORITY_CMD
,

25 
	mGET_VLAN_INGRESS_PRIORITY_CMD
,

26 
	mGET_VLAN_EGRESS_PRIORITY_CMD
,

27 
	mSET_VLAN_NAME_TYPE_CMD
,

28 
	mSET_VLAN_FLAG_CMD
,

29 
	mGET_VLAN_REALDEV_NAME_CMD
,

30 
	mGET_VLAN_VID_CMD


33 
	evÏn_æags
 {

34 
	mVLAN_FLAG_REORDER_HDR
 = 0x1,

35 
	mVLAN_FLAG_GVRP
 = 0x2,

36 
	mVLAN_FLAG_LOOSE_BINDING
 = 0x4,

37 
	mVLAN_FLAG_MVRP
 = 0x8,

40 
	evÏn_Çme_ty³s
 {

41 
	mVLAN_NAME_TYPE_PLUS_VID
,

42 
	mVLAN_NAME_TYPE_RAW_PLUS_VID
,

43 
	mVLAN_NAME_TYPE_PLUS_VID_NO_PAD
,

44 
	mVLAN_NAME_TYPE_RAW_PLUS_VID_NO_PAD
,

45 
	mVLAN_NAME_TYPE_HIGHEST


48 
	svÏn_ioùl_¬gs
 {

49 
	mcmd
;

50 
	mdeviû1
[24];

53 
	mdeviû2
[24];

54 
	mVID
;

55 
	mskb_´iÜ™y
;

56 
	mÇme_ty³
;

57 
	mbšd_ty³
;

58 
	mæag
;

59 } 
	mu
;

61 
	mvÏn_qos
;

	@/usr/include/linux/in_route.h

1 #iâdeà
_LINUX_IN_ROUTE_H


2 
	#_LINUX_IN_ROUTE_H


	)

6 
	#RTCF_DEAD
 
RTNH_F_DEAD


	)

7 
	#RTCF_ONLINK
 
RTNH_F_ONLINK


	)

10 
	#RTCF_NOPMTUDISC
 
RTM_F_NOPMTUDISC


	)

12 
	#RTCF_NOTIFY
 0x00010000

	)

13 
	#RTCF_DIRECTDST
 0x00020000

	)

14 
	#RTCF_REDIRECTED
 0x00040000

	)

15 
	#RTCF_TPROXY
 0x00080000

	)

17 
	#RTCF_FAST
 0x00200000

	)

18 
	#RTCF_MASQ
 0x00400000

	)

19 
	#RTCF_SNAT
 0x00800000

	)

20 
	#RTCF_DOREDIRECT
 0x01000000

	)

21 
	#RTCF_DIRECTSRC
 0x04000000

	)

22 
	#RTCF_DNAT
 0x08000000

	)

23 
	#RTCF_BROADCAST
 0x10000000

	)

24 
	#RTCF_MULTICAST
 0x20000000

	)

25 
	#RTCF_REJECT
 0x40000000

	)

26 
	#RTCF_LOCAL
 0x80000000

	)

28 
	#RTCF_NAT
 (
RTCF_DNAT
|
RTCF_SNAT
)

	)

30 
	#RT_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

	@/usr/include/linux/inet_diag.h

1 #iâdeà
_INET_DIAG_H_


2 
	#_INET_DIAG_H_


	)

4 
	~<lšux/ty³s.h
>

7 
	#TCPDIAG_GETSOCK
 18

	)

8 
	#DCCPDIAG_GETSOCK
 19

	)

10 
	#INET_DIAG_GETSOCK_MAX
 24

	)

13 
	sš‘_dŸg_sockid
 {

14 
__be16
 
	midŸg_¥Üt
;

15 
__be16
 
	midŸg_dpÜt
;

16 
__be32
 
	midŸg_¤c
[4];

17 
__be32
 
	midŸg_d¡
[4];

18 
__u32
 
	midŸg_if
;

19 
__u32
 
	midŸg_cook›
[2];

20 
	#INET_DIAG_NOCOOKIE
 (~0U)

	)

25 
	sš‘_dŸg_»q
 {

26 
__u8
 
	midŸg_çmy
;

27 
__u8
 
	midŸg_¤c_Ën
;

28 
__u8
 
	midŸg_d¡_Ën
;

29 
__u8
 
	midŸg_ext
;

31 
š‘_dŸg_sockid
 
	mid
;

33 
__u32
 
	midŸg_¡©es
;

34 
__u32
 
	midŸg_dbs
;

37 
	sš‘_dŸg_»q_v2
 {

38 
__u8
 
	msdŸg_çmy
;

39 
__u8
 
	msdŸg_´ÙocŞ
;

40 
__u8
 
	midŸg_ext
;

41 
__u8
 
	m·d
;

42 
__u32
 
	midŸg_¡©es
;

43 
š‘_dŸg_sockid
 
	mid
;

47 
	mINET_DIAG_REQ_NONE
,

48 
	mINET_DIAG_REQ_BYTECODE
,

51 
	#INET_DIAG_REQ_MAX
 
INET_DIAG_REQ_BYTECODE


	)

59 
	sš‘_dŸg_bc_İ
 {

60 
	mcode
;

61 
	myes
;

62 
	mno
;

66 
	mINET_DIAG_BC_NOP
,

67 
	mINET_DIAG_BC_JMP
,

68 
	mINET_DIAG_BC_S_GE
,

69 
	mINET_DIAG_BC_S_LE
,

70 
	mINET_DIAG_BC_D_GE
,

71 
	mINET_DIAG_BC_D_LE
,

72 
	mINET_DIAG_BC_AUTO
,

73 
	mINET_DIAG_BC_S_COND
,

74 
	mINET_DIAG_BC_D_COND
,

77 
	sš‘_dŸg_ho¡cÚd
 {

78 
__u8
 
	mçmy
;

79 
__u8
 
	m´efix_Ën
;

80 
	mpÜt
;

81 
__be32
 
	maddr
[0];

86 
	sš‘_dŸg_msg
 {

87 
__u8
 
	midŸg_çmy
;

88 
__u8
 
	midŸg_¡©e
;

89 
__u8
 
	midŸg_tim”
;

90 
__u8
 
	midŸg_»Œªs
;

92 
š‘_dŸg_sockid
 
	mid
;

94 
__u32
 
	midŸg_expœes
;

95 
__u32
 
	midŸg_rqueue
;

96 
__u32
 
	midŸg_wqueue
;

97 
__u32
 
	midŸg_uid
;

98 
__u32
 
	midŸg_šode
;

104 
	mINET_DIAG_NONE
,

105 
	mINET_DIAG_MEMINFO
,

106 
	mINET_DIAG_INFO
,

107 
	mINET_DIAG_VEGASINFO
,

108 
	mINET_DIAG_CONG
,

109 
	mINET_DIAG_TOS
,

110 
	mINET_DIAG_TCLASS
,

111 
	mINET_DIAG_SKMEMINFO
,

112 
	mINET_DIAG_SHUTDOWN
,

113 
	mINET_DIAG_DCTCPINFO
,

114 
	mINET_DIAG_PROTOCOL
,

115 
	mINET_DIAG_SKV6ONLY
,

118 
	#INET_DIAG_MAX
 
INET_DIAG_SKV6ONLY


	)

122 
	sš‘_dŸg_memšfo
 {

123 
__u32
 
	midŸg_rmem
;

124 
__u32
 
	midŸg_wmem
;

125 
__u32
 
	midŸg_fmem
;

126 
__u32
 
	midŸg_tmem
;

131 
	stıvegas_šfo
 {

132 
__u32
 
	mtıv_’abËd
;

133 
__u32
 
	mtıv_¹tút
;

134 
__u32
 
	mtıv_¹t
;

135 
__u32
 
	mtıv_mš¹t
;

140 
	stı_dùı_šfo
 {

141 
__u16
 
	mdùı_’abËd
;

142 
__u16
 
	mdùı_û_¡©e
;

143 
__u32
 
	mdùı_®pha
;

144 
__u32
 
	mdùı_ab_eú
;

145 
__u32
 
	mdùı_ab_tÙ
;

148 
	utı_cc_šfo
 {

149 
tıvegas_šfo
 
	mvegas
;

150 
tı_dùı_šfo
 
	mdùı
;

	@/usr/include/linux/ip.h

17 #iâdeà
_LINUX_IP_H


18 
	#_LINUX_IP_H


	)

19 
	~<lšux/ty³s.h
>

20 
	~<asm/by‹Üd”.h
>

22 
	#IPTOS_TOS_MASK
 0x1E

	)

23 
	#IPTOS_TOS
(
tos
è(Ños)&
IPTOS_TOS_MASK
)

	)

24 
	#IPTOS_LOWDELAY
 0x10

	)

25 
	#IPTOS_THROUGHPUT
 0x08

	)

26 
	#IPTOS_RELIABILITY
 0x04

	)

27 
	#IPTOS_MINCOST
 0x02

	)

29 
	#IPTOS_PREC_MASK
 0xE0

	)

30 
	#IPTOS_PREC
(
tos
è(Ños)&
IPTOS_PREC_MASK
)

	)

31 
	#IPTOS_PREC_NETCONTROL
 0xe0

	)

32 
	#IPTOS_PREC_INTERNETCONTROL
 0xc0

	)

33 
	#IPTOS_PREC_CRITIC_ECP
 0xa0

	)

34 
	#IPTOS_PREC_FLASHOVERRIDE
 0x80

	)

35 
	#IPTOS_PREC_FLASH
 0x60

	)

36 
	#IPTOS_PREC_IMMEDIATE
 0x40

	)

37 
	#IPTOS_PREC_PRIORITY
 0x20

	)

38 
	#IPTOS_PREC_ROUTINE
 0x00

	)

42 
	#IPOPT_COPY
 0x80

	)

43 
	#IPOPT_CLASS_MASK
 0x60

	)

44 
	#IPOPT_NUMBER_MASK
 0x1f

	)

46 
	#IPOPT_COPIED
(
o
è((o)&
IPOPT_COPY
)

	)

47 
	#IPOPT_CLASS
(
o
è((o)&
IPOPT_CLASS_MASK
)

	)

48 
	#IPOPT_NUMBER
(
o
è((o)&
IPOPT_NUMBER_MASK
)

	)

50 
	#IPOPT_CONTROL
 0x00

	)

51 
	#IPOPT_RESERVED1
 0x20

	)

52 
	#IPOPT_MEASUREMENT
 0x40

	)

53 
	#IPOPT_RESERVED2
 0x60

	)

55 
	#IPOPT_END
 (0 |
IPOPT_CONTROL
)

	)

56 
	#IPOPT_NOOP
 (1 |
IPOPT_CONTROL
)

	)

57 
	#IPOPT_SEC
 (2 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

58 
	#IPOPT_LSRR
 (3 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

59 
	#IPOPT_TIMESTAMP
 (4 |
IPOPT_MEASUREMENT
)

	)

60 
	#IPOPT_CIPSO
 (6 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

61 
	#IPOPT_RR
 (7 |
IPOPT_CONTROL
)

	)

62 
	#IPOPT_SID
 (8 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

63 
	#IPOPT_SSRR
 (9 |
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

64 
	#IPOPT_RA
 (20|
IPOPT_CONTROL
|
IPOPT_COPY
)

	)

66 
	#IPVERSION
 4

	)

67 
	#MAXTTL
 255

	)

68 
	#IPDEFTTL
 64

	)

70 
	#IPOPT_OPTVAL
 0

	)

71 
	#IPOPT_OLEN
 1

	)

72 
	#IPOPT_OFFSET
 2

	)

73 
	#IPOPT_MINOFF
 4

	)

74 
	#MAX_IPOPTLEN
 40

	)

75 
	#IPOPT_NOP
 
IPOPT_NOOP


	)

76 
	#IPOPT_EOL
 
IPOPT_END


	)

77 
	#IPOPT_TS
 
IPOPT_TIMESTAMP


	)

79 
	#IPOPT_TS_TSONLY
 0

	)

80 
	#IPOPT_TS_TSANDADDR
 1

	)

81 
	#IPOPT_TS_PRESPEC
 3

	)

83 
	#IPV4_BEET_PHMAXLEN
 8

	)

85 
	shdr
 {

86 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

87 
__u8
 
	mihl
:4,

88 
	mv”siÚ
:4;

89 #–ià
defšed
 (
__BIG_ENDIAN_BITFIELD
)

90 
__u8
 
	mv”siÚ
:4,

91 
	mihl
:4;

95 
__u8
 
	mtos
;

96 
__be16
 
	mtÙ_Ën
;

97 
__be16
 
	mid
;

98 
__be16
 
	mäag_off
;

99 
__u8
 
	m‰l
;

100 
__u8
 
	m´ÙocŞ
;

101 
__sum16
 
	mcheck
;

102 
__be32
 
	m§ddr
;

103 
__be32
 
	mdaddr
;

108 
	s_auth_hdr
 {

109 
__u8
 
	mÃxthdr
;

110 
__u8
 
	mhd¾’
;

111 
__be16
 
	m»£rved
;

112 
__be32
 
	m¥i
;

113 
__be32
 
	m£q_no
;

114 
__u8
 
	mauth_d©a
[0];

117 
	s_e¥_hdr
 {

118 
__be32
 
	m¥i
;

119 
__be32
 
	m£q_no
;

120 
__u8
 
	m’c_d©a
[0];

123 
	s_comp_hdr
 {

124 
__u8
 
	mÃxthdr
;

125 
__u8
 
	mæags
;

126 
__be16
 
	mıi
;

129 
	s_b“t_phdr
 {

130 
__u8
 
	mÃxthdr
;

131 
__u8
 
	mhd¾’
;

132 
__u8
 
	m·dËn
;

133 
__u8
 
	m»£rved
;

139 
	mIPV4_DEVCONF_FORWARDING
=1,

140 
	mIPV4_DEVCONF_MC_FORWARDING
,

141 
	mIPV4_DEVCONF_PROXY_ARP
,

142 
	mIPV4_DEVCONF_ACCEPT_REDIRECTS
,

143 
	mIPV4_DEVCONF_SECURE_REDIRECTS
,

144 
	mIPV4_DEVCONF_SEND_REDIRECTS
,

145 
	mIPV4_DEVCONF_SHARED_MEDIA
,

146 
	mIPV4_DEVCONF_RP_FILTER
,

147 
	mIPV4_DEVCONF_ACCEPT_SOURCE_ROUTE
,

148 
	mIPV4_DEVCONF_BOOTP_RELAY
,

149 
	mIPV4_DEVCONF_LOG_MARTIANS
,

150 
	mIPV4_DEVCONF_TAG
,

151 
	mIPV4_DEVCONF_ARPFILTER
,

152 
	mIPV4_DEVCONF_MEDIUM_ID
,

153 
	mIPV4_DEVCONF_NOXFRM
,

154 
	mIPV4_DEVCONF_NOPOLICY
,

155 
	mIPV4_DEVCONF_FORCE_IGMP_VERSION
,

156 
	mIPV4_DEVCONF_ARP_ANNOUNCE
,

157 
	mIPV4_DEVCONF_ARP_IGNORE
,

158 
	mIPV4_DEVCONF_PROMOTE_SECONDARIES
,

159 
	mIPV4_DEVCONF_ARP_ACCEPT
,

160 
	mIPV4_DEVCONF_ARP_NOTIFY
,

161 
	mIPV4_DEVCONF_ACCEPT_LOCAL
,

162 
	mIPV4_DEVCONF_SRC_VMARK
,

163 
	mIPV4_DEVCONF_PROXY_ARP_PVLAN
,

164 
	mIPV4_DEVCONF_ROUTE_LOCALNET
,

165 
	mIPV4_DEVCONF_IGMPV2_UNSOLICITED_REPORT_INTERVAL
,

166 
	mIPV4_DEVCONF_IGMPV3_UNSOLICITED_REPORT_INTERVAL
,

167 
	mIPV4_DEVCONF_IGNORE_ROUTES_WITH_LINKDOWN
,

168 
	m__IPV4_DEVCONF_MAX


171 
	#IPV4_DEVCONF_MAX
 (
__IPV4_DEVCONF_MAX
 - 1)

	)

	@/usr/include/linux/ipv6.h

1 #iâdeà
_IPV6_H


2 
	#_IPV6_H


	)

4 
	~<lšux/libc-com·t.h
>

5 
	~<lšux/ty³s.h
>

6 
	~<lšux/š6.h
>

7 
	~<asm/by‹Üd”.h
>

11 
	#IPV6_MIN_MTU
 1280

	)

19 #ià
__UAPI_DEF_IN6_PKTINFO


20 
	sš6_pktšfo
 {

21 
š6_addr
 
	mi6_addr
;

22 
	mi6_ifšdex
;

26 #ià
__UAPI_DEF_IP6_MTUINFO


27 
	s6_mtušfo
 {

28 
sockaddr_š6
 
	m6m_addr
;

29 
__u32
 
	m6m_mtu
;

33 
	sš6_iäeq
 {

34 
š6_addr
 
	miä6_addr
;

35 
__u32
 
	miä6_´efixËn
;

36 
	miä6_ifšdex
;

39 
	#IPV6_SRCRT_STRICT
 0x01

	)

40 
	#IPV6_SRCRT_TYPE_0
 0

	)

41 
	#IPV6_SRCRT_TYPE_2
 2

	)

46 
	sv6_¹_hdr
 {

47 
__u8
 
	mÃxthdr
;

48 
__u8
 
	mhd¾’
;

49 
__u8
 
	mty³
;

50 
__u8
 
	m£gm’ts_Ëá
;

59 
	sv6_İt_hdr
 {

60 
__u8
 
	mÃxthdr
;

61 
__u8
 
	mhd¾’
;

65 } 
__©Œibu‹__
((
·cked
));

67 
	#v6_de¡İt_hdr
 
v6_İt_hdr


	)

68 
	#v6_hİİt_hdr
 
v6_İt_hdr


	)

71 
	#IPV6_OPT_ROUTERALERT_MLD
 0x0000

	)

77 
	s¹0_hdr
 {

78 
v6_¹_hdr
 
	m¹_hdr
;

79 
__u32
 
	m»£rved
;

80 
š6_addr
 
	maddr
[0];

82 
	#¹0_ty³
 
¹_hdr
.
ty³


	)

89 
	s¹2_hdr
 {

90 
v6_¹_hdr
 
	m¹_hdr
;

91 
__u32
 
	m»£rved
;

92 
š6_addr
 
	maddr
;

94 
	#¹2_ty³
 
¹_hdr
.
ty³


	)

101 
	sv6_de¡İt_hao
 {

102 
__u8
 
	mty³
;

103 
__u8
 
	mËngth
;

104 
š6_addr
 
	maddr
;

105 } 
__©Œibu‹__
((
·cked
));

114 
	sv6hdr
 {

115 #ià
defšed
(
__LITTLE_ENDIAN_BITFIELD
)

116 
__u8
 
	m´iÜ™y
:4,

117 
	mv”siÚ
:4;

118 #–ià
defšed
(
__BIG_ENDIAN_BITFIELD
)

119 
__u8
 
	mv”siÚ
:4,

120 
	m´iÜ™y
:4;

124 
__u8
 
	mæow_lbl
[3];

126 
__be16
 
	m·ylßd_Ën
;

127 
__u8
 
	mÃxthdr
;

128 
__u8
 
	mhİ_lim™
;

130 
š6_addr
 
	m§ddr
;

131 
š6_addr
 
	mdaddr
;

137 
	mDEVCONF_FORWARDING
 = 0,

138 
	mDEVCONF_HOPLIMIT
,

139 
	mDEVCONF_MTU6
,

140 
	mDEVCONF_ACCEPT_RA
,

141 
	mDEVCONF_ACCEPT_REDIRECTS
,

142 
	mDEVCONF_AUTOCONF
,

143 
	mDEVCONF_DAD_TRANSMITS
,

144 
	mDEVCONF_RTR_SOLICITS
,

145 
	mDEVCONF_RTR_SOLICIT_INTERVAL
,

146 
	mDEVCONF_RTR_SOLICIT_DELAY
,

147 
	mDEVCONF_USE_TEMPADDR
,

148 
	mDEVCONF_TEMP_VALID_LFT
,

149 
	mDEVCONF_TEMP_PREFERED_LFT
,

150 
	mDEVCONF_REGEN_MAX_RETRY
,

151 
	mDEVCONF_MAX_DESYNC_FACTOR
,

152 
	mDEVCONF_MAX_ADDRESSES
,

153 
	mDEVCONF_FORCE_MLD_VERSION
,

154 
	mDEVCONF_ACCEPT_RA_DEFRTR
,

155 
	mDEVCONF_ACCEPT_RA_PINFO
,

156 
	mDEVCONF_ACCEPT_RA_RTR_PREF
,

157 
	mDEVCONF_RTR_PROBE_INTERVAL
,

158 
	mDEVCONF_ACCEPT_RA_RT_INFO_MAX_PLEN
,

159 
	mDEVCONF_PROXY_NDP
,

160 
	mDEVCONF_OPTIMISTIC_DAD
,

161 
	mDEVCONF_ACCEPT_SOURCE_ROUTE
,

162 
	mDEVCONF_MC_FORWARDING
,

163 
	mDEVCONF_DISABLE_IPV6
,

164 
	mDEVCONF_ACCEPT_DAD
,

165 
	mDEVCONF_FORCE_TLLAO
,

166 
	mDEVCONF_NDISC_NOTIFY
,

167 
	mDEVCONF_MLDV1_UNSOLICITED_REPORT_INTERVAL
,

168 
	mDEVCONF_MLDV2_UNSOLICITED_REPORT_INTERVAL
,

169 
	mDEVCONF_SUPPRESS_FRAG_NDISC
,

170 
	mDEVCONF_ACCEPT_RA_FROM_LOCAL
,

171 
	mDEVCONF_USE_OPTIMISTIC
,

172 
	mDEVCONF_ACCEPT_RA_MTU
,

173 
	mDEVCONF_STABLE_SECRET
,

174 
	mDEVCONF_USE_OIF_ADDRS_ONLY
,

175 
	mDEVCONF_ACCEPT_RA_MIN_HOP_LIMIT
,

176 
	mDEVCONF_IGNORE_ROUTES_WITH_LINKDOWN
,

177 
	mDEVCONF_MAX


	@/usr/include/linux/neighbour.h

1 #iâdeà
__LINUX_NEIGHBOUR_H


2 
	#__LINUX_NEIGHBOUR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	sndmsg
 {

8 
__u8
 
	mndm_çmy
;

9 
__u8
 
	mndm_·d1
;

10 
__u16
 
	mndm_·d2
;

11 
__s32
 
	mndm_ifšdex
;

12 
__u16
 
	mndm_¡©e
;

13 
__u8
 
	mndm_æags
;

14 
__u8
 
	mndm_ty³
;

18 
	mNDA_UNSPEC
,

19 
	mNDA_DST
,

20 
	mNDA_LLADDR
,

21 
	mNDA_CACHEINFO
,

22 
	mNDA_PROBES
,

23 
	mNDA_VLAN
,

24 
	mNDA_PORT
,

25 
	mNDA_VNI
,

26 
	mNDA_IFINDEX
,

27 
	mNDA_MASTER
,

28 
	mNDA_LINK_NETNSID
,

29 
	m__NDA_MAX


32 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

38 
	#NTF_USE
 0x01

	)

39 
	#NTF_SELF
 0x02

	)

40 
	#NTF_MASTER
 0x04

	)

41 
	#NTF_PROXY
 0x08

	)

42 
	#NTF_EXT_LEARNED
 0x10

	)

43 
	#NTF_ROUTER
 0x80

	)

49 
	#NUD_INCOMPLETE
 0x01

	)

50 
	#NUD_REACHABLE
 0x02

	)

51 
	#NUD_STALE
 0x04

	)

52 
	#NUD_DELAY
 0x08

	)

53 
	#NUD_PROBE
 0x10

	)

54 
	#NUD_FAILED
 0x20

	)

57 
	#NUD_NOARP
 0x40

	)

58 
	#NUD_PERMANENT
 0x80

	)

59 
	#NUD_NONE
 0x00

	)

66 
	snda_ÿchešfo
 {

67 
__u32
 
	mndm_cÚfœmed
;

68 
__u32
 
	mndm_u£d
;

69 
__u32
 
	mndm_upd©ed
;

70 
__u32
 
	mndm_»fút
;

98 
	sndt_¡©s
 {

99 
__u64
 
	mndts_®locs
;

100 
__u64
 
	mndts_de¡roys
;

101 
__u64
 
	mndts_hash_grows
;

102 
__u64
 
	mndts_»s_çed
;

103 
__u64
 
	mndts_lookups
;

104 
__u64
 
	mndts_h™s
;

105 
__u64
 
	mndts_rcv_´obes_mÿ¡
;

106 
__u64
 
	mndts_rcv_´obes_uÿ¡
;

107 
__u64
 
	mndts_³riodic_gc_runs
;

108 
__u64
 
	mndts_fÜûd_gc_runs
;

109 
__u64
 
	mndts_bË_fuÎs
;

113 
	mNDTPA_UNSPEC
,

114 
	mNDTPA_IFINDEX
,

115 
	mNDTPA_REFCNT
,

116 
	mNDTPA_REACHABLE_TIME
,

117 
	mNDTPA_BASE_REACHABLE_TIME
,

118 
	mNDTPA_RETRANS_TIME
,

119 
	mNDTPA_GC_STALETIME
,

120 
	mNDTPA_DELAY_PROBE_TIME
,

121 
	mNDTPA_QUEUE_LEN
,

122 
	mNDTPA_APP_PROBES
,

123 
	mNDTPA_UCAST_PROBES
,

124 
	mNDTPA_MCAST_PROBES
,

125 
	mNDTPA_ANYCAST_DELAY
,

126 
	mNDTPA_PROXY_DELAY
,

127 
	mNDTPA_PROXY_QLEN
,

128 
	mNDTPA_LOCKTIME
,

129 
	mNDTPA_QUEUE_LENBYTES
,

130 
	mNDTPA_MCAST_REPROBES
,

131 
	m__NDTPA_MAX


133 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

135 
	sndtmsg
 {

136 
__u8
 
	mndtm_çmy
;

137 
__u8
 
	mndtm_·d1
;

138 
__u16
 
	mndtm_·d2
;

141 
	sndt_cÚfig
 {

142 
__u16
 
	mndtc_key_Ën
;

143 
__u16
 
	mndtc_’Œy_size
;

144 
__u32
 
	mndtc_’Œ›s
;

145 
__u32
 
	mndtc_Ï¡_æush
;

146 
__u32
 
	mndtc_Ï¡_¿nd
;

147 
__u32
 
	mndtc_hash_ºd
;

148 
__u32
 
	mndtc_hash_mask
;

149 
__u32
 
	mndtc_hash_chaš_gc
;

150 
__u32
 
	mndtc_´oxy_qËn
;

154 
	mNDTA_UNSPEC
,

155 
	mNDTA_NAME
,

156 
	mNDTA_THRESH1
,

157 
	mNDTA_THRESH2
,

158 
	mNDTA_THRESH3
,

159 
	mNDTA_CONFIG
,

160 
	mNDTA_PARMS
,

161 
	mNDTA_STATS
,

162 
	mNDTA_GC_INTERVAL
,

163 
	m__NDTA_MAX


165 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/if_lšk.h
>

34 
	#MAX_ADDR_LEN
 32

	)

37 
	#INIT_NETDEV_GROUP
 0

	)

41 
	#NET_NAME_UNKNOWN
 0

	)

42 
	#NET_NAME_ENUM
 1

	)

43 
	#NET_NAME_PREDICTABLE
 2

	)

44 
	#NET_NAME_USER
 3

	)

45 
	#NET_NAME_RENAMED
 4

	)

49 
	mIF_PORT_UNKNOWN
 = 0,

50 
	mIF_PORT_10BASE2
,

51 
	mIF_PORT_10BASET
,

52 
	mIF_PORT_AUI
,

53 
	mIF_PORT_100BASET
,

54 
	mIF_PORT_100BASETX
,

55 
	mIF_PORT_100BASEFX


59 
	#NET_ADDR_PERM
 0

	)

60 
	#NET_ADDR_RANDOM
 1

	)

61 
	#NET_ADDR_STOLEN
 2

	)

62 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/netfilter.h

1 #iâdeà
__LINUX_NETFILTER_H


2 
	#__LINUX_NETFILTER_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<lšux/sysùl.h
>

7 
	~<lšux/š.h
>

8 
	~<lšux/š6.h
>

11 
	#NF_DROP
 0

	)

12 
	#NF_ACCEPT
 1

	)

13 
	#NF_STOLEN
 2

	)

14 
	#NF_QUEUE
 3

	)

15 
	#NF_REPEAT
 4

	)

16 
	#NF_STOP
 5

	)

17 
	#NF_MAX_VERDICT
 
NF_STOP


	)

22 
	#NF_VERDICT_MASK
 0x000000ff

	)

25 
	#NF_VERDICT_FLAG_QUEUE_BYPASS
 0x00008000

	)

28 
	#NF_VERDICT_QMASK
 0xffff0000

	)

29 
	#NF_VERDICT_QBITS
 16

	)

31 
	#NF_QUEUE_NR
(
x
è((((xè<< 16è& 
NF_VERDICT_QMASK
è| 
NF_QUEUE
)

	)

33 
	#NF_DROP_ERR
(
x
è(((-xè<< 16è| 
NF_DROP
)

	)

38 
	#NFC_UNKNOWN
 0x4000

	)

39 
	#NFC_ALTERED
 0x8000

	)

42 
	#NF_VERDICT_BITS
 16

	)

44 
	enf_š‘_hooks
 {

45 
	mNF_INET_PRE_ROUTING
,

46 
	mNF_INET_LOCAL_IN
,

47 
	mNF_INET_FORWARD
,

48 
	mNF_INET_LOCAL_OUT
,

49 
	mNF_INET_POST_ROUTING
,

50 
	mNF_INET_NUMHOOKS


53 
	enf_dev_hooks
 {

54 
	mNF_NETDEV_INGRESS
,

55 
	mNF_NETDEV_NUMHOOKS


59 
	mNFPROTO_UNSPEC
 = 0,

60 
	mNFPROTO_INET
 = 1,

61 
	mNFPROTO_IPV4
 = 2,

62 
	mNFPROTO_ARP
 = 3,

63 
	mNFPROTO_NETDEV
 = 5,

64 
	mNFPROTO_BRIDGE
 = 7,

65 
	mNFPROTO_IPV6
 = 10,

66 
	mNFPROTO_DECNET
 = 12,

67 
	mNFPROTO_NUMPROTO
,

70 
	unf_š‘_addr
 {

71 
__u32
 
	m®l
[4];

72 
__be32
 
	m
;

73 
__be32
 
	m6
[4];

74 
š_addr
 
	mš
;

75 
š6_addr
 
	mš6
;

	@/usr/include/linux/netfilter/nf_conntrack_common.h

1 #iâdeà
_NF_CONNTRACK_COMMON_H


2 
	#_NF_CONNTRACK_COMMON_H


	)

6 
	e_cÚÁ¿ck_šfo
 {

8 
	mIP_CT_ESTABLISHED
,

12 
	mIP_CT_RELATED
,

16 
	mIP_CT_NEW
,

19 
	mIP_CT_IS_REPLY
,

21 
	mIP_CT_ESTABLISHED_REPLY
 = 
IP_CT_ESTABLISHED
 + 
IP_CT_IS_REPLY
,

22 
	mIP_CT_RELATED_REPLY
 = 
IP_CT_RELATED
 + 
IP_CT_IS_REPLY
,

23 
	mIP_CT_NEW_REPLY
 = 
IP_CT_NEW
 + 
IP_CT_IS_REPLY
,

25 
	mIP_CT_NUMBER
 = 
IP_CT_IS_REPLY
 * 2 - 1

28 
	#NF_CT_STATE_INVALID_BIT
 (1 << 0)

	)

29 
	#NF_CT_STATE_BIT
(
ùšfo
è(1 << ((ùšfoè% 
IP_CT_IS_REPLY
 + 1))

	)

30 
	#NF_CT_STATE_UNTRACKED_BIT
 (1 << (
IP_CT_NUMBER
 + 1))

	)

33 
	e_cÚÁ¿ck_¡©us
 {

35 
	mIPS_EXPECTED_BIT
 = 0,

36 
	mIPS_EXPECTED
 = (1 << 
IPS_EXPECTED_BIT
),

39 
	mIPS_SEEN_REPLY_BIT
 = 1,

40 
	mIPS_SEEN_REPLY
 = (1 << 
IPS_SEEN_REPLY_BIT
),

43 
	mIPS_ASSURED_BIT
 = 2,

44 
	mIPS_ASSURED
 = (1 << 
IPS_ASSURED_BIT
),

47 
	mIPS_CONFIRMED_BIT
 = 3,

48 
	mIPS_CONFIRMED
 = (1 << 
IPS_CONFIRMED_BIT
),

51 
	mIPS_SRC_NAT_BIT
 = 4,

52 
	mIPS_SRC_NAT
 = (1 << 
IPS_SRC_NAT_BIT
),

55 
	mIPS_DST_NAT_BIT
 = 5,

56 
	mIPS_DST_NAT
 = (1 << 
IPS_DST_NAT_BIT
),

59 
	mIPS_NAT_MASK
 = (
IPS_DST_NAT
 | 
IPS_SRC_NAT
),

62 
	mIPS_SEQ_ADJUST_BIT
 = 6,

63 
	mIPS_SEQ_ADJUST
 = (1 << 
IPS_SEQ_ADJUST_BIT
),

66 
	mIPS_SRC_NAT_DONE_BIT
 = 7,

67 
	mIPS_SRC_NAT_DONE
 = (1 << 
IPS_SRC_NAT_DONE_BIT
),

69 
	mIPS_DST_NAT_DONE_BIT
 = 8,

70 
	mIPS_DST_NAT_DONE
 = (1 << 
IPS_DST_NAT_DONE_BIT
),

73 
	mIPS_NAT_DONE_MASK
 = (
IPS_DST_NAT_DONE
 | 
IPS_SRC_NAT_DONE
),

76 
	mIPS_DYING_BIT
 = 9,

77 
	mIPS_DYING
 = (1 << 
IPS_DYING_BIT
),

80 
	mIPS_FIXED_TIMEOUT_BIT
 = 10,

81 
	mIPS_FIXED_TIMEOUT
 = (1 << 
IPS_FIXED_TIMEOUT_BIT
),

84 
	mIPS_TEMPLATE_BIT
 = 11,

85 
	mIPS_TEMPLATE
 = (1 << 
IPS_TEMPLATE_BIT
),

88 
	mIPS_UNTRACKED_BIT
 = 12,

89 
	mIPS_UNTRACKED
 = (1 << 
IPS_UNTRACKED_BIT
),

92 
	mIPS_HELPER_BIT
 = 13,

93 
	mIPS_HELPER
 = (1 << 
IPS_HELPER_BIT
),

97 
	e_cÚÁ¿ck_ev’ts
 {

98 
	mIPCT_NEW
,

99 
	mIPCT_RELATED
,

100 
	mIPCT_DESTROY
,

101 
	mIPCT_REPLY
,

102 
	mIPCT_ASSURED
,

103 
	mIPCT_PROTOINFO
,

104 
	mIPCT_HELPER
,

105 
	mIPCT_MARK
,

106 
	mIPCT_SEQADJ
,

107 
	mIPCT_NATSEQADJ
 = 
IPCT_SEQADJ
,

108 
	mIPCT_SECMARK
,

109 
	mIPCT_LABEL
,

112 
	e_cÚÁ¿ck_ex³ù_ev’ts
 {

113 
	mIPEXP_NEW
,

114 
	mIPEXP_DESTROY
,

118 
	#NF_CT_EXPECT_PERMANENT
 0x1

	)

119 
	#NF_CT_EXPECT_INACTIVE
 0x2

	)

120 
	#NF_CT_EXPECT_USERSPACE
 0x4

	)

	@/usr/include/linux/netfilter/nf_conntrack_tcp.h

1 #iâdeà
_NF_CONNTRACK_TCP_H


2 
	#_NF_CONNTRACK_TCP_H


	)

5 
	~<lšux/ty³s.h
>

8 
	etı_cÚÁ¿ck
 {

9 
	mTCP_CONNTRACK_NONE
,

10 
	mTCP_CONNTRACK_SYN_SENT
,

11 
	mTCP_CONNTRACK_SYN_RECV
,

12 
	mTCP_CONNTRACK_ESTABLISHED
,

13 
	mTCP_CONNTRACK_FIN_WAIT
,

14 
	mTCP_CONNTRACK_CLOSE_WAIT
,

15 
	mTCP_CONNTRACK_LAST_ACK
,

16 
	mTCP_CONNTRACK_TIME_WAIT
,

17 
	mTCP_CONNTRACK_CLOSE
,

18 
	mTCP_CONNTRACK_LISTEN
,

19 
	#TCP_CONNTRACK_SYN_SENT2
 
TCP_CONNTRACK_LISTEN


	)

20 
	mTCP_CONNTRACK_MAX
,

21 
	mTCP_CONNTRACK_IGNORE
,

22 
	mTCP_CONNTRACK_RETRANS
,

23 
	mTCP_CONNTRACK_UNACK
,

24 
	mTCP_CONNTRACK_TIMEOUT_MAX


28 
	#IP_CT_TCP_FLAG_WINDOW_SCALE
 0x01

	)

31 
	#IP_CT_TCP_FLAG_SACK_PERM
 0x02

	)

34 
	#IP_CT_TCP_FLAG_CLOSE_INIT
 0x04

	)

37 
	#IP_CT_TCP_FLAG_BE_LIBERAL
 0x08

	)

40 
	#IP_CT_TCP_FLAG_DATA_UNACKNOWLEDGED
 0x10

	)

43 
	#IP_CT_TCP_FLAG_MAXACK_SET
 0x20

	)

46 
	#IP_CT_EXP_CHALLENGE_ACK
 0x40

	)

48 
	snf_ù_tı_æags
 {

49 
__u8
 
	mæags
;

50 
__u8
 
	mmask
;

	@/usr/include/linux/netfilter/nfnetlink.h

1 #iâdeà
_NFNETLINK_H


2 
	#_NFNETLINK_H


	)

3 
	~<lšux/ty³s.h
>

4 
	~<lšux/Ãtf‹r/nâ‘lšk_com·t.h
>

6 
	enâ‘lšk_groups
 {

7 
	mNFNLGRP_NONE
,

8 
	#NFNLGRP_NONE
 
NFNLGRP_NONE


	)

9 
	mNFNLGRP_CONNTRACK_NEW
,

10 
	#NFNLGRP_CONNTRACK_NEW
 
NFNLGRP_CONNTRACK_NEW


	)

11 
	mNFNLGRP_CONNTRACK_UPDATE
,

12 
	#NFNLGRP_CONNTRACK_UPDATE
 
NFNLGRP_CONNTRACK_UPDATE


	)

13 
	mNFNLGRP_CONNTRACK_DESTROY
,

14 
	#NFNLGRP_CONNTRACK_DESTROY
 
NFNLGRP_CONNTRACK_DESTROY


	)

15 
	mNFNLGRP_CONNTRACK_EXP_NEW
,

16 
	#NFNLGRP_CONNTRACK_EXP_NEW
 
NFNLGRP_CONNTRACK_EXP_NEW


	)

17 
	mNFNLGRP_CONNTRACK_EXP_UPDATE
,

18 
	#NFNLGRP_CONNTRACK_EXP_UPDATE
 
NFNLGRP_CONNTRACK_EXP_UPDATE


	)

19 
	mNFNLGRP_CONNTRACK_EXP_DESTROY
,

20 
	#NFNLGRP_CONNTRACK_EXP_DESTROY
 
NFNLGRP_CONNTRACK_EXP_DESTROY


	)

21 
	mNFNLGRP_NFTABLES
,

22 
	#NFNLGRP_NFTABLES
 
NFNLGRP_NFTABLES


	)

23 
	mNFNLGRP_ACCT_QUOTA
,

24 
	#NFNLGRP_ACCT_QUOTA
 
NFNLGRP_ACCT_QUOTA


	)

25 
	m__NFNLGRP_MAX
,

27 
	#NFNLGRP_MAX
 (
__NFNLGRP_MAX
 - 1)

	)

31 
	snfg’msg
 {

32 
__u8
 
	mnfg’_çmy
;

33 
__u8
 
	mv”siÚ
;

34 
__be16
 
	m»s_id
;

37 
	#NFNETLINK_V0
 0

	)

43 
	#NFNL_SUBSYS_ID
(
x
è((x & 0xff00è>> 8)

	)

44 
	#NFNL_MSG_TYPE
(
x
è(x & 0x00ff)

	)

48 
	#NFNL_SUBSYS_NONE
 0

	)

49 
	#NFNL_SUBSYS_CTNETLINK
 1

	)

50 
	#NFNL_SUBSYS_CTNETLINK_EXP
 2

	)

51 
	#NFNL_SUBSYS_QUEUE
 3

	)

52 
	#NFNL_SUBSYS_ULOG
 4

	)

53 
	#NFNL_SUBSYS_OSF
 5

	)

54 
	#NFNL_SUBSYS_IPSET
 6

	)

55 
	#NFNL_SUBSYS_ACCT
 7

	)

56 
	#NFNL_SUBSYS_CTNETLINK_TIMEOUT
 8

	)

57 
	#NFNL_SUBSYS_CTHELPER
 9

	)

58 
	#NFNL_SUBSYS_NFTABLES
 10

	)

59 
	#NFNL_SUBSYS_NFT_COMPAT
 11

	)

60 
	#NFNL_SUBSYS_COUNT
 12

	)

63 
	#NFNL_MSG_BATCH_BEGIN
 
NLMSG_MIN_TYPE


	)

64 
	#NFNL_MSG_BATCH_END
 
NLMSG_MIN_TYPE
+1

	)

	@/usr/include/linux/netfilter/nfnetlink_compat.h

1 #iâdeà
_NFNETLINK_COMPAT_H


2 
	#_NFNETLINK_COMPAT_H


	)

4 
	~<lšux/ty³s.h
>

9 
	#NF_NETLINK_CONNTRACK_NEW
 0x00000001

	)

10 
	#NF_NETLINK_CONNTRACK_UPDATE
 0x00000002

	)

11 
	#NF_NETLINK_CONNTRACK_DESTROY
 0x00000004

	)

12 
	#NF_NETLINK_CONNTRACK_EXP_NEW
 0x00000008

	)

13 
	#NF_NETLINK_CONNTRACK_EXP_UPDATE
 0x00000010

	)

14 
	#NF_NETLINK_CONNTRACK_EXP_DESTROY
 0x00000020

	)

23 
	snç‰r
 {

24 
__u16
 
	mnç_Ën
;

25 
__u16
 
	mnç_ty³
;

32 
	#NFNL_NFA_NEST
 0x8000

	)

33 
	#NFA_TYPE
(
©Œ
è(×‰r)->
nç_ty³
 & 0x7fff)

	)

35 
	#NFA_ALIGNTO
 4

	)

36 
	#NFA_ALIGN
(
Ën
è((Ö’è+ 
NFA_ALIGNTO
 - 1è& ~(NFA_ALIGNTO - 1))

	)

37 
	#NFA_OK
(
nç
,
Ën
è(Ö’è> 0 && (nç)->
nç_Ën
 >ğ(
nç‰r
) \

38 && (
nç
)->
nç_Ën
 <ğ(
Ën
))

	)

39 
	#NFA_NEXT
(
nç
,
©ŒËn
è(×‰¾’è-ğ
	`NFA_ALIGN
(Òç)->
nç_Ën
), \

40 (
nç‰r
 *)(((*)(
nç
)è+ 
	`NFA_ALIGN
(Òç)->
nç_Ën
)))

	)

41 
	#NFA_LENGTH
(
Ën
è(
	`NFA_ALIGN
((
nç‰r
)è+ (Ën))

	)

42 
	#NFA_SPACE
(
Ën
è
	`NFA_ALIGN
(
	`NFA_LENGTH
Ö’))

	)

43 
	#NFA_DATA
(
nç
è((*)(((*)Òç)è+ 
	`NFA_LENGTH
(0)))

	)

44 
	#NFA_PAYLOAD
(
nç
è(()(Òç)->
nç_Ën
è- 
	`NFA_LENGTH
(0))

	)

45 
	#NFA_NEST
(
skb
, 
ty³
) \

46 ({ 
nç‰r
 *
__¡¬t
 = (nç‰¸*)
	`skb__poš‹r
(
skb
); \

47 
	`NFA_PUT
(
skb
, (
NFNL_NFA_NEST
 | 
ty³
), 0, 
NULL
); \

48 
__¡¬t
; })

	)

49 
	#NFA_NEST_END
(
skb
, 
¡¬t
) \

50 ({ (
¡¬t
)->
nç_Ën
 = 
	`skb__poš‹r
(
skb
) - (*)(start); \

51 (
skb
)->
Ën
; })

	)

52 
	#NFA_NEST_CANCEL
(
skb
, 
¡¬t
) \

53 ({ ià(
¡¬t
) \

54 
	`skb_Œim
(
skb
, (*è(
¡¬t
è- (skb)->
d©a
); \

55 -1; })

	)

57 
	#NFM_NFA
(
n
è((
nç‰r
 *)(((*)(n)) \

58 + 
	`NLMSG_ALIGN
((
nfg’msg
))))

	)

59 
	#NFM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò, (
nfg’msg
))

	)

	@/usr/include/linux/netfilter/nfnetlink_conntrack.h

1 #iâdeà
_IPCONNTRACK_NETLINK_H


2 
	#_IPCONNTRACK_NETLINK_H


	)

3 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

5 
	eú_msg_ty³s
 {

6 
	mIPCTNL_MSG_CT_NEW
,

7 
	mIPCTNL_MSG_CT_GET
,

8 
	mIPCTNL_MSG_CT_DELETE
,

9 
	mIPCTNL_MSG_CT_GET_CTRZERO
,

10 
	mIPCTNL_MSG_CT_GET_STATS_CPU
,

11 
	mIPCTNL_MSG_CT_GET_STATS
,

12 
	mIPCTNL_MSG_CT_GET_DYING
,

13 
	mIPCTNL_MSG_CT_GET_UNCONFIRMED
,

15 
	mIPCTNL_MSG_MAX


18 
	eùÆ_exp_msg_ty³s
 {

19 
	mIPCTNL_MSG_EXP_NEW
,

20 
	mIPCTNL_MSG_EXP_GET
,

21 
	mIPCTNL_MSG_EXP_DELETE
,

22 
	mIPCTNL_MSG_EXP_GET_STATS_CPU
,

24 
	mIPCTNL_MSG_EXP_MAX


28 
	eù©Œ_ty³
 {

29 
	mCTA_UNSPEC
,

30 
	mCTA_TUPLE_ORIG
,

31 
	mCTA_TUPLE_REPLY
,

32 
	mCTA_STATUS
,

33 
	mCTA_PROTOINFO
,

34 
	mCTA_HELP
,

35 
	mCTA_NAT_SRC
,

36 
	#CTA_NAT
 
CTA_NAT_SRC


	)

37 
	mCTA_TIMEOUT
,

38 
	mCTA_MARK
,

39 
	mCTA_COUNTERS_ORIG
,

40 
	mCTA_COUNTERS_REPLY
,

41 
	mCTA_USE
,

42 
	mCTA_ID
,

43 
	mCTA_NAT_DST
,

44 
	mCTA_TUPLE_MASTER
,

45 
	mCTA_SEQ_ADJ_ORIG
,

46 
	mCTA_NAT_SEQ_ADJ_ORIG
 = 
CTA_SEQ_ADJ_ORIG
,

47 
	mCTA_SEQ_ADJ_REPLY
,

48 
	mCTA_NAT_SEQ_ADJ_REPLY
 = 
CTA_SEQ_ADJ_REPLY
,

49 
	mCTA_SECMARK
,

50 
	mCTA_ZONE
,

51 
	mCTA_SECCTX
,

52 
	mCTA_TIMESTAMP
,

53 
	mCTA_MARK_MASK
,

54 
	mCTA_LABELS
,

55 
	mCTA_LABELS_MASK
,

56 
	m__CTA_MAX


58 
	#CTA_MAX
 (
__CTA_MAX
 - 1)

	)

60 
	eù©Œ_tu¶e
 {

61 
	mCTA_TUPLE_UNSPEC
,

62 
	mCTA_TUPLE_IP
,

63 
	mCTA_TUPLE_PROTO
,

64 
	mCTA_TUPLE_ZONE
,

65 
	m__CTA_TUPLE_MAX


67 
	#CTA_TUPLE_MAX
 (
__CTA_TUPLE_MAX
 - 1)

	)

69 
	eù©Œ_
 {

70 
	mCTA_IP_UNSPEC
,

71 
	mCTA_IP_V4_SRC
,

72 
	mCTA_IP_V4_DST
,

73 
	mCTA_IP_V6_SRC
,

74 
	mCTA_IP_V6_DST
,

75 
	m__CTA_IP_MAX


77 
	#CTA_IP_MAX
 (
__CTA_IP_MAX
 - 1)

	)

79 
	eù©Œ_l4´Ùo
 {

80 
	mCTA_PROTO_UNSPEC
,

81 
	mCTA_PROTO_NUM
,

82 
	mCTA_PROTO_SRC_PORT
,

83 
	mCTA_PROTO_DST_PORT
,

84 
	mCTA_PROTO_ICMP_ID
,

85 
	mCTA_PROTO_ICMP_TYPE
,

86 
	mCTA_PROTO_ICMP_CODE
,

87 
	mCTA_PROTO_ICMPV6_ID
,

88 
	mCTA_PROTO_ICMPV6_TYPE
,

89 
	mCTA_PROTO_ICMPV6_CODE
,

90 
	m__CTA_PROTO_MAX


92 
	#CTA_PROTO_MAX
 (
__CTA_PROTO_MAX
 - 1)

	)

94 
	eù©Œ_´Ùošfo
 {

95 
	mCTA_PROTOINFO_UNSPEC
,

96 
	mCTA_PROTOINFO_TCP
,

97 
	mCTA_PROTOINFO_DCCP
,

98 
	mCTA_PROTOINFO_SCTP
,

99 
	m__CTA_PROTOINFO_MAX


101 
	#CTA_PROTOINFO_MAX
 (
__CTA_PROTOINFO_MAX
 - 1)

	)

103 
	eù©Œ_´Ùošfo_tı
 {

104 
	mCTA_PROTOINFO_TCP_UNSPEC
,

105 
	mCTA_PROTOINFO_TCP_STATE
,

106 
	mCTA_PROTOINFO_TCP_WSCALE_ORIGINAL
,

107 
	mCTA_PROTOINFO_TCP_WSCALE_REPLY
,

108 
	mCTA_PROTOINFO_TCP_FLAGS_ORIGINAL
,

109 
	mCTA_PROTOINFO_TCP_FLAGS_REPLY
,

110 
	m__CTA_PROTOINFO_TCP_MAX


112 
	#CTA_PROTOINFO_TCP_MAX
 (
__CTA_PROTOINFO_TCP_MAX
 - 1)

	)

114 
	eù©Œ_´Ùošfo_dcı
 {

115 
	mCTA_PROTOINFO_DCCP_UNSPEC
,

116 
	mCTA_PROTOINFO_DCCP_STATE
,

117 
	mCTA_PROTOINFO_DCCP_ROLE
,

118 
	mCTA_PROTOINFO_DCCP_HANDSHAKE_SEQ
,

119 
	m__CTA_PROTOINFO_DCCP_MAX
,

121 
	#CTA_PROTOINFO_DCCP_MAX
 (
__CTA_PROTOINFO_DCCP_MAX
 - 1)

	)

123 
	eù©Œ_´Ùošfo_sùp
 {

124 
	mCTA_PROTOINFO_SCTP_UNSPEC
,

125 
	mCTA_PROTOINFO_SCTP_STATE
,

126 
	mCTA_PROTOINFO_SCTP_VTAG_ORIGINAL
,

127 
	mCTA_PROTOINFO_SCTP_VTAG_REPLY
,

128 
	m__CTA_PROTOINFO_SCTP_MAX


130 
	#CTA_PROTOINFO_SCTP_MAX
 (
__CTA_PROTOINFO_SCTP_MAX
 - 1)

	)

132 
	eù©Œ_couÁ”s
 {

133 
	mCTA_COUNTERS_UNSPEC
,

134 
	mCTA_COUNTERS_PACKETS
,

135 
	mCTA_COUNTERS_BYTES
,

136 
	mCTA_COUNTERS32_PACKETS
,

137 
	mCTA_COUNTERS32_BYTES
,

138 
	m__CTA_COUNTERS_MAX


140 
	#CTA_COUNTERS_MAX
 (
__CTA_COUNTERS_MAX
 - 1)

	)

142 
	eù©Œ_t¡amp
 {

143 
	mCTA_TIMESTAMP_UNSPEC
,

144 
	mCTA_TIMESTAMP_START
,

145 
	mCTA_TIMESTAMP_STOP
,

146 
	m__CTA_TIMESTAMP_MAX


148 
	#CTA_TIMESTAMP_MAX
 (
__CTA_TIMESTAMP_MAX
 - 1)

	)

150 
	eù©Œ_Çt
 {

151 
	mCTA_NAT_UNSPEC
,

152 
	mCTA_NAT_V4_MINIP
,

153 
	#CTA_NAT_MINIP
 
CTA_NAT_V4_MINIP


	)

154 
	mCTA_NAT_V4_MAXIP
,

155 
	#CTA_NAT_MAXIP
 
CTA_NAT_V4_MAXIP


	)

156 
	mCTA_NAT_PROTO
,

157 
	mCTA_NAT_V6_MINIP
,

158 
	mCTA_NAT_V6_MAXIP
,

159 
	m__CTA_NAT_MAX


161 
	#CTA_NAT_MAX
 (
__CTA_NAT_MAX
 - 1)

	)

163 
	eù©Œ_´ÙÚ©
 {

164 
	mCTA_PROTONAT_UNSPEC
,

165 
	mCTA_PROTONAT_PORT_MIN
,

166 
	mCTA_PROTONAT_PORT_MAX
,

167 
	m__CTA_PROTONAT_MAX


169 
	#CTA_PROTONAT_MAX
 (
__CTA_PROTONAT_MAX
 - 1)

	)

171 
	eù©Œ_£qadj
 {

172 
	mCTA_SEQADJ_UNSPEC
,

173 
	mCTA_SEQADJ_CORRECTION_POS
,

174 
	mCTA_SEQADJ_OFFSET_BEFORE
,

175 
	mCTA_SEQADJ_OFFSET_AFTER
,

176 
	m__CTA_SEQADJ_MAX


178 
	#CTA_SEQADJ_MAX
 (
__CTA_SEQADJ_MAX
 - 1)

	)

180 
	eù©Œ_Çt£q
 {

181 
	mCTA_NAT_SEQ_UNSPEC
,

182 
	mCTA_NAT_SEQ_CORRECTION_POS
,

183 
	mCTA_NAT_SEQ_OFFSET_BEFORE
,

184 
	mCTA_NAT_SEQ_OFFSET_AFTER
,

185 
	m__CTA_NAT_SEQ_MAX


187 
	#CTA_NAT_SEQ_MAX
 (
__CTA_NAT_SEQ_MAX
 - 1)

	)

189 
	eù©Œ_ex³ù
 {

190 
	mCTA_EXPECT_UNSPEC
,

191 
	mCTA_EXPECT_MASTER
,

192 
	mCTA_EXPECT_TUPLE
,

193 
	mCTA_EXPECT_MASK
,

194 
	mCTA_EXPECT_TIMEOUT
,

195 
	mCTA_EXPECT_ID
,

196 
	mCTA_EXPECT_HELP_NAME
,

197 
	mCTA_EXPECT_ZONE
,

198 
	mCTA_EXPECT_FLAGS
,

199 
	mCTA_EXPECT_CLASS
,

200 
	mCTA_EXPECT_NAT
,

201 
	mCTA_EXPECT_FN
,

202 
	m__CTA_EXPECT_MAX


204 
	#CTA_EXPECT_MAX
 (
__CTA_EXPECT_MAX
 - 1)

	)

206 
	eù©Œ_ex³ù_Çt
 {

207 
	mCTA_EXPECT_NAT_UNSPEC
,

208 
	mCTA_EXPECT_NAT_DIR
,

209 
	mCTA_EXPECT_NAT_TUPLE
,

210 
	m__CTA_EXPECT_NAT_MAX


212 
	#CTA_EXPECT_NAT_MAX
 (
__CTA_EXPECT_NAT_MAX
 - 1)

	)

214 
	eù©Œ_h–p
 {

215 
	mCTA_HELP_UNSPEC
,

216 
	mCTA_HELP_NAME
,

217 
	mCTA_HELP_INFO
,

218 
	m__CTA_HELP_MAX


220 
	#CTA_HELP_MAX
 (
__CTA_HELP_MAX
 - 1)

	)

222 
	eù©Œ_£cùx
 {

223 
	mCTA_SECCTX_UNSPEC
,

224 
	mCTA_SECCTX_NAME
,

225 
	m__CTA_SECCTX_MAX


227 
	#CTA_SECCTX_MAX
 (
__CTA_SECCTX_MAX
 - 1)

	)

229 
	eù©Œ_¡©s_ıu
 {

230 
	mCTA_STATS_UNSPEC
,

231 
	mCTA_STATS_SEARCHED
,

232 
	mCTA_STATS_FOUND
,

233 
	mCTA_STATS_NEW
,

234 
	mCTA_STATS_INVALID
,

235 
	mCTA_STATS_IGNORE
,

236 
	mCTA_STATS_DELETE
,

237 
	mCTA_STATS_DELETE_LIST
,

238 
	mCTA_STATS_INSERT
,

239 
	mCTA_STATS_INSERT_FAILED
,

240 
	mCTA_STATS_DROP
,

241 
	mCTA_STATS_EARLY_DROP
,

242 
	mCTA_STATS_ERROR
,

243 
	mCTA_STATS_SEARCH_RESTART
,

244 
	m__CTA_STATS_MAX
,

246 
	#CTA_STATS_MAX
 (
__CTA_STATS_MAX
 - 1)

	)

248 
	eù©Œ_¡©s_glob®
 {

249 
	mCTA_STATS_GLOBAL_UNSPEC
,

250 
	mCTA_STATS_GLOBAL_ENTRIES
,

251 
	m__CTA_STATS_GLOBAL_MAX
,

253 
	#CTA_STATS_GLOBAL_MAX
 (
__CTA_STATS_GLOBAL_MAX
 - 1)

	)

255 
	eù©Œ_ex³ù_¡©s
 {

256 
	mCTA_STATS_EXP_UNSPEC
,

257 
	mCTA_STATS_EXP_NEW
,

258 
	mCTA_STATS_EXP_CREATE
,

259 
	mCTA_STATS_EXP_DELETE
,

260 
	m__CTA_STATS_EXP_MAX
,

262 
	#CTA_STATS_EXP_MAX
 (
__CTA_STATS_EXP_MAX
 - 1)

	)

	@/usr/include/linux/netfilter/nfnetlink_log.h

1 #iâdeà
_NFNETLINK_LOG_H


2 
	#_NFNETLINK_LOG_H


	)

8 
	~<lšux/ty³s.h
>

9 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

11 
	enfuÊl_msg_ty³s
 {

12 
	mNFULNL_MSG_PACKET
,

13 
	mNFULNL_MSG_CONFIG
,

15 
	mNFULNL_MSG_MAX


18 
	snfuÊl_msg_·ck‘_hdr
 {

19 
__be16
 
	mhw_´ÙocŞ
;

20 
__u8
 
	mhook
;

21 
__u8
 
	m_·d
;

24 
	snfuÊl_msg_·ck‘_hw
 {

25 
__be16
 
	mhw_add¾’
;

26 
__u16
 
	m_·d
;

27 
__u8
 
	mhw_addr
[8];

30 
	snfuÊl_msg_·ck‘_time¡amp
 {

31 
__®igÃd_be64
 
	m£c
;

32 
__®igÃd_be64
 
	mu£c
;

35 
	enfuÊl_©Œ_ty³
 {

36 
	mNFULA_UNSPEC
,

37 
	mNFULA_PACKET_HDR
,

38 
	mNFULA_MARK
,

39 
	mNFULA_TIMESTAMP
,

40 
	mNFULA_IFINDEX_INDEV
,

41 
	mNFULA_IFINDEX_OUTDEV
,

42 
	mNFULA_IFINDEX_PHYSINDEV
,

43 
	mNFULA_IFINDEX_PHYSOUTDEV
,

44 
	mNFULA_HWADDR
,

45 
	mNFULA_PAYLOAD
,

46 
	mNFULA_PREFIX
,

47 
	mNFULA_UID
,

48 
	mNFULA_SEQ
,

49 
	mNFULA_SEQ_GLOBAL
,

50 
	mNFULA_GID
,

51 
	mNFULA_HWTYPE
,

52 
	mNFULA_HWHEADER
,

53 
	mNFULA_HWLEN
,

54 
	mNFULA_CT
,

55 
	mNFULA_CT_INFO
,

57 
	m__NFULA_MAX


59 
	#NFULA_MAX
 (
__NFULA_MAX
 - 1)

	)

61 
	enfuÊl_msg_cÚfig_cmds
 {

62 
	mNFULNL_CFG_CMD_NONE
,

63 
	mNFULNL_CFG_CMD_BIND
,

64 
	mNFULNL_CFG_CMD_UNBIND
,

65 
	mNFULNL_CFG_CMD_PF_BIND
,

66 
	mNFULNL_CFG_CMD_PF_UNBIND
,

69 
	snfuÊl_msg_cÚfig_cmd
 {

70 
__u8
 
	mcommªd
;

71 } 
__©Œibu‹__
 ((
·cked
));

73 
	snfuÊl_msg_cÚfig_mode
 {

74 
__be32
 
	mcİy_¿nge
;

75 
__u8
 
	mcİy_mode
;

76 
__u8
 
	m_·d
;

77 } 
__©Œibu‹__
 ((
·cked
));

79 
	enfuÊl_©Œ_cÚfig
 {

80 
	mNFULA_CFG_UNSPEC
,

81 
	mNFULA_CFG_CMD
,

82 
	mNFULA_CFG_MODE
,

83 
	mNFULA_CFG_NLBUFSIZ
,

84 
	mNFULA_CFG_TIMEOUT
,

85 
	mNFULA_CFG_QTHRESH
,

86 
	mNFULA_CFG_FLAGS
,

87 
	m__NFULA_CFG_MAX


89 
	#NFULA_CFG_MAX
 (
__NFULA_CFG_MAX
 -1)

	)

91 
	#NFULNL_COPY_NONE
 0x00

	)

92 
	#NFULNL_COPY_META
 0x01

	)

93 
	#NFULNL_COPY_PACKET
 0x02

	)

96 
	#NFULNL_CFG_F_SEQ
 0x0001

	)

97 
	#NFULNL_CFG_F_SEQ_GLOBAL
 0x0002

	)

98 
	#NFULNL_CFG_F_CONNTRACK
 0x0004

	)

	@/usr/include/linux/netfilter/nfnetlink_queue.h

1 #iâdeà
_NFNETLINK_QUEUE_H


2 
	#_NFNETLINK_QUEUE_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãtf‹r/nâ‘lšk.h
>

7 
	enfqÆ_msg_ty³s
 {

8 
	mNFQNL_MSG_PACKET
,

9 
	mNFQNL_MSG_VERDICT
,

10 
	mNFQNL_MSG_CONFIG
,

11 
	mNFQNL_MSG_VERDICT_BATCH
,

13 
	mNFQNL_MSG_MAX


16 
	snfqÆ_msg_·ck‘_hdr
 {

17 
__be32
 
	m·ck‘_id
;

18 
__be16
 
	mhw_´ÙocŞ
;

19 
__u8
 
	mhook
;

20 } 
__©Œibu‹__
 ((
·cked
));

22 
	snfqÆ_msg_·ck‘_hw
 {

23 
__be16
 
	mhw_add¾’
;

24 
__u16
 
	m_·d
;

25 
__u8
 
	mhw_addr
[8];

28 
	snfqÆ_msg_·ck‘_time¡amp
 {

29 
__®igÃd_be64
 
	m£c
;

30 
__®igÃd_be64
 
	mu£c
;

33 
	enfqÆ_©Œ_ty³
 {

34 
	mNFQA_UNSPEC
,

35 
	mNFQA_PACKET_HDR
,

36 
	mNFQA_VERDICT_HDR
,

37 
	mNFQA_MARK
,

38 
	mNFQA_TIMESTAMP
,

39 
	mNFQA_IFINDEX_INDEV
,

40 
	mNFQA_IFINDEX_OUTDEV
,

41 
	mNFQA_IFINDEX_PHYSINDEV
,

42 
	mNFQA_IFINDEX_PHYSOUTDEV
,

43 
	mNFQA_HWADDR
,

44 
	mNFQA_PAYLOAD
,

45 
	mNFQA_CT
,

46 
	mNFQA_CT_INFO
,

47 
	mNFQA_CAP_LEN
,

48 
	mNFQA_SKB_INFO
,

49 
	mNFQA_EXP
,

50 
	mNFQA_UID
,

51 
	mNFQA_GID
,

52 
	mNFQA_SECCTX
,

54 
	m__NFQA_MAX


56 
	#NFQA_MAX
 (
__NFQA_MAX
 - 1)

	)

58 
	snfqÆ_msg_v”diù_hdr
 {

59 
__be32
 
	mv”diù
;

60 
__be32
 
	mid
;

64 
	enfqÆ_msg_cÚfig_cmds
 {

65 
	mNFQNL_CFG_CMD_NONE
,

66 
	mNFQNL_CFG_CMD_BIND
,

67 
	mNFQNL_CFG_CMD_UNBIND
,

68 
	mNFQNL_CFG_CMD_PF_BIND
,

69 
	mNFQNL_CFG_CMD_PF_UNBIND
,

72 
	snfqÆ_msg_cÚfig_cmd
 {

73 
__u8
 
	mcommªd
;

74 
__u8
 
	m_·d
;

75 
__be16
 
	mpf
;

78 
	enfqÆ_cÚfig_mode
 {

79 
	mNFQNL_COPY_NONE
,

80 
	mNFQNL_COPY_META
,

81 
	mNFQNL_COPY_PACKET
,

84 
	snfqÆ_msg_cÚfig_·¿ms
 {

85 
__be32
 
	mcİy_¿nge
;

86 
__u8
 
	mcİy_mode
;

87 } 
__©Œibu‹__
 ((
·cked
));

90 
	enfqÆ_©Œ_cÚfig
 {

91 
	mNFQA_CFG_UNSPEC
,

92 
	mNFQA_CFG_CMD
,

93 
	mNFQA_CFG_PARAMS
,

94 
	mNFQA_CFG_QUEUE_MAXLEN
,

95 
	mNFQA_CFG_MASK
,

96 
	mNFQA_CFG_FLAGS
,

97 
	m__NFQA_CFG_MAX


99 
	#NFQA_CFG_MAX
 (
__NFQA_CFG_MAX
-1)

	)

102 
	#NFQA_CFG_F_FAIL_OPEN
 (1 << 0)

	)

103 
	#NFQA_CFG_F_CONNTRACK
 (1 << 1)

	)

104 
	#NFQA_CFG_F_GSO
 (1 << 2)

	)

105 
	#NFQA_CFG_F_UID_GID
 (1 << 3)

	)

106 
	#NFQA_CFG_F_SECCTX
 (1 << 4)

	)

107 
	#NFQA_CFG_F_MAX
 (1 << 5)

	)

111 
	#NFQA_SKB_CSUMNOTREADY
 (1 << 0)

	)

113 
	#NFQA_SKB_GSO
 (1 << 1)

	)

115 
	#NFQA_SKB_CSUM_NOTVERIFIED
 (1 << 2)

	)

	@/usr/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/k”Ãl.h
>

5 
	~<lšux/sock‘.h
>

6 
	~<lšux/ty³s.h
>

8 
	#NETLINK_ROUTE
 0

	)

9 
	#NETLINK_UNUSED
 1

	)

10 
	#NETLINK_USERSOCK
 2

	)

11 
	#NETLINK_FIREWALL
 3

	)

12 
	#NETLINK_SOCK_DIAG
 4

	)

13 
	#NETLINK_NFLOG
 5

	)

14 
	#NETLINK_XFRM
 6

	)

15 
	#NETLINK_SELINUX
 7

	)

16 
	#NETLINK_ISCSI
 8

	)

17 
	#NETLINK_AUDIT
 9

	)

18 
	#NETLINK_FIB_LOOKUP
 10

	)

19 
	#NETLINK_CONNECTOR
 11

	)

20 
	#NETLINK_NETFILTER
 12

	)

21 
	#NETLINK_IP6_FW
 13

	)

22 
	#NETLINK_DNRTMSG
 14

	)

23 
	#NETLINK_KOBJECT_UEVENT
 15

	)

24 
	#NETLINK_GENERIC
 16

	)

26 
	#NETLINK_SCSITRANSPORT
 18

	)

27 
	#NETLINK_ECRYPTFS
 19

	)

28 
	#NETLINK_RDMA
 20

	)

29 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

33 
	#MAX_LINKS
 32

	)

35 
	ssockaddr_Æ
 {

36 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

37 
	mÆ_·d
;

38 
__u32
 
	mÆ_pid
;

39 
__u32
 
	mÆ_groups
;

42 
	sÆmsghdr
 {

43 
__u32
 
	mÆmsg_Ën
;

44 
__u16
 
	mÆmsg_ty³
;

45 
__u16
 
	mÆmsg_æags
;

46 
__u32
 
	mÆmsg_£q
;

47 
__u32
 
	mÆmsg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

57 
	#NLM_F_DUMP_FILTERED
 32

	)

60 
	#NLM_F_ROOT
 0x100

	)

61 
	#NLM_F_MATCH
 0x200

	)

62 
	#NLM_F_ATOMIC
 0x400

	)

63 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

66 
	#NLM_F_REPLACE
 0x100

	)

67 
	#NLM_F_EXCL
 0x200

	)

68 
	#NLM_F_CREATE
 0x400

	)

69 
	#NLM_F_APPEND
 0x800

	)

80 
	#NLMSG_ALIGNTO
 4U

	)

81 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

82 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

83 
	#NLMSG_LENGTH
(
Ën
è(Ö’è+ 
NLMSG_HDRLEN
)

	)

84 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

85 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

86 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

87 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

88 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

89 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

90 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

91 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

93 
	#NLMSG_NOOP
 0x1

	)

94 
	#NLMSG_ERROR
 0x2

	)

95 
	#NLMSG_DONE
 0x3

	)

96 
	#NLMSG_OVERRUN
 0x4

	)

98 
	#NLMSG_MIN_TYPE
 0x10

	)

100 
	sÆmsg”r
 {

101 
	m”rÜ
;

102 
Æmsghdr
 
	mmsg
;

105 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

106 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

107 
	#NETLINK_PKTINFO
 3

	)

108 
	#NETLINK_BROADCAST_ERROR
 4

	)

109 
	#NETLINK_NO_ENOBUFS
 5

	)

110 
	#NETLINK_RX_RING
 6

	)

111 
	#NETLINK_TX_RING
 7

	)

112 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

113 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

114 
	#NETLINK_CAP_ACK
 10

	)

116 
	sÆ_pktšfo
 {

117 
__u32
 
	mgroup
;

120 
	sÆ_mm­_»q
 {

121 
	mnm_block_size
;

122 
	mnm_block_Ä
;

123 
	mnm_äame_size
;

124 
	mnm_äame_Ä
;

127 
	sÆ_mm­_hdr
 {

128 
	mnm_¡©us
;

129 
	mnm_Ën
;

130 
__u32
 
	mnm_group
;

132 
__u32
 
	mnm_pid
;

133 
__u32
 
	mnm_uid
;

134 
__u32
 
	mnm_gid
;

137 
	eÆ_mm­_¡©us
 {

138 
	mNL_MMAP_STATUS_UNUSED
,

139 
	mNL_MMAP_STATUS_RESERVED
,

140 
	mNL_MMAP_STATUS_VALID
,

141 
	mNL_MMAP_STATUS_COPY
,

142 
	mNL_MMAP_STATUS_SKIP
,

145 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

146 
	#NL_MMAP_MSG_ALIGN
(
sz
è
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

147 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
Æ_mm­_hdr
))

	)

149 
	#NET_MAJOR
 36

	)

152 
	mNETLINK_UNCONNECTED
 = 0,

153 
	mNETLINK_CONNECTED
,

165 
	sÆ©Œ
 {

166 
__u16
 
	mÆa_Ën
;

167 
__u16
 
	mÆa_ty³
;

180 
	#NLA_F_NESTED
 (1 << 15)

	)

181 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

182 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

184 
	#NLA_ALIGNTO
 4

	)

185 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

186 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@/usr/include/linux/nl80211.h

1 #iâdeà
__LINUX_NL80211_H


2 
	#__LINUX_NL80211_H


	)

42 
	~<lšux/ty³s.h
>

44 
	#NL80211_GENL_NAME
 "Æ80211"

	)

46 
	#NL80211_MULTICAST_GROUP_CONFIG
 "cÚfig"

	)

47 
	#NL80211_MULTICAST_GROUP_SCAN
 "sÿn"

	)

48 
	#NL80211_MULTICAST_GROUP_REG
 "»guÏtÜy"

	)

49 
	#NL80211_MULTICAST_GROUP_MLME
 "mlme"

	)

50 
	#NL80211_MULTICAST_GROUP_VENDOR
 "v’dÜ"

	)

51 
	#NL80211_MULTICAST_GROUP_TESTMODE
 "‹¡mode"

	)

826 
	eÆ80211_commªds
 {

828 
	mNL80211_CMD_UNSPEC
,

830 
	mNL80211_CMD_GET_WIPHY
,

831 
	mNL80211_CMD_SET_WIPHY
,

832 
	mNL80211_CMD_NEW_WIPHY
,

833 
	mNL80211_CMD_DEL_WIPHY
,

835 
	mNL80211_CMD_GET_INTERFACE
,

836 
	mNL80211_CMD_SET_INTERFACE
,

837 
	mNL80211_CMD_NEW_INTERFACE
,

838 
	mNL80211_CMD_DEL_INTERFACE
,

840 
	mNL80211_CMD_GET_KEY
,

841 
	mNL80211_CMD_SET_KEY
,

842 
	mNL80211_CMD_NEW_KEY
,

843 
	mNL80211_CMD_DEL_KEY
,

845 
	mNL80211_CMD_GET_BEACON
,

846 
	mNL80211_CMD_SET_BEACON
,

847 
	mNL80211_CMD_START_AP
,

848 
	mNL80211_CMD_NEW_BEACON
 = 
NL80211_CMD_START_AP
,

849 
	mNL80211_CMD_STOP_AP
,

850 
	mNL80211_CMD_DEL_BEACON
 = 
NL80211_CMD_STOP_AP
,

852 
	mNL80211_CMD_GET_STATION
,

853 
	mNL80211_CMD_SET_STATION
,

854 
	mNL80211_CMD_NEW_STATION
,

855 
	mNL80211_CMD_DEL_STATION
,

857 
	mNL80211_CMD_GET_MPATH
,

858 
	mNL80211_CMD_SET_MPATH
,

859 
	mNL80211_CMD_NEW_MPATH
,

860 
	mNL80211_CMD_DEL_MPATH
,

862 
	mNL80211_CMD_SET_BSS
,

864 
	mNL80211_CMD_SET_REG
,

865 
	mNL80211_CMD_REQ_SET_REG
,

867 
	mNL80211_CMD_GET_MESH_CONFIG
,

868 
	mNL80211_CMD_SET_MESH_CONFIG
,

870 
	mNL80211_CMD_SET_MGMT_EXTRA_IE
 ,

872 
	mNL80211_CMD_GET_REG
,

874 
	mNL80211_CMD_GET_SCAN
,

875 
	mNL80211_CMD_TRIGGER_SCAN
,

876 
	mNL80211_CMD_NEW_SCAN_RESULTS
,

877 
	mNL80211_CMD_SCAN_ABORTED
,

879 
	mNL80211_CMD_REG_CHANGE
,

881 
	mNL80211_CMD_AUTHENTICATE
,

882 
	mNL80211_CMD_ASSOCIATE
,

883 
	mNL80211_CMD_DEAUTHENTICATE
,

884 
	mNL80211_CMD_DISASSOCIATE
,

886 
	mNL80211_CMD_MICHAEL_MIC_FAILURE
,

888 
	mNL80211_CMD_REG_BEACON_HINT
,

890 
	mNL80211_CMD_JOIN_IBSS
,

891 
	mNL80211_CMD_LEAVE_IBSS
,

893 
	mNL80211_CMD_TESTMODE
,

895 
	mNL80211_CMD_CONNECT
,

896 
	mNL80211_CMD_ROAM
,

897 
	mNL80211_CMD_DISCONNECT
,

899 
	mNL80211_CMD_SET_WIPHY_NETNS
,

901 
	mNL80211_CMD_GET_SURVEY
,

902 
	mNL80211_CMD_NEW_SURVEY_RESULTS
,

904 
	mNL80211_CMD_SET_PMKSA
,

905 
	mNL80211_CMD_DEL_PMKSA
,

906 
	mNL80211_CMD_FLUSH_PMKSA
,

908 
	mNL80211_CMD_REMAIN_ON_CHANNEL
,

909 
	mNL80211_CMD_CANCEL_REMAIN_ON_CHANNEL
,

911 
	mNL80211_CMD_SET_TX_BITRATE_MASK
,

913 
	mNL80211_CMD_REGISTER_FRAME
,

914 
	mNL80211_CMD_REGISTER_ACTION
 = 
NL80211_CMD_REGISTER_FRAME
,

915 
	mNL80211_CMD_FRAME
,

916 
	mNL80211_CMD_ACTION
 = 
NL80211_CMD_FRAME
,

917 
	mNL80211_CMD_FRAME_TX_STATUS
,

918 
	mNL80211_CMD_ACTION_TX_STATUS
 = 
NL80211_CMD_FRAME_TX_STATUS
,

920 
	mNL80211_CMD_SET_POWER_SAVE
,

921 
	mNL80211_CMD_GET_POWER_SAVE
,

923 
	mNL80211_CMD_SET_CQM
,

924 
	mNL80211_CMD_NOTIFY_CQM
,

926 
	mNL80211_CMD_SET_CHANNEL
,

927 
	mNL80211_CMD_SET_WDS_PEER
,

929 
	mNL80211_CMD_FRAME_WAIT_CANCEL
,

931 
	mNL80211_CMD_JOIN_MESH
,

932 
	mNL80211_CMD_LEAVE_MESH
,

934 
	mNL80211_CMD_UNPROT_DEAUTHENTICATE
,

935 
	mNL80211_CMD_UNPROT_DISASSOCIATE
,

937 
	mNL80211_CMD_NEW_PEER_CANDIDATE
,

939 
	mNL80211_CMD_GET_WOWLAN
,

940 
	mNL80211_CMD_SET_WOWLAN
,

942 
	mNL80211_CMD_START_SCHED_SCAN
,

943 
	mNL80211_CMD_STOP_SCHED_SCAN
,

944 
	mNL80211_CMD_SCHED_SCAN_RESULTS
,

945 
	mNL80211_CMD_SCHED_SCAN_STOPPED
,

947 
	mNL80211_CMD_SET_REKEY_OFFLOAD
,

949 
	mNL80211_CMD_PMKSA_CANDIDATE
,

951 
	mNL80211_CMD_TDLS_OPER
,

952 
	mNL80211_CMD_TDLS_MGMT
,

954 
	mNL80211_CMD_UNEXPECTED_FRAME
,

956 
	mNL80211_CMD_PROBE_CLIENT
,

958 
	mNL80211_CMD_REGISTER_BEACONS
,

960 
	mNL80211_CMD_UNEXPECTED_4ADDR_FRAME
,

962 
	mNL80211_CMD_SET_NOACK_MAP
,

964 
	mNL80211_CMD_CH_SWITCH_NOTIFY
,

966 
	mNL80211_CMD_START_P2P_DEVICE
,

967 
	mNL80211_CMD_STOP_P2P_DEVICE
,

969 
	mNL80211_CMD_CONN_FAILED
,

971 
	mNL80211_CMD_SET_MCAST_RATE
,

973 
	mNL80211_CMD_SET_MAC_ACL
,

975 
	mNL80211_CMD_RADAR_DETECT
,

977 
	mNL80211_CMD_GET_PROTOCOL_FEATURES
,

979 
	mNL80211_CMD_UPDATE_FT_IES
,

980 
	mNL80211_CMD_FT_EVENT
,

982 
	mNL80211_CMD_CRIT_PROTOCOL_START
,

983 
	mNL80211_CMD_CRIT_PROTOCOL_STOP
,

985 
	mNL80211_CMD_GET_COALESCE
,

986 
	mNL80211_CMD_SET_COALESCE
,

988 
	mNL80211_CMD_CHANNEL_SWITCH
,

990 
	mNL80211_CMD_VENDOR
,

992 
	mNL80211_CMD_SET_QOS_MAP
,

994 
	mNL80211_CMD_ADD_TX_TS
,

995 
	mNL80211_CMD_DEL_TX_TS
,

997 
	mNL80211_CMD_GET_MPP
,

999 
	mNL80211_CMD_JOIN_OCB
,

1000 
	mNL80211_CMD_LEAVE_OCB
,

1002 
	mNL80211_CMD_CH_SWITCH_STARTED_NOTIFY
,

1004 
	mNL80211_CMD_TDLS_CHANNEL_SWITCH
,

1005 
	mNL80211_CMD_TDLS_CANCEL_CHANNEL_SWITCH
,

1007 
	mNL80211_CMD_WIPHY_REG_CHANGE
,

1012 
	m__NL80211_CMD_AFTER_LAST
,

1013 
	mNL80211_CMD_MAX
 = 
__NL80211_CMD_AFTER_LAST
 - 1

1020 
	#NL80211_CMD_SET_BSS
 
NL80211_CMD_SET_BSS


	)

1021 
	#NL80211_CMD_SET_MGMT_EXTRA_IE
 
NL80211_CMD_SET_MGMT_EXTRA_IE


	)

1022 
	#NL80211_CMD_REG_CHANGE
 
NL80211_CMD_REG_CHANGE


	)

1023 
	#NL80211_CMD_AUTHENTICATE
 
NL80211_CMD_AUTHENTICATE


	)

1024 
	#NL80211_CMD_ASSOCIATE
 
NL80211_CMD_ASSOCIATE


	)

1025 
	#NL80211_CMD_DEAUTHENTICATE
 
NL80211_CMD_DEAUTHENTICATE


	)

1026 
	#NL80211_CMD_DISASSOCIATE
 
NL80211_CMD_DISASSOCIATE


	)

1027 
	#NL80211_CMD_REG_BEACON_HINT
 
NL80211_CMD_REG_BEACON_HINT


	)

1029 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

1032 
	#NL80211_CMD_GET_MESH_PARAMS
 
NL80211_CMD_GET_MESH_CONFIG


	)

1033 
	#NL80211_CMD_SET_MESH_PARAMS
 
NL80211_CMD_SET_MESH_CONFIG


	)

1034 
	#NL80211_MESH_SETUP_VENDOR_PATH_SEL_IE
 
NL80211_MESH_SETUP_IE


	)

1790 
	eÆ80211_©Œs
 {

1792 
	mNL80211_ATTR_UNSPEC
,

1794 
	mNL80211_ATTR_WIPHY
,

1795 
	mNL80211_ATTR_WIPHY_NAME
,

1797 
	mNL80211_ATTR_IFINDEX
,

1798 
	mNL80211_ATTR_IFNAME
,

1799 
	mNL80211_ATTR_IFTYPE
,

1801 
	mNL80211_ATTR_MAC
,

1803 
	mNL80211_ATTR_KEY_DATA
,

1804 
	mNL80211_ATTR_KEY_IDX
,

1805 
	mNL80211_ATTR_KEY_CIPHER
,

1806 
	mNL80211_ATTR_KEY_SEQ
,

1807 
	mNL80211_ATTR_KEY_DEFAULT
,

1809 
	mNL80211_ATTR_BEACON_INTERVAL
,

1810 
	mNL80211_ATTR_DTIM_PERIOD
,

1811 
	mNL80211_ATTR_BEACON_HEAD
,

1812 
	mNL80211_ATTR_BEACON_TAIL
,

1814 
	mNL80211_ATTR_STA_AID
,

1815 
	mNL80211_ATTR_STA_FLAGS
,

1816 
	mNL80211_ATTR_STA_LISTEN_INTERVAL
,

1817 
	mNL80211_ATTR_STA_SUPPORTED_RATES
,

1818 
	mNL80211_ATTR_STA_VLAN
,

1819 
	mNL80211_ATTR_STA_INFO
,

1821 
	mNL80211_ATTR_WIPHY_BANDS
,

1823 
	mNL80211_ATTR_MNTR_FLAGS
,

1825 
	mNL80211_ATTR_MESH_ID
,

1826 
	mNL80211_ATTR_STA_PLINK_ACTION
,

1827 
	mNL80211_ATTR_MPATH_NEXT_HOP
,

1828 
	mNL80211_ATTR_MPATH_INFO
,

1830 
	mNL80211_ATTR_BSS_CTS_PROT
,

1831 
	mNL80211_ATTR_BSS_SHORT_PREAMBLE
,

1832 
	mNL80211_ATTR_BSS_SHORT_SLOT_TIME
,

1834 
	mNL80211_ATTR_HT_CAPABILITY
,

1836 
	mNL80211_ATTR_SUPPORTED_IFTYPES
,

1838 
	mNL80211_ATTR_REG_ALPHA2
,

1839 
	mNL80211_ATTR_REG_RULES
,

1841 
	mNL80211_ATTR_MESH_CONFIG
,

1843 
	mNL80211_ATTR_BSS_BASIC_RATES
,

1845 
	mNL80211_ATTR_WIPHY_TXQ_PARAMS
,

1846 
	mNL80211_ATTR_WIPHY_FREQ
,

1847 
	mNL80211_ATTR_WIPHY_CHANNEL_TYPE
,

1849 
	mNL80211_ATTR_KEY_DEFAULT_MGMT
,

1851 
	mNL80211_ATTR_MGMT_SUBTYPE
,

1852 
	mNL80211_ATTR_IE
,

1854 
	mNL80211_ATTR_MAX_NUM_SCAN_SSIDS
,

1856 
	mNL80211_ATTR_SCAN_FREQUENCIES
,

1857 
	mNL80211_ATTR_SCAN_SSIDS
,

1858 
	mNL80211_ATTR_GENERATION
,

1859 
	mNL80211_ATTR_BSS
,

1861 
	mNL80211_ATTR_REG_INITIATOR
,

1862 
	mNL80211_ATTR_REG_TYPE
,

1864 
	mNL80211_ATTR_SUPPORTED_COMMANDS
,

1866 
	mNL80211_ATTR_FRAME
,

1867 
	mNL80211_ATTR_SSID
,

1868 
	mNL80211_ATTR_AUTH_TYPE
,

1869 
	mNL80211_ATTR_REASON_CODE
,

1871 
	mNL80211_ATTR_KEY_TYPE
,

1873 
	mNL80211_ATTR_MAX_SCAN_IE_LEN
,

1874 
	mNL80211_ATTR_CIPHER_SUITES
,

1876 
	mNL80211_ATTR_FREQ_BEFORE
,

1877 
	mNL80211_ATTR_FREQ_AFTER
,

1879 
	mNL80211_ATTR_FREQ_FIXED
,

1882 
	mNL80211_ATTR_WIPHY_RETRY_SHORT
,

1883 
	mNL80211_ATTR_WIPHY_RETRY_LONG
,

1884 
	mNL80211_ATTR_WIPHY_FRAG_THRESHOLD
,

1885 
	mNL80211_ATTR_WIPHY_RTS_THRESHOLD
,

1887 
	mNL80211_ATTR_TIMED_OUT
,

1889 
	mNL80211_ATTR_USE_MFP
,

1891 
	mNL80211_ATTR_STA_FLAGS2
,

1893 
	mNL80211_ATTR_CONTROL_PORT
,

1895 
	mNL80211_ATTR_TESTDATA
,

1897 
	mNL80211_ATTR_PRIVACY
,

1899 
	mNL80211_ATTR_DISCONNECTED_BY_AP
,

1900 
	mNL80211_ATTR_STATUS_CODE
,

1902 
	mNL80211_ATTR_CIPHER_SUITES_PAIRWISE
,

1903 
	mNL80211_ATTR_CIPHER_SUITE_GROUP
,

1904 
	mNL80211_ATTR_WPA_VERSIONS
,

1905 
	mNL80211_ATTR_AKM_SUITES
,

1907 
	mNL80211_ATTR_REQ_IE
,

1908 
	mNL80211_ATTR_RESP_IE
,

1910 
	mNL80211_ATTR_PREV_BSSID
,

1912 
	mNL80211_ATTR_KEY
,

1913 
	mNL80211_ATTR_KEYS
,

1915 
	mNL80211_ATTR_PID
,

1917 
	mNL80211_ATTR_4ADDR
,

1919 
	mNL80211_ATTR_SURVEY_INFO
,

1921 
	mNL80211_ATTR_PMKID
,

1922 
	mNL80211_ATTR_MAX_NUM_PMKIDS
,

1924 
	mNL80211_ATTR_DURATION
,

1926 
	mNL80211_ATTR_COOKIE
,

1928 
	mNL80211_ATTR_WIPHY_COVERAGE_CLASS
,

1930 
	mNL80211_ATTR_TX_RATES
,

1932 
	mNL80211_ATTR_FRAME_MATCH
,

1934 
	mNL80211_ATTR_ACK
,

1936 
	mNL80211_ATTR_PS_STATE
,

1938 
	mNL80211_ATTR_CQM
,

1940 
	mNL80211_ATTR_LOCAL_STATE_CHANGE
,

1942 
	mNL80211_ATTR_AP_ISOLATE
,

1944 
	mNL80211_ATTR_WIPHY_TX_POWER_SETTING
,

1945 
	mNL80211_ATTR_WIPHY_TX_POWER_LEVEL
,

1947 
	mNL80211_ATTR_TX_FRAME_TYPES
,

1948 
	mNL80211_ATTR_RX_FRAME_TYPES
,

1949 
	mNL80211_ATTR_FRAME_TYPE
,

1951 
	mNL80211_ATTR_CONTROL_PORT_ETHERTYPE
,

1952 
	mNL80211_ATTR_CONTROL_PORT_NO_ENCRYPT
,

1954 
	mNL80211_ATTR_SUPPORT_IBSS_RSN
,

1956 
	mNL80211_ATTR_WIPHY_ANTENNA_TX
,

1957 
	mNL80211_ATTR_WIPHY_ANTENNA_RX
,

1959 
	mNL80211_ATTR_MCAST_RATE
,

1961 
	mNL80211_ATTR_OFFCHANNEL_TX_OK
,

1963 
	mNL80211_ATTR_BSS_HT_OPMODE
,

1965 
	mNL80211_ATTR_KEY_DEFAULT_TYPES
,

1967 
	mNL80211_ATTR_MAX_REMAIN_ON_CHANNEL_DURATION
,

1969 
	mNL80211_ATTR_MESH_SETUP
,

1971 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_TX
,

1972 
	mNL80211_ATTR_WIPHY_ANTENNA_AVAIL_RX
,

1974 
	mNL80211_ATTR_SUPPORT_MESH_AUTH
,

1975 
	mNL80211_ATTR_STA_PLINK_STATE
,

1977 
	mNL80211_ATTR_WOWLAN_TRIGGERS
,

1978 
	mNL80211_ATTR_WOWLAN_TRIGGERS_SUPPORTED
,

1980 
	mNL80211_ATTR_SCHED_SCAN_INTERVAL
,

1982 
	mNL80211_ATTR_INTERFACE_COMBINATIONS
,

1983 
	mNL80211_ATTR_SOFTWARE_IFTYPES
,

1985 
	mNL80211_ATTR_REKEY_DATA
,

1987 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_SSIDS
,

1988 
	mNL80211_ATTR_MAX_SCHED_SCAN_IE_LEN
,

1990 
	mNL80211_ATTR_SCAN_SUPP_RATES
,

1992 
	mNL80211_ATTR_HIDDEN_SSID
,

1994 
	mNL80211_ATTR_IE_PROBE_RESP
,

1995 
	mNL80211_ATTR_IE_ASSOC_RESP
,

1997 
	mNL80211_ATTR_STA_WME
,

1998 
	mNL80211_ATTR_SUPPORT_AP_UAPSD
,

2000 
	mNL80211_ATTR_ROAM_SUPPORT
,

2002 
	mNL80211_ATTR_SCHED_SCAN_MATCH
,

2003 
	mNL80211_ATTR_MAX_MATCH_SETS
,

2005 
	mNL80211_ATTR_PMKSA_CANDIDATE
,

2007 
	mNL80211_ATTR_TX_NO_CCK_RATE
,

2009 
	mNL80211_ATTR_TDLS_ACTION
,

2010 
	mNL80211_ATTR_TDLS_DIALOG_TOKEN
,

2011 
	mNL80211_ATTR_TDLS_OPERATION
,

2012 
	mNL80211_ATTR_TDLS_SUPPORT
,

2013 
	mNL80211_ATTR_TDLS_EXTERNAL_SETUP
,

2015 
	mNL80211_ATTR_DEVICE_AP_SME
,

2017 
	mNL80211_ATTR_DONT_WAIT_FOR_ACK
,

2019 
	mNL80211_ATTR_FEATURE_FLAGS
,

2021 
	mNL80211_ATTR_PROBE_RESP_OFFLOAD
,

2023 
	mNL80211_ATTR_PROBE_RESP
,

2025 
	mNL80211_ATTR_DFS_REGION
,

2027 
	mNL80211_ATTR_DISABLE_HT
,

2028 
	mNL80211_ATTR_HT_CAPABILITY_MASK
,

2030 
	mNL80211_ATTR_NOACK_MAP
,

2032 
	mNL80211_ATTR_INACTIVITY_TIMEOUT
,

2034 
	mNL80211_ATTR_RX_SIGNAL_DBM
,

2036 
	mNL80211_ATTR_BG_SCAN_PERIOD
,

2038 
	mNL80211_ATTR_WDEV
,

2040 
	mNL80211_ATTR_USER_REG_HINT_TYPE
,

2042 
	mNL80211_ATTR_CONN_FAILED_REASON
,

2044 
	mNL80211_ATTR_SAE_DATA
,

2046 
	mNL80211_ATTR_VHT_CAPABILITY
,

2048 
	mNL80211_ATTR_SCAN_FLAGS
,

2050 
	mNL80211_ATTR_CHANNEL_WIDTH
,

2051 
	mNL80211_ATTR_CENTER_FREQ1
,

2052 
	mNL80211_ATTR_CENTER_FREQ2
,

2054 
	mNL80211_ATTR_P2P_CTWINDOW
,

2055 
	mNL80211_ATTR_P2P_OPPPS
,

2057 
	mNL80211_ATTR_LOCAL_MESH_POWER_MODE
,

2059 
	mNL80211_ATTR_ACL_POLICY
,

2061 
	mNL80211_ATTR_MAC_ADDRS
,

2063 
	mNL80211_ATTR_MAC_ACL_MAX
,

2065 
	mNL80211_ATTR_RADAR_EVENT
,

2067 
	mNL80211_ATTR_EXT_CAPA
,

2068 
	mNL80211_ATTR_EXT_CAPA_MASK
,

2070 
	mNL80211_ATTR_STA_CAPABILITY
,

2071 
	mNL80211_ATTR_STA_EXT_CAPABILITY
,

2073 
	mNL80211_ATTR_PROTOCOL_FEATURES
,

2074 
	mNL80211_ATTR_SPLIT_WIPHY_DUMP
,

2076 
	mNL80211_ATTR_DISABLE_VHT
,

2077 
	mNL80211_ATTR_VHT_CAPABILITY_MASK
,

2079 
	mNL80211_ATTR_MDID
,

2080 
	mNL80211_ATTR_IE_RIC
,

2082 
	mNL80211_ATTR_CRIT_PROT_ID
,

2083 
	mNL80211_ATTR_MAX_CRIT_PROT_DURATION
,

2085 
	mNL80211_ATTR_PEER_AID
,

2087 
	mNL80211_ATTR_COALESCE_RULE
,

2089 
	mNL80211_ATTR_CH_SWITCH_COUNT
,

2090 
	mNL80211_ATTR_CH_SWITCH_BLOCK_TX
,

2091 
	mNL80211_ATTR_CSA_IES
,

2092 
	mNL80211_ATTR_CSA_C_OFF_BEACON
,

2093 
	mNL80211_ATTR_CSA_C_OFF_PRESP
,

2095 
	mNL80211_ATTR_RXMGMT_FLAGS
,

2097 
	mNL80211_ATTR_STA_SUPPORTED_CHANNELS
,

2099 
	mNL80211_ATTR_STA_SUPPORTED_OPER_CLASSES
,

2101 
	mNL80211_ATTR_HANDLE_DFS
,

2103 
	mNL80211_ATTR_SUPPORT_5_MHZ
,

2104 
	mNL80211_ATTR_SUPPORT_10_MHZ
,

2106 
	mNL80211_ATTR_OPMODE_NOTIF
,

2108 
	mNL80211_ATTR_VENDOR_ID
,

2109 
	mNL80211_ATTR_VENDOR_SUBCMD
,

2110 
	mNL80211_ATTR_VENDOR_DATA
,

2111 
	mNL80211_ATTR_VENDOR_EVENTS
,

2113 
	mNL80211_ATTR_QOS_MAP
,

2115 
	mNL80211_ATTR_MAC_HINT
,

2116 
	mNL80211_ATTR_WIPHY_FREQ_HINT
,

2118 
	mNL80211_ATTR_MAX_AP_ASSOC_STA
,

2120 
	mNL80211_ATTR_TDLS_PEER_CAPABILITY
,

2122 
	mNL80211_ATTR_SOCKET_OWNER
,

2124 
	mNL80211_ATTR_CSA_C_OFFSETS_TX
,

2125 
	mNL80211_ATTR_MAX_CSA_COUNTERS
,

2127 
	mNL80211_ATTR_TDLS_INITIATOR
,

2129 
	mNL80211_ATTR_USE_RRM
,

2131 
	mNL80211_ATTR_WIPHY_DYN_ACK
,

2133 
	mNL80211_ATTR_TSID
,

2134 
	mNL80211_ATTR_USER_PRIO
,

2135 
	mNL80211_ATTR_ADMITTED_TIME
,

2137 
	mNL80211_ATTR_SMPS_MODE
,

2139 
	mNL80211_ATTR_OPER_CLASS
,

2141 
	mNL80211_ATTR_MAC_MASK
,

2143 
	mNL80211_ATTR_WIPHY_SELF_MANAGED_REG
,

2145 
	mNL80211_ATTR_EXT_FEATURES
,

2147 
	mNL80211_ATTR_SURVEY_RADIO_STATS
,

2149 
	mNL80211_ATTR_NETNS_FD
,

2151 
	mNL80211_ATTR_SCHED_SCAN_DELAY
,

2153 
	mNL80211_ATTR_REG_INDOOR
,

2155 
	mNL80211_ATTR_MAX_NUM_SCHED_SCAN_PLANS
,

2156 
	mNL80211_ATTR_MAX_SCAN_PLAN_INTERVAL
,

2157 
	mNL80211_ATTR_MAX_SCAN_PLAN_ITERATIONS
,

2158 
	mNL80211_ATTR_SCHED_SCAN_PLANS
,

2162 
	m__NL80211_ATTR_AFTER_LAST
,

2163 
	mNUM_NL80211_ATTR
 = 
__NL80211_ATTR_AFTER_LAST
,

2164 
	mNL80211_ATTR_MAX
 = 
__NL80211_ATTR_AFTER_LAST
 - 1

2168 
	#NL80211_ATTR_SCAN_GENERATION
 
NL80211_ATTR_GENERATION


	)

2169 
	#NL80211_ATTR_MESH_PARAMS
 
NL80211_ATTR_MESH_CONFIG


	)

2170 
	#NL80211_ATTR_IFACE_SOCKET_OWNER
 
NL80211_ATTR_SOCKET_OWNER


	)

2176 
	#NL80211_CMD_CONNECT
 
NL80211_CMD_CONNECT


	)

2177 
	#NL80211_ATTR_HT_CAPABILITY
 
NL80211_ATTR_HT_CAPABILITY


	)

2178 
	#NL80211_ATTR_BSS_BASIC_RATES
 
NL80211_ATTR_BSS_BASIC_RATES


	)

2179 
	#NL80211_ATTR_WIPHY_TXQ_PARAMS
 
NL80211_ATTR_WIPHY_TXQ_PARAMS


	)

2180 
	#NL80211_ATTR_WIPHY_FREQ
 
NL80211_ATTR_WIPHY_FREQ


	)

2181 
	#NL80211_ATTR_WIPHY_CHANNEL_TYPE
 
NL80211_ATTR_WIPHY_CHANNEL_TYPE


	)

2182 
	#NL80211_ATTR_MGMT_SUBTYPE
 
NL80211_ATTR_MGMT_SUBTYPE


	)

2183 
	#NL80211_ATTR_IE
 
NL80211_ATTR_IE


	)

2184 
	#NL80211_ATTR_REG_INITIATOR
 
NL80211_ATTR_REG_INITIATOR


	)

2185 
	#NL80211_ATTR_REG_TYPE
 
NL80211_ATTR_REG_TYPE


	)

2186 
	#NL80211_ATTR_FRAME
 
NL80211_ATTR_FRAME


	)

2187 
	#NL80211_ATTR_SSID
 
NL80211_ATTR_SSID


	)

2188 
	#NL80211_ATTR_AUTH_TYPE
 
NL80211_ATTR_AUTH_TYPE


	)

2189 
	#NL80211_ATTR_REASON_CODE
 
NL80211_ATTR_REASON_CODE


	)

2190 
	#NL80211_ATTR_CIPHER_SUITES_PAIRWISE
 
NL80211_ATTR_CIPHER_SUITES_PAIRWISE


	)

2191 
	#NL80211_ATTR_CIPHER_SUITE_GROUP
 
NL80211_ATTR_CIPHER_SUITE_GROUP


	)

2192 
	#NL80211_ATTR_WPA_VERSIONS
 
NL80211_ATTR_WPA_VERSIONS


	)

2193 
	#NL80211_ATTR_AKM_SUITES
 
NL80211_ATTR_AKM_SUITES


	)

2194 
	#NL80211_ATTR_KEY
 
NL80211_ATTR_KEY


	)

2195 
	#NL80211_ATTR_KEYS
 
NL80211_ATTR_KEYS


	)

2196 
	#NL80211_ATTR_FEATURE_FLAGS
 
NL80211_ATTR_FEATURE_FLAGS


	)

2198 
	#NL80211_MAX_SUPP_RATES
 32

	)

2199 
	#NL80211_MAX_SUPP_HT_RATES
 77

	)

2200 
	#NL80211_MAX_SUPP_REG_RULES
 64

	)

2201 
	#NL80211_TKIP_DATA_OFFSET_ENCR_KEY
 0

	)

2202 
	#NL80211_TKIP_DATA_OFFSET_TX_MIC_KEY
 16

	)

2203 
	#NL80211_TKIP_DATA_OFFSET_RX_MIC_KEY
 24

	)

2204 
	#NL80211_HT_CAPABILITY_LEN
 26

	)

2205 
	#NL80211_VHT_CAPABILITY_LEN
 12

	)

2207 
	#NL80211_MAX_NR_CIPHER_SUITES
 5

	)

2208 
	#NL80211_MAX_NR_AKM_SUITES
 2

	)

2210 
	#NL80211_MIN_REMAIN_ON_CHANNEL_TIME
 10

	)

2213 
	#NL80211_SCAN_RSSI_THOLD_OFF
 -300

	)

2215 
	#NL80211_CQM_TXE_MAX_INTVL
 1800

	)

2245 
	eÆ80211_iáy³
 {

2246 
	mNL80211_IFTYPE_UNSPECIFIED
,

2247 
	mNL80211_IFTYPE_ADHOC
,

2248 
	mNL80211_IFTYPE_STATION
,

2249 
	mNL80211_IFTYPE_AP
,

2250 
	mNL80211_IFTYPE_AP_VLAN
,

2251 
	mNL80211_IFTYPE_WDS
,

2252 
	mNL80211_IFTYPE_MONITOR
,

2253 
	mNL80211_IFTYPE_MESH_POINT
,

2254 
	mNL80211_IFTYPE_P2P_CLIENT
,

2255 
	mNL80211_IFTYPE_P2P_GO
,

2256 
	mNL80211_IFTYPE_P2P_DEVICE
,

2257 
	mNL80211_IFTYPE_OCB
,

2260 
	mNUM_NL80211_IFTYPES
,

2261 
	mNL80211_IFTYPE_MAX
 = 
NUM_NL80211_IFTYPES
 - 1

2288 
	eÆ80211_¡a_æags
 {

2289 
	m__NL80211_STA_FLAG_INVALID
,

2290 
	mNL80211_STA_FLAG_AUTHORIZED
,

2291 
	mNL80211_STA_FLAG_SHORT_PREAMBLE
,

2292 
	mNL80211_STA_FLAG_WME
,

2293 
	mNL80211_STA_FLAG_MFP
,

2294 
	mNL80211_STA_FLAG_AUTHENTICATED
,

2295 
	mNL80211_STA_FLAG_TDLS_PEER
,

2296 
	mNL80211_STA_FLAG_ASSOCIATED
,

2299 
	m__NL80211_STA_FLAG_AFTER_LAST
,

2300 
	mNL80211_STA_FLAG_MAX
 = 
__NL80211_STA_FLAG_AFTER_LAST
 - 1

2303 
	#NL80211_STA_FLAG_MAX_OLD_API
 
NL80211_STA_FLAG_TDLS_PEER


	)

2312 
	sÆ80211_¡a_æag_upd©e
 {

2313 
__u32
 
	mmask
;

2314 
__u32
 
	m£t
;

2315 } 
__©Œibu‹__
((
·cked
));

2351 
	eÆ80211_¿‹_šfo
 {

2352 
	m__NL80211_RATE_INFO_INVALID
,

2353 
	mNL80211_RATE_INFO_BITRATE
,

2354 
	mNL80211_RATE_INFO_MCS
,

2355 
	mNL80211_RATE_INFO_40_MHZ_WIDTH
,

2356 
	mNL80211_RATE_INFO_SHORT_GI
,

2357 
	mNL80211_RATE_INFO_BITRATE32
,

2358 
	mNL80211_RATE_INFO_VHT_MCS
,

2359 
	mNL80211_RATE_INFO_VHT_NSS
,

2360 
	mNL80211_RATE_INFO_80_MHZ_WIDTH
,

2361 
	mNL80211_RATE_INFO_80P80_MHZ_WIDTH
,

2362 
	mNL80211_RATE_INFO_160_MHZ_WIDTH
,

2363 
	mNL80211_RATE_INFO_10_MHZ_WIDTH
,

2364 
	mNL80211_RATE_INFO_5_MHZ_WIDTH
,

2367 
	m__NL80211_RATE_INFO_AFTER_LAST
,

2368 
	mNL80211_RATE_INFO_MAX
 = 
__NL80211_RATE_INFO_AFTER_LAST
 - 1

2388 
	eÆ80211_¡a_bss_·¿m
 {

2389 
	m__NL80211_STA_BSS_PARAM_INVALID
,

2390 
	mNL80211_STA_BSS_PARAM_CTS_PROT
,

2391 
	mNL80211_STA_BSS_PARAM_SHORT_PREAMBLE
,

2392 
	mNL80211_STA_BSS_PARAM_SHORT_SLOT_TIME
,

2393 
	mNL80211_STA_BSS_PARAM_DTIM_PERIOD
,

2394 
	mNL80211_STA_BSS_PARAM_BEACON_INTERVAL
,

2397 
	m__NL80211_STA_BSS_PARAM_AFTER_LAST
,

2398 
	mNL80211_STA_BSS_PARAM_MAX
 = 
__NL80211_STA_BSS_PARAM_AFTER_LAST
 - 1

2463 
	eÆ80211_¡a_šfo
 {

2464 
	m__NL80211_STA_INFO_INVALID
,

2465 
	mNL80211_STA_INFO_INACTIVE_TIME
,

2466 
	mNL80211_STA_INFO_RX_BYTES
,

2467 
	mNL80211_STA_INFO_TX_BYTES
,

2468 
	mNL80211_STA_INFO_LLID
,

2469 
	mNL80211_STA_INFO_PLID
,

2470 
	mNL80211_STA_INFO_PLINK_STATE
,

2471 
	mNL80211_STA_INFO_SIGNAL
,

2472 
	mNL80211_STA_INFO_TX_BITRATE
,

2473 
	mNL80211_STA_INFO_RX_PACKETS
,

2474 
	mNL80211_STA_INFO_TX_PACKETS
,

2475 
	mNL80211_STA_INFO_TX_RETRIES
,

2476 
	mNL80211_STA_INFO_TX_FAILED
,

2477 
	mNL80211_STA_INFO_SIGNAL_AVG
,

2478 
	mNL80211_STA_INFO_RX_BITRATE
,

2479 
	mNL80211_STA_INFO_BSS_PARAM
,

2480 
	mNL80211_STA_INFO_CONNECTED_TIME
,

2481 
	mNL80211_STA_INFO_STA_FLAGS
,

2482 
	mNL80211_STA_INFO_BEACON_LOSS
,

2483 
	mNL80211_STA_INFO_T_OFFSET
,

2484 
	mNL80211_STA_INFO_LOCAL_PM
,

2485 
	mNL80211_STA_INFO_PEER_PM
,

2486 
	mNL80211_STA_INFO_NONPEER_PM
,

2487 
	mNL80211_STA_INFO_RX_BYTES64
,

2488 
	mNL80211_STA_INFO_TX_BYTES64
,

2489 
	mNL80211_STA_INFO_CHAIN_SIGNAL
,

2490 
	mNL80211_STA_INFO_CHAIN_SIGNAL_AVG
,

2491 
	mNL80211_STA_INFO_EXPECTED_THROUGHPUT
,

2492 
	mNL80211_STA_INFO_RX_DROP_MISC
,

2493 
	mNL80211_STA_INFO_BEACON_RX
,

2494 
	mNL80211_STA_INFO_BEACON_SIGNAL_AVG
,

2495 
	mNL80211_STA_INFO_TID_STATS
,

2498 
	m__NL80211_STA_INFO_AFTER_LAST
,

2499 
	mNL80211_STA_INFO_MAX
 = 
__NL80211_STA_INFO_AFTER_LAST
 - 1

2515 
	eÆ80211_tid_¡©s
 {

2516 
	m__NL80211_TID_STATS_INVALID
,

2517 
	mNL80211_TID_STATS_RX_MSDU
,

2518 
	mNL80211_TID_STATS_TX_MSDU
,

2519 
	mNL80211_TID_STATS_TX_MSDU_RETRIES
,

2520 
	mNL80211_TID_STATS_TX_MSDU_FAILED
,

2523 
	mNUM_NL80211_TID_STATS
,

2524 
	mNL80211_TID_STATS_MAX
 = 
NUM_NL80211_TID_STATS
 - 1

2536 
	eÆ80211_m·th_æags
 {

2537 
	mNL80211_MPATH_FLAG_ACTIVE
 = 1<<0,

2538 
	mNL80211_MPATH_FLAG_RESOLVING
 = 1<<1,

2539 
	mNL80211_MPATH_FLAG_SN_VALID
 = 1<<2,

2540 
	mNL80211_MPATH_FLAG_FIXED
 = 1<<3,

2541 
	mNL80211_MPATH_FLAG_RESOLVED
 = 1<<4,

2563 
	eÆ80211_m·th_šfo
 {

2564 
	m__NL80211_MPATH_INFO_INVALID
,

2565 
	mNL80211_MPATH_INFO_FRAME_QLEN
,

2566 
	mNL80211_MPATH_INFO_SN
,

2567 
	mNL80211_MPATH_INFO_METRIC
,

2568 
	mNL80211_MPATH_INFO_EXPTIME
,

2569 
	mNL80211_MPATH_INFO_FLAGS
,

2570 
	mNL80211_MPATH_INFO_DISCOVERY_TIMEOUT
,

2571 
	mNL80211_MPATH_INFO_DISCOVERY_RETRIES
,

2574 
	m__NL80211_MPATH_INFO_AFTER_LAST
,

2575 
	mNL80211_MPATH_INFO_MAX
 = 
__NL80211_MPATH_INFO_AFTER_LAST
 - 1

2596 
	eÆ80211_bªd_©Œ
 {

2597 
	m__NL80211_BAND_ATTR_INVALID
,

2598 
	mNL80211_BAND_ATTR_FREQS
,

2599 
	mNL80211_BAND_ATTR_RATES
,

2601 
	mNL80211_BAND_ATTR_HT_MCS_SET
,

2602 
	mNL80211_BAND_ATTR_HT_CAPA
,

2603 
	mNL80211_BAND_ATTR_HT_AMPDU_FACTOR
,

2604 
	mNL80211_BAND_ATTR_HT_AMPDU_DENSITY
,

2606 
	mNL80211_BAND_ATTR_VHT_MCS_SET
,

2607 
	mNL80211_BAND_ATTR_VHT_CAPA
,

2610 
	m__NL80211_BAND_ATTR_AFTER_LAST
,

2611 
	mNL80211_BAND_ATTR_MAX
 = 
__NL80211_BAND_ATTR_AFTER_LAST
 - 1

2614 
	#NL80211_BAND_ATTR_HT_CAPA
 
NL80211_BAND_ATTR_HT_CAPA


	)

2674 
	eÆ80211_äequ’cy_©Œ
 {

2675 
	m__NL80211_FREQUENCY_ATTR_INVALID
,

2676 
	mNL80211_FREQUENCY_ATTR_FREQ
,

2677 
	mNL80211_FREQUENCY_ATTR_DISABLED
,

2678 
	mNL80211_FREQUENCY_ATTR_NO_IR
,

2679 
	m__NL80211_FREQUENCY_ATTR_NO_IBSS
,

2680 
	mNL80211_FREQUENCY_ATTR_RADAR
,

2681 
	mNL80211_FREQUENCY_ATTR_MAX_TX_POWER
,

2682 
	mNL80211_FREQUENCY_ATTR_DFS_STATE
,

2683 
	mNL80211_FREQUENCY_ATTR_DFS_TIME
,

2684 
	mNL80211_FREQUENCY_ATTR_NO_HT40_MINUS
,

2685 
	mNL80211_FREQUENCY_ATTR_NO_HT40_PLUS
,

2686 
	mNL80211_FREQUENCY_ATTR_NO_80MHZ
,

2687 
	mNL80211_FREQUENCY_ATTR_NO_160MHZ
,

2688 
	mNL80211_FREQUENCY_ATTR_DFS_CAC_TIME
,

2689 
	mNL80211_FREQUENCY_ATTR_INDOOR_ONLY
,

2690 
	mNL80211_FREQUENCY_ATTR_IR_CONCURRENT
,

2691 
	mNL80211_FREQUENCY_ATTR_NO_20MHZ
,

2692 
	mNL80211_FREQUENCY_ATTR_NO_10MHZ
,

2695 
	m__NL80211_FREQUENCY_ATTR_AFTER_LAST
,

2696 
	mNL80211_FREQUENCY_ATTR_MAX
 = 
__NL80211_FREQUENCY_ATTR_AFTER_LAST
 - 1

2699 
	#NL80211_FREQUENCY_ATTR_MAX_TX_POWER
 
NL80211_FREQUENCY_ATTR_MAX_TX_POWER


	)

2700 
	#NL80211_FREQUENCY_ATTR_PASSIVE_SCAN
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2701 
	#NL80211_FREQUENCY_ATTR_NO_IBSS
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2702 
	#NL80211_FREQUENCY_ATTR_NO_IR
 
NL80211_FREQUENCY_ATTR_NO_IR


	)

2703 
	#NL80211_FREQUENCY_ATTR_GO_CONCURRENT
 \

2704 
NL80211_FREQUENCY_ATTR_IR_CONCURRENT


	)

2716 
	eÆ80211_b™¿‹_©Œ
 {

2717 
	m__NL80211_BITRATE_ATTR_INVALID
,

2718 
	mNL80211_BITRATE_ATTR_RATE
,

2719 
	mNL80211_BITRATE_ATTR_2GHZ_SHORTPREAMBLE
,

2722 
	m__NL80211_BITRATE_ATTR_AFTER_LAST
,

2723 
	mNL80211_BITRATE_ATTR_MAX
 = 
__NL80211_BITRATE_ATTR_AFTER_LAST
 - 1

2742 
	eÆ80211_»g_š™ŸtÜ
 {

2743 
	mNL80211_REGDOM_SET_BY_CORE
,

2744 
	mNL80211_REGDOM_SET_BY_USER
,

2745 
	mNL80211_REGDOM_SET_BY_DRIVER
,

2746 
	mNL80211_REGDOM_SET_BY_COUNTRY_IE
,

2765 
	eÆ80211_»g_ty³
 {

2766 
	mNL80211_REGDOM_TYPE_COUNTRY
,

2767 
	mNL80211_REGDOM_TYPE_WORLD
,

2768 
	mNL80211_REGDOM_TYPE_CUSTOM_WORLD
,

2769 
	mNL80211_REGDOM_TYPE_INTERSECTION
,

2797 
	eÆ80211_»g_ruË_©Œ
 {

2798 
	m__NL80211_REG_RULE_ATTR_INVALID
,

2799 
	mNL80211_ATTR_REG_RULE_FLAGS
,

2801 
	mNL80211_ATTR_FREQ_RANGE_START
,

2802 
	mNL80211_ATTR_FREQ_RANGE_END
,

2803 
	mNL80211_ATTR_FREQ_RANGE_MAX_BW
,

2805 
	mNL80211_ATTR_POWER_RULE_MAX_ANT_GAIN
,

2806 
	mNL80211_ATTR_POWER_RULE_MAX_EIRP
,

2808 
	mNL80211_ATTR_DFS_CAC_TIME
,

2811 
	m__NL80211_REG_RULE_ATTR_AFTER_LAST
,

2812 
	mNL80211_REG_RULE_ATTR_MAX
 = 
__NL80211_REG_RULE_ATTR_AFTER_LAST
 - 1

2832 
	eÆ80211_sched_sÿn_m©ch_©Œ
 {

2833 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_INVALID
,

2835 
	mNL80211_SCHED_SCAN_MATCH_ATTR_SSID
,

2836 
	mNL80211_SCHED_SCAN_MATCH_ATTR_RSSI
,

2839 
	m__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
,

2840 
	mNL80211_SCHED_SCAN_MATCH_ATTR_MAX
 =

2841 
__NL80211_SCHED_SCAN_MATCH_ATTR_AFTER_LAST
 - 1

2845 
	#NL80211_ATTR_SCHED_SCAN_MATCH_SSID
 
NL80211_SCHED_SCAN_MATCH_ATTR_SSID


	)

2869 
	eÆ80211_»g_ruË_æags
 {

2870 
	mNL80211_RRF_NO_OFDM
 = 1<<0,

2871 
	mNL80211_RRF_NO_CCK
 = 1<<1,

2872 
	mNL80211_RRF_NO_INDOOR
 = 1<<2,

2873 
	mNL80211_RRF_NO_OUTDOOR
 = 1<<3,

2874 
	mNL80211_RRF_DFS
 = 1<<4,

2875 
	mNL80211_RRF_PTP_ONLY
 = 1<<5,

2876 
	mNL80211_RRF_PTMP_ONLY
 = 1<<6,

2877 
	mNL80211_RRF_NO_IR
 = 1<<7,

2878 
	m__NL80211_RRF_NO_IBSS
 = 1<<8,

2879 
	mNL80211_RRF_AUTO_BW
 = 1<<11,

2880 
	mNL80211_RRF_IR_CONCURRENT
 = 1<<12,

2881 
	mNL80211_RRF_NO_HT40MINUS
 = 1<<13,

2882 
	mNL80211_RRF_NO_HT40PLUS
 = 1<<14,

2883 
	mNL80211_RRF_NO_80MHZ
 = 1<<15,

2884 
	mNL80211_RRF_NO_160MHZ
 = 1<<16,

2887 
	#NL80211_RRF_PASSIVE_SCAN
 
NL80211_RRF_NO_IR


	)

2888 
	#NL80211_RRF_NO_IBSS
 
NL80211_RRF_NO_IR


	)

2889 
	#NL80211_RRF_NO_IR
 
NL80211_RRF_NO_IR


	)

2890 
	#NL80211_RRF_NO_HT40
 (
NL80211_RRF_NO_HT40MINUS
 |\

2891 
NL80211_RRF_NO_HT40PLUS
)

	)

2892 
	#NL80211_RRF_GO_CONCURRENT
 
NL80211_RRF_IR_CONCURRENT


	)

2895 
	#NL80211_RRF_NO_IR_ALL
 (
NL80211_RRF_NO_IR
 | 
__NL80211_RRF_NO_IBSS
)

	)

2905 
	eÆ80211_dfs_»giÚs
 {

2906 
	mNL80211_DFS_UNSET
 = 0,

2907 
	mNL80211_DFS_FCC
 = 1,

2908 
	mNL80211_DFS_ETSI
 = 2,

2909 
	mNL80211_DFS_JP
 = 3,

2929 
	eÆ80211_u£r_»g_hšt_ty³
 {

2930 
	mNL80211_USER_REG_HINT_USER
 = 0,

2931 
	mNL80211_USER_REG_HINT_CELL_BASE
 = 1,

2932 
	mNL80211_USER_REG_HINT_INDOOR
 = 2,

2961 
	eÆ80211_survey_šfo
 {

2962 
	m__NL80211_SURVEY_INFO_INVALID
,

2963 
	mNL80211_SURVEY_INFO_FREQUENCY
,

2964 
	mNL80211_SURVEY_INFO_NOISE
,

2965 
	mNL80211_SURVEY_INFO_IN_USE
,

2966 
	mNL80211_SURVEY_INFO_TIME
,

2967 
	mNL80211_SURVEY_INFO_TIME_BUSY
,

2968 
	mNL80211_SURVEY_INFO_TIME_EXT_BUSY
,

2969 
	mNL80211_SURVEY_INFO_TIME_RX
,

2970 
	mNL80211_SURVEY_INFO_TIME_TX
,

2971 
	mNL80211_SURVEY_INFO_TIME_SCAN
,

2974 
	m__NL80211_SURVEY_INFO_AFTER_LAST
,

2975 
	mNL80211_SURVEY_INFO_MAX
 = 
__NL80211_SURVEY_INFO_AFTER_LAST
 - 1

2979 
	#NL80211_SURVEY_INFO_CHANNEL_TIME
 
NL80211_SURVEY_INFO_TIME


	)

2980 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_BUSY
 
NL80211_SURVEY_INFO_TIME_BUSY


	)

2981 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_EXT_BUSY
 
NL80211_SURVEY_INFO_TIME_EXT_BUSY


	)

2982 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_RX
 
NL80211_SURVEY_INFO_TIME_RX


	)

2983 
	#NL80211_SURVEY_INFO_CHANNEL_TIME_TX
 
NL80211_SURVEY_INFO_TIME_TX


	)

3004 
	eÆ80211_mÁr_æags
 {

3005 
	m__NL80211_MNTR_FLAG_INVALID
,

3006 
	mNL80211_MNTR_FLAG_FCSFAIL
,

3007 
	mNL80211_MNTR_FLAG_PLCPFAIL
,

3008 
	mNL80211_MNTR_FLAG_CONTROL
,

3009 
	mNL80211_MNTR_FLAG_OTHER_BSS
,

3010 
	mNL80211_MNTR_FLAG_COOK_FRAMES
,

3011 
	mNL80211_MNTR_FLAG_ACTIVE
,

3014 
	m__NL80211_MNTR_FLAG_AFTER_LAST
,

3015 
	mNL80211_MNTR_FLAG_MAX
 = 
__NL80211_MNTR_FLAG_AFTER_LAST
 - 1

3036 
	eÆ80211_mesh_pow”_mode
 {

3037 
	mNL80211_MESH_POWER_UNKNOWN
,

3038 
	mNL80211_MESH_POWER_ACTIVE
,

3039 
	mNL80211_MESH_POWER_LIGHT_SLEEP
,

3040 
	mNL80211_MESH_POWER_DEEP_SLEEP
,

3042 
	m__NL80211_MESH_POWER_AFTER_LAST
,

3043 
	mNL80211_MESH_POWER_MAX
 = 
__NL80211_MESH_POWER_AFTER_LAST
 - 1

3154 
	eÆ80211_meshcÚf_·¿ms
 {

3155 
	m__NL80211_MESHCONF_INVALID
,

3156 
	mNL80211_MESHCONF_RETRY_TIMEOUT
,

3157 
	mNL80211_MESHCONF_CONFIRM_TIMEOUT
,

3158 
	mNL80211_MESHCONF_HOLDING_TIMEOUT
,

3159 
	mNL80211_MESHCONF_MAX_PEER_LINKS
,

3160 
	mNL80211_MESHCONF_MAX_RETRIES
,

3161 
	mNL80211_MESHCONF_TTL
,

3162 
	mNL80211_MESHCONF_AUTO_OPEN_PLINKS
,

3163 
	mNL80211_MESHCONF_HWMP_MAX_PREQ_RETRIES
,

3164 
	mNL80211_MESHCONF_PATH_REFRESH_TIME
,

3165 
	mNL80211_MESHCONF_MIN_DISCOVERY_TIMEOUT
,

3166 
	mNL80211_MESHCONF_HWMP_ACTIVE_PATH_TIMEOUT
,

3167 
	mNL80211_MESHCONF_HWMP_PREQ_MIN_INTERVAL
,

3168 
	mNL80211_MESHCONF_HWMP_NET_DIAM_TRVS_TIME
,

3169 
	mNL80211_MESHCONF_HWMP_ROOTMODE
,

3170 
	mNL80211_MESHCONF_ELEMENT_TTL
,

3171 
	mNL80211_MESHCONF_HWMP_RANN_INTERVAL
,

3172 
	mNL80211_MESHCONF_GATE_ANNOUNCEMENTS
,

3173 
	mNL80211_MESHCONF_HWMP_PERR_MIN_INTERVAL
,

3174 
	mNL80211_MESHCONF_FORWARDING
,

3175 
	mNL80211_MESHCONF_RSSI_THRESHOLD
,

3176 
	mNL80211_MESHCONF_SYNC_OFFSET_MAX_NEIGHBOR
,

3177 
	mNL80211_MESHCONF_HT_OPMODE
,

3178 
	mNL80211_MESHCONF_HWMP_PATH_TO_ROOT_TIMEOUT
,

3179 
	mNL80211_MESHCONF_HWMP_ROOT_INTERVAL
,

3180 
	mNL80211_MESHCONF_HWMP_CONFIRMATION_INTERVAL
,

3181 
	mNL80211_MESHCONF_POWER_MODE
,

3182 
	mNL80211_MESHCONF_AWAKE_WINDOW
,

3183 
	mNL80211_MESHCONF_PLINK_TIMEOUT
,

3186 
	m__NL80211_MESHCONF_ATTR_AFTER_LAST
,

3187 
	mNL80211_MESHCONF_ATTR_MAX
 = 
__NL80211_MESHCONF_ATTR_AFTER_LAST
 - 1

3239 
	eÆ80211_mesh_£tup_·¿ms
 {

3240 
	m__NL80211_MESH_SETUP_INVALID
,

3241 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_PATH_SEL
,

3242 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_METRIC
,

3243 
	mNL80211_MESH_SETUP_IE
,

3244 
	mNL80211_MESH_SETUP_USERSPACE_AUTH
,

3245 
	mNL80211_MESH_SETUP_USERSPACE_AMPE
,

3246 
	mNL80211_MESH_SETUP_ENABLE_VENDOR_SYNC
,

3247 
	mNL80211_MESH_SETUP_USERSPACE_MPM
,

3248 
	mNL80211_MESH_SETUP_AUTH_PROTOCOL
,

3251 
	m__NL80211_MESH_SETUP_ATTR_AFTER_LAST
,

3252 
	mNL80211_MESH_SETUP_ATTR_MAX
 = 
__NL80211_MESH_SETUP_ATTR_AFTER_LAST
 - 1

3269 
	eÆ80211_txq_©Œ
 {

3270 
	m__NL80211_TXQ_ATTR_INVALID
,

3271 
	mNL80211_TXQ_ATTR_AC
,

3272 
	mNL80211_TXQ_ATTR_TXOP
,

3273 
	mNL80211_TXQ_ATTR_CWMIN
,

3274 
	mNL80211_TXQ_ATTR_CWMAX
,

3275 
	mNL80211_TXQ_ATTR_AIFS
,

3278 
	m__NL80211_TXQ_ATTR_AFTER_LAST
,

3279 
	mNL80211_TXQ_ATTR_MAX
 = 
__NL80211_TXQ_ATTR_AFTER_LAST
 - 1

3282 
	eÆ80211_ac
 {

3283 
	mNL80211_AC_VO
,

3284 
	mNL80211_AC_VI
,

3285 
	mNL80211_AC_BE
,

3286 
	mNL80211_AC_BK
,

3287 
	mNL80211_NUM_ACS


3291 
	#NL80211_TXQ_ATTR_QUEUE
 
NL80211_TXQ_ATTR_AC


	)

3292 
	#NL80211_TXQ_Q_VO
 
NL80211_AC_VO


	)

3293 
	#NL80211_TXQ_Q_VI
 
NL80211_AC_VI


	)

3294 
	#NL80211_TXQ_Q_BE
 
NL80211_AC_BE


	)

3295 
	#NL80211_TXQ_Q_BK
 
NL80211_AC_BK


	)

3306 
	eÆ80211_chªÃl_ty³
 {

3307 
	mNL80211_CHAN_NO_HT
,

3308 
	mNL80211_CHAN_HT20
,

3309 
	mNL80211_CHAN_HT40MINUS
,

3310 
	mNL80211_CHAN_HT40PLUS


3332 
	eÆ80211_chª_width
 {

3333 
	mNL80211_CHAN_WIDTH_20_NOHT
,

3334 
	mNL80211_CHAN_WIDTH_20
,

3335 
	mNL80211_CHAN_WIDTH_40
,

3336 
	mNL80211_CHAN_WIDTH_80
,

3337 
	mNL80211_CHAN_WIDTH_80P80
,

3338 
	mNL80211_CHAN_WIDTH_160
,

3339 
	mNL80211_CHAN_WIDTH_5
,

3340 
	mNL80211_CHAN_WIDTH_10
,

3352 
	eÆ80211_bss_sÿn_width
 {

3353 
	mNL80211_BSS_CHAN_WIDTH_20
,

3354 
	mNL80211_BSS_CHAN_WIDTH_10
,

3355 
	mNL80211_BSS_CHAN_WIDTH_5
,

3400 
	eÆ80211_bss
 {

3401 
	m__NL80211_BSS_INVALID
,

3402 
	mNL80211_BSS_BSSID
,

3403 
	mNL80211_BSS_FREQUENCY
,

3404 
	mNL80211_BSS_TSF
,

3405 
	mNL80211_BSS_BEACON_INTERVAL
,

3406 
	mNL80211_BSS_CAPABILITY
,

3407 
	mNL80211_BSS_INFORMATION_ELEMENTS
,

3408 
	mNL80211_BSS_SIGNAL_MBM
,

3409 
	mNL80211_BSS_SIGNAL_UNSPEC
,

3410 
	mNL80211_BSS_STATUS
,

3411 
	mNL80211_BSS_SEEN_MS_AGO
,

3412 
	mNL80211_BSS_BEACON_IES
,

3413 
	mNL80211_BSS_CHAN_WIDTH
,

3414 
	mNL80211_BSS_BEACON_TSF
,

3415 
	mNL80211_BSS_PRESP_DATA
,

3416 
	mNL80211_BSS_LAST_SEEN_BOOTTIME
,

3419 
	m__NL80211_BSS_AFTER_LAST
,

3420 
	mNL80211_BSS_MAX
 = 
__NL80211_BSS_AFTER_LAST
 - 1

3435 
	eÆ80211_bss_¡©us
 {

3436 
	mNL80211_BSS_STATUS_AUTHENTICATED
,

3437 
	mNL80211_BSS_STATUS_ASSOCIATED
,

3438 
	mNL80211_BSS_STATUS_IBSS_JOINED
,

3455 
	eÆ80211_auth_ty³
 {

3456 
	mNL80211_AUTHTYPE_OPEN_SYSTEM
,

3457 
	mNL80211_AUTHTYPE_SHARED_KEY
,

3458 
	mNL80211_AUTHTYPE_FT
,

3459 
	mNL80211_AUTHTYPE_NETWORK_EAP
,

3460 
	mNL80211_AUTHTYPE_SAE
,

3463 
	m__NL80211_AUTHTYPE_NUM
,

3464 
	mNL80211_AUTHTYPE_MAX
 = 
__NL80211_AUTHTYPE_NUM
 - 1,

3465 
	mNL80211_AUTHTYPE_AUTOMATIC


3475 
	eÆ80211_key_ty³
 {

3476 
	mNL80211_KEYTYPE_GROUP
,

3477 
	mNL80211_KEYTYPE_PAIRWISE
,

3478 
	mNL80211_KEYTYPE_PEERKEY
,

3480 
	mNUM_NL80211_KEYTYPES


3488 
	eÆ80211_må
 {

3489 
	mNL80211_MFP_NO
,

3490 
	mNL80211_MFP_REQUIRED
,

3493 
	eÆ80211_w·_v”siÚs
 {

3494 
	mNL80211_WPA_VERSION_1
 = 1 << 0,

3495 
	mNL80211_WPA_VERSION_2
 = 1 << 1,

3507 
	eÆ80211_key_deçuÉ_ty³s
 {

3508 
	m__NL80211_KEY_DEFAULT_TYPE_INVALID
,

3509 
	mNL80211_KEY_DEFAULT_TYPE_UNICAST
,

3510 
	mNL80211_KEY_DEFAULT_TYPE_MULTICAST
,

3512 
	mNUM_NL80211_KEY_DEFAULT_TYPES


3537 
	eÆ80211_key_©Œibu‹s
 {

3538 
	m__NL80211_KEY_INVALID
,

3539 
	mNL80211_KEY_DATA
,

3540 
	mNL80211_KEY_IDX
,

3541 
	mNL80211_KEY_CIPHER
,

3542 
	mNL80211_KEY_SEQ
,

3543 
	mNL80211_KEY_DEFAULT
,

3544 
	mNL80211_KEY_DEFAULT_MGMT
,

3545 
	mNL80211_KEY_TYPE
,

3546 
	mNL80211_KEY_DEFAULT_TYPES
,

3549 
	m__NL80211_KEY_AFTER_LAST
,

3550 
	mNL80211_KEY_MAX
 = 
__NL80211_KEY_AFTER_LAST
 - 1

3568 
	eÆ80211_tx_¿‹_©Œibu‹s
 {

3569 
	m__NL80211_TXRATE_INVALID
,

3570 
	mNL80211_TXRATE_LEGACY
,

3571 
	mNL80211_TXRATE_HT
,

3572 
	mNL80211_TXRATE_VHT
,

3573 
	mNL80211_TXRATE_GI
,

3576 
	m__NL80211_TXRATE_AFTER_LAST
,

3577 
	mNL80211_TXRATE_MAX
 = 
__NL80211_TXRATE_AFTER_LAST
 - 1

3580 
	#NL80211_TXRATE_MCS
 
NL80211_TXRATE_HT


	)

3581 
	#NL80211_VHT_NSS_MAX
 8

	)

3587 
	sÆ80211_tx¿‹_vht
 {

3588 
__u16
 
	mmcs
[
NL80211_VHT_NSS_MAX
];

3591 
	eÆ80211_tx¿‹_gi
 {

3592 
	mNL80211_TXRATE_DEFAULT_GI
,

3593 
	mNL80211_TXRATE_FORCE_SGI
,

3594 
	mNL80211_TXRATE_FORCE_LGI
,

3603 
	eÆ80211_bªd
 {

3604 
	mNL80211_BAND_2GHZ
,

3605 
	mNL80211_BAND_5GHZ
,

3606 
	mNL80211_BAND_60GHZ
,

3614 
	eÆ80211_ps_¡©e
 {

3615 
	mNL80211_PS_DISABLED
,

3616 
	mNL80211_PS_ENABLED
,

3647 
	eÆ80211_©Œ_cqm
 {

3648 
	m__NL80211_ATTR_CQM_INVALID
,

3649 
	mNL80211_ATTR_CQM_RSSI_THOLD
,

3650 
	mNL80211_ATTR_CQM_RSSI_HYST
,

3651 
	mNL80211_ATTR_CQM_RSSI_THRESHOLD_EVENT
,

3652 
	mNL80211_ATTR_CQM_PKT_LOSS_EVENT
,

3653 
	mNL80211_ATTR_CQM_TXE_RATE
,

3654 
	mNL80211_ATTR_CQM_TXE_PKTS
,

3655 
	mNL80211_ATTR_CQM_TXE_INTVL
,

3656 
	mNL80211_ATTR_CQM_BEACON_LOSS_EVENT
,

3659 
	m__NL80211_ATTR_CQM_AFTER_LAST
,

3660 
	mNL80211_ATTR_CQM_MAX
 = 
__NL80211_ATTR_CQM_AFTER_LAST
 - 1

3671 
	eÆ80211_cqm_rssi_th»shŞd_ev’t
 {

3672 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_LOW
,

3673 
	mNL80211_CQM_RSSI_THRESHOLD_EVENT_HIGH
,

3674 
	mNL80211_CQM_RSSI_BEACON_LOSS_EVENT
,

3684 
	eÆ80211_tx_pow”_£‰šg
 {

3685 
	mNL80211_TX_POWER_AUTOMATIC
,

3686 
	mNL80211_TX_POWER_LIMITED
,

3687 
	mNL80211_TX_POWER_FIXED
,

3711 
	eÆ80211_·ck‘_·‰”n_©Œ
 {

3712 
	m__NL80211_PKTPAT_INVALID
,

3713 
	mNL80211_PKTPAT_MASK
,

3714 
	mNL80211_PKTPAT_PATTERN
,

3715 
	mNL80211_PKTPAT_OFFSET
,

3717 
	mNUM_NL80211_PKTPAT
,

3718 
	mMAX_NL80211_PKTPAT
 = 
NUM_NL80211_PKTPAT
 - 1,

3734 
	sÆ80211_·‰”n_suµÜt
 {

3735 
__u32
 
	mmax_·‰”ns
;

3736 
__u32
 
	mmš_·‰”n_Ën
;

3737 
__u32
 
	mmax_·‰”n_Ën
;

3738 
__u32
 
	mmax_pkt_off£t
;

3739 } 
__©Œibu‹__
((
·cked
));

3742 
	#__NL80211_WOWLAN_PKTPAT_INVALID
 
__NL80211_PKTPAT_INVALID


	)

3743 
	#NL80211_WOWLAN_PKTPAT_MASK
 
NL80211_PKTPAT_MASK


	)

3744 
	#NL80211_WOWLAN_PKTPAT_PATTERN
 
NL80211_PKTPAT_PATTERN


	)

3745 
	#NL80211_WOWLAN_PKTPAT_OFFSET
 
NL80211_PKTPAT_OFFSET


	)

3746 
	#NUM_NL80211_WOWLAN_PKTPAT
 
NUM_NL80211_PKTPAT


	)

3747 
	#MAX_NL80211_WOWLAN_PKTPAT
 
MAX_NL80211_PKTPAT


	)

3748 
	#Æ80211_wowÏn_·‰”n_suµÜt
 
Æ80211_·‰”n_suµÜt


	)

3839 
	eÆ80211_wowÏn_Œigg”s
 {

3840 
	m__NL80211_WOWLAN_TRIG_INVALID
,

3841 
	mNL80211_WOWLAN_TRIG_ANY
,

3842 
	mNL80211_WOWLAN_TRIG_DISCONNECT
,

3843 
	mNL80211_WOWLAN_TRIG_MAGIC_PKT
,

3844 
	mNL80211_WOWLAN_TRIG_PKT_PATTERN
,

3845 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_SUPPORTED
,

3846 
	mNL80211_WOWLAN_TRIG_GTK_REKEY_FAILURE
,

3847 
	mNL80211_WOWLAN_TRIG_EAP_IDENT_REQUEST
,

3848 
	mNL80211_WOWLAN_TRIG_4WAY_HANDSHAKE
,

3849 
	mNL80211_WOWLAN_TRIG_RFKILL_RELEASE
,

3850 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211
,

3851 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_80211_LEN
,

3852 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023
,

3853 
	mNL80211_WOWLAN_TRIG_WAKEUP_PKT_8023_LEN
,

3854 
	mNL80211_WOWLAN_TRIG_TCP_CONNECTION
,

3855 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_MATCH
,

3856 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_CONNLOST
,

3857 
	mNL80211_WOWLAN_TRIG_WAKEUP_TCP_NOMORETOKENS
,

3858 
	mNL80211_WOWLAN_TRIG_NET_DETECT
,

3859 
	mNL80211_WOWLAN_TRIG_NET_DETECT_RESULTS
,

3862 
	mNUM_NL80211_WOWLAN_TRIG
,

3863 
	mMAX_NL80211_WOWLAN_TRIG
 = 
NUM_NL80211_WOWLAN_TRIG
 - 1

3899 
	sÆ80211_wowÏn_tı_d©a_£q
 {

3900 
__u32
 
	m¡¬t
, 
	moff£t
, 
	mËn
;

3910 
	sÆ80211_wowÏn_tı_d©a_tok’
 {

3911 
__u32
 
	moff£t
, 
	mËn
;

3912 
__u8
 
	mtok’_¡»am
[];

3921 
	sÆ80211_wowÏn_tı_d©a_tok’_ã©u»
 {

3922 
__u32
 
	mmš_Ën
, 
	mmax_Ën
, 
	mbufsize
;

3957 
	eÆ80211_wowÏn_tı_©Œs
 {

3958 
	m__NL80211_WOWLAN_TCP_INVALID
,

3959 
	mNL80211_WOWLAN_TCP_SRC_IPV4
,

3960 
	mNL80211_WOWLAN_TCP_DST_IPV4
,

3961 
	mNL80211_WOWLAN_TCP_DST_MAC
,

3962 
	mNL80211_WOWLAN_TCP_SRC_PORT
,

3963 
	mNL80211_WOWLAN_TCP_DST_PORT
,

3964 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD
,

3965 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_SEQ
,

3966 
	mNL80211_WOWLAN_TCP_DATA_PAYLOAD_TOKEN
,

3967 
	mNL80211_WOWLAN_TCP_DATA_INTERVAL
,

3968 
	mNL80211_WOWLAN_TCP_WAKE_PAYLOAD
,

3969 
	mNL80211_WOWLAN_TCP_WAKE_MASK
,

3972 
	mNUM_NL80211_WOWLAN_TCP
,

3973 
	mMAX_NL80211_WOWLAN_TCP
 = 
NUM_NL80211_WOWLAN_TCP
 - 1

3985 
	sÆ80211_cßËsû_ruË_suµÜt
 {

3986 
__u32
 
	mmax_ruËs
;

3987 
Æ80211_·‰”n_suµÜt
 
	m·t
;

3988 
__u32
 
	mmax_d–ay
;

3989 } 
__©Œibu‹__
((
·cked
));

4002 
	eÆ80211_©Œ_cßËsû_ruË
 {

4003 
	m__NL80211_COALESCE_RULE_INVALID
,

4004 
	mNL80211_ATTR_COALESCE_RULE_DELAY
,

4005 
	mNL80211_ATTR_COALESCE_RULE_CONDITION
,

4006 
	mNL80211_ATTR_COALESCE_RULE_PKT_PATTERN
,

4009 
	mNUM_NL80211_ATTR_COALESCE_RULE
,

4010 
	mNL80211_ATTR_COALESCE_RULE_MAX
 = 
NUM_NL80211_ATTR_COALESCE_RULE
 - 1

4020 
	eÆ80211_cßËsû_cÚd™iÚ
 {

4021 
	mNL80211_COALESCE_CONDITION_MATCH
,

4022 
	mNL80211_COALESCE_CONDITION_NO_MATCH


4035 
	eÆ80211_içû_lim™_©Œs
 {

4036 
	mNL80211_IFACE_LIMIT_UNSPEC
,

4037 
	mNL80211_IFACE_LIMIT_MAX
,

4038 
	mNL80211_IFACE_LIMIT_TYPES
,

4041 
	mNUM_NL80211_IFACE_LIMIT
,

4042 
	mMAX_NL80211_IFACE_LIMIT
 = 
NUM_NL80211_IFACE_LIMIT
 - 1

4091 
	eÆ80211_if_combš©iÚ_©Œs
 {

4092 
	mNL80211_IFACE_COMB_UNSPEC
,

4093 
	mNL80211_IFACE_COMB_LIMITS
,

4094 
	mNL80211_IFACE_COMB_MAXNUM
,

4095 
	mNL80211_IFACE_COMB_STA_AP_BI_MATCH
,

4096 
	mNL80211_IFACE_COMB_NUM_CHANNELS
,

4097 
	mNL80211_IFACE_COMB_RADAR_DETECT_WIDTHS
,

4098 
	mNL80211_IFACE_COMB_RADAR_DETECT_REGIONS
,

4101 
	mNUM_NL80211_IFACE_COMB
,

4102 
	mMAX_NL80211_IFACE_COMB
 = 
NUM_NL80211_IFACE_COMB
 - 1

4124 
	eÆ80211_¶šk_¡©e
 {

4125 
	mNL80211_PLINK_LISTEN
,

4126 
	mNL80211_PLINK_OPN_SNT
,

4127 
	mNL80211_PLINK_OPN_RCVD
,

4128 
	mNL80211_PLINK_CNF_RCVD
,

4129 
	mNL80211_PLINK_ESTAB
,

4130 
	mNL80211_PLINK_HOLDING
,

4131 
	mNL80211_PLINK_BLOCKED
,

4134 
	mNUM_NL80211_PLINK_STATES
,

4135 
	mMAX_NL80211_PLINK_STATES
 = 
NUM_NL80211_PLINK_STATES
 - 1

4146 
	e¶šk_aùiÚs
 {

4147 
	mNL80211_PLINK_ACTION_NO_ACTION
,

4148 
	mNL80211_PLINK_ACTION_OPEN
,

4149 
	mNL80211_PLINK_ACTION_BLOCK
,

4151 
	mNUM_NL80211_PLINK_ACTIONS
,

4155 
	#NL80211_KCK_LEN
 16

	)

4156 
	#NL80211_KEK_LEN
 16

	)

4157 
	#NL80211_REPLAY_CTR_LEN
 8

	)

4168 
	eÆ80211_»key_d©a
 {

4169 
	m__NL80211_REKEY_DATA_INVALID
,

4170 
	mNL80211_REKEY_DATA_KEK
,

4171 
	mNL80211_REKEY_DATA_KCK
,

4172 
	mNL80211_REKEY_DATA_REPLAY_CTR
,

4175 
	mNUM_NL80211_REKEY_DATA
,

4176 
	mMAX_NL80211_REKEY_DATA
 = 
NUM_NL80211_REKEY_DATA
 - 1

4188 
	eÆ80211_hidd’_ssid
 {

4189 
	mNL80211_HIDDEN_SSID_NOT_IN_USE
,

4190 
	mNL80211_HIDDEN_SSID_ZERO_LEN
,

4191 
	mNL80211_HIDDEN_SSID_ZERO_CONTENTS


4204 
	eÆ80211_¡a_wme_©Œ
 {

4205 
	m__NL80211_STA_WME_INVALID
,

4206 
	mNL80211_STA_WME_UAPSD_QUEUES
,

4207 
	mNL80211_STA_WME_MAX_SP
,

4210 
	m__NL80211_STA_WME_AFTER_LAST
,

4211 
	mNL80211_STA_WME_MAX
 = 
__NL80211_STA_WME_AFTER_LAST
 - 1

4226 
	eÆ80211_pmk§_ÿndid©e_©Œ
 {

4227 
	m__NL80211_PMKSA_CANDIDATE_INVALID
,

4228 
	mNL80211_PMKSA_CANDIDATE_INDEX
,

4229 
	mNL80211_PMKSA_CANDIDATE_BSSID
,

4230 
	mNL80211_PMKSA_CANDIDATE_PREAUTH
,

4233 
	mNUM_NL80211_PMKSA_CANDIDATE
,

4234 
	mMAX_NL80211_PMKSA_CANDIDATE
 = 
NUM_NL80211_PMKSA_CANDIDATE
 - 1

4245 
	eÆ80211_tdls_İ”©iÚ
 {

4246 
	mNL80211_TDLS_DISCOVERY_REQ
,

4247 
	mNL80211_TDLS_SETUP
,

4248 
	mNL80211_TDLS_TEARDOWN
,

4249 
	mNL80211_TDLS_ENABLE_LINK
,

4250 
	mNL80211_TDLS_DISABLE_LINK
,

4354 
	eÆ80211_ã©u»_æags
 {

4355 
	mNL80211_FEATURE_SK_TX_STATUS
 = 1 << 0,

4356 
	mNL80211_FEATURE_HT_IBSS
 = 1 << 1,

4357 
	mNL80211_FEATURE_INACTIVITY_TIMER
 = 1 << 2,

4358 
	mNL80211_FEATURE_CELL_BASE_REG_HINTS
 = 1 << 3,

4359 
	mNL80211_FEATURE_P2P_DEVICE_NEEDS_CHANNEL
 = 1 << 4,

4360 
	mNL80211_FEATURE_SAE
 = 1 << 5,

4361 
	mNL80211_FEATURE_LOW_PRIORITY_SCAN
 = 1 << 6,

4362 
	mNL80211_FEATURE_SCAN_FLUSH
 = 1 << 7,

4363 
	mNL80211_FEATURE_AP_SCAN
 = 1 << 8,

4364 
	mNL80211_FEATURE_VIF_TXPOWER
 = 1 << 9,

4365 
	mNL80211_FEATURE_NEED_OBSS_SCAN
 = 1 << 10,

4366 
	mNL80211_FEATURE_P2P_GO_CTWIN
 = 1 << 11,

4367 
	mNL80211_FEATURE_P2P_GO_OPPPS
 = 1 << 12,

4369 
	mNL80211_FEATURE_ADVERTISE_CHAN_LIMITS
 = 1 << 14,

4370 
	mNL80211_FEATURE_FULL_AP_CLIENT_STATE
 = 1 << 15,

4371 
	mNL80211_FEATURE_USERSPACE_MPM
 = 1 << 16,

4372 
	mNL80211_FEATURE_ACTIVE_MONITOR
 = 1 << 17,

4373 
	mNL80211_FEATURE_AP_MODE_CHAN_WIDTH_CHANGE
 = 1 << 18,

4374 
	mNL80211_FEATURE_DS_PARAM_SET_IE_IN_PROBES
 = 1 << 19,

4375 
	mNL80211_FEATURE_WFA_TPC_IE_IN_PROBES
 = 1 << 20,

4376 
	mNL80211_FEATURE_QUIET
 = 1 << 21,

4377 
	mNL80211_FEATURE_TX_POWER_INSERTION
 = 1 << 22,

4378 
	mNL80211_FEATURE_ACKTO_ESTIMATION
 = 1 << 23,

4379 
	mNL80211_FEATURE_STATIC_SMPS
 = 1 << 24,

4380 
	mNL80211_FEATURE_DYNAMIC_SMPS
 = 1 << 25,

4381 
	mNL80211_FEATURE_SUPPORTS_WMM_ADMISSION
 = 1 << 26,

4382 
	mNL80211_FEATURE_MAC_ON_CREATE
 = 1 << 27,

4383 
	mNL80211_FEATURE_TDLS_CHANNEL_SWITCH
 = 1 << 28,

4384 
	mNL80211_FEATURE_SCAN_RANDOM_MAC_ADDR
 = 1 << 29,

4385 
	mNL80211_FEATURE_SCHED_SCAN_RANDOM_MAC_ADDR
 = 1 << 30,

4386 
	mNL80211_FEATURE_ND_RANDOM_MAC_ADDR
 = 1 << 31,

4396 
	eÆ80211_ext_ã©u»_šdex
 {

4397 
	mNL80211_EXT_FEATURE_VHT_IBSS
,

4400 
	mNUM_NL80211_EXT_FEATURES
,

4401 
	mMAX_NL80211_EXT_FEATURES
 = 
NUM_NL80211_EXT_FEATURES
 - 1

4418 
	eÆ80211_´obe_»¥_ofæßd_suµÜt_©Œ
 {

4419 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS
 = 1<<0,

4420 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_WPS2
 = 1<<1,

4421 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_P2P
 = 1<<2,

4422 
	mNL80211_PROBE_RESP_OFFLOAD_SUPPORT_80211U
 = 1<<3,

4431 
	eÆ80211_cÚÃù_çed_»asÚ
 {

4432 
	mNL80211_CONN_FAIL_MAX_CLIENTS
,

4433 
	mNL80211_CONN_FAIL_BLOCKED_CLIENT
,

4460 
	eÆ80211_sÿn_æags
 {

4461 
	mNL80211_SCAN_FLAG_LOW_PRIORITY
 = 1<<0,

4462 
	mNL80211_SCAN_FLAG_FLUSH
 = 1<<1,

4463 
	mNL80211_SCAN_FLAG_AP
 = 1<<2,

4464 
	mNL80211_SCAN_FLAG_RANDOM_ADDR
 = 1<<3,

4480 
	eÆ80211_aş_pŞicy
 {

4481 
	mNL80211_ACL_POLICY_ACCEPT_UNLESS_LISTED
,

4482 
	mNL80211_ACL_POLICY_DENY_UNLESS_LISTED
,

4495 
	eÆ80211_smps_mode
 {

4496 
	mNL80211_SMPS_OFF
,

4497 
	mNL80211_SMPS_STATIC
,

4498 
	mNL80211_SMPS_DYNAMIC
,

4500 
	m__NL80211_SMPS_AFTER_LAST
,

4501 
	mNL80211_SMPS_MAX
 = 
__NL80211_SMPS_AFTER_LAST
 - 1

4519 
	eÆ80211_¿d¬_ev’t
 {

4520 
	mNL80211_RADAR_DETECTED
,

4521 
	mNL80211_RADAR_CAC_FINISHED
,

4522 
	mNL80211_RADAR_CAC_ABORTED
,

4523 
	mNL80211_RADAR_NOP_FINISHED
,

4537 
	eÆ80211_dfs_¡©e
 {

4538 
	mNL80211_DFS_USABLE
,

4539 
	mNL80211_DFS_UNAVAILABLE
,

4540 
	mNL80211_DFS_AVAILABLE
,

4551 
	eÆ80211_´ÙocŞ_ã©u»s
 {

4552 
	mNL80211_PROTOCOL_FEATURE_SPLIT_WIPHY_DUMP
 = 1 << 0,

4564 
	eÆ80211_ü™_´Ùo_id
 {

4565 
	mNL80211_CRIT_PROTO_UNSPEC
,

4566 
	mNL80211_CRIT_PROTO_DHCP
,

4567 
	mNL80211_CRIT_PROTO_EAPOL
,

4568 
	mNL80211_CRIT_PROTO_APIPA
,

4570 
	mNUM_NL80211_CRIT_PROTO


4574 
	#NL80211_CRIT_PROTO_MAX_DURATION
 5000

	)

4583 
	eÆ80211_rxmgmt_æags
 {

4584 
	mNL80211_RXMGMT_FLAG_ANSWERED
 = 1 << 0,

4592 
	#NL80211_VENDOR_ID_IS_LINUX
 0x80000000

	)

4602 
	sÆ80211_v’dÜ_cmd_šfo
 {

4603 
__u32
 
	mv’dÜ_id
;

4604 
__u32
 
	msubcmd
;

4617 
	eÆ80211_tdls_³”_ÿ·b™y
 {

4618 
	mNL80211_TDLS_PEER_HT
 = 1<<0,

4619 
	mNL80211_TDLS_PEER_VHT
 = 1<<1,

4620 
	mNL80211_TDLS_PEER_WMM
 = 1<<2,

4636 
	eÆ80211_sched_sÿn_¶ª
 {

4637 
	m__NL80211_SCHED_SCAN_PLAN_INVALID
,

4638 
	mNL80211_SCHED_SCAN_PLAN_INTERVAL
,

4639 
	mNL80211_SCHED_SCAN_PLAN_ITERATIONS
,

4642 
	m__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
,

4643 
	mNL80211_SCHED_SCAN_PLAN_MAX
 =

4644 
__NL80211_SCHED_SCAN_PLAN_AFTER_LAST
 - 1

	@/usr/include/linux/param.h

1 #iâdeà
_LINUX_PARAM_H


2 
	#_LINUX_PARAM_H


	)

4 
	~<asm/·¿m.h
>

	@/usr/include/linux/pkt_cls.h

1 #iâdeà
__LINUX_PKT_CLS_H


2 
	#__LINUX_PKT_CLS_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_sched.h
>

10 
	mTCA_ACT_UNSPEC
,

11 
	mTCA_ACT_KIND
,

12 
	mTCA_ACT_OPTIONS
,

13 
	mTCA_ACT_INDEX
,

14 
	mTCA_ACT_STATS
,

15 
	m__TCA_ACT_MAX


18 
	#TCA_ACT_MAX
 
__TCA_ACT_MAX


	)

19 
	#TCA_OLD_COMPAT
 (
TCA_ACT_MAX
+1)

	)

20 
	#TCA_ACT_MAX_PRIO
 32

	)

21 
	#TCA_ACT_BIND
 1

	)

22 
	#TCA_ACT_NOBIND
 0

	)

23 
	#TCA_ACT_UNBIND
 1

	)

24 
	#TCA_ACT_NOUNBIND
 0

	)

25 
	#TCA_ACT_REPLACE
 1

	)

26 
	#TCA_ACT_NOREPLACE
 0

	)

28 
	#TC_ACT_UNSPEC
 (-1)

	)

29 
	#TC_ACT_OK
 0

	)

30 
	#TC_ACT_RECLASSIFY
 1

	)

31 
	#TC_ACT_SHOT
 2

	)

32 
	#TC_ACT_PIPE
 3

	)

33 
	#TC_ACT_STOLEN
 4

	)

34 
	#TC_ACT_QUEUED
 5

	)

35 
	#TC_ACT_REPEAT
 6

	)

36 
	#TC_ACT_REDIRECT
 7

	)

37 
	#TC_ACT_JUMP
 0x10000000

	)

41 
	mTCA_ID_UNSPEC
=0,

42 
	mTCA_ID_POLICE
=1,

44 
	m__TCA_ID_MAX
=255

47 
	#TCA_ID_MAX
 
__TCA_ID_MAX


	)

49 
	stc_pŞiû
 {

50 
__u32
 
	mšdex
;

51 
	maùiÚ
;

52 
	#TC_POLICE_UNSPEC
 
TC_ACT_UNSPEC


	)

53 
	#TC_POLICE_OK
 
TC_ACT_OK


	)

54 
	#TC_POLICE_RECLASSIFY
 
TC_ACT_RECLASSIFY


	)

55 
	#TC_POLICE_SHOT
 
TC_ACT_SHOT


	)

56 
	#TC_POLICE_PIPE
 
TC_ACT_PIPE


	)

58 
__u32
 
	mlim™
;

59 
__u32
 
	mbur¡
;

60 
__u32
 
	mmtu
;

61 
tc_¿‹¥ec
 
	m¿‹
;

62 
tc_¿‹¥ec
 
	m³ak¿‹
;

63 
	m»fút
;

64 
	mbšdút
;

65 
__u32
 
	mÿ·b
;

68 
	stcf_t
 {

69 
__u64
 
	mš¡®l
;

70 
__u64
 
	mÏ¡u£
;

71 
__u64
 
	mexpœes
;

74 
	stc_út
 {

75 
	m»fút
;

76 
	mbšdút
;

79 
	#tc_g’
 \

80 
__u32
 
šdex
; \

81 
__u32
 
ÿ·b
; \

82 
aùiÚ
; \

83 
»fút
; \

84 
bšdút


	)

87 
	mTCA_POLICE_UNSPEC
,

88 
	mTCA_POLICE_TBF
,

89 
	mTCA_POLICE_RATE
,

90 
	mTCA_POLICE_PEAKRATE
,

91 
	mTCA_POLICE_AVRATE
,

92 
	mTCA_POLICE_RESULT
,

93 
	m__TCA_POLICE_MAX


94 
	#TCA_POLICE_RESULT
 
TCA_POLICE_RESULT


	)

97 
	#TCA_POLICE_MAX
 (
__TCA_POLICE_MAX
 - 1)

	)

101 
	#TC_U32_HTID
(
h
è((h)&0xFFF00000)

	)

102 
	#TC_U32_USERHTID
(
h
è(
	`TC_U32_HTID
(h)>>20)

	)

103 
	#TC_U32_HASH
(
h
è(((h)>>12)&0xFF)

	)

104 
	#TC_U32_NODE
(
h
è((h)&0xFFF)

	)

105 
	#TC_U32_KEY
(
h
è((h)&0xFFFFF)

	)

106 
	#TC_U32_UNSPEC
 0

	)

107 
	#TC_U32_ROOT
 (0xFFF00000)

	)

110 
	mTCA_U32_UNSPEC
,

111 
	mTCA_U32_CLASSID
,

112 
	mTCA_U32_HASH
,

113 
	mTCA_U32_LINK
,

114 
	mTCA_U32_DIVISOR
,

115 
	mTCA_U32_SEL
,

116 
	mTCA_U32_POLICE
,

117 
	mTCA_U32_ACT
,

118 
	mTCA_U32_INDEV
,

119 
	mTCA_U32_PCNT
,

120 
	mTCA_U32_MARK
,

121 
	m__TCA_U32_MAX


124 
	#TCA_U32_MAX
 (
__TCA_U32_MAX
 - 1)

	)

126 
	stc_u32_key
 {

127 
__be32
 
	mmask
;

128 
__be32
 
	mv®
;

129 
	moff
;

130 
	moffmask
;

133 
	stc_u32_£l
 {

134 
	mæags
;

135 
	moffshiá
;

136 
	mnkeys
;

138 
__be16
 
	moffmask
;

139 
__u16
 
	moff
;

140 
	moffoff
;

142 
	mhoff
;

143 
__be32
 
	mhmask
;

144 
tc_u32_key
 
	mkeys
[0];

147 
	stc_u32_m¬k
 {

148 
__u32
 
	mv®
;

149 
__u32
 
	mmask
;

150 
__u32
 
	msucûss
;

153 
	stc_u32_pút
 {

154 
__u64
 
	mrút
;

155 
__u64
 
	mrh™
;

156 
__u64
 
	mkúts
[0];

161 
	#TC_U32_TERMINAL
 1

	)

162 
	#TC_U32_OFFSET
 2

	)

163 
	#TC_U32_VAROFFSET
 4

	)

164 
	#TC_U32_EAT
 8

	)

166 
	#TC_U32_MAXDEPTH
 8

	)

172 
	mTCA_RSVP_UNSPEC
,

173 
	mTCA_RSVP_CLASSID
,

174 
	mTCA_RSVP_DST
,

175 
	mTCA_RSVP_SRC
,

176 
	mTCA_RSVP_PINFO
,

177 
	mTCA_RSVP_POLICE
,

178 
	mTCA_RSVP_ACT
,

179 
	m__TCA_RSVP_MAX


182 
	#TCA_RSVP_MAX
 (
__TCA_RSVP_MAX
 - 1 )

	)

184 
	stc_rsvp_gpi
 {

185 
__u32
 
	mkey
;

186 
__u32
 
	mmask
;

187 
	moff£t
;

190 
	stc_rsvp_pšfo
 {

191 
tc_rsvp_gpi
 
	mdpi
;

192 
tc_rsvp_gpi
 
	m¥i
;

193 
__u8
 
	m´ÙocŞ
;

194 
__u8
 
	mtuÂ–id
;

195 
__u8
 
	mtuÂ–hdr
;

196 
__u8
 
	m·d
;

202 
	mTCA_ROUTE4_UNSPEC
,

203 
	mTCA_ROUTE4_CLASSID
,

204 
	mTCA_ROUTE4_TO
,

205 
	mTCA_ROUTE4_FROM
,

206 
	mTCA_ROUTE4_IIF
,

207 
	mTCA_ROUTE4_POLICE
,

208 
	mTCA_ROUTE4_ACT
,

209 
	m__TCA_ROUTE4_MAX


212 
	#TCA_ROUTE4_MAX
 (
__TCA_ROUTE4_MAX
 - 1)

	)

218 
	mTCA_FW_UNSPEC
,

219 
	mTCA_FW_CLASSID
,

220 
	mTCA_FW_POLICE
,

221 
	mTCA_FW_INDEV
,

222 
	mTCA_FW_ACT
,

223 
	mTCA_FW_MASK
,

224 
	m__TCA_FW_MAX


227 
	#TCA_FW_MAX
 (
__TCA_FW_MAX
 - 1)

	)

232 
	mTCA_TCINDEX_UNSPEC
,

233 
	mTCA_TCINDEX_HASH
,

234 
	mTCA_TCINDEX_MASK
,

235 
	mTCA_TCINDEX_SHIFT
,

236 
	mTCA_TCINDEX_FALL_THROUGH
,

237 
	mTCA_TCINDEX_CLASSID
,

238 
	mTCA_TCINDEX_POLICE
,

239 
	mTCA_TCINDEX_ACT
,

240 
	m__TCA_TCINDEX_MAX


243 
	#TCA_TCINDEX_MAX
 (
__TCA_TCINDEX_MAX
 - 1)

	)

248 
	mFLOW_KEY_SRC
,

249 
	mFLOW_KEY_DST
,

250 
	mFLOW_KEY_PROTO
,

251 
	mFLOW_KEY_PROTO_SRC
,

252 
	mFLOW_KEY_PROTO_DST
,

253 
	mFLOW_KEY_IIF
,

254 
	mFLOW_KEY_PRIORITY
,

255 
	mFLOW_KEY_MARK
,

256 
	mFLOW_KEY_NFCT
,

257 
	mFLOW_KEY_NFCT_SRC
,

258 
	mFLOW_KEY_NFCT_DST
,

259 
	mFLOW_KEY_NFCT_PROTO_SRC
,

260 
	mFLOW_KEY_NFCT_PROTO_DST
,

261 
	mFLOW_KEY_RTCLASSID
,

262 
	mFLOW_KEY_SKUID
,

263 
	mFLOW_KEY_SKGID
,

264 
	mFLOW_KEY_VLAN_TAG
,

265 
	mFLOW_KEY_RXHASH
,

266 
	m__FLOW_KEY_MAX
,

269 
	#FLOW_KEY_MAX
 (
__FLOW_KEY_MAX
 - 1)

	)

272 
	mFLOW_MODE_MAP
,

273 
	mFLOW_MODE_HASH
,

277 
	mTCA_FLOW_UNSPEC
,

278 
	mTCA_FLOW_KEYS
,

279 
	mTCA_FLOW_MODE
,

280 
	mTCA_FLOW_BASECLASS
,

281 
	mTCA_FLOW_RSHIFT
,

282 
	mTCA_FLOW_ADDEND
,

283 
	mTCA_FLOW_MASK
,

284 
	mTCA_FLOW_XOR
,

285 
	mTCA_FLOW_DIVISOR
,

286 
	mTCA_FLOW_ACT
,

287 
	mTCA_FLOW_POLICE
,

288 
	mTCA_FLOW_EMATCHES
,

289 
	mTCA_FLOW_PERTURB
,

290 
	m__TCA_FLOW_MAX


293 
	#TCA_FLOW_MAX
 (
__TCA_FLOW_MAX
 - 1)

	)

298 
	mTCA_BASIC_UNSPEC
,

299 
	mTCA_BASIC_CLASSID
,

300 
	mTCA_BASIC_EMATCHES
,

301 
	mTCA_BASIC_ACT
,

302 
	mTCA_BASIC_POLICE
,

303 
	m__TCA_BASIC_MAX


306 
	#TCA_BASIC_MAX
 (
__TCA_BASIC_MAX
 - 1)

	)

312 
	mTCA_CGROUP_UNSPEC
,

313 
	mTCA_CGROUP_ACT
,

314 
	mTCA_CGROUP_POLICE
,

315 
	mTCA_CGROUP_EMATCHES
,

316 
	m__TCA_CGROUP_MAX
,

319 
	#TCA_CGROUP_MAX
 (
__TCA_CGROUP_MAX
 - 1)

	)

323 
	#TCA_BPF_FLAG_ACT_DIRECT
 (1 << 0)

	)

326 
	mTCA_BPF_UNSPEC
,

327 
	mTCA_BPF_ACT
,

328 
	mTCA_BPF_POLICE
,

329 
	mTCA_BPF_CLASSID
,

330 
	mTCA_BPF_OPS_LEN
,

331 
	mTCA_BPF_OPS
,

332 
	mTCA_BPF_FD
,

333 
	mTCA_BPF_NAME
,

334 
	mTCA_BPF_FLAGS
,

335 
	m__TCA_BPF_MAX
,

338 
	#TCA_BPF_MAX
 (
__TCA_BPF_MAX
 - 1)

	)

343 
	mTCA_FLOWER_UNSPEC
,

344 
	mTCA_FLOWER_CLASSID
,

345 
	mTCA_FLOWER_INDEV
,

346 
	mTCA_FLOWER_ACT
,

347 
	mTCA_FLOWER_KEY_ETH_DST
,

348 
	mTCA_FLOWER_KEY_ETH_DST_MASK
,

349 
	mTCA_FLOWER_KEY_ETH_SRC
,

350 
	mTCA_FLOWER_KEY_ETH_SRC_MASK
,

351 
	mTCA_FLOWER_KEY_ETH_TYPE
,

352 
	mTCA_FLOWER_KEY_IP_PROTO
,

353 
	mTCA_FLOWER_KEY_IPV4_SRC
,

354 
	mTCA_FLOWER_KEY_IPV4_SRC_MASK
,

355 
	mTCA_FLOWER_KEY_IPV4_DST
,

356 
	mTCA_FLOWER_KEY_IPV4_DST_MASK
,

357 
	mTCA_FLOWER_KEY_IPV6_SRC
,

358 
	mTCA_FLOWER_KEY_IPV6_SRC_MASK
,

359 
	mTCA_FLOWER_KEY_IPV6_DST
,

360 
	mTCA_FLOWER_KEY_IPV6_DST_MASK
,

361 
	mTCA_FLOWER_KEY_TCP_SRC
,

362 
	mTCA_FLOWER_KEY_TCP_DST
,

363 
	mTCA_FLOWER_KEY_UDP_SRC
,

364 
	mTCA_FLOWER_KEY_UDP_DST
,

365 
	m__TCA_FLOWER_MAX
,

368 
	#TCA_FLOWER_MAX
 (
__TCA_FLOWER_MAX
 - 1)

	)

373 
	mTCA_MATCHALL_UNSPEC
,

374 
	mTCA_MATCHALL_CLASSID
,

375 
	mTCA_MATCHALL_ACT
,

376 
	m__TCA_MATCHALL_MAX
,

379 
	#TCA_MATCHALL_MAX
 (
__TCA_MATCHALL_MAX
 - 1)

	)

383 
	stcf_em©ch_Œ“_hdr
 {

384 
__u16
 
	mnm©ches
;

385 
__u16
 
	m´ogid
;

389 
	mTCA_EMATCH_TREE_UNSPEC
,

390 
	mTCA_EMATCH_TREE_HDR
,

391 
	mTCA_EMATCH_TREE_LIST
,

392 
	m__TCA_EMATCH_TREE_MAX


394 
	#TCA_EMATCH_TREE_MAX
 (
__TCA_EMATCH_TREE_MAX
 - 1)

	)

396 
	stcf_em©ch_hdr
 {

397 
__u16
 
	mm©chid
;

398 
__u16
 
	mkšd
;

399 
__u16
 
	mæags
;

400 
__u16
 
	m·d
;

417 
	#TCF_EM_REL_END
 0

	)

418 
	#TCF_EM_REL_AND
 (1<<0)

	)

419 
	#TCF_EM_REL_OR
 (1<<1)

	)

420 
	#TCF_EM_INVERT
 (1<<2)

	)

421 
	#TCF_EM_SIMPLE
 (1<<3)

	)

423 
	#TCF_EM_REL_MASK
 3

	)

424 
	#TCF_EM_REL_VALID
(
v
è(((vè& 
TCF_EM_REL_MASK
è!ğTCF_EM_REL_MASK)

	)

427 
	mTCF_LAYER_LINK
,

428 
	mTCF_LAYER_NETWORK
,

429 
	mTCF_LAYER_TRANSPORT
,

430 
	m__TCF_LAYER_MAX


432 
	#TCF_LAYER_MAX
 (
__TCF_LAYER_MAX
 - 1)

	)

438 
	#TCF_EM_CONTAINER
 0

	)

439 
	#TCF_EM_CMP
 1

	)

440 
	#TCF_EM_NBYTE
 2

	)

441 
	#TCF_EM_U32
 3

	)

442 
	#TCF_EM_META
 4

	)

443 
	#TCF_EM_TEXT
 5

	)

444 
	#TCF_EM_VLAN
 6

	)

445 
	#TCF_EM_CANID
 7

	)

446 
	#TCF_EM_IPSET
 8

	)

447 
	#TCF_EM_MAX
 8

	)

450 
	mTCF_EM_PROG_TC


454 
	mTCF_EM_OPND_EQ
,

455 
	mTCF_EM_OPND_GT
,

456 
	mTCF_EM_OPND_LT


	@/usr/include/linux/pkt_sched.h

1 #iâdeà
__LINUX_PKT_SCHED_H


2 
	#__LINUX_PKT_SCHED_H


	)

4 
	~<lšux/ty³s.h
>

19 
	#TC_PRIO_BESTEFFORT
 0

	)

20 
	#TC_PRIO_FILLER
 1

	)

21 
	#TC_PRIO_BULK
 2

	)

22 
	#TC_PRIO_INTERACTIVE_BULK
 4

	)

23 
	#TC_PRIO_INTERACTIVE
 6

	)

24 
	#TC_PRIO_CONTROL
 7

	)

26 
	#TC_PRIO_MAX
 15

	)

32 
	stc_¡©s
 {

33 
__u64
 
	mby‹s
;

34 
__u32
 
	m·ck‘s
;

35 
__u32
 
	mdrİs
;

36 
__u32
 
	mov”lim™s
;

38 
__u32
 
	mbps
;

39 
__u32
 
	mµs
;

40 
__u32
 
	mqËn
;

41 
__u32
 
	mbacklog
;

44 
	stc_e¡im©Ü
 {

45 sigÃd 
	mš‹rv®
;

46 
	mewma_log
;

66 
	#TC_H_MAJ_MASK
 (0xFFFF0000U)

	)

67 
	#TC_H_MIN_MASK
 (0x0000FFFFU)

	)

68 
	#TC_H_MAJ
(
h
è((h)&
TC_H_MAJ_MASK
)

	)

69 
	#TC_H_MIN
(
h
è((h)&
TC_H_MIN_MASK
)

	)

70 
	#TC_H_MAKE
(
maj
,
mš
è(((maj)&
TC_H_MAJ_MASK
)|((mš)&
TC_H_MIN_MASK
))

	)

72 
	#TC_H_UNSPEC
 (0U)

	)

73 
	#TC_H_ROOT
 (0xFFFFFFFFU)

	)

74 
	#TC_H_INGRESS
 (0xFFFFFFF1U)

	)

77 
	etc_lšk_Ïy”
 {

78 
	mTC_LINKLAYER_UNAWARE
,

79 
	mTC_LINKLAYER_ETHERNET
,

80 
	mTC_LINKLAYER_ATM
,

82 
	#TC_LINKLAYER_MASK
 0x0F

	)

84 
	stc_¿‹¥ec
 {

85 
	mûÎ_log
;

86 
__u8
 
	mlškÏy”
;

87 
	mov”h—d
;

88 
	mûÎ_®ign
;

89 
	mmpu
;

90 
__u32
 
	m¿‹
;

93 
	#TC_RTAB_SIZE
 1024

	)

95 
	stc_size¥ec
 {

96 
	mûÎ_log
;

97 
	msize_log
;

98 
	mûÎ_®ign
;

99 
	mov”h—d
;

100 
	mlškÏy”
;

101 
	mmpu
;

102 
	mmtu
;

103 
	mtsize
;

107 
	mTCA_STAB_UNSPEC
,

108 
	mTCA_STAB_BASE
,

109 
	mTCA_STAB_DATA
,

110 
	m__TCA_STAB_MAX


113 
	#TCA_STAB_MAX
 (
__TCA_STAB_MAX
 - 1)

	)

117 
	stc_fifo_qİt
 {

118 
__u32
 
	mlim™
;

123 
	#TCQ_PRIO_BANDS
 16

	)

124 
	#TCQ_MIN_PRIO_BANDS
 2

	)

126 
	stc_´io_qİt
 {

127 
	mbªds
;

128 
__u8
 
	m´iom­
[
TC_PRIO_MAX
+1];

133 
	stc_muÉiq_qİt
 {

134 
__u16
 
	mbªds
;

135 
__u16
 
	mmax_bªds
;

140 
	#TCQ_PLUG_BUFFER
 0

	)

141 
	#TCQ_PLUG_RELEASE_ONE
 1

	)

142 
	#TCQ_PLUG_RELEASE_INDEFINITE
 2

	)

143 
	#TCQ_PLUG_LIMIT
 3

	)

145 
	stc_¶ug_qİt
 {

155 
	maùiÚ
;

156 
__u32
 
	mlim™
;

161 
	stc_tbf_qİt
 {

162 
tc_¿‹¥ec
 
	m¿‹
;

163 
tc_¿‹¥ec
 
	m³ak¿‹
;

164 
__u32
 
	mlim™
;

165 
__u32
 
	mbufãr
;

166 
__u32
 
	mmtu
;

170 
	mTCA_TBF_UNSPEC
,

171 
	mTCA_TBF_PARMS
,

172 
	mTCA_TBF_RTAB
,

173 
	mTCA_TBF_PTAB
,

174 
	mTCA_TBF_RATE64
,

175 
	mTCA_TBF_PRATE64
,

176 
	mTCA_TBF_BURST
,

177 
	mTCA_TBF_PBURST
,

178 
	m__TCA_TBF_MAX
,

181 
	#TCA_TBF_MAX
 (
__TCA_TBF_MAX
 - 1)

	)

190 
	stc_sfq_qİt
 {

191 
	mquªtum
;

192 
	m³¹urb_³riod
;

193 
__u32
 
	mlim™
;

194 
	mdivisÜ
;

195 
	mæows
;

198 
	stc_sfq»d_¡©s
 {

199 
__u32
 
	m´ob_drİ
;

200 
__u32
 
	mfÜûd_drİ
;

201 
__u32
 
	m´ob_m¬k
;

202 
__u32
 
	mfÜûd_m¬k
;

203 
__u32
 
	m´ob_m¬k_h—d
;

204 
__u32
 
	mfÜûd_m¬k_h—d
;

207 
	stc_sfq_qİt_v1
 {

208 
tc_sfq_qİt
 
	mv0
;

209 
	md•th
;

210 
	mh—ddrİ
;

212 
__u32
 
	mlim™
;

213 
__u32
 
	mqth_mš
;

214 
__u32
 
	mqth_max
;

215 
	mWlog
;

216 
	mPlog
;

217 
	mSûÎ_log
;

218 
	mæags
;

219 
__u32
 
	mmax_P
;

221 
tc_sfq»d_¡©s
 
	m¡©s
;

225 
	stc_sfq_x¡©s
 {

226 
__s32
 
	m®lÙ
;

232 
	mTCA_RED_UNSPEC
,

233 
	mTCA_RED_PARMS
,

234 
	mTCA_RED_STAB
,

235 
	mTCA_RED_MAX_P
,

236 
	m__TCA_RED_MAX
,

239 
	#TCA_RED_MAX
 (
__TCA_RED_MAX
 - 1)

	)

241 
	stc_»d_qİt
 {

242 
__u32
 
	mlim™
;

243 
__u32
 
	mqth_mš
;

244 
__u32
 
	mqth_max
;

245 
	mWlog
;

246 
	mPlog
;

247 
	mSûÎ_log
;

248 
	mæags
;

249 
	#TC_RED_ECN
 1

	)

250 
	#TC_RED_HARDDROP
 2

	)

251 
	#TC_RED_ADAPTATIVE
 4

	)

254 
	stc_»d_x¡©s
 {

255 
__u32
 
	m—¾y
;

256 
__u32
 
	mpdrİ
;

257 
__u32
 
	mÙh”
;

258 
__u32
 
	mm¬ked
;

263 
	#MAX_DPs
 16

	)

266 
	mTCA_GRED_UNSPEC
,

267 
	mTCA_GRED_PARMS
,

268 
	mTCA_GRED_STAB
,

269 
	mTCA_GRED_DPS
,

270 
	mTCA_GRED_MAX_P
,

271 
	mTCA_GRED_LIMIT
,

272 
	m__TCA_GRED_MAX
,

275 
	#TCA_GRED_MAX
 (
__TCA_GRED_MAX
 - 1)

	)

277 
	stc_g»d_qİt
 {

278 
__u32
 
	mlim™
;

279 
__u32
 
	mqth_mš
;

280 
__u32
 
	mqth_max
;

281 
__u32
 
	mDP
;

282 
__u32
 
	mbacklog
;

283 
__u32
 
	mqave
;

284 
__u32
 
	mfÜûd
;

285 
__u32
 
	m—¾y
;

286 
__u32
 
	mÙh”
;

287 
__u32
 
	mpdrİ
;

288 
__u8
 
	mWlog
;

289 
__u8
 
	mPlog
;

290 
__u8
 
	mSûÎ_log
;

291 
__u8
 
	m´io
;

292 
__u32
 
	m·ck‘s
;

293 
__u32
 
	mby‹sš
;

297 
	stc_g»d_sİt
 {

298 
__u32
 
	mDPs
;

299 
__u32
 
	mdef_DP
;

300 
__u8
 
	mgrio
;

301 
__u8
 
	mæags
;

302 
__u16
 
	m·d1
;

308 
	mTCA_CHOKE_UNSPEC
,

309 
	mTCA_CHOKE_PARMS
,

310 
	mTCA_CHOKE_STAB
,

311 
	mTCA_CHOKE_MAX_P
,

312 
	m__TCA_CHOKE_MAX
,

315 
	#TCA_CHOKE_MAX
 (
__TCA_CHOKE_MAX
 - 1)

	)

317 
	stc_choke_qİt
 {

318 
__u32
 
	mlim™
;

319 
__u32
 
	mqth_mš
;

320 
__u32
 
	mqth_max
;

321 
	mWlog
;

322 
	mPlog
;

323 
	mSûÎ_log
;

324 
	mæags
;

327 
	stc_choke_x¡©s
 {

328 
__u32
 
	m—¾y
;

329 
__u32
 
	mpdrİ
;

330 
__u32
 
	mÙh”
;

331 
__u32
 
	mm¬ked
;

332 
__u32
 
	mm©ched
;

336 
	#TC_HTB_NUMPRIO
 8

	)

337 
	#TC_HTB_MAXDEPTH
 8

	)

338 
	#TC_HTB_PROTOVER
 3

	)

340 
	stc_htb_İt
 {

341 
tc_¿‹¥ec
 
	m¿‹
;

342 
tc_¿‹¥ec
 
	mû
;

343 
__u32
 
	mbufãr
;

344 
__u32
 
	mcbufãr
;

345 
__u32
 
	mquªtum
;

346 
__u32
 
	mËv–
;

347 
__u32
 
	m´io
;

349 
	stc_htb_glob
 {

350 
__u32
 
	mv”siÚ
;

351 
__u32
 
	m¿‹2quªtum
;

352 
__u32
 
	mdefşs
;

353 
__u32
 
	mdebug
;

356 
__u32
 
	mdœeù_pkts
;

359 
	mTCA_HTB_UNSPEC
,

360 
	mTCA_HTB_PARMS
,

361 
	mTCA_HTB_INIT
,

362 
	mTCA_HTB_CTAB
,

363 
	mTCA_HTB_RTAB
,

364 
	mTCA_HTB_DIRECT_QLEN
,

365 
	mTCA_HTB_RATE64
,

366 
	mTCA_HTB_CEIL64
,

367 
	m__TCA_HTB_MAX
,

370 
	#TCA_HTB_MAX
 (
__TCA_HTB_MAX
 - 1)

	)

372 
	stc_htb_x¡©s
 {

373 
__u32
 
	mËnds
;

374 
__u32
 
	mbÜrows
;

375 
__u32
 
	mgŸÁs
;

376 
__u32
 
	mtok’s
;

377 
__u32
 
	mùok’s
;

382 
	stc_hfsc_qİt
 {

383 
__u16
 
	mdefşs
;

386 
	stc_£rviû_curve
 {

387 
__u32
 
	mm1
;

388 
__u32
 
	md
;

389 
__u32
 
	mm2
;

392 
	stc_hfsc_¡©s
 {

393 
__u64
 
	mwÜk
;

394 
__u64
 
	m¹wÜk
;

395 
__u32
 
	m³riod
;

396 
__u32
 
	mËv–
;

400 
	mTCA_HFSC_UNSPEC
,

401 
	mTCA_HFSC_RSC
,

402 
	mTCA_HFSC_FSC
,

403 
	mTCA_HFSC_USC
,

404 
	m__TCA_HFSC_MAX
,

407 
	#TCA_HFSC_MAX
 (
__TCA_HFSC_MAX
 - 1)

	)

412 
	#TC_CBQ_MAXPRIO
 8

	)

413 
	#TC_CBQ_MAXLEVEL
 8

	)

414 
	#TC_CBQ_DEF_EWMA
 5

	)

416 
	stc_cbq_lssİt
 {

417 
	mchªge
;

418 
	mæags
;

419 
	#TCF_CBQ_LSS_BOUNDED
 1

	)

420 
	#TCF_CBQ_LSS_ISOLATED
 2

	)

421 
	mewma_log
;

422 
	mËv–
;

423 
	#TCF_CBQ_LSS_FLAGS
 1

	)

424 
	#TCF_CBQ_LSS_EWMA
 2

	)

425 
	#TCF_CBQ_LSS_MAXIDLE
 4

	)

426 
	#TCF_CBQ_LSS_MINIDLE
 8

	)

427 
	#TCF_CBQ_LSS_OFFTIME
 0x10

	)

428 
	#TCF_CBQ_LSS_AVPKT
 0x20

	)

429 
__u32
 
	mmaxidË
;

430 
__u32
 
	mmšidË
;

431 
__u32
 
	mofáime
;

432 
__u32
 
	mavpkt
;

435 
	stc_cbq_w¼İt
 {

436 
	mæags
;

437 
	m´iÜ™y
;

438 
	mıriÜ™y
;

439 
	m__»£rved
;

440 
__u32
 
	m®lÙ
;

441 
__u32
 
	mweight
;

444 
	stc_cbq_ovl
 {

445 
	m¡¿‹gy
;

446 
	#TC_CBQ_OVL_CLASSIC
 0

	)

447 
	#TC_CBQ_OVL_DELAY
 1

	)

448 
	#TC_CBQ_OVL_LOWPRIO
 2

	)

449 
	#TC_CBQ_OVL_DROP
 3

	)

450 
	#TC_CBQ_OVL_RCLASSIC
 4

	)

451 
	m´iÜ™y2
;

452 
__u16
 
	m·d
;

453 
__u32
 
	m³ÇÉy
;

456 
	stc_cbq_pŞiû
 {

457 
	mpŞiû
;

458 
	m__»s1
;

459 
	m__»s2
;

462 
	stc_cbq_fİt
 {

463 
__u32
 
	m¥l™
;

464 
__u32
 
	mdefm­
;

465 
__u32
 
	mdefchªge
;

468 
	stc_cbq_x¡©s
 {

469 
__u32
 
	mbÜrows
;

470 
__u32
 
	mov”aùiÚs
;

471 
__s32
 
	mavgidË
;

472 
__s32
 
	mund”time
;

476 
	mTCA_CBQ_UNSPEC
,

477 
	mTCA_CBQ_LSSOPT
,

478 
	mTCA_CBQ_WRROPT
,

479 
	mTCA_CBQ_FOPT
,

480 
	mTCA_CBQ_OVL_STRATEGY
,

481 
	mTCA_CBQ_RATE
,

482 
	mTCA_CBQ_RTAB
,

483 
	mTCA_CBQ_POLICE
,

484 
	m__TCA_CBQ_MAX
,

487 
	#TCA_CBQ_MAX
 (
__TCA_CBQ_MAX
 - 1)

	)

492 
	mTCA_DSMARK_UNSPEC
,

493 
	mTCA_DSMARK_INDICES
,

494 
	mTCA_DSMARK_DEFAULT_INDEX
,

495 
	mTCA_DSMARK_SET_TC_INDEX
,

496 
	mTCA_DSMARK_MASK
,

497 
	mTCA_DSMARK_VALUE
,

498 
	m__TCA_DSMARK_MAX
,

501 
	#TCA_DSMARK_MAX
 (
__TCA_DSMARK_MAX
 - 1)

	)

506 
	mTCA_ATM_UNSPEC
,

507 
	mTCA_ATM_FD
,

508 
	mTCA_ATM_PTR
,

509 
	mTCA_ATM_HDR
,

510 
	mTCA_ATM_EXCESS
,

511 
	mTCA_ATM_ADDR
,

512 
	mTCA_ATM_STATE
,

513 
	m__TCA_ATM_MAX
,

516 
	#TCA_ATM_MAX
 (
__TCA_ATM_MAX
 - 1)

	)

521 
	mTCA_NETEM_UNSPEC
,

522 
	mTCA_NETEM_CORR
,

523 
	mTCA_NETEM_DELAY_DIST
,

524 
	mTCA_NETEM_REORDER
,

525 
	mTCA_NETEM_CORRUPT
,

526 
	mTCA_NETEM_LOSS
,

527 
	mTCA_NETEM_RATE
,

528 
	mTCA_NETEM_ECN
,

529 
	mTCA_NETEM_RATE64
,

530 
	m__TCA_NETEM_MAX
,

533 
	#TCA_NETEM_MAX
 (
__TCA_NETEM_MAX
 - 1)

	)

535 
	stc_Ã‹m_qİt
 {

536 
__u32
 
	mÏ‹ncy
;

537 
__u32
 
	mlim™
;

538 
__u32
 
	mloss
;

539 
__u32
 
	mg­
;

540 
__u32
 
	mdu¶iÿ‹
;

541 
__u32
 
	mj™‹r
;

544 
	stc_Ã‹m_cÜr
 {

545 
__u32
 
	md–ay_cÜr
;

546 
__u32
 
	mloss_cÜr
;

547 
__u32
 
	mdup_cÜr
;

550 
	stc_Ã‹m_»Üd”
 {

551 
__u32
 
	m´obab™y
;

552 
__u32
 
	mcÜ»ÏtiÚ
;

555 
	stc_Ã‹m_cÜru±
 {

556 
__u32
 
	m´obab™y
;

557 
__u32
 
	mcÜ»ÏtiÚ
;

560 
	stc_Ã‹m_¿‹
 {

561 
__u32
 
	m¿‹
;

562 
__s32
 
	m·ck‘_ov”h—d
;

563 
__u32
 
	mûÎ_size
;

564 
__s32
 
	mûÎ_ov”h—d
;

568 
	mNETEM_LOSS_UNSPEC
,

569 
	mNETEM_LOSS_GI
,

570 
	mNETEM_LOSS_GE
,

571 
	m__NETEM_LOSS_MAX


573 
	#NETEM_LOSS_MAX
 (
__NETEM_LOSS_MAX
 - 1)

	)

576 
	stc_Ã‹m_gimod–
 {

577 
__u32
 
	mp13
;

578 
__u32
 
	mp31
;

579 
__u32
 
	mp32
;

580 
__u32
 
	mp14
;

581 
__u32
 
	mp23
;

585 
	stc_Ã‹m_gemod–
 {

586 
__u32
 
	mp
;

587 
__u32
 
	mr
;

588 
__u32
 
	mh
;

589 
__u32
 
	mk1
;

592 
	#NETEM_DIST_SCALE
 8192

	)

593 
	#NETEM_DIST_MAX
 16384

	)

598 
	mTCA_DRR_UNSPEC
,

599 
	mTCA_DRR_QUANTUM
,

600 
	m__TCA_DRR_MAX


603 
	#TCA_DRR_MAX
 (
__TCA_DRR_MAX
 - 1)

	)

605 
	stc_d¼_¡©s
 {

606 
__u32
 
	mdefic™
;

610 
	#TC_QOPT_BITMASK
 15

	)

611 
	#TC_QOPT_MAX_QUEUE
 16

	)

613 
	stc_mq´io_qİt
 {

614 
__u8
 
	mnum_tc
;

615 
__u8
 
	m´io_tc_m­
[
TC_QOPT_BITMASK
 + 1];

616 
__u8
 
	mhw
;

617 
__u16
 
	mcouÁ
[
TC_QOPT_MAX_QUEUE
];

618 
__u16
 
	moff£t
[
TC_QOPT_MAX_QUEUE
];

624 
	mTCA_SFB_UNSPEC
,

625 
	mTCA_SFB_PARMS
,

626 
	m__TCA_SFB_MAX
,

629 
	#TCA_SFB_MAX
 (
__TCA_SFB_MAX
 - 1)

	)

634 
	stc_sfb_qİt
 {

635 
__u32
 
	m»hash_š‹rv®
;

636 
__u32
 
	mw¬mup_time
;

637 
__u32
 
	mmax
;

638 
__u32
 
	mbš_size
;

639 
__u32
 
	mšüem’t
;

640 
__u32
 
	mdeüem’t
;

641 
__u32
 
	mlim™
;

642 
__u32
 
	m³ÇÉy_¿‹
;

643 
__u32
 
	m³ÇÉy_bur¡
;

646 
	stc_sfb_x¡©s
 {

647 
__u32
 
	m—¾ydrİ
;

648 
__u32
 
	m³ÇÉydrİ
;

649 
__u32
 
	mbuck‘drİ
;

650 
__u32
 
	mqueuedrİ
;

651 
__u32
 
	mchddrİ
;

652 
__u32
 
	mm¬ked
;

653 
__u32
 
	mmaxqËn
;

654 
__u32
 
	mmax´ob
;

655 
__u32
 
	mavg´ob
;

658 
	#SFB_MAX_PROB
 0xFFFF

	)

662 
	mTCA_QFQ_UNSPEC
,

663 
	mTCA_QFQ_WEIGHT
,

664 
	mTCA_QFQ_LMAX
,

665 
	m__TCA_QFQ_MAX


668 
	#TCA_QFQ_MAX
 (
__TCA_QFQ_MAX
 - 1)

	)

670 
	stc_qfq_¡©s
 {

671 
__u32
 
	mweight
;

672 
__u32
 
	mlmax
;

678 
	mTCA_CODEL_UNSPEC
,

679 
	mTCA_CODEL_TARGET
,

680 
	mTCA_CODEL_LIMIT
,

681 
	mTCA_CODEL_INTERVAL
,

682 
	mTCA_CODEL_ECN
,

683 
	mTCA_CODEL_CE_THRESHOLD
,

684 
	m__TCA_CODEL_MAX


687 
	#TCA_CODEL_MAX
 (
__TCA_CODEL_MAX
 - 1)

	)

689 
	stc_cod–_x¡©s
 {

690 
__u32
 
	mmax·ck‘
;

691 
__u32
 
	mcouÁ
;

694 
__u32
 
	mÏ¡couÁ
;

695 
__u32
 
	mld–ay
;

696 
__s32
 
	mdrİ_Ãxt
;

697 
__u32
 
	mdrİ_ov”lim™
;

698 
__u32
 
	meú_m¬k
;

699 
__u32
 
	mdrİpšg
;

700 
__u32
 
	mû_m¬k
;

706 
	mTCA_FQ_CODEL_UNSPEC
,

707 
	mTCA_FQ_CODEL_TARGET
,

708 
	mTCA_FQ_CODEL_LIMIT
,

709 
	mTCA_FQ_CODEL_INTERVAL
,

710 
	mTCA_FQ_CODEL_ECN
,

711 
	mTCA_FQ_CODEL_FLOWS
,

712 
	mTCA_FQ_CODEL_QUANTUM
,

713 
	mTCA_FQ_CODEL_CE_THRESHOLD
,

714 
	m__TCA_FQ_CODEL_MAX


717 
	#TCA_FQ_CODEL_MAX
 (
__TCA_FQ_CODEL_MAX
 - 1)

	)

720 
	mTCA_FQ_CODEL_XSTATS_QDISC
,

721 
	mTCA_FQ_CODEL_XSTATS_CLASS
,

724 
	stc_fq_cod–_qd_¡©s
 {

725 
__u32
 
	mmax·ck‘
;

726 
__u32
 
	mdrİ_ov”lim™
;

729 
__u32
 
	meú_m¬k
;

732 
__u32
 
	mÃw_æow_couÁ
;

735 
__u32
 
	mÃw_æows_Ën
;

736 
__u32
 
	mŞd_æows_Ën
;

737 
__u32
 
	mû_m¬k
;

740 
	stc_fq_cod–_ş_¡©s
 {

741 
__s32
 
	mdefic™
;

742 
__u32
 
	mld–ay
;

745 
__u32
 
	mcouÁ
;

746 
__u32
 
	mÏ¡couÁ
;

747 
__u32
 
	mdrİpšg
;

748 
__s32
 
	mdrİ_Ãxt
;

751 
	stc_fq_cod–_x¡©s
 {

752 
__u32
 
	mty³
;

754 
tc_fq_cod–_qd_¡©s
 
	mqdisc_¡©s
;

755 
tc_fq_cod–_ş_¡©s
 
	mşass_¡©s
;

762 
	mTCA_FQ_UNSPEC
,

764 
	mTCA_FQ_PLIMIT
,

766 
	mTCA_FQ_FLOW_PLIMIT
,

768 
	mTCA_FQ_QUANTUM
,

770 
	mTCA_FQ_INITIAL_QUANTUM
,

772 
	mTCA_FQ_RATE_ENABLE
,

774 
	mTCA_FQ_FLOW_DEFAULT_RATE
,

776 
	mTCA_FQ_FLOW_MAX_RATE
,

778 
	mTCA_FQ_BUCKETS_LOG
,

780 
	mTCA_FQ_FLOW_REFILL_DELAY
,

782 
	mTCA_FQ_ORPHAN_MASK
,

784 
	m__TCA_FQ_MAX


787 
	#TCA_FQ_MAX
 (
__TCA_FQ_MAX
 - 1)

	)

789 
	stc_fq_qd_¡©s
 {

790 
__u64
 
	mgc_æows
;

791 
__u64
 
	mhigh´io_·ck‘s
;

792 
__u64
 
	mtı_»Œªs
;

793 
__u64
 
	mthrÙed
;

794 
__u64
 
	mæows_¶im™
;

795 
__u64
 
	mpkts_too_lÚg
;

796 
__u64
 
	m®loÿtiÚ_”rÜs
;

797 
__s64
 
	mtime_Ãxt_d–ayed_æow
;

798 
__u32
 
	mæows
;

799 
__u32
 
	mšaùive_æows
;

800 
__u32
 
	mthrÙed_æows
;

801 
__u32
 
	m·d
;

807 
	mTCA_HHF_UNSPEC
,

808 
	mTCA_HHF_BACKLOG_LIMIT
,

809 
	mTCA_HHF_QUANTUM
,

810 
	mTCA_HHF_HH_FLOWS_LIMIT
,

811 
	mTCA_HHF_RESET_TIMEOUT
,

812 
	mTCA_HHF_ADMIT_BYTES
,

813 
	mTCA_HHF_EVICT_TIMEOUT
,

814 
	mTCA_HHF_NON_HH_WEIGHT
,

815 
	m__TCA_HHF_MAX


818 
	#TCA_HHF_MAX
 (
__TCA_HHF_MAX
 - 1)

	)

820 
	stc_hhf_x¡©s
 {

821 
__u32
 
	mdrİ_ov”lim™
;

824 
__u32
 
	mhh_ov”lim™
;

825 
__u32
 
	mhh_tÙ_couÁ
;

826 
__u32
 
	mhh_cur_couÁ
;

831 
	mTCA_PIE_UNSPEC
,

832 
	mTCA_PIE_TARGET
,

833 
	mTCA_PIE_LIMIT
,

834 
	mTCA_PIE_TUPDATE
,

835 
	mTCA_PIE_ALPHA
,

836 
	mTCA_PIE_BETA
,

837 
	mTCA_PIE_ECN
,

838 
	mTCA_PIE_BYTEMODE
,

839 
	m__TCA_PIE_MAX


841 
	#TCA_PIE_MAX
 (
__TCA_PIE_MAX
 - 1)

	)

843 
	stc_p›_x¡©s
 {

844 
__u32
 
	m´ob
;

845 
__u32
 
	md–ay
;

846 
__u32
 
	mavg_dq_¿‹
;

847 
__u32
 
	m·ck‘s_š
;

848 
__u32
 
	mdrİ³d
;

849 
__u32
 
	mov”lim™
;

850 
__u32
 
	mmaxq
;

851 
__u32
 
	meú_m¬k
;

	@/usr/include/linux/rose.h

7 #iâdef 
ROSE_KERNEL_H


8 
	#ROSE_KERNEL_H


	)

10 
	~<lšux/sock‘.h
>

11 
	~<lšux/ax25.h
>

13 
	#ROSE_MTU
 251

	)

15 
	#ROSE_MAX_DIGIS
 6

	)

17 
	#ROSE_DEFER
 1

	)

18 
	#ROSE_T1
 2

	)

19 
	#ROSE_T2
 3

	)

20 
	#ROSE_T3
 4

	)

21 
	#ROSE_IDLE
 5

	)

22 
	#ROSE_QBITINCL
 6

	)

23 
	#ROSE_HOLDBACK
 7

	)

25 
	#SIOCRSGCAUSE
 (
SIOCPROTOPRIVATE
+0)

	)

26 
	#SIOCRSSCAUSE
 (
SIOCPROTOPRIVATE
+1)

	)

27 
	#SIOCRSL2CALL
 (
SIOCPROTOPRIVATE
+2)

	)

28 
	#SIOCRSSL2CALL
 (
SIOCPROTOPRIVATE
+2)

	)

29 
	#SIOCRSACCEPT
 (
SIOCPROTOPRIVATE
+3)

	)

30 
	#SIOCRSCLRRT
 (
SIOCPROTOPRIVATE
+4)

	)

31 
	#SIOCRSGL2CALL
 (
SIOCPROTOPRIVATE
+5)

	)

32 
	#SIOCRSGFACILITIES
 (
SIOCPROTOPRIVATE
+6)

	)

34 
	#ROSE_DTE_ORIGINATED
 0x00

	)

35 
	#ROSE_NUMBER_BUSY
 0x01

	)

36 
	#ROSE_INVALID_FACILITY
 0x03

	)

37 
	#ROSE_NETWORK_CONGESTION
 0x05

	)

38 
	#ROSE_OUT_OF_ORDER
 0x09

	)

39 
	#ROSE_ACCESS_BARRED
 0x0B

	)

40 
	#ROSE_NOT_OBTAINABLE
 0x0D

	)

41 
	#ROSE_REMOTE_PROCEDURE
 0x11

	)

42 
	#ROSE_LOCAL_PROCEDURE
 0x13

	)

43 
	#ROSE_SHIP_ABSENT
 0x39

	)

46 
	mro£_addr
[5];

47 } 
	tro£_add»ss
;

49 
	ssockaddr_ro£
 {

50 
__k”Ãl_§_çmy_t
 
	m¤o£_çmy
;

51 
ro£_add»ss
 
	m¤o£_addr
;

52 
ax25_add»ss
 
	m¤o£_ÿÎ
;

53 
	m¤o£_ndigis
;

54 
ax25_add»ss
 
	m¤o£_digi
;

57 
	sfuÎ_sockaddr_ro£
 {

58 
__k”Ãl_§_çmy_t
 
	m¤o£_çmy
;

59 
ro£_add»ss
 
	m¤o£_addr
;

60 
ax25_add»ss
 
	m¤o£_ÿÎ
;

61 
	m¤o£_ndigis
;

62 
ax25_add»ss
 
	m¤o£_digis
[
ROSE_MAX_DIGIS
];

65 
	sro£_rou‹_¡ruù
 {

66 
ro£_add»ss
 
	madd»ss
;

67 
	mmask
;

68 
ax25_add»ss
 
	mÃighbour
;

69 
	mdeviû
[16];

70 
	mndigis
;

71 
ax25_add»ss
 
	mdig—‹rs
[
AX25_MAX_DIGIS
];

74 
	sro£_ÿu£_¡ruù
 {

75 
	mÿu£
;

76 
	mdŸgno¡ic
;

79 
	sro£_çc™›s_¡ruù
 {

80 
ro£_add»ss
 
	msourû_addr
, 
	mde¡_addr
;

81 
ax25_add»ss
 
	msourû_ÿÎ
, 
	mde¡_ÿÎ
;

82 
	msourû_ndigis
, 
	mde¡_ndigis
;

83 
ax25_add»ss
 
	msourû_digis
[
ROSE_MAX_DIGIS
];

84 
ax25_add»ss
 
	mde¡_digis
[
ROSE_MAX_DIGIS
];

85 
	m¿nd
;

86 
ro£_add»ss
 
	mç_addr
;

87 
ax25_add»ss
 
	mç_ÿÎ
;

	@/usr/include/linux/rtnetlink.h

1 #iâdeà
__LINUX_RTNETLINK_H


2 
	#__LINUX_RTNETLINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

6 
	~<lšux/if_lšk.h
>

7 
	~<lšux/if_addr.h
>

8 
	~<lšux/Ãighbour.h
>

13 
	#RTNL_FAMILY_IPMR
 128

	)

14 
	#RTNL_FAMILY_IP6MR
 129

	)

15 
	#RTNL_FAMILY_MAX
 129

	)

24 
	mRTM_BASE
 = 16,

25 
	#RTM_BASE
 
RTM_BASE


	)

27 
	mRTM_NEWLINK
 = 16,

28 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

29 
	mRTM_DELLINK
,

30 
	#RTM_DELLINK
 
RTM_DELLINK


	)

31 
	mRTM_GETLINK
,

32 
	#RTM_GETLINK
 
RTM_GETLINK


	)

33 
	mRTM_SETLINK
,

34 
	#RTM_SETLINK
 
RTM_SETLINK


	)

36 
	mRTM_NEWADDR
 = 20,

37 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

38 
	mRTM_DELADDR
,

39 
	#RTM_DELADDR
 
RTM_DELADDR


	)

40 
	mRTM_GETADDR
,

41 
	#RTM_GETADDR
 
RTM_GETADDR


	)

43 
	mRTM_NEWROUTE
 = 24,

44 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

45 
	mRTM_DELROUTE
,

46 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

47 
	mRTM_GETROUTE
,

48 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

50 
	mRTM_NEWNEIGH
 = 28,

51 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

52 
	mRTM_DELNEIGH
,

53 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

54 
	mRTM_GETNEIGH
,

55 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

57 
	mRTM_NEWRULE
 = 32,

58 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

59 
	mRTM_DELRULE
,

60 
	#RTM_DELRULE
 
RTM_DELRULE


	)

61 
	mRTM_GETRULE
,

62 
	#RTM_GETRULE
 
RTM_GETRULE


	)

64 
	mRTM_NEWQDISC
 = 36,

65 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

66 
	mRTM_DELQDISC
,

67 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

68 
	mRTM_GETQDISC
,

69 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

71 
	mRTM_NEWTCLASS
 = 40,

72 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

73 
	mRTM_DELTCLASS
,

74 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

75 
	mRTM_GETTCLASS
,

76 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

78 
	mRTM_NEWTFILTER
 = 44,

79 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

80 
	mRTM_DELTFILTER
,

81 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

82 
	mRTM_GETTFILTER
,

83 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

85 
	mRTM_NEWACTION
 = 48,

86 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

87 
	mRTM_DELACTION
,

88 
	#RTM_DELACTION
 
RTM_DELACTION


	)

89 
	mRTM_GETACTION
,

90 
	#RTM_GETACTION
 
RTM_GETACTION


	)

92 
	mRTM_NEWPREFIX
 = 52,

93 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

95 
	mRTM_GETMULTICAST
 = 58,

96 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

98 
	mRTM_GETANYCAST
 = 62,

99 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

101 
	mRTM_NEWNEIGHTBL
 = 64,

102 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

103 
	mRTM_GETNEIGHTBL
 = 66,

104 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

105 
	mRTM_SETNEIGHTBL
,

106 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

108 
	mRTM_NEWNDUSEROPT
 = 68,

109 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

111 
	mRTM_NEWADDRLABEL
 = 72,

112 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

113 
	mRTM_DELADDRLABEL
,

114 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

115 
	mRTM_GETADDRLABEL
,

116 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

118 
	mRTM_GETDCB
 = 78,

119 
	#RTM_GETDCB
 
RTM_GETDCB


	)

120 
	mRTM_SETDCB
,

121 
	#RTM_SETDCB
 
RTM_SETDCB


	)

123 
	mRTM_NEWNETCONF
 = 80,

124 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

125 
	mRTM_GETNETCONF
 = 82,

126 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

128 
	mRTM_NEWMDB
 = 84,

129 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

130 
	mRTM_DELMDB
 = 85,

131 
	#RTM_DELMDB
 
RTM_DELMDB


	)

132 
	mRTM_GETMDB
 = 86,

133 
	#RTM_GETMDB
 
RTM_GETMDB


	)

135 
	mRTM_NEWNSID
 = 88,

136 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

137 
	mRTM_DELNSID
 = 89,

138 
	#RTM_DELNSID
 
RTM_DELNSID


	)

139 
	mRTM_GETNSID
 = 90,

140 
	#RTM_GETNSID
 
RTM_GETNSID


	)

142 
	m__RTM_MAX
,

143 
	#RTM_MAX
 (((
__RTM_MAX
 + 3è& ~3è- 1)

	)

146 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

147 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

148 
	#RTM_FAM
(
cmd
è(((cmdè- 
RTM_BASE
è>> 2)

	)

156 
	s¹©Œ
 {

157 
	m¹a_Ën
;

158 
	m¹a_ty³
;

163 
	#RTA_ALIGNTO
 4U

	)

164 
	#RTA_ALIGN
(
Ën
èĞ(Ö’)+
RTA_ALIGNTO
-1è& ~(RTA_ALIGNTO-1è)

	)

165 
	#RTA_OK
(
¹a
,
Ën
è(Ö’è>ğ()(
¹©Œ
) && \

166 (
¹a
)->
¹a_Ën
 >ğ(
¹©Œ
) && \

167 (
¹a
)->
¹a_Ën
 <ğ(
Ën
))

	)

168 
	#RTA_NEXT
(
¹a
,
©ŒËn
è(×‰¾’è-ğ
	`RTA_ALIGN
(Ô)->
¹a_Ën
), \

169 (
¹©Œ
*)(((*)(
¹a
)è+ 
	`RTA_ALIGN
(Ô)->
¹a_Ën
)))

	)

170 
	#RTA_LENGTH
(
Ën
è(
	`RTA_ALIGN
((
¹©Œ
)è+ (Ën))

	)

171 
	#RTA_SPACE
(
Ën
è
	`RTA_ALIGN
(
	`RTA_LENGTH
Ö’))

	)

172 
	#RTA_DATA
(
¹a
è((*)(((*)Ô)è+ 
	`RTA_LENGTH
(0)))

	)

173 
	#RTA_PAYLOAD
(
¹a
è(()(Ô)->
¹a_Ën
è- 
	`RTA_LENGTH
(0))

	)

182 
	s¹msg
 {

183 
	m¹m_çmy
;

184 
	m¹m_d¡_Ën
;

185 
	m¹m_¤c_Ën
;

186 
	m¹m_tos
;

188 
	m¹m_bË
;

189 
	m¹m_´ÙocŞ
;

190 
	m¹m_scİe
;

191 
	m¹m_ty³
;

193 
	m¹m_æags
;

199 
	mRTN_UNSPEC
,

200 
	mRTN_UNICAST
,

201 
	mRTN_LOCAL
,

202 
	mRTN_BROADCAST
,

204 
	mRTN_ANYCAST
,

206 
	mRTN_MULTICAST
,

207 
	mRTN_BLACKHOLE
,

208 
	mRTN_UNREACHABLE
,

209 
	mRTN_PROHIBIT
,

210 
	mRTN_THROW
,

211 
	mRTN_NAT
,

212 
	mRTN_XRESOLVE
,

213 
	m__RTN_MAX


216 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

221 
	#RTPROT_UNSPEC
 0

	)

222 
	#RTPROT_REDIRECT
 1

	)

224 
	#RTPROT_KERNEL
 2

	)

225 
	#RTPROT_BOOT
 3

	)

226 
	#RTPROT_STATIC
 4

	)

235 
	#RTPROT_GATED
 8

	)

236 
	#RTPROT_RA
 9

	)

237 
	#RTPROT_MRT
 10

	)

238 
	#RTPROT_ZEBRA
 11

	)

239 
	#RTPROT_BIRD
 12

	)

240 
	#RTPROT_DNROUTED
 13

	)

241 
	#RTPROT_XORP
 14

	)

242 
	#RTPROT_NTK
 15

	)

243 
	#RTPROT_DHCP
 16

	)

244 
	#RTPROT_MROUTED
 17

	)

245 
	#RTPROT_BABEL
 42

	)

258 
	e¹_scİe_t
 {

259 
	mRT_SCOPE_UNIVERSE
=0,

261 
	mRT_SCOPE_SITE
=200,

262 
	mRT_SCOPE_LINK
=253,

263 
	mRT_SCOPE_HOST
=254,

264 
	mRT_SCOPE_NOWHERE
=255

269 
	#RTM_F_NOTIFY
 0x100

	)

270 
	#RTM_F_CLONED
 0x200

	)

271 
	#RTM_F_EQUALIZE
 0x400

	)

272 
	#RTM_F_PREFIX
 0x800

	)

273 
	#RTM_F_LOOKUP_TABLE
 0x1000

	)

277 
	e¹_şass_t
 {

278 
	mRT_TABLE_UNSPEC
=0,

280 
	mRT_TABLE_COMPAT
=252,

281 
	mRT_TABLE_DEFAULT
=253,

282 
	mRT_TABLE_MAIN
=254,

283 
	mRT_TABLE_LOCAL
=255,

284 
	mRT_TABLE_MAX
=0xFFFFFFFF

290 
	e¹©Œ_ty³_t
 {

291 
	mRTA_UNSPEC
,

292 
	mRTA_DST
,

293 
	mRTA_SRC
,

294 
	mRTA_IIF
,

295 
	mRTA_OIF
,

296 
	mRTA_GATEWAY
,

297 
	mRTA_PRIORITY
,

298 
	mRTA_PREFSRC
,

299 
	mRTA_METRICS
,

300 
	mRTA_MULTIPATH
,

301 
	mRTA_PROTOINFO
,

302 
	mRTA_FLOW
,

303 
	mRTA_CACHEINFO
,

304 
	mRTA_SESSION
,

305 
	mRTA_MP_ALGO
,

306 
	mRTA_TABLE
,

307 
	mRTA_MARK
,

308 
	mRTA_MFC_STATS
,

309 
	mRTA_VIA
,

310 
	mRTA_NEWDST
,

311 
	mRTA_PREF
,

312 
	mRTA_ENCAP_TYPE
,

313 
	mRTA_ENCAP
,

314 
	m__RTA_MAX


317 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

319 
	#RTM_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
¹msg
))))

	)

320 
	#RTM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
¹msg
))

	)

331 
	s¹Ãxthİ
 {

332 
	m¹nh_Ën
;

333 
	m¹nh_æags
;

334 
	m¹nh_hİs
;

335 
	m¹nh_ifšdex
;

340 
	#RTNH_F_DEAD
 1

	)

341 
	#RTNH_F_PERVASIVE
 2

	)

342 
	#RTNH_F_ONLINK
 4

	)

343 
	#RTNH_F_OFFLOAD
 8

	)

344 
	#RTNH_F_LINKDOWN
 16

	)

346 
	#RTNH_COMPARE_MASK
 (
RTNH_F_DEAD
 | 
RTNH_F_LINKDOWN
 | 
RTNH_F_OFFLOAD
)

	)

350 
	#RTNH_ALIGNTO
 4

	)

351 
	#RTNH_ALIGN
(
Ën
èĞ(Ö’)+
RTNH_ALIGNTO
-1è& ~(RTNH_ALIGNTO-1è)

	)

352 
	#RTNH_OK
(
¹nh
,
Ën
è(ÔŠh)->
¹nh_Ën
 >ğ(
¹Ãxthİ
) && \

353 (()(
¹nh
)->
¹nh_Ën
è<ğ(
Ën
))

	)

354 
	#RTNH_NEXT
(
¹nh
è((
¹Ãxthİ
*)(((*)ÔŠh)è+ 
	`RTNH_ALIGN
(ÔŠh)->
¹nh_Ën
)))

	)

355 
	#RTNH_LENGTH
(
Ën
è(
	`RTNH_ALIGN
((
¹Ãxthİ
)è+ (Ën))

	)

356 
	#RTNH_SPACE
(
Ën
è
	`RTNH_ALIGN
(
	`RTNH_LENGTH
Ö’))

	)

357 
	#RTNH_DATA
(
¹nh
è((
¹©Œ
*)(((*)ÔŠh)è+ 
	`RTNH_LENGTH
(0)))

	)

360 
	s¹vŸ
 {

361 
__k”Ãl_§_çmy_t
 
	m¹vŸ_çmy
;

362 
__u8
 
	m¹vŸ_addr
[0];

367 
	s¹a_ÿchešfo
 {

368 
__u32
 
	m¹a_şÁ»f
;

369 
__u32
 
	m¹a_Ï¡u£
;

370 
__s32
 
	m¹a_expœes
;

371 
__u32
 
	m¹a_”rÜ
;

372 
__u32
 
	m¹a_u£d
;

374 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

375 
__u32
 
	m¹a_id
;

376 
__u32
 
	m¹a_ts
;

377 
__u32
 
	m¹a_t§ge
;

383 
	mRTAX_UNSPEC
,

384 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

385 
	mRTAX_LOCK
,

386 
	#RTAX_LOCK
 
RTAX_LOCK


	)

387 
	mRTAX_MTU
,

388 
	#RTAX_MTU
 
RTAX_MTU


	)

389 
	mRTAX_WINDOW
,

390 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

391 
	mRTAX_RTT
,

392 
	#RTAX_RTT
 
RTAX_RTT


	)

393 
	mRTAX_RTTVAR
,

394 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

395 
	mRTAX_SSTHRESH
,

396 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

397 
	mRTAX_CWND
,

398 
	#RTAX_CWND
 
RTAX_CWND


	)

399 
	mRTAX_ADVMSS
,

400 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

401 
	mRTAX_REORDERING
,

402 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

403 
	mRTAX_HOPLIMIT
,

404 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

405 
	mRTAX_INITCWND
,

406 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

407 
	mRTAX_FEATURES
,

408 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

409 
	mRTAX_RTO_MIN
,

410 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

411 
	mRTAX_INITRWND
,

412 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

413 
	mRTAX_QUICKACK
,

414 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

415 
	mRTAX_CC_ALGO
,

416 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

417 
	m__RTAX_MAX


420 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

422 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

423 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

424 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

425 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

427 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

428 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

430 
	s¹a_£ssiÚ
 {

431 
__u8
 
	m´Ùo
;

432 
__u8
 
	m·d1
;

433 
__u16
 
	m·d2
;

437 
__u16
 
	m¥Üt
;

438 
__u16
 
	mdpÜt
;

439 } 
	mpÜts
;

442 
__u8
 
	mty³
;

443 
__u8
 
	mcode
;

444 
__u16
 
	mid’t
;

445 } 
	micm±
;

447 
__u32
 
	m¥i
;

448 } 
	mu
;

451 
	s¹a_mfc_¡©s
 {

452 
__u64
 
	mmfcs_·ck‘s
;

453 
__u64
 
	mmfcs_by‹s
;

454 
__u64
 
	mmfcs_wrÚg_if
;

461 
	s¹g’msg
 {

462 
	m¹g’_çmy
;

474 
	sifšfomsg
 {

475 
	mifi_çmy
;

476 
	m__ifi_·d
;

477 
	mifi_ty³
;

478 
	mifi_šdex
;

479 
	mifi_æags
;

480 
	mifi_chªge
;

487 
	s´efixmsg
 {

488 
	m´efix_çmy
;

489 
	m´efix_·d1
;

490 
	m´efix_·d2
;

491 
	m´efix_ifšdex
;

492 
	m´efix_ty³
;

493 
	m´efix_Ën
;

494 
	m´efix_æags
;

495 
	m´efix_·d3
;

500 
	mPREFIX_UNSPEC
,

501 
	mPREFIX_ADDRESS
,

502 
	mPREFIX_CACHEINFO
,

503 
	m__PREFIX_MAX


506 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

508 
	s´efix_ÿchešfo
 {

509 
__u32
 
	m´eã¼ed_time
;

510 
__u32
 
	mv®id_time
;

518 
	stcmsg
 {

519 
	mtcm_çmy
;

520 
	mtcm__·d1
;

521 
	mtcm__·d2
;

522 
	mtcm_ifšdex
;

523 
__u32
 
	mtcm_hªdË
;

524 
__u32
 
	mtcm_·»Á
;

525 
__u32
 
	mtcm_šfo
;

529 
	mTCA_UNSPEC
,

530 
	mTCA_KIND
,

531 
	mTCA_OPTIONS
,

532 
	mTCA_STATS
,

533 
	mTCA_XSTATS
,

534 
	mTCA_RATE
,

535 
	mTCA_FCNT
,

536 
	mTCA_STATS2
,

537 
	mTCA_STAB
,

538 
	m__TCA_MAX


541 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

543 
	#TCA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

544 
	#TCA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tcmsg
))

	)

550 
	sndu£rİtmsg
 {

551 
	mndu£rİt_çmy
;

552 
	mndu£rİt_·d1
;

553 
	mndu£rİt_İts_Ën
;

554 
	mndu£rİt_ifšdex
;

555 
__u8
 
	mndu£rİt_icmp_ty³
;

556 
__u8
 
	mndu£rİt_icmp_code
;

557 
	mndu£rİt_·d2
;

558 
	mndu£rİt_·d3
;

563 
	mNDUSEROPT_UNSPEC
,

564 
	mNDUSEROPT_SRCADDR
,

565 
	m__NDUSEROPT_MAX


568 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

571 
	#RTMGRP_LINK
 1

	)

572 
	#RTMGRP_NOTIFY
 2

	)

573 
	#RTMGRP_NEIGH
 4

	)

574 
	#RTMGRP_TC
 8

	)

576 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

577 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

578 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

579 
	#RTMGRP_IPV4_RULE
 0x80

	)

581 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

582 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

583 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

584 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

586 
	#RTMGRP_DECÃt_IFADDR
 0x1000

	)

587 
	#RTMGRP_DECÃt_ROUTE
 0x4000

	)

589 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

592 
	e¹Ãšk_groups
 {

593 
	mRTNLGRP_NONE
,

594 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

595 
	mRTNLGRP_LINK
,

596 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

597 
	mRTNLGRP_NOTIFY
,

598 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

599 
	mRTNLGRP_NEIGH
,

600 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

601 
	mRTNLGRP_TC
,

602 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

603 
	mRTNLGRP_IPV4_IFADDR
,

604 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

605 
	mRTNLGRP_IPV4_MROUTE
,

606 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

607 
	mRTNLGRP_IPV4_ROUTE
,

608 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

609 
	mRTNLGRP_IPV4_RULE
,

610 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

611 
	mRTNLGRP_IPV6_IFADDR
,

612 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

613 
	mRTNLGRP_IPV6_MROUTE
,

614 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

615 
	mRTNLGRP_IPV6_ROUTE
,

616 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

617 
	mRTNLGRP_IPV6_IFINFO
,

618 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

619 
	mRTNLGRP_DECÃt_IFADDR
,

620 
	#RTNLGRP_DECÃt_IFADDR
 
RTNLGRP_DECÃt_IFADDR


	)

621 
	mRTNLGRP_NOP2
,

622 
	mRTNLGRP_DECÃt_ROUTE
,

623 
	#RTNLGRP_DECÃt_ROUTE
 
RTNLGRP_DECÃt_ROUTE


	)

624 
	mRTNLGRP_DECÃt_RULE
,

625 
	#RTNLGRP_DECÃt_RULE
 
RTNLGRP_DECÃt_RULE


	)

626 
	mRTNLGRP_NOP4
,

627 
	mRTNLGRP_IPV6_PREFIX
,

628 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

629 
	mRTNLGRP_IPV6_RULE
,

630 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

631 
	mRTNLGRP_ND_USEROPT
,

632 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

633 
	mRTNLGRP_PHONET_IFADDR
,

634 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

635 
	mRTNLGRP_PHONET_ROUTE
,

636 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

637 
	mRTNLGRP_DCB
,

638 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

639 
	mRTNLGRP_IPV4_NETCONF
,

640 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

641 
	mRTNLGRP_IPV6_NETCONF
,

642 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

643 
	mRTNLGRP_MDB
,

644 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

645 
	mRTNLGRP_MPLS_ROUTE
,

646 
	#RTNLGRP_MPLS_ROUTE
 
RTNLGRP_MPLS_ROUTE


	)

647 
	mRTNLGRP_NSID
,

648 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

649 
	m__RTNLGRP_MAX


651 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

654 
	stÿmsg
 {

655 
	mtÿ_çmy
;

656 
	mtÿ__·d1
;

657 
	mtÿ__·d2
;

659 
	#TA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tÿmsg
))))

	)

660 
	#TA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tÿmsg
))

	)

661 
	#TCA_ACT_TAB
 1

	)

662 
	#TCAA_MAX
 1

	)

665 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

666 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

667 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

668 
	#RTEXT_FILTER_SKIP_STATS
 (1 << 3)

	)

	@/usr/include/linux/snmp.h

7 #iâdeà
_LINUX_SNMP_H


8 
	#_LINUX_SNMP_H


	)

20 
	mIPSTATS_MIB_NUM
 = 0,

22 
	mIPSTATS_MIB_INPKTS
,

23 
	mIPSTATS_MIB_INOCTETS
,

24 
	mIPSTATS_MIB_INDELIVERS
,

25 
	mIPSTATS_MIB_OUTFORWDATAGRAMS
,

26 
	mIPSTATS_MIB_OUTPKTS
,

27 
	mIPSTATS_MIB_OUTOCTETS
,

29 
	mIPSTATS_MIB_INHDRERRORS
,

30 
	mIPSTATS_MIB_INTOOBIGERRORS
,

31 
	mIPSTATS_MIB_INNOROUTES
,

32 
	mIPSTATS_MIB_INADDRERRORS
,

33 
	mIPSTATS_MIB_INUNKNOWNPROTOS
,

34 
	mIPSTATS_MIB_INTRUNCATEDPKTS
,

35 
	mIPSTATS_MIB_INDISCARDS
,

36 
	mIPSTATS_MIB_OUTDISCARDS
,

37 
	mIPSTATS_MIB_OUTNOROUTES
,

38 
	mIPSTATS_MIB_REASMTIMEOUT
,

39 
	mIPSTATS_MIB_REASMREQDS
,

40 
	mIPSTATS_MIB_REASMOKS
,

41 
	mIPSTATS_MIB_REASMFAILS
,

42 
	mIPSTATS_MIB_FRAGOKS
,

43 
	mIPSTATS_MIB_FRAGFAILS
,

44 
	mIPSTATS_MIB_FRAGCREATES
,

45 
	mIPSTATS_MIB_INMCASTPKTS
,

46 
	mIPSTATS_MIB_OUTMCASTPKTS
,

47 
	mIPSTATS_MIB_INBCASTPKTS
,

48 
	mIPSTATS_MIB_OUTBCASTPKTS
,

49 
	mIPSTATS_MIB_INMCASTOCTETS
,

50 
	mIPSTATS_MIB_OUTMCASTOCTETS
,

51 
	mIPSTATS_MIB_INBCASTOCTETS
,

52 
	mIPSTATS_MIB_OUTBCASTOCTETS
,

53 
	mIPSTATS_MIB_CSUMERRORS
,

54 
	mIPSTATS_MIB_NOECTPKTS
,

55 
	mIPSTATS_MIB_ECT1PKTS
,

56 
	mIPSTATS_MIB_ECT0PKTS
,

57 
	mIPSTATS_MIB_CEPKTS
,

58 
	m__IPSTATS_MIB_MAX


68 
	mICMP_MIB_NUM
 = 0,

69 
	mICMP_MIB_INMSGS
,

70 
	mICMP_MIB_INERRORS
,

71 
	mICMP_MIB_INDESTUNREACHS
,

72 
	mICMP_MIB_INTIMEEXCDS
,

73 
	mICMP_MIB_INPARMPROBS
,

74 
	mICMP_MIB_INSRCQUENCHS
,

75 
	mICMP_MIB_INREDIRECTS
,

76 
	mICMP_MIB_INECHOS
,

77 
	mICMP_MIB_INECHOREPS
,

78 
	mICMP_MIB_INTIMESTAMPS
,

79 
	mICMP_MIB_INTIMESTAMPREPS
,

80 
	mICMP_MIB_INADDRMASKS
,

81 
	mICMP_MIB_INADDRMASKREPS
,

82 
	mICMP_MIB_OUTMSGS
,

83 
	mICMP_MIB_OUTERRORS
,

84 
	mICMP_MIB_OUTDESTUNREACHS
,

85 
	mICMP_MIB_OUTTIMEEXCDS
,

86 
	mICMP_MIB_OUTPARMPROBS
,

87 
	mICMP_MIB_OUTSRCQUENCHS
,

88 
	mICMP_MIB_OUTREDIRECTS
,

89 
	mICMP_MIB_OUTECHOS
,

90 
	mICMP_MIB_OUTECHOREPS
,

91 
	mICMP_MIB_OUTTIMESTAMPS
,

92 
	mICMP_MIB_OUTTIMESTAMPREPS
,

93 
	mICMP_MIB_OUTADDRMASKS
,

94 
	mICMP_MIB_OUTADDRMASKREPS
,

95 
	mICMP_MIB_CSUMERRORS
,

96 
	m__ICMP_MIB_MAX


99 
	#__ICMPMSG_MIB_MAX
 512

	)

107 
	mICMP6_MIB_NUM
 = 0,

108 
	mICMP6_MIB_INMSGS
,

109 
	mICMP6_MIB_INERRORS
,

110 
	mICMP6_MIB_OUTMSGS
,

111 
	mICMP6_MIB_OUTERRORS
,

112 
	mICMP6_MIB_CSUMERRORS
,

113 
	m__ICMP6_MIB_MAX


116 
	#__ICMP6MSG_MIB_MAX
 512

	)

125 
	mTCP_MIB_NUM
 = 0,

126 
	mTCP_MIB_RTOALGORITHM
,

127 
	mTCP_MIB_RTOMIN
,

128 
	mTCP_MIB_RTOMAX
,

129 
	mTCP_MIB_MAXCONN
,

130 
	mTCP_MIB_ACTIVEOPENS
,

131 
	mTCP_MIB_PASSIVEOPENS
,

132 
	mTCP_MIB_ATTEMPTFAILS
,

133 
	mTCP_MIB_ESTABRESETS
,

134 
	mTCP_MIB_CURRESTAB
,

135 
	mTCP_MIB_INSEGS
,

136 
	mTCP_MIB_OUTSEGS
,

137 
	mTCP_MIB_RETRANSSEGS
,

138 
	mTCP_MIB_INERRS
,

139 
	mTCP_MIB_OUTRSTS
,

140 
	mTCP_MIB_CSUMERRORS
,

141 
	m__TCP_MIB_MAX


151 
	mUDP_MIB_NUM
 = 0,

152 
	mUDP_MIB_INDATAGRAMS
,

153 
	mUDP_MIB_NOPORTS
,

154 
	mUDP_MIB_INERRORS
,

155 
	mUDP_MIB_OUTDATAGRAMS
,

156 
	mUDP_MIB_RCVBUFERRORS
,

157 
	mUDP_MIB_SNDBUFERRORS
,

158 
	mUDP_MIB_CSUMERRORS
,

159 
	mUDP_MIB_IGNOREDMULTI
,

160 
	m__UDP_MIB_MAX


166 
	mLINUX_MIB_NUM
 = 0,

167 
	mLINUX_MIB_SYNCOOKIESSENT
,

168 
	mLINUX_MIB_SYNCOOKIESRECV
,

169 
	mLINUX_MIB_SYNCOOKIESFAILED
,

170 
	mLINUX_MIB_EMBRYONICRSTS
,

171 
	mLINUX_MIB_PRUNECALLED
,

172 
	mLINUX_MIB_RCVPRUNED
,

173 
	mLINUX_MIB_OFOPRUNED
,

174 
	mLINUX_MIB_OUTOFWINDOWICMPS
,

175 
	mLINUX_MIB_LOCKDROPPEDICMPS
,

176 
	mLINUX_MIB_ARPFILTER
,

177 
	mLINUX_MIB_TIMEWAITED
,

178 
	mLINUX_MIB_TIMEWAITRECYCLED
,

179 
	mLINUX_MIB_TIMEWAITKILLED
,

180 
	mLINUX_MIB_PAWSPASSIVEREJECTED
,

181 
	mLINUX_MIB_PAWSACTIVEREJECTED
,

182 
	mLINUX_MIB_PAWSESTABREJECTED
,

183 
	mLINUX_MIB_DELAYEDACKS
,

184 
	mLINUX_MIB_DELAYEDACKLOCKED
,

185 
	mLINUX_MIB_DELAYEDACKLOST
,

186 
	mLINUX_MIB_LISTENOVERFLOWS
,

187 
	mLINUX_MIB_LISTENDROPS
,

188 
	mLINUX_MIB_TCPPREQUEUED
,

189 
	mLINUX_MIB_TCPDIRECTCOPYFROMBACKLOG
,

190 
	mLINUX_MIB_TCPDIRECTCOPYFROMPREQUEUE
,

191 
	mLINUX_MIB_TCPPREQUEUEDROPPED
,

192 
	mLINUX_MIB_TCPHPHITS
,

193 
	mLINUX_MIB_TCPHPHITSTOUSER
,

194 
	mLINUX_MIB_TCPPUREACKS
,

195 
	mLINUX_MIB_TCPHPACKS
,

196 
	mLINUX_MIB_TCPRENORECOVERY
,

197 
	mLINUX_MIB_TCPSACKRECOVERY
,

198 
	mLINUX_MIB_TCPSACKRENEGING
,

199 
	mLINUX_MIB_TCPFACKREORDER
,

200 
	mLINUX_MIB_TCPSACKREORDER
,

201 
	mLINUX_MIB_TCPRENOREORDER
,

202 
	mLINUX_MIB_TCPTSREORDER
,

203 
	mLINUX_MIB_TCPFULLUNDO
,

204 
	mLINUX_MIB_TCPPARTIALUNDO
,

205 
	mLINUX_MIB_TCPDSACKUNDO
,

206 
	mLINUX_MIB_TCPLOSSUNDO
,

207 
	mLINUX_MIB_TCPLOSTRETRANSMIT
,

208 
	mLINUX_MIB_TCPRENOFAILURES
,

209 
	mLINUX_MIB_TCPSACKFAILURES
,

210 
	mLINUX_MIB_TCPLOSSFAILURES
,

211 
	mLINUX_MIB_TCPFASTRETRANS
,

212 
	mLINUX_MIB_TCPFORWARDRETRANS
,

213 
	mLINUX_MIB_TCPSLOWSTARTRETRANS
,

214 
	mLINUX_MIB_TCPTIMEOUTS
,

215 
	mLINUX_MIB_TCPLOSSPROBES
,

216 
	mLINUX_MIB_TCPLOSSPROBERECOVERY
,

217 
	mLINUX_MIB_TCPRENORECOVERYFAIL
,

218 
	mLINUX_MIB_TCPSACKRECOVERYFAIL
,

219 
	mLINUX_MIB_TCPSCHEDULERFAILED
,

220 
	mLINUX_MIB_TCPRCVCOLLAPSED
,

221 
	mLINUX_MIB_TCPDSACKOLDSENT
,

222 
	mLINUX_MIB_TCPDSACKOFOSENT
,

223 
	mLINUX_MIB_TCPDSACKRECV
,

224 
	mLINUX_MIB_TCPDSACKOFORECV
,

225 
	mLINUX_MIB_TCPABORTONDATA
,

226 
	mLINUX_MIB_TCPABORTONCLOSE
,

227 
	mLINUX_MIB_TCPABORTONMEMORY
,

228 
	mLINUX_MIB_TCPABORTONTIMEOUT
,

229 
	mLINUX_MIB_TCPABORTONLINGER
,

230 
	mLINUX_MIB_TCPABORTFAILED
,

231 
	mLINUX_MIB_TCPMEMORYPRESSURES
,

232 
	mLINUX_MIB_TCPSACKDISCARD
,

233 
	mLINUX_MIB_TCPDSACKIGNOREDOLD
,

234 
	mLINUX_MIB_TCPDSACKIGNOREDNOUNDO
,

235 
	mLINUX_MIB_TCPSPURIOUSRTOS
,

236 
	mLINUX_MIB_TCPMD5NOTFOUND
,

237 
	mLINUX_MIB_TCPMD5UNEXPECTED
,

238 
	mLINUX_MIB_SACKSHIFTED
,

239 
	mLINUX_MIB_SACKMERGED
,

240 
	mLINUX_MIB_SACKSHIFTFALLBACK
,

241 
	mLINUX_MIB_TCPBACKLOGDROP
,

242 
	mLINUX_MIB_TCPMINTTLDROP
,

243 
	mLINUX_MIB_TCPDEFERACCEPTDROP
,

244 
	mLINUX_MIB_IPRPFILTER
,

245 
	mLINUX_MIB_TCPTIMEWAITOVERFLOW
,

246 
	mLINUX_MIB_TCPREQQFULLDOCOOKIES
,

247 
	mLINUX_MIB_TCPREQQFULLDROP
,

248 
	mLINUX_MIB_TCPRETRANSFAIL
,

249 
	mLINUX_MIB_TCPRCVCOALESCE
,

250 
	mLINUX_MIB_TCPOFOQUEUE
,

251 
	mLINUX_MIB_TCPOFODROP
,

252 
	mLINUX_MIB_TCPOFOMERGE
,

253 
	mLINUX_MIB_TCPCHALLENGEACK
,

254 
	mLINUX_MIB_TCPSYNCHALLENGE
,

255 
	mLINUX_MIB_TCPFASTOPENACTIVE
,

256 
	mLINUX_MIB_TCPFASTOPENACTIVEFAIL
,

257 
	mLINUX_MIB_TCPFASTOPENPASSIVE
,

258 
	mLINUX_MIB_TCPFASTOPENPASSIVEFAIL
,

259 
	mLINUX_MIB_TCPFASTOPENLISTENOVERFLOW
,

260 
	mLINUX_MIB_TCPFASTOPENCOOKIEREQD
,

261 
	mLINUX_MIB_TCPSPURIOUS_RTX_HOSTQUEUES
,

262 
	mLINUX_MIB_BUSYPOLLRXPACKETS
,

263 
	mLINUX_MIB_TCPAUTOCORKING
,

264 
	mLINUX_MIB_TCPFROMZEROWINDOWADV
,

265 
	mLINUX_MIB_TCPTOZEROWINDOWADV
,

266 
	mLINUX_MIB_TCPWANTZEROWINDOWADV
,

267 
	mLINUX_MIB_TCPSYNRETRANS
,

268 
	mLINUX_MIB_TCPORIGDATASENT
,

269 
	mLINUX_MIB_TCPHYSTARTTRAINDETECT
,

270 
	mLINUX_MIB_TCPHYSTARTTRAINCWND
,

271 
	mLINUX_MIB_TCPHYSTARTDELAYDETECT
,

272 
	mLINUX_MIB_TCPHYSTARTDELAYCWND
,

273 
	mLINUX_MIB_TCPACKSKIPPEDSYNRECV
,

274 
	mLINUX_MIB_TCPACKSKIPPEDPAWS
,

275 
	mLINUX_MIB_TCPACKSKIPPEDSEQ
,

276 
	mLINUX_MIB_TCPACKSKIPPEDFINWAIT2
,

277 
	mLINUX_MIB_TCPACKSKIPPEDTIMEWAIT
,

278 
	mLINUX_MIB_TCPACKSKIPPEDCHALLENGE
,

279 
	mLINUX_MIB_TCPWINPROBE
,

280 
	mLINUX_MIB_TCPKEEPALIVE
,

281 
	mLINUX_MIB_TCPMTUPFAIL
,

282 
	mLINUX_MIB_TCPMTUPSUCCESS
,

283 
	m__LINUX_MIB_MAX


289 
	mLINUX_MIB_XFRMNUM
 = 0,

290 
	mLINUX_MIB_XFRMINERROR
,

291 
	mLINUX_MIB_XFRMINBUFFERERROR
,

292 
	mLINUX_MIB_XFRMINHDRERROR
,

293 
	mLINUX_MIB_XFRMINNOSTATES
,

294 
	mLINUX_MIB_XFRMINSTATEPROTOERROR
,

295 
	mLINUX_MIB_XFRMINSTATEMODEERROR
,

296 
	mLINUX_MIB_XFRMINSTATESEQERROR
,

297 
	mLINUX_MIB_XFRMINSTATEEXPIRED
,

298 
	mLINUX_MIB_XFRMINSTATEMISMATCH
,

299 
	mLINUX_MIB_XFRMINSTATEINVALID
,

300 
	mLINUX_MIB_XFRMINTMPLMISMATCH
,

301 
	mLINUX_MIB_XFRMINNOPOLS
,

302 
	mLINUX_MIB_XFRMINPOLBLOCK
,

303 
	mLINUX_MIB_XFRMINPOLERROR
,

304 
	mLINUX_MIB_XFRMOUTERROR
,

305 
	mLINUX_MIB_XFRMOUTBUNDLEGENERROR
,

306 
	mLINUX_MIB_XFRMOUTBUNDLECHECKERROR
,

307 
	mLINUX_MIB_XFRMOUTNOSTATES
,

308 
	mLINUX_MIB_XFRMOUTSTATEPROTOERROR
,

309 
	mLINUX_MIB_XFRMOUTSTATEMODEERROR
,

310 
	mLINUX_MIB_XFRMOUTSTATESEQERROR
,

311 
	mLINUX_MIB_XFRMOUTSTATEEXPIRED
,

312 
	mLINUX_MIB_XFRMOUTPOLBLOCK
,

313 
	mLINUX_MIB_XFRMOUTPOLDEAD
,

314 
	mLINUX_MIB_XFRMOUTPOLERROR
,

315 
	mLINUX_MIB_XFRMFWDHDRERROR
,

316 
	mLINUX_MIB_XFRMOUTSTATEINVALID
,

317 
	mLINUX_MIB_XFRMACQUIREERROR
,

318 
	m__LINUX_MIB_XFRMMAX


	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/sockios.h

18 #iâdeà
_LINUX_SOCKIOS_H


19 
	#_LINUX_SOCKIOS_H


	)

21 
	~<asm/sockios.h
>

24 
	#SIOCINQ
 
FIONREAD


	)

25 
	#SIOCOUTQ
 
TIOCOUTQ


	)

28 
	#SIOCADDRT
 0x890B

	)

29 
	#SIOCDELRT
 0x890C

	)

30 
	#SIOCRTMSG
 0x890D

	)

33 
	#SIOCGIFNAME
 0x8910

	)

34 
	#SIOCSIFLINK
 0x8911

	)

35 
	#SIOCGIFCONF
 0x8912

	)

36 
	#SIOCGIFFLAGS
 0x8913

	)

37 
	#SIOCSIFFLAGS
 0x8914

	)

38 
	#SIOCGIFADDR
 0x8915

	)

39 
	#SIOCSIFADDR
 0x8916

	)

40 
	#SIOCGIFDSTADDR
 0x8917

	)

41 
	#SIOCSIFDSTADDR
 0x8918

	)

42 
	#SIOCGIFBRDADDR
 0x8919

	)

43 
	#SIOCSIFBRDADDR
 0x891¨

	)

44 
	#SIOCGIFNETMASK
 0x891b

	)

45 
	#SIOCSIFNETMASK
 0x891ø

	)

46 
	#SIOCGIFMETRIC
 0x891d

	)

47 
	#SIOCSIFMETRIC
 0x891

	)

48 
	#SIOCGIFMEM
 0x891à

	)

49 
	#SIOCSIFMEM
 0x8920

	)

50 
	#SIOCGIFMTU
 0x8921

	)

51 
	#SIOCSIFMTU
 0x8922

	)

52 
	#SIOCSIFNAME
 0x8923

	)

53 
	#SIOCSIFHWADDR
 0x8924

	)

54 
	#SIOCGIFENCAP
 0x8925

	)

55 
	#SIOCSIFENCAP
 0x8926

	)

56 
	#SIOCGIFHWADDR
 0x8927

	)

57 
	#SIOCGIFSLAVE
 0x8929

	)

58 
	#SIOCSIFSLAVE
 0x8930

	)

59 
	#SIOCADDMULTI
 0x8931

	)

60 
	#SIOCDELMULTI
 0x8932

	)

61 
	#SIOCGIFINDEX
 0x8933

	)

62 
	#SIOGIFINDEX
 
SIOCGIFINDEX


	)

63 
	#SIOCSIFPFLAGS
 0x8934

	)

64 
	#SIOCGIFPFLAGS
 0x8935

	)

65 
	#SIOCDIFADDR
 0x8936

	)

66 
	#SIOCSIFHWBROADCAST
 0x8937

	)

67 
	#SIOCGIFCOUNT
 0x8938

	)

69 
	#SIOCGIFBR
 0x8940

	)

70 
	#SIOCSIFBR
 0x8941

	)

72 
	#SIOCGIFTXQLEN
 0x8942

	)

73 
	#SIOCSIFTXQLEN
 0x8943

	)

78 
	#SIOCETHTOOL
 0x8946

	)

80 
	#SIOCGMIIPHY
 0x8947

	)

81 
	#SIOCGMIIREG
 0x8948

	)

82 
	#SIOCSMIIREG
 0x8949

	)

84 
	#SIOCWANDEV
 0x894A

	)

86 
	#SIOCOUTQNSD
 0x894B

	)

90 
	#SIOCDARP
 0x8953

	)

91 
	#SIOCGARP
 0x8954

	)

92 
	#SIOCSARP
 0x8955

	)

95 
	#SIOCDRARP
 0x8960

	)

96 
	#SIOCGRARP
 0x8961

	)

97 
	#SIOCSRARP
 0x8962

	)

101 
	#SIOCGIFMAP
 0x8970

	)

102 
	#SIOCSIFMAP
 0x8971

	)

106 
	#SIOCADDDLCI
 0x8980

	)

107 
	#SIOCDELDLCI
 0x8981

	)

109 
	#SIOCGIFVLAN
 0x8982

	)

110 
	#SIOCSIFVLAN
 0x8983

	)

114 
	#SIOCBONDENSLAVE
 0x8990

	)

115 
	#SIOCBONDRELEASE
 0x8991

	)

116 
	#SIOCBONDSETHWADDR
 0x8992

	)

117 
	#SIOCBONDSLAVEINFOQUERY
 0x8993

	)

118 
	#SIOCBONDINFOQUERY
 0x8994

	)

119 
	#SIOCBONDCHANGEACTIVE
 0x8995

	)

122 
	#SIOCBRADDBR
 0x89a0

	)

123 
	#SIOCBRDELBR
 0x89a1

	)

124 
	#SIOCBRADDIF
 0x89a2

	)

125 
	#SIOCBRDELIF
 0x89a3

	)

128 
	#SIOCSHWTSTAMP
 0x89b0

	)

129 
	#SIOCGHWTSTAMP
 0x89b1

	)

142 
	#SIOCDEVPRIVATE
 0x89F0

	)

148 
	#SIOCPROTOPRIVATE
 0x89E0

	)

	@/usr/include/linux/taskstats.h

16 #iâdeà
_LINUX_TASKSTATS_H


17 
	#_LINUX_TASKSTATS_H


	)

19 
	~<lšux/ty³s.h
>

36 
	#TASKSTATS_VERSION
 8

	)

37 
	#TS_COMM_LEN
 32

	)

40 
	ssk¡©s
 {

46 
__u16
 
	mv”siÚ
;

47 
__u32
 
	mac_ex™code
;

52 
__u8
 
	mac_æag
;

53 
__u8
 
	mac_niû
;

71 
__u64
 
ıu_couÁ
 
__©Œibu‹__
((
®igÃd
(8)));

72 
__u64
 
	mıu_d–ay_tÙ®
;

79 
__u64
 
	mblkio_couÁ
;

80 
__u64
 
	mblkio_d–ay_tÙ®
;

83 
__u64
 
	msw­š_couÁ
;

84 
__u64
 
	msw­š_d–ay_tÙ®
;

92 
__u64
 
	mıu_run_»®_tÙ®
;

100 
__u64
 
	mıu_run_vœtu®_tÙ®
;

105 
	mac_comm
[
TS_COMM_LEN
];

106 
__u8
 
ac_sched
 
__©Œibu‹__
((
®igÃd
(8)));

108 
__u8
 
	mac_·d
[3];

109 
__u32
 
ac_uid
 
__©Œibu‹__
((
®igÃd
(8)));

111 
__u32
 
	mac_gid
;

112 
__u32
 
	mac_pid
;

113 
__u32
 
	mac_µid
;

114 
__u32
 
	mac_btime
;

115 
__u64
 
ac_‘ime
 
__©Œibu‹__
((
®igÃd
(8)));

117 
__u64
 
	mac_utime
;

118 
__u64
 
	mac_¡ime
;

119 
__u64
 
	mac_mšæt
;

120 
__u64
 
	mac_majæt
;

130 
__u64
 
	mcÜemem
;

134 
__u64
 
	mvœtmem
;

139 
__u64
 
	mhiw©”_rss
;

140 
__u64
 
	mhiw©”_vm
;

143 
__u64
 
	m»ad_ch¬
;

144 
__u64
 
	mwr™e_ch¬
;

145 
__u64
 
	m»ad_sysÿÎs
;

146 
__u64
 
	mwr™e_sysÿÎs
;

149 
	#TASKSTATS_HAS_IO_ACCOUNTING


	)

151 
__u64
 
	m»ad_by‹s
;

152 
__u64
 
	mwr™e_by‹s
;

153 
__u64
 
	mÿnûÎed_wr™e_by‹s
;

155 
__u64
 
	mnvcsw
;

156 
__u64
 
	mnivcsw
;

159 
__u64
 
	mac_utimesÿËd
;

160 
__u64
 
	mac_¡imesÿËd
;

161 
__u64
 
	mıu_sÿËd_run_»®_tÙ®
;

164 
__u64
 
	mä“·ges_couÁ
;

165 
__u64
 
	mä“·ges_d–ay_tÙ®
;

176 
	mTASKSTATS_CMD_UNSPEC
 = 0,

177 
	mTASKSTATS_CMD_GET
,

178 
	mTASKSTATS_CMD_NEW
,

179 
	m__TASKSTATS_CMD_MAX
,

182 
	#TASKSTATS_CMD_MAX
 (
__TASKSTATS_CMD_MAX
 - 1)

	)

185 
	mTASKSTATS_TYPE_UNSPEC
 = 0,

186 
	mTASKSTATS_TYPE_PID
,

187 
	mTASKSTATS_TYPE_TGID
,

188 
	mTASKSTATS_TYPE_STATS
,

189 
	mTASKSTATS_TYPE_AGGR_PID
,

190 
	mTASKSTATS_TYPE_AGGR_TGID
,

191 
	mTASKSTATS_TYPE_NULL
,

192 
	m__TASKSTATS_TYPE_MAX
,

195 
	#TASKSTATS_TYPE_MAX
 (
__TASKSTATS_TYPE_MAX
 - 1)

	)

198 
	mTASKSTATS_CMD_ATTR_UNSPEC
 = 0,

199 
	mTASKSTATS_CMD_ATTR_PID
,

200 
	mTASKSTATS_CMD_ATTR_TGID
,

201 
	mTASKSTATS_CMD_ATTR_REGISTER_CPUMASK
,

202 
	mTASKSTATS_CMD_ATTR_DEREGISTER_CPUMASK
,

203 
	m__TASKSTATS_CMD_ATTR_MAX
,

206 
	#TASKSTATS_CMD_ATTR_MAX
 (
__TASKSTATS_CMD_ATTR_MAX
 - 1)

	)

210 
	#TASKSTATS_GENL_NAME
 "TASKSTATS"

	)

211 
	#TASKSTATS_GENL_VERSION
 0x1

	)

	@/usr/include/linux/tc_act/tc_mirred.h

1 #iâdeà
__LINUX_TC_MIR_H


2 
	#__LINUX_TC_MIR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

7 
	#TCA_ACT_MIRRED
 8

	)

8 
	#TCA_EGRESS_REDIR
 1

	)

9 
	#TCA_EGRESS_MIRROR
 2

	)

10 
	#TCA_INGRESS_REDIR
 3

	)

11 
	#TCA_INGRESS_MIRROR
 4

	)

13 
	stc_mœ»d
 {

14 
	mtc_g’
;

15 
	m—ùiÚ
;

16 
__u32
 
	mifšdex
;

20 
	mTCA_MIRRED_UNSPEC
,

21 
	mTCA_MIRRED_TM
,

22 
	mTCA_MIRRED_PARMS
,

23 
	m__TCA_MIRRED_MAX


25 
	#TCA_MIRRED_MAX
 (
__TCA_MIRRED_MAX
 - 1)

	)

	@/usr/include/linux/tc_ematch/tc_em_cmp.h

1 #iâdeà
__LINUX_TC_EM_CMP_H


2 
	#__LINUX_TC_EM_CMP_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

7 
	stcf_em_cmp
 {

8 
__u32
 
	mv®
;

9 
__u32
 
	mmask
;

10 
__u16
 
	moff
;

11 
__u8
 
	m®ign
:4;

12 
__u8
 
	mæags
:4;

13 
__u8
 
	mÏy”
:4;

14 
__u8
 
	mİnd
:4;

18 
	mTCF_EM_ALIGN_U8
 = 1,

19 
	mTCF_EM_ALIGN_U16
 = 2,

20 
	mTCF_EM_ALIGN_U32
 = 4

23 
	#TCF_EM_CMP_TRANS
 1

	)

	@/usr/include/linux/tc_ematch/tc_em_meta.h

1 #iâdeà
__LINUX_TC_EM_META_H


2 
	#__LINUX_TC_EM_META_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

8 
	mTCA_EM_META_UNSPEC
,

9 
	mTCA_EM_META_HDR
,

10 
	mTCA_EM_META_LVALUE
,

11 
	mTCA_EM_META_RVALUE
,

12 
	m__TCA_EM_META_MAX


14 
	#TCA_EM_META_MAX
 (
__TCA_EM_META_MAX
 - 1)

	)

16 
	stcf_m‘a_v®
 {

17 
__u16
 
	mkšd
;

18 
__u8
 
	mshiá
;

19 
__u8
 
	mİ
;

22 
	#TCF_META_TYPE_MASK
 (0xà<< 12)

	)

23 
	#TCF_META_TYPE
(
kšd
è(((kšdè& 
TCF_META_TYPE_MASK
è>> 12)

	)

24 
	#TCF_META_ID_MASK
 0x7ff

	)

25 
	#TCF_META_ID
(
kšd
è((kšdè& 
TCF_META_ID_MASK
)

	)

28 
	mTCF_META_TYPE_VAR
,

29 
	mTCF_META_TYPE_INT
,

30 
	m__TCF_META_TYPE_MAX


32 
	#TCF_META_TYPE_MAX
 (
__TCF_META_TYPE_MAX
 - 1)

	)

35 
	mTCF_META_ID_VALUE
,

36 
	mTCF_META_ID_RANDOM
,

37 
	mTCF_META_ID_LOADAVG_0
,

38 
	mTCF_META_ID_LOADAVG_1
,

39 
	mTCF_META_ID_LOADAVG_2
,

40 
	mTCF_META_ID_DEV
,

41 
	mTCF_META_ID_PRIORITY
,

42 
	mTCF_META_ID_PROTOCOL
,

43 
	mTCF_META_ID_PKTTYPE
,

44 
	mTCF_META_ID_PKTLEN
,

45 
	mTCF_META_ID_DATALEN
,

46 
	mTCF_META_ID_MACLEN
,

47 
	mTCF_META_ID_NFMARK
,

48 
	mTCF_META_ID_TCINDEX
,

49 
	mTCF_META_ID_RTCLASSID
,

50 
	mTCF_META_ID_RTIIF
,

51 
	mTCF_META_ID_SK_FAMILY
,

52 
	mTCF_META_ID_SK_STATE
,

53 
	mTCF_META_ID_SK_REUSE
,

54 
	mTCF_META_ID_SK_BOUND_IF
,

55 
	mTCF_META_ID_SK_REFCNT
,

56 
	mTCF_META_ID_SK_SHUTDOWN
,

57 
	mTCF_META_ID_SK_PROTO
,

58 
	mTCF_META_ID_SK_TYPE
,

59 
	mTCF_META_ID_SK_RCVBUF
,

60 
	mTCF_META_ID_SK_RMEM_ALLOC
,

61 
	mTCF_META_ID_SK_WMEM_ALLOC
,

62 
	mTCF_META_ID_SK_OMEM_ALLOC
,

63 
	mTCF_META_ID_SK_WMEM_QUEUED
,

64 
	mTCF_META_ID_SK_RCV_QLEN
,

65 
	mTCF_META_ID_SK_SND_QLEN
,

66 
	mTCF_META_ID_SK_ERR_QLEN
,

67 
	mTCF_META_ID_SK_FORWARD_ALLOCS
,

68 
	mTCF_META_ID_SK_SNDBUF
,

69 
	mTCF_META_ID_SK_ALLOCS
,

70 
	m__TCF_META_ID_SK_ROUTE_CAPS
,

71 
	mTCF_META_ID_SK_HASH
,

72 
	mTCF_META_ID_SK_LINGERTIME
,

73 
	mTCF_META_ID_SK_ACK_BACKLOG
,

74 
	mTCF_META_ID_SK_MAX_ACK_BACKLOG
,

75 
	mTCF_META_ID_SK_PRIO
,

76 
	mTCF_META_ID_SK_RCVLOWAT
,

77 
	mTCF_META_ID_SK_RCVTIMEO
,

78 
	mTCF_META_ID_SK_SNDTIMEO
,

79 
	mTCF_META_ID_SK_SENDMSG_OFF
,

80 
	mTCF_META_ID_SK_WRITE_PENDING
,

81 
	mTCF_META_ID_VLAN_TAG
,

82 
	mTCF_META_ID_RXHASH
,

83 
	m__TCF_META_ID_MAX


85 
	#TCF_META_ID_MAX
 (
__TCF_META_ID_MAX
 - 1)

	)

87 
	stcf_m‘a_hdr
 {

88 
tcf_m‘a_v®
 
	mËá
;

89 
tcf_m‘a_v®
 
	mright
;

	@/usr/include/linux/tc_ematch/tc_em_nbyte.h

1 #iâdeà
__LINUX_TC_EM_NBYTE_H


2 
	#__LINUX_TC_EM_NBYTE_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

7 
	stcf_em_nby‹
 {

8 
__u16
 
	moff
;

9 
__u16
 
	mËn
:12;

10 
__u8
 
	mÏy”
:4;

	@/usr/include/linux/tc_ematch/tc_em_text.h

1 #iâdeà
__LINUX_TC_EM_TEXT_H


2 
	#__LINUX_TC_EM_TEXT_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/pkt_şs.h
>

7 
	#TC_EM_TEXT_ALGOSIZ
 16

	)

9 
	stcf_em_‹xt
 {

10 
	m®go
[
TC_EM_TEXT_ALGOSIZ
];

11 
__u16
 
	mäom_off£t
;

12 
__u16
 
	mto_off£t
;

13 
__u16
 
	m·‰”n_Ën
;

14 
__u8
 
	mäom_Ïy”
:4;

15 
__u8
 
	mto_Ïy”
:4;

16 
__u8
 
	m·d
;

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 #ifdeà
__CHECK_ENDIAN__


22 
	#__b™wi£
 
__b™wi£__


	)

24 
	#__b™wi£


	)

27 
__u16
 
	t__b™wi£
 
	t__Ë16
;

28 
__u16
 
	t__b™wi£
 
	t__be16
;

29 
__u32
 
	t__b™wi£
 
	t__Ë32
;

30 
__u32
 
	t__b™wi£
 
	t__be32
;

31 
__u64
 
	t__b™wi£
 
	t__Ë64
;

32 
__u64
 
	t__b™wi£
 
	t__be64
;

34 
__u16
 
	t__b™wi£
 
	t__sum16
;

35 
__u32
 
	t__b™wi£
 
	t__wsum
;

46 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

47 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

48 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 263244

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
è((×è<< 16è+ ((bè<< 8è+ (c))

	)

	@/usr/include/linux/x25.h

11 #iâdef 
X25_KERNEL_H


12 
	#X25_KERNEL_H


	)

14 
	~<lšux/ty³s.h
>

15 
	~<lšux/sock‘.h
>

17 
	#SIOCX25GSUBSCRIP
 (
SIOCPROTOPRIVATE
 + 0)

	)

18 
	#SIOCX25SSUBSCRIP
 (
SIOCPROTOPRIVATE
 + 1)

	)

19 
	#SIOCX25GFACILITIES
 (
SIOCPROTOPRIVATE
 + 2)

	)

20 
	#SIOCX25SFACILITIES
 (
SIOCPROTOPRIVATE
 + 3)

	)

21 
	#SIOCX25GCALLUSERDATA
 (
SIOCPROTOPRIVATE
 + 4)

	)

22 
	#SIOCX25SCALLUSERDATA
 (
SIOCPROTOPRIVATE
 + 5)

	)

23 
	#SIOCX25GCAUSEDIAG
 (
SIOCPROTOPRIVATE
 + 6)

	)

24 
	#SIOCX25SCUDMATCHLEN
 (
SIOCPROTOPRIVATE
 + 7)

	)

25 
	#SIOCX25CALLACCPTAPPRV
 (
SIOCPROTOPRIVATE
 + 8)

	)

26 
	#SIOCX25SENDCALLACCPT
 (
SIOCPROTOPRIVATE
 + 9)

	)

27 
	#SIOCX25GDTEFACILITIES
 (
SIOCPROTOPRIVATE
 + 10)

	)

28 
	#SIOCX25SDTEFACILITIES
 (
SIOCPROTOPRIVATE
 + 11)

	)

29 
	#SIOCX25SCAUSEDIAG
 (
SIOCPROTOPRIVATE
 + 12)

	)

34 
	#X25_QBITINCL
 1

	)

39 
	#X25_PS16
 4

	)

40 
	#X25_PS32
 5

	)

41 
	#X25_PS64
 6

	)

42 
	#X25_PS128
 7

	)

43 
	#X25_PS256
 8

	)

44 
	#X25_PS512
 9

	)

45 
	#X25_PS1024
 10

	)

46 
	#X25_PS2048
 11

	)

47 
	#X25_PS4096
 12

	)

53 
	sx25_add»ss
 {

54 
	mx25_addr
[16];

60 
	ssockaddr_x25
 {

61 
__k”Ãl_§_çmy_t
 
	msx25_çmy
;

62 
x25_add»ss
 
	msx25_addr
;

73 
	sx25_subsü_¡ruù
 {

74 
	mdeviû
[200-()];

75 
	mglob®_çc_mask
;

76 
	mex‹nded
;

81 
	#X25_MASK_REVERSE
 0x01

	)

82 
	#X25_MASK_THROUGHPUT
 0x02

	)

83 
	#X25_MASK_PACKET_SIZE
 0x04

	)

84 
	#X25_MASK_WINDOW_SIZE
 0x08

	)

86 
	#X25_MASK_CALLING_AE
 0x10

	)

87 
	#X25_MASK_CALLED_AE
 0x20

	)

93 
	sx25_rou‹_¡ruù
 {

94 
x25_add»ss
 
	madd»ss
;

95 
	msigdig™s
;

96 
	mdeviû
[200];

102 
	sx25_çc™›s
 {

103 
	mwšsize_š
, 
	mwšsize_out
;

104 
	m·csize_š
, 
	m·csize_out
;

105 
	mthroughput
;

106 
	m»v”£
;

117 
	sx25_d‹_çc™›s
 {

118 
__u16
 
	md–ay_cumul
;

119 
__u16
 
	md–ay_rg‘
;

120 
__u16
 
	md–ay_max
;

121 
__u8
 
	mmš_throughput
;

122 
__u8
 
	mex³d™ed
;

123 
__u8
 
	mÿÎšg_Ën
;

124 
__u8
 
	mÿÎed_Ën
;

125 
__u8
 
	mÿÎšg_«
[20];

126 
__u8
 
	mÿÎed_«
[20];

132 
	sx25_ÿÎu£rd©a
 {

133 
	mcudËngth
;

134 
	mcudd©a
[128];

140 
	sx25_ÿu£dŸg
 {

141 
	mÿu£
;

142 
	mdŸgno¡ic
;

148 
	sx25_subaddr
 {

149 
	mcudm©chËngth
;

	@/usr/include/locale.h

22 #iâdef 
_LOCALE_H


23 
	#_LOCALE_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	#__Ãed_NULL


	)

28 
	~<¡ddef.h
>

29 
	~<b™s/loÿË.h
>

31 
	g__BEGIN_DECLS


35 
	#LC_CTYPE
 
__LC_CTYPE


	)

36 
	#LC_NUMERIC
 
__LC_NUMERIC


	)

37 
	#LC_TIME
 
__LC_TIME


	)

38 
	#LC_COLLATE
 
__LC_COLLATE


	)

39 
	#LC_MONETARY
 
__LC_MONETARY


	)

40 
	#LC_MESSAGES
 
__LC_MESSAGES


	)

41 
	#LC_ALL
 
__LC_ALL


	)

42 
	#LC_PAPER
 
__LC_PAPER


	)

43 
	#LC_NAME
 
__LC_NAME


	)

44 
	#LC_ADDRESS
 
__LC_ADDRESS


	)

45 
	#LC_TELEPHONE
 
__LC_TELEPHONE


	)

46 
	#LC_MEASUREMENT
 
__LC_MEASUREMENT


	)

47 
	#LC_IDENTIFICATION
 
__LC_IDENTIFICATION


	)

50 
__BEGIN_NAMESPACE_STD


53 
	slcÚv


57 *
	mdecim®_pošt
;

58 *
	mthou§nds_£p
;

64 *
	mgroupšg
;

70 *
	mšt_cu¼_symbŞ
;

71 *
	mcu¼’cy_symbŞ
;

72 *
	mmÚ_decim®_pošt
;

73 *
	mmÚ_thou§nds_£p
;

74 *
	mmÚ_groupšg
;

75 *
	mpos™ive_sign
;

76 *
	mÃg©ive_sign
;

77 
	mšt_äac_dig™s
;

78 
	mäac_dig™s
;

80 
	mp_cs_´eûdes
;

82 
	mp_£p_by_¥aû
;

84 
	mn_cs_´eûdes
;

86 
	mn_£p_by_¥aû
;

93 
	mp_sign_po¢
;

94 
	mn_sign_po¢
;

95 #ifdeà
__USE_ISOC99


97 
	mšt_p_cs_´eûdes
;

99 
	mšt_p_£p_by_¥aû
;

101 
	mšt_n_cs_´eûdes
;

103 
	mšt_n_£p_by_¥aû
;

110 
	mšt_p_sign_po¢
;

111 
	mšt_n_sign_po¢
;

113 
	m__št_p_cs_´eûdes
;

114 
	m__št_p_£p_by_¥aû
;

115 
	m__št_n_cs_´eûdes
;

116 
	m__št_n_£p_by_¥aû
;

117 
	m__št_p_sign_po¢
;

118 
	m__št_n_sign_po¢
;

124 *
	$£oÿË
 (
__ÿ‹gÜy
, cÚ¡ *
__loÿË
è
__THROW
;

127 
lcÚv
 *
	$loÿËcÚv
 (è
__THROW
;

129 
__END_NAMESPACE_STD


132 #ifdef 
__USE_XOPEN2K8


145 
	~<xloÿË.h
>

151 
__loÿË_t
 
	$ÃwloÿË
 (
__ÿ‹gÜy_mask
, cÚ¡ *
__loÿË
,

152 
__loÿË_t
 
__ba£
è
__THROW
;

158 
	#LC_CTYPE_MASK
 (1 << 
__LC_CTYPE
)

	)

159 
	#LC_NUMERIC_MASK
 (1 << 
__LC_NUMERIC
)

	)

160 
	#LC_TIME_MASK
 (1 << 
__LC_TIME
)

	)

161 
	#LC_COLLATE_MASK
 (1 << 
__LC_COLLATE
)

	)

162 
	#LC_MONETARY_MASK
 (1 << 
__LC_MONETARY
)

	)

163 
	#LC_MESSAGES_MASK
 (1 << 
__LC_MESSAGES
)

	)

164 
	#LC_PAPER_MASK
 (1 << 
__LC_PAPER
)

	)

165 
	#LC_NAME_MASK
 (1 << 
__LC_NAME
)

	)

166 
	#LC_ADDRESS_MASK
 (1 << 
__LC_ADDRESS
)

	)

167 
	#LC_TELEPHONE_MASK
 (1 << 
__LC_TELEPHONE
)

	)

168 
	#LC_MEASUREMENT_MASK
 (1 << 
__LC_MEASUREMENT
)

	)

169 
	#LC_IDENTIFICATION_MASK
 (1 << 
__LC_IDENTIFICATION
)

	)

170 
	#LC_ALL_MASK
 (
LC_CTYPE_MASK
 \

171 | 
LC_NUMERIC_MASK
 \

172 | 
LC_TIME_MASK
 \

173 | 
LC_COLLATE_MASK
 \

174 | 
LC_MONETARY_MASK
 \

175 | 
LC_MESSAGES_MASK
 \

176 | 
LC_PAPER_MASK
 \

177 | 
LC_NAME_MASK
 \

178 | 
LC_ADDRESS_MASK
 \

179 | 
LC_TELEPHONE_MASK
 \

180 | 
LC_MEASUREMENT_MASK
 \

181 | 
LC_IDENTIFICATION_MASK
 \

182 )

	)

186 
__loÿË_t
 
	$du¶oÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

190 
	$ä“loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

197 
__loÿË_t
 
	$u£loÿË
 (
__loÿË_t
 
__d©a£t
è
__THROW
;

201 
	#LC_GLOBAL_LOCALE
 ((
__loÿË_t
è-1L)

	)

205 
__END_DECLS


	@/usr/include/malloc.h

19 #iâdeà
_MALLOC_H


20 
	#_MALLOC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<¡ddef.h
>

24 
	~<¡dio.h
>

26 #ifdeà
_LIBC


27 
	#__MALLOC_HOOK_VOLATILE


	)

28 
	#__MALLOC_DEPRECATED


	)

30 
	#__MALLOC_HOOK_VOLATILE
 vŞ©e

	)

31 
	#__MALLOC_DEPRECATED
 
__©Œibu‹_d•»ÿ‹d__


	)

35 
__BEGIN_DECLS


38 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

41 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

42 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

49 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

50 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

53 
	$ä“
 (*
__±r
è
__THROW
;

56 
	$cä“
 (*
__±r
è
__THROW
;

59 *
	$mem®ign
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

60 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

63 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

67 *
	$pv®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

71 *(*
__mÜecÜe
è(
±rdiff_t
 
__size
);

74 *
	$__deçuÉ_mÜecÜe
 (
±rdiff_t
 
__size
)

75 
__THROW
 
__©Œibu‹_m®loc__
;

79 
	sm®lšfo


81 
¬’a
;

82 
Üdblks
;

83 
smblks
;

84 
hblks
;

85 
hblkhd
;

86 
usmblks
;

87 
fsmblks
;

88 
uÜdblks
;

89 
fÜdblks
;

90 
k“pco¡
;

94 
m®lšfo
 
	$m®lšfo
 (è
__THROW
;

97 #iâdeà
M_MXFAST


98 
	#M_MXFAST
 1

	)

100 #iâdeà
M_NLBLKS


101 
	#M_NLBLKS
 2

	)

103 #iâdeà
M_GRAIN


104 
	#M_GRAIN
 3

	)

106 #iâdeà
M_KEEP


107 
	#M_KEEP
 4

	)

111 
	#M_TRIM_THRESHOLD
 -1

	)

112 
	#M_TOP_PAD
 -2

	)

113 
	#M_MMAP_THRESHOLD
 -3

	)

114 
	#M_MMAP_MAX
 -4

	)

115 
	#M_CHECK_ACTION
 -5

	)

116 
	#M_PERTURB
 -6

	)

117 
	#M_ARENA_TEST
 -7

	)

118 
	#M_ARENA_MAX
 -8

	)

121 
	$m®lİt
 (
__·¿m
, 
__v®
è
__THROW
;

125 
	$m®loc_Œim
 (
size_t
 
__·d
è
__THROW
;

129 
size_t
 
	$m®loc_u§bË_size
 (*
__±r
è
__THROW
;

132 
	$m®loc_¡©s
 (è
__THROW
;

135 
	$m®loc_šfo
 (
__İtiÚs
, 
FILE
 *
__å
è
__THROW
;

138 *
	$m®loc_g‘_¡©e
 (è
__THROW
;

142 
	$m®loc_£t_¡©e
 (*
__±r
è
__THROW
;

147 (*
__MALLOC_HOOK_VOLATILE
 
__m®loc_š™Ÿlize_hook
) ()

148 
__MALLOC_DEPRECATED
;

150 (*
__MALLOC_HOOK_VOLATILE
 
__ä“_hook
è(*
__±r
,

152 
__MALLOC_DEPRECATED
;

153 *(*
__MALLOC_HOOK_VOLATILE
 
__m®loc_hook
)(
size_t
 
__size
,

155 
__MALLOC_DEPRECATED
;

156 *(*
__MALLOC_HOOK_VOLATILE
 
__»®loc_hook
)(*
__±r
,

157 
size_t
 
__size
,

159 
__MALLOC_DEPRECATED
;

160 *(*
__MALLOC_HOOK_VOLATILE
 
__mem®ign_hook
)(
size_t
 
__®ignm’t
,

161 
size_t
 
__size
,

163 
__MALLOC_DEPRECATED
;

164 (*
__MALLOC_HOOK_VOLATILE
 
__aá”_mÜecÜe_hook
) ();

167 
	$__m®loc_check_š™
 (è
__THROW
 
__MALLOC_DEPRECATED
;

170 
__END_DECLS


	@/usr/include/math.h

23 #iâdef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<ã©u»s.h
>

28 
	g__BEGIN_DECLS


32 
	~<b™s/huge_v®.h
>

33 #ifdeà
__USE_ISOC99


34 
	~<b™s/huge_v®f.h
>

35 
	~<b™s/huge_v®l.h
>

38 
	~<b™s/šf.h
>

41 
	~<b™s/Çn.h
>

45 
	~<b™s/m©hdef.h
>

52 
	#__MATHCALL
(
funùiÚ
,
suffix
, 
¬gs
) \

53 
	`__MATHDECL
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
)

	)

54 
	#__MATHDECL
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

55 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
); \

56 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
)

	)

57 
	#__MATHCALLX
(
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

58 
	`__MATHDECLX
 (
_MdoubË_
,
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
)

	)

59 
	#__MATHDECLX
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
©Œib
) \

60 
	`__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
); \

61 
	`__MATHDECL_1
(
ty³
, 
	`__CONCAT
(
__
,
funùiÚ
),
suffix
, 
¬gs
è
	`__©Œibu‹__
 (
©Œib
)

	)

62 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

63 
ty³
 
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
è
¬gs
 
__THROW


	)

65 
	#_MdoubË_
 

	)

66 
	#__MATH_PRECNAME
(
Çme
,
r
è
	`__CONCAT
Òame,r)

	)

67 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

68 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

69 
	~<b™s/m©hÿÎs.h
>

70 #undeà
_MdoubË_


71 #undeà
_MdoubË_BEGIN_NAMESPACE


72 #undeà
_MdoubË_END_NAMESPACE


73 #undeà
__MATH_PRECNAME


75 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


81 #iâdeà
_Mæßt_


82 
	#_Mæßt_
 

	)

84 
	#_MdoubË_
 
_Mæßt_


	)

85 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
f
##
	)
r

86 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<b™s/m©hÿÎs.h
>

89 #undeà
_MdoubË_


90 #undeà
_MdoubË_BEGIN_NAMESPACE


91 #undeà
_MdoubË_END_NAMESPACE


92 #undeà
__MATH_PRECNAME


94 #ià!(
defšed
 
__NO_LONG_DOUBLE_MATH
 && defšed 
_LIBC
) \

95 || 
defšed
 
__LDBL_COMPAT


96 #ifdeà
__LDBL_COMPAT


98 #ifdeà
__USE_ISOC99


99 
	$__Ædbl_Ãx‰ow¬df
 (
__x
, 
__y
)

100 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

101 #ifdeà
__REDIRECT_NTH


102 
	`__REDIRECT_NTH
 (
Ãx‰ow¬df
, (
__x
, 
__y
),

103 
__Ædbl_Ãx‰ow¬df
)

104 
	`__©Œibu‹__
 ((
__cÚ¡__
));

105 
	`__REDIRECT_NTH
 (
Ãx‰ow¬d
, (
__x
, 
__y
),

106 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

107 
	`__REDIRECT_NTH
 (
Ãx‰ow¬dl
,

108 (
__x
, 
__y
),

109 
Ãxá”
è
	`__©Œibu‹__
 ((
__cÚ¡__
));

113 #undeà
__MATHDECL_1


114 
	#__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
®Ÿs
) \

115 
ty³
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funùiÚ
,
suffix
), \

116 
¬gs
, 
®Ÿs
)

	)

117 
	#__MATHDECL_1
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
) \

118 
	`__MATHDECL_2
(
ty³
, 
funùiÚ
,
suffix
, 
¬gs
, 
	`__CONCAT
(funùiÚ,suffix))

	)

124 #iâdeà
_MlÚg_doubË_


125 
	#_MlÚg_doubË_
 

	)

127 
	#_MdoubË_
 
_MlÚg_doubË_


	)

128 
	#__MATH_PRECNAME
(
Çme
,
r
èÇme##
l
##
	)
r

129 
	#_MdoubË_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

130 
	#_MdoubË_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

131 
	#__MATH_DECLARE_LDOUBLE
 1

	)

132 
	~<b™s/m©hÿÎs.h
>

133 #undeà
_MdoubË_


134 #undeà
_MdoubË_BEGIN_NAMESPACE


135 #undeà
_MdoubË_END_NAMESPACE


136 #undeà
__MATH_PRECNAME


141 #undeà
__MATHDECL_1


142 #undeà
__MATHDECL


143 #undeà
__MATHCALL


146 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


148 
signgam
;

153 #ifdeà
__USE_ISOC99


191 
FP_NAN
 =

192 
	#FP_NAN
 0

	)

193 
FP_NAN
,

194 
FP_INFINITE
 =

195 
	#FP_INFINITE
 1

	)

196 
FP_INFINITE
,

197 
FP_ZERO
 =

198 
	#FP_ZERO
 2

	)

199 
FP_ZERO
,

200 
FP_SUBNORMAL
 =

201 
	#FP_SUBNORMAL
 3

	)

202 
FP_SUBNORMAL
,

203 
FP_NORMAL
 =

204 
	#FP_NORMAL
 4

	)

205 
FP_NORMAL


209 #ifdeà
__NO_LONG_DOUBLE_MATH


210 
	#åşassify
(
x
) \

211 ( (
x
è=ğ (è? 
	`__åşassifyf
 (xè: 
	`__åşassify
 (x))

	)

213 
	#åşassify
(
x
) \

214 ( (
x
) ==  () \

215 ? 
	`__åşassifyf
 (
x
) \

216 :  (
x
) ==  () \

217 ? 
	`__åşassify
 (
x
è: 
	`__åşassifyl
 (x))

	)

221 #ifdeà
__NO_LONG_DOUBLE_MATH


222 
	#signb™
(
x
) \

223 ( (
x
è=ğ (è? 
	`__signb™f
 (xè: 
	`__signb™
 (x))

	)

225 
	#signb™
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__signb™f
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__signb™
 (
x
è: 
	`__signb™l
 (x))

	)

233 #ifdeà
__NO_LONG_DOUBLE_MATH


234 
	#isfš™e
(
x
) \

235 ( (
x
è=ğ (è? 
	`__fš™ef
 (xè: 
	`__fš™e
 (x))

	)

237 
	#isfš™e
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__fš™ef
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__fš™e
 (
x
è: 
	`__fš™–
 (x))

	)

245 
	#i¢Üm®
(
x
è(
	`åşassify
 (xè=ğ
FP_NORMAL
)

	)

249 #ifdeà
__NO_LONG_DOUBLE_MATH


250 
	#i¢ª
(
x
) \

251 ( (
x
è=ğ (è? 
	`__i¢ªf
 (xè: 
	`__i¢ª
 (x))

	)

253 
	#i¢ª
(
x
) \

254 ( (
x
) ==  () \

255 ? 
	`__i¢ªf
 (
x
) \

256 :  (
x
) ==  () \

257 ? 
	`__i¢ª
 (
x
è: 
	`__i¢ªl
 (x))

	)

261 #ifdeà
__NO_LONG_DOUBLE_MATH


262 
	#isšf
(
x
) \

263 ( (
x
è=ğ (è? 
	`__isšff
 (xè: 
	`__isšf
 (x))

	)

265 
	#isšf
(
x
) \

266 ( (
x
) ==  () \

267 ? 
	`__isšff
 (
x
) \

268 :  (
x
) ==  () \

269 ? 
	`__isšf
 (
x
è: 
	`__isšæ
 (x))

	)

273 
	#MATH_ERRNO
 1

	)

274 
	#MATH_ERREXCEPT
 2

	)

279 #iâdeà
__FAST_MATH__


280 
	#m©h_”rhªdlšg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

285 #ifdeà
__USE_GNU


287 #ifdeà
__NO_LONG_DOUBLE_MATH


288 
	#issigÇlšg
(
x
) \

289 ( (
x
è=ğ (è? 
	`__issigÇlšgf
 (xè: 
	`__issigÇlšg
 (x))

	)

291 
	#issigÇlšg
(
x
) \

292 ( (
x
) ==  () \

293 ? 
	`__issigÇlšgf
 (
x
) \

294 :  (
x
) ==  () \

295 ? 
	`__issigÇlšg
 (
x
è: 
	`__issigÇlšgl
 (x))

	)

299 #ifdef 
__USE_MISC


303 
_IEEE_
 = -1,

304 
_SVID_
,

305 
_XOPEN_
,

306 
_POSIX_
,

307 
_ISOC_


308 } 
	t_LIB_VERSION_TYPE
;

313 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

317 #ifdeà
__USE_SVID


323 #ifdeà
__ılu¥lus


324 
__exû±iÚ


326 
exû±iÚ


329 
ty³
;

330 *
Çme
;

331 
¬g1
;

332 
¬g2
;

333 
»tv®
;

334 
	}
};

336 #ifdeà
__ılu¥lus


337 
	$m©h”r
 (
__exû±iÚ
 *
__exc
è
	`throw
 ();

339 
	`m©h”r
 (
exû±iÚ
 *
__exc
);

342 
	#X_TLOSS
 1.41484755040568800000e+16

	)

345 
	#DOMAIN
 1

	)

346 
	#SING
 2

	)

347 
	#OVERFLOW
 3

	)

348 
	#UNDERFLOW
 4

	)

349 
	#TLOSS
 5

	)

350 
	#PLOSS
 6

	)

353 
	#HUGE
 3.40282347e+38F

	)

357 #ifdeà
__USE_XOPEN


359 
	#MAXFLOAT
 3.40282347e+38F

	)

366 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


367 
	#M_E
 2.7182818284590452354

	)

368 
	#M_LOG2E
 1.4426950408889634074

	)

369 
	#M_LOG10E
 0.43429448190325182765

	)

370 
	#M_LN2
 0.69314718055994530942

	)

371 
	#M_LN10
 2.30258509299404568402

	)

372 
	#M_PI
 3.14159265358979323846

	)

373 
	#M_PI_2
 1.57079632679489661923

	)

374 
	#M_PI_4
 0.78539816339744830962

	)

375 
	#M_1_PI
 0.31830988618379067154

	)

376 
	#M_2_PI
 0.63661977236758134308

	)

377 
	#M_2_SQRTPI
 1.12837916709551257390

	)

378 
	#M_SQRT2
 1.41421356237309504880

	)

379 
	#M_SQRT1_2
 0.70710678118654752440

	)

385 #ifdeà
__USE_GNU


386 
	#M_El
 2.718281828459045235360287471352662498L

	)

387 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

388 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

389 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

390 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

391 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

392 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

393 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

394 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

395 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

396 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

397 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

398 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

405 #ià
defšed
 
__STRICT_ANSI__
 && !defšed 
__NO_MATH_INLINES


406 
	#__NO_MATH_INLINES
 1

	)

409 #ià
defšed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

416 
	#isg»©”
(
x
, 
y
è
	`__butš_isg»©”
(x, y)

	)

417 
	#isg»©”equ®
(
x
, 
y
è
	`__butš_isg»©”equ®
(x, y)

	)

418 
	#i¦ess
(
x
, 
y
è
	`__butš_i¦ess
(x, y)

	)

419 
	#i¦es£qu®
(
x
, 
y
è
	`__butš_i¦es£qu®
(x, y)

	)

420 
	#i¦essg»©”
(
x
, 
y
è
	`__butš_i¦essg»©”
(x, y)

	)

421 
	#isunÜd”ed
(
u
, 
v
è
	`__butš_isunÜd”ed
(u, v)

	)

425 #ifdeà
__USE_EXTERN_INLINES


426 
	~<b™s/m©hšlše.h
>

431 #ià
defšed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

432 
	~<b™s/m©h-fš™e.h
>

435 #ifdeà
__USE_ISOC99


439 #iâdeà
isg»©”


440 
	#isg»©”
(
x
, 
y
) \

441 (
__ex‹nsiÚ__
 \

442 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

443 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x > __y; 
	}
}))

	)

447 #iâdeà
isg»©”equ®


448 
	#isg»©”equ®
(
x
, 
y
) \

449 (
__ex‹nsiÚ__
 \

450 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

451 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x >ğ__y; }))

	)

455 #iâdeà
i¦ess


456 
	#i¦ess
(
x
, 
y
) \

457 (
__ex‹nsiÚ__
 \

458 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

459 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x < __y; }))

	)

463 #iâdeà
i¦es£qu®


464 
	#i¦es£qu®
(
x
, 
y
) \

465 (
__ex‹nsiÚ__
 \

466 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

467 !
	`isunÜd”ed
 (
__x
, 
__y
è&& __x <ğ__y; }))

	)

471 #iâdeà
i¦essg»©”


472 
	#i¦essg»©”
(
x
, 
y
) \

473 (
__ex‹nsiÚ__
 \

474 ({ 
	`__ty³of__
(
x
è
__x
 = (x); __ty³of__(
y
è
__y
 = (y); \

475 !
	`isunÜd”ed
 (
__x
, 
__y
è&& (__x < __y || __y < __x); }))

	)

479 #iâdeà
isunÜd”ed


480 
	#isunÜd”ed
(
u
, 
v
) \

481 (
__ex‹nsiÚ__
 \

482 ({ 
	`__ty³of__
(
u
è
__u
 = (u); __ty³of__(
v
è
__v
 = (v); \

483 
	`åşassify
 (
__u
è=ğ
FP_NAN
 || fpşassify (
__v
è=ğFP_NAN; }))

	)

488 
	g__END_DECLS


	@/usr/include/net/ethernet.h

21 #iâdeà
__NET_ETHERNET_H


22 
	#__NET_ETHERNET_H
 1

	)

24 
	~<sys/cdefs.h
>

25 
	~<sys/ty³s.h
>

26 
	~<lšux/if_‘h”.h
>

28 
__BEGIN_DECLS


32 
	s‘h”_addr


34 
u_št8_t
 
	m‘h”_addr_où‘
[
ETH_ALEN
];

35 } 
__©Œibu‹__
 ((
__·cked__
));

38 
	s‘h”_h—d”


40 
u_št8_t
 
	m‘h”_dho¡
[
ETH_ALEN
];

41 
u_št8_t
 
	m‘h”_sho¡
[
ETH_ALEN
];

42 
u_št16_t
 
	m‘h”_ty³
;

43 } 
__©Œibu‹__
 ((
__·cked__
));

46 
	#ETHERTYPE_PUP
 0x0200

	)

47 
	#ETHERTYPE_SPRITE
 0x0500

	)

48 
	#ETHERTYPE_IP
 0x0800

	)

49 
	#ETHERTYPE_ARP
 0x0806

	)

50 
	#ETHERTYPE_REVARP
 0x8035

	)

51 
	#ETHERTYPE_AT
 0x809B

	)

52 
	#ETHERTYPE_AARP
 0x80F3

	)

53 
	#ETHERTYPE_VLAN
 0x8100

	)

54 
	#ETHERTYPE_IPX
 0x8137

	)

55 
	#ETHERTYPE_IPV6
 0x86dd

	)

56 
	#ETHERTYPE_LOOPBACK
 0x9000

	)

59 
	#ETHER_ADDR_LEN
 
ETH_ALEN


	)

60 
	#ETHER_TYPE_LEN
 2

	)

61 
	#ETHER_CRC_LEN
 4

	)

62 
	#ETHER_HDR_LEN
 
ETH_HLEN


	)

63 
	#ETHER_MIN_LEN
 (
ETH_ZLEN
 + 
ETHER_CRC_LEN
è

	)

64 
	#ETHER_MAX_LEN
 (
ETH_FRAME_LEN
 + 
ETHER_CRC_LEN
è

	)

67 
	#ETHER_IS_VALID_LEN
(
foo
) \

68 ((
foo
è>ğ
ETHER_MIN_LEN
 && (fooè<ğ
ETHER_MAX_LEN
)

	)

75 
	#ETHERTYPE_TRAIL
 0x1000

	)

76 
	#ETHERTYPE_NTRAILER
 16

	)

78 
	#ETHERMTU
 
ETH_DATA_LEN


	)

79 
	#ETHERMIN
 (
ETHER_MIN_LEN
 - 
ETHER_HDR_LEN
 - 
ETHER_CRC_LEN
)

	)

81 
	g__END_DECLS


	@/usr/include/net/if.h

19 #iâdeà
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<ã©u»s.h
>

24 #ifdeà
__USE_MISC


25 
	~<sys/ty³s.h
>

26 
	~<sys/sock‘.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_Çmešdex


35 
	mif_šdex
;

36 *
	mif_Çme
;

40 #ifdeà
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siçddr


90 
sockaddr
 
	miç_addr
;

93 
sockaddr
 
	mifu_brßdaddr
;

94 
sockaddr
 
	mifu_d¡addr
;

95 } 
	miç_ifu
;

96 
içû
 *
	miç_iå
;

97 
içddr
 *
	miç_Ãxt
;

100 
	#iç_brßdaddr
 
iç_ifu
.
ifu_brßdaddr


	)

101 
	#iç_d¡addr
 
iç_ifu
.
ifu_d¡addr


	)

111 
	sifm­


113 
	mmem_¡¬t
;

114 
	mmem_’d
;

115 
	mba£_addr
;

116 
	mœq
;

117 
	mdma
;

118 
	mpÜt
;

126 
	siäeq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	miän_Çme
[
IFNAMSIZ
];

133 } 
	miä_iän
;

137 
sockaddr
 
	miäu_addr
;

138 
sockaddr
 
	miäu_d¡addr
;

139 
sockaddr
 
	miäu_brßdaddr
;

140 
sockaddr
 
	miäu_Ãtmask
;

141 
sockaddr
 
	miäu_hwaddr
;

142 
	miäu_æags
;

143 
	miäu_iv®ue
;

144 
	miäu_mtu
;

145 
ifm­
 
	miäu_m­
;

146 
	miäu_¦ave
[
IFNAMSIZ
];

147 
	miäu_ÃwÇme
[
IFNAMSIZ
];

148 
__ÿddr_t
 
	miäu_d©a
;

149 } 
	miä_iäu
;

151 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

152 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

153 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

154 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

155 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

156 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

157 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

158 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

159 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

160 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

161 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

162 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

163 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

164 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

165 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

166 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

167 
	#_IOT_iäeq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_iäeq_shÜt
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_iäeq_št
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcÚf


178 
	mifc_Ën
;

181 
__ÿddr_t
 
	mifcu_buf
;

182 
iäeq
 *
	mifcu_»q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

187 
	#_IOT_ifcÚf
 
	`_IOT
(
	`_IOTS
(
ifcÚf
),1,0,0,0,0è

	)

190 
__BEGIN_DECLS


193 
	$if_Çm‘ošdex
 (cÚ¡ *
__iâame
è
__THROW
;

194 *
	$if_šdextÚame
 (
__ifšdex
, *
__iâame
è
__THROW
;

197 
if_Çmešdex
 *
	$if_Çmešdex
 (è
__THROW
;

200 
	$if_ä“Çmešdex
 (
if_Çmešdex
 *
__±r
è
__THROW
;

202 
__END_DECLS


	@/usr/include/net/if_arp.h

22 #iâdeà
_NET_IF_ARP_H


24 
	#_NET_IF_ARP_H
 1

	)

25 
	~<sys/cdefs.h
>

27 
	~<sys/ty³s.h
>

28 
	~<sys/sock‘.h
>

30 
	g__BEGIN_DECLS


33 
	#MAX_ADDR_LEN
 7

	)

39 
	#ARPOP_REQUEST
 1

	)

40 
	#ARPOP_REPLY
 2

	)

41 
	#ARPOP_RREQUEST
 3

	)

42 
	#ARPOP_RREPLY
 4

	)

43 
	#ARPOP_InREQUEST
 8

	)

44 
	#ARPOP_InREPLY
 9

	)

45 
	#ARPOP_NAK
 10

	)

54 
	s¬phdr


56 
	m¬_hrd
;

57 
	m¬_´o
;

58 
	m¬_hÊ
;

59 
	m¬_¶n
;

60 
	m¬_İ
;

64 
	m__¬_sha
[
ETH_ALEN
];

65 
	m__¬_s
[4];

66 
	m__¬_tha
[
ETH_ALEN
];

67 
	m__¬_t
[4];

73 
	#ARPHRD_NETROM
 0

	)

74 
	#ARPHRD_ETHER
 1

	)

75 
	#ARPHRD_EETHER
 2

	)

76 
	#ARPHRD_AX25
 3

	)

77 
	#ARPHRD_PRONET
 4

	)

78 
	#ARPHRD_CHAOS
 5

	)

79 
	#ARPHRD_IEEE802
 6

	)

80 
	#ARPHRD_ARCNET
 7

	)

81 
	#ARPHRD_APPLETLK
 8

	)

82 
	#ARPHRD_DLCI
 15

	)

83 
	#ARPHRD_ATM
 19

	)

84 
	#ARPHRD_METRICOM
 23

	)

85 
	#ARPHRD_IEEE1394
 24

	)

86 
	#ARPHRD_EUI64
 27

	)

87 
	#ARPHRD_INFINIBAND
 32

	)

90 
	#ARPHRD_SLIP
 256

	)

91 
	#ARPHRD_CSLIP
 257

	)

92 
	#ARPHRD_SLIP6
 258

	)

93 
	#ARPHRD_CSLIP6
 259

	)

94 
	#ARPHRD_RSRVD
 260

	)

95 
	#ARPHRD_ADAPT
 264

	)

96 
	#ARPHRD_ROSE
 270

	)

97 
	#ARPHRD_X25
 271

	)

98 
	#ARPHRD_HWX25
 272

	)

99 
	#ARPHRD_PPP
 512

	)

100 
	#ARPHRD_CISCO
 513

	)

101 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

102 
	#ARPHRD_LAPB
 516

	)

103 
	#ARPHRD_DDCMP
 517

	)

104 
	#ARPHRD_RAWHDLC
 518

	)

106 
	#ARPHRD_TUNNEL
 768

	)

107 
	#ARPHRD_TUNNEL6
 769

	)

108 
	#ARPHRD_FRAD
 770

	)

109 
	#ARPHRD_SKIP
 771

	)

110 
	#ARPHRD_LOOPBACK
 772

	)

111 
	#ARPHRD_LOCALTLK
 773

	)

112 
	#ARPHRD_FDDI
 774

	)

113 
	#ARPHRD_BIF
 775

	)

114 
	#ARPHRD_SIT
 776

	)

115 
	#ARPHRD_IPDDP
 777

	)

116 
	#ARPHRD_IPGRE
 778

	)

117 
	#ARPHRD_PIMREG
 779

	)

118 
	#ARPHRD_HIPPI
 780

	)

119 
	#ARPHRD_ASH
 781

	)

120 
	#ARPHRD_ECONET
 782

	)

121 
	#ARPHRD_IRDA
 783

	)

122 
	#ARPHRD_FCPP
 784

	)

123 
	#ARPHRD_FCAL
 785

	)

124 
	#ARPHRD_FCPL
 786

	)

125 
	#ARPHRD_FCFABRIC
 787

	)

126 
	#ARPHRD_IEEE802_TR
 800

	)

127 
	#ARPHRD_IEEE80211
 801

	)

128 
	#ARPHRD_IEEE80211_PRISM
 802

	)

129 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

130 
	#ARPHRD_IEEE802154
 804

	)

131 
	#ARPHRD_IEEE802154_PHY
 805

	)

133 
	#ARPHRD_VOID
 0xFFFF

	)

134 
	#ARPHRD_NONE
 0xFFFE

	)

138 
	s¬´eq


140 
sockaddr
 
	m¬p_·
;

141 
sockaddr
 
	m¬p_ha
;

142 
	m¬p_æags
;

143 
sockaddr
 
	m¬p_Ãtmask
;

144 
	m¬p_dev
[16];

147 
	s¬´eq_Şd


149 
sockaddr
 
	m¬p_·
;

150 
sockaddr
 
	m¬p_ha
;

151 
	m¬p_æags
;

152 
sockaddr
 
	m¬p_Ãtmask
;

156 
	#ATF_COM
 0x02

	)

157 
	#ATF_PERM
 0x04

	)

158 
	#ATF_PUBL
 0x08

	)

159 
	#ATF_USETRAILERS
 0x10

	)

160 
	#ATF_NETMASK
 0x20

	)

162 
	#ATF_DONTPUB
 0x40

	)

163 
	#ATF_MAGIC
 0x80

	)

167 
	#ARPD_UPDATE
 0x01

	)

168 
	#ARPD_LOOKUP
 0x02

	)

169 
	#ARPD_FLUSH
 0x03

	)

171 
	s¬pd_»que¡


173 
	m»q
;

174 
u_št32_t
 
	m
;

175 
	mdev
;

176 
	m¡amp
;

177 
	mupd©ed
;

178 
	mha
[
MAX_ADDR_LEN
];

181 
	g__END_DECLS


	@/usr/include/net/route.h

20 #iâdeà
_NET_ROUTE_H


21 
	#_NET_ROUTE_H
 1

	)

23 
	~<ã©u»s.h
>

24 
	~<sys/sock‘.h
>

25 
	~<sys/ty³s.h
>

26 
	~<Ãtš‘/š.h
>

27 
	~<b™s/wÜdsize.h
>

31 
	s¹’Œy


33 
	m¹_·d1
;

34 
sockaddr
 
	m¹_d¡
;

35 
sockaddr
 
	m¹_g©eway
;

36 
sockaddr
 
	m¹_g’mask
;

37 
	m¹_æags
;

38 
	m¹_·d2
;

39 
	m¹_·d3
;

40 
	m¹_tos
;

41 
	m¹_şass
;

42 #ià
__WORDSIZE
 == 64

43 
	m¹_·d4
[3];

45 
	m¹_·d4
;

47 
	m¹_m‘ric
;

48 *
	m¹_dev
;

49 
	m¹_mtu
;

50 
	m¹_wšdow
;

51 
	m¹_œ‰
;

54 
	#¹_mss
 
¹_mtu


	)

57 
	sš6_¹msg


59 
š6_addr
 
	m¹msg_d¡
;

60 
š6_addr
 
	m¹msg_¤c
;

61 
š6_addr
 
	m¹msg_g©eway
;

62 
u_št32_t
 
	m¹msg_ty³
;

63 
u_št16_t
 
	m¹msg_d¡_Ën
;

64 
u_št16_t
 
	m¹msg_¤c_Ën
;

65 
u_št32_t
 
	m¹msg_m‘ric
;

66 
	m¹msg_šfo
;

67 
u_št32_t
 
	m¹msg_æags
;

68 
	m¹msg_ifšdex
;

72 
	#RTF_UP
 0x0001

	)

73 
	#RTF_GATEWAY
 0x0002

	)

75 
	#RTF_HOST
 0x0004

	)

76 
	#RTF_REINSTATE
 0x0008

	)

77 
	#RTF_DYNAMIC
 0x0010

	)

78 
	#RTF_MODIFIED
 0x0020

	)

79 
	#RTF_MTU
 0x0040

	)

80 
	#RTF_MSS
 
RTF_MTU


	)

81 
	#RTF_WINDOW
 0x0080

	)

82 
	#RTF_IRTT
 0x0100

	)

83 
	#RTF_REJECT
 0x0200

	)

84 
	#RTF_STATIC
 0x0400

	)

85 
	#RTF_XRESOLVE
 0x0800

	)

86 
	#RTF_NOFORWARD
 0x1000

	)

87 
	#RTF_THROW
 0x2000

	)

88 
	#RTF_NOPMTUDISC
 0x4000

	)

91 
	#RTF_DEFAULT
 0x00010000

	)

92 
	#RTF_ALLONLINK
 0x00020000

	)

93 
	#RTF_ADDRCONF
 0x00040000

	)

95 
	#RTF_LINKRT
 0x00100000

	)

96 
	#RTF_NONEXTHOP
 0x00200000

	)

98 
	#RTF_CACHE
 0x01000000

	)

99 
	#RTF_FLOW
 0x02000000

	)

100 
	#RTF_POLICY
 0x04000000

	)

102 
	#RTCF_VALVE
 0x00200000

	)

103 
	#RTCF_MASQ
 0x00400000

	)

104 
	#RTCF_NAT
 0x00800000

	)

105 
	#RTCF_DOREDIRECT
 0x01000000

	)

106 
	#RTCF_LOG
 0x02000000

	)

107 
	#RTCF_DIRECTSRC
 0x04000000

	)

109 
	#RTF_LOCAL
 0x80000000

	)

110 
	#RTF_INTERFACE
 0x40000000

	)

111 
	#RTF_MULTICAST
 0x20000000

	)

112 
	#RTF_BROADCAST
 0x10000000

	)

113 
	#RTF_NAT
 0x08000000

	)

115 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

116 
	#RT_ADDRCLASS
(
æags
è((
__u_št32_t
èæag >> 23)

	)

118 
	#RT_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

120 
	#RT_LOCALADDR
(
æags
è((æag & 
RTF_ADDRCLASSMASK
) \

121 =ğ(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

123 
	#RT_CLASS_UNSPEC
 0

	)

124 
	#RT_CLASS_DEFAULT
 253

	)

126 
	#RT_CLASS_MAIN
 254

	)

127 
	#RT_CLASS_LOCAL
 255

	)

128 
	#RT_CLASS_MAX
 255

	)

131 
	#RTMSG_ACK
 
NLMSG_ACK


	)

132 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

134 
	#RTMSG_NEWDEVICE
 0x11

	)

135 
	#RTMSG_DELDEVICE
 0x12

	)

136 
	#RTMSG_NEWROUTE
 0x21

	)

137 
	#RTMSG_DELROUTE
 0x22

	)

138 
	#RTMSG_NEWRULE
 0x31

	)

139 
	#RTMSG_DELRULE
 0x32

	)

140 
	#RTMSG_CONTROL
 0x40

	)

142 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/netax25/ax25.h

18 #iâdeà
_NETAX25_AX25_H


19 
	#_NETAX25_AX25_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<b™s/sockaddr.h
>

25 
	#SOL_AX25
 257

	)

28 
	#AX25_WINDOW
 1

	)

29 
	#AX25_T1
 2

	)

30 
	#AX25_T2
 5

	)

31 
	#AX25_T3
 4

	)

32 
	#AX25_N2
 3

	)

33 
	#AX25_BACKOFF
 6

	)

34 
	#AX25_EXTSEQ
 7

	)

35 
	#AX25_PIDINCL
 8

	)

36 
	#AX25_IDLE
 9

	)

37 
	#AX25_PACLEN
 10

	)

38 
	#AX25_IPMAXQUEUE
 11

	)

39 
	#AX25_IAMDIGI
 12

	)

40 
	#AX25_KILL
 99

	)

43 
	#SIOCAX25GETUID
 (
SIOCPROTOPRIVATE
)

	)

44 
	#SIOCAX25ADDUID
 (
SIOCPROTOPRIVATE
+1)

	)

45 
	#SIOCAX25DELUID
 (
SIOCPROTOPRIVATE
+2)

	)

46 
	#SIOCAX25NOUID
 (
SIOCPROTOPRIVATE
+3)

	)

47 
	#SIOCAX25BPQADDR
 (
SIOCPROTOPRIVATE
+4)

	)

48 
	#SIOCAX25GETPARMS
 (
SIOCPROTOPRIVATE
+5)

	)

49 
	#SIOCAX25SETPARMS
 (
SIOCPROTOPRIVATE
+6)

	)

50 
	#SIOCAX25OPTRT
 (
SIOCPROTOPRIVATE
+7)

	)

51 
	#SIOCAX25CTLCON
 (
SIOCPROTOPRIVATE
+8)

	)

52 
	#SIOCAX25GETINFO
 (
SIOCPROTOPRIVATE
+9)

	)

53 
	#SIOCAX25ADDFWD
 (
SIOCPROTOPRIVATE
+10)

	)

54 
	#SIOCAX25DELFWD
 (
SIOCPROTOPRIVATE
+11)

	)

57 
	#AX25_NOUID_DEFAULT
 0

	)

58 
	#AX25_NOUID_BLOCK
 1

	)

59 
	#AX25_SET_RT_IPMODE
 2

	)

62 
	#AX25_DIGI_INBAND
 0x01

	)

63 
	#AX25_DIGI_XBAND
 0x02

	)

66 
	#AX25_MAX_DIGIS
 8

	)

71 
	max25_ÿÎ
[7];

73 
	tax25_add»ss
;

75 
	ssockaddr_ax25


77 
§_çmy_t
 
	m§x25_çmy
;

78 
ax25_add»ss
 
	m§x25_ÿÎ
;

79 
	m§x25_ndigis
;

85 
	sfuÎ_sockaddr_ax25


87 
sockaddr_ax25
 
	mf§_ax25
;

88 
ax25_add»ss
 
	mf§_dig—‹r
[
AX25_MAX_DIGIS
];

90 
	#§x25_uid
 
§x25_ndigis


	)

92 
	sax25_rou‹s_¡ruù


94 
ax25_add»ss
 
	mpÜt_addr
;

95 
ax25_add»ss
 
	mde¡_addr
;

96 
	mdigi_couÁ
;

97 
ax25_add»ss
 
	mdigi_addr
[
AX25_MAX_DIGIS
];

101 
	sax25_ùl_¡ruù


103 
ax25_add»ss
 
	mpÜt_addr
;

104 
ax25_add»ss
 
	msourû_addr
;

105 
ax25_add»ss
 
	mde¡_addr
;

106 
	mcmd
;

107 
	m¬g
;

108 
	mdigi_couÁ
;

109 
ax25_add»ss
 
	mdigi_addr
[
AX25_MAX_DIGIS
];

112 
	sax25_šfo_¡ruù


114 
	mn2
, 
	mn2couÁ
;

115 
	mt1
, 
	mt1tim”
;

116 
	mt2
, 
	mt2tim”
;

117 
	mt3
, 
	mt3tim”
;

118 
	midË
, 
	midËtim”
;

119 
	m¡©e
;

120 
	mrcv_q
, 
	m¢d_q
;

123 
	sax25_fwd_¡ruù


125 
ax25_add»ss
 
	mpÜt_äom
;

126 
ax25_add»ss
 
	mpÜt_to
;

130 
	sax25_rou‹_İt_¡ruù


132 
ax25_add»ss
 
	mpÜt_addr
;

133 
ax25_add»ss
 
	mde¡_addr
;

134 
	mcmd
;

135 
	m¬g
;

139 
	sax25_bpqaddr_¡ruù


141 
	mdev
[16];

142 
ax25_add»ss
 
	maddr
;

146 
	#AX25_VALUES_IPDEFMODE
 0

	)

147 
	#AX25_VALUES_AXDEFMODE
 1

	)

148 
	#AX25_VALUES_NETROM
 2

	)

149 
	#AX25_VALUES_TEXT
 3

	)

150 
	#AX25_VALUES_BACKOFF
 4

	)

151 
	#AX25_VALUES_CONMODE
 5

	)

152 
	#AX25_VALUES_WINDOW
 6

	)

153 
	#AX25_VALUES_EWINDOW
 7

	)

154 
	#AX25_VALUES_T1
 8

	)

155 
	#AX25_VALUES_T2
 9

	)

156 
	#AX25_VALUES_T3
 10

	)

157 
	#AX25_VALUES_N2
 11

	)

158 
	#AX25_VALUES_DIGI
 12

	)

159 
	#AX25_VALUES_IDLE
 13

	)

160 
	#AX25_VALUES_PACLEN
 14

	)

161 
	#AX25_VALUES_IPMAXQUEUE
 15

	)

162 
	#AX25_MAX_VALUES
 20

	)

164 
	sax25_·rms_¡ruù


166 
ax25_add»ss
 
	mpÜt_addr
;

167 
	mv®ues
[
AX25_MAX_VALUES
];

	@/usr/include/netdb.h

22 #iâdef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	~<Ãtš‘/š.h
>

28 
	~<¡dšt.h
>

29 #ifdeà
__USE_MISC


32 
	~<½c/Ãtdb.h
>

35 #ifdeà
__USE_GNU


36 
	#__Ãed_sigev’t_t


	)

37 
	~<b™s/sigšfo.h
>

38 
	#__Ãed_time¥ec


	)

39 
	~<time.h
>

42 
	~<b™s/Ãtdb.h
>

45 
	#_PATH_HEQUIV
 "/‘c/ho¡s.equiv"

	)

46 
	#_PATH_HOSTS
 "/‘c/ho¡s"

	)

47 
	#_PATH_NETWORKS
 "/‘c/ÃtwÜks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/‘c/nssw™ch.cÚf"

	)

49 
	#_PATH_PROTOCOLS
 "/‘c/´ÙocŞs"

	)

50 
	#_PATH_SERVICES
 "/‘c/£rviûs"

	)

53 
	g__BEGIN_DECLS


55 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


58 
	#h_”ºo
 (*
	`__h_”ºo_loÿtiÚ
 ())

	)

61 *
	$__h_”ºo_loÿtiÚ
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifdeà
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifdeà
__USE_MISC


92 
	$h”rÜ
 (cÚ¡ *
__¡r
è
__THROW
;

95 cÚ¡ *
	$h¡»¼Ü
 (
__”r_num
è
__THROW
;

100 
	sho¡’t


102 *
h_Çme
;

103 **
h_®Ÿ£s
;

104 
h_add¹y³
;

105 
h_Ëngth
;

106 **
h_addr_li¡
;

107 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


108 
	#h_addr
 
h_addr_li¡
[0]

	)

117 
	`£tho¡’t
 (
__¡ay_İ’
);

123 
	`’dho¡’t
 ();

130 
ho¡’t
 *
	`g‘ho¡’t
 ();

137 
ho¡’t
 *
	`g‘ho¡byaddr
 (cÚ¡ *
__addr
, 
__sockËn_t
 
__Ën
,

138 
__ty³
);

144 
ho¡’t
 *
	`g‘ho¡byÇme
 (cÚ¡ *
__Çme
);

146 #ifdeà
__USE_MISC


155 
ho¡’t
 *
	`g‘ho¡byÇme2
 (cÚ¡ *
__Çme
, 
__af
);

167 
	`g‘ho¡’t_r
 (
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

168 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

169 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

170 *
__»¡riù
 
__h_”ºİ
);

172 
	`g‘ho¡byaddr_r
 (cÚ¡ *
__»¡riù
 
__addr
, 
__sockËn_t
 
__Ën
,

173 
__ty³
,

174 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

175 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

176 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

177 *
__»¡riù
 
__h_”ºİ
);

179 
	`g‘ho¡byÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

180 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

181 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

182 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

183 *
__»¡riù
 
__h_”ºİ
);

185 
	`g‘ho¡byÇme2_r
 (cÚ¡ *
__»¡riù
 
__Çme
, 
__af
,

186 
ho¡’t
 *
__»¡riù
 
__»suÉ_buf
,

187 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

188 
ho¡’t
 **
__»¡riù
 
__»suÉ
,

189 *
__»¡riù
 
__h_”ºİ
);

198 
	`£Š‘’t
 (
__¡ay_İ’
);

204 
	`’dÃ‹Á
 ();

211 
Ã‹Á
 *
	`g‘Ã‹Á
 ();

218 
Ã‹Á
 *
	`g‘Ãtbyaddr
 (
ušt32_t
 
__Ãt
, 
__ty³
);

224 
Ã‹Á
 *
	`g‘ÃtbyÇme
 (cÚ¡ *
__Çme
);

226 #ifdef 
__USE_MISC


237 
	`g‘Ã‹Á_r
 (
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

238 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

239 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

240 *
__»¡riù
 
__h_”ºİ
);

242 
	`g‘Ãtbyaddr_r
 (
ušt32_t
 
__Ãt
, 
__ty³
,

243 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

244 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

245 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

246 *
__»¡riù
 
__h_”ºİ
);

248 
	`g‘ÃtbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

249 
Ã‹Á
 *
__»¡riù
 
__»suÉ_buf
,

250 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

251 
Ã‹Á
 **
__»¡riù
 
__»suÉ
,

252 *
__»¡riù
 
__h_”ºİ
);

257 
	s£rv’t


259 *
s_Çme
;

260 **
s_®Ÿ£s
;

261 
s_pÜt
;

262 *
s_´Ùo
;

270 
	`£t£rv’t
 (
__¡ay_İ’
);

276 
	`’d£rv’t
 ();

283 
£rv’t
 *
	`g‘£rv’t
 ();

290 
£rv’t
 *
	`g‘£rvbyÇme
 (cÚ¡ *
__Çme
, cÚ¡ *
__´Ùo
);

297 
£rv’t
 *
	`g‘£rvbypÜt
 (
__pÜt
, cÚ¡ *
__´Ùo
);

300 #ifdef 
__USE_MISC


308 
	`g‘£rv’t_r
 (
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

309 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

310 
£rv’t
 **
__»¡riù
 
__»suÉ
);

312 
	`g‘£rvbyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

313 cÚ¡ *
__»¡riù
 
__´Ùo
,

314 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

315 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

316 
£rv’t
 **
__»¡riù
 
__»suÉ
);

318 
	`g‘£rvbypÜt_r
 (
__pÜt
, cÚ¡ *
__»¡riù
 
__´Ùo
,

319 
£rv’t
 *
__»¡riù
 
__»suÉ_buf
,

320 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

321 
£rv’t
 **
__»¡riù
 
__»suÉ
);

326 
	s´ÙÛÁ


328 *
p_Çme
;

329 **
p_®Ÿ£s
;

330 
p_´Ùo
;

338 
	`£rÙÛÁ
 (
__¡ay_İ’
);

344 
	`’d´ÙÛÁ
 ();

351 
´ÙÛÁ
 *
	`g‘´ÙÛÁ
 ();

357 
´ÙÛÁ
 *
	`g‘´ÙobyÇme
 (cÚ¡ *
__Çme
);

363 
´ÙÛÁ
 *
	`g‘´Ùobynumb”
 (
__´Ùo
);

366 #ifdef 
__USE_MISC


374 
	`g‘´ÙÛÁ_r
 (
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

375 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

376 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

378 
	`g‘´ÙobyÇme_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

379 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

380 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

381 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

383 
	`g‘´Ùobynumb”_r
 (
__´Ùo
,

384 
´ÙÛÁ
 *
__»¡riù
 
__»suÉ_buf
,

385 *
__»¡riù
 
__buf
, 
size_t
 
__buæ’
,

386 
´ÙÛÁ
 **
__»¡riù
 
__»suÉ
);

395 
	`£Š‘g»Á
 (cÚ¡ *
__Ãtgroup
);

403 
	`’dÃtg»Á
 ();

412 
	`g‘Ãtg»Á
 (**
__»¡riù
 
__ho¡p
,

413 **
__»¡riù
 
__u£½
,

414 **
__»¡riù
 
__domašp
);

423 
	`šÃtgr
 (cÚ¡ *
__Ãtgroup
, cÚ¡ *
__ho¡
,

424 cÚ¡ *
__u£r
, cÚ¡ *
__domaš
);

432 
	`g‘Ãtg»Á_r
 (**
__»¡riù
 
__ho¡p
,

433 **
__»¡riù
 
__u£½
,

434 **
__»¡riù
 
__domašp
,

435 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
);

439 #ifdeà
__USE_BSD


451 
	`rcmd
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

452 cÚ¡ *
__»¡riù
 
__locu£r
,

453 cÚ¡ *
__»¡riù
 
__»mu£r
,

454 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

463 
	`rcmd_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

464 cÚ¡ *
__»¡riù
 
__locu£r
,

465 cÚ¡ *
__»¡riù
 
__»mu£r
,

466 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

467 
§_çmy_t
 
__af
);

479 
	`»xec
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

480 cÚ¡ *
__»¡riù
 
__Çme
,

481 cÚ¡ *
__»¡riù
 
__·ss
,

482 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
);

491 
	`»xec_af
 (**
__»¡riù
 
__aho¡
, 
__½Üt
,

492 cÚ¡ *
__»¡riù
 
__Çme
,

493 cÚ¡ *
__»¡riù
 
__·ss
,

494 cÚ¡ *
__»¡riù
 
__cmd
, *__»¡riù 
__fd2p
,

495 
§_çmy_t
 
__af
);

505 
	`ru£rok
 (cÚ¡ *
__rho¡
, 
__su£r
,

506 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

515 
	`ru£rok_af
 (cÚ¡ *
__rho¡
, 
__su£r
,

516 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

517 
§_çmy_t
 
__af
);

528 
	`œu£rok
 (
ušt32_t
 
__¿ddr
, 
__su£r
,

529 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
);

539 
	`œu£rok_af
 (cÚ¡ *
__¿ddr
, 
__su£r
,

540 cÚ¡ *
__»mu£r
, cÚ¡ *
__locu£r
,

541 
§_çmy_t
 
__af
);

551 
	`¼esvpÜt
 (*
__®pÜt
);

560 
	`¼esvpÜt_af
 (*
__®pÜt
, 
§_çmy_t
 
__af
);

565 #ifdef 
__USE_POSIX


567 
	saddršfo


569 
ai_æags
;

570 
ai_çmy
;

571 
ai_sockty³
;

572 
ai_´ÙocŞ
;

573 
sockËn_t
 
ai_add¾’
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_ÿnÚÇme
;

576 
addršfo
 *
ai_Ãxt
;

579 #ifdeà
__USE_GNU


581 
	sgaicb


583 cÚ¡ *
¬_Çme
;

584 cÚ¡ *
¬_£rviû
;

585 cÚ¡ 
addršfo
 *
¬_»que¡
;

586 
addršfo
 *
¬_»suÉ
;

588 
__»tuº
;

589 
__glibc_»£rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifdeà
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifdeà
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifdeà
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifdeà
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`g‘addršfo
 (cÚ¡ *
__»¡riù
 
__Çme
,

663 cÚ¡ *
__»¡riù
 
__£rviû
,

664 cÚ¡ 
addršfo
 *
__»¡riù
 
__»q
,

665 
addršfo
 **
__»¡riù
 
__·i
);

668 
	$ä“addršfo
 (
addršfo
 *
__ai
è
__THROW
;

671 cÚ¡ *
	$gai_¡»¼Ü
 (
__ecode
è
__THROW
;

677 
	`g‘Çmešfo
 (cÚ¡ 
sockaddr
 *
__»¡riù
 
__§
,

678 
sockËn_t
 
__§Ën
, *
__»¡riù
 
__ho¡
,

679 
sockËn_t
 
__ho¡Ën
, *
__»¡riù
 
__£rv
,

680 
sockËn_t
 
__£rvËn
, 
__æags
);

683 #ifdeà
__USE_GNU


692 
	`g‘addršfo_a
 (
__mode
, 
gaicb
 *
__li¡
[
__»¡riù_¬r
],

693 
__’t
, 
sigev’t
 *
__»¡riù
 
__sig
);

703 
	`gai_su¥’d
 (cÚ¡ 
gaicb
 *cÚ¡ 
__li¡
[], 
__’t
,

704 cÚ¡ 
time¥ec
 *
__timeout
);

707 
	$gai_”rÜ
 (
gaicb
 *
__»q
è
__THROW
;

710 
	$gai_ÿnûl
 (
gaicb
 *
__gaicbp
è
__THROW
;

713 
__END_DECLS


	@/usr/include/neteconet/ec.h

19 #iâdeà
_NETECONET_EC_H


20 
	#_NETECONET_EC_H
 1

	)

22 
	~<ã©u»s.h
>

23 
	~<b™s/sockaddr.h
>

25 
	sec_addr


27 
	m¡©iÚ
;

28 
	mÃt
;

31 
	ssockaddr_ec


33 
__SOCKADDR_COMMON
 (
£c_
);

34 
	mpÜt
;

35 
	mcb
;

36 
	mty³
;

37 
ec_addr
 
	maddr
;

38 
	mcook›
;

41 
	#ECTYPE_PACKET_RECEIVED
 0

	)

42 
	#ECTYPE_TRANSMIT_STATUS
 0x10

	)

44 
	#ECTYPE_TRANSMIT_OK
 1

	)

45 
	#ECTYPE_TRANSMIT_NOT_LISTENING
 2

	)

46 
	#ECTYPE_TRANSMIT_NET_ERROR
 3

	)

47 
	#ECTYPE_TRANSMIT_NO_CLOCK
 4

	)

48 
	#ECTYPE_TRANSMIT_LINE_JAMMED
 5

	)

49 
	#ECTYPE_TRANSMIT_NOT_PRESENT
 6

	)

	@/usr/include/netinet/if_fddi.h

18 #iâdeà
_NETINET_IF_FDDI_H


19 
	#_NETINET_IF_FDDI_H
 1

	)

21 
	~<sys/cdefs.h
>

22 
	~<sys/ty³s.h
>

23 
	~<asm/ty³s.h
>

25 
	~<lšux/if_fddi.h
>

27 #ifdeà
__USE_BSD


29 
	sfddi_h—d”
 {

30 
u_št8_t
 
	mfddi_fc
;

31 
u_št8_t
 
	mfddi_dho¡
[
FDDI_K_ALEN
];

32 
u_št8_t
 
	mfddi_sho¡
[
FDDI_K_ALEN
];

	@/usr/include/netinet/in.h

18 #iâdef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<¡dšt.h
>

23 
	~<sys/sock‘.h
>

24 
	~<b™s/ty³s.h
>

27 
__BEGIN_DECLS


30 
ušt32_t
 
	tš_addr_t
;

31 
	sš_addr


33 
š_addr_t
 
	ms_addr
;

37 
	~<b™s/š.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_RAW
 = 255,

89 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

90 
	mIPPROTO_MAX


96 #iâdeà
__USE_KERNEL_IPV6_DEFS


99 
	mIPPROTO_HOPOPTS
 = 0,

100 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

101 
	mIPPROTO_ROUTING
 = 43,

102 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

103 
	mIPPROTO_FRAGMENT
 = 44,

104 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

105 
	mIPPROTO_ICMPV6
 = 58,

106 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

107 
	mIPPROTO_NONE
 = 59,

108 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

109 
	mIPPROTO_DSTOPTS
 = 60,

110 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

111 
	mIPPROTO_MH
 = 135

112 
	#IPPROTO_MH
 
IPPROTO_MH


	)

117 
ušt16_t
 
	tš_pÜt_t
;

122 
	mIPPORT_ECHO
 = 7,

123 
	mIPPORT_DISCARD
 = 9,

124 
	mIPPORT_SYSTAT
 = 11,

125 
	mIPPORT_DAYTIME
 = 13,

126 
	mIPPORT_NETSTAT
 = 15,

127 
	mIPPORT_FTP
 = 21,

128 
	mIPPORT_TELNET
 = 23,

129 
	mIPPORT_SMTP
 = 25,

130 
	mIPPORT_TIMESERVER
 = 37,

131 
	mIPPORT_NAMESERVER
 = 42,

132 
	mIPPORT_WHOIS
 = 43,

133 
	mIPPORT_MTP
 = 57,

135 
	mIPPORT_TFTP
 = 69,

136 
	mIPPORT_RJE
 = 77,

137 
	mIPPORT_FINGER
 = 79,

138 
	mIPPORT_TTYLINK
 = 87,

139 
	mIPPORT_SUPDUP
 = 95,

142 
	mIPPORT_EXECSERVER
 = 512,

143 
	mIPPORT_LOGINSERVER
 = 513,

144 
	mIPPORT_CMDSERVER
 = 514,

145 
	mIPPORT_EFSSERVER
 = 520,

148 
	mIPPORT_BIFFUDP
 = 512,

149 
	mIPPORT_WHOSERVER
 = 513,

150 
	mIPPORT_ROUTESERVER
 = 520,

153 
	mIPPORT_RESERVED
 = 1024,

156 
	mIPPORT_USERRESERVED
 = 5000

164 
	#IN_CLASSA
(
a
è((((
š_addr_t
)×)è& 0x80000000è=ğ0)

	)

165 
	#IN_CLASSA_NET
 0xff000000

	)

166 
	#IN_CLASSA_NSHIFT
 24

	)

167 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

168 
	#IN_CLASSA_MAX
 128

	)

170 
	#IN_CLASSB
(
a
è((((
š_addr_t
)×)è& 0xc0000000è=ğ0x80000000)

	)

171 
	#IN_CLASSB_NET
 0xffff0000

	)

172 
	#IN_CLASSB_NSHIFT
 16

	)

173 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

174 
	#IN_CLASSB_MAX
 65536

	)

176 
	#IN_CLASSC
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xc0000000)

	)

177 
	#IN_CLASSC_NET
 0xffffff00

	)

178 
	#IN_CLASSC_NSHIFT
 8

	)

179 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

181 
	#IN_CLASSD
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xe0000000)

	)

182 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

184 
	#IN_EXPERIMENTAL
(
a
è((((
š_addr_t
)×)è& 0xe0000000è=ğ0xe0000000)

	)

185 
	#IN_BADCLASS
(
a
è((((
š_addr_t
)×)è& 0xf0000000è=ğ0xf0000000)

	)

188 
	#INADDR_ANY
 ((
š_addr_t
è0x00000000)

	)

190 
	#INADDR_BROADCAST
 ((
š_addr_t
è0xffffffff)

	)

192 
	#INADDR_NONE
 ((
š_addr_t
è0xffffffff)

	)

195 
	#IN_LOOPBACKNET
 127

	)

197 #iâdeà
INADDR_LOOPBACK


198 
	#INADDR_LOOPBACK
 ((
š_addr_t
è0x7f000001è

	)

202 
	#INADDR_UNSPEC_GROUP
 ((
š_addr_t
è0xe0000000è

	)

203 
	#INADDR_ALLHOSTS_GROUP
 ((
š_addr_t
è0xe0000001è

	)

204 
	#INADDR_ALLRTRS_GROUP
 ((
š_addr_t
è0xe0000002è

	)

205 
	#INADDR_MAX_LOCAL_GROUP
 ((
š_addr_t
è0xe00000ffè

	)

207 #iâdeà
__USE_KERNEL_IPV6_DEFS


209 
	sš6_addr


213 
ušt8_t
 
	m__u6_addr8
[16];

214 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


215 
ušt16_t
 
	m__u6_addr16
[8];

216 
ušt32_t
 
	m__u6_addr32
[4];

218 } 
	m__š6_u
;

219 
	#s6_addr
 
__š6_u
.
__u6_addr8


	)

220 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


221 
	#s6_addr16
 
__š6_u
.
__u6_addr16


	)

222 
	#s6_addr32
 
__š6_u
.
__u6_addr32


	)

227 cÚ¡ 
š6_addr
 
š6addr_ªy
;

228 cÚ¡ 
š6_addr
 
š6addr_loİback
;

229 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

230 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

232 
	#INET_ADDRSTRLEN
 16

	)

233 
	#INET6_ADDRSTRLEN
 46

	)

237 
	ssockaddr_š


239 
__SOCKADDR_COMMON
 (
sš_
);

240 
š_pÜt_t
 
	msš_pÜt
;

241 
š_addr
 
	msš_addr
;

244 
	msš_z”o
[ (
sockaddr
) -

245 
__SOCKADDR_COMMON_SIZE
 -

246  (
š_pÜt_t
) -

247  (
š_addr
)];

250 #iâdeà
__USE_KERNEL_IPV6_DEFS


252 
	ssockaddr_š6


254 
__SOCKADDR_COMMON
 (
sš6_
);

255 
š_pÜt_t
 
	msš6_pÜt
;

256 
ušt32_t
 
	msš6_æowšfo
;

257 
š6_addr
 
	msš6_addr
;

258 
ušt32_t
 
	msš6_scİe_id
;

262 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


264 
	s_m»q


267 
š_addr
 
	mimr_muÉŸddr
;

270 
š_addr
 
	mimr_š‹rçû
;

273 
	s_m»q_sourû


276 
š_addr
 
	mimr_muÉŸddr
;

279 
š_addr
 
	mimr_š‹rçû
;

282 
š_addr
 
	mimr_sourûaddr
;

286 #iâdeà
__USE_KERNEL_IPV6_DEFS


288 
	sv6_m»q


291 
š6_addr
 
	mv6mr_muÉŸddr
;

294 
	mv6mr_š‹rçû
;

298 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


300 
	sgroup_»q


303 
ušt32_t
 
	mgr_š‹rçû
;

306 
sockaddr_¡Üage
 
	mgr_group
;

309 
	sgroup_sourû_»q


312 
ušt32_t
 
	mg¤_š‹rçû
;

315 
sockaddr_¡Üage
 
	mg¤_group
;

318 
sockaddr_¡Üage
 
	mg¤_sourû
;

323 
	s_msf‹r


326 
š_addr
 
	mimsf_muÉŸddr
;

329 
š_addr
 
	mimsf_š‹rçû
;

332 
ušt32_t
 
	mimsf_fmode
;

335 
ušt32_t
 
	mimsf_num¤c
;

337 
š_addr
 
	mimsf_¦i¡
[1];

340 
	#IP_MSFILTER_SIZE
(
num¤c
è( (
_msf‹r
) \

341 -  (
š_addr
) \

342 + (
num¤c
è*  (
š_addr
))

	)

344 
	sgroup_f‹r


347 
ušt32_t
 
	mgf_š‹rçû
;

350 
sockaddr_¡Üage
 
	mgf_group
;

353 
ušt32_t
 
	mgf_fmode
;

356 
ušt32_t
 
	mgf_num¤c
;

358 
sockaddr_¡Üage
 
	mgf_¦i¡
[1];

361 
	#GROUP_FILTER_SIZE
(
num¤c
è( (
group_f‹r
) \

362 -  (
sockaddr_¡Üage
) \

363 + ((
num¤c
) \

364 *  (
sockaddr_¡Üage
)))

	)

374 
ušt32_t
 
	$Áohl
 (
ušt32_t
 
__ÃÚg
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

375 
ušt16_t
 
	$Áohs
 (
ušt16_t
 
__ÃtshÜt
)

376 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

377 
ušt32_t
 
	$htÚl
 (
ušt32_t
 
__ho¡lÚg
)

378 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

379 
ušt16_t
 
	$htÚs
 (
ušt16_t
 
__ho¡shÜt
)

380 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

382 
	~<’dŸn.h
>

385 
	~<b™s/by‹sw­.h
>

387 #ifdeà
__OPTIMIZE__


391 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


394 
	#Áohl
(
x
è(x)

	)

395 
	#Áohs
(
x
è(x)

	)

396 
	#htÚl
(
x
è(x)

	)

397 
	#htÚs
(
x
è(x)

	)

399 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


400 
	#Áohl
(
x
è
	`__bsw­_32
 (x)

	)

401 
	#Áohs
(
x
è
	`__bsw­_16
 (x)

	)

402 
	#htÚl
(
x
è
	`__bsw­_32
 (x)

	)

403 
	#htÚs
(
x
è
	`__bsw­_16
 (x)

	)

408 #ifdeà
__GNUC__


409 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

410 (
__ex‹nsiÚ__
 \

411 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

412 
__a
->
s6_addr32
[0] == 0 \

413 && 
__a
->
s6_addr32
[1] == 0 \

414 && 
__a
->
s6_addr32
[2] == 0 \

415 && 
__a
->
s6_addr32
[3] =ğ0; 
	}
}))

	)

417 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

418 (
__ex‹nsiÚ__
 \

419 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

420 
__a
->
s6_addr32
[0] == 0 \

421 && 
__a
->
s6_addr32
[1] == 0 \

422 && 
__a
->
s6_addr32
[2] == 0 \

423 && 
__a
->
s6_addr32
[3] =ğ
	`htÚl
 (1); }))

	)

425 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

426 (
__ex‹nsiÚ__
 \

427 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

428 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xã800000); }))

	)

430 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

431 (
__ex‹nsiÚ__
 \

432 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

433 (
__a
->
s6_addr32
[0] & 
	`htÚl
 (0xffc00000)è=ğhtÚÈ(0xãc00000); }))

	)

435 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

436 (
__ex‹nsiÚ__
 \

437 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

438 
__a
->
s6_addr32
[0] == 0 \

439 && 
__a
->
s6_addr32
[1] == 0 \

440 && 
__a
->
s6_addr32
[2] =ğ
	`htÚl
 (0xffff); }))

	)

442 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

443 (
__ex‹nsiÚ__
 \

444 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

445 
__a
->
s6_addr32
[0] == 0 \

446 && 
__a
->
s6_addr32
[1] == 0 \

447 && 
__a
->
s6_addr32
[2] == 0 \

448 && 
	`Áohl
 (
__a
->
s6_addr32
[3]è> 1; }))

	)

450 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

451 (
__ex‹nsiÚ__
 \

452 ({ cÚ¡ 
š6_addr
 *
__a
 = (cÚ¡ š6_add¸*è(
a
); \

453 cÚ¡ 
š6_addr
 *
__b
 = (cÚ¡ š6_add¸*è(
b
); \

454 
__a
->
s6_addr32
[0] =ğ
__b
->s6_addr32[0] \

455 && 
__a
->
s6_addr32
[1] =ğ
__b
->s6_addr32[1] \

456 && 
__a
->
s6_addr32
[2] =ğ
__b
->s6_addr32[2] \

457 && 
__a
->
s6_addr32
[3] =ğ
__b
->s6_addr32[3]; }))

	)

459 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

460 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

461 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

462 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

463 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ0)

	)

465 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

466 (((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0 \

467 && ((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0 \

468 && ((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0 \

469 && ((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ
	`htÚl
 (1))

	)

471 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

472 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

473 =ğ
	`htÚl
 (0xã800000))

	)

475 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

476 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] & 
	`htÚl
 (0xffc00000)) \

477 =ğ
	`htÚl
 (0xãc00000))

	)

479 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

480 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

481 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

482 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ
	`htÚl
 (0xffff)))

	)

484 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

485 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] == 0) \

486 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] == 0) \

487 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] == 0) \

488 && (
	`Áohl
 (((cÚ¡ 
ušt32_t
 *è(
a
))[3]è> 1))

	)

490 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

491 ((((cÚ¡ 
ušt32_t
 *è(
a
))[0] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[0]) \

492 && (((cÚ¡ 
ušt32_t
 *è(
a
))[1] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[1]) \

493 && (((cÚ¡ 
ušt32_t
 *è(
a
))[2] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[2]) \

494 && (((cÚ¡ 
ušt32_t
 *è(
a
))[3] =ğ((cÚ¡ ušt32_ˆ*è(
b
))[3]))

	)

497 
	#IN6_IS_ADDR_MULTICAST
(
a
è(((cÚ¡ 
ušt8_t
 *è×))[0] =ğ0xff)

	)

499 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_GNU


501 
	$bšd»svpÜt
 (
__sockfd
, 
sockaddr_š
 *
__sock_š
è
__THROW
;

504 
	$bšd»svpÜt6
 (
__sockfd
, 
sockaddr_š6
 *
__sock_š
)

505 
__THROW
;

509 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

510 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

511 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x1))

	)

513 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

514 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

515 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x2))

	)

517 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

518 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

519 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x5))

	)

521 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

522 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

523 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0x8))

	)

525 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

526 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

527 && ((((cÚ¡ 
ušt8_t
 *è(
a
))[1] & 0xfè=ğ0xe))

	)

530 #ifdeà
__USE_GNU


531 
cmsghdr
;

534 
	sš6_pktšfo


536 
š6_addr
 
i6_addr
;

537 
i6_ifšdex
;

541 
	s6_mtušfo


543 
sockaddr_š6
 
6m_addr
;

544 
ušt32_t
 
6m_mtu
;

549 
	$š‘6_İtiÚ_¥aû
 (
__nby‹s
)

550 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

551 
	$š‘6_İtiÚ_š™
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

552 
__ty³
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

553 
	$š‘6_İtiÚ_­³nd
 (
cmsghdr
 *
__cmsg
,

554 cÚ¡ 
ušt8_t
 *
__ty³p
, 
__muÉx
,

555 
__¶usy
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

556 
ušt8_t
 *
	$š‘6_İtiÚ_®loc
 (
cmsghdr
 *
__cmsg
, 
__d©®’
,

557 
__muÉx
, 
__¶usy
)

558 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

559 
	$š‘6_İtiÚ_Ãxt
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

560 
ušt8_t
 **
__Œp
)

561 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

562 
	$š‘6_İtiÚ_fšd
 (cÚ¡ 
cmsghdr
 *
__cmsg
,

563 
ušt8_t
 **
__Œp
, 
__ty³
)

564 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

568 
	$š‘6_İt_š™
 (*
__extbuf
, 
sockËn_t
 
__ex’
è
__THROW
;

569 
	$š‘6_İt_­³nd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

570 
ušt8_t
 
__ty³
, 
sockËn_t
 
__Ën
, ušt8_ˆ
__®ign
,

571 **
__d©abuå
è
__THROW
;

572 
	$š‘6_İt_fšish
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
)

573 
__THROW
;

574 
	$š‘6_İt_£t_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

575 
sockËn_t
 
__v®Ën
è
__THROW
;

576 
	$š‘6_İt_Ãxt
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

577 
ušt8_t
 *
__ty³p
, 
sockËn_t
 *
__ËÅ
,

578 **
__d©abuå
è
__THROW
;

579 
	$š‘6_İt_fšd
 (*
__extbuf
, 
sockËn_t
 
__ex’
, 
__off£t
,

580 
ušt8_t
 
__ty³
, 
sockËn_t
 *
__ËÅ
,

581 **
__d©abuå
è
__THROW
;

582 
	$š‘6_İt_g‘_v®
 (*
__d©abuf
, 
__off£t
, *
__v®
,

583 
sockËn_t
 
__v®Ën
è
__THROW
;

587 
sockËn_t
 
	$š‘6_¹h_¥aû
 (
__ty³
, 
__£gm’ts
è
__THROW
;

588 *
	$š‘6_¹h_š™
 (*
__bp
, 
sockËn_t
 
__bp_Ën
, 
__ty³
,

589 
__£gm’ts
è
__THROW
;

590 
	$š‘6_¹h_add
 (*
__bp
, cÚ¡ 
š6_addr
 *
__addr
è
__THROW
;

591 
	$š‘6_¹h_»v”£
 (cÚ¡ *
__š
, *
__out
è
__THROW
;

592 
	$š‘6_¹h_£gm’ts
 (cÚ¡ *
__bp
è
__THROW
;

593 
š6_addr
 *
	$š‘6_¹h_g‘addr
 (cÚ¡ *
__bp
, 
__šdex
)

594 
__THROW
;

600 
	$g‘v4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

601 
š_addr
 
__group
, 
ušt32_t
 *
__fmode
,

602 
ušt32_t
 *
__num¤c
, 
š_addr
 *
__¦i¡
)

603 
__THROW
;

606 
	$£tv4sourûf‹r
 (
__s
, 
š_addr
 
__š‹rçû_addr
,

607 
š_addr
 
__group
, 
ušt32_t
 
__fmode
,

608 
ušt32_t
 
__num¤c
,

609 cÚ¡ 
š_addr
 *
__¦i¡
)

610 
__THROW
;

614 
	$g‘sourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

615 cÚ¡ 
sockaddr
 *
__group
,

616 
sockËn_t
 
__grou¶’
, 
ušt32_t
 *
__fmode
,

617 
ušt32_t
 *
__num¤c
,

618 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

621 
	$£tsourûf‹r
 (
__s
, 
ušt32_t
 
__š‹rçû_addr
,

622 cÚ¡ 
sockaddr
 *
__group
,

623 
sockËn_t
 
__grou¶’
, 
ušt32_t
 
__fmode
,

624 
ušt32_t
 
__num¤c
,

625 cÚ¡ 
sockaddr_¡Üage
 *
__¦i¡
è
__THROW
;

628 
__END_DECLS


	@/usr/include/netinet/ip.h

18 #iâdeà
__NETINET_IP_H


19 
	#__NETINET_IP_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<sys/ty³s.h
>

24 
	~<Ãtš‘/š.h
>

26 
__BEGIN_DECLS


28 
	stime¡amp


30 
u_št8_t
 
	mËn
;

31 
u_št8_t
 
	m±r
;

32 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


33 
	mæags
:4;

34 
	mov”æow
:4;

35 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


36 
	mov”æow
:4;

37 
	mæags
:4;

41 
u_št32_t
 
	md©a
[9];

44 
	shdr


46 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


47 
	mihl
:4;

48 
	mv”siÚ
:4;

49 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


50 
	mv”siÚ
:4;

51 
	mihl
:4;

55 
u_št8_t
 
	mtos
;

56 
u_št16_t
 
	mtÙ_Ën
;

57 
u_št16_t
 
	mid
;

58 
u_št16_t
 
	mäag_off
;

59 
u_št8_t
 
	m‰l
;

60 
u_št8_t
 
	m´ÙocŞ
;

61 
u_št16_t
 
	mcheck
;

62 
u_št32_t
 
	m§ddr
;

63 
u_št32_t
 
	mdaddr
;

67 #ifdeà
__USE_BSD


107 
	s


109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
	m_hl
:4;

111 
	m_v
:4;

113 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


114 
	m_v
:4;

115 
	m_hl
:4;

117 
u_št8_t
 
	m_tos
;

118 
u_shÜt
 
	m_Ën
;

119 
u_shÜt
 
	m_id
;

120 
u_shÜt
 
	m_off
;

121 
	#IP_RF
 0x8000

	)

122 
	#IP_DF
 0x4000

	)

123 
	#IP_MF
 0x2000

	)

124 
	#IP_OFFMASK
 0x1ffà

	)

125 
u_št8_t
 
	m_‰l
;

126 
u_št8_t
 
	m_p
;

127 
u_shÜt
 
	m_sum
;

128 
š_addr
 
	m_¤c
, 
	m_d¡
;

134 
	s_time¡amp


136 
u_št8_t
 
	mt_code
;

137 
u_št8_t
 
	mt_Ën
;

138 
u_št8_t
 
	mt_±r
;

139 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


140 
	mt_æg
:4;

141 
	mt_oæw
:4;

143 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


144 
	mt_oæw
:4;

145 
	mt_æg
:4;

147 
u_št32_t
 
	md©a
[9];

151 
	#IPVERSION
 4

	)

152 
	#IP_MAXPACKET
 65535

	)

160 
	#IPTOS_ECN_MASK
 0x03

	)

161 
	#IPTOS_ECN
(
x
è((xè& 
IPTOS_ECN_MASK
)

	)

162 
	#IPTOS_ECN_NOT_ECT
 0x00

	)

163 
	#IPTOS_ECN_ECT1
 0x01

	)

164 
	#IPTOS_ECN_ECT0
 0x02

	)

165 
	#IPTOS_ECN_CE
 0x03

	)

173 
	#IPTOS_DSCP_MASK
 0xfc

	)

174 
	#IPTOS_DSCP
(
x
è((xè& 
IPTOS_DSCP_MASK
)

	)

175 
	#IPTOS_DSCP_AF11
 0x28

	)

176 
	#IPTOS_DSCP_AF12
 0x30

	)

177 
	#IPTOS_DSCP_AF13
 0x38

	)

178 
	#IPTOS_DSCP_AF21
 0x48

	)

179 
	#IPTOS_DSCP_AF22
 0x50

	)

180 
	#IPTOS_DSCP_AF23
 0x58

	)

181 
	#IPTOS_DSCP_AF31
 0x68

	)

182 
	#IPTOS_DSCP_AF32
 0x70

	)

183 
	#IPTOS_DSCP_AF33
 0x78

	)

184 
	#IPTOS_DSCP_AF41
 0x88

	)

185 
	#IPTOS_DSCP_AF42
 0x90

	)

186 
	#IPTOS_DSCP_AF43
 0x98

	)

187 
	#IPTOS_DSCP_EF
 0xb8

	)

194 
	#IPTOS_CLASS_MASK
 0xe0

	)

195 
	#IPTOS_CLASS
(
şass
è((şassè& 
IPTOS_CLASS_MASK
)

	)

196 
	#IPTOS_CLASS_CS0
 0x00

	)

197 
	#IPTOS_CLASS_CS1
 0x20

	)

198 
	#IPTOS_CLASS_CS2
 0x40

	)

199 
	#IPTOS_CLASS_CS3
 0x60

	)

200 
	#IPTOS_CLASS_CS4
 0x80

	)

201 
	#IPTOS_CLASS_CS5
 0xa0

	)

202 
	#IPTOS_CLASS_CS6
 0xc0

	)

203 
	#IPTOS_CLASS_CS7
 0xe0

	)

205 
	#IPTOS_CLASS_DEFAULT
 
IPTOS_CLASS_CS0


	)

211 
	#IPTOS_TOS_MASK
 0x1E

	)

212 
	#IPTOS_TOS
(
tos
è(Ñosè& 
IPTOS_TOS_MASK
)

	)

213 
	#IPTOS_LOWDELAY
 0x10

	)

214 
	#IPTOS_THROUGHPUT
 0x08

	)

215 
	#IPTOS_RELIABILITY
 0x04

	)

216 
	#IPTOS_LOWCOST
 0x02

	)

217 
	#IPTOS_MINCOST
 
IPTOS_LOWCOST


	)

222 
	#IPTOS_PREC_MASK
 
IPTOS_CLASS_MASK


	)

223 
	#IPTOS_PREC
(
tos
è
	`IPTOS_CLASS
Ños)

	)

224 
	#IPTOS_PREC_NETCONTROL
 
IPTOS_CLASS_CS7


	)

225 
	#IPTOS_PREC_INTERNETCONTROL
 
IPTOS_CLASS_CS6


	)

226 
	#IPTOS_PREC_CRITIC_ECP
 
IPTOS_CLASS_CS5


	)

227 
	#IPTOS_PREC_FLASHOVERRIDE
 
IPTOS_CLASS_CS4


	)

228 
	#IPTOS_PREC_FLASH
 
IPTOS_CLASS_CS3


	)

229 
	#IPTOS_PREC_IMMEDIATE
 
IPTOS_CLASS_CS2


	)

230 
	#IPTOS_PREC_PRIORITY
 
IPTOS_CLASS_CS1


	)

231 
	#IPTOS_PREC_ROUTINE
 
IPTOS_CLASS_CS0


	)

236 
	#IPOPT_COPY
 0x80

	)

237 
	#IPOPT_CLASS_MASK
 0x60

	)

238 
	#IPOPT_NUMBER_MASK
 0x1f

	)

240 
	#IPOPT_COPIED
(
o
è((oè& 
IPOPT_COPY
)

	)

241 
	#IPOPT_CLASS
(
o
è((oè& 
IPOPT_CLASS_MASK
)

	)

242 
	#IPOPT_NUMBER
(
o
è((oè& 
IPOPT_NUMBER_MASK
)

	)

244 
	#IPOPT_CONTROL
 0x00

	)

245 
	#IPOPT_RESERVED1
 0x20

	)

246 
	#IPOPT_DEBMEAS
 0x40

	)

247 
	#IPOPT_MEASUREMENT
 
IPOPT_DEBMEAS


	)

248 
	#IPOPT_RESERVED2
 0x60

	)

250 
	#IPOPT_EOL
 0

	)

251 
	#IPOPT_END
 
IPOPT_EOL


	)

252 
	#IPOPT_NOP
 1

	)

253 
	#IPOPT_NOOP
 
IPOPT_NOP


	)

255 
	#IPOPT_RR
 7

	)

256 
	#IPOPT_TS
 68

	)

257 
	#IPOPT_TIMESTAMP
 
IPOPT_TS


	)

258 
	#IPOPT_SECURITY
 130

	)

259 
	#IPOPT_SEC
 
IPOPT_SECURITY


	)

260 
	#IPOPT_LSRR
 131

	)

261 
	#IPOPT_SATID
 136

	)

262 
	#IPOPT_SID
 
IPOPT_SATID


	)

263 
	#IPOPT_SSRR
 137

	)

264 
	#IPOPT_RA
 148

	)

269 
	#IPOPT_OPTVAL
 0

	)

270 
	#IPOPT_OLEN
 1

	)

271 
	#IPOPT_OFFSET
 2

	)

272 
	#IPOPT_MINOFF
 4

	)

274 
	#MAX_IPOPTLEN
 40

	)

277 
	#IPOPT_TS_TSONLY
 0

	)

278 
	#IPOPT_TS_TSANDADDR
 1

	)

279 
	#IPOPT_TS_PRESPEC
 3

	)

282 
	#IPOPT_SECUR_UNCLASS
 0x0000

	)

283 
	#IPOPT_SECUR_CONFID
 0xf135

	)

284 
	#IPOPT_SECUR_EFTO
 0x789a

	)

285 
	#IPOPT_SECUR_MMMM
 0xbc4d

	)

286 
	#IPOPT_SECUR_RESTR
 0xaf13

	)

287 
	#IPOPT_SECUR_SECRET
 0xd788

	)

288 
	#IPOPT_SECUR_TOPSECRET
 0x6bc5

	)

293 
	#MAXTTL
 255

	)

294 
	#IPDEFTTL
 64

	)

295 
	#IPFRAGTTL
 60

	)

296 
	#IPTTLDEC
 1

	)

298 
	#IP_MSS
 576

	)

300 
	g__END_DECLS


	@/usr/include/netinet/tcp.h

32 #iâdeà
_NETINET_TCP_H


33 
	#_NETINET_TCP_H
 1

	)

35 
	~<ã©u»s.h
>

40 
	#TCP_NODELAY
 1

	)

41 
	#TCP_MAXSEG
 2

	)

42 
	#TCP_CORK
 3

	)

43 
	#TCP_KEEPIDLE
 4

	)

44 
	#TCP_KEEPINTVL
 5

	)

45 
	#TCP_KEEPCNT
 6

	)

46 
	#TCP_SYNCNT
 7

	)

47 
	#TCP_LINGER2
 8

	)

48 
	#TCP_DEFER_ACCEPT
 9

	)

49 
	#TCP_WINDOW_CLAMP
 10

	)

50 
	#TCP_INFO
 11

	)

51 
	#TCP_QUICKACK
 12

	)

52 
	#TCP_CONGESTION
 13

	)

53 
	#TCP_MD5SIG
 14

	)

54 
	#TCP_COOKIE_TRANSACTIONS
 15

	)

55 
	#TCP_THIN_LINEAR_TIMEOUTS
 16

	)

56 
	#TCP_THIN_DUPACK
 17

	)

57 
	#TCP_USER_TIMEOUT
 18

	)

58 
	#TCP_REPAIR
 19

	)

59 
	#TCP_REPAIR_QUEUE
 20

	)

60 
	#TCP_QUEUE_SEQ
 21

	)

61 
	#TCP_REPAIR_OPTIONS
 22

	)

62 
	#TCP_FASTOPEN
 23

	)

63 
	#TCP_TIMESTAMP
 24

	)

65 #ifdeà
__USE_MISC


66 
	~<sys/ty³s.h
>

67 
	~<sys/sock‘.h
>

69 
u_št32_t
 
	ttı_£q
;

74 
	stıhdr


76 
__ex‹nsiÚ__
 union

80 
u_št16_t
 
	mth_¥Üt
;

81 
u_št16_t
 
	mth_dpÜt
;

82 
tı_£q
 
	mth_£q
;

83 
tı_£q
 
	mth_ack
;

84 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


85 
u_št8_t
 
	mth_x2
:4;

86 
u_št8_t
 
	mth_off
:4;

88 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


89 
u_št8_t
 
	mth_off
:4;

90 
u_št8_t
 
	mth_x2
:4;

92 
u_št8_t
 
	mth_æags
;

93 
	#TH_FIN
 0x01

	)

94 
	#TH_SYN
 0x02

	)

95 
	#TH_RST
 0x04

	)

96 
	#TH_PUSH
 0x08

	)

97 
	#TH_ACK
 0x10

	)

98 
	#TH_URG
 0x20

	)

99 
u_št16_t
 
	mth_wš
;

100 
u_št16_t
 
	mth_sum
;

101 
u_št16_t
 
	mth_u½
;

105 
u_št16_t
 
	msourû
;

106 
u_št16_t
 
	mde¡
;

107 
u_št32_t
 
	m£q
;

108 
u_št32_t
 
	mack_£q
;

109 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


110 
u_št16_t
 
	m»s1
:4;

111 
u_št16_t
 
	mdoff
:4;

112 
u_št16_t
 
	mfš
:1;

113 
u_št16_t
 
	msyn
:1;

114 
u_št16_t
 
	mr¡
:1;

115 
u_št16_t
 
	mpsh
:1;

116 
u_št16_t
 
	mack
:1;

117 
u_št16_t
 
	murg
:1;

118 
u_št16_t
 
	m»s2
:2;

119 #–ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


120 
u_št16_t
 
	mdoff
:4;

121 
u_št16_t
 
	m»s1
:4;

122 
u_št16_t
 
	m»s2
:2;

123 
u_št16_t
 
	murg
:1;

124 
u_št16_t
 
	mack
:1;

125 
u_št16_t
 
	mpsh
:1;

126 
u_št16_t
 
	mr¡
:1;

127 
u_št16_t
 
	msyn
:1;

128 
u_št16_t
 
	mfš
:1;

132 
u_št16_t
 
	mwšdow
;

133 
u_št16_t
 
	mcheck
;

134 
u_št16_t
 
	murg_±r
;

141 
	mTCP_ESTABLISHED
 = 1,

142 
	mTCP_SYN_SENT
,

143 
	mTCP_SYN_RECV
,

144 
	mTCP_FIN_WAIT1
,

145 
	mTCP_FIN_WAIT2
,

146 
	mTCP_TIME_WAIT
,

147 
	mTCP_CLOSE
,

148 
	mTCP_CLOSE_WAIT
,

149 
	mTCP_LAST_ACK
,

150 
	mTCP_LISTEN
,

151 
	mTCP_CLOSING


154 
	#TCPOPT_EOL
 0

	)

155 
	#TCPOPT_NOP
 1

	)

156 
	#TCPOPT_MAXSEG
 2

	)

157 
	#TCPOLEN_MAXSEG
 4

	)

158 
	#TCPOPT_WINDOW
 3

	)

159 
	#TCPOLEN_WINDOW
 3

	)

160 
	#TCPOPT_SACK_PERMITTED
 4

	)

161 
	#TCPOLEN_SACK_PERMITTED
 2

	)

162 
	#TCPOPT_SACK
 5

	)

163 
	#TCPOPT_TIMESTAMP
 8

	)

164 
	#TCPOLEN_TIMESTAMP
 10

	)

165 
	#TCPOLEN_TSTAMP_APPA
 (
TCPOLEN_TIMESTAMP
+2è

	)

167 
	#TCPOPT_TSTAMP_HDR
 \

168 (
TCPOPT_NOP
<<24|TCPOPT_NOP<<16|
TCPOPT_TIMESTAMP
<<8|
TCPOLEN_TIMESTAMP
)

	)

176 
	#TCP_MSS
 512

	)

178 
	#TCP_MAXWIN
 65535

	)

180 
	#TCP_MAX_WINSHIFT
 14

	)

182 
	#SOL_TCP
 6

	)

185 
	#TCPI_OPT_TIMESTAMPS
 1

	)

186 
	#TCPI_OPT_SACK
 2

	)

187 
	#TCPI_OPT_WSCALE
 4

	)

188 
	#TCPI_OPT_ECN
 8

	)

189 
	#TCPI_OPT_ECN_SEEN
 16

	)

190 
	#TCPI_OPT_SYN_DATA
 32

	)

193 
	etı_ÿ_¡©e


195 
	mTCP_CA_O³n
 = 0,

196 
	mTCP_CA_DisÜd”
 = 1,

197 
	mTCP_CA_CWR
 = 2,

198 
	mTCP_CA_Recov”y
 = 3,

199 
	mTCP_CA_Loss
 = 4

202 
	stı_šfo


204 
u_št8_t
 
	mtıi_¡©e
;

205 
u_št8_t
 
	mtıi_ÿ_¡©e
;

206 
u_št8_t
 
	mtıi_»Œªsm™s
;

207 
u_št8_t
 
	mtıi_´obes
;

208 
u_št8_t
 
	mtıi_backoff
;

209 
u_št8_t
 
	mtıi_İtiÚs
;

210 
u_št8_t
 
	mtıi_¢d_wsÿË
 : 4, 
	mtıi_rcv_wsÿË
 : 4;

212 
u_št32_t
 
	mtıi_¹o
;

213 
u_št32_t
 
	mtıi_©o
;

214 
u_št32_t
 
	mtıi_¢d_mss
;

215 
u_št32_t
 
	mtıi_rcv_mss
;

217 
u_št32_t
 
	mtıi_uÇcked
;

218 
u_št32_t
 
	mtıi_§cked
;

219 
u_št32_t
 
	mtıi_lo¡
;

220 
u_št32_t
 
	mtıi_»Œªs
;

221 
u_št32_t
 
	mtıi_çck‘s
;

224 
u_št32_t
 
	mtıi_Ï¡_d©a_£Á
;

225 
u_št32_t
 
	mtıi_Ï¡_ack_£Á
;

226 
u_št32_t
 
	mtıi_Ï¡_d©a_»cv
;

227 
u_št32_t
 
	mtıi_Ï¡_ack_»cv
;

230 
u_št32_t
 
	mtıi_pmtu
;

231 
u_št32_t
 
	mtıi_rcv_s¡h»sh
;

232 
u_št32_t
 
	mtıi_¹t
;

233 
u_št32_t
 
	mtıi_¹tv¬
;

234 
u_št32_t
 
	mtıi_¢d_s¡h»sh
;

235 
u_št32_t
 
	mtıi_¢d_cwnd
;

236 
u_št32_t
 
	mtıi_advmss
;

237 
u_št32_t
 
	mtıi_»Üd”šg
;

239 
u_št32_t
 
	mtıi_rcv_¹t
;

240 
u_št32_t
 
	mtıi_rcv_¥aû
;

242 
u_št32_t
 
	mtıi_tÙ®_»Œªs
;

247 
	#TCP_MD5SIG_MAXKEYLEN
 80

	)

249 
	stı_md5sig


251 
sockaddr_¡Üage
 
	mtım_addr
;

252 
u_št16_t
 
	m__tım_·d1
;

253 
u_št16_t
 
	mtım_keyËn
;

254 
u_št32_t
 
	m__tım_·d2
;

255 
u_št8_t
 
	mtım_key
[
TCP_MD5SIG_MAXKEYLEN
];

259 
	stı_»·œ_İt


261 
u_št32_t
 
	mİt_code
;

262 
u_št32_t
 
	mİt_v®
;

268 
	mTCP_NO_QUEUE
,

269 
	mTCP_RECV_QUEUE
,

270 
	mTCP_SEND_QUEUE
,

271 
	mTCP_QUEUES_NR
,

275 
	#TCP_COOKIE_MIN
 8

	)

276 
	#TCP_COOKIE_MAX
 16

	)

277 
	#TCP_COOKIE_PAIR_SIZE
 (2*
TCP_COOKIE_MAX
)

	)

280 
	#TCP_COOKIE_IN_ALWAYS
 (1 << 0è

	)

281 
	#TCP_COOKIE_OUT_NEVER
 (1 << 1è

	)

285 
	#TCP_S_DATA_IN
 (1 << 2è

	)

286 
	#TCP_S_DATA_OUT
 (1 << 3è

	)

288 
	#TCP_MSS_DEFAULT
 536U

	)

289 
	#TCP_MSS_DESIRED
 1220U

	)

291 
	stı_cook›_Œª§ùiÚs


293 
u_št16_t
 
	mtıù_æags
;

294 
u_št8_t
 
	m__tıù_·d1
;

295 
u_št8_t
 
	mtıù_cook›_desœed
;

296 
u_št16_t
 
	mtıù_s_d©a_desœed
;

297 
u_št16_t
 
	mtıù_u£d
;

298 
u_št8_t
 
	mtıù_v®ue
[
TCP_MSS_DEFAULT
];

	@/usr/include/netipx/ipx.h

18 #iâdeà
__NETIPX_IPX_H


19 
	#__NETIPX_IPX_H
 1

	)

21 
	~<ã©u»s.h
>

23 
	~<sys/ty³s.h
>

24 
	~<b™s/sockaddr.h
>

26 
	g__BEGIN_DECLS


28 
	#SOL_IPX
 256

	)

30 
	#IPX_TYPE
 1

	)

31 
	#IPX_NODE_LEN
 6

	)

32 
	#IPX_MTU
 576

	)

34 
	ssockaddr_x


36 
§_çmy_t
 
	msx_çmy
;

37 
u_št16_t
 
	msx_pÜt
;

38 
u_št32_t
 
	msx_ÃtwÜk
;

39 
	msx_node
[
IPX_NODE_LEN
];

40 
u_št8_t
 
	msx_ty³
;

41 
	msx_z”o
;

48 
	#sx_¥ecŸl
 
sx_pÜt


	)

49 
	#sx_aùiÚ
 
sx_z”o


	)

50 
	#IPX_DLTITF
 0

	)

51 
	#IPX_CRTITF
 1

	)

53 
	sx_rou‹_defš™iÚ


55 
	mx_ÃtwÜk
;

56 
	mx_rou‹r_ÃtwÜk
;

57 
	mx_rou‹r_node
[
IPX_NODE_LEN
];

59 
	tx_rou‹_defš™iÚ
;

61 
	sx_š‹rçû_defš™iÚ


63 
	mx_ÃtwÜk
;

64 
	mx_deviû
[16];

65 
	mx_dlšk_ty³
;

66 
	#IPX_FRAME_NONE
 0

	)

67 
	#IPX_FRAME_SNAP
 1

	)

68 
	#IPX_FRAME_8022
 2

	)

69 
	#IPX_FRAME_ETHERII
 3

	)

70 
	#IPX_FRAME_8023
 4

	)

71 
	#IPX_FRAME_TR_8022
 5

	)

72 
	mx_¥ecŸl
;

73 
	#IPX_SPECIAL_NONE
 0

	)

74 
	#IPX_PRIMARY
 1

	)

75 
	#IPX_INTERNAL
 2

	)

76 
	mx_node
[
IPX_NODE_LEN
];

78 
	tx_š‹rçû_defš™iÚ
;

80 
	sx_cÚfig_d©a


82 
	mxcfg_auto_£Ëù_´im¬y
;

83 
	mxcfg_auto_ü—‹_š‹rçûs
;

85 
	tx_cÚfig_d©a
;

91 
	sx_rou‹_def


93 
	mx_ÃtwÜk
;

94 
	mx_rou‹r_ÃtwÜk
;

95 
	#IPX_ROUTE_NO_ROUTER
 0

	)

96 
	mx_rou‹r_node
[
IPX_NODE_LEN
];

97 
	mx_deviû
[16];

98 
	mx_æags
;

99 
	#IPX_RT_SNAP
 8

	)

100 
	#IPX_RT_8022
 4

	)

101 
	#IPX_RT_BLUEBOOK
 2

	)

102 
	#IPX_RT_ROUTED
 1

	)

105 
	#SIOCAIPXITFCRT
 (
SIOCPROTOPRIVATE
)

	)

106 
	#SIOCAIPXPRISLT
 (
SIOCPROTOPRIVATE
 + 1)

	)

107 
	#SIOCIPXCFGDATA
 (
SIOCPROTOPRIVATE
 + 2)

	)

108 
	#SIOCIPXNCPCONN
 (
SIOCPROTOPRIVATE
 + 3)

	)

110 
	g__END_DECLS


	@/usr/include/paths.h

32 #iâdeà
_PATHS_H_


33 
	#_PATHS_H_


	)

36 
	#_PATH_DEFPATH
 "/u¤/bš:/bš"

	)

38 
	#_PATH_STDPATH
 \

39 "/u¤/bš:/bš:/u¤/sbš:/sbš"

	)

41 
	#_PATH_BSHELL
 "/bš/sh"

	)

42 
	#_PATH_CONSOLE
 "/dev/cÚsŞe"

	)

43 
	#_PATH_CSHELL
 "/bš/csh"

	)

44 
	#_PATH_DEVDB
 "/v¬/run/dev.db"

	)

45 
	#_PATH_DEVNULL
 "/dev/nuÎ"

	)

46 
	#_PATH_DRUM
 "/dev/drum"

	)

47 
	#_PATH_GSHADOW
 "/‘c/gshadow"

	)

48 
	#_PATH_KLOG
 "/´oc/kmsg"

	)

49 
	#_PATH_KMEM
 "/dev/kmem"

	)

50 
	#_PATH_LASTLOG
 "/v¬/log/Ï¡log"

	)

51 
	#_PATH_MAILDIR
 "/v¬/ma"

	)

52 
	#_PATH_MAN
 "/u¤/sh¬e/mª"

	)

53 
	#_PATH_MEM
 "/dev/mem"

	)

54 
	#_PATH_MNTTAB
 "/‘c/f¡ab"

	)

55 
	#_PATH_MOUNTED
 "/‘c/mb"

	)

56 
	#_PATH_NOLOGIN
 "/‘c/nŞogš"

	)

57 
	#_PATH_PRESERVE
 "/v¬/lib"

	)

58 
	#_PATH_RWHODIR
 "/v¬/¥oŞ/rwho"

	)

59 
	#_PATH_SENDMAIL
 "/u¤/sbš/£ndma"

	)

60 
	#_PATH_SHADOW
 "/‘c/shadow"

	)

61 
	#_PATH_SHELLS
 "/‘c/sh–ls"

	)

62 
	#_PATH_TTY
 "/dev/‰y"

	)

63 
	#_PATH_UNIX
 "/boÙ/vmlšux"

	)

64 
	#_PATH_UTMP
 "/v¬/run/utmp"

	)

65 
	#_PATH_VI
 "/u¤/bš/vi"

	)

66 
	#_PATH_WTMP
 "/v¬/log/wtmp"

	)

69 
	#_PATH_DEV
 "/dev/"

	)

70 
	#_PATH_TMP
 "/tmp/"

	)

71 
	#_PATH_VARDB
 "/v¬/lib/misc/"

	)

72 
	#_PATH_VARRUN
 "/v¬/run/"

	)

73 
	#_PATH_VARTMP
 "/v¬/tmp/"

	)

	@/usr/include/pthread.h

18 #iâdeà
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<ã©u»s.h
>

22 
	~<’dŸn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<b™s/±h»adty³s.h
>

27 
	~<b™s/£tjmp.h
>

28 
	~<b™s/wÜdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifdeà
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifdeà
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


86 #ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 1

87 
	#__PTHREAD_SPINS
 0, 0

	)

88 #–ià
__PTHREAD_MUTEX_HAVE_ELISION
 == 2

89 
	#__PTHREAD_SPINS
 { 0, 0 }

	)

91 
	#__PTHREAD_SPINS
 0

	)

94 #ifdeà
__PTHREAD_MUTEX_HAVE_PREV


95 
	#PTHREAD_MUTEX_INITIALIZER
 \

96 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

97 #ifdeà
__USE_GNU


98 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

99 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

100 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

101 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

102 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

103 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

104 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

105 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

109 
	#PTHREAD_MUTEX_INITIALIZER
 \

110 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

111 #ifdeà
__USE_GNU


112 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

113 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

114 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

115 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

116 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

117 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

124 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


127 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

128 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

129 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

130 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


136 #iâdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


137 #ià
__WORDSIZE
 == 64

138 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

143 
	#PTHREAD_RWLOCK_INITIALIZER
 \

144 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 } }

	)

145 #ifdeà
__USE_GNU


146 #ifdeà
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


147 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

149 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

151 #ià
__BYTE_ORDER
 =ğ
__LITTLE_ENDIAN


152 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

153 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

154 0, 0, 0, 0 } }

	)

156 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

157 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

158 0 } }

	)

168 
	mPTHREAD_INHERIT_SCHED
,

169 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

170 
	mPTHREAD_EXPLICIT_SCHED


171 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

178 
	mPTHREAD_SCOPE_SYSTEM
,

179 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

180 
	mPTHREAD_SCOPE_PROCESS


181 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

188 
	mPTHREAD_PROCESS_PRIVATE
,

189 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

190 
	mPTHREAD_PROCESS_SHARED


191 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

197 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*è0, 0, 0 } }

	)

201 
	s_±h»ad_ş—nup_bufãr


203 (*
	m__routše
) (*);

204 *
	m__¬g
;

205 
	m__ÿnûÉy³
;

206 
_±h»ad_ş—nup_bufãr
 *
	m__´ev
;

212 
	mPTHREAD_CANCEL_ENABLE
,

213 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

214 
	mPTHREAD_CANCEL_DISABLE


215 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

219 
	mPTHREAD_CANCEL_DEFERRED
,

220 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

221 
	mPTHREAD_CANCEL_ASYNCHRONOUS


222 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

224 
	#PTHREAD_CANCELED
 ((*è-1)

	)

228 
	#PTHREAD_ONCE_INIT
 0

	)

231 #ifdeà
__USE_XOPEN2K


235 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

239 
__BEGIN_DECLS


244 
±h»ad_ü—‹
 (
±h»ad_t
 *
__»¡riù
 
__Ãwth»ad
,

245 cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

246 *(*
__¡¬t_routše
) (*),

247 *
__»¡riù
 
__¬g
è
__THROWNL
 
__nÚnuÎ
 ((1, 3));

253 
	$±h»ad_ex™
 (*
__»tv®
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

261 
	`±h»ad_još
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
);

263 #ifdeà
__USE_GNU


266 
	$±h»ad_Œyjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
è
__THROW
;

274 
	`±h»ad_timedjoš_Å
 (
±h»ad_t
 
__th
, **
__th»ad_»tuº
,

275 cÚ¡ 
time¥ec
 *
__ab¡ime
);

282 
	$±h»ad_d‘ach
 (
±h»ad_t
 
__th
è
__THROW
;

286 
±h»ad_t
 
	$±h»ad_£lf
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

289 
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
)

290 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

298 
	$±h»ad_©Œ_š™
 (
±h»ad_©Œ_t
 *
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

301 
	$±h»ad_©Œ_de¡roy
 (
±h»ad_©Œ_t
 *
__©Œ
)

302 
__THROW
 
	`__nÚnuÎ
 ((1));

305 
	$±h»ad_©Œ_g‘d‘ach¡©e
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

306 *
__d‘ach¡©e
)

307 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

310 
	$±h»ad_©Œ_£td‘ach¡©e
 (
±h»ad_©Œ_t
 *
__©Œ
,

311 
__d‘ach¡©e
)

312 
__THROW
 
	`__nÚnuÎ
 ((1));

316 
	$±h»ad_©Œ_g‘gu¬dsize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

317 
size_t
 *
__gu¬dsize
)

318 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

321 
	$±h»ad_©Œ_£tgu¬dsize
 (
±h»ad_©Œ_t
 *
__©Œ
,

322 
size_t
 
__gu¬dsize
)

323 
__THROW
 
	`__nÚnuÎ
 ((1));

327 
	$±h»ad_©Œ_g‘sched·¿m
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

328 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

329 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

332 
	$±h»ad_©Œ_£tsched·¿m
 (
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

333 cÚ¡ 
sched_·¿m
 *
__»¡riù


334 
__·¿m
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

337 
	$±h»ad_©Œ_g‘schedpŞicy
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


338 
__©Œ
, *
__»¡riù
 
__pŞicy
)

339 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

342 
	$±h»ad_©Œ_£tschedpŞicy
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__pŞicy
)

343 
__THROW
 
	`__nÚnuÎ
 ((1));

346 
	$±h»ad_©Œ_g‘šh”™sched
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


347 
__©Œ
, *
__»¡riù
 
__šh”™
)

348 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

351 
	$±h»ad_©Œ_£tšh”™sched
 (
±h»ad_©Œ_t
 *
__©Œ
,

352 
__šh”™
)

353 
__THROW
 
	`__nÚnuÎ
 ((1));

357 
	$±h»ad_©Œ_g‘scİe
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

358 *
__»¡riù
 
__scİe
)

359 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

362 
	$±h»ad_©Œ_£tscİe
 (
±h»ad_©Œ_t
 *
__©Œ
, 
__scİe
)

363 
__THROW
 
	`__nÚnuÎ
 ((1));

366 
	$±h»ad_©Œ_g‘¡ackaddr
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


367 
__©Œ
, **
__»¡riù
 
__¡ackaddr
)

368 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__©Œibu‹_d•»ÿ‹d__
;

374 
	$±h»ad_©Œ_£t¡ackaddr
 (
±h»ad_©Œ_t
 *
__©Œ
,

375 *
__¡ackaddr
)

376 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
;

379 
	$±h»ad_©Œ_g‘¡acksize
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù


380 
__©Œ
, 
size_t
 *
__»¡riù
 
__¡acksize
)

381 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

386 
	$±h»ad_©Œ_£t¡acksize
 (
±h»ad_©Œ_t
 *
__©Œ
,

387 
size_t
 
__¡acksize
)

388 
__THROW
 
	`__nÚnuÎ
 ((1));

390 #ifdeà
__USE_XOPEN2K


392 
	$±h»ad_©Œ_g‘¡ack
 (cÚ¡ 
±h»ad_©Œ_t
 *
__»¡riù
 
__©Œ
,

393 **
__»¡riù
 
__¡ackaddr
,

394 
size_t
 *
__»¡riù
 
__¡acksize
)

395 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

400 
	$±h»ad_©Œ_£t¡ack
 (
±h»ad_©Œ_t
 *
__©Œ
, *
__¡ackaddr
,

401 
size_t
 
__¡acksize
è
__THROW
 
	`__nÚnuÎ
 ((1));

404 #ifdeà
__USE_GNU


407 
	$±h»ad_©Œ_£ffš™y_Å
 (
±h»ad_©Œ_t
 *
__©Œ
,

408 
size_t
 
__ıu£tsize
,

409 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

410 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

414 
	$±h»ad_©Œ_g‘affš™y_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
,

415 
size_t
 
__ıu£tsize
,

416 
ıu_£t_t
 *
__ıu£t
)

417 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

420 
	$±h»ad_g‘©Œ_deçuÉ_Å
 (
±h»ad_©Œ_t
 *
__©Œ
)

421 
__THROW
 
	`__nÚnuÎ
 ((1));

425 
	$±h»ad_£‰r_deçuÉ_Å
 (cÚ¡ 
±h»ad_©Œ_t
 *
__©Œ
)

426 
__THROW
 
	`__nÚnuÎ
 ((1));

431 
	$±h»ad_g‘©Œ_Å
 (
±h»ad_t
 
__th
, 
±h»ad_©Œ_t
 *
__©Œ
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

440 
	$±h»ad_£tsched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
, 
__pŞicy
,

441 cÚ¡ 
sched_·¿m
 *
__·¿m
)

442 
__THROW
 
	`__nÚnuÎ
 ((3));

445 
	$±h»ad_g‘sched·¿m
 (
±h»ad_t
 
__rg‘_th»ad
,

446 *
__»¡riù
 
__pŞicy
,

447 
sched_·¿m
 *
__»¡riù
 
__·¿m
)

448 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

451 
	$±h»ad_£tsched´io
 (
±h»ad_t
 
__rg‘_th»ad
, 
__´io
)

452 
__THROW
;

455 #ifdeà
__USE_GNU


457 
	$±h»ad_g‘Çme_Å
 (
±h»ad_t
 
__rg‘_th»ad
, *
__buf
,

458 
size_t
 
__buæ’
)

459 
__THROW
 
	`__nÚnuÎ
 ((2));

462 
	$±h»ad_£Šame_Å
 (
±h»ad_t
 
__rg‘_th»ad
, cÚ¡ *
__Çme
)

463 
__THROW
 
	`__nÚnuÎ
 ((2));

467 #ifdeà
__USE_UNIX98


469 
	$±h»ad_g‘cÚcu¼’cy
 (è
__THROW
;

472 
	$±h»ad_£tcÚcu¼’cy
 (
__Ëv–
è
__THROW
;

475 #ifdeà
__USE_GNU


480 
	$±h»ad_y›ld
 (è
__THROW
;

485 
	$±h»ad_£ffš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

486 cÚ¡ 
ıu_£t_t
 *
__ıu£t
)

487 
__THROW
 
	`__nÚnuÎ
 ((3));

490 
	$±h»ad_g‘affš™y_Å
 (
±h»ad_t
 
__th
, 
size_t
 
__ıu£tsize
,

491 
ıu_£t_t
 *
__ıu£t
)

492 
__THROW
 
	`__nÚnuÎ
 ((3));

505 
	`±h»ad_Úû
 (
±h»ad_Úû_t
 *
__Úû_cÚŒŞ
,

506 (*
__š™_routše
è()è
	`__nÚnuÎ
 ((1, 2));

517 
	`±h»ad_£tÿnûl¡©e
 (
__¡©e
, *
__Şd¡©e
);

521 
	`±h»ad_£tÿnûÉy³
 (
__ty³
, *
__Şdty³
);

524 
	`±h»ad_ÿnûl
 (
±h»ad_t
 
__th
);

529 
	`±h»ad_‹¡ÿnûl
 ();

538 
__jmp_buf
 
__ÿnûl_jmp_buf
;

539 
__mask_was_§ved
;

540 } 
__ÿnûl_jmp_buf
[1];

541 *
__·d
[4];

542 } 
	t__±h»ad_unwšd_buf_t
 
	t__©Œibu‹__
 ((
	t__®igÃd__
));

545 #iâdeà
__ş—nup_fù_©Œibu‹


546 
	#__ş—nup_fù_©Œibu‹


	)

551 
	s__±h»ad_ş—nup_äame


553 (*
__ÿnûl_routše
) (*);

554 *
__ÿnûl_¬g
;

555 
__do_™
;

556 
__ÿnûl_ty³
;

559 #ià
defšed
 
__GNUC__
 && defšed 
__EXCEPTIONS


560 #ifdeà
__ılu¥lus


562 şas 
	c__±h»ad_ş—nup_şass


564 (*
__ÿnûl_routše
) (*);

565 *
__ÿnûl_¬g
;

566 
__do_™
;

567 
__ÿnûl_ty³
;

569 
public
:

570 
	`__±h»ad_ş—nup_şass
 ((*
__fù
è(*), *
__¬g
)

571 : 
	`__ÿnûl_routše
 (
__fù
), 
	`__ÿnûl_¬g
 (
__¬g
), 
	$__do_™
 (1) { }

572 ~
	$__±h»ad_ş—nup_şass
 (è{ ià(
__do_™
è
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); 
	}
}

573 
	$__£tdo™
 (
__Ãwv®
è{ 
__do_™
 = __Ãwv®; 
	}
}

574 
	$__deãr
 (è{ 
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
,

575 &
__ÿnûl_ty³
); 
	}
}

576 
	$__»¡Üe
 (ècÚ¡ { 
	`±h»ad_£tÿnûÉy³
 (
__ÿnûl_ty³
, 0); 
	}
}

586 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

588 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
)

	)

592 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

593 
__şäame
.
	`__£tdo™
 (
execu‹
); \

594 } 0)

	)

596 #ifdeà
__USE_GNU


600 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

602 
__±h»ad_ş—nup_şass
 
	`__şäame
 (
routše
, 
¬g
); \

603 
__şäame
.
	`__deãr
 ()

	)

608 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

609 
__şäame
.
	`__»¡Üe
 (); \

610 
__şäame
.
	`__£tdo™
 (
execu‹
); \

611 } 0)

	)

618 
__ex‹º_šlše
 

619 
	$__±h»ad_ş—nup_routše
 (
__±h»ad_ş—nup_äame
 *
__äame
)

621 ià(
__äame
->
__do_™
)

622 
__äame
->
	`__ÿnûl_routše
 (__äame->
__ÿnûl_¬g
);

623 
	}
}

632 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

634 
__±h»ad_ş—nup_äame
 
__şäame
 \

635 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

636 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

637 .
__do_™
 = 1 };

	)

641 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

642 
__şäame
.
__do_™
 = (
execu‹
); \

643 } 0)

	)

645 #ifdeà
__USE_GNU


649 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

651 
__±h»ad_ş—nup_äame
 
__şäame
 \

652 
	`__©Œibu‹__
 ((
	`__ş—nup__
 (
__±h»ad_ş—nup_routše
))) \

653 ğ{ .
__ÿnûl_routše
 = (
routše
), .
__ÿnûl_¬g
 = (
¬g
), \

654 .
__do_™
 = 1 }; \

655 (è
	`±h»ad_£tÿnûÉy³
 (
PTHREAD_CANCEL_DEFERRED
, \

656 &
__şäame
.
__ÿnûl_ty³
)

	)

661 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

662 (è
	`±h»ad_£tÿnûÉy³
 (
__şäame
.
__ÿnûl_ty³
, 
NULL
); \

663 
__şäame
.
__do_™
 = (
execu‹
); \

664 } 0)

	)

675 
	#±h»ad_ş—nup_push
(
routše
, 
¬g
) \

677 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

678 (*
__ÿnûl_routše
è(*èğ(
routše
); \

679 *
__ÿnûl_¬g
 = (
¬g
); \

680 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

681 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

682 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

684 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

685 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

689 
	`__±h»ad_»gi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

690 dØ{

	)

691 
__±h»ad_»gi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

692 
__ş—nup_fù_©Œibu‹
;

696 
	#±h»ad_ş—nup_pİ
(
execu‹
) \

699 
	`__±h»ad_uÄegi¡”_ÿnûl
 (&
__ÿnûl_buf
); \

700 ià(
execu‹
) \

701 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

702 } 0)

	)

703 
	$__±h»ad_uÄegi¡”_ÿnûl
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

704 
__ş—nup_fù_©Œibu‹
;

706 #ifdeà
__USE_GNU


710 
	#±h»ad_ş—nup_push_deãr_Å
(
routše
, 
¬g
) \

712 
__±h»ad_unwšd_buf_t
 
__ÿnûl_buf
; \

713 (*
__ÿnûl_routše
è(*èğ(
routše
); \

714 *
__ÿnûl_¬g
 = (
¬g
); \

715 
__nÙ_fœ¡_ÿÎ
 = 
	`__sig£tjmp
 ((
__jmp_buf_g
 *) (*) \

716 
__ÿnûl_buf
.
__ÿnûl_jmp_buf
, 0); \

717 ià(
	`__glibc_uÆik–y
 (
__nÙ_fœ¡_ÿÎ
)) \

719 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

720 
	`__±h»ad_unwšd_Ãxt
 (&
__ÿnûl_buf
); \

724 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (&
__ÿnûl_buf
); \

725 dØ{

	)

726 
	`__±h»ad_»gi¡”_ÿnûl_deãr
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

727 
__ş—nup_fù_©Œibu‹
;

732 
	#±h»ad_ş—nup_pİ_»¡Üe_Å
(
execu‹
) \

735 
	`__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (&
__ÿnûl_buf
); \

736 ià(
execu‹
) \

737 
	`__ÿnûl_routše
 (
__ÿnûl_¬g
); \

738 
	}
} 0)

	)

739 
	$__±h»ad_uÄegi¡”_ÿnûl_»¡Üe
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

740 
__ş—nup_fù_©Œibu‹
;

744 
	$__±h»ad_unwšd_Ãxt
 (
__±h»ad_unwšd_buf_t
 *
__buf
)

745 
__ş—nup_fù_©Œibu‹
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

746 #iâdeà
SHARED


747 
	`__©Œibu‹__
 ((
__w—k__
))

753 
__jmp_buf_g
;

754 
	$__sig£tjmp
 (
__jmp_buf_g
 *
__’v
, 
__§vemask
è
__THROWNL
;

760 
	$±h»ad_mu‹x_š™
 (
±h»ad_mu‹x_t
 *
__mu‹x
,

761 cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__mu‹x©Œ
)

762 
__THROW
 
	`__nÚnuÎ
 ((1));

765 
	$±h»ad_mu‹x_de¡roy
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

766 
__THROW
 
	`__nÚnuÎ
 ((1));

769 
	$±h»ad_mu‹x_Œylock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

770 
__THROWNL
 
	`__nÚnuÎ
 ((1));

773 
	$±h»ad_mu‹x_lock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

774 
__THROWNL
 
	`__nÚnuÎ
 ((1));

776 #ifdeà
__USE_XOPEN2K


778 
	$±h»ad_mu‹x_timedlock
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

779 cÚ¡ 
time¥ec
 *
__»¡riù


780 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

784 
	$±h»ad_mu‹x_uÆock
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

785 
__THROWNL
 
	`__nÚnuÎ
 ((1));

789 
	$±h»ad_mu‹x_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x_t
 *

790 
__»¡riù
 
__mu‹x
,

791 *
__»¡riù
 
__´ioûšg
)

792 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

796 
	$±h»ad_mu‹x_£rioûšg
 (
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

797 
__´ioûšg
,

798 *
__»¡riù
 
__Şd_ûšg
)

799 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

802 #ifdeà
__USE_XOPEN2K8


804 
	$±h»ad_mu‹x_cÚsi¡’t
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

805 
__THROW
 
	`__nÚnuÎ
 ((1));

806 #ifdeà
__USE_GNU


807 
	$±h»ad_mu‹x_cÚsi¡’t_Å
 (
±h»ad_mu‹x_t
 *
__mu‹x
)

808 
__THROW
 
	`__nÚnuÎ
 ((1));

817 
	$±h»ad_mu‹x©Œ_š™
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

818 
__THROW
 
	`__nÚnuÎ
 ((1));

821 
	$±h»ad_mu‹x©Œ_de¡roy
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
)

822 
__THROW
 
	`__nÚnuÎ
 ((1));

825 
	$±h»ad_mu‹x©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

826 
__»¡riù
 
__©Œ
,

827 *
__»¡riù
 
__psh¬ed
)

828 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

831 
	$±h»ad_mu‹x©Œ_£sh¬ed
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

832 
__psh¬ed
)

833 
__THROW
 
	`__nÚnuÎ
 ((1));

835 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


837 
	$±h»ad_mu‹x©Œ_g‘ty³
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__»¡riù


838 
__©Œ
, *
__»¡riù
 
__kšd
)

839 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

844 
	$±h»ad_mu‹x©Œ_£‰y³
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
, 
__kšd
)

845 
__THROW
 
	`__nÚnuÎ
 ((1));

849 
	$±h»ad_mu‹x©Œ_g‘´ÙocŞ
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

850 
__»¡riù
 
__©Œ
,

851 *
__»¡riù
 
__´ÙocŞ
)

852 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

856 
	$±h»ad_mu‹x©Œ_£rÙocŞ
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

857 
__´ÙocŞ
)

858 
__THROW
 
	`__nÚnuÎ
 ((1));

861 
	$±h»ad_mu‹x©Œ_g‘´ioûšg
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *

862 
__»¡riù
 
__©Œ
,

863 *
__»¡riù
 
__´ioûšg
)

864 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

867 
	$±h»ad_mu‹x©Œ_£rioûšg
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

868 
__´ioûšg
)

869 
__THROW
 
	`__nÚnuÎ
 ((1));

871 #ifdeà
__USE_XOPEN2K


873 
	$±h»ad_mu‹x©Œ_g‘robu¡
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

874 *
__robu¡Ãss
)

875 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

876 #ifdeà
__USE_GNU


877 
	$±h»ad_mu‹x©Œ_g‘robu¡_Å
 (cÚ¡ 
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

878 *
__robu¡Ãss
)

879 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

883 
	$±h»ad_mu‹x©Œ_£Œobu¡
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

884 
__robu¡Ãss
)

885 
__THROW
 
	`__nÚnuÎ
 ((1));

886 #ifdeà
__USE_GNU


887 
	$±h»ad_mu‹x©Œ_£Œobu¡_Å
 (
±h»ad_mu‹x©Œ_t
 *
__©Œ
,

888 
__robu¡Ãss
)

889 
__THROW
 
	`__nÚnuÎ
 ((1));

894 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


899 
	$±h»ad_rwlock_š™
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

900 cÚ¡ 
±h»ad_rwlock©Œ_t
 *
__»¡riù


901 
__©Œ
è
__THROW
 
	`__nÚnuÎ
 ((1));

904 
	$±h»ad_rwlock_de¡roy
 (
±h»ad_rwlock_t
 *
__rwlock
)

905 
__THROW
 
	`__nÚnuÎ
 ((1));

908 
	$±h»ad_rwlock_rdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

909 
__THROWNL
 
	`__nÚnuÎ
 ((1));

912 
	$±h»ad_rwlock_Œyrdlock
 (
±h»ad_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nÚnuÎ
 ((1));

915 #ifdeà
__USE_XOPEN2K


917 
	$±h»ad_rwlock_timedrdlock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

918 cÚ¡ 
time¥ec
 *
__»¡riù


919 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

923 
	$±h»ad_rwlock_w¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

924 
__THROWNL
 
	`__nÚnuÎ
 ((1));

927 
	$±h»ad_rwlock_Œyw¾ock
 (
±h»ad_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nÚnuÎ
 ((1));

930 #ifdeà
__USE_XOPEN2K


932 
	$±h»ad_rwlock_timedw¾ock
 (
±h»ad_rwlock_t
 *
__»¡riù
 
__rwlock
,

933 cÚ¡ 
time¥ec
 *
__»¡riù


934 
__ab¡ime
è
__THROWNL
 
	`__nÚnuÎ
 ((1, 2));

938 
	$±h»ad_rwlock_uÆock
 (
±h»ad_rwlock_t
 *
__rwlock
)

939 
__THROWNL
 
	`__nÚnuÎ
 ((1));

945 
	$±h»ad_rwlock©Œ_š™
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

946 
__THROW
 
	`__nÚnuÎ
 ((1));

949 
	$±h»ad_rwlock©Œ_de¡roy
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
)

950 
__THROW
 
	`__nÚnuÎ
 ((1));

953 
	$±h»ad_rwlock©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

954 
__»¡riù
 
__©Œ
,

955 *
__»¡riù
 
__psh¬ed
)

956 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

959 
	$±h»ad_rwlock©Œ_£sh¬ed
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

960 
__psh¬ed
)

961 
__THROW
 
	`__nÚnuÎ
 ((1));

964 
	$±h»ad_rwlock©Œ_g‘kšd_Å
 (cÚ¡ 
±h»ad_rwlock©Œ_t
 *

965 
__»¡riù
 
__©Œ
,

966 *
__»¡riù
 
__´ef
)

967 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

970 
	$±h»ad_rwlock©Œ_£tkšd_Å
 (
±h»ad_rwlock©Œ_t
 *
__©Œ
,

971 
__´ef
è
__THROW
 
	`__nÚnuÎ
 ((1));

979 
	$±h»ad_cÚd_š™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

980 cÚ¡ 
±h»ad_cÚd©Œ_t
 *
__»¡riù
 
__cÚd_©Œ
)

981 
__THROW
 
	`__nÚnuÎ
 ((1));

984 
	$±h»ad_cÚd_de¡roy
 (
±h»ad_cÚd_t
 *
__cÚd
)

985 
__THROW
 
	`__nÚnuÎ
 ((1));

988 
	$±h»ad_cÚd_sigÇl
 (
±h»ad_cÚd_t
 *
__cÚd
)

989 
__THROWNL
 
	`__nÚnuÎ
 ((1));

992 
	$±h»ad_cÚd_brßdÿ¡
 (
±h»ad_cÚd_t
 *
__cÚd
)

993 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1000 
	$±h»ad_cÚd_wa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1001 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
)

1002 
	`__nÚnuÎ
 ((1, 2));

1011 
	$±h»ad_cÚd_timedwa™
 (
±h»ad_cÚd_t
 *
__»¡riù
 
__cÚd
,

1012 
±h»ad_mu‹x_t
 *
__»¡riù
 
__mu‹x
,

1013 cÚ¡ 
time¥ec
 *
__»¡riù
 
__ab¡ime
)

1014 
	`__nÚnuÎ
 ((1, 2, 3));

1019 
	$±h»ad_cÚd©Œ_š™
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1020 
__THROW
 
	`__nÚnuÎ
 ((1));

1023 
	$±h»ad_cÚd©Œ_de¡roy
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
)

1024 
__THROW
 
	`__nÚnuÎ
 ((1));

1027 
	$±h»ad_cÚd©Œ_g‘psh¬ed
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1028 
__»¡riù
 
__©Œ
,

1029 *
__»¡riù
 
__psh¬ed
)

1030 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1033 
	$±h»ad_cÚd©Œ_£sh¬ed
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1034 
__psh¬ed
è
__THROW
 
	`__nÚnuÎ
 ((1));

1036 #ifdeà
__USE_XOPEN2K


1038 
	$±h»ad_cÚd©Œ_g‘şock
 (cÚ¡ 
±h»ad_cÚd©Œ_t
 *

1039 
__»¡riù
 
__©Œ
,

1040 
__şockid_t
 *
__»¡riù
 
__şock_id
)

1041 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1044 
	$±h»ad_cÚd©Œ_£tşock
 (
±h»ad_cÚd©Œ_t
 *
__©Œ
,

1045 
__şockid_t
 
__şock_id
)

1046 
__THROW
 
	`__nÚnuÎ
 ((1));

1050 #ifdeà
__USE_XOPEN2K


1055 
	$±h»ad_¥š_š™
 (
±h»ad_¥šlock_t
 *
__lock
, 
__psh¬ed
)

1056 
__THROW
 
	`__nÚnuÎ
 ((1));

1059 
	$±h»ad_¥š_de¡roy
 (
±h»ad_¥šlock_t
 *
__lock
)

1060 
__THROW
 
	`__nÚnuÎ
 ((1));

1063 
	$±h»ad_¥š_lock
 (
±h»ad_¥šlock_t
 *
__lock
)

1064 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1067 
	$±h»ad_¥š_Œylock
 (
±h»ad_¥šlock_t
 *
__lock
)

1068 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1071 
	$±h»ad_¥š_uÆock
 (
±h»ad_¥šlock_t
 *
__lock
)

1072 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1079 
	$±h»ad_b¬r›r_š™
 (
±h»ad_b¬r›r_t
 *
__»¡riù
 
__b¬r›r
,

1080 cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *
__»¡riù


1081 
__©Œ
, 
__couÁ
)

1082 
__THROW
 
	`__nÚnuÎ
 ((1));

1085 
	$±h»ad_b¬r›r_de¡roy
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1086 
__THROW
 
	`__nÚnuÎ
 ((1));

1089 
	$±h»ad_b¬r›r_wa™
 (
±h»ad_b¬r›r_t
 *
__b¬r›r
)

1090 
__THROWNL
 
	`__nÚnuÎ
 ((1));

1094 
	$±h»ad_b¬r›¿‰r_š™
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1095 
__THROW
 
	`__nÚnuÎ
 ((1));

1098 
	$±h»ad_b¬r›¿‰r_de¡roy
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
)

1099 
__THROW
 
	`__nÚnuÎ
 ((1));

1102 
	$±h»ad_b¬r›¿‰r_g‘psh¬ed
 (cÚ¡ 
±h»ad_b¬r›¿‰r_t
 *

1103 
__»¡riù
 
__©Œ
,

1104 *
__»¡riù
 
__psh¬ed
)

1105 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1108 
	$±h»ad_b¬r›¿‰r_£sh¬ed
 (
±h»ad_b¬r›¿‰r_t
 *
__©Œ
,

1109 
__psh¬ed
)

1110 
__THROW
 
	`__nÚnuÎ
 ((1));

1122 
	`±h»ad_key_ü—‹
 (
±h»ad_key_t
 *
__key
,

1123 (*
__de¡r_funùiÚ
) (*))

1124 
__THROW
 
	`__nÚnuÎ
 ((1));

1127 
	$±h»ad_key_d–‘e
 (
±h»ad_key_t
 
__key
è
__THROW
;

1130 *
	$±h»ad_g‘¥ecific
 (
±h»ad_key_t
 
__key
è
__THROW
;

1133 
	$±h»ad_£t¥ecific
 (
±h»ad_key_t
 
__key
,

1134 cÚ¡ *
__poš‹r
è
__THROW
 ;

1137 #ifdeà
__USE_XOPEN2K


1139 
	$±h»ad_g‘ıuşockid
 (
±h»ad_t
 
__th»ad_id
,

1140 
__şockid_t
 *
__şock_id
)

1141 
__THROW
 
	`__nÚnuÎ
 ((2));

1156 
	`±h»ad_©fÜk
 ((*
__´•¬e
) (),

1157 (*
__·»Á
) (),

1158 (*
__chd
è()è
__THROW
;

1161 #ifdeà
__USE_EXTERN_INLINES


1163 
__ex‹º_šlše
 

1164 
	`__NTH
 (
	$±h»ad_equ®
 (
±h»ad_t
 
__th»ad1
,…th»ad_ˆ
__th»ad2
))

1166  
__th»ad1
 =ğ
__th»ad2
;

1167 
	}
}

1170 
	g__END_DECLS


	@/usr/include/pwd.h

22 #iâdef 
_PWD_H


23 
	#_PWD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


29 
	~<b™s/ty³s.h
>

31 
	#__Ãed_size_t


	)

32 
	~<¡ddef.h
>

34 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


37 #iâdeà
__gid_t_defšed


38 
__gid_t
 
	tgid_t
;

39 
	#__gid_t_defšed


	)

42 #iâdeà
__uid_t_defšed


43 
__uid_t
 
	tuid_t
;

44 
	#__uid_t_defšed


	)

49 
	s·sswd


51 *
	mpw_Çme
;

52 *
	mpw_·sswd
;

53 
__uid_t
 
	mpw_uid
;

54 
__gid_t
 
	mpw_gid
;

55 *
	mpw_gecos
;

56 *
	mpw_dœ
;

57 *
	mpw_sh–l
;

61 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_GNU


62 
	#__Ãed_FILE


	)

63 
	~<¡dio.h
>

67 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED


72 
£w’t
 ();

78 
’dpw’t
 ();

84 
·sswd
 *
g‘pw’t
 ();

87 #ifdef 
__USE_SVID


94 
·sswd
 *
fg‘pw’t
 (
FILE
 *
__¡»am
);

102 
puw’t
 (cÚ¡ 
·sswd
 *
__»¡riù
 
__p
,

103 
FILE
 *
__»¡riù
 
__f
);

110 
·sswd
 *
g‘pwuid
 (
__uid_t
 
__uid
);

116 
·sswd
 *
g‘pwÇm
 (cÚ¡ *
__Çme
);

118 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


120 #ifdeà
__USE_MISC


123 
	#NSS_BUFLEN_PASSWD
 1024

	)

134 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC


139 
g‘pw’t_r
 (
·sswd
 *
__»¡riù
 
__»suÉbuf
,

140 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

141 
·sswd
 **
__»¡riù
 
__»suÉ
);

144 
g‘pwuid_r
 (
__uid_t
 
__uid
,

145 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

146 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

147 
·sswd
 **
__»¡riù
 
__»suÉ
);

149 
g‘pwÇm_r
 (cÚ¡ *
__»¡riù
 
__Çme
,

150 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

151 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

152 
·sswd
 **
__»¡riù
 
__»suÉ
);

155 #ifdef 
__USE_SVID


163 
fg‘pw’t_r
 (
FILE
 *
__»¡riù
 
__¡»am
,

164 
·sswd
 *
__»¡riù
 
__»suÉbuf
,

165 *
__»¡riù
 
__bufãr
, 
size_t
 
__buæ’
,

166 
·sswd
 **
__»¡riù
 
__»suÉ
);

171 #ifdeà
__USE_GNU


180 
g‘pw
 (
__uid_t
 
__uid
, *
__bufãr
);

183 
	g__END_DECLS


	@/usr/include/regex.h

20 #iâdeà
_REGEX_H


21 
	#_REGEX_H
 1

	)

23 
	~<sys/ty³s.h
>

24 
	~<gnu/İtiÚ-groups.h
>

27 #ifdeà
__ılu¥lus


35 
	ts_»g_t
;

36 
	taùive_»g_t
;

43 
	t»g_syÁax_t
;

45 #ifdeà
__USE_GNU


48 
	#RE_BACKSLASH_ESCAPE_IN_LISTS
 ((è1)

	)

53 
	#RE_BK_PLUS_QM
 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 << 1)

	)

59 
	#RE_CHAR_CLASSES
 (
RE_BK_PLUS_QM
 << 1)

	)

73 
	#RE_CONTEXT_INDEP_ANCHORS
 (
RE_CHAR_CLASSES
 << 1)

	)

81 
	#RE_CONTEXT_INDEP_OPS
 (
RE_CONTEXT_INDEP_ANCHORS
 << 1)

	)

85 
	#RE_CONTEXT_INVALID_OPS
 (
RE_CONTEXT_INDEP_OPS
 << 1)

	)

89 
	#RE_DOT_NEWLINE
 (
RE_CONTEXT_INVALID_OPS
 << 1)

	)

93 
	#RE_DOT_NOT_NULL
 (
RE_DOT_NEWLINE
 << 1)

	)

97 
	#RE_HAT_LISTS_NOT_NEWLINE
 (
RE_DOT_NOT_NULL
 << 1)

	)

102 
	#RE_INTERVALS
 (
RE_HAT_LISTS_NOT_NEWLINE
 << 1)

	)

106 
	#RE_LIMITED_OPS
 (
RE_INTERVALS
 << 1)

	)

110 
	#RE_NEWLINE_ALT
 (
RE_LIMITED_OPS
 << 1)

	)

115 
	#RE_NO_BK_BRACES
 (
RE_NEWLINE_ALT
 << 1)

	)

119 
	#RE_NO_BK_PARENS
 (
RE_NO_BK_BRACES
 << 1)

	)

123 
	#RE_NO_BK_REFS
 (
RE_NO_BK_PARENS
 << 1)

	)

127 
	#RE_NO_BK_VBAR
 (
RE_NO_BK_REFS
 << 1)

	)

133 
	#RE_NO_EMPTY_RANGES
 (
RE_NO_BK_VBAR
 << 1)

	)

137 
	#RE_UNMATCHED_RIGHT_PAREN_ORD
 (
RE_NO_EMPTY_RANGES
 << 1)

	)

141 
	#RE_NO_POSIX_BACKTRACKING
 (
RE_UNMATCHED_RIGHT_PAREN_ORD
 << 1)

	)

145 
	#RE_NO_GNU_OPS
 (
RE_NO_POSIX_BACKTRACKING
 << 1)

	)

153 
	#RE_DEBUG
 (
RE_NO_GNU_OPS
 << 1)

	)

158 
	#RE_INVALID_INTERVAL_ORD
 (
RE_DEBUG
 << 1)

	)

161 #ifdeà
__OPTION_POSIX_REGEXP_GLIBC


164 
	#RE_ICASE
 (
RE_INVALID_INTERVAL_ORD
 << 1)

	)

169 
	#RE_CARET_ANCHORS_HERE
 (
RE_ICASE
 << 1)

	)

173 
	#RE_CONTEXT_INVALID_DUP
 (
RE_CARET_ANCHORS_HERE
 << 1)

	)

177 
	#RE_NO_SUB
 (
RE_CONTEXT_INVALID_DUP
 << 1)

	)

185 
»g_syÁax_t
 
»_syÁax_İtiÚs
;

187 #ifdeà
__USE_GNU


192 
	#RE_SYNTAX_EMACS
 0

	)

194 
	#RE_SYNTAX_AWK
 \

195 (
RE_BACKSLASH_ESCAPE_IN_LISTS
 | 
RE_DOT_NOT_NULL
 \

196 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

197 | 
RE_NO_BK_VBAR
 | 
RE_NO_EMPTY_RANGES
 \

198 | 
RE_DOT_NEWLINE
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

199 | 
RE_CHAR_CLASSES
 \

200 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
 | 
RE_NO_GNU_OPS
)

	)

202 
	#RE_SYNTAX_GNU_AWK
 \

203 ((
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

204 | 
RE_INVALID_INTERVAL_ORD
) \

205 & ~(
RE_DOT_NOT_NULL
 | 
RE_CONTEXT_INDEP_OPS
 \

206 | 
RE_CONTEXT_INVALID_OPS
 ))

	)

208 
	#RE_SYNTAX_POSIX_AWK
 \

209 (
RE_SYNTAX_POSIX_EXTENDED
 | 
RE_BACKSLASH_ESCAPE_IN_LISTS
 \

210 | 
RE_INTERVALS
 | 
RE_NO_GNU_OPS
 \

211 | 
RE_INVALID_INTERVAL_ORD
)

	)

213 
	#RE_SYNTAX_GREP
 \

214 (
RE_BK_PLUS_QM
 | 
RE_CHAR_CLASSES
 \

215 | 
RE_HAT_LISTS_NOT_NEWLINE
 | 
RE_INTERVALS
 \

216 | 
RE_NEWLINE_ALT
)

	)

218 
	#RE_SYNTAX_EGREP
 \

219 (
RE_CHAR_CLASSES
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

220 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_HAT_LISTS_NOT_NEWLINE
 \

221 | 
RE_NEWLINE_ALT
 | 
RE_NO_BK_PARENS
 \

222 | 
RE_NO_BK_VBAR
)

	)

224 
	#RE_SYNTAX_POSIX_EGREP
 \

225 (
RE_SYNTAX_EGREP
 | 
RE_INTERVALS
 | 
RE_NO_BK_BRACES
 \

226 | 
RE_INVALID_INTERVAL_ORD
)

	)

229 
	#RE_SYNTAX_ED
 
RE_SYNTAX_POSIX_BASIC


	)

231 
	#RE_SYNTAX_SED
 
RE_SYNTAX_POSIX_BASIC


	)

234 
	#_RE_SYNTAX_POSIX_COMMON
 \

235 (
RE_CHAR_CLASSES
 | 
RE_DOT_NEWLINE
 | 
RE_DOT_NOT_NULL
 \

236 | 
RE_INTERVALS
 | 
RE_NO_EMPTY_RANGES
)

	)

238 #ifdeà
__OPTION_POSIX_REGEXP_GLIBC


239 
	#RE_SYNTAX_POSIX_BASIC
 \

240 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
 | 
RE_CONTEXT_INVALID_DUP
)

	)

242 
	#RE_SYNTAX_POSIX_BASIC
 \

243 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_BK_PLUS_QM
)

	)

249 
	#RE_SYNTAX_POSIX_MINIMAL_BASIC
 \

250 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_LIMITED_OPS
)

	)

252 
	#RE_SYNTAX_POSIX_EXTENDED
 \

253 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

254 | 
RE_CONTEXT_INDEP_OPS
 | 
RE_NO_BK_BRACES
 \

255 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_VBAR
 \

256 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

260 
	#RE_SYNTAX_POSIX_MINIMAL_EXTENDED
 \

261 (
_RE_SYNTAX_POSIX_COMMON
 | 
RE_CONTEXT_INDEP_ANCHORS
 \

262 | 
RE_CONTEXT_INVALID_OPS
 | 
RE_NO_BK_BRACES
 \

263 | 
RE_NO_BK_PARENS
 | 
RE_NO_BK_REFS
 \

264 | 
RE_NO_BK_VBAR
 | 
RE_UNMATCHED_RIGHT_PAREN_ORD
)

	)

270 #ifdeà
RE_DUP_MAX


271 #undeà
RE_DUP_MAX


274 
	#RE_DUP_MAX
 (0x7fff)

	)

282 
	#REG_EXTENDED
 1

	)

286 
	#REG_ICASE
 (
REG_EXTENDED
 << 1)

	)

291 
	#REG_NEWLINE
 (
REG_ICASE
 << 1)

	)

295 
	#REG_NOSUB
 (
REG_NEWLINE
 << 1)

	)

305 
	#REG_NOTBOL
 1

	)

308 
	#REG_NOTEOL
 (1 << 1)

	)

310 #ifdeà
__OPTION_POSIX_REGEXP_GLIBC


313 
	#REG_STARTEND
 (1 << 2)

	)

321 #ià
defšed
 
_XOPEN_SOURCE
 || defšed 
__USE_XOPEN2K


322 
	gREG_ENOSYS
 = -1,

325 
	gREG_NOERROR
 = 0,

326 
	gREG_NOMATCH
,

330 
	gREG_BADPAT
,

331 
	gREG_ECOLLATE
,

332 
	gREG_ECTYPE
,

333 
	gREG_EESCAPE
,

334 
	gREG_ESUBREG
,

335 
	gREG_EBRACK
,

336 
	gREG_EPAREN
,

337 
	gREG_EBRACE
,

338 
	gREG_BADBR
,

339 
	gREG_ERANGE
,

340 
	gREG_ESPACE
,

341 
	gREG_BADRPT
,

344 
	gREG_EEND
,

345 
	gREG_ESIZE
,

346 
	gREG_ERPAREN


347 } 
	t»g_”rcode_t
;

355 #iâdeà
RE_TRANSLATE_TYPE


356 
	#__RE_TRANSLATE_TYPE
 *

	)

357 #ifdeà
__USE_GNU


358 
	#RE_TRANSLATE_TYPE
 
__RE_TRANSLATE_TYPE


	)

362 #ifdeà
__USE_GNU


363 
	#__REPB_PREFIX
(
Çme
è
	)
Çme

365 
	#__REPB_PREFIX
(
Çme
è
__
##
	)
Çme

368 
	s»_·‰”n_bufãr


373 *
__REPB_PREFIX
(
bufãr
);

376 
__REPB_PREFIX
(
®loÿ‹d
);

379 
__REPB_PREFIX
(
u£d
);

382 
»g_syÁax_t
 
__REPB_PREFIX
(
syÁax
);

387 *
__REPB_PREFIX
(
ç¡m­
);

393 
__RE_TRANSLATE_TYPE
 
__REPB_PREFIX
(
Œª¦©e
);

396 
size_t
 
	g»_nsub
;

402 
__REPB_PREFIX
(
ÿn_be_nuÎ
) : 1;

408 #ifdeà
__USE_GNU


409 
	#REGS_UNALLOCATED
 0

	)

410 
	#REGS_REALLOCATE
 1

	)

411 
	#REGS_FIXED
 2

	)

413 
__REPB_PREFIX
(
»gs_®loÿ‹d
) : 2;

417 
__REPB_PREFIX
(
ç¡m­_accu¿‹
) : 1;

421 
__REPB_PREFIX
(
no_sub
) : 1;

425 
__REPB_PREFIX
(
nÙ_bŞ
) : 1;

428 
__REPB_PREFIX
(
nÙ_eŞ
) : 1;

431 
__REPB_PREFIX
(
Ãwlše_ªchÜ
) : 1;

434 
»_·‰”n_bufãr
 
	t»gex_t
;

437 
	t»goff_t
;

440 #ifdeà
__USE_GNU


443 
	s»_»gi¡”s


445 
	gnum_»gs
;

446 
»goff_t
 *
	g¡¬t
;

447 
»goff_t
 *
	g’d
;

454 #iâdeà
RE_NREGS


455 
	#RE_NREGS
 30

	)

465 
»goff_t
 
	grm_so
;

466 
»goff_t
 
	grm_eo
;

467 } 
	t»gm©ch_t
;

471 #ifdeà
__USE_GNU


474 
»g_syÁax_t
 
»_£t_syÁax
 (»g_syÁax_ˆ
__syÁax
);

484 cÚ¡ *
»_compe_·‰”n
 (cÚ¡ *
__·‰”n
, 
size_t
 
__Ëngth
,

485 
»_·‰”n_bufãr
 *
__bufãr
);

491 
»_compe_ç¡m­
 (
»_·‰”n_bufãr
 *
__bufãr
);

499 
»_£¬ch
 (
»_·‰”n_bufãr
 *
__bufãr
, cÚ¡ *
__¡ršg
,

500 
__Ëngth
, 
__¡¬t
, 
__¿nge
,

501 
»_»gi¡”s
 *
__»gs
);

506 
»_£¬ch_2
 (
»_·‰”n_bufãr
 *
__bufãr
,

507 cÚ¡ *
__¡ršg1
, 
__Ëngth1
,

508 cÚ¡ *
__¡ršg2
, 
__Ëngth2
, 
__¡¬t
,

509 
__¿nge
, 
»_»gi¡”s
 *
__»gs
, 
__¡İ
);

514 
»_m©ch
 (
»_·‰”n_bufãr
 *
__bufãr
, cÚ¡ *
__¡ršg
,

515 
__Ëngth
, 
__¡¬t
, 
»_»gi¡”s
 *
__»gs
);

519 
»_m©ch_2
 (
»_·‰”n_bufãr
 *
__bufãr
,

520 cÚ¡ *
__¡ršg1
, 
__Ëngth1
,

521 cÚ¡ *
__¡ršg2
, 
__Ëngth2
, 
__¡¬t
,

522 
»_»gi¡”s
 *
__»gs
, 
__¡İ
);

537 
»_£t_»gi¡”s
 (
»_·‰”n_bufãr
 *
__bufãr
,

538 
»_»gi¡”s
 *
__»gs
,

539 
__num_»gs
,

540 
»goff_t
 *
__¡¬ts
,„egoff_ˆ*
__’ds
);

543 #ià
defšed
 
_REGEX_RE_COMP
 || (defšed 
_LIBC
 && defšed 
__USE_BSD
)

544 #iâdeà
_CRAY


546 *
»_comp
 (const *);

547 
»_exec
 (const *);

553 #iâdeà
__»¡riù


554 #ià! (2 < 
__GNUC__
 || (2 =ğ__GNUC__ && 95 <ğ
__GNUC_MINOR__
))

555 #ià
defšed
 
»¡riù
 || 199901L <ğ
__STDC_VERSION__


556 
	#__»¡riù
 
»¡riù


	)

558 
	#__»¡riù


	)

563 #iâdeà
__»¡riù_¬r


564 #ià(
__GNUC__
 > 3 || (__GNUC__ =ğ3 && 
__GNUC_MINOR__
 >= 1)) \

565 && !
defšed
 
	g__GNUG__


566 
	#__»¡riù_¬r
 
__»¡riù


	)

568 
	#__»¡riù_¬r


	)

573 
»gcomp
 (
»gex_t
 *
__»¡riù
 
__´eg
,

574 cÚ¡ *
__»¡riù
 
__·‰”n
,

575 
__cæags
);

577 
»gexec
 (cÚ¡ 
»gex_t
 *
__»¡riù
 
__´eg
,

578 cÚ¡ *
__»¡riù
 
__¡ršg
, 
size_t
 
__nm©ch
,

579 
»gm©ch_t
 
__pm©ch
[
__»¡riù_¬r
],

580 
__eæags
);

582 
size_t
 
»g”rÜ
 (
__”rcode
, cÚ¡ 
»gex_t
 *
__»¡riù
 
__´eg
,

583 *
__»¡riù
 
__”rbuf
, 
size_t
 
__”rbuf_size
);

585 
»gä“
 (
»gex_t
 *
__´eg
);

588 #ifdeà
__ılu¥lus


	@/usr/include/resolv.h

52 #iâdeà
_RESOLV_H_


56 
	~<sys/ty³s.h
>

57 
	~<Ãtš‘/š.h
>

59 #iâdeà
__Ãed_»s_¡©e


60 
	#_RESOLV_H_


	)

62 
	~<sys/·¿m.h
>

63 
	~<sys/cdefs.h
>

64 
	~<¡dio.h
>

65 
	~<¬·/Çme£r.h
>

68 #iâdeà
__»s_¡©e_defšed


69 
	#__»s_¡©e_defšed


	)

71 ’um { 
	m»s_gßh—d
, 
	m»s_ÃxŠs
, 
	m»s_modif›d
, 
	m»s_dÚe
, 
	m»s_”rÜ
 }

72 
	t»s_£ndhookaù
;

74 
	$»s_£ndhookaù
 (*
	t»s_£nd_qhook
è(
	tsockaddr_š
 * cÚ¡ *
	t__ns
,

75 cÚ¡ 
	tu_ch¬
 **
	t__qu”y
,

76 *
	t__qu”yËn
,

77 
	tu_ch¬
 *
	t__ªs
,

78 
	t__ªssiz
,

79 *
	t__»¥Ën
);

81 
	$»s_£ndhookaù
 (*
	t»s_£nd_rhook
è(cÚ¡ 
	tsockaddr_š
 *
	t__ns
,

82 cÚ¡ 
	tu_ch¬
 *
	t__qu”y
,

83 
	t__qu”yËn
,

84 
	tu_ch¬
 *
	t__ªs
,

85 
	t__ªssiz
,

86 *
	t__»¥Ën
);

91 
	#MAXNS
 3

	)

92 
	#MAXDFLSRCH
 3

	)

93 
	#MAXDNSRCH
 6

	)

94 
	#LOCALDOMAINPARTS
 2

	)

96 
	#RES_TIMEOUT
 5

	)

97 
	#MAXRESOLVSORT
 10

	)

98 
	#RES_MAXNDOTS
 15

	)

99 
	#RES_MAXRETRANS
 30

	)

100 
	#RES_MAXRETRY
 5

	)

101 
	#RES_DFLRETRY
 2

	)

102 
	#RES_MAXTIME
 65535

	)

104 
	s__»s_¡©e
 {

105 
»Œªs
;

106 
»Œy
;

107 
u_lÚg
 
İtiÚs
;

108 
nscouÁ
;

109 
sockaddr_š


110 
n§ddr_li¡
[
MAXNS
];

111 
	#n§ddr
 
n§ddr_li¡
[0]

	)

112 
u_shÜt
 
id
;

114 *
dn¤ch
[
MAXDNSRCH
+1];

115 
defdÇme
[256];

116 
u_lÚg
 
pfcode
;

117 
ndÙs
:4;

118 
nsÜt
:4;

119 
v6_uÇva
:1;

120 
unu£d
:23;

122 
š_addr
 
addr
;

123 
u_št32_t
 
mask
;

124 } 
sÜt_li¡
[
MAXRESOLVSORT
];

126 
»s_£nd_qhook
 
qhook
;

127 
»s_£nd_rhook
 
rhook
;

128 
»s_h_”ºo
;

129 
_vcsock
;

130 
u_št
 
_æags
;

133 
·d
[52];

135 
u_št16_t
 
nscouÁ
;

136 
u_št16_t
 
nsm­
[
MAXNS
];

137 
nssocks
[
MAXNS
];

138 
u_št16_t
 
nscouÁ6
;

139 
u_št16_t
 
nsš™
;

140 
sockaddr_š6
 *
n§ddrs
[
MAXNS
];

141 #ifdeà
_LIBC


142 
š™¡amp


143 
	`__©Œibu‹__
((
·cked
));

145 
_š™¡amp
[2];

147 } 
_ext
;

148 } 
_u
;

151 
__»s_¡©e
 *
	t»s_¡©e
;

152 #undeà
__Ãed_»s_¡©e


155 #ifdeà
_RESOLV_H_


164 
	#__RES
 19991006

	)

172 #iâdeà
_PATH_RESCONF


173 
	#_PATH_RESCONF
 "/‘c/»sŞv.cÚf"

	)

176 
	s»s_sym
 {

177 
numb”
;

178 * 
Çme
;

179 * 
humªÇme
;

185 
	#RES_F_VC
 0x00000001

	)

186 
	#RES_F_CONN
 0x00000002

	)

187 
	#RES_F_EDNS0ERR
 0x00000004

	)

190 
	#RES_EXHAUSTIVE
 0x00000001

	)

195 
	#RES_INIT
 0x00000001

	)

196 
	#RES_DEBUG
 0x00000002

	)

197 
	#RES_AAONLY
 0x00000004

	)

198 
	#RES_USEVC
 0x00000008

	)

199 
	#RES_PRIMARY
 0x00000010

	)

200 
	#RES_IGNTC
 0x00000020

	)

201 
	#RES_RECURSE
 0x00000040

	)

202 
	#RES_DEFNAMES
 0x00000080

	)

203 
	#RES_STAYOPEN
 0x00000100

	)

204 
	#RES_DNSRCH
 0x00000200

	)

205 
	#RES_INSECURE1
 0x00000400

	)

206 
	#RES_INSECURE2
 0x00000800

	)

207 
	#RES_NOALIASES
 0x00001000

	)

208 
	#RES_USE_INET6
 0x00002000

	)

209 
	#RES_ROTATE
 0x00004000

	)

210 
	#RES_NOCHECKNAME
 0x00008000

	)

211 
	#RES_KEEPTSIG
 0x00010000

	)

212 
	#RES_BLAST
 0x00020000

	)

213 
	#RES_USEBSTRING
 0x00040000

	)

215 
	#RES_NOIP6DOTINT
 0x00080000

	)

217 
	#RES_USE_EDNS0
 0x00100000

	)

218 
	#RES_SNGLKUP
 0x00200000

	)

219 
	#RES_SNGLKUPREOP
 0x00400000

	)

221 
	#RES_USE_DNSSEC
 0x00800000

	)

222 
	#RES_NOTLDQUERY
 0x01000000

	)

225 
	#RES_DEFAULT
 (
RES_RECURSE
|
RES_DEFNAMES
|
RES_DNSRCH
|
RES_NOIP6DOTINT
)

	)

230 
	#RES_PRF_STATS
 0x00000001

	)

231 
	#RES_PRF_UPDATE
 0x00000002

	)

232 
	#RES_PRF_CLASS
 0x00000004

	)

233 
	#RES_PRF_CMD
 0x00000008

	)

234 
	#RES_PRF_QUES
 0x00000010

	)

235 
	#RES_PRF_ANS
 0x00000020

	)

236 
	#RES_PRF_AUTH
 0x00000040

	)

237 
	#RES_PRF_ADD
 0x00000080

	)

238 
	#RES_PRF_HEAD1
 0x00000100

	)

239 
	#RES_PRF_HEAD2
 0x00000200

	)

240 
	#RES_PRF_TTLID
 0x00000400

	)

241 
	#RES_PRF_HEADX
 0x00000800

	)

242 
	#RES_PRF_QUERY
 0x00001000

	)

243 
	#RES_PRF_REPLY
 0x00002000

	)

244 
	#RES_PRF_INIT
 0x00004000

	)

248 
__BEGIN_DECLS


249 
__»s_¡©e
 *
	$__»s_¡©e
(è
	`__©Œibu‹__
 ((
__cÚ¡__
));

250 
__END_DECLS


251 
	#_»s
 (*
	`__»s_¡©e
())

	)

253 #iâdeà
__BIND_NOSTATIC


254 
	#å_nqu”y
 
__å_nqu”y


	)

255 
	#å_qu”y
 
__å_qu”y


	)

256 
	#ho¡®Ÿs
 
__ho¡®Ÿs


	)

257 
	#p_qu”y
 
__p_qu”y


	)

258 
	#»s_şo£
 
__»s_şo£


	)

259 
	#»s_š™
 
__»s_š™


	)

260 
	#»s_isour£rv”
 
__»s_isour£rv”


	)

261 
	#»s_mkqu”y
 
__»s_mkqu”y


	)

262 
	#»s_qu”y
 
__»s_qu”y


	)

263 
	#»s_qu”ydomaš
 
__»s_qu”ydomaš


	)

264 
	#»s_£¬ch
 
__»s_£¬ch


	)

265 
	#»s_£nd
 
__»s_£nd


	)

267 
__BEGIN_DECLS


268 
	$å_nqu”y
 (cÚ¡ 
u_ch¬
 *, , 
FILE
 *è
__THROW
;

269 
	$å_qu”y
 (cÚ¡ 
u_ch¬
 *, 
FILE
 *è
__THROW
;

270 cÚ¡ * 
	$ho¡®Ÿs
 (cÚ¡ *è
__THROW
;

271 
	$p_qu”y
 (cÚ¡ 
u_ch¬
 *è
__THROW
;

272 
	$»s_şo£
 (è
__THROW
;

273 
	$»s_š™
 (è
__THROW
;

274 
	$»s_isour£rv”
 (cÚ¡ 
sockaddr_š
 *è
__THROW
;

275 
	$»s_mkqu”y
 (, cÚ¡ *, , , cÚ¡ 
u_ch¬
 *,

276 , cÚ¡ 
u_ch¬
 *, u_ch¬ *, è
__THROW
;

277 
	$»s_qu”y
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

278 
	$»s_qu”ydomaš
 (const *, const *, , ,

279 
u_ch¬
 *, è
__THROW
;

280 
	$»s_£¬ch
 (cÚ¡ *, , , 
u_ch¬
 *, è
__THROW
;

281 
	$»s_£nd
 (cÚ¡ 
u_ch¬
 *, , u_ch¬ *, è
__THROW
;

282 
__END_DECLS


285 
	#b64_Áİ
 
__b64_Áİ


	)

286 
	#b64_±Ú
 
__b64_±Ú


	)

287 
	#dn_comp
 
__dn_comp


	)

288 
	#dn_couÁ_Ïb–s
 
__dn_couÁ_Ïb–s


	)

289 
	#dn_ex·nd
 
__dn_ex·nd


	)

290 
	#dn_skÇme
 
__dn_skÇme


	)

291 
	#å_»s¡©
 
__å_»s¡©


	)

292 
	#loc_©Ú
 
__loc_©Ú


	)

293 
	#loc_Áß
 
__loc_Áß


	)

294 
	#p_cdÇme
 
__p_cdÇme


	)

295 
	#p_cdÂame
 
__p_cdÂame


	)

296 
	#p_şass
 
__p_şass


	)

297 
	#p_fqÇme
 
__p_fqÇme


	)

298 
	#p_fqÂame
 
__p_fqÂame


	)

299 
	#p_İtiÚ
 
__p_İtiÚ


	)

300 
	#p_£c¡od©e
 
__p_£c¡od©e


	)

301 
	#p_£ùiÚ
 
__p_£ùiÚ


	)

302 
	#p_time
 
__p_time


	)

303 
	#p_ty³
 
__p_ty³


	)

304 
	#p_rcode
 
__p_rcode


	)

305 
	#puÚg
 
__puÚg


	)

306 
	#putshÜt
 
__putshÜt


	)

307 
	#»s_dnok
 
__»s_dnok


	)

308 
	#»s_hnok
 
__»s_hnok


	)

309 
	#»s_ho¡®Ÿs
 
__»s_ho¡®Ÿs


	)

310 
	#»s_maok
 
__»s_maok


	)

311 
	#»s_Çmešqu”y
 
__»s_Çmešqu”y


	)

312 
	#»s_nşo£
 
__»s_nşo£


	)

313 
	#»s_nš™
 
__»s_nš™


	)

314 
	#»s_nmkqu”y
 
__»s_nmkqu”y


	)

315 
	#»s_Åqu”y
 
__»s_Åqu”y


	)

316 
	#»s_nqu”y
 
__»s_nqu”y


	)

317 
	#»s_nqu”ydomaš
 
__»s_nqu”ydomaš


	)

318 
	#»s_n£¬ch
 
__»s_n£¬ch


	)

319 
	#»s_n£nd
 
__»s_n£nd


	)

320 
	#»s_nisour£rv”
 
__»s_nisour£rv”


	)

321 
	#»s_ownok
 
__»s_ownok


	)

322 
	#»s_qu”›sm©ch
 
__»s_qu”›sm©ch


	)

323 
	#»s_¿ndomid
 
__»s_¿ndomid


	)

324 
	#sym_Áİ
 
__sym_Áİ


	)

325 
	#sym_Áos
 
__sym_Áos


	)

326 
	#sym_¡Ú
 
__sym_¡Ú


	)

327 
__BEGIN_DECLS


328 
	$»s_hnok
 (cÚ¡ *è
__THROW
;

329 
	$»s_ownok
 (cÚ¡ *è
__THROW
;

330 
	$»s_maok
 (cÚ¡ *è
__THROW
;

331 
	$»s_dnok
 (cÚ¡ *è
__THROW
;

332 
	$sym_¡Ú
 (cÚ¡ 
»s_sym
 *, cÚ¡ *, *è
__THROW
;

333 cÚ¡ * 
	$sym_Áos
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

334 cÚ¡ * 
	$sym_Áİ
 (cÚ¡ 
»s_sym
 *, , *è
__THROW
;

335 
	$b64_Áİ
 (
u_ch¬
 cÚ¡ *, 
size_t
, *, size_tè
__THROW
;

336 
	$b64_±Ú
 (cÚ¡ *, 
u_ch¬
 *, 
size_t
è
__THROW
;

337 
	$loc_©Ú
 (cÚ¡ *
__ascii
, 
u_ch¬
 *
__bš¬y
è
__THROW
;

338 cÚ¡ * 
	$loc_Áß
 (cÚ¡ 
u_ch¬
 *
__bš¬y
, *
__ascii
è
__THROW
;

339 
	$dn_skÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

340 
	$puÚg
 (
u_št32_t
, 
u_ch¬
 *è
__THROW
;

341 
	$putshÜt
 (
u_št16_t
, 
u_ch¬
 *è
__THROW
;

342 cÚ¡ * 
	$p_şass
 (è
__THROW
;

343 cÚ¡ * 
	$p_time
 (
u_št32_t
è
__THROW
;

344 cÚ¡ * 
	$p_ty³
 (è
__THROW
;

345 cÚ¡ * 
	$p_rcode
 (è
__THROW
;

346 cÚ¡ 
u_ch¬
 * 
	$p_cdÂame
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, , 
FILE
 *)

347 
__THROW
;

348 cÚ¡ 
u_ch¬
 * 
	$p_cdÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

349 cÚ¡ 
u_ch¬
 * 
	$p_fqÂame
 (cÚ¡ 
u_ch¬
 *
__ı
, cÚ¡ u_ch¬ *
__msg
,

350 , *, è
__THROW
;

351 cÚ¡ 
u_ch¬
 * 
	$p_fqÇme
 (cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *, 
FILE
 *è
__THROW
;

352 cÚ¡ * 
	$p_İtiÚ
 (
u_lÚg
 
__İtiÚ
è
__THROW
;

353 * 
	$p_£c¡od©e
 (
u_lÚg
è
__THROW
;

354 
	$dn_couÁ_Ïb–s
 (cÚ¡ *è
__THROW
;

355 
	$dn_comp
 (cÚ¡ *, 
u_ch¬
 *, , u_char **, u_char **)

356 
__THROW
;

357 
	$dn_ex·nd
 (cÚ¡ 
u_ch¬
 *, const u_char *, const u_char *,

358 *, è
__THROW
;

359 
u_št
 
	$»s_¿ndomid
 (è
__THROW
;

360 
	$»s_Çmešqu”y
 (const *, , ,

361 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

362 
	$»s_qu”›sm©ch
 (cÚ¡ 
u_ch¬
 *, const u_char *,

363 cÚ¡ 
u_ch¬
 *, cÚ¡ u_ch¬ *è
__THROW
;

364 cÚ¡ * 
	$p_£ùiÚ
 (
__£ùiÚ
, 
__İcode
è
__THROW
;

366 
	$»s_nš™
 (
»s_¡©e
è
__THROW
;

367 
	$»s_nisour£rv”
 (cÚ¡ 
»s_¡©e
,

368 cÚ¡ 
sockaddr_š
 *è
__THROW
;

369 
	$å_»s¡©
 (cÚ¡ 
»s_¡©e
, 
FILE
 *è
__THROW
;

370 
	$»s_Åqu”y
 (cÚ¡ 
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , 
FILE
 *)

371 
__THROW
;

372 cÚ¡ * 
	$»s_ho¡®Ÿs
 (cÚ¡ 
»s_¡©e
, cÚ¡ *, *, 
size_t
)

373 
__THROW
;

374 
	$»s_nqu”y
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

375 
__THROW
;

376 
	$»s_n£¬ch
 (
»s_¡©e
, cÚ¡ *, , , 
u_ch¬
 *, )

377 
__THROW
;

378 
	$»s_nqu”ydomaš
 (
»s_¡©e
, const *, const *, ,

379 , 
u_ch¬
 *, è
__THROW
;

380 
	$»s_nmkqu”y
 (
»s_¡©e
, , const *, , ,

381 cÚ¡ 
u_ch¬
 *, , const u_char *, u_char *,

382 è
__THROW
;

383 
	$»s_n£nd
 (
»s_¡©e
, cÚ¡ 
u_ch¬
 *, , u_char *, )

384 
__THROW
;

385 
	$»s_nşo£
 (
»s_¡©e
è
__THROW
;

386 
__END_DECLS


	@/usr/include/sched.h

19 #iâdef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<ã©u»s.h
>

25 
	~<b™s/ty³s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

30 
	#__Ãed_time_t


	)

31 
	#__Ãed_time¥ec


	)

32 
	~<time.h
>

34 #iâdeà
__pid_t_defšed


35 
__pid_t
 
	tpid_t
;

36 
	#__pid_t_defšed


	)

41 
	~<b™s/sched.h
>

43 
	#sched_´iÜ™y
 
__sched_´iÜ™y


	)

46 
__BEGIN_DECLS


49 
	$sched_£¬am
 (
__pid_t
 
__pid
, cÚ¡ 
sched_·¿m
 *
__·¿m
)

50 
__THROW
;

53 
	$sched_g‘·¿m
 (
__pid_t
 
__pid
, 
sched_·¿m
 *
__·¿m
è
__THROW
;

56 
	$sched_£tscheduËr
 (
__pid_t
 
__pid
, 
__pŞicy
,

57 cÚ¡ 
sched_·¿m
 *
__·¿m
è
__THROW
;

60 
	$sched_g‘scheduËr
 (
__pid_t
 
__pid
è
__THROW
;

63 
	$sched_y›ld
 (è
__THROW
;

66 
	$sched_g‘_´iÜ™y_max
 (
__®gÜ™hm
è
__THROW
;

69 
	$sched_g‘_´iÜ™y_mš
 (
__®gÜ™hm
è
__THROW
;

72 
	$sched_¼_g‘_š‹rv®
 (
__pid_t
 
__pid
, 
time¥ec
 *
__t
è
__THROW
;

75 #ifdeà
__USE_GNU


77 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

78 
	#CPU_SET
(
ıu
, 
ıu£
è
	`__CPU_SET_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

79 
	#CPU_CLR
(
ıu
, 
ıu£
è
	`__CPU_CLR_S
 (ıu,  (
ıu_£t_t
), cpu£)

	)

80 
	#CPU_ISSET
(
ıu
, 
ıu£
è
	`__CPU_ISSET_S
 (ıu,  (
ıu_£t_t
), \

81 
ıu£
)

	)

82 
	#CPU_ZERO
(
ıu£
è
	`__CPU_ZERO_S
 ( (
ıu_£t_t
), cpu£)

	)

83 
	#CPU_COUNT
(
ıu£
è
	`__CPU_COUNT_S
 ( (
ıu_£t_t
), cpu£)

	)

85 
	#CPU_SET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_SET_S
 (ıu, s‘size, cpu£)

	)

86 
	#CPU_CLR_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_CLR_S
 (ıu, s‘size, cpu£)

	)

87 
	#CPU_ISSET_S
(
ıu
, 
£tsize
, 
ıu£
è
	`__CPU_ISSET_S
 (cpu, setsize, \

88 
ıu£
)

	)

89 
	#CPU_ZERO_S
(
£tsize
, 
ıu£
è
	`__CPU_ZERO_S
 (£tsize, cpu£)

	)

90 
	#CPU_COUNT_S
(
£tsize
, 
ıu£
è
	`__CPU_COUNT_S
 (£tsize, cpu£)

	)

92 
	#CPU_EQUAL
(
ıu£1
, 
ıu£2
) \

93 
	`__CPU_EQUAL_S
 ( (
ıu_£t_t
), 
ıu£1
, 
ıu£2
)

	)

94 
	#CPU_EQUAL_S
(
£tsize
, 
ıu£1
, 
ıu£2
) \

95 
	`__CPU_EQUAL_S
 (
£tsize
, 
ıu£1
, 
ıu£2
)

	)

97 
	#CPU_AND
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

98 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

99 
	#CPU_OR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

100 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

101 
	#CPU_XOR
(
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

102 
	`__CPU_OP_S
 ( (
ıu_£t_t
), 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

103 
	#CPU_AND_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

104 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, &)

	)

105 
	#CPU_OR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

106 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, |)

	)

107 
	#CPU_XOR_S
(
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
) \

108 
	`__CPU_OP_S
 (
£tsize
, 
de¡£t
, 
¤c£t1
, 
¤c£t2
, ^)

	)

110 
	#CPU_ALLOC_SIZE
(
couÁ
è
	`__CPU_ALLOC_SIZE
 (couÁ)

	)

111 
	#CPU_ALLOC
(
couÁ
è
	`__CPU_ALLOC
 (couÁ)

	)

112 
	#CPU_FREE
(
ıu£t
è
	`__CPU_FREE
 (ıu£t)

	)

116 
	$sched_£ffš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

117 cÚ¡ 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

120 
	$sched_g‘affš™y
 (
__pid_t
 
__pid
, 
size_t
 
__ıu£tsize
,

121 
ıu_£t_t
 *
__ıu£t
è
__THROW
;

124 
__END_DECLS


	@/usr/include/search.h

19 #iâdeà
_SEARCH_H


20 
	#_SEARCH_H
 1

	)

22 
	~<ã©u»s.h
>

24 
	#__Ãed_size_t


	)

25 
	~<¡ddef.h
>

27 
	g__BEGIN_DECLS


29 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


33 #ifdeà
__USE_GNU


34 
	sq–em


36 
q–em
 *
	mq_fÜw
;

37 
q–em
 *
	mq_back
;

38 
	mq_d©a
[1];

44 
	$šsque
 (*
__–em
, *
__´ev
è
__THROW
;

47 
	$»mque
 (*
__–em
è
__THROW
;

52 #iâdeà
__COMPAR_FN_T


53 
	#__COMPAR_FN_T


	)

54 (*
	t__com·r_â_t
) (const *, const *);

56 #ifdef 
__USE_GNU


57 
__com·r_â_t
 
	tcom·risÚ_â_t
;

64 
FIND
,

65 
ENTER


67 
	tACTION
;

69 
	s’Œy


71 *
key
;

72 *
d©a
;

74 
	tENTRY
;

77 
_ENTRY
;

87 
ENTRY
 *
	$h£¬ch
 (
ENTRY
 
__™em
, 
ACTION
 
__aùiÚ
è
__THROW
;

90 
	$hü—‹
 (
size_t
 
__Ãl
è
__THROW
;

93 
	$hde¡roy
 (è
__THROW
;

95 #ifdeà
__USE_GNU


97 
	sh£¬ch_d©a


99 
_ENTRY
 *
bË
;

100 
size
;

101 
fËd
;

106 
	$h£¬ch_r
 (
ENTRY
 
__™em
, 
ACTION
 
__aùiÚ
, ENTRY **
__»tv®
,

107 
h£¬ch_d©a
 *
__hb
è
__THROW
;

108 
	$hü—‹_r
 (
size_t
 
__Ãl
, 
h£¬ch_d©a
 *
__hb
è
__THROW
;

109 
	$hde¡roy_r
 (
h£¬ch_d©a
 *
__hb
è
__THROW
;

120 
´eÜd”
,

121 
po¡Üd”
,

122 
’dÜd”
,

123 
Ëaf


125 
	tVISIT
;

129 *
	`t£¬ch
 (cÚ¡ *
__key
, **
__roÙp
,

130 
__com·r_â_t
 
__com·r
);

134 *
	`tfšd
 (cÚ¡ *
__key
, *cÚ¡ *
__roÙp
,

135 
__com·r_â_t
 
__com·r
);

138 *
	`td–‘e
 (cÚ¡ *
__»¡riù
 
__key
,

139 **
__»¡riù
 
__roÙp
,

140 
__com·r_â_t
 
__com·r
);

142 #iâdeà
__ACTION_FN_T


143 
	#__ACTION_FN_T


	)

144 (*
	t__aùiÚ_â_t
è(cÚ¡ *
	t__nod•
, 
	tVISIT
 
	t__v®ue
,

145 
	t__Ëv–
);

150 
	`tw®k
 (cÚ¡ *
__roÙ
, 
__aùiÚ_â_t
 
__aùiÚ
);

152 #ifdeà
__USE_GNU


155 (*
	t__ä“_â_t
è(*
	t__nod•
);

158 
	`tde¡roy
 (*
__roÙ
, 
__ä“_â_t
 
__ä“fù
);

164 *
	`lfšd
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

165 
size_t
 *
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
);

169 *
	`l£¬ch
 (cÚ¡ *
__key
, *
__ba£
,

170 
size_t
 *
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
);

172 
__END_DECLS


	@/usr/include/signal.h

22 #iâdef 
_SIGNAL_H


24 #ià!
defšed
 
__Ãed_sig_©omic_t
 && !defšed 
__Ãed_sig£t_t


25 
	#_SIGNAL_H


	)

28 
	~<ã©u»s.h
>

30 
	g__BEGIN_DECLS


32 
	~<b™s/sig£t.h
>

36 #ià
defšed
 
__Ãed_sig_©omic_t
 || defšed 
_SIGNAL_H


37 #iâdeà
__sig_©omic_t_defšed


38 
	#__sig_©omic_t_defšed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_©omic_t
 
	tsig_©omic_t
;

41 
	g__END_NAMESPACE_STD


43 #undeà
__Ãed_sig_©omic_t


46 #ià
defšed
 
__Ãed_sig£t_t
 || (defšed 
_SIGNAL_H
 && defšed 
__USE_POSIX
)

47 #iâdeà
__sig£t_t_defšed


48 
	#__sig£t_t_defšed


	)

49 
__sig£t_t
 
	tsig£t_t
;

51 #undeà
__Ãed_sig£t_t


54 #ifdeà
_SIGNAL_H


56 
	~<b™s/ty³s.h
>

57 
	~<b™s/signum.h
>

59 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


60 #iâdeà
__pid_t_defšed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defšed


	)

64 #ifdeà
__USE_XOPEN


66 #iâdeà
__uid_t_defšed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defšed


	)

72 #ifdeà
__USE_POSIX199309


74 
	#__Ãed_time¥ec


	)

75 
	~<time.h
>

78 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_XOPEN_EXTENDED


80 
	~<b™s/sigšfo.h
>

85 (*
	t__sighªdËr_t
) ();

90 
__sighªdËr_t
 
	$__sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

91 
__THROW
;

92 #ifdeà
__USE_GNU


93 
__sighªdËr_t
 
	$sysv_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifdeà
__USE_BSD


102 
__sighªdËr_t
 
	$sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

103 
__THROW
;

106 #ifdeà
__REDIRECT_NTH


107 
__sighªdËr_t
 
	`__REDIRECT_NTH
 (
sigÇl
,

108 (
__sig
, 
__sighªdËr_t
 
__hªdËr
),

109 
__sysv_sigÇl
);

111 
	#sigÇl
 
__sysv_sigÇl


	)

114 
__END_NAMESPACE_STD


116 #ifdeà
__USE_XOPEN


119 
__sighªdËr_t
 
	$bsd_sigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

120 
__THROW
;

126 #ifdeà
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig
è
__THROW
;

130 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


134 
	$kÍg
 (
__pid_t
 
__pg½
, 
__sig
è
__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$¿i£
 (
__sig
è
__THROW
;

140 
__END_NAMESPACE_STD


142 #ifdeà
__USE_SVID


144 
__sighªdËr_t
 
	$ssigÇl
 (
__sig
, 
__sighªdËr_t
 
__hªdËr
)

145 
__THROW
;

146 
	$gsigÇl
 (
__sig
è
__THROW
;

149 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN2K


151 
	`psigÇl
 (
__sig
, cÚ¡ *
__s
);

154 #ifdeà
__USE_XOPEN2K


156 
	`psigšfo
 (cÚ¡ 
sigšfo_t
 *
__pšfo
, cÚ¡ *
__s
);

167 
	`__sig·u£
 (
__sig_Ü_mask
, 
__is_sig
);

169 #ifdeà
__USE_XOPEN


170 #ifdeà
__GNUC__


171 
	$sig·u£
 (
__sig
è
	`__asm__
 ("__xpg_sigpause");

174 
	#sig·u£
(
sig
è
	`__sig·u£
 ((sig), 1)

	)

179 #ifdeà
__USE_BSD


186 
	#sigmask
(
sig
è
	`__sigmask
(sig)

	)

189 
	$sigblock
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

192 
	$sig£tmask
 (
__mask
è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

195 
	$sigg‘mask
 (è
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

199 #ifdeà
__USE_MISC


200 
	#NSIG
 
_NSIG


	)

203 #ifdeà
__USE_GNU


204 
__sighªdËr_t
 
	tsighªdËr_t
;

208 #ifdeà
__USE_BSD


209 
__sighªdËr_t
 
	tsig_t
;

212 #ifdeà
__USE_POSIX


215 
	$sigem±y£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

218 
	$sigfl£t
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

221 
	$sigadd£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

224 
	$sigd–£t
 (
sig£t_t
 *
__£t
, 
__signo
è
__THROW
 
	`__nÚnuÎ
 ((1));

227 
	$sigismemb”
 (cÚ¡ 
sig£t_t
 *
__£t
, 
__signo
)

228 
__THROW
 
	`__nÚnuÎ
 ((1));

230 #ifdeà
__USE_GNU


232 
	$sigi£m±y£t
 (cÚ¡ 
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

235 
	$sigªd£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

236 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

239 
	$sigÜ£t
 (
sig£t_t
 *
__£t
, cÚ¡ sig£t_ˆ*
__Ëá
,

240 cÚ¡ 
sig£t_t
 *
__right
è
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3));

245 
	~<b™s/sigaùiÚ.h
>

248 
	$sig´ocmask
 (
__how
, cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

249 
sig£t_t
 *
__»¡riù
 
__o£t
è
__THROW
;

256 
	$sigsu¥’d
 (cÚ¡ 
sig£t_t
 *
__£t
è
	`__nÚnuÎ
 ((1));

259 
	$sigaùiÚ
 (
__sig
, cÚ¡ 
sigaùiÚ
 *
__»¡riù
 
__aù
,

260 
sigaùiÚ
 *
__»¡riù
 
__ßù
è
__THROW
;

263 
	$sig³ndšg
 (
sig£t_t
 *
__£t
è
__THROW
 
	`__nÚnuÎ
 ((1));

270 
	$sigwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
, *__»¡riù 
__sig
)

271 
	`__nÚnuÎ
 ((1, 2));

273 #ifdeà
__USE_POSIX199309


278 
	$sigwa™šfo
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

279 
sigšfo_t
 *
__»¡riù
 
__šfo
è
	`__nÚnuÎ
 ((1));

286 
	$sigtimedwa™
 (cÚ¡ 
sig£t_t
 *
__»¡riù
 
__£t
,

287 
sigšfo_t
 *
__»¡riù
 
__šfo
,

288 cÚ¡ 
time¥ec
 *
__»¡riù
 
__timeout
)

289 
	`__nÚnuÎ
 ((1));

293 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cÚ¡ 
sigv®
 
__v®
)

294 
__THROW
;

299 #ifdeà
__USE_BSD


303 cÚ¡ *cÚ¡ 
_sys_sigli¡
[
_NSIG
];

304 cÚ¡ *cÚ¡ 
sys_sigli¡
[
_NSIG
];

307 
	ssigvec


309 
__sighªdËr_t
 
sv_hªdËr
;

310 
sv_mask
;

312 
sv_æags
;

313 
	#sv_Ú¡ack
 
sv_æags


	)

317 
	#SV_ONSTACK
 (1 << 0)

	)

318 
	#SV_INTERRUPT
 (1 << 1)

	)

319 
	#SV_RESETHAND
 (1 << 2)

	)

327 
	$sigvec
 (
__sig
, cÚ¡ 
sigvec
 *
__vec
,

328 
sigvec
 *
__ovec
è
__THROW
;

332 
	~<b™s/sigcÚ‹xt.h
>

335 
	$sig»tuº
 (
sigcÚ‹xt
 *
__sı
è
__THROW
;

340 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


341 
	#__Ãed_size_t


	)

342 
	~<¡ddef.h
>

347 
	$sigš‹¼u±
 (
__sig
, 
__š‹¼u±
è
__THROW
;

349 
	~<b™s/sig¡ack.h
>

350 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


352 
	~<sys/ucÚ‹xt.h
>

358 
	$sig¡ack
 (
sig¡ack
 *
__ss
, sig¡ack *
__oss
)

359 
__THROW
 
__©Œibu‹_d•»ÿ‹d__
;

363 
	$sig®t¡ack
 (cÚ¡ 
sig®t¡ack
 *
__»¡riù
 
__ss
,

364 
sig®t¡ack
 *
__»¡riù
 
__oss
è
__THROW
;

368 #ifdeà
__USE_XOPEN_EXTENDED


372 
	$sighŞd
 (
__sig
è
__THROW
;

375 
	$sig»l£
 (
__sig
è
__THROW
;

378 
	$sigignÜe
 (
__sig
è
__THROW
;

381 
__sighªdËr_t
 
	$sig£t
 (
__sig
, 
__sighªdËr_t
 
__di¥
è
__THROW
;

384 #ià
defšed
 
__USE_POSIX199506
 || defšed 
__USE_UNIX98


387 
	~<b™s/±h»adty³s.h
>

388 
	~<b™s/sigth»ad.h
>

395 
	$__libc_cu¼’t_sig¹mš
 (è
__THROW
;

397 
	$__libc_cu¼’t_sig¹max
 (è
__THROW
;

401 
__END_DECLS


	@/usr/include/stdint.h

22 #iâdeà
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	~<b™s/wch¬.h
>

27 
	~<b™s/wÜdsize.h
>

34 #iâdeà
__št8_t_defšed


35 
	#__št8_t_defšed


	)

36 sigÃd 
	tšt8_t
;

37 
	tšt16_t
;

38 
	tšt32_t
;

39 #ià
__WORDSIZE
 == 64

40 
	tšt64_t
;

42 
__ex‹nsiÚ__


43 
	tšt64_t
;

48 
	tušt8_t
;

49 
	tušt16_t
;

50 #iâdeà
__ušt32_t_defšed


51 
	tušt32_t
;

52 
	#__ušt32_t_defšed


	)

54 #ià
__WORDSIZE
 == 64

55 
	tušt64_t
;

57 
__ex‹nsiÚ__


58 
	tušt64_t
;

65 sigÃd 
	tšt_Ëa¡8_t
;

66 
	tšt_Ëa¡16_t
;

67 
	tšt_Ëa¡32_t
;

68 #ià
__WORDSIZE
 == 64

69 
	tšt_Ëa¡64_t
;

71 
__ex‹nsiÚ__


72 
	tšt_Ëa¡64_t
;

76 
	tušt_Ëa¡8_t
;

77 
	tušt_Ëa¡16_t
;

78 
	tušt_Ëa¡32_t
;

79 #ià
__WORDSIZE
 == 64

80 
	tušt_Ëa¡64_t
;

82 
__ex‹nsiÚ__


83 
	tušt_Ëa¡64_t
;

90 sigÃd 
	tšt_ç¡8_t
;

91 #ià
__WORDSIZE
 == 64

92 
	tšt_ç¡16_t
;

93 
	tšt_ç¡32_t
;

94 
	tšt_ç¡64_t
;

96 
	tšt_ç¡16_t
;

97 
	tšt_ç¡32_t
;

98 
__ex‹nsiÚ__


99 
	tšt_ç¡64_t
;

103 
	tušt_ç¡8_t
;

104 #ià
__WORDSIZE
 == 64

105 
	tušt_ç¡16_t
;

106 
	tušt_ç¡32_t
;

107 
	tušt_ç¡64_t
;

109 
	tušt_ç¡16_t
;

110 
	tušt_ç¡32_t
;

111 
__ex‹nsiÚ__


112 
	tušt_ç¡64_t
;

117 #ià
__WORDSIZE
 == 64

118 #iâdeà
__šŒ_t_defšed


119 
	tšŒ_t
;

120 
	#__šŒ_t_defšed


	)

122 
	tušŒ_t
;

124 #iâdeà
__šŒ_t_defšed


125 
	tšŒ_t
;

126 
	#__šŒ_t_defšed


	)

128 
	tušŒ_t
;

133 #ià
__WORDSIZE
 == 64

134 
	tštmax_t
;

135 
	tuštmax_t
;

137 
__ex‹nsiÚ__


138 
	tštmax_t
;

139 
__ex‹nsiÚ__


140 
	tuštmax_t
;

144 #ià
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
èø## 
L


	)

146 
	#__UINT64_C
(
c
èø## 
UL


	)

148 
	#__INT64_C
(
c
èø## 
LL


	)

149 
	#__UINT64_C
(
c
èø## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #ià
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #ià
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #ià
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #ià
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #ià
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #ià
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 
	#SIZE_MAX
 (4294967295U)

	)

267 #iâdeà
WCHAR_MIN


269 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

270 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

274 
	#WINT_MIN
 (0u)

	)

275 
	#WINT_MAX
 (4294967295u)

	)

278 
	#INT8_C
(
c
è
	)
c

279 
	#INT16_C
(
c
è
	)
c

280 
	#INT32_C
(
c
è
	)
c

281 #ià
__WORDSIZE
 == 64

282 
	#INT64_C
(
c
èø## 
L


	)

284 
	#INT64_C
(
c
èø## 
LL


	)

288 
	#UINT8_C
(
c
è
	)
c

289 
	#UINT16_C
(
c
è
	)
c

290 
	#UINT32_C
(
c
èø## 
U


	)

291 #ià
__WORDSIZE
 == 64

292 
	#UINT64_C
(
c
èø## 
UL


	)

294 
	#UINT64_C
(
c
èø## 
ULL


	)

298 #ià
__WORDSIZE
 == 64

299 
	#INTMAX_C
(
c
èø## 
L


	)

300 
	#UINTMAX_C
(
c
èø## 
UL


	)

302 
	#INTMAX_C
(
c
èø## 
LL


	)

303 
	#UINTMAX_C
(
c
èø## 
ULL


	)

	@/usr/include/stdio.h

23 #iâdeà
_STDIO_H


25 #ià!
defšed
 
__Ãed_FILE
 && !defšed 
__Ãed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


31 
	#__Ãed_size_t


	)

32 
	#__Ãed_NULL


	)

33 
	~<¡ddef.h
>

35 
	~<b™s/ty³s.h
>

36 
	#__Ãed_FILE


	)

37 
	#__Ãed___FILE


	)

41 #ià!
defšed
 
__FILE_defšed
 && defšed 
__Ãed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #ià
defšed
 
__USE_LARGEFILE64
 || defšed 
__USE_SVID
 || defšed 
__USE_POSIX
 \

51 || 
defšed
 
	g__USE_BSD
 || defšed 
	g__USE_ISOC99
 || defšed 
	g__USE_XOPEN
 \

52 || 
defšed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defšed
 1

	)

58 #undeà
__Ãed_FILE


61 #ià!
defšed
 
____FILE_defšed
 && defšed 
__Ãed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defšed
 1

	)

68 #undeà
__Ãed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8


77 #ifdeà
__GNUC__


78 #iâdeà
_VA_LIST_DEFINED


79 
_G_va_li¡
 
	tva_li¡
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<¡d¬g.h
>

87 #ifdeà
__USE_XOPEN2K8


88 #iâdeà
__off_t_defšed


89 #iâdeà
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defšed


	)

96 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defšed


	)

101 #iâdeà
__ssize_t_defšed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defšed


	)

108 
__BEGIN_NAMESPACE_STD


109 #iâdeà
__USE_FILE_OFFSET64


110 
_G_åos_t
 
	tåos_t
;

112 
_G_åos64_t
 
	tåos_t
;

114 
__END_NAMESPACE_STD


115 #ifdeà
__USE_LARGEFILE64


116 
_G_åos64_t
 
	tåos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #iâdeà
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #iâdeà
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifdeà
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


151 
	#P_tmpdœ
 "/tmp"

	)

164 
	~<b™s/¡dio_lim.h
>

168 
_IO_FILE
 *
¡dš
;

169 
_IO_FILE
 *
¡dout
;

170 
_IO_FILE
 *
¡d”r
;

172 
	#¡dš
 
¡dš


	)

173 
	#¡dout
 
¡dout


	)

174 
	#¡d”r
 
¡d”r


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$»move
 (cÚ¡ *
__f’ame
è
__THROW
;

180 
	$»Çme
 (cÚ¡ *
__Şd
, cÚ¡ *
__Ãw
è
__THROW
;

181 
__END_NAMESPACE_STD


183 #ifdeà
__USE_ATFILE


185 
	$»Çm—t
 (
__Şdfd
, cÚ¡ *
__Şd
, 
__Ãwfd
,

186 cÚ¡ *
__Ãw
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #iâdeà
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (è
__wur
;

197 #ifdeà
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64
è
__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifdeà
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (è
__wur
;

209 *
	$tm²am
 (*
__s
è
__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifdeà
__USE_MISC


215 *
	$tm²am_r
 (*
__s
è
__THROW
 
__wur
;

219 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


227 *
	$‹m²am
 (cÚ¡ *
__dœ
, cÚ¡ *
__pfx
)

228 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fşo£
 (
FILE
 *
__¡»am
);

242 
	`fæush
 (
FILE
 *
__¡»am
);

243 
__END_NAMESPACE_STD


245 #ifdeà
__USE_MISC


252 
	`fæush_uÆocked
 (
FILE
 *
__¡»am
);

255 #ifdeà
__USE_GNU


262 
	`fşo£®l
 ();

266 
__BEGIN_NAMESPACE_STD


267 #iâdeà
__USE_FILE_OFFSET64


272 
FILE
 *
	$fİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

273 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

278 
FILE
 *
	$äeİ’
 (cÚ¡ *
__»¡riù
 
__f’ame
,

279 cÚ¡ *
__»¡riù
 
__modes
,

280 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

282 #ifdeà
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

284 cÚ¡ *
__»¡riù
 
__modes
), 
fİ’64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
äeİ’
, (cÚ¡ *
__»¡riù
 
__f’ame
,

287 cÚ¡ *
__»¡riù
 
__modes
,

288 
FILE
 *
__»¡riù
 
__¡»am
), 
äeİ’64
)

289 
__wur
;

291 
	#fİ’
 
fİ’64


	)

292 
	#äeİ’
 
äeİ’64


	)

295 
__END_NAMESPACE_STD


296 #ifdeà
__USE_LARGEFILE64


297 
FILE
 *
	$fİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

298 cÚ¡ *
__»¡riù
 
__modes
è
__wur
;

299 
FILE
 *
	$äeİ’64
 (cÚ¡ *
__»¡riù
 
__f’ame
,

300 cÚ¡ *
__»¡riù
 
__modes
,

301 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdİ’
 (
__fd
, cÚ¡ *
__modes
è
__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fİ’cook›
 (*
__»¡riù
 
__magic_cook›
,

313 cÚ¡ *
__»¡riù
 
__modes
,

314 
_IO_cook›_io_funùiÚs_t
 
__io_funcs
è
__THROW
 
__wur
;

317 #ifdeà
__USE_XOPEN2K8


319 
FILE
 *
	$fmemİ’
 (*
__s
, 
size_t
 
__Ën
, cÚ¡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$İ’_mem¡»am
 (**
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$£tbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
è
__THROW
;

336 
	$£tvbuf
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

337 
__modes
, 
size_t
 
__n
è
__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_BSD


343 
	$£tbufãr
 (
FILE
 *
__»¡riù
 
__¡»am
, *__»¡riù 
__buf
,

344 
size_t
 
__size
è
__THROW
;

347 
	$£šebuf
 (
FILE
 *
__¡»am
è
__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`årštf
 (
FILE
 *
__»¡riù
 
__¡»am
,

357 cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

362 
	`´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...);

364 
	$¥rštf
 (*
__»¡riù
 
__s
,

365 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROWNL
;

371 
	`vårštf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

372 
_G_va_li¡
 
__¬g
);

377 
	`v´štf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
);

379 
	$v¥rštf
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

380 
_G_va_li¡
 
__¬g
è
__THROWNL
;

381 
__END_NAMESPACE_STD


383 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_ISOC99
 || defšed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

387 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

388 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 4)));

390 
	$v¢´štf
 (*
__»¡riù
 
__s
, 
size_t
 
__maxËn
,

391 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

392 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifdeà
__USE_GNU


399 
	$va¥rštf
 (**
__»¡riù
 
__±r
, cÚ¡ *__»¡riù 
__f
,

400 
_G_va_li¡
 
__¬g
)

401 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 0))è
__wur
;

402 
	$__a¥rštf
 (**
__»¡riù
 
__±r
,

403 cÚ¡ *
__»¡riù
 
__fmt
, ...)

404 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

405 
	$a¥rštf
 (**
__»¡riù
 
__±r
,

406 cÚ¡ *
__»¡riù
 
__fmt
, ...)

407 
__THROWNL
 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__´štf__
, 2, 3))è
__wur
;

410 #ifdeà
__USE_XOPEN2K8


412 
	$vd´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
,

413 
_G_va_li¡
 
__¬g
)

414 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

415 
	$d´štf
 (
__fd
, cÚ¡ *
__»¡riù
 
__fmt
, ...)

416 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

426 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

431 
	$sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

433 
	$ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

434 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

436 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

437 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

438 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

439 #ifdeà
__REDIRECT


443 
	`__REDIRECT
 (
fsÿnf
, (
FILE
 *
__»¡riù
 
__¡»am
,

444 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

445 
__isoc99_fsÿnf
è
__wur
;

446 
	`__REDIRECT
 (
sÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

447 
__isoc99_sÿnf
è
__wur
;

448 
	`__REDIRECT_NTH
 (
ssÿnf
, (cÚ¡ *
__»¡riù
 
__s
,

449 cÚ¡ *
__»¡riù
 
__fÜm©
, ...),

450 
__isoc99_ssÿnf
);

452 
	$__isoc99_fsÿnf
 (
FILE
 *
__»¡riù
 
__¡»am
,

453 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

454 
	$__isoc99_sÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__wur
;

455 
	$__isoc99_ssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

456 cÚ¡ *
__»¡riù
 
__fÜm©
, ...è
__THROW
;

457 
	#fsÿnf
 
__isoc99_fsÿnf


	)

458 
	#sÿnf
 
__isoc99_sÿnf


	)

459 
	#ssÿnf
 
__isoc99_ssÿnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__fÜm©
,

472 
_G_va_li¡
 
__¬g
)

473 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

479 
	$vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

480 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

483 
	$vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

484 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
)

485 
__THROW
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

487 #ià!
defšed
 
__USE_GNU
 \

488 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

489 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

490 #ifdeà
__REDIRECT


494 
	`__REDIRECT
 (
vfsÿnf
,

495 (
FILE
 *
__»¡riù
 
__s
,

496 cÚ¡ *
__»¡riù
 
__fÜm©
, 
_G_va_li¡
 
__¬g
),

497 
__isoc99_vfsÿnf
)

498 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 2, 0))è
__wur
;

499 
	`__REDIRECT
 (
vsÿnf
, (cÚ¡ *
__»¡riù
 
__fÜm©
,

500 
_G_va_li¡
 
__¬g
), 
__isoc99_vsÿnf
)

501 
	`__©Œibu‹__
 ((
	$__fÜm©__
 (
__sÿnf__
, 1, 0))è
__wur
;

502 
	`__REDIRECT_NTH
 (
vssÿnf
,

503 (cÚ¡ *
__»¡riù
 
__s
,

504 cÚ¡ *
__»¡riù
 
__fÜm©
,

505 
_G_va_li¡
 
__¬g
), 
__isoc99_vssÿnf
)

506 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__sÿnf__
, 2, 0)));

508 
	$__isoc99_vfsÿnf
 (
FILE
 *
__»¡riù
 
__s
,

509 cÚ¡ *
__»¡riù
 
__fÜm©
,

510 
_G_va_li¡
 
__¬g
è
__wur
;

511 
	$__isoc99_vsÿnf
 (cÚ¡ *
__»¡riù
 
__fÜm©
,

512 
_G_va_li¡
 
__¬g
è
__wur
;

513 
	$__isoc99_vssÿnf
 (cÚ¡ *
__»¡riù
 
__s
,

514 cÚ¡ *
__»¡riù
 
__fÜm©
,

515 
_G_va_li¡
 
__¬g
è
__THROW
;

516 
	#vfsÿnf
 
__isoc99_vfsÿnf


	)

517 
	#vsÿnf
 
__isoc99_vsÿnf


	)

518 
	#vssÿnf
 
__isoc99_vssÿnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fg‘c
 (
FILE
 *
__¡»am
);

532 
	`g‘c
 (
FILE
 *
__¡»am
);

538 
	`g‘ch¬
 ();

539 
__END_NAMESPACE_STD


543 
	#g‘c
(
_å
è
	`_IO_g‘c
 (_å)

	)

545 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


550 
	`g‘c_uÆocked
 (
FILE
 *
__¡»am
);

551 
	`g‘ch¬_uÆocked
 ();

554 #ifdeà
__USE_MISC


561 
	`fg‘c_uÆocked
 (
FILE
 *
__¡»am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`åutc
 (
__c
, 
FILE
 *
__¡»am
);

574 
	`putc
 (
__c
, 
FILE
 *
__¡»am
);

580 
	`putch¬
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_å
è
	`_IO_putc
 (_ch, _å)

	)

587 #ifdeà
__USE_MISC


594 
	`åutc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

597 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


602 
	`putc_uÆocked
 (
__c
, 
FILE
 *
__¡»am
);

603 
	`putch¬_uÆocked
 (
__c
);

607 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_MISC
 \

608 || (
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

610 
	`g‘w
 (
FILE
 *
__¡»am
);

613 
	`putw
 (
__w
, 
FILE
 *
__¡»am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fg‘s
 (*
__»¡riù
 
__s
, 
__n
, 
FILE
 *__»¡riù 
__¡»am
)

623 
__wur
;

625 #ià!
defšed
 
__USE_ISOC11
 \

626 || (
defšed
 
__ılu¥lus
 && __cplusplus <= 201103L)

638 *
	$g‘s
 (*
__s
è
__wur
 
__©Œibu‹_d•»ÿ‹d__
;

640 
__END_NAMESPACE_STD


642 #ifdeà
__USE_GNU


649 *
	$fg‘s_uÆocked
 (*
__»¡riù
 
__s
, 
__n
,

650 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

666 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

667 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

668 
_IO_ssize_t
 
	$g‘d–im
 (**
__»¡riù
 
__lš•Œ
,

669 
size_t
 *
__»¡riù
 
__n
, 
__d–im™”
,

670 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

678 
_IO_ssize_t
 
	$g‘lše
 (**
__»¡riù
 
__lš•Œ
,

679 
size_t
 *
__»¡riù
 
__n
,

680 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`åuts
 (cÚ¡ *
__»¡riù
 
__s
, 
FILE
 *__»¡riù 
__¡»am
);

695 
	`puts
 (cÚ¡ *
__s
);

702 
	`ung‘c
 (
__c
, 
FILE
 *
__¡»am
);

709 
size_t
 
	$ä—d
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

715 
size_t
 
	`fwr™e
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

716 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifdeà
__USE_GNU


726 
	`åuts_uÆocked
 (cÚ¡ *
__»¡riù
 
__s
,

727 
FILE
 *
__»¡riù
 
__¡»am
);

730 #ifdeà
__USE_MISC


737 
size_t
 
	$ä—d_uÆocked
 (*
__»¡riù
 
__±r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
è
__wur
;

739 
size_t
 
	`fwr™e_uÆocked
 (cÚ¡ *
__»¡riù
 
__±r
, size_ˆ
__size
,

740 
size_t
 
__n
, 
FILE
 *
__»¡riù
 
__¡»am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`f£ek
 (
FILE
 *
__¡»am
, 
__off
, 
__wh’û
);

754 
	$á–l
 (
FILE
 *
__¡»am
è
__wur
;

759 
	`»wšd
 (
FILE
 *
__¡»am
);

760 
__END_NAMESPACE_STD


767 #ià
defšed
 
__USE_LARGEFILE
 || defšed 
__USE_XOPEN2K


768 #iâdeà
__USE_FILE_OFFSET64


773 
	`f£eko
 (
FILE
 *
__¡»am
, 
__off_t
 
__off
, 
__wh’û
);

778 
__off_t
 
	$á–lo
 (
FILE
 *
__¡»am
è
__wur
;

780 #ifdeà
__REDIRECT


781 
	`__REDIRECT
 (
f£eko
,

782 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
),

783 
f£eko64
);

784 
__off64_t
 
	`__REDIRECT
 (
á–lo
, (
FILE
 *
__¡»am
), 
á–lo64
);

786 
	#f£eko
 
f£eko64


	)

787 
	#á–lo
 
á–lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #iâdeà
__USE_FILE_OFFSET64


798 
	`fg‘pos
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos_t
 *__»¡riù 
__pos
);

803 
	`f£os
 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
);

805 #ifdeà
__REDIRECT


806 
	`__REDIRECT
 (
fg‘pos
, (
FILE
 *
__»¡riù
 
__¡»am
,

807 
åos_t
 *
__»¡riù
 
__pos
), 
fg‘pos64
);

808 
	`__REDIRECT
 (
f£os
,

809 (
FILE
 *
__¡»am
, cÚ¡ 
åos_t
 *
__pos
), 
f£os64
);

811 
	#fg‘pos
 
fg‘pos64


	)

812 
	#f£os
 
f£os64


	)

815 
__END_NAMESPACE_STD


817 #ifdeà
__USE_LARGEFILE64


818 
	`f£eko64
 (
FILE
 *
__¡»am
, 
__off64_t
 
__off
, 
__wh’û
);

819 
__off64_t
 
	$á–lo64
 (
FILE
 *
__¡»am
è
__wur
;

820 
	`fg‘pos64
 (
FILE
 *
__»¡riù
 
__¡»am
, 
åos64_t
 *__»¡riù 
__pos
);

821 
	`f£os64
 (
FILE
 *
__¡»am
, cÚ¡ 
åos64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$ş—»¼
 (
FILE
 *
__¡»am
è
__THROW
;

828 
	$ãof
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

830 
	$ã¼Ü
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifdeà
__USE_MISC


835 
	$ş—»¼_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
;

836 
	$ãof_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

837 
	$ã¼Ü_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`³¼Ü
 (cÚ¡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<b™s/sys_”¾i¡.h
>

856 #ifdef 
__USE_POSIX


858 
	$f’o
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

861 #ifdeà
__USE_MISC


863 
	$f’o_uÆocked
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

867 #ià(
defšed
 
__USE_POSIX2
 || defšed 
__USE_SVID
 || defšed 
__USE_BSD
 || \

868 
defšed
 
__USE_MISC
)

873 
FILE
 *
	$pİ’
 (cÚ¡ *
__commªd
, cÚ¡ *
__modes
è
__wur
;

879 
	`pşo£
 (
FILE
 *
__¡»am
);

883 #ifdef 
__USE_POSIX


885 *
	$ù”mid
 (*
__s
è
__THROW
;

889 #ifdeà
__USE_XOPEN


891 *
	`cu£rid
 (*
__s
);

895 #ifdef 
__USE_GNU


896 
ob¡ack
;

899 
	$ob¡ack_´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

900 cÚ¡ *
__»¡riù
 
__fÜm©
, ...)

901 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 3)));

902 
	$ob¡ack_v´štf
 (
ob¡ack
 *
__»¡riù
 
__ob¡ack
,

903 cÚ¡ *
__»¡riù
 
__fÜm©
,

904 
_G_va_li¡
 
__¬gs
)

905 
__THROWNL
 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__´štf__
, 2, 0)));

909 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


913 
	$æockfe
 (
FILE
 *
__¡»am
è
__THROW
;

917 
	$árylockfe
 (
FILE
 *
__¡»am
è
__THROW
 
__wur
;

920 
	$fuÆockfe
 (
FILE
 *
__¡»am
è
__THROW
;

923 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


927 
	#__Ãed_g‘İt


	)

928 
	~<g‘İt.h
>

933 #ifdeà
__USE_EXTERN_INLINES


934 
	~<b™s/¡dio.h
>

936 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__ex‹º_®ways_šlše


937 
	~<b™s/¡dio2.h
>

939 #ifdeà
__LDBL_COMPAT


940 
	~<b™s/¡dio-ldbl.h
>

943 
__END_DECLS


	@/usr/include/stdlib.h

22 #iâdef 
_STDLIB_H


24 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


29 
	#__Ãed_wch¬_t


	)

30 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

34 
	g__BEGIN_DECLS


36 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


37 
	#_STDLIB_H
 1

	)

39 #ià(
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K8
è&& !defšed 
_SYS_WAIT_H


41 
	~<b™s/wa™æags.h
>

42 
	~<b™s/wa™¡©us.h
>

44 #ifdeà
__USE_BSD


49 #ià
defšed
 
__GNUC__
 && !defšed 
__ılu¥lus


50 
	#__WAIT_INT
(
¡©us
) \

51 (
	`__ex‹nsiÚ__
 (((uniÚ { 
	`__ty³of
(
¡©us
è
__š
; 
__i
; }) \

52 { .
__š
 = (
¡©us
è}).
__i
))

	)

54 
	#__WAIT_INT
(
¡©us
è(*(*è&(¡©us))

	)

62 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2 || defšed 
__ılu¥lus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa™
 *
	m__u±r
;

70 *
	m__Œ
;

71 } 
	t__WAIT_STATUS
 
	t__©Œibu‹__
 ((
	t__Œª¥¬’t_uniÚ__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
¡©us
è(¡©us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
¡©us
è
	`__WEXITSTATUS
 (
	`__WAIT_INT
 (¡©us))

	)

85 
	#WTERMSIG
(
¡©us
è
	`__WTERMSIG
 (
	`__WAIT_INT
 (¡©us))

	)

86 
	#WSTOPSIG
(
¡©us
è
	`__WSTOPSIG
 (
	`__WAIT_INT
 (¡©us))

	)

87 
	#WIFEXITED
(
¡©us
è
	`__WIFEXITED
 (
	`__WAIT_INT
 (¡©us))

	)

88 
	#WIFSIGNALED
(
¡©us
è
	`__WIFSIGNALED
 (
	`__WAIT_INT
 (¡©us))

	)

89 
	#WIFSTOPPED
(
¡©us
è
	`__WIFSTOPPED
 (
	`__WAIT_INT
 (¡©us))

	)

90 #ifdeà
__WIFCONTINUED


91 
	#WIFCONTINUED
(
¡©us
è
	`__WIFCONTINUED
 (
	`__WAIT_INT
 (¡©us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mquÙ
;

100 
	m»m
;

101 } 
	tdiv_t
;

104 #iâdeà
__ldiv_t_defšed


107 
	mquÙ
;

108 
	m»m
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defšed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__Îdiv_t_defšed


115 
__BEGIN_NAMESPACE_C99


117 
__ex‹nsiÚ__
 struct

119 
	mquÙ
;

120 
	m»m
;

121 } 
	tÎdiv_t
;

122 
	#__Îdiv_t_defšed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__ùy³_g‘_mb_cur_max
 ())

	)

139 
size_t
 
	$__ùy³_g‘_mb_cur_max
 (è
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$©of
 (cÚ¡ *
__ÅŒ
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

147 
	$©oi
 (cÚ¡ *
__ÅŒ
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

150 
	$©Ş
 (cÚ¡ *
__ÅŒ
)

151 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

152 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


155 
__BEGIN_NAMESPACE_C99


157 
__ex‹nsiÚ__
 
	$©Şl
 (cÚ¡ *
__ÅŒ
)

158 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$¡¹od
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

165 **
__»¡riù
 
__’d±r
)

166 
__THROW
 
	`__nÚnuÎ
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$¡¹of
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

173 **
__»¡riù
 
__’d±r
è
__THROW
 
	`__nÚnuÎ
 ((1));

175 
	$¡¹Şd
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

176 **
__»¡riù
 
__’d±r
)

177 
__THROW
 
	`__nÚnuÎ
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$¡¹Ş
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

184 **
__»¡riù
 
__’d±r
, 
__ba£
)

185 
__THROW
 
	`__nÚnuÎ
 ((1));

187 
	$¡¹oul
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

188 **
__»¡riù
 
__’d±r
, 
__ba£
)

189 
__THROW
 
	`__nÚnuÎ
 ((1));

190 
__END_NAMESPACE_STD


192 #ifdeà
__USE_BSD


194 
__ex‹nsiÚ__


195 
	$¡¹oq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

196 **
__»¡riù
 
__’d±r
, 
__ba£
)

197 
__THROW
 
	`__nÚnuÎ
 ((1));

199 
__ex‹nsiÚ__


200 
	$¡¹ouq
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

201 **
__»¡riù
 
__’d±r
, 
__ba£
)

202 
__THROW
 
	`__nÚnuÎ
 ((1));

205 #ià
defšed
 
__USE_ISOC99
 || defšed 
__USE_MISC


206 
__BEGIN_NAMESPACE_C99


208 
__ex‹nsiÚ__


209 
	$¡¹Şl
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

210 **
__»¡riù
 
__’d±r
, 
__ba£
)

211 
__THROW
 
	`__nÚnuÎ
 ((1));

213 
__ex‹nsiÚ__


214 
	$¡¹ouÎ
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

215 **
__»¡riù
 
__’d±r
, 
__ba£
)

216 
__THROW
 
	`__nÚnuÎ
 ((1));

217 
__END_NAMESPACE_C99


221 #ifdeà
__USE_GNU


235 
	~<xloÿË.h
>

239 
	$¡¹Ş_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

240 **
__»¡riù
 
__’d±r
, 
__ba£
,

241 
__loÿË_t
 
__loc
è
__THROW
 
	`__nÚnuÎ
 ((1, 4));

243 
	$¡¹oul_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

244 **
__»¡riù
 
__’d±r
,

245 
__ba£
, 
__loÿË_t
 
__loc
)

246 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

248 
__ex‹nsiÚ__


249 
	$¡¹Şl_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

250 **
__»¡riù
 
__’d±r
, 
__ba£
,

251 
__loÿË_t
 
__loc
)

252 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

254 
__ex‹nsiÚ__


255 
	$¡¹ouÎ_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

256 **
__»¡riù
 
__’d±r
,

257 
__ba£
, 
__loÿË_t
 
__loc
)

258 
__THROW
 
	`__nÚnuÎ
 ((1, 4));

260 
	$¡¹od_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

261 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

262 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

264 
	$¡¹of_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

265 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

266 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

268 
	$¡¹Şd_l
 (cÚ¡ *
__»¡riù
 
__ÅŒ
,

269 **
__»¡riù
 
__’d±r
,

270 
__loÿË_t
 
__loc
)

271 
__THROW
 
	`__nÚnuÎ
 ((1, 3));

275 #ifdeà
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex‹º_šlše
 

278 
	`__NTH
 (
	$©oi
 (cÚ¡ *
__ÅŒ
))

280  (è
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

281 
	}
}

282 
__ex‹º_šlše
 

283 
__NTH
 (
	$©Ş
 (cÚ¡ *
__ÅŒ
))

285  
	`¡¹Ş
 (
__ÅŒ
, (**è
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__ex‹nsiÚ__
 
__ex‹º_šlše
 

292 
__NTH
 (
	$©Şl
 (cÚ¡ *
__ÅŒ
))

294  
	`¡¹Şl
 (
__ÅŒ
, (**è
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n
è
__THROW
 
__wur
;

308 
	$a64l
 (cÚ¡ *
__s
)

309 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1)è
__wur
;

313 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_BSD


314 
	~<sys/ty³s.h
>

321 
	$¿ndom
 (è
__THROW
;

324 
	$¤ªdom
 (
__£ed
è
__THROW
;

330 *
	$š™¡©e
 (
__£ed
, *
__¡©ebuf
,

331 
size_t
 
__¡©–’
è
__THROW
 
	`__nÚnuÎ
 ((2));

335 *
	$£t¡©e
 (*
__¡©ebuf
è
__THROW
 
	`__nÚnuÎ
 ((1));

338 #ifdeà
__USE_MISC


343 
	s¿ndom_d©a


345 
št32_t
 *
åŒ
;

346 
št32_t
 *
½Œ
;

347 
št32_t
 *
¡©e
;

348 
¿nd_ty³
;

349 
¿nd_deg
;

350 
¿nd_£p
;

351 
št32_t
 *
’d_±r
;

354 
	$¿ndom_r
 (
¿ndom_d©a
 *
__»¡riù
 
__buf
,

355 
št32_t
 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

357 
	$¤ªdom_r
 (
__£ed
, 
¿ndom_d©a
 *
__buf
)

358 
__THROW
 
	`__nÚnuÎ
 ((2));

360 
	$š™¡©e_r
 (
__£ed
, *
__»¡riù
 
__¡©ebuf
,

361 
size_t
 
__¡©–’
,

362 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

363 
__THROW
 
	`__nÚnuÎ
 ((2, 4));

365 
	$£t¡©e_r
 (*
__»¡riù
 
__¡©ebuf
,

366 
¿ndom_d©a
 *
__»¡riù
 
__buf
)

367 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$¿nd
 (è
__THROW
;

376 
	$¤ªd
 (
__£ed
è
__THROW
;

377 
__END_NAMESPACE_STD


379 #ifdeà
__USE_POSIX


381 
	$¿nd_r
 (*
__£ed
è
__THROW
;

385 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


389 
	$d¿nd48
 (è
__THROW
;

390 
	$”ªd48
 (
__xsubi
[3]è
__THROW
 
	`__nÚnuÎ
 ((1));

393 
	$Ìªd48
 (è
__THROW
;

394 
	$Äªd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nÚnuÎ
 ((1));

398 
	$m¿nd48
 (è
__THROW
;

399 
	$j¿nd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nÚnuÎ
 ((1));

403 
	$¤ªd48
 (
__£edv®
è
__THROW
;

404 *
	$£ed48
 (
__£ed16v
[3])

405 
__THROW
 
	`__nÚnuÎ
 ((1));

406 
	$lcÚg48
 (
__·¿m
[7]è
__THROW
 
	`__nÚnuÎ
 ((1));

408 #ifdeà
__USE_MISC


412 
	sd¿nd48_d©a


414 
__x
[3];

415 
__Şd_x
[3];

416 
__c
;

417 
__š™
;

418 
__ex‹nsiÚ__
 
__a
;

423 
	$d¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

424 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

425 
	$”ªd48_r
 (
__xsubi
[3],

426 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

427 *
__»¡riù
 
__»suÉ
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

430 
	$Ìªd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

431 *
__»¡riù
 
__»suÉ
)

432 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

433 
	$Äªd48_r
 (
__xsubi
[3],

434 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

435 *
__»¡riù
 
__»suÉ
)

436 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

439 
	$m¿nd48_r
 (
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

440 *
__»¡riù
 
__»suÉ
)

441 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

442 
	$j¿nd48_r
 (
__xsubi
[3],

443 
d¿nd48_d©a
 *
__»¡riù
 
__bufãr
,

444 *
__»¡riù
 
__»suÉ
)

445 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

448 
	$¤ªd48_r
 (
__£edv®
, 
d¿nd48_d©a
 *
__bufãr
)

449 
__THROW
 
	`__nÚnuÎ
 ((2));

451 
	$£ed48_r
 (
__£ed16v
[3],

452 
d¿nd48_d©a
 *
__bufãr
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

454 
	$lcÚg48_r
 (
__·¿m
[7],

455 
d¿nd48_d©a
 *
__bufãr
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

462 #iâdeà
__m®loc_ªd_ÿÎoc_defšed


463 
	#__m®loc_ªd_ÿÎoc_defšed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$m®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

468 *
	$ÿÎoc
 (
size_t
 
__nmemb
, size_ˆ
__size
)

469 
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #iâdeà
__Ãed_m®loc_ªd_ÿÎoc


474 
__BEGIN_NAMESPACE_STD


480 *
	$»®loc
 (*
__±r
, 
size_t
 
__size
)

481 
__THROW
 
__©Œibu‹_w¬n_unu£d_»suÉ__
;

483 
	$ä“
 (*
__±r
è
__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$cä“
 (*
__±r
è
__THROW
;

491 #ià
defšed
 
__USE_GNU
 || defšed 
__USE_BSD
 || defšed 
__USE_MISC


492 
	~<®loÿ.h
>

495 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

496 || 
defšed
 
__USE_BSD


498 *
	$v®loc
 (
size_t
 
__size
è
__THROW
 
__©Œibu‹_m®loc__
 
__wur
;

501 #ifdeà
__USE_XOPEN2K


503 
	$posix_mem®ign
 (**
__mem±r
, 
size_t
 
__®ignm’t
, size_ˆ
__size
)

504 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

507 #ifdeà
__USE_ISOC11


509 *
	$®igÃd_®loc
 (
size_t
 
__®ignm’t
, size_ˆ
__size
)

510 
__THROW
 
__©Œibu‹_m®loc__
 
	`__©Œibu‹_®loc_size__
 ((2)è
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abÜt
 (è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

519 
	`©ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

521 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


523 #ifdeà
__ılu¥lus


524 "C++" 
	`©_quick_ex™
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("©_quick_ex™"è
	`__nÚnuÎ
 ((1));

527 
	`©_quick_ex™
 ((*
__func
è()è
__THROW
 
	`__nÚnuÎ
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	`Ú_ex™
 ((*
__func
è(
__¡©us
, *
__¬g
), *__arg)

536 
__THROW
 
	`__nÚnuÎ
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

545 #ià
defšed
 
__USE_ISOC11
 || defšed 
__USE_ISOCXX11


549 
	$quick_ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

551 
__END_NAMESPACE_STD


553 #ifdeà
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex™
 (
__¡©us
è
__THROW
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$g‘’v
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

565 
__END_NAMESPACE_STD


567 #ifdeà
__USE_GNU


570 *
	$£cu»_g‘’v
 (cÚ¡ *
__Çme
)

571 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

574 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


578 
	$pu‹nv
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

581 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


584 
	$£‹nv
 (cÚ¡ *
__Çme
, cÚ¡ *
__v®ue
, 
__»¶aû
)

585 
__THROW
 
	`__nÚnuÎ
 ((2));

588 
	$un£‹nv
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 #ifdef 
__USE_MISC


595 
	$ş—»nv
 (è
__THROW
;

599 #ià
defšed
 
__USE_MISC
 \

600 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
)

606 *
	$mk‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1));

609 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 \

610 || 
defšed
 
__USE_XOPEN2K8


619 #iâdeà
__USE_FILE_OFFSET64


620 
	$mk¡emp
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

622 #ifdeà
__REDIRECT


623 
	`__REDIRECT
 (
mk¡emp
, (*
__‹m¶©e
), 
mk¡emp64
)

624 
	`__nÚnuÎ
 ((1)è
__wur
;

626 
	#mk¡emp
 
mk¡emp64


	)

629 #ifdeà
__USE_LARGEFILE64


630 
	$mk¡emp64
 (*
__‹m¶©e
è
	`__nÚnuÎ
 ((1)è
__wur
;

634 #ifdeà
__USE_MISC


641 #iâdeà
__USE_FILE_OFFSET64


642 
	$mk¡emps
 (*
__‹m¶©e
, 
__suffixËn
è
	`__nÚnuÎ
 ((1)è
__wur
;

644 #ifdeà
__REDIRECT


645 
	`__REDIRECT
 (
mk¡emps
, (*
__‹m¶©e
, 
__suffixËn
),

646 
mk¡emps64
è
	`__nÚnuÎ
 ((1)è
__wur
;

648 
	#mk¡emps
 
mk¡emps64


	)

651 #ifdeà
__USE_LARGEFILE64


652 
	$mk¡emps64
 (*
__‹m¶©e
, 
__suffixËn
)

653 
	`__nÚnuÎ
 ((1)è
__wur
;

657 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K8


663 *
	$mkd‹mp
 (*
__‹m¶©e
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

666 #ifdeà
__USE_GNU


673 #iâdeà
__USE_FILE_OFFSET64


674 
	$mko¡emp
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

676 #ifdeà
__REDIRECT


677 
	`__REDIRECT
 (
mko¡emp
, (*
__‹m¶©e
, 
__æags
), 
mko¡emp64
)

678 
	`__nÚnuÎ
 ((1)è
__wur
;

680 
	#mko¡emp
 
mko¡emp64


	)

683 #ifdeà
__USE_LARGEFILE64


684 
	$mko¡emp64
 (*
__‹m¶©e
, 
__æags
è
	`__nÚnuÎ
 ((1)è
__wur
;

693 #iâdeà
__USE_FILE_OFFSET64


694 
	$mko¡emps
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

695 
	`__nÚnuÎ
 ((1)è
__wur
;

697 #ifdeà
__REDIRECT


698 
	`__REDIRECT
 (
mko¡emps
, (*
__‹m¶©e
, 
__suffixËn
,

699 
__æags
), 
mko¡emps64
)

700 
	`__nÚnuÎ
 ((1)è
__wur
;

702 
	#mko¡emps
 
mko¡emps64


	)

705 #ifdeà
__USE_LARGEFILE64


706 
	$mko¡emps64
 (*
__‹m¶©e
, 
__suffixËn
, 
__æags
)

707 
	`__nÚnuÎ
 ((1)è
__wur
;

712 
__BEGIN_NAMESPACE_STD


717 
	$sy¡em
 (cÚ¡ *
__commªd
è
__wur
;

718 
__END_NAMESPACE_STD


721 #ifdef 
__USE_GNU


724 *
	$ÿnÚiÿlize_fe_Çme
 (cÚ¡ *
__Çme
)

725 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

728 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


734 *
	$»®·th
 (cÚ¡ *
__»¡riù
 
__Çme
,

735 *
__»¡riù
 
__»sŞved
è
__THROW
 
__wur
;

740 #iâdeà
__COMPAR_FN_T


741 
	#__COMPAR_FN_T


	)

742 (*
	t__com·r_â_t
) (const *, const *);

744 #ifdef 
__USE_GNU


745 
__com·r_â_t
 
	tcom·risÚ_â_t
;

748 #ifdeà
__USE_GNU


749 (*
	t__com·r_d_â_t
) (const *, const *, *);

752 
__BEGIN_NAMESPACE_STD


755 *
	$b£¬ch
 (cÚ¡ *
__key
, cÚ¡ *
__ba£
,

756 
size_t
 
__nmemb
, size_ˆ
__size
, 
__com·r_â_t
 
__com·r
)

757 
	`__nÚnuÎ
 ((1, 2, 5)è
__wur
;

759 #ifdeà
__USE_EXTERN_INLINES


760 
	~<b™s/¡dlib-b£¬ch.h
>

765 
	$qsÜt
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

766 
__com·r_â_t
 
__com·r
è
	`__nÚnuÎ
 ((1, 4));

767 #ifdeà
__USE_GNU


768 
	$qsÜt_r
 (*
__ba£
, 
size_t
 
__nmemb
, size_ˆ
__size
,

769 
__com·r_d_â_t
 
__com·r
, *
__¬g
)

770 
	`__nÚnuÎ
 ((1, 4));

775 
	$abs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

776 
	$Ïbs
 (
__x
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

777 
__END_NAMESPACE_STD


779 #ifdeà
__USE_ISOC99


780 
__ex‹nsiÚ__
 
	$Îabs
 (
__x
)

781 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

785 
__BEGIN_NAMESPACE_STD


789 
div_t
 
	$div
 (
__num”
, 
__d’om
)

790 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

791 
ldiv_t
 
	$ldiv
 (
__num”
, 
__d’om
)

792 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

793 
__END_NAMESPACE_STD


795 #ifdeà
__USE_ISOC99


796 
__BEGIN_NAMESPACE_C99


797 
__ex‹nsiÚ__
 
Îdiv_t
 
	$Îdiv
 (
__num”
,

798 
__d’om
)

799 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
)è
__wur
;

800 
__END_NAMESPACE_C99


804 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

805 || 
defšed
 
__USE_SVID


812 *
	$ecvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

813 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

818 *
	$fcvt
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

819 *
__»¡riù
 
__sign
è
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

824 *
	$gcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

825 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

828 #ifdeà
__USE_MISC


830 *
	$qecvt
 (
__v®ue
, 
__ndig™
,

831 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

832 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

833 *
	$qfcvt
 (
__v®ue
, 
__ndig™
,

834 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
)

835 
__THROW
 
	`__nÚnuÎ
 ((3, 4)è
__wur
;

836 *
	$qgcvt
 (
__v®ue
, 
__ndig™
, *
__buf
)

837 
__THROW
 
	`__nÚnuÎ
 ((3)è
__wur
;

842 
	$ecvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

843 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

844 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

845 
	$fcvt_r
 (
__v®ue
, 
__ndig™
, *
__»¡riù
 
__deıt
,

846 *
__»¡riù
 
__sign
, *__»¡riù 
__buf
,

847 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

849 
	$qecvt_r
 (
__v®ue
, 
__ndig™
,

850 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

851 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

852 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

853 
	$qfcvt_r
 (
__v®ue
, 
__ndig™
,

854 *
__»¡riù
 
__deıt
, *__»¡riù 
__sign
,

855 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

856 
__THROW
 
	`__nÚnuÎ
 ((3, 4, 5));

860 
__BEGIN_NAMESPACE_STD


863 
	$mbËn
 (cÚ¡ *
__s
, 
size_t
 
__n
è
__THROW
;

866 
	$mbtowc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

867 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

870 
	$wùomb
 (*
__s
, 
wch¬_t
 
__wch¬
è
__THROW
;

874 
size_t
 
	$mb¡owcs
 (
wch¬_t
 *
__»¡riù
 
__pwcs
,

875 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
è
__THROW
;

877 
size_t
 
	$wc¡ombs
 (*
__»¡riù
 
__s
,

878 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__pwcs
, 
size_t
 
__n
)

879 
__THROW
;

880 
__END_NAMESPACE_STD


883 #ifdeà
__USE_SVID


888 
	$½m©ch
 (cÚ¡ *
__»¥Ú£
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

892 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


899 
	$g‘subİt
 (**
__»¡riù
 
__İtiÚp
,

900 *cÚ¡ *
__»¡riù
 
__tok’s
,

901 **
__»¡riù
 
__v®u•
)

902 
__THROW
 
	`__nÚnuÎ
 ((1, 2, 3)è
__wur
;

906 #ifdeà
__USE_XOPEN


908 
	$£tkey
 (cÚ¡ *
__key
è
__THROW
 
	`__nÚnuÎ
 ((1));

914 #ifdeà
__USE_XOPEN2KXSI


916 
	$posix_İ’±
 (
__oæag
è
__wur
;

919 #ifdeà
__USE_XOPEN


924 
	$g¿Á±
 (
__fd
è
__THROW
;

928 
	$uÆock±
 (
__fd
è
__THROW
;

933 *
	$±¢ame
 (
__fd
è
__THROW
 
__wur
;

936 #ifdeà
__USE_GNU


940 
	$±¢ame_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

941 
__THROW
 
	`__nÚnuÎ
 ((2));

944 
	`g‘±
 ();

947 #ifdeà
__USE_BSD


951 
	$g‘lßdavg
 (
__lßdavg
[], 
__ÃËm
)

952 
__THROW
 
	`__nÚnuÎ
 ((1));

955 
	~<b™s/¡dlib-æßt.h
>

958 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


959 
	~<b™s/¡dlib.h
>

961 #ifdeà
__LDBL_COMPAT


962 
	~<b™s/¡dlib-ldbl.h
>

966 #undeà
__Ãed_m®loc_ªd_ÿÎoc


968 
__END_DECLS


	@/usr/include/string.h

22 #iâdef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


30 
	#__Ãed_size_t


	)

31 
	#__Ãed_NULL


	)

32 
	~<¡ddef.h
>

39 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

40 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

44 
__BEGIN_NAMESPACE_STD


46 *
	$memıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

47 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

50 *
	$memmove
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
)

51 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

52 
__END_NAMESPACE_STD


57 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN


58 *
	$memcıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

59 
__c
, 
size_t
 
__n
)

60 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

64 
__BEGIN_NAMESPACE_STD


66 *
	$mem£t
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

69 
	$memcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

70 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

73 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


76 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

77 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

78 cÚ¡ *
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

79 
__THROW
 
	`__asm
 ("memchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__OPTIMIZE__


82 
__ex‹º_®ways_šlše
 *

83 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
è
__THROW


85  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

88 
__ex‹º_®ways_šlše
 const *

89 
	`memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
è
__THROW


91  
	`__butš_memchr
 (
__s
, 
__c
, 
__n
);

94 
	}
}

96 *
	$memchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

97 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

99 
__END_NAMESPACE_STD


101 #ifdeà
__USE_GNU


104 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


105 "C++" *
	$¿wmemchr
 (*
__s
, 
__c
)

106 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

107 "C++" cÚ¡ *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

108 
__THROW
 
	`__asm
 ("¿wmemchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

110 *
	$¿wmemchr
 (cÚ¡ *
__s
, 
__c
)

111 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

115 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


116 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

117 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

118 "C++" cÚ¡ *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

119 
__THROW
 
	`__asm
 ("memrchr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

121 *
	$memrchr
 (cÚ¡ *
__s
, 
__c
, 
size_t
 
__n
)

122 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

127 
__BEGIN_NAMESPACE_STD


129 *
	$¡rıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

130 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

132 *
	$¡ºıy
 (*
__»¡riù
 
__de¡
,

133 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

134 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

137 *
	$¡rÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

138 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

140 *
	$¡ºÿt
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
,

141 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

144 
	$¡rcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

145 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

147 
	$¡ºcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

148 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

151 
	$¡rcŞl
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

152 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

154 
size_t
 
	$¡rxäm
 (*
__»¡riù
 
__de¡
,

155 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

156 
__THROW
 
	`__nÚnuÎ
 ((2));

157 
__END_NAMESPACE_STD


159 #ifdeà
__USE_XOPEN2K8


163 
	~<xloÿË.h
>

166 
	$¡rcŞl_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__l
)

167 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

169 
size_t
 
	$¡rxäm_l
 (*
__de¡
, cÚ¡ *
__¤c
, 
size_t
 
__n
,

170 
__loÿË_t
 
__l
è
__THROW
 
	`__nÚnuÎ
 ((2, 4));

173 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 \

174 || 
defšed
 
__USE_XOPEN2K8


176 *
	$¡rdup
 (cÚ¡ *
__s
)

177 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

183 #ià
defšed
 
__USE_XOPEN2K8


184 *
	$¡ºdup
 (cÚ¡ *
__¡ršg
, 
size_t
 
__n
)

185 
__THROW
 
__©Œibu‹_m®loc__
 
	`__nÚnuÎ
 ((1));

188 #ià
defšed
 
__USE_GNU
 && defšed 
__GNUC__


190 
	#¡rdu·
(
s
) \

191 (
__ex‹nsiÚ__
 \

193 cÚ¡ *
__Şd
 = (
s
); \

194 
size_t
 
__Ën
 = 
	`¡¾’
 (
__Şd
) + 1; \

195 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
); \

196 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

197 
	}
}))

	)

200 
	#¡ºdu·
(
s
, 
n
) \

201 (
__ex‹nsiÚ__
 \

203 cÚ¡ *
__Şd
 = (
s
); \

204 
size_t
 
__Ën
 = 
	`¡ºËn
 (
__Şd
, (
n
)); \

205 *
__Ãw
 = (*è
	`__butš_®loÿ
 (
__Ën
 + 1); \

206 
__Ãw
[
__Ën
] = '\0'; \

207 (*è
	`memıy
 (
__Ãw
, 
__Şd
, 
__Ën
); \

208 }))

	)

211 
	g__BEGIN_NAMESPACE_STD


213 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


216 *
¡rchr
 (*
__s
, 
__c
)

217 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

218 cÚ¡ *
¡rchr
 (cÚ¡ *
__s
, 
__c
)

219 
__THROW
 
__asm
 ("¡rchr"è
__©Œibu‹_pu»__
 
__nÚnuÎ
 ((1));

221 #ifdeà
__OPTIMIZE__


222 
__ex‹º_®ways_šlše
 *

223 
¡rchr
 (*
__s
, 
__c
è
	g__THROW


225  
__butš_¡rchr
 (
__s
, 
__c
);

228 
__ex‹º_®ways_šlše
 const *

229 
¡rchr
 (cÚ¡ *
__s
, 
__c
è
	g__THROW


231  
__butš_¡rchr
 (
__s
, 
__c
);

236 *
	$¡rchr
 (cÚ¡ *
__s
, 
__c
)

237 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

240 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


243 *
	`¡¼chr
 (*
__s
, 
__c
)

244 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

245 cÚ¡ *
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
)

246 
__THROW
 
	`__asm
 ("¡¼chr"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

248 #ifdeà
__OPTIMIZE__


249 
__ex‹º_®ways_šlše
 *

250 
	`¡¼chr
 (*
__s
, 
__c
è
__THROW


252  
	`__butš_¡¼chr
 (
__s
, 
__c
);

255 
__ex‹º_®ways_šlše
 const *

256 
	`¡¼chr
 (cÚ¡ *
__s
, 
__c
è
__THROW


258  
	`__butš_¡¼chr
 (
__s
, 
__c
);

261 
	}
}

263 *
	$¡¼chr
 (cÚ¡ *
__s
, 
__c
)

264 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

266 
__END_NAMESPACE_STD


268 #ifdeà
__USE_GNU


271 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


272 "C++" *
	$¡rchºul
 (*
__s
, 
__c
)

273 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

274 "C++" cÚ¡ *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

275 
__THROW
 
	`__asm
 ("¡rchºul"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

277 *
	$¡rchºul
 (cÚ¡ *
__s
, 
__c
)

278 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

282 
__BEGIN_NAMESPACE_STD


285 
size_t
 
	$¡rc¥n
 (cÚ¡ *
__s
, cÚ¡ *
__»jeù
)

286 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

289 
size_t
 
	$¡r¥n
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

290 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

292 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


295 *
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
)

296 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

297 cÚ¡ *
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

298 
__THROW
 
	`__asm
 ("¡½brk"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

300 #ifdeà
__OPTIMIZE__


301 
__ex‹º_®ways_šlše
 *

302 
	`¡½brk
 (*
__s
, cÚ¡ *
__acû±
è
__THROW


304  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

307 
__ex‹º_®ways_šlše
 const *

308 
	`¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
è
__THROW


310  
	`__butš_¡½brk
 (
__s
, 
__acû±
);

313 
	}
}

315 *
	$¡½brk
 (cÚ¡ *
__s
, cÚ¡ *
__acû±
)

316 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

319 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


322 *
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

323 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

324 cÚ¡ *
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

325 
__THROW
 
	`__asm
 ("¡r¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

327 #ifdeà
__OPTIMIZE__


328 
__ex‹º_®ways_šlše
 *

329 
	`¡r¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


331  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

334 
__ex‹º_®ways_šlše
 const *

335 
	`¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
è
__THROW


337  
	`__butš_¡r¡r
 (
__hay¡ack
, 
__ÃedË
);

340 
	}
}

342 *
	$¡r¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

343 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

348 *
	$¡¹ok
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
)

349 
__THROW
 
	`__nÚnuÎ
 ((2));

350 
__END_NAMESPACE_STD


354 *
	$__¡¹ok_r
 (*
__»¡riù
 
__s
,

355 cÚ¡ *
__»¡riù
 
__d–im
,

356 **
__»¡riù
 
__§ve_±r
)

357 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

358 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


359 *
	$¡¹ok_r
 (*
__»¡riù
 
__s
, cÚ¡ *__»¡riù 
__d–im
,

360 **
__»¡riù
 
__§ve_±r
)

361 
__THROW
 
	`__nÚnuÎ
 ((2, 3));

364 #ifdeà
__USE_GNU


366 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


367 "C++" *
	$¡rÿ£¡r
 (*
__hay¡ack
, cÚ¡ *
__ÃedË
)

368 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

369 "C++" cÚ¡ *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
,

370 cÚ¡ *
__ÃedË
)

371 
__THROW
 
	`__asm
 ("¡rÿ£¡r"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

373 *
	$¡rÿ£¡r
 (cÚ¡ *
__hay¡ack
, cÚ¡ *
__ÃedË
)

374 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

378 #ifdeà
__USE_GNU


382 *
	$memmem
 (cÚ¡ *
__hay¡ack
, 
size_t
 
__hay¡ackËn
,

383 cÚ¡ *
__ÃedË
, 
size_t
 
__ÃedËËn
)

384 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 3));

388 *
	$__mempıy
 (*
__»¡riù
 
__de¡
,

389 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

390 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

391 *
	$mempıy
 (*
__»¡riù
 
__de¡
,

392 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

393 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

397 
__BEGIN_NAMESPACE_STD


399 
size_t
 
	$¡¾’
 (cÚ¡ *
__s
)

400 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

401 
__END_NAMESPACE_STD


403 #ifdef 
__USE_XOPEN2K8


406 
size_t
 
	$¡ºËn
 (cÚ¡ *
__¡ršg
, 
size_t
 
__maxËn
)

407 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

411 
__BEGIN_NAMESPACE_STD


413 *
	$¡»¼Ü
 (
__”ºum
è
__THROW
;

414 
__END_NAMESPACE_STD


415 #ià
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_MISC


423 #ià
defšed
 
__USE_XOPEN2K
 && !defšed 
__USE_GNU


426 #ifdeà
__REDIRECT_NTH


427 
	`__REDIRECT_NTH
 (
¡»¼Ü_r
,

428 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
),

429 
__xpg_¡»¼Ü_r
è
	`__nÚnuÎ
 ((2));

431 
	$__xpg_¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

432 
__THROW
 
	`__nÚnuÎ
 ((2));

433 
	#¡»¼Ü_r
 
__xpg_¡»¼Ü_r


	)

438 *
	$¡»¼Ü_r
 (
__”ºum
, *
__buf
, 
size_t
 
__buæ’
)

439 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

443 #ifdeà
__USE_XOPEN2K8


445 *
	$¡»¼Ü_l
 (
__”ºum
, 
__loÿË_t
 
__l
è
__THROW
;

451 
	$__bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

453 #ifdeà
__USE_BSD


455 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
)

456 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

459 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

462 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

463 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

466 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


469 *
	`šdex
 (*
__s
, 
__c
)

470 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

471 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

472 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

474 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


475 
__ex‹º_®ways_šlše
 *

476 
	`šdex
 (*
__s
, 
__c
è
__THROW


478  
	`__butš_šdex
 (
__s
, 
__c
);

481 
__ex‹º_®ways_šlše
 const *

482 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


484  
	`__butš_šdex
 (
__s
, 
__c
);

487 
	}
}

489 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

490 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

494 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


497 *
	`ršdex
 (*
__s
, 
__c
)

498 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

499 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

500 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

502 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


503 
__ex‹º_®ways_šlše
 *

504 
	`ršdex
 (*
__s
, 
__c
è
__THROW


506  
	`__butš_ršdex
 (
__s
, 
__c
);

509 
__ex‹º_®ways_šlše
 const *

510 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


512  
	`__butš_ršdex
 (
__s
, 
__c
);

515 
	}
}

517 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

518 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

523 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

527 #ifdef 
__USE_GNU


528 
	$ff¦
 (
__l
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

529 
__ex‹nsiÚ__
 
	$ff¦l
 (
__Î
)

530 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

534 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

535 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

538 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

539 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

542 #ifdef 
__USE_GNU


545 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

546 
__loÿË_t
 
__loc
)

547 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

549 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

550 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

551 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

554 #ifdef 
__USE_BSD


557 *
	$¡r£p
 (**
__»¡riù
 
__¡ršgp
,

558 cÚ¡ *
__»¡riù
 
__d–im
)

559 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

562 #ifdef 
__USE_XOPEN2K8


564 *
	$¡rsigÇl
 (
__sig
è
__THROW
;

567 *
	$__¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

568 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

569 *
	$¡pıy
 (*
__»¡riù
 
__de¡
, cÚ¡ *__»¡riù 
__¤c
)

570 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

574 *
	$__¡²ıy
 (*
__»¡riù
 
__de¡
,

575 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

576 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

577 *
	$¡²ıy
 (*
__»¡riù
 
__de¡
,

578 cÚ¡ *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

582 #ifdef 
__USE_GNU


584 
	$¡rv”scmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

585 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2));

588 *
	$¡räy
 (*
__¡ršg
è
__THROW
 
	`__nÚnuÎ
 ((1));

591 *
	$memäob
 (*
__s
, 
size_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1));

593 #iâdeà
ba£Çme


598 #ifdeà
__CORRECT_ISO_CPP_STRING_H_PROTO


599 "C++" *
	$ba£Çme
 (*
__f’ame
)

600 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

601 "C++" cÚ¡ *
	$ba£Çme
 (cÚ¡ *
__f’ame
)

602 
__THROW
 
	`__asm
 ("ba£Çme"è
	`__nÚnuÎ
 ((1));

604 *
	$ba£Çme
 (cÚ¡ *
__f’ame
è
__THROW
 
	`__nÚnuÎ
 ((1));

610 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

611 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__OPTIMIZE_SIZE__
 \

612 && !
defšed
 
__NO_INLINE__
 && !defšed 
__ılu¥lus


632 
	~<b™s/¡ršg.h
>

635 
	~<b™s/¡ršg2.h
>

638 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


640 
	~<b™s/¡ršg3.h
>

644 
__END_DECLS


	@/usr/include/strings.h

18 #iâdef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #ià!
defšed
 
_STRING_H
 || !defšed 
__USE_BSD


26 
	~<ã©u»s.h
>

27 
	#__Ãed_size_t


	)

28 
	~<¡ddef.h
>

35 #ià
defšed
 
__ılu¥lus
 && (__ılu¥lu >ğ199711L || 
__GNUC_PREREQ
 (4, 4))

36 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

39 
	g__BEGIN_DECLS


41 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8


43 
	$bcmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

44 
__THROW
 
__©Œibu‹_pu»__
;

47 
	$bcİy
 (cÚ¡ *
__¤c
, *
__de¡
, 
size_t
 
__n
è
__THROW
;

50 
	$bz”o
 (*
__s
, 
size_t
 
__n
è
__THROW
;

53 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


56 *
	`šdex
 (*
__s
, 
__c
)

57 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

58 cÚ¡ *
	`šdex
 (cÚ¡ *
__s
, 
__c
)

59 
__THROW
 
	`__asm
 ("šdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

61 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


62 
__ex‹º_®ways_šlše
 *

63 
	`šdex
 (*
__s
, 
__c
è
__THROW


65  
	`__butš_šdex
 (
__s
, 
__c
);

68 
__ex‹º_®ways_šlše
 const *

69 
	`šdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


71  
	`__butš_šdex
 (
__s
, 
__c
);

74 
	}
}

76 *
	$šdex
 (cÚ¡ *
__s
, 
__c
)

77 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

81 #ifdeà
__CORRECT_ISO_CPP_STRINGS_H_PROTO


84 *
	`ršdex
 (*
__s
, 
__c
)

85 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

86 cÚ¡ *
	`ršdex
 (cÚ¡ *
__s
, 
__c
)

87 
__THROW
 
	`__asm
 ("ršdex"è
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

89 #ià
defšed
 
__OPTIMIZE__
 && !defšed 
__CORRECT_ISO_CPP_STRING_H_PROTO


90 
__ex‹º_®ways_šlše
 *

91 
	`ršdex
 (*
__s
, 
__c
è
__THROW


93  
	`__butš_ršdex
 (
__s
, 
__c
);

96 
__ex‹º_®ways_šlše
 const *

97 
	`ršdex
 (cÚ¡ *
__s
, 
__c
è
__THROW


99  
	`__butš_ršdex
 (
__s
, 
__c
);

102 
	}
}

104 *
	$ršdex
 (cÚ¡ *
__s
, 
__c
)

105 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1));

109 #ià
defšed
 
__USE_MISC
 || !defšed 
__USE_XOPEN2K8
 || defšed 
__USE_XOPEN2K8XSI


112 
	$ffs
 (
__i
è
__THROW
 
	`__©Œibu‹__
 ((const));

116 
	$¡rÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
)

117 
__THROW
 
__©Œibu‹_pu»__
;

120 
	$¡ºÿ£cmp
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
size_t
 
__n
)

121 
__THROW
 
__©Œibu‹_pu»__
;

123 #ifdef 
__USE_XOPEN2K8


127 
	~<xloÿË.h
>

131 
	$¡rÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
, 
__loÿË_t
 
__loc
)

132 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 3));

134 
	$¡ºÿ£cmp_l
 (cÚ¡ *
__s1
, cÚ¡ *
__s2
,

135 
size_t
 
__n
, 
__loÿË_t
 
__loc
)

136 
__THROW
 
__©Œibu‹_pu»__
 
	`__nÚnuÎ
 ((1, 2, 4));

139 
__END_DECLS


	@/usr/include/syslog.h

1 
	~<sys/sy¦og.h
>

	@/usr/include/termios.h

22 #iâdef 
_TERMIOS_H


23 
	#_TERMIOS_H
 1

	)

25 
	~<ã©u»s.h
>

26 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


28 
	~<b™s/ty³s.h
>

29 #iâdeà
__pid_t_defšed


30 
__pid_t
 
	tpid_t
;

31 
	#__pid_t_defšed


	)

35 
	g__BEGIN_DECLS


39 
	~<b™s/‹rmios.h
>

41 #ifdeà
__USE_BSD


44 
	#CCEQ
(
v®
, 
c
è((cè=ğ(v®è&& (v®è!ğ
_POSIX_VDISABLE
)

	)

48 
¥“d_t
 
	$cfg‘o¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

51 
¥“d_t
 
	$cfg‘i¥“d
 (cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

54 
	$cf£to¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

57 
	$cf£ti¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

59 #ifdef 
__USE_BSD


61 
	$cf£t¥“d
 (
‹rmios
 *
__‹rmios_p
, 
¥“d_t
 
__¥“d
è
__THROW
;

66 
	$tcg‘©Œ
 (
__fd
, 
‹rmios
 *
__‹rmios_p
è
__THROW
;

70 
	$tc£‰r
 (
__fd
, 
__İtiÚ®_aùiÚs
,

71 cÚ¡ 
‹rmios
 *
__‹rmios_p
è
__THROW
;

74 #ifdef 
__USE_BSD


76 
	$cfmak”aw
 (
‹rmios
 *
__‹rmios_p
è
__THROW
;

80 
	$tc£ndb»ak
 (
__fd
, 
__du¿tiÚ
è
__THROW
;

86 
	`tcd¿š
 (
__fd
);

90 
	$tcæush
 (
__fd
, 
__queue_£ËùÜ
è
__THROW
;

94 
	$tcæow
 (
__fd
, 
__aùiÚ
è
__THROW
;

97 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


99 
__pid_t
 
	$tcg‘sid
 (
__fd
è
__THROW
;

103 #ifdeà
__USE_BSD


104 
	~<sys/‰ydeçuÉs.h
>

107 
__END_DECLS


	@/usr/include/time.h

22 #iâdef 
_TIME_H


24 #ià(! 
defšed
 
__Ãed_time_t
 && !defšed 
__Ãed_şock_t
 && \

25 ! 
defšed
 
	g__Ãed_time¥ec
)

26 
	#_TIME_H
 1

	)

27 
	~<ã©u»s.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__Ãed_size_t


	)

36 
	#__Ãed_NULL


	)

37 
	~<¡ddef.h
>

41 
	~<b™s/time.h
>

44 #ià!
defšed
 
__STRICT_ANSI__
 && !defšed 
__USE_XOPEN2K


45 #iâdeà
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #ià!
defšed
 
__şock_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_şock_t
)

53 
	#__şock_t_defšed
 1

	)

55 
	~<b™s/ty³s.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__şock_t
 
	tşock_t
;

60 
	g__END_NAMESPACE_STD


61 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


62 
	$__USING_NAMESPACE_STD
(
şock_t
)

66 #undeà
__Ãed_şock_t


68 #ià!
defšed
 
__time_t_defšed
 && (defšed 
_TIME_H
 || defšed 
__Ãed_time_t
)

69 
	#__time_t_defšed
 1

	)

71 
	~<b™s/ty³s.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC
 || defšed 
__USE_SVID


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #undeà
__Ãed_time_t


84 #ià!
defšed
 
__şockid_t_defšed
 && \

85 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_şockid_t
)

86 
	#__şockid_t_defšed
 1

	)

88 
	~<b™s/ty³s.h
>

91 
__şockid_t
 
	tşockid_t
;

94 #undeà
__şockid_time_t


96 #ià!
defšed
 
__tim”_t_defšed
 && \

97 ((
defšed
 
_TIME_H
 && defšed 
__USE_POSIX199309
è|| defšed 
__Ãed_tim”_t
)

98 
	#__tim”_t_defšed
 1

	)

100 
	~<b™s/ty³s.h
>

103 
__tim”_t
 
	ttim”_t
;

106 #undeà
__Ãed_tim”_t


109 #ià(!
defšed
 
__time¥ec_defšed
 \

110 && ((
defšed
 
_TIME_H
 \

111 && (
defšed
 
__USE_POSIX199309
 || defšed 
__USE_MISC
 \

112 || 
defšed
 
__USE_ISOC11
)) \

113 || 
defšed
 
__Ãed_time¥ec
))

114 
	#__time¥ec_defšed
 1

	)

116 
	~<b™s/ty³s.h
>

120 
	stime¥ec


122 
__time_t
 
tv_£c
;

123 
__sysÿÎ_¦Úg_t
 
tv_n£c
;

127 #undeà
__Ãed_time¥ec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_£c
;

136 
tm_mš
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_mÚ
;

140 
tm_y—r
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd¡
;

145 #ifdef 
__USE_BSD


146 
tm_gmtoff
;

147 cÚ¡ *
tm_zÚe
;

149 
__tm_gmtoff
;

150 cÚ¡ *
__tm_zÚe
;

153 
__END_NAMESPACE_STD


154 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_POSIX
 || defšed 
__USE_MISC


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifdeà
__USE_POSIX199309


161 
	s™im”¥ec


163 
time¥ec
 
™_š‹rv®
;

164 
time¥ec
 
™_v®ue
;

168 
sigev’t
;

172 #ifdeà
__USE_XOPEN2K


173 #iâdeà
__pid_t_defšed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defšed


	)

180 #ifdeà
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
şock_t
 
	$şock
 (è
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim”
è
__THROW
;

195 
	$difáime
 (
time_t
 
__time1
,ime_ˆ
__time0
)

196 
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

199 
time_t
 
	$mktime
 (
tm
 *
__
è
__THROW
;

205 
size_t
 
	$¡ráime
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

206 cÚ¡ *
__»¡riù
 
__fÜm©
,

207 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

208 
__END_NAMESPACE_STD


210 #ifdeà
__USE_XOPEN


213 *
	$¡½time
 (cÚ¡ *
__»¡riù
 
__s
,

214 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifdeà
__USE_XOPEN2K8


221 
	~<xloÿË.h
>

223 
size_t
 
	$¡ráime_l
 (*
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

224 cÚ¡ *
__»¡riù
 
__fÜm©
,

225 cÚ¡ 
tm
 *
__»¡riù
 
__
,

226 
__loÿË_t
 
__loc
è
__THROW
;

229 #ifdeà
__USE_GNU


230 *
	$¡½time_l
 (cÚ¡ *
__»¡riù
 
__s
,

231 cÚ¡ *
__»¡riù
 
__fmt
, 
tm
 *
__
,

232 
__loÿË_t
 
__loc
è
__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

243 
tm
 *
	$loÿÉime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

244 
__END_NAMESPACE_STD


246 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


249 
tm
 *
	$gmtime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

250 
tm
 *
__»¡riù
 
__
è
__THROW
;

254 
tm
 *
	$loÿÉime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

255 
tm
 *
__»¡riù
 
__
è
__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asùime
 (cÚ¡ 
tm
 *
__
è
__THROW
;

264 *
	$ùime
 (cÚ¡ 
time_t
 *
__tim”
è
__THROW
;

265 
__END_NAMESPACE_STD


267 #ià
defšed
 
__USE_POSIX
 || defšed 
__USE_MISC


272 *
	$asùime_r
 (cÚ¡ 
tm
 *
__»¡riù
 
__
,

273 *
__»¡riù
 
__buf
è
__THROW
;

276 *
	$ùime_r
 (cÚ¡ 
time_t
 *
__»¡riù
 
__tim”
,

277 *
__»¡riù
 
__buf
è
__THROW
;

282 *
__tzÇme
[2];

283 
__daylight
;

284 
__timezÚe
;

287 #ifdef 
__USE_POSIX


289 *
tzÇme
[2];

293 
	$tz£t
 (è
__THROW
;

296 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_XOPEN


297 
daylight
;

298 
timezÚe
;

301 #ifdeà
__USE_SVID


304 
	$¡ime
 (cÚ¡ 
time_t
 *
__wh’
è
__THROW
;

310 
	#__i¦—p
(
y—r
) \

311 ((
y—r
è% 4 =ğ0 && ((y—rè% 100 !ğ0 || (y—rè% 400 =ğ0))

	)

314 #ifdeà
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__
è
__THROW
;

322 
time_t
 
	$tim–oÿl
 (
tm
 *
__
è
__THROW
;

325 
	$dysize
 (
__y—r
è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

329 #ifdeà
__USE_POSIX199309


334 
	`Çno¦“p
 (cÚ¡ 
time¥ec
 *
__»que¡ed_time
,

335 
time¥ec
 *
__»maššg
);

339 
	$şock_g‘»s
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__»s
è
__THROW
;

342 
	$şock_g‘time
 (
şockid_t
 
__şock_id
, 
time¥ec
 *
__
è
__THROW
;

345 
	$şock_£‰ime
 (
şockid_t
 
__şock_id
, cÚ¡ 
time¥ec
 *
__
)

346 
__THROW
;

348 #ifdeà
__USE_XOPEN2K


353 
	`şock_Çno¦“p
 (
şockid_t
 
__şock_id
, 
__æags
,

354 cÚ¡ 
time¥ec
 *
__»q
,

355 
time¥ec
 *
__»m
);

358 
	$şock_g‘ıuşockid
 (
pid_t
 
__pid
, 
şockid_t
 *
__şock_id
è
__THROW
;

363 
	$tim”_ü—‹
 (
şockid_t
 
__şock_id
,

364 
sigev’t
 *
__»¡riù
 
__evp
,

365 
tim”_t
 *
__»¡riù
 
__tim”id
è
__THROW
;

368 
	$tim”_d–‘e
 (
tim”_t
 
__tim”id
è
__THROW
;

371 
	$tim”_£‰ime
 (
tim”_t
 
__tim”id
, 
__æags
,

372 cÚ¡ 
™im”¥ec
 *
__»¡riù
 
__v®ue
,

373 
™im”¥ec
 *
__»¡riù
 
__ov®ue
è
__THROW
;

376 
	$tim”_g‘time
 (
tim”_t
 
__tim”id
, 
™im”¥ec
 *
__v®ue
)

377 
__THROW
;

380 
	$tim”_g‘ov”run
 (
tim”_t
 
__tim”id
è
__THROW
;

384 #ifdeà
__USE_ISOC11


386 
	$time¥ec_g‘
 (
time¥ec
 *
__ts
, 
__ba£
)

387 
__THROW
 
	`__nÚnuÎ
 ((1));

391 #ifdeà
__USE_XOPEN_EXTENDED


403 
g‘d©e_”r
;

412 
tm
 *
	`g‘d©e
 (cÚ¡ *
__¡ršg
);

415 #ifdeà
__USE_GNU


426 
	`g‘d©e_r
 (cÚ¡ *
__»¡riù
 
__¡ršg
,

427 
tm
 *
__»¡riù
 
__»sbuå
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #iâdef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<ã©u»s.h
>

27 
	g__BEGIN_DECLS


32 #ifdeà
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #–ià
defšed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #–ià
defšed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #–ià
defšed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifdeà
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #–ià
defšed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #–ià
defšed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

71 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

75 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

79 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

83 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

86 #ifdeà
__USE_XOPEN2K8


87 
	#_XOPEN_VERSION
 700

	)

88 #–ià
defšed
 
__USE_XOPEN2K


89 
	#_XOPEN_VERSION
 600

	)

90 #–ià
defšed
 
__USE_UNIX98


91 
	#_XOPEN_VERSION
 500

	)

93 
	#_XOPEN_VERSION
 4

	)

97 
	#_XOPEN_XCU_VERSION
 4

	)

100 
	#_XOPEN_XPG2
 1

	)

101 
	#_XOPEN_XPG3
 1

	)

102 
	#_XOPEN_XPG4
 1

	)

105 
	#_XOPEN_UNIX
 1

	)

108 
	#_XOPEN_CRYPT
 1

	)

112 
	#_XOPEN_ENH_I18N
 1

	)

115 
	#_XOPEN_LEGACY
 1

	)

202 
	~<b™s/posix_İt.h
>

205 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


206 
	~<b™s/’vœÚm’ts.h
>

210 
	#STDIN_FILENO
 0

	)

211 
	#STDOUT_FILENO
 1

	)

212 
	#STDERR_FILENO
 2

	)

217 
	~<b™s/ty³s.h
>

219 #iâdef 
__ssize_t_defšed


220 
__ssize_t
 
	tssize_t
;

221 
	#__ssize_t_defšed


	)

224 
	#__Ãed_size_t


	)

225 
	#__Ãed_NULL


	)

226 
	~<¡ddef.h
>

228 #ià
defšed
 
__USE_XOPEN
 || defšed 
__USE_XOPEN2K


231 #iâdeà
__gid_t_defšed


232 
__gid_t
 
	tgid_t
;

233 
	#__gid_t_defšed


	)

236 #iâdeà
__uid_t_defšed


237 
__uid_t
 
	tuid_t
;

238 
	#__uid_t_defšed


	)

241 #iâdeà
__off_t_defšed


242 #iâdeà
__USE_FILE_OFFSET64


243 
__off_t
 
	toff_t
;

245 
__off64_t
 
	toff_t
;

247 
	#__off_t_defšed


	)

249 #ià
defšed
 
__USE_LARGEFILE64
 && !defšed 
__off64_t_defšed


250 
__off64_t
 
	toff64_t
;

251 
	#__off64_t_defšed


	)

254 #iâdeà
__u£cÚds_t_defšed


255 
__u£cÚds_t
 
	tu£cÚds_t
;

256 
	#__u£cÚds_t_defšed


	)

259 #iâdeà
__pid_t_defšed


260 
__pid_t
 
	tpid_t
;

261 
	#__pid_t_defšed


	)

265 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


266 #iâdeà
__šŒ_t_defšed


267 
__šŒ_t
 
	tšŒ_t
;

268 
	#__šŒ_t_defšed


	)

272 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN


273 #iâdeà
__sockËn_t_defšed


274 
__sockËn_t
 
	tsockËn_t
;

275 
	#__sockËn_t_defšed


	)

281 
	#R_OK
 4

	)

282 
	#W_OK
 2

	)

283 
	#X_OK
 1

	)

284 
	#F_OK
 0

	)

287 
	$acûss
 (cÚ¡ *
__Çme
, 
__ty³
è
__THROW
 
	`__nÚnuÎ
 ((1));

289 #ifdeà
__USE_GNU


292 
	$euidacûss
 (cÚ¡ *
__Çme
, 
__ty³
)

293 
__THROW
 
	`__nÚnuÎ
 ((1));

296 
	$—cûss
 (cÚ¡ *
__Çme
, 
__ty³
)

297 
__THROW
 
	`__nÚnuÎ
 ((1));

300 #ifdeà
__USE_ATFILE


304 
	$çcûs§t
 (
__fd
, cÚ¡ *
__fe
, 
__ty³
, 
__æag
)

305 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

310 #iâdef 
_STDIO_H


311 
	#SEEK_SET
 0

	)

312 
	#SEEK_CUR
 1

	)

313 
	#SEEK_END
 2

	)

314 #ifdeà
__USE_GNU


315 
	#SEEK_DATA
 3

	)

316 
	#SEEK_HOLE
 4

	)

320 #ià
defšed
 
__USE_BSD
 && !defšed 
L_SET


322 
	#L_SET
 
SEEK_SET


	)

323 
	#L_INCR
 
SEEK_CUR


	)

324 
	#L_XTND
 
SEEK_END


	)

333 #iâdeà
__USE_FILE_OFFSET64


334 
__off_t
 
	$l£ek
 (
__fd
, 
__off_t
 
__off£t
, 
__wh’û
è
__THROW
;

336 #ifdeà
__REDIRECT_NTH


337 
__off64_t
 
	`__REDIRECT_NTH
 (
l£ek
,

338 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
),

339 
l£ek64
);

341 
	#l£ek
 
l£ek64


	)

344 #ifdeà
__USE_LARGEFILE64


345 
__off64_t
 
	$l£ek64
 (
__fd
, 
__off64_t
 
__off£t
, 
__wh’û
)

346 
__THROW
;

353 
	`şo£
 (
__fd
);

360 
ssize_t
 
	$»ad
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
è
__wur
;

366 
ssize_t
 
	$wr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
è
__wur
;

368 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K8


369 #iâdeà
__USE_FILE_OFFSET64


376 
ssize_t
 
	$´—d
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

377 
__off_t
 
__off£t
è
__wur
;

384 
ssize_t
 
	$pwr™e
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

385 
__off_t
 
__off£t
è
__wur
;

387 #ifdeà
__REDIRECT


388 
ssize_t
 
	`__REDIRECT
 (
´—d
, (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

389 
__off64_t
 
__off£t
),

390 
´—d64
è
__wur
;

391 
ssize_t
 
	`__REDIRECT
 (
pwr™e
, (
__fd
, cÚ¡ *
__buf
,

392 
size_t
 
__nby‹s
, 
__off64_t
 
__off£t
),

393 
pwr™e64
è
__wur
;

395 
	#´—d
 
´—d64


	)

396 
	#pwr™e
 
pwr™e64


	)

400 #ifdeà
__USE_LARGEFILE64


404 
ssize_t
 
	$´—d64
 (
__fd
, *
__buf
, 
size_t
 
__nby‹s
,

405 
__off64_t
 
__off£t
è
__wur
;

408 
ssize_t
 
	$pwr™e64
 (
__fd
, cÚ¡ *
__buf
, 
size_t
 
__n
,

409 
__off64_t
 
__off£t
è
__wur
;

417 
	$pe
 (
__pedes
[2]è
__THROW
 
__wur
;

419 #ifdeà
__USE_GNU


422 
	$pe2
 (
__pedes
[2], 
__æags
è
__THROW
 
__wur
;

432 
	$®¬m
 (
__£cÚds
è
__THROW
;

444 
	`¦“p
 (
__£cÚds
);

446 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

447 || 
defšed
 
__USE_BSD


452 
__u£cÚds_t
 
	$u®¬m
 (
__u£cÚds_t
 
__v®ue
, __u£cÚds_ˆ
__š‹rv®
)

453 
__THROW
;

460 
	`u¦“p
 (
__u£cÚds_t
 
__u£cÚds
);

469 
	`·u£
 ();

473 
	$chown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

474 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

476 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


478 
	$fchown
 (
__fd
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
è
__THROW
 
__wur
;

483 
	$lchown
 (cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
, 
__gid_t
 
__group
)

484 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

488 #ifdeà
__USE_ATFILE


491 
	$fchowÇt
 (
__fd
, cÚ¡ *
__fe
, 
__uid_t
 
__owÃr
,

492 
__gid_t
 
__group
, 
__æag
)

493 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

497 
	$chdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

499 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


501 
	$fchdœ
 (
__fd
è
__THROW
 
__wur
;

511 *
	$g‘cwd
 (*
__buf
, 
size_t
 
__size
è
__THROW
 
__wur
;

513 #ifdef 
__USE_GNU


517 *
	$g‘_cu¼’t_dœ_Çme
 (è
__THROW
;

520 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

521 || 
defšed
 
__USE_BSD


525 *
	$g‘wd
 (*
__buf
)

526 
__THROW
 
	`__nÚnuÎ
 ((1)è
__©Œibu‹_d•»ÿ‹d__
 
__wur
;

531 
	$dup
 (
__fd
è
__THROW
 
__wur
;

534 
	$dup2
 (
__fd
, 
__fd2
è
__THROW
;

536 #ifdeà
__USE_GNU


539 
	$dup3
 (
__fd
, 
__fd2
, 
__æags
è
__THROW
;

543 **
__’vœÚ
;

544 #ifdeà
__USE_GNU


545 **
’vœÚ
;

551 
	$execve
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[],

552 *cÚ¡ 
__’vp
[]è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

554 #ifdeà
__USE_XOPEN2K8


557 
	$ãxecve
 (
__fd
, *cÚ¡ 
__¬gv
[], *cÚ¡ 
__’vp
[])

558 
__THROW
 
	`__nÚnuÎ
 ((2));

563 
	$execv
 (cÚ¡ *
__·th
, *cÚ¡ 
__¬gv
[])

564 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

568 
	$exeşe
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

569 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

573 
	$exeş
 (cÚ¡ *
__·th
, cÚ¡ *
__¬g
, ...)

574 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

578 
	$execvp
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[])

579 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

584 
	$exeşp
 (cÚ¡ *
__fe
, cÚ¡ *
__¬g
, ...)

585 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

587 #ifdeà
__USE_GNU


590 
	$execv³
 (cÚ¡ *
__fe
, *cÚ¡ 
__¬gv
[],

591 *cÚ¡ 
__’vp
[])

592 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

596 #ià
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN


598 
	$niû
 (
__šc
è
__THROW
 
__wur
;

603 
	$_ex™
 (
__¡©us
è
	`__©Œibu‹__
 ((
__nÜ‘uº__
));

609 
	~<b™s/cÚâame.h
>

612 
	$·thcÚf
 (cÚ¡ *
__·th
, 
__Çme
)

613 
__THROW
 
	`__nÚnuÎ
 ((1));

616 
	$å©hcÚf
 (
__fd
, 
__Çme
è
__THROW
;

619 
	$syscÚf
 (
__Çme
è
__THROW
;

621 #ifdef 
__USE_POSIX2


623 
size_t
 
	$cÚf¡r
 (
__Çme
, *
__buf
, 
size_t
 
__Ën
è
__THROW
;

628 
__pid_t
 
	$g‘pid
 (è
__THROW
;

631 
__pid_t
 
	$g‘µid
 (è
__THROW
;

634 
__pid_t
 
	$g‘pg½
 (è
__THROW
;

637 
__pid_t
 
	$__g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

638 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


639 
__pid_t
 
	$g‘pgid
 (
__pid_t
 
__pid
è
__THROW
;

646 
	$£gid
 (
__pid_t
 
__pid
, __pid_ˆ
__pgid
è
__THROW
;

648 #ià
defšed
 
__USE_SVID
 || defšed 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


660 
	$£g½
 (è
__THROW
;

667 
__pid_t
 
	$£tsid
 (è
__THROW
;

669 #ià
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


671 
__pid_t
 
	$g‘sid
 (
__pid_t
 
__pid
è
__THROW
;

675 
__uid_t
 
	$g‘uid
 (è
__THROW
;

678 
__uid_t
 
	$g‘euid
 (è
__THROW
;

681 
__gid_t
 
	$g‘gid
 (è
__THROW
;

684 
__gid_t
 
	$g‘egid
 (è
__THROW
;

689 
	$g‘groups
 (
__size
, 
__gid_t
 
__li¡
[]è
__THROW
 
__wur
;

691 #ifdef 
__USE_GNU


693 
	$group_memb”
 (
__gid_t
 
__gid
è
__THROW
;

700 
	$£tuid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

702 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


705 
	$£Œeuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
è
__THROW
 
__wur
;

708 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


710 
	$£‹uid
 (
__uid_t
 
__uid
è
__THROW
 
__wur
;

717 
	$£tgid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

719 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


722 
	$£Œegid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
è
__THROW
 
__wur
;

725 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN2K


727 
	$£‹gid
 (
__gid_t
 
__gid
è
__THROW
 
__wur
;

730 #ifdeà
__USE_GNU


733 
	$g‘»suid
 (
__uid_t
 *
__ruid
, __uid_ˆ*
__euid
, __uid_ˆ*
__suid
)

734 
__THROW
;

738 
	$g‘»sgid
 (
__gid_t
 *
__rgid
, __gid_ˆ*
__egid
, __gid_ˆ*
__sgid
)

739 
__THROW
;

743 
	$£Œesuid
 (
__uid_t
 
__ruid
, __uid_ˆ
__euid
, __uid_ˆ
__suid
)

744 
__THROW
 
__wur
;

748 
	$£Œesgid
 (
__gid_t
 
__rgid
, __gid_ˆ
__egid
, __gid_ˆ
__sgid
)

749 
__THROW
 
__wur
;

756 
__pid_t
 
	$fÜk
 (è
__THROWNL
;

758 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K8
) \

759 || 
defšed
 
__USE_BSD


764 
__pid_t
 
	$vfÜk
 (è
__THROW
;

770 *
	$‰yÇme
 (
__fd
è
__THROW
;

774 
	$‰yÇme_r
 (
__fd
, *
__buf
, 
size_t
 
__buæ’
)

775 
__THROW
 
	`__nÚnuÎ
 ((2)è
__wur
;

779 
	$i§‰y
 (
__fd
è
__THROW
;

781 #ià
defšed
 
__USE_BSD
 \

782 || (
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_UNIX98
)

785 
	$‰y¦Ù
 (è
__THROW
;

790 
	$lšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

791 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

793 #ifdeà
__USE_ATFILE


796 
	$lšk©
 (
__äomfd
, cÚ¡ *
__äom
, 
__tofd
,

797 cÚ¡ *
__to
, 
__æags
)

798 
__THROW
 
	`__nÚnuÎ
 ((2, 4)è
__wur
;

801 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


803 
	$symlšk
 (cÚ¡ *
__äom
, cÚ¡ *
__to
)

804 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

809 
ssize_t
 
	$»adlšk
 (cÚ¡ *
__»¡riù
 
__·th
,

810 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

811 
__THROW
 
	`__nÚnuÎ
 ((1, 2)è
__wur
;

814 #ifdeà
__USE_ATFILE


816 
	$symlšk©
 (cÚ¡ *
__äom
, 
__tofd
,

817 cÚ¡ *
__to
è
__THROW
 
	`__nÚnuÎ
 ((1, 3)è
__wur
;

820 
ssize_t
 
	$»adlšk©
 (
__fd
, cÚ¡ *
__»¡riù
 
__·th
,

821 *
__»¡riù
 
__buf
, 
size_t
 
__Ën
)

822 
__THROW
 
	`__nÚnuÎ
 ((2, 3)è
__wur
;

826 
	$uÆšk
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

828 #ifdeà
__USE_ATFILE


830 
	$uÆšk©
 (
__fd
, cÚ¡ *
__Çme
, 
__æag
)

831 
__THROW
 
	`__nÚnuÎ
 ((2));

835 
	$rmdœ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1));

839 
__pid_t
 
	$tcg‘pg½
 (
__fd
è
__THROW
;

842 
	$tc£g½
 (
__fd
, 
__pid_t
 
__pg½_id
è
__THROW
;

849 *
	`g‘logš
 ();

850 #ià
defšed
 
__USE_REENTRANT
 || defšed 
__USE_POSIX199506


857 
	$g‘logš_r
 (*
__Çme
, 
size_t
 
__Çme_Ën
è
	`__nÚnuÎ
 ((1));

860 #ifdef 
__USE_BSD


862 
	$£ogš
 (cÚ¡ *
__Çme
è
__THROW
 
	`__nÚnuÎ
 ((1));

866 #ifdef 
__USE_POSIX2


870 
	#__Ãed_g‘İt


	)

871 
	~<g‘İt.h
>

875 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


879 
	$g‘ho¡Çme
 (*
__Çme
, 
size_t
 
__Ën
è
__THROW
 
	`__nÚnuÎ
 ((1));

883 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_UNIX98
)

886 
	$£tho¡Çme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

887 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

891 
	$£tho¡id
 (
__id
è
__THROW
 
__wur
;

897 
	$g‘domašÇme
 (*
__Çme
, 
size_t
 
__Ën
)

898 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

899 
	$£tdomašÇme
 (cÚ¡ *
__Çme
, 
size_t
 
__Ën
)

900 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

906 
	$vhªgup
 (è
__THROW
;

909 
	$»voke
 (cÚ¡ *
__fe
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

917 
	$´of
 (*
__§m¶e_bufãr
, 
size_t
 
__size
,

918 
size_t
 
__off£t
, 
__sÿË
)

919 
__THROW
 
	`__nÚnuÎ
 ((1));

925 
	$acù
 (cÚ¡ *
__Çme
è
__THROW
;

929 *
	$g‘u£rsh–l
 (è
__THROW
;

930 
	$’du£rsh–l
 (è
__THROW
;

931 
	$£tu£rsh–l
 (è
__THROW
;

937 
	$d«mÚ
 (
__nochdœ
, 
__noşo£
è
__THROW
 
__wur
;

941 #ià
defšed
 
__USE_BSD
 || (defšed 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K
)

944 
	$chroÙ
 (cÚ¡ *
__·th
è
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

948 *
	$g‘·ss
 (cÚ¡ *
__´om±
è
	`__nÚnuÎ
 ((1));

956 
	`fsync
 (
__fd
);

959 #ifdeà
__USE_GNU


962 
	$syncfs
 (
__fd
è
__THROW
;

966 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED


969 
	`g‘ho¡id
 ();

972 
	$sync
 (è
__THROW
;

975 #ià
defšed
 
__USE_BSD
 || !defšed 
__USE_XOPEN2K


978 
	$g‘·gesize
 (è
__THROW
 
	`__©Œibu‹__
 ((
__cÚ¡__
));

983 
	$g‘dbËsize
 (è
__THROW
;

989 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K8


992 #iâdeà
__USE_FILE_OFFSET64


993 
	$Œunÿ‹
 (cÚ¡ *
__fe
, 
__off_t
 
__Ëngth
)

994 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

996 #ifdeà
__REDIRECT_NTH


997 
	`__REDIRECT_NTH
 (
Œunÿ‹
,

998 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
),

999 
Œunÿ‹64
è
	`__nÚnuÎ
 ((1)è
__wur
;

1001 
	#Œunÿ‹
 
Œunÿ‹64


	)

1004 #ifdeà
__USE_LARGEFILE64


1005 
	$Œunÿ‹64
 (cÚ¡ *
__fe
, 
__off64_t
 
__Ëngth
)

1006 
__THROW
 
	`__nÚnuÎ
 ((1)è
__wur
;

1011 #ià
defšed
 
__USE_BSD
 || defšed 
__USE_POSIX199309
 \

1012 || 
defšed
 
__USE_XOPEN_EXTENDED
 || defšed 
__USE_XOPEN2K


1015 #iâdeà
__USE_FILE_OFFSET64


1016 
	$árunÿ‹
 (
__fd
, 
__off_t
 
__Ëngth
è
__THROW
 
__wur
;

1018 #ifdeà
__REDIRECT_NTH


1019 
	`__REDIRECT_NTH
 (
árunÿ‹
, (
__fd
, 
__off64_t
 
__Ëngth
),

1020 
árunÿ‹64
è
__wur
;

1022 
	#árunÿ‹
 
árunÿ‹64


	)

1025 #ifdeà
__USE_LARGEFILE64


1026 
	$árunÿ‹64
 (
__fd
, 
__off64_t
 
__Ëngth
è
__THROW
 
__wur
;

1032 #ià(
defšed
 
__USE_XOPEN_EXTENDED
 && !defšed 
__USE_XOPEN2K
) \

1033 || 
defšed
 
__USE_MISC


1037 
	$brk
 (*
__addr
è
__THROW
 
__wur
;

1043 *
	$sbrk
 (
šŒ_t
 
__d–
è
__THROW
;

1047 #ifdeà
__USE_MISC


1058 
	$sysÿÎ
 (
__sy¢o
, ...è
__THROW
;

1063 #ià(
defšed
 
__USE_MISC
 || defšed 
__USE_XOPEN_EXTENDED
è&& !defšed 
F_LOCK


1075 
	#F_ULOCK
 0

	)

1076 
	#F_LOCK
 1

	)

1077 
	#F_TLOCK
 2

	)

1078 
	#F_TEST
 3

	)

1080 #iâdeà
__USE_FILE_OFFSET64


1081 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__Ën
è
__wur
;

1083 #ifdeà
__REDIRECT


1084 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
),

1085 
lockf64
è
__wur
;

1087 
	#lockf
 
lockf64


	)

1090 #ifdeà
__USE_LARGEFILE64


1091 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__Ën
è
__wur
;

1096 #ifdeà
__USE_GNU


1101 
	#TEMP_FAILURE_RETRY
(
ex´essiÚ
) \

1102 (
__ex‹nsiÚ__
 \

1103 ({ 
__»suÉ
; \

1104 dØ
__»suÉ
 = (è(
ex´essiÚ
); \

1105 
__»suÉ
 =ğ-1L && 
”ºo
 =ğ
EINTR
); \

1106 
__»suÉ
; 
	}
}))

	)

1109 #ià
defšed
 
__USE_POSIX199309
 || defšed 
__USE_UNIX98


1112 
fd©async
 (
__fdes
);

1118 #ifdef 
__USE_XOPEN


1120 *
	$üy±
 (cÚ¡ *
__key
, cÚ¡ *
__§É
)

1121 
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1125 
	$’üy±
 (*
__glibc_block
, 
__edæag
)

1126 
__THROW
 
	`__nÚnuÎ
 ((1));

1133 
	$swab
 (cÚ¡ *
__»¡riù
 
__äom
, *__»¡riù 
__to
,

1134 
ssize_t
 
__n
è
__THROW
 
	`__nÚnuÎ
 ((1, 2));

1140 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_XOPEN2K


1142 *
	$ù”mid
 (*
__s
è
__THROW
;

1147 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


1148 
	~<b™s/uni¡d.h
>

1151 
__END_DECLS


	@/usr/include/arpa/nameser_compat.h

34 #iâdeà
_ARPA_NAMESER_COMPAT_


35 
	#_ARPA_NAMESER_COMPAT_


	)

37 
	#__BIND
 19950621

	)

39 
	~<’dŸn.h
>

49 
	mid
 :16;

50 #ià
BYTE_ORDER
 =ğ
BIG_ENDIAN


52 
	mqr
: 1;

53 
	mİcode
: 4;

54 
	m¯
: 1;

55 
	mtc
: 1;

56 
	mrd
: 1;

58 
	m¿
: 1;

59 
	munu£d
 :1;

60 
	mad
: 1;

61 
	mcd
: 1;

62 
	mrcode
 :4;

64 #ià
BYTE_ORDER
 =ğ
LITTLE_ENDIAN
 || BYTE_ORDER =ğ
PDP_ENDIAN


66 
	mrd
 :1;

67 
	mtc
 :1;

68 
	m¯
 :1;

69 
	mİcode
 :4;

70 
	mqr
 :1;

72 
	mrcode
 :4;

73 
	mcd
: 1;

74 
	mad
: 1;

75 
	munu£d
 :1;

76 
	m¿
 :1;

79 
	mqdcouÁ
 :16;

80 
	mªcouÁ
 :16;

81 
	mnscouÁ
 :16;

82 
	m¬couÁ
 :16;

83 } 
	tHEADER
;

85 
	#PACKETSZ
 
NS_PACKETSZ


	)

86 
	#MAXDNAME
 
NS_MAXDNAME


	)

87 
	#MAXCDNAME
 
NS_MAXCDNAME


	)

88 
	#MAXLABEL
 
NS_MAXLABEL


	)

89 
	#HFIXEDSZ
 
NS_HFIXEDSZ


	)

90 
	#QFIXEDSZ
 
NS_QFIXEDSZ


	)

91 
	#RRFIXEDSZ
 
NS_RRFIXEDSZ


	)

92 
	#INT32SZ
 
NS_INT32SZ


	)

93 
	#INT16SZ
 
NS_INT16SZ


	)

94 
	#INT8SZ
 
NS_INT8SZ


	)

95 
	#INADDRSZ
 
NS_INADDRSZ


	)

96 
	#IN6ADDRSZ
 
NS_IN6ADDRSZ


	)

97 
	#INDIR_MASK
 
NS_CMPRSFLGS


	)

98 
	#NAMESERVER_PORT
 
NS_DEFAULTPORT


	)

100 
	#S_ZONE
 
ns_s_zn


	)

101 
	#S_PREREQ
 
ns_s_´


	)

102 
	#S_UPDATE
 
ns_s_ud


	)

103 
	#S_ADDT
 
ns_s_¬


	)

105 
	#QUERY
 
ns_o_qu”y


	)

106 
	#IQUERY
 
ns_o_iqu”y


	)

107 
	#STATUS
 
ns_o_¡©us


	)

108 
	#NS_NOTIFY_OP
 
ns_o_nÙify


	)

109 
	#NS_UPDATE_OP
 
ns_o_upd©e


	)

111 
	#NOERROR
 
ns_r_nÛ¼Ü


	)

112 
	#FORMERR
 
ns_r_fÜm”r


	)

113 
	#SERVFAIL
 
ns_r_£rvç


	)

114 
	#NXDOMAIN
 
ns_r_nxdomaš


	)

115 
	#NOTIMP
 
ns_r_nÙim¶


	)

116 
	#REFUSED
 
ns_r_»fu£d


	)

117 
	#YXDOMAIN
 
ns_r_yxdomaš


	)

118 
	#YXRRSET
 
ns_r_yx¼£t


	)

119 
	#NXRRSET
 
ns_r_nx¼£t


	)

120 
	#NOTAUTH
 
ns_r_nÙauth


	)

121 
	#NOTZONE
 
ns_r_nÙzÚe


	)

127 
	#DELETE
 
ns_uİ_d–‘e


	)

128 
	#ADD
 
ns_uİ_add


	)

130 
	#T_A
 
ns_t_a


	)

131 
	#T_NS
 
ns_t_ns


	)

132 
	#T_MD
 
ns_t_md


	)

133 
	#T_MF
 
ns_t_mf


	)

134 
	#T_CNAME
 
ns_t_úame


	)

135 
	#T_SOA
 
ns_t_sß


	)

136 
	#T_MB
 
ns_t_mb


	)

137 
	#T_MG
 
ns_t_mg


	)

138 
	#T_MR
 
ns_t_mr


	)

139 
	#T_NULL
 
ns_t_nuÎ


	)

140 
	#T_WKS
 
ns_t_wks


	)

141 
	#T_PTR
 
ns_t_±r


	)

142 
	#T_HINFO
 
ns_t_hšfo


	)

143 
	#T_MINFO
 
ns_t_mšfo


	)

144 
	#T_MX
 
ns_t_mx


	)

145 
	#T_TXT
 
ns_t_txt


	)

146 
	#T_RP
 
ns_t_½


	)

147 
	#T_AFSDB
 
ns_t_afsdb


	)

148 
	#T_X25
 
ns_t_x25


	)

149 
	#T_ISDN
 
ns_t_isdn


	)

150 
	#T_RT
 
ns_t_¹


	)

151 
	#T_NSAP
 
ns_t_n§p


	)

152 
	#T_NSAP_PTR
 
ns_t_n§p_±r


	)

153 
	#T_SIG
 
ns_t_sig


	)

154 
	#T_KEY
 
ns_t_key


	)

155 
	#T_PX
 
ns_t_px


	)

156 
	#T_GPOS
 
ns_t_gpos


	)

157 
	#T_AAAA
 
ns_t_¯¯


	)

158 
	#T_LOC
 
ns_t_loc


	)

159 
	#T_NXT
 
ns_t_nxt


	)

160 
	#T_EID
 
ns_t_eid


	)

161 
	#T_NIMLOC
 
ns_t_nimloc


	)

162 
	#T_SRV
 
ns_t_¤v


	)

163 
	#T_ATMA
 
ns_t_©ma


	)

164 
	#T_NAPTR
 
ns_t_Ç±r


	)

165 
	#T_A6
 
ns_t_a6


	)

166 
	#T_DNAME
 
ns_t_dÇme


	)

167 
	#T_TSIG
 
ns_t_tsig


	)

168 
	#T_IXFR
 
ns_t_ixä


	)

169 
	#T_AXFR
 
ns_t_axä


	)

170 
	#T_MAILB
 
ns_t_mab


	)

171 
	#T_MAILA
 
ns_t_maa


	)

172 
	#T_ANY
 
ns_t_ªy


	)

174 
	#C_IN
 
ns_c_š


	)

175 
	#C_CHAOS
 
ns_c_chaos


	)

176 
	#C_HS
 
ns_c_hs


	)

178 
	#C_NONE
 
ns_c_nÚe


	)

179 
	#C_ANY
 
ns_c_ªy


	)

181 
	#GETSHORT
 
NS_GET16


	)

182 
	#GETLONG
 
NS_GET32


	)

183 
	#PUTSHORT
 
NS_PUT16


	)

184 
	#PUTLONG
 
NS_PUT32


	)

	@/usr/include/libio.h

28 #iâdeà
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cÚfig.h
>

33 
	#_IO_åos_t
 
_G_åos_t


	)

34 
	#_IO_åos64_t
 
_G_åos64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icÚv_t
 
_G_icÚv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li¡
 
_G_va_li¡


	)

45 
	#_IO_wšt_t
 
wšt_t


	)

48 
	#__Ãed___va_li¡


	)

49 
	~<¡d¬g.h
>

50 #ifdeà
__GNUC_VA_LIST


51 #undeà
_IO_va_li¡


52 
	#_IO_va_li¡
 
__gnuc_va_li¡


	)

55 #iâdeà
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #iâdeà
EOF


62 
	#EOF
 (-1)

	)

64 #iâdeà
NULL


65 #ià
defšed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =ğ2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nuÎ
)

	)

69 #ià!
defšed
(
__ılu¥lus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifdeà
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifdeà
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifdeà
_IO_MTSAFE_IO


148 #ià
defšed
 
__GLIBC__
 && __GLIBC__ >= 2

149 
	~<b™s/¡dio-lock.h
>

154 
	t_IO_lock_t
;

160 
	s_IO_m¬k”
 {

161 
_IO_m¬k”
 *
	m_Ãxt
;

162 
_IO_FILE
 *
	m_sbuf
;

166 
	m_pos
;

168 
£t_¡»ampos
(
¡»ampos
 
¥
è{ 
	m_¥os
 = sp; }

169 
£t_off£t
(
off£t
è{ 
	m_pos
 = off£t; 
	m_¥os
 = (
¡»ampos
)(-2); }

170 
	mpublic
:

171 
¡»amm¬k”
(
¡»ambuf
 *
sb
);

172 ~
¡»amm¬k”
();

173 
§všg
(è{  
	m_¥os
 == -2; }

174 
d–
(
¡»amm¬k”
&);

175 
d–
();

180 
	e__codecvt_»suÉ


182 
	m__codecvt_ok
,

183 
	m__codecvt_·¹Ÿl
,

184 
	m__codecvt_”rÜ
,

185 
	m__codecvt_nocÚv


188 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


191 
	s_IO_codecvt


193 (*
	m__codecvt_de¡r
è(
	m_IO_codecvt
 *);

194 
__codecvt_»suÉ
 (*
__codecvt_do_out
è(
	m_IO_codecvt
 *,

195 
	m__mb¡©e_t
 *,

196 cÚ¡ 
	mwch¬_t
 *,

197 cÚ¡ 
	mwch¬_t
 *,

198 cÚ¡ 
	mwch¬_t
 **, *,

200 
__codecvt_»suÉ
 (*
__codecvt_do_unshiá
è(
	m_IO_codecvt
 *,

201 
	m__mb¡©e_t
 *, *,

203 
__codecvt_»suÉ
 (*
__codecvt_do_š
è(
	m_IO_codecvt
 *,

204 
	m__mb¡©e_t
 *,

206 cÚ¡ **, 
	mwch¬_t
 *,

207 
	mwch¬_t
 *, wchar_t **);

208 (*
	m__codecvt_do_’codšg
è(
	m_IO_codecvt
 *);

209 (*
	m__codecvt_do_®ways_nocÚv
è(
	m_IO_codecvt
 *);

210 (*
	m__codecvt_do_Ëngth
è(
	m_IO_codecvt
 *, 
	m__mb¡©e_t
 *,

211 cÚ¡ *, cÚ¡ *, 
	m_IO_size_t
);

212 (*
	m__codecvt_do_max_Ëngth
è(
	m_IO_codecvt
 *);

214 
_IO_icÚv_t
 
	m__cd_š
;

215 
_IO_icÚv_t
 
	m__cd_out
;

219 
	s_IO_wide_d©a


221 
wch¬_t
 *
	m_IO_»ad_±r
;

222 
wch¬_t
 *
	m_IO_»ad_’d
;

223 
wch¬_t
 *
	m_IO_»ad_ba£
;

224 
wch¬_t
 *
	m_IO_wr™e_ba£
;

225 
wch¬_t
 *
	m_IO_wr™e_±r
;

226 
wch¬_t
 *
	m_IO_wr™e_’d
;

227 
wch¬_t
 *
	m_IO_buf_ba£
;

228 
wch¬_t
 *
	m_IO_buf_’d
;

230 
wch¬_t
 *
	m_IO_§ve_ba£
;

231 
wch¬_t
 *
	m_IO_backup_ba£
;

233 
wch¬_t
 *
	m_IO_§ve_’d
;

235 
__mb¡©e_t
 
	m_IO_¡©e
;

236 
__mb¡©e_t
 
	m_IO_Ï¡_¡©e
;

237 
_IO_codecvt
 
	m_codecvt
;

239 
wch¬_t
 
	m_shÜtbuf
[1];

241 cÚ¡ 
_IO_jump_t
 *
	m_wide_vbË
;

245 
	s_IO_FILE
 {

246 
	m_æags
;

247 
	#_IO_fe_æags
 
_æags


	)

251 * 
	m_IO_»ad_±r
;

252 * 
	m_IO_»ad_’d
;

253 * 
	m_IO_»ad_ba£
;

254 * 
	m_IO_wr™e_ba£
;

255 * 
	m_IO_wr™e_±r
;

256 * 
	m_IO_wr™e_’d
;

257 * 
	m_IO_buf_ba£
;

258 * 
	m_IO_buf_’d
;

260 *
	m_IO_§ve_ba£
;

261 *
	m_IO_backup_ba£
;

262 *
	m_IO_§ve_’d
;

264 
_IO_m¬k”
 *
	m_m¬k”s
;

266 
_IO_FILE
 *
	m_chaš
;

268 
	m_f’o
;

270 
	m_blksize
;

272 
	m_æags2
;

274 
_IO_off_t
 
	m_Şd_off£t
;

276 
	#__HAVE_COLUMN


	)

278 
	m_cur_cŞumn
;

279 sigÃd 
	m_vbË_off£t
;

280 
	m_shÜtbuf
[1];

284 
_IO_lock_t
 *
	m_lock
;

285 #ifdeà
_IO_USE_OLD_IO_FILE


288 
	s_IO_FILE_com¶‘e


290 
_IO_FILE
 
	m_fe
;

292 #ià
defšed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

293 
_IO_off64_t
 
	m_off£t
;

294 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


296 
_IO_codecvt
 *
	m_codecvt
;

297 
_IO_wide_d©a
 *
	m_wide_d©a
;

298 
_IO_FILE
 *
	m_ä“»s_li¡
;

299 *
	m_ä“»s_buf
;

300 
size_t
 
	m_ä“»s_size
;

302 *
	m__·d1
;

303 *
	m__·d2
;

304 *
	m__·d3
;

305 *
	m__·d4
;

306 
size_t
 
	m__·d5
;

308 
	m_mode
;

310 
	m_unu£d2
[15 *  (è- 4 *  (*è-  (
size_t
)];

314 #iâdeà
__ılu¥lus


315 
_IO_FILE
 
	t_IO_FILE
;

318 
	g_IO_FILE_¶us
;

320 
_IO_FILE_¶us
 
_IO_2_1_¡dš_
;

321 
_IO_FILE_¶us
 
_IO_2_1_¡dout_
;

322 
_IO_FILE_¶us
 
_IO_2_1_¡d”r_
;

323 #iâdeà
_LIBC


324 
	#_IO_¡dš
 ((
_IO_FILE
*)(&
_IO_2_1_¡dš_
))

	)

325 
	#_IO_¡dout
 ((
_IO_FILE
*)(&
_IO_2_1_¡dout_
))

	)

326 
	#_IO_¡d”r
 ((
_IO_FILE
*)(&
_IO_2_1_¡d”r_
))

	)

328 
_IO_FILE
 *
_IO_¡dš
 
©Œibu‹_hidd’
;

329 
_IO_FILE
 *
_IO_¡dout
 
©Œibu‹_hidd’
;

330 
_IO_FILE
 *
_IO_¡d”r
 
©Œibu‹_hidd’
;

338 
__ssize_t
 
	t__io_»ad_â
 (*
	t__cook›
, *
	t__buf
, 
	tsize_t
 
	t__nby‹s
);

346 
__ssize_t
 
	t__io_wr™e_â
 (*
	t__cook›
, cÚ¡ *
	t__buf
,

347 
	tsize_t
 
	t__n
);

355 
	t__io_£ek_â
 (*
	t__cook›
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

358 
	t__io_şo£_â
 (*
	t__cook›
);

361 #ifdeà
_GNU_SOURCE


363 
__io_»ad_â
 
	tcook›_»ad_funùiÚ_t
;

364 
__io_wr™e_â
 
	tcook›_wr™e_funùiÚ_t
;

365 
__io_£ek_â
 
	tcook›_£ek_funùiÚ_t
;

366 
__io_şo£_â
 
	tcook›_şo£_funùiÚ_t
;

371 
__io_»ad_â
 *
	m»ad
;

372 
__io_wr™e_â
 *
	mwr™e
;

373 
__io_£ek_â
 *
	m£ek
;

374 
__io_şo£_â
 *
	mşo£
;

375 } 
	t_IO_cook›_io_funùiÚs_t
;

376 
_IO_cook›_io_funùiÚs_t
 
	tcook›_io_funùiÚs_t
;

378 
	g_IO_cook›_fe
;

381 
_IO_cook›_š™
 (
_IO_cook›_fe
 *
__cfe
, 
__»ad_wr™e
,

382 *
__cook›
, 
_IO_cook›_io_funùiÚs_t
 
__âs
);

386 #ifdeà
__ılu¥lus


390 
__und”æow
 (
_IO_FILE
 *);

391 
__uæow
 (
_IO_FILE
 *);

392 
__ov”æow
 (
_IO_FILE
 *, );

393 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


394 
_IO_wšt_t
 
__wund”æow
 (
_IO_FILE
 *);

395 
_IO_wšt_t
 
__wuæow
 (
_IO_FILE
 *);

396 
_IO_wšt_t
 
__wov”æow
 (
_IO_FILE
 *, _IO_wint_t);

399 #ià 
__GNUC__
 >= 3

400 
	#_IO_BE
(
ex´
, 
»s
è
	`__butš_ex³ù
 (Óx´),„es)

	)

402 
	#_IO_BE
(
ex´
, 
»s
èÓx´)

	)

405 
	#_IO_g‘c_uÆocked
(
_å
) \

406 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

407 ? 
	`__uæow
 (
_å
è: *(*è(_å)->
_IO_»ad_±r
++)

	)

408 
	#_IO_³ekc_uÆocked
(
_å
) \

409 (
	`_IO_BE
 ((
_å
)->
_IO_»ad_±r
 >ğ(_å)->
_IO_»ad_’d
, 0) \

410 && 
	`__und”æow
 (
_å
è=ğ
EOF
 ? EOF \

411 : *(*è(
_å
)->
_IO_»ad_±r
)

	)

412 
	#_IO_putc_uÆocked
(
_ch
, 
_å
) \

413 (
	`_IO_BE
 ((
_å
)->
_IO_wr™e_±r
 >ğ(_å)->
_IO_wr™e_’d
, 0) \

414 ? 
	`__ov”æow
 (
_å
, (è(
_ch
)) \

415 : (è(*(
_å
)->
_IO_wr™e_±r
++ = (
_ch
)))

	)

417 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


418 
	#_IO_g‘wc_uÆocked
(
_å
) \

419 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

420 || ((
_å
)->
_wide_d©a
->
_IO_»ad_±r
 \

421 >ğ(
_å
)->
_wide_d©a
->
_IO_»ad_’d
), 0) \

422 ? 
	`__wuæow
 (
_å
è: (
_IO_wšt_t
è*(_å)->
_wide_d©a
->
_IO_»ad_±r
++)

	)

423 
	#_IO_putwc_uÆocked
(
_wch
, 
_å
) \

424 (
	`_IO_BE
 ((
_å
)->
_wide_d©a
 =ğ
NULL
 \

425 || ((
_å
)->
_wide_d©a
->
_IO_wr™e_±r
 \

426 >ğ(
_å
)->
_wide_d©a
->
_IO_wr™e_’d
), 0) \

427 ? 
	`__wov”æow
 (
_å
, 
_wch
) \

428 : (
_IO_wšt_t
è(*(
_å
)->
_wide_d©a
->
_IO_wr™e_±r
++ = (
_wch
)))

	)

431 
	#_IO_ãof_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_EOF_SEEN
è!ğ0)

	)

432 
	#_IO_ã¼Ü_uÆocked
(
__å
è(((__å)->
_æags
 & 
_IO_ERR_SEEN
è!ğ0)

	)

434 
_IO_g‘c
 (
_IO_FILE
 *
__å
);

435 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__å
);

436 
_IO_ãof
 (
_IO_FILE
 *
__å
è
__THROW
;

437 
_IO_ã¼Ü
 (
_IO_FILE
 *
__å
è
__THROW
;

439 
_IO_³ekc_locked
 (
_IO_FILE
 *
__å
);

442 
	#_IO_PENDING_OUTPUT_COUNT
(
_å
) \

443 ((
_å
)->
_IO_wr™e_±r
 - (_å)->
_IO_wr™e_ba£
)

	)

445 
_IO_æockfe
 (
_IO_FILE
 *è
__THROW
;

446 
_IO_fuÆockfe
 (
_IO_FILE
 *è
__THROW
;

447 
_IO_árylockfe
 (
_IO_FILE
 *è
__THROW
;

449 #ifdeà
_IO_MTSAFE_IO


450 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_locked
 (_å)

	)

451 
	#_IO_æockfe
(
_å
) \

452 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_æockfe
 (_å)

	)

453 
	#_IO_fuÆockfe
(
_å
) \

454 ià(((
_å
)->
_æags
 & 
_IO_USER_LOCK
è=ğ0è
	`_IO_fuÆockfe
 (_å)

	)

456 
	#_IO_³ekc
(
_å
è
	`_IO_³ekc_uÆocked
 (_å)

	)

457 
	#_IO_æockfe
(
_å
è

	)

458 
	#_IO_fuÆockfe
(
_å
è

	)

459 
	#_IO_árylockfe
(
_å
è

	)

460 
	#_IO_ş—nup_»giÚ_¡¬t
(
_fù
, 
_å
è

	)

461 
	#_IO_ş—nup_»giÚ_’d
(
_Do™
è

	)

464 
_IO_vfsÿnf
 (
_IO_FILE
 * 
__»¡riù
, const * __restrict,

465 
_IO_va_li¡
, *
__»¡riù
);

466 
_IO_vårštf
 (
_IO_FILE
 *
__»¡riù
, const *__restrict,

467 
_IO_va_li¡
);

468 
_IO_ssize_t
 
_IO_·dn
 (
_IO_FILE
 *, , _IO_ssize_t);

469 
_IO_size_t
 
_IO_sg‘n
 (
_IO_FILE
 *, *, _IO_size_t);

471 
_IO_off64_t
 
_IO_£ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

472 
_IO_off64_t
 
_IO_£ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

474 
_IO_ä“_backup_¬—
 (
_IO_FILE
 *è
__THROW
;

476 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


477 
_IO_wšt_t
 
_IO_g‘wc
 (
_IO_FILE
 *
__å
);

478 
_IO_wšt_t
 
_IO_putwc
 (
wch¬_t
 
__wc
, 
_IO_FILE
 *
__å
);

479 
_IO_fwide
 (
_IO_FILE
 *
__å
, 
__mode
è
__THROW
;

480 #ià
__GNUC__
 >= 2

483 #ià
defšed
 
_LIBC
 && defšed 
SHARED


484 
	~<shlib-com·t.h
>

485 #ià
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

486 
	#_IO_fwide_maybe_šcom·tibË
 \

487 (
	`__butš_ex³ù
 (&
_IO_¡dš_u£d
 =ğ
NULL
, 0))

	)

488 cÚ¡ 
_IO_¡dš_u£d
;

489 
w—k_ex‹º
 (
_IO_¡dš_u£d
);

492 #iâdeà
_IO_fwide_maybe_šcom·tibË


493 
	#_IO_fwide_maybe_šcom·tibË
 (0)

	)

497 
	#_IO_fwide
(
__å
, 
__mode
) \

498 ({ 
__»suÉ
 = (
__mode
); \

499 ià(
__»suÉ
 < 0 && ! 
_IO_fwide_maybe_šcom·tibË
) \

501 ià((
__å
)->
_mode
 == 0) \

503 (
__å
)->
_mode
 = -1; \

504 
__»suÉ
 = (
__å
)->
_mode
; \

506 ià(
	`__butš_cÚ¡ªt_p
 (
__mode
) && (__mode) == 0) \

507 
__»suÉ
 = 
_IO_fwide_maybe_šcom·tibË
 ? -1 : (
__å
)->
_mode
; \

509 
__»suÉ
 = 
	`_IO_fwide
 (
__å
, __result); \

510 
__»suÉ
; })

	)

513 
_IO_vfwsÿnf
 (
_IO_FILE
 * 
__»¡riù
, cÚ¡ 
wch¬_t
 * __restrict,

514 
_IO_va_li¡
, *
__»¡riù
);

515 
_IO_vfw´štf
 (
_IO_FILE
 *
__»¡riù
, cÚ¡ 
wch¬_t
 *__restrict,

516 
_IO_va_li¡
);

517 
_IO_ssize_t
 
_IO_w·dn
 (
_IO_FILE
 *, 
wšt_t
, _IO_ssize_t);

518 
_IO_ä“_wbackup_¬—
 (
_IO_FILE
 *è
__THROW
;

521 #ifdeà
__LDBL_COMPAT


522 
	~<b™s/libio-ldbl.h
>

525 #ifdeà
__ılu¥lus


	@/usr/include/linux/atmapi.h

6 #iâdeà
_LINUX_ATMAPI_H


7 
	#_LINUX_ATMAPI_H


	)

9 #ià
defšed
(
__¥¬c__
è|| defšed(
__Ÿ64__
)

12 
	#__ATM_API_ALIGN
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

14 
	#__ATM_API_ALIGN


	)

27 ¡ruù { 
	m_
[8]; } 
	t__ATM_API_ALIGN
 
	t©m_k±r_t
;

	@/usr/include/linux/atmioc.h

12 #iâdeà
_LINUX_ATMIOC_H


13 
	#_LINUX_ATMIOC_H


	)

15 
	~<asm/ioùl.h
>

18 
	#ATMIOC_PHYCOM
 0x00

	)

19 
	#ATMIOC_PHYCOM_END
 0x0f

	)

20 
	#ATMIOC_PHYTYP
 0x10

	)

21 
	#ATMIOC_PHYTYP_END
 0x2f

	)

22 
	#ATMIOC_PHYPRV
 0x30

	)

23 
	#ATMIOC_PHYPRV_END
 0x4f

	)

24 
	#ATMIOC_SARCOM
 0x50

	)

25 
	#ATMIOC_SARCOM_END
 0x50

	)

26 
	#ATMIOC_SARPRV
 0x60

	)

27 
	#ATMIOC_SARPRV_END
 0x7f

	)

28 
	#ATMIOC_ITF
 0x80

	)

29 
	#ATMIOC_ITF_END
 0x8f

	)

30 
	#ATMIOC_BACKEND
 0x90

	)

31 
	#ATMIOC_BACKEND_END
 0xaf

	)

33 
	#ATMIOC_AREQUIPA
 0xc0

	)

34 
	#ATMIOC_LANE
 0xd0

	)

35 
	#ATMIOC_MPOA
 0xd8

	)

36 
	#ATMIOC_CLIP
 0xe0

	)

37 
	#ATMIOC_CLIP_END
 0xef

	)

38 
	#ATMIOC_SPECIAL
 0xf0

	)

39 
	#ATMIOC_SPECIAL_END
 0xff

	)

	@/usr/include/linux/atmsap.h

6 #iâdeà
_LINUX_ATMSAP_H


7 
	#_LINUX_ATMSAP_H


	)

9 
	~<lšux/©m­i.h
>

22 
	#ATM_L2_NONE
 0

	)

23 
	#ATM_L2_ISO1745
 0x01

	)

24 
	#ATM_L2_Q291
 0x02

	)

25 
	#ATM_L2_X25_LL
 0x06

	)

26 
	#ATM_L2_X25_ML
 0x07

	)

27 
	#ATM_L2_LAPB
 0x08

	)

28 
	#ATM_L2_HDLC_ARM
 0x09

	)

29 
	#ATM_L2_HDLC_NRM
 0x0¨

	)

30 
	#ATM_L2_HDLC_ABM
 0x0b

	)

31 
	#ATM_L2_ISO8802
 0x0ø

	)

32 
	#ATM_L2_X75
 0x0d

	)

33 
	#ATM_L2_Q922
 0x0

	)

34 
	#ATM_L2_USER
 0x10

	)

35 
	#ATM_L2_ISO7776
 0x11

	)

44 
	#ATM_L3_NONE
 0

	)

45 
	#ATM_L3_X25
 0x06

	)

46 
	#ATM_L3_ISO8208
 0x07

	)

47 
	#ATM_L3_X223
 0x08

	)

48 
	#ATM_L3_ISO8473
 0x09

	)

49 
	#ATM_L3_T70
 0x0¨

	)

50 
	#ATM_L3_TR9577
 0x0b

	)

51 
	#ATM_L3_H310
 0x0ø

	)

52 
	#ATM_L3_H321
 0x0d

	)

53 
	#ATM_L3_USER
 0x10

	)

62 
	#ATM_HL_NONE
 0

	)

63 
	#ATM_HL_ISO
 0x01

	)

64 
	#ATM_HL_USER
 0x02

	)

65 
	#ATM_HL_HLP
 0x03

	)

66 
	#ATM_HL_VENDOR
 0x04

	)

75 
	#ATM_IMD_NONE
 0

	)

76 
	#ATM_IMD_NORMAL
 1

	)

77 
	#ATM_IMD_EXTENDED
 2

	)

84 
	#ATM_TT_NONE
 0

	)

85 
	#ATM_TT_RX
 1

	)

86 
	#ATM_TT_TX
 2

	)

87 
	#ATM_TT_RXTX
 3

	)

89 
	#ATM_MC_NONE
 0

	)

90 
	#ATM_MC_TS
 1

	)

91 
	#ATM_MC_TS_FEC
 2

	)

92 
	#ATM_MC_PS
 3

	)

93 
	#ATM_MC_PS_FEC
 4

	)

94 
	#ATM_MC_H221
 5

	)

100 
	#ATM_MAX_HLI
 8

	)

103 
	s©m_bÎi
 {

104 
	ml2_´Ùo
;

107 
	mmode
;

109 
	mwšdow
;

110 } 
	m™u
;

111 
	mu£r
;

112 } 
	ml2
;

113 
	ml3_´Ùo
;

116 
	mmode
;

118 
	mdef_size
;

120 
	mwšdow
;

121 } 
	m™u
;

122 
	mu£r
;

124 
	m‹rm_ty³
;

125 
	mfw_mpx_ÿp
;

127 
	mbw_mpx_ÿp
;

129 } 
	mh310
;

131 
	mi
;

132 
	m¢­
[5];

134 } 
	mŒ9577
;

135 } 
	ml3
;

136 } 
	g__ATM_API_ALIGN
;

139 
	s©m_bhli
 {

140 
	mhl_ty³
;

141 
	mhl_Ëngth
;

143 
	mhl_šfo
[
ATM_MAX_HLI
];

147 
	#ATM_MAX_BLLI
 3

	)

150 
	s©m_§p
 {

151 
©m_bhli
 
	mbhli
;

152 
©m_bÎi
 
	mbÎi
[
ATM_MAX_BLLI
] 
	m__ATM_API_ALIGN
;

157 
__šlše__
 
	$bÎi_š_u£
(
©m_bÎi
 
bÎi
)

159  
bÎi
.
l2_´Ùo
 || bÎi.
l3_´Ùo
;

160 
	}
}

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

37 #iâdeà
__ASSEMBLY__


40 
	mşock_¿‹
;

41 
	mşock_ty³
;

42 
	mloİback
;

43 } 
	tsync_£rŸl_£‰šgs
;

46 
	mşock_¿‹
;

47 
	mşock_ty³
;

48 
	mloİback
;

49 
	m¦Ù_m­
;

50 } 
	t‹1_£‰šgs
;

53 
	m’codšg
;

54 
	m·r™y
;

55 } 
	t¿w_hdlc_´Ùo
;

58 
	mt391
;

59 
	mt392
;

60 
	mn391
;

61 
	mn392
;

62 
	mn393
;

63 
	mlmi
;

64 
	mdû
;

65 } 
	tä_´Ùo
;

68 
	mdlci
;

69 } 
	tä_´Ùo_pvc
;

72 
	mdlci
;

73 
	mma¡”
[
IFNAMSIZ
];

74 }
	tä_´Ùo_pvc_šfo
;

77 
	mš‹rv®
;

78 
	mtimeout
;

79 } 
	tcisco_´Ùo
;

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt
 {

7 
	m¥kt_çmy
;

8 
	m¥kt_deviû
[14];

9 
__be16
 
	m¥kt_´ÙocŞ
;

12 
	ssockaddr_Î
 {

13 
	m¦l_çmy
;

14 
__be16
 
	m¦l_´ÙocŞ
;

15 
	m¦l_ifšdex
;

16 
	m¦l_h©y³
;

17 
	m¦l_pk‰y³
;

18 
	m¦l_h®’
;

19 
	m¦l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

29 
	#PACKET_LOOPBACK
 5

	)

30 
	#PACKET_USER
 6

	)

31 
	#PACKET_KERNEL
 7

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

49 
	#PACKET_TX_RING
 13

	)

50 
	#PACKET_LOSS
 14

	)

51 
	#PACKET_VNET_HDR
 15

	)

52 
	#PACKET_TX_TIMESTAMP
 16

	)

53 
	#PACKET_TIMESTAMP
 17

	)

54 
	#PACKET_FANOUT
 18

	)

55 
	#PACKET_TX_HAS_OFF
 19

	)

56 
	#PACKET_QDISC_BYPASS
 20

	)

57 
	#PACKET_ROLLOVER_STATS
 21

	)

58 
	#PACKET_FANOUT_DATA
 22

	)

60 
	#PACKET_FANOUT_HASH
 0

	)

61 
	#PACKET_FANOUT_LB
 1

	)

62 
	#PACKET_FANOUT_CPU
 2

	)

63 
	#PACKET_FANOUT_ROLLOVER
 3

	)

64 
	#PACKET_FANOUT_RND
 4

	)

65 
	#PACKET_FANOUT_QM
 5

	)

66 
	#PACKET_FANOUT_CBPF
 6

	)

67 
	#PACKET_FANOUT_EBPF
 7

	)

68 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

69 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

71 
	sack‘_¡©s
 {

72 
	m_·ck‘s
;

73 
	m_drİs
;

76 
	sack‘_¡©s_v3
 {

77 
	m_·ck‘s
;

78 
	m_drİs
;

79 
	m_ä“ze_q_út
;

82 
	sack‘_rŞlov”_¡©s
 {

83 
__®igÃd_u64
 
	m_®l
;

84 
__®igÃd_u64
 
	m_huge
;

85 
__®igÃd_u64
 
	m_çed
;

88 
	uack‘_¡©s_u
 {

89 
ack‘_¡©s
 
	m¡©s1
;

90 
ack‘_¡©s_v3
 
	m¡©s3
;

93 
	sack‘_auxd©a
 {

94 
__u32
 
	m_¡©us
;

95 
__u32
 
	m_Ën
;

96 
__u32
 
	m_¢­Ën
;

97 
__u16
 
	m_mac
;

98 
__u16
 
	m_Ãt
;

99 
__u16
 
	m_vÏn_tci
;

100 
__u16
 
	m_vÏn_id
;

104 
	#TP_STATUS_KERNEL
 0

	)

105 
	#TP_STATUS_USER
 (1 << 0)

	)

106 
	#TP_STATUS_COPY
 (1 << 1)

	)

107 
	#TP_STATUS_LOSING
 (1 << 2)

	)

108 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

109 
	#TP_STATUS_VLAN_VALID
 (1 << 4è

	)

110 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

111 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6è

	)

112 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

115 
	#TP_STATUS_AVAILABLE
 0

	)

116 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

117 
	#TP_STATUS_SENDING
 (1 << 1)

	)

118 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

121 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

122 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30è

	)

123 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

126 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

128 
	sack‘_hdr
 {

129 
	m_¡©us
;

130 
	m_Ën
;

131 
	m_¢­Ën
;

132 
	m_mac
;

133 
	m_Ãt
;

134 
	m_£c
;

135 
	m_u£c
;

138 
	#TPACKET_ALIGNMENT
 16

	)

139 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

140 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

142 
	sack‘2_hdr
 {

143 
__u32
 
	m_¡©us
;

144 
__u32
 
	m_Ën
;

145 
__u32
 
	m_¢­Ën
;

146 
__u16
 
	m_mac
;

147 
__u16
 
	m_Ãt
;

148 
__u32
 
	m_£c
;

149 
__u32
 
	m_n£c
;

150 
__u16
 
	m_vÏn_tci
;

151 
__u16
 
	m_vÏn_id
;

152 
__u8
 
	m_·ddšg
[4];

155 
	sack‘_hdr_v¬ŸÁ1
 {

156 
__u32
 
	m_rxhash
;

157 
__u32
 
	m_vÏn_tci
;

158 
__u16
 
	m_vÏn_id
;

159 
__u16
 
	m_·ddšg
;

162 
	sack‘3_hdr
 {

163 
__u32
 
	m_Ãxt_off£t
;

164 
__u32
 
	m_£c
;

165 
__u32
 
	m_n£c
;

166 
__u32
 
	m_¢­Ën
;

167 
__u32
 
	m_Ën
;

168 
__u32
 
	m_¡©us
;

169 
__u16
 
	m_mac
;

170 
__u16
 
	m_Ãt
;

173 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

175 
__u8
 
	m_·ddšg
[8];

178 
	sack‘_bd_ts
 {

179 
	mts_£c
;

181 
	mts_u£c
;

182 
	mts_n£c
;

186 
	sack‘_hdr_v1
 {

187 
__u32
 
	mblock_¡©us
;

188 
__u32
 
	mnum_pkts
;

189 
__u32
 
	moff£t_to_fœ¡_pkt
;

194 
__u32
 
	mblk_Ën
;

205 
__®igÃd_u64
 
	m£q_num
;

232 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

235 
	uack‘_bd_h—d”_u
 {

236 
ack‘_hdr_v1
 
	mbh1
;

239 
	sack‘_block_desc
 {

240 
__u32
 
	mv”siÚ
;

241 
__u32
 
	moff£t_to_´iv
;

242 
ack‘_bd_h—d”_u
 
	mhdr
;

245 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

246 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

248 
	eack‘_v”siÚs
 {

249 
	mTPACKET_V1
,

250 
	mTPACKET_V2
,

251 
	mTPACKET_V3


267 
	sack‘_»q
 {

268 
	m_block_size
;

269 
	m_block_Ä
;

270 
	m_äame_size
;

271 
	m_äame_Ä
;

274 
	sack‘_»q3
 {

275 
	m_block_size
;

276 
	m_block_Ä
;

277 
	m_äame_size
;

278 
	m_äame_Ä
;

279 
	m_»tœe_blk_tov
;

280 
	m_sizeof_´iv
;

281 
	m_ã©u»_»q_wÜd
;

284 
	uack‘_»q_u
 {

285 
ack‘_»q
 
	m»q
;

286 
ack‘_»q3
 
	m»q3
;

289 
	s·ck‘_m»q
 {

290 
	mmr_ifšdex
;

291 
	mmr_ty³
;

292 
	mmr_®’
;

293 
	mmr_add»ss
[8];

296 
	#PACKET_MR_MULTICAST
 0

	)

297 
	#PACKET_MR_PROMISC
 1

	)

298 
	#PACKET_MR_ALLMULTI
 2

	)

299 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/in.h

18 #iâdeà
_LINUX_IN_H


19 
	#_LINUX_IN_H


	)

21 
	~<lšux/ty³s.h
>

22 
	~<lšux/libc-com·t.h
>

23 
	~<lšux/sock‘.h
>

25 #ià
__UAPI_DEF_IN_IPPROTO


28 
	mIPPROTO_IP
 = 0,

29 
	#IPPROTO_IP
 
IPPROTO_IP


	)

30 
	mIPPROTO_ICMP
 = 1,

31 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

32 
	mIPPROTO_IGMP
 = 2,

33 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

34 
	mIPPROTO_IPIP
 = 4,

35 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

36 
	mIPPROTO_TCP
 = 6,

37 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

38 
	mIPPROTO_EGP
 = 8,

39 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

40 
	mIPPROTO_PUP
 = 12,

41 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

42 
	mIPPROTO_UDP
 = 17,

43 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

44 
	mIPPROTO_IDP
 = 22,

45 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

46 
	mIPPROTO_TP
 = 29,

47 
	#IPPROTO_TP
 
IPPROTO_TP


	)

48 
	mIPPROTO_DCCP
 = 33,

49 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

50 
	mIPPROTO_IPV6
 = 41,

51 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

52 
	mIPPROTO_RSVP
 = 46,

53 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

54 
	mIPPROTO_GRE
 = 47,

55 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

56 
	mIPPROTO_ESP
 = 50,

57 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

58 
	mIPPROTO_AH
 = 51,

59 
	#IPPROTO_AH
 
IPPROTO_AH


	)

60 
	mIPPROTO_MTP
 = 92,

61 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

62 
	mIPPROTO_BEETPH
 = 94,

63 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

64 
	mIPPROTO_ENCAP
 = 98,

65 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

66 
	mIPPROTO_PIM
 = 103,

67 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

68 
	mIPPROTO_COMP
 = 108,

69 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

70 
	mIPPROTO_SCTP
 = 132,

71 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

72 
	mIPPROTO_UDPLITE
 = 136,

73 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

74 
	mIPPROTO_MPLS
 = 137,

75 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

76 
	mIPPROTO_RAW
 = 255,

77 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

78 
	mIPPROTO_MAX


82 #ià
__UAPI_DEF_IN_ADDR


84 
	sš_addr
 {

85 
__be32
 
	ms_addr
;

89 
	#IP_TOS
 1

	)

90 
	#IP_TTL
 2

	)

91 
	#IP_HDRINCL
 3

	)

92 
	#IP_OPTIONS
 4

	)

93 
	#IP_ROUTER_ALERT
 5

	)

94 
	#IP_RECVOPTS
 6

	)

95 
	#IP_RETOPTS
 7

	)

96 
	#IP_PKTINFO
 8

	)

97 
	#IP_PKTOPTIONS
 9

	)

98 
	#IP_MTU_DISCOVER
 10

	)

99 
	#IP_RECVERR
 11

	)

100 
	#IP_RECVTTL
 12

	)

101 
	#IP_RECVTOS
 13

	)

102 
	#IP_MTU
 14

	)

103 
	#IP_FREEBIND
 15

	)

104 
	#IP_IPSEC_POLICY
 16

	)

105 
	#IP_XFRM_POLICY
 17

	)

106 
	#IP_PASSSEC
 18

	)

107 
	#IP_TRANSPARENT
 19

	)

110 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

113 
	#IP_ORIGDSTADDR
 20

	)

114 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

116 
	#IP_MINTTL
 21

	)

117 
	#IP_NODEFRAG
 22

	)

118 
	#IP_CHECKSUM
 23

	)

119 
	#IP_BIND_ADDRESS_NO_PORT
 24

	)

122 
	#IP_PMTUDISC_DONT
 0

	)

123 
	#IP_PMTUDISC_WANT
 1

	)

124 
	#IP_PMTUDISC_DO
 2

	)

125 
	#IP_PMTUDISC_PROBE
 3

	)

130 
	#IP_PMTUDISC_INTERFACE
 4

	)

134 
	#IP_PMTUDISC_OMIT
 5

	)

136 
	#IP_MULTICAST_IF
 32

	)

137 
	#IP_MULTICAST_TTL
 33

	)

138 
	#IP_MULTICAST_LOOP
 34

	)

139 
	#IP_ADD_MEMBERSHIP
 35

	)

140 
	#IP_DROP_MEMBERSHIP
 36

	)

141 
	#IP_UNBLOCK_SOURCE
 37

	)

142 
	#IP_BLOCK_SOURCE
 38

	)

143 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

144 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

145 
	#IP_MSFILTER
 41

	)

146 
	#MCAST_JOIN_GROUP
 42

	)

147 
	#MCAST_BLOCK_SOURCE
 43

	)

148 
	#MCAST_UNBLOCK_SOURCE
 44

	)

149 
	#MCAST_LEAVE_GROUP
 45

	)

150 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

151 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

152 
	#MCAST_MSFILTER
 48

	)

153 
	#IP_MULTICAST_ALL
 49

	)

154 
	#IP_UNICAST_IF
 50

	)

156 
	#MCAST_EXCLUDE
 0

	)

157 
	#MCAST_INCLUDE
 1

	)

160 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

161 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

165 #ià
__UAPI_DEF_IP_MREQ


166 
	s_m»q
 {

167 
š_addr
 
	mimr_muÉŸddr
;

168 
š_addr
 
	mimr_š‹rçû
;

171 
	s_m»qn
 {

172 
š_addr
 
	mimr_muÉŸddr
;

173 
š_addr
 
	mimr_add»ss
;

174 
	mimr_ifšdex
;

177 
	s_m»q_sourû
 {

178 
__be32
 
	mimr_muÉŸddr
;

179 
__be32
 
	mimr_š‹rçû
;

180 
__be32
 
	mimr_sourûaddr
;

183 
	s_msf‹r
 {

184 
__be32
 
	mimsf_muÉŸddr
;

185 
__be32
 
	mimsf_š‹rçû
;

186 
__u32
 
	mimsf_fmode
;

187 
__u32
 
	mimsf_num¤c
;

188 
__be32
 
	mimsf_¦i¡
[1];

191 
	#IP_MSFILTER_SIZE
(
num¤c
) \

192 ((
_msf‹r
è- (
__u32
) \

193 + (
num¤c
è* (
__u32
))

	)

195 
	sgroup_»q
 {

196 
__u32
 
	mgr_š‹rçû
;

197 
__k”Ãl_sockaddr_¡Üage
 
	mgr_group
;

200 
	sgroup_sourû_»q
 {

201 
__u32
 
	mg¤_š‹rçû
;

202 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_group
;

203 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_sourû
;

206 
	sgroup_f‹r
 {

207 
__u32
 
	mgf_š‹rçû
;

208 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group
;

209 
__u32
 
	mgf_fmode
;

210 
__u32
 
	mgf_num¤c
;

211 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡
[1];

214 
	#GROUP_FILTER_SIZE
(
num¤c
) \

215 ((
group_f‹r
è- (
__k”Ãl_sockaddr_¡Üage
) \

216 + (
num¤c
è* (
__k”Ãl_sockaddr_¡Üage
))

	)

219 #ià
__UAPI_DEF_IN_PKTINFO


220 
	sš_pktšfo
 {

221 
	mi_ifšdex
;

222 
š_addr
 
	mi_¥ec_d¡
;

223 
š_addr
 
	mi_addr
;

228 #ià 
__UAPI_DEF_SOCKADDR_IN


229 
	#__SOCK_SIZE__
 16

	)

230 
	ssockaddr_š
 {

231 
__k”Ãl_§_çmy_t
 
	msš_çmy
;

232 
__be16
 
	msš_pÜt
;

233 
š_addr
 
	msš_addr
;

236 
	m__·d
[
__SOCK_SIZE__
 - () -

237 (è- (
š_addr
)];

239 
	#sš_z”o
 
__·d


	)

242 #ià
__UAPI_DEF_IN_CLASS


248 
	#IN_CLASSA
(
a
è((((è×)è& 0x80000000è=ğ0)

	)

249 
	#IN_CLASSA_NET
 0xff000000

	)

250 
	#IN_CLASSA_NSHIFT
 24

	)

251 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

252 
	#IN_CLASSA_MAX
 128

	)

254 
	#IN_CLASSB
(
a
è((((è×)è& 0xc0000000è=ğ0x80000000)

	)

255 
	#IN_CLASSB_NET
 0xffff0000

	)

256 
	#IN_CLASSB_NSHIFT
 16

	)

257 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

258 
	#IN_CLASSB_MAX
 65536

	)

260 
	#IN_CLASSC
(
a
è((((è×)è& 0xe0000000è=ğ0xc0000000)

	)

261 
	#IN_CLASSC_NET
 0xffffff00

	)

262 
	#IN_CLASSC_NSHIFT
 8

	)

263 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

265 
	#IN_CLASSD
(
a
è((((è×)è& 0xf0000000è=ğ0xe0000000)

	)

266 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

267 
	#IN_MULTICAST_NET
 0xF0000000

	)

269 
	#IN_EXPERIMENTAL
(
a
è((((è×)è& 0xf0000000è=ğ0xf0000000)

	)

270 
	#IN_BADCLASS
(
a
è
	`IN_EXPERIMENTAL
(×))

	)

273 
	#INADDR_ANY
 ((è0x00000000)

	)

276 
	#INADDR_BROADCAST
 ((è0xffffffff)

	)

279 
	#INADDR_NONE
 ((è0xffffffff)

	)

282 
	#IN_LOOPBACKNET
 127

	)

285 
	#INADDR_LOOPBACK
 0x7f000001

	)

286 
	#IN_LOOPBACK
(
a
è((((è×)è& 0xff000000è=ğ0x7f000000)

	)

289 
	#INADDR_UNSPEC_GROUP
 0xe0000000U

	)

290 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

291 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

292 
	#INADDR_MAX_LOCAL_GROUP
 0xe00000ffU

	)

296 
	~<asm/by‹Üd”.h
>

	@/usr/include/linux/in6.h

21 #iâdeà
_LINUX_IN6_H


22 
	#_LINUX_IN6_H


	)

24 
	~<lšux/ty³s.h
>

25 
	~<lšux/libc-com·t.h
>

31 #ià
__UAPI_DEF_IN6_ADDR


32 
	sš6_addr
 {

34 
__u8
 
	mu6_addr8
[16];

35 #ià
__UAPI_DEF_IN6_ADDR_ALT


36 
__be16
 
	mu6_addr16
[8];

37 
__be32
 
	mu6_addr32
[4];

39 } 
	mš6_u
;

40 
	#s6_addr
 
š6_u
.
u6_addr8


	)

41 #ià
__UAPI_DEF_IN6_ADDR_ALT


42 
	#s6_addr16
 
š6_u
.
u6_addr16


	)

43 
	#s6_addr32
 
š6_u
.
u6_addr32


	)

48 #ià
__UAPI_DEF_SOCKADDR_IN6


49 
	ssockaddr_š6
 {

50 
	msš6_çmy
;

51 
__be16
 
	msš6_pÜt
;

52 
__be32
 
	msš6_æowšfo
;

53 
š6_addr
 
	msš6_addr
;

54 
__u32
 
	msš6_scİe_id
;

58 #ià
__UAPI_DEF_IPV6_MREQ


59 
	sv6_m»q
 {

61 
š6_addr
 
	mv6mr_muÉŸddr
;

64 
	mv6mr_ifšdex
;

68 
	#v6mr_aÿddr
 
v6mr_muÉŸddr


	)

70 
	sš6_æowÏb–_»q
 {

71 
š6_addr
 
	mær_d¡
;

72 
__be32
 
	mær_Ïb–
;

73 
__u8
 
	mær_aùiÚ
;

74 
__u8
 
	mær_sh¬e
;

75 
__u16
 
	mær_æags
;

76 
__u16
 
	mær_expœes
;

77 
__u16
 
	mær_lšg”
;

78 
__u32
 
	m__ær_·d
;

82 
	#IPV6_FL_A_GET
 0

	)

83 
	#IPV6_FL_A_PUT
 1

	)

84 
	#IPV6_FL_A_RENEW
 2

	)

86 
	#IPV6_FL_F_CREATE
 1

	)

87 
	#IPV6_FL_F_EXCL
 2

	)

88 
	#IPV6_FL_F_REFLECT
 4

	)

89 
	#IPV6_FL_F_REMOTE
 8

	)

91 
	#IPV6_FL_S_NONE
 0

	)

92 
	#IPV6_FL_S_EXCL
 1

	)

93 
	#IPV6_FL_S_PROCESS
 2

	)

94 
	#IPV6_FL_S_USER
 3

	)

95 
	#IPV6_FL_S_ANY
 255

	)

106 
	#IPV6_FLOWINFO_FLOWLABEL
 0x000fffff

	)

107 
	#IPV6_FLOWINFO_PRIORITY
 0x0ff00000

	)

110 
	#IPV6_PRIORITY_UNCHARACTERIZED
 0x0000

	)

111 
	#IPV6_PRIORITY_FILLER
 0x0100

	)

112 
	#IPV6_PRIORITY_UNATTENDED
 0x0200

	)

113 
	#IPV6_PRIORITY_RESERVED1
 0x0300

	)

114 
	#IPV6_PRIORITY_BULK
 0x0400

	)

115 
	#IPV6_PRIORITY_RESERVED2
 0x0500

	)

116 
	#IPV6_PRIORITY_INTERACTIVE
 0x0600

	)

117 
	#IPV6_PRIORITY_CONTROL
 0x0700

	)

118 
	#IPV6_PRIORITY_8
 0x0800

	)

119 
	#IPV6_PRIORITY_9
 0x0900

	)

120 
	#IPV6_PRIORITY_10
 0x0a00

	)

121 
	#IPV6_PRIORITY_11
 0x0b00

	)

122 
	#IPV6_PRIORITY_12
 0x0c00

	)

123 
	#IPV6_PRIORITY_13
 0x0d00

	)

124 
	#IPV6_PRIORITY_14
 0x0e00

	)

125 
	#IPV6_PRIORITY_15
 0x0f00

	)

130 #ià
__UAPI_DEF_IPPROTO_V6


131 
	#IPPROTO_HOPOPTS
 0

	)

132 
	#IPPROTO_ROUTING
 43

	)

133 
	#IPPROTO_FRAGMENT
 44

	)

134 
	#IPPROTO_ICMPV6
 58

	)

135 
	#IPPROTO_NONE
 59

	)

136 
	#IPPROTO_DSTOPTS
 60

	)

137 
	#IPPROTO_MH
 135

	)

143 
	#IPV6_TLV_PAD1
 0

	)

144 
	#IPV6_TLV_PADN
 1

	)

145 
	#IPV6_TLV_ROUTERALERT
 5

	)

146 
	#IPV6_TLV_JUMBO
 194

	)

147 
	#IPV6_TLV_HAO
 201

	)

152 #ià
__UAPI_DEF_IPV6_OPTIONS


153 
	#IPV6_ADDRFORM
 1

	)

154 
	#IPV6_2292PKTINFO
 2

	)

155 
	#IPV6_2292HOPOPTS
 3

	)

156 
	#IPV6_2292DSTOPTS
 4

	)

157 
	#IPV6_2292RTHDR
 5

	)

158 
	#IPV6_2292PKTOPTIONS
 6

	)

159 
	#IPV6_CHECKSUM
 7

	)

160 
	#IPV6_2292HOPLIMIT
 8

	)

161 
	#IPV6_NEXTHOP
 9

	)

162 
	#IPV6_AUTHHDR
 10

	)

163 
	#IPV6_FLOWINFO
 11

	)

165 
	#IPV6_UNICAST_HOPS
 16

	)

166 
	#IPV6_MULTICAST_IF
 17

	)

167 
	#IPV6_MULTICAST_HOPS
 18

	)

168 
	#IPV6_MULTICAST_LOOP
 19

	)

169 
	#IPV6_ADD_MEMBERSHIP
 20

	)

170 
	#IPV6_DROP_MEMBERSHIP
 21

	)

171 
	#IPV6_ROUTER_ALERT
 22

	)

172 
	#IPV6_MTU_DISCOVER
 23

	)

173 
	#IPV6_MTU
 24

	)

174 
	#IPV6_RECVERR
 25

	)

175 
	#IPV6_V6ONLY
 26

	)

176 
	#IPV6_JOIN_ANYCAST
 27

	)

177 
	#IPV6_LEAVE_ANYCAST
 28

	)

180 
	#IPV6_PMTUDISC_DONT
 0

	)

181 
	#IPV6_PMTUDISC_WANT
 1

	)

182 
	#IPV6_PMTUDISC_DO
 2

	)

183 
	#IPV6_PMTUDISC_PROBE
 3

	)

187 
	#IPV6_PMTUDISC_INTERFACE
 4

	)

191 
	#IPV6_PMTUDISC_OMIT
 5

	)

194 
	#IPV6_FLOWLABEL_MGR
 32

	)

195 
	#IPV6_FLOWINFO_SEND
 33

	)

197 
	#IPV6_IPSEC_POLICY
 34

	)

198 
	#IPV6_XFRM_POLICY
 35

	)

220 
	#IPV6_RECVPKTINFO
 49

	)

221 
	#IPV6_PKTINFO
 50

	)

222 
	#IPV6_RECVHOPLIMIT
 51

	)

223 
	#IPV6_HOPLIMIT
 52

	)

224 
	#IPV6_RECVHOPOPTS
 53

	)

225 
	#IPV6_HOPOPTS
 54

	)

226 
	#IPV6_RTHDRDSTOPTS
 55

	)

227 
	#IPV6_RECVRTHDR
 56

	)

228 
	#IPV6_RTHDR
 57

	)

229 
	#IPV6_RECVDSTOPTS
 58

	)

230 
	#IPV6_DSTOPTS
 59

	)

231 
	#IPV6_RECVPATHMTU
 60

	)

232 
	#IPV6_PATHMTU
 61

	)

233 
	#IPV6_DONTFRAG
 62

	)

235 
	#IPV6_USE_MIN_MTU
 63

	)

251 
	#IPV6_RECVTCLASS
 66

	)

252 
	#IPV6_TCLASS
 67

	)

265 
	#IPV6_AUTOFLOWLABEL
 70

	)

267 
	#IPV6_ADDR_PREFERENCES
 72

	)

269 
	#IPV6_PREFER_SRC_TMP
 0x0001

	)

270 
	#IPV6_PREFER_SRC_PUBLIC
 0x0002

	)

271 
	#IPV6_PREFER_SRC_PUBTMP_DEFAULT
 0x0100

	)

272 
	#IPV6_PREFER_SRC_COA
 0x0004

	)

273 
	#IPV6_PREFER_SRC_HOME
 0x0400

	)

274 
	#IPV6_PREFER_SRC_CGA
 0x0008

	)

275 
	#IPV6_PREFER_SRC_NONCGA
 0x0800

	)

278 
	#IPV6_MINHOPCOUNT
 73

	)

280 
	#IPV6_ORIGDSTADDR
 74

	)

281 
	#IPV6_RECVORIGDSTADDR
 
IPV6_ORIGDSTADDR


	)

282 
	#IPV6_TRANSPARENT
 75

	)

283 
	#IPV6_UNICAST_IF
 76

	)

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<lšux/sysšfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

	@/usr/include/linux/libc-compat.h

48 #iâdeà
_LIBC_COMPAT_H


49 
	#_LIBC_COMPAT_H


	)

52 #ià
defšed
(
__GLIBC__
)

55 #ià
defšed
(
_NET_IF_H
è&& defšed(
__USE_MISC
)

60 
	#__UAPI_DEF_IF_IFCONF
 0

	)

61 
	#__UAPI_DEF_IF_IFMAP
 0

	)

62 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

63 
	#__UAPI_DEF_IF_IFREQ
 0

	)

65 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

67 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


68 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

77 
	#__UAPI_DEF_IF_IFCONF
 1

	)

78 
	#__UAPI_DEF_IF_IFMAP
 1

	)

79 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

80 
	#__UAPI_DEF_IF_IFREQ
 1

	)

82 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

84 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

89 #ià
defšed
(
_NETINET_IN_H
)

93 
	#__UAPI_DEF_IN_ADDR
 0

	)

94 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

95 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

96 
	#__UAPI_DEF_IP_MREQ
 0

	)

97 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

98 
	#__UAPI_DEF_IN_CLASS
 0

	)

100 
	#__UAPI_DEF_IN6_ADDR
 0

	)

105 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

106 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

108 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

110 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

111 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

112 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

113 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

114 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

115 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

122 
	#__UAPI_DEF_IN_ADDR
 1

	)

123 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

124 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

125 
	#__UAPI_DEF_IP_MREQ
 1

	)

126 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

127 
	#__UAPI_DEF_IN_CLASS
 1

	)

129 
	#__UAPI_DEF_IN6_ADDR
 1

	)

132 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

133 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

134 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

135 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

136 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

137 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

138 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

143 #ià
defšed
(
_SYS_XATTR_H
)

144 
	#__UAPI_DEF_XATTR
 0

	)

146 
	#__UAPI_DEF_XATTR
 1

	)

155 
	#__UAPI_DEF_IF_IFCONF
 1

	)

156 
	#__UAPI_DEF_IF_IFMAP
 1

	)

157 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

158 
	#__UAPI_DEF_IF_IFREQ
 1

	)

160 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

162 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

165 
	#__UAPI_DEF_IN_ADDR
 1

	)

166 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

167 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

168 
	#__UAPI_DEF_IP_MREQ
 1

	)

169 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

170 
	#__UAPI_DEF_IN_CLASS
 1

	)

173 
	#__UAPI_DEF_IN6_ADDR
 1

	)

174 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

175 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

176 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

177 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

178 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

179 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

180 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

183 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/linux/sysctl.h

22 #iâdeà
_LINUX_SYSCTL_H


23 
	#_LINUX_SYSCTL_H


	)

25 
	~<lšux/k”Ãl.h
>

26 
	~<lšux/ty³s.h
>

29 
	gcom¶‘iÚ
;

31 
	#CTL_MAXNAME
 10

	)

36 
	s__sysùl_¬gs
 {

37 *
	mÇme
;

38 
	mÆ’
;

39 *
	mŞdv®
;

40 
size_t
 *
	mŞdËÅ
;

41 *
	mÃwv®
;

42 
size_t
 
	mÃwËn
;

43 
	m__unu£d
[4];

52 
	mCTL_KERN
=1,

53 
	mCTL_VM
=2,

54 
	mCTL_NET
=3,

55 
	mCTL_PROC
=4,

56 
	mCTL_FS
=5,

57 
	mCTL_DEBUG
=6,

58 
	mCTL_DEV
=7,

59 
	mCTL_BUS
=8,

60 
	mCTL_ABI
=9,

61 
	mCTL_CPU
=10,

62 
	mCTL_ARLAN
=254,

63 
	mCTL_S390DBF
=5677,

64 
	mCTL_SUNRPC
=7249,

65 
	mCTL_PM
=9899,

66 
	mCTL_FRV
=9898,

72 
	mCTL_BUS_ISA
=1

78 
	mINOTIFY_MAX_USER_INSTANCES
=1,

79 
	mINOTIFY_MAX_USER_WATCHES
=2,

80 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

86 
	mKERN_OSTYPE
=1,

87 
	mKERN_OSRELEASE
=2,

88 
	mKERN_OSREV
=3,

89 
	mKERN_VERSION
=4,

90 
	mKERN_SECUREMASK
=5,

91 
	mKERN_PROF
=6,

92 
	mKERN_NODENAME
=7,

93 
	mKERN_DOMAINNAME
=8,

95 
	mKERN_PANIC
=15,

96 
	mKERN_REALROOTDEV
=16,

98 
	mKERN_SPARC_REBOOT
=21,

99 
	mKERN_CTLALTDEL
=22,

100 
	mKERN_PRINTK
=23,

101 
	mKERN_NAMETRANS
=24,

102 
	mKERN_PPC_HTABRECLAIM
=25,

103 
	mKERN_PPC_ZEROPAGED
=26,

104 
	mKERN_PPC_POWERSAVE_NAP
=27,

105 
	mKERN_MODPROBE
=28,

106 
	mKERN_SG_BIG_BUFF
=29,

107 
	mKERN_ACCT
=30,

108 
	mKERN_PPC_L2CR
=31,

110 
	mKERN_RTSIGNR
=32,

111 
	mKERN_RTSIGMAX
=33,

113 
	mKERN_SHMMAX
=34,

114 
	mKERN_MSGMAX
=35,

115 
	mKERN_MSGMNB
=36,

116 
	mKERN_MSGPOOL
=37,

117 
	mKERN_SYSRQ
=38,

118 
	mKERN_MAX_THREADS
=39,

119 
	mKERN_RANDOM
=40,

120 
	mKERN_SHMALL
=41,

121 
	mKERN_MSGMNI
=42,

122 
	mKERN_SEM
=43,

123 
	mKERN_SPARC_STOP_A
=44,

124 
	mKERN_SHMMNI
=45,

125 
	mKERN_OVERFLOWUID
=46,

126 
	mKERN_OVERFLOWGID
=47,

127 
	mKERN_SHMPATH
=48,

128 
	mKERN_HOTPLUG
=49,

129 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

130 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

131 
	mKERN_CORE_USES_PID
=52,

132 
	mKERN_TAINTED
=53,

133 
	mKERN_CADPID
=54,

134 
	mKERN_PIDMAX
=55,

135 
	mKERN_CORE_PATTERN
=56,

136 
	mKERN_PANIC_ON_OOPS
=57,

137 
	mKERN_HPPA_PWRSW
=58,

138 
	mKERN_HPPA_UNALIGNED
=59,

139 
	mKERN_PRINTK_RATELIMIT
=60,

140 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

141 
	mKERN_PTY
=62,

142 
	mKERN_NGROUPS_MAX
=63,

143 
	mKERN_SPARC_SCONS_PWROFF
=64,

144 
	mKERN_HZ_TIMER
=65,

145 
	mKERN_UNKNOWN_NMI_PANIC
=66,

146 
	mKERN_BOOTLOADER_TYPE
=67,

147 
	mKERN_RANDOMIZE
=68,

148 
	mKERN_SETUID_DUMPABLE
=69,

149 
	mKERN_SPIN_RETRY
=70,

150 
	mKERN_ACPI_VIDEO_FLAGS
=71,

151 
	mKERN_IA64_UNALIGNED
=72,

152 
	mKERN_COMPAT_LOG
=73,

153 
	mKERN_MAX_LOCK_DEPTH
=74,

154 
	mKERN_NMI_WATCHDOG
=75,

155 
	mKERN_PANIC_ON_NMI
=76,

156 
	mKERN_PANIC_ON_WARN
=77,

164 
	mVM_UNUSED1
=1,

165 
	mVM_UNUSED2
=2,

166 
	mVM_UNUSED3
=3,

167 
	mVM_UNUSED4
=4,

168 
	mVM_OVERCOMMIT_MEMORY
=5,

169 
	mVM_UNUSED5
=6,

170 
	mVM_UNUSED7
=7,

171 
	mVM_UNUSED8
=8,

172 
	mVM_UNUSED9
=9,

173 
	mVM_PAGE_CLUSTER
=10,

174 
	mVM_DIRTY_BACKGROUND
=11,

175 
	mVM_DIRTY_RATIO
=12,

176 
	mVM_DIRTY_WB_CS
=13,

177 
	mVM_DIRTY_EXPIRE_CS
=14,

178 
	mVM_NR_PDFLUSH_THREADS
=15,

179 
	mVM_OVERCOMMIT_RATIO
=16,

180 
	mVM_PAGEBUF
=17,

181 
	mVM_HUGETLB_PAGES
=18,

182 
	mVM_SWAPPINESS
=19,

183 
	mVM_LOWMEM_RESERVE_RATIO
=20,

184 
	mVM_MIN_FREE_KBYTES
=21,

185 
	mVM_MAX_MAP_COUNT
=22,

186 
	mVM_LAPTOP_MODE
=23,

187 
	mVM_BLOCK_DUMP
=24,

188 
	mVM_HUGETLB_GROUP
=25,

189 
	mVM_VFS_CACHE_PRESSURE
=26,

190 
	mVM_LEGACY_VA_LAYOUT
=27,

191 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

192 
	mVM_DROP_PAGECACHE
=29,

193 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

194 
	mVM_ZONE_RECLAIM_MODE
=31,

195 
	mVM_MIN_UNMAPPED
=32,

196 
	mVM_PANIC_ON_OOM
=33,

197 
	mVM_VDSO_ENABLED
=34,

198 
	mVM_MIN_SLAB
=35,

205 
	mNET_CORE
=1,

206 
	mNET_ETHER
=2,

207 
	mNET_802
=3,

208 
	mNET_UNIX
=4,

209 
	mNET_IPV4
=5,

210 
	mNET_IPX
=6,

211 
	mNET_ATALK
=7,

212 
	mNET_NETROM
=8,

213 
	mNET_AX25
=9,

214 
	mNET_BRIDGE
=10,

215 
	mNET_ROSE
=11,

216 
	mNET_IPV6
=12,

217 
	mNET_X25
=13,

218 
	mNET_TR
=14,

219 
	mNET_DECNET
=15,

220 
	mNET_ECONET
=16,

221 
	mNET_SCTP
=17,

222 
	mNET_LLC
=18,

223 
	mNET_NETFILTER
=19,

224 
	mNET_DCCP
=20,

225 
	mNET_IRDA
=412,

231 
	mRANDOM_POOLSIZE
=1,

232 
	mRANDOM_ENTROPY_COUNT
=2,

233 
	mRANDOM_READ_THRESH
=3,

234 
	mRANDOM_WRITE_THRESH
=4,

235 
	mRANDOM_BOOT_ID
=5,

236 
	mRANDOM_UUID
=6

242 
	mPTY_MAX
=1,

243 
	mPTY_NR
=2

249 
	mBUS_ISA_MEM_BASE
=1,

250 
	mBUS_ISA_PORT_BASE
=2,

251 
	mBUS_ISA_PORT_SHIFT
=3

257 
	mNET_CORE_WMEM_MAX
=1,

258 
	mNET_CORE_RMEM_MAX
=2,

259 
	mNET_CORE_WMEM_DEFAULT
=3,

260 
	mNET_CORE_RMEM_DEFAULT
=4,

262 
	mNET_CORE_MAX_BACKLOG
=6,

263 
	mNET_CORE_FASTROUTE
=7,

264 
	mNET_CORE_MSG_COST
=8,

265 
	mNET_CORE_MSG_BURST
=9,

266 
	mNET_CORE_OPTMEM_MAX
=10,

267 
	mNET_CORE_HOT_LIST_LENGTH
=11,

268 
	mNET_CORE_DIVERT_VERSION
=12,

269 
	mNET_CORE_NO_CONG_THRESH
=13,

270 
	mNET_CORE_NO_CONG
=14,

271 
	mNET_CORE_LO_CONG
=15,

272 
	mNET_CORE_MOD_CONG
=16,

273 
	mNET_CORE_DEV_WEIGHT
=17,

274 
	mNET_CORE_SOMAXCONN
=18,

275 
	mNET_CORE_BUDGET
=19,

276 
	mNET_CORE_AEVENT_ETIME
=20,

277 
	mNET_CORE_AEVENT_RSEQTH
=21,

278 
	mNET_CORE_WARNINGS
=22,

289 
	mNET_UNIX_DESTROY_DELAY
=1,

290 
	mNET_UNIX_DELETE_DELAY
=2,

291 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

297 
	mNET_NF_CONNTRACK_MAX
=1,

298 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

299 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

300 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

301 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

304 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

305 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

306 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

307 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

308 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

309 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

310 
	mNET_NF_CONNTRACK_BUCKETS
=14,

311 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

312 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

313 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

314 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

315 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

316 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

317 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

318 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

319 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

321 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

322 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

323 
	mNET_NF_CONNTRACK_COUNT
=27,

324 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

325 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

326 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

327 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

328 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

335 
	mNET_IPV4_FORWARD
=8,

336 
	mNET_IPV4_DYNADDR
=9,

338 
	mNET_IPV4_CONF
=16,

339 
	mNET_IPV4_NEIGH
=17,

340 
	mNET_IPV4_ROUTE
=18,

341 
	mNET_IPV4_FIB_HASH
=19,

342 
	mNET_IPV4_NETFILTER
=20,

344 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

345 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

346 
	mNET_IPV4_TCP_SACK
=35,

347 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

348 
	mNET_IPV4_DEFAULT_TTL
=37,

349 
	mNET_IPV4_AUTOCONFIG
=38,

350 
	mNET_IPV4_NO_PMTU_DISC
=39,

351 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

352 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

353 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

354 
	mNET_IPV4_IPFRAG_TIME
=43,

355 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

356 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

357 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

358 
	mNET_IPV4_TCP_RETRIES1
=47,

359 
	mNET_IPV4_TCP_RETRIES2
=48,

360 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

361 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

362 
	mNET_TCP_SYNCOOKIES
=51,

363 
	mNET_TCP_STDURG
=52,

364 
	mNET_TCP_RFC1337
=53,

365 
	mNET_TCP_SYN_TAILDROP
=54,

366 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

367 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

368 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

369 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

370 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

371 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

372 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

373 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

374 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

375 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

376 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

377 
	mNET_TCP_TW_RECYCLE
=66,

378 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

379 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

380 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

381 
	mNET_IPV4_INET_PEER_MINTTL
=70,

382 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

383 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

384 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

385 
	mNET_TCP_ORPHAN_RETRIES
=74,

386 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

387 
	mNET_TCP_SYNACK_RETRIES
=76,

388 
	mNET_TCP_MAX_ORPHANS
=77,

389 
	mNET_TCP_MAX_TW_BUCKETS
=78,

390 
	mNET_TCP_FACK
=79,

391 
	mNET_TCP_REORDERING
=80,

392 
	mNET_TCP_ECN
=81,

393 
	mNET_TCP_DSACK
=82,

394 
	mNET_TCP_MEM
=83,

395 
	mNET_TCP_WMEM
=84,

396 
	mNET_TCP_RMEM
=85,

397 
	mNET_TCP_APP_WIN
=86,

398 
	mNET_TCP_ADV_WIN_SCALE
=87,

399 
	mNET_IPV4_NONLOCAL_BIND
=88,

400 
	mNET_IPV4_ICMP_RATELIMIT
=89,

401 
	mNET_IPV4_ICMP_RATEMASK
=90,

402 
	mNET_TCP_TW_REUSE
=91,

403 
	mNET_TCP_FRTO
=92,

404 
	mNET_TCP_LOW_LATENCY
=93,

405 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

406 
	mNET_IPV4_IGMP_MAX_MSF
=96,

407 
	mNET_TCP_NO_METRICS_SAVE
=97,

408 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

409 
	mNET_TCP_MODERATE_RCVBUF
=106,

410 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

411 
	mNET_TCP_BIC_BETA
=108,

412 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

413 
	mNET_TCP_CONG_CONTROL
=110,

414 
	mNET_TCP_ABC
=111,

415 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

416 
	mNET_TCP_MTU_PROBING
=113,

417 
	mNET_TCP_BASE_MSS
=114,

418 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

419 
	mNET_TCP_DMA_COPYBREAK
=116,

420 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

421 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

422 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

423 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

424 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

425 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

426 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

427 
	mNET_TCP_MAX_SSTHRESH
=124,

428 
	mNET_TCP_FRTO_RESPONSE
=125,

432 
	mNET_IPV4_ROUTE_FLUSH
=1,

433 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

434 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

435 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

436 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

437 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

438 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

439 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

440 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

441 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

442 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

443 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

444 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

445 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

446 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

447 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

448 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

449 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

450 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

455 
	mNET_PROTO_CONF_ALL
=-2,

456 
	mNET_PROTO_CONF_DEFAULT
=-3

463 
	mNET_IPV4_CONF_FORWARDING
=1,

464 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

465 
	mNET_IPV4_CONF_PROXY_ARP
=3,

466 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

467 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

468 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

469 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

470 
	mNET_IPV4_CONF_RP_FILTER
=8,

471 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

472 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

473 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

474 
	mNET_IPV4_CONF_TAG
=12,

475 
	mNET_IPV4_CONF_ARPFILTER
=13,

476 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

477 
	mNET_IPV4_CONF_NOXFRM
=15,

478 
	mNET_IPV4_CONF_NOPOLICY
=16,

479 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

480 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

481 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

482 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

483 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

484 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

490 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

491 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

492 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

493 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

494 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

497 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

498 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

499 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

500 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

501 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

502 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

503 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

504 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

505 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

506 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

507 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

508 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

509 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

510 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

511 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

512 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

514 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

515 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

516 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

517 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

522 
	mNET_IPV6_CONF
=16,

523 
	mNET_IPV6_NEIGH
=17,

524 
	mNET_IPV6_ROUTE
=18,

525 
	mNET_IPV6_ICMP
=19,

526 
	mNET_IPV6_BINDV6ONLY
=20,

527 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

528 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

529 
	mNET_IPV6_IP6FRAG_TIME
=23,

530 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

531 
	mNET_IPV6_MLD_MAX_MSF
=25,

535 
	mNET_IPV6_ROUTE_FLUSH
=1,

536 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

537 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

538 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

539 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

540 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

541 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

542 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

543 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

544 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

548 
	mNET_IPV6_FORWARDING
=1,

549 
	mNET_IPV6_HOP_LIMIT
=2,

550 
	mNET_IPV6_MTU
=3,

551 
	mNET_IPV6_ACCEPT_RA
=4,

552 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

553 
	mNET_IPV6_AUTOCONF
=6,

554 
	mNET_IPV6_DAD_TRANSMITS
=7,

555 
	mNET_IPV6_RTR_SOLICITS
=8,

556 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

557 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

558 
	mNET_IPV6_USE_TEMPADDR
=11,

559 
	mNET_IPV6_TEMP_VALID_LFT
=12,

560 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

561 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

562 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

563 
	mNET_IPV6_MAX_ADDRESSES
=16,

564 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

565 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

566 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

567 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

568 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

569 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

570 
	mNET_IPV6_PROXY_NDP
=23,

571 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

572 
	mNET_IPV6_ACCEPT_RA_FROM_LOCAL
=26,

573 
	m__NET_IPV6_MAX


578 
	mNET_IPV6_ICMP_RATELIMIT
=1

583 
	mNET_NEIGH_MCAST_SOLICIT
=1,

584 
	mNET_NEIGH_UCAST_SOLICIT
=2,

585 
	mNET_NEIGH_APP_SOLICIT
=3,

586 
	mNET_NEIGH_RETRANS_TIME
=4,

587 
	mNET_NEIGH_REACHABLE_TIME
=5,

588 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

589 
	mNET_NEIGH_GC_STALE_TIME
=7,

590 
	mNET_NEIGH_UNRES_QLEN
=8,

591 
	mNET_NEIGH_PROXY_QLEN
=9,

592 
	mNET_NEIGH_ANYCAST_DELAY
=10,

593 
	mNET_NEIGH_PROXY_DELAY
=11,

594 
	mNET_NEIGH_LOCKTIME
=12,

595 
	mNET_NEIGH_GC_INTERVAL
=13,

596 
	mNET_NEIGH_GC_THRESH1
=14,

597 
	mNET_NEIGH_GC_THRESH2
=15,

598 
	mNET_NEIGH_GC_THRESH3
=16,

599 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

600 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

605 
	mNET_DCCP_DEFAULT
=1,

610 
	mNET_IPX_PPROP_BROADCASTING
=1,

611 
	mNET_IPX_FORWARDING
=2

616 
	mNET_LLC2
=1,

617 
	mNET_LLC_STATION
=2,

622 
	mNET_LLC2_TIMEOUT
=1,

627 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

632 
	mNET_LLC2_ACK_TIMEOUT
=1,

633 
	mNET_LLC2_P_TIMEOUT
=2,

634 
	mNET_LLC2_REJ_TIMEOUT
=3,

635 
	mNET_LLC2_BUSY_TIMEOUT
=4,

640 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

641 
	mNET_ATALK_AARP_TICK_TIME
=2,

642 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

643 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

649 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

650 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

651 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

652 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

653 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

654 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

655 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

656 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

657 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

658 
	mNET_NETROM_ROUTING_CONTROL
=10,

659 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

660 
	mNET_NETROM_RESET
=12

665 
	mNET_AX25_IP_DEFAULT_MODE
=1,

666 
	mNET_AX25_DEFAULT_MODE
=2,

667 
	mNET_AX25_BACKOFF_TYPE
=3,

668 
	mNET_AX25_CONNECT_MODE
=4,

669 
	mNET_AX25_STANDARD_WINDOW
=5,

670 
	mNET_AX25_EXTENDED_WINDOW
=6,

671 
	mNET_AX25_T1_TIMEOUT
=7,

672 
	mNET_AX25_T2_TIMEOUT
=8,

673 
	mNET_AX25_T3_TIMEOUT
=9,

674 
	mNET_AX25_IDLE_TIMEOUT
=10,

675 
	mNET_AX25_N2
=11,

676 
	mNET_AX25_PACLEN
=12,

677 
	mNET_AX25_PROTOCOL
=13,

678 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

683 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

684 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

685 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

686 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

687 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

688 
	mNET_ROSE_ROUTING_CONTROL
=6,

689 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

690 
	mNET_ROSE_MAX_VCS
=8,

691 
	mNET_ROSE_WINDOW_SIZE
=9,

692 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

697 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

698 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

699 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

700 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

701 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

702 
	mNET_X25_FORWARD
=6

708 
	mNET_TR_RIF_TIMEOUT
=1

713 
	mNET_DECNET_NODE_TYPE
 = 1,

714 
	mNET_DECNET_NODE_ADDRESS
 = 2,

715 
	mNET_DECNET_NODE_NAME
 = 3,

716 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

717 
	mNET_DECNET_TIME_WAIT
 = 5,

718 
	mNET_DECNET_DN_COUNT
 = 6,

719 
	mNET_DECNET_DI_COUNT
 = 7,

720 
	mNET_DECNET_DR_COUNT
 = 8,

721 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

722 
	mNET_DECNET_CONF
 = 10,

723 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

724 
	mNET_DECNET_MEM
 = 12,

725 
	mNET_DECNET_RMEM
 = 13,

726 
	mNET_DECNET_WMEM
 = 14,

727 
	mNET_DECNET_DEBUG_LEVEL
 = 255

732 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

733 
	mNET_DECNET_CONF_DDCMP
 = -3,

734 
	mNET_DECNET_CONF_PPP
 = -4,

735 
	mNET_DECNET_CONF_X25
 = -5,

736 
	mNET_DECNET_CONF_GRE
 = -6,

737 
	mNET_DECNET_CONF_ETHER
 = -7

744 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

745 
	mNET_DECNET_CONF_DEV_T1
 = 2,

746 
	mNET_DECNET_CONF_DEV_T2
 = 3,

747 
	mNET_DECNET_CONF_DEV_T3
 = 4,

748 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

749 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

750 
	mNET_DECNET_CONF_DEV_STATE
 = 7

755 
	mNET_SCTP_RTO_INITIAL
 = 1,

756 
	mNET_SCTP_RTO_MIN
 = 2,

757 
	mNET_SCTP_RTO_MAX
 = 3,

758 
	mNET_SCTP_RTO_ALPHA
 = 4,

759 
	mNET_SCTP_RTO_BETA
 = 5,

760 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

761 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

762 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

763 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

764 
	mNET_SCTP_HB_INTERVAL
 = 10,

765 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

766 
	mNET_SCTP_MAX_BURST
 = 12,

767 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

768 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

769 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

770 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

771 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

776 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

777 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

778 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

779 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

780 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

785 
	mNET_IRDA_DISCOVERY
=1,

786 
	mNET_IRDA_DEVNAME
=2,

787 
	mNET_IRDA_DEBUG
=3,

788 
	mNET_IRDA_FAST_POLL
=4,

789 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

790 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

791 
	mNET_IRDA_SLOT_TIMEOUT
=7,

792 
	mNET_IRDA_MAX_BAUD_RATE
=8,

793 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

794 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

795 
	mNET_IRDA_MAX_TX_WINDOW
=11,

796 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

797 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

798 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

805 
	mFS_NRINODE
=1,

806 
	mFS_STATINODE
=2,

807 
	mFS_MAXINODE
=3,

808 
	mFS_NRDQUOT
=4,

809 
	mFS_MAXDQUOT
=5,

810 
	mFS_NRFILE
=6,

811 
	mFS_MAXFILE
=7,

812 
	mFS_DENTRY
=8,

813 
	mFS_NRSUPER
=9,

814 
	mFS_MAXSUPER
=10,

815 
	mFS_OVERFLOWUID
=11,

816 
	mFS_OVERFLOWGID
=12,

817 
	mFS_LEASES
=13,

818 
	mFS_DIR_NOTIFY
=14,

819 
	mFS_LEASE_TIME
=15,

820 
	mFS_DQSTATS
=16,

821 
	mFS_XFS
=17,

822 
	mFS_AIO_NR
=18,

823 
	mFS_AIO_MAX_NR
=19,

824 
	mFS_INOTIFY
=20,

825 
	mFS_OCFS2
=988,

830 
	mFS_DQ_LOOKUPS
 = 1,

831 
	mFS_DQ_DROPS
 = 2,

832 
	mFS_DQ_READS
 = 3,

833 
	mFS_DQ_WRITES
 = 4,

834 
	mFS_DQ_CACHE_HITS
 = 5,

835 
	mFS_DQ_ALLOCATED
 = 6,

836 
	mFS_DQ_FREE
 = 7,

837 
	mFS_DQ_SYNCS
 = 8,

838 
	mFS_DQ_WARNINGS
 = 9,

845 
	mDEV_CDROM
=1,

846 
	mDEV_HWMON
=2,

847 
	mDEV_PARPORT
=3,

848 
	mDEV_RAID
=4,

849 
	mDEV_MAC_HID
=5,

850 
	mDEV_SCSI
=6,

851 
	mDEV_IPMI
=7,

856 
	mDEV_CDROM_INFO
=1,

857 
	mDEV_CDROM_AUTOCLOSE
=2,

858 
	mDEV_CDROM_AUTOEJECT
=3,

859 
	mDEV_CDROM_DEBUG
=4,

860 
	mDEV_CDROM_LOCK
=5,

861 
	mDEV_CDROM_CHECK_MEDIA
=6

866 
	mDEV_PARPORT_DEFAULT
=-3

871 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

872 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

877 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

878 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

883 
	mDEV_PARPORT_SPINTIME
=1,

884 
	mDEV_PARPORT_BASE_ADDR
=2,

885 
	mDEV_PARPORT_IRQ
=3,

886 
	mDEV_PARPORT_DMA
=4,

887 
	mDEV_PARPORT_MODES
=5,

888 
	mDEV_PARPORT_DEVICES
=6,

889 
	mDEV_PARPORT_AUTOPROBE
=16

894 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

899 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

904 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

905 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

906 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

907 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

908 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

909 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

914 
	mDEV_SCSI_LOGGING_LEVEL
=1,

919 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

925 
	mABI_DEFHANDLER_COFF
=1,

926 
	mABI_DEFHANDLER_ELF
=2,

927 
	mABI_DEFHANDLER_LCALL7
=3,

928 
	mABI_DEFHANDLER_LIBCSO
=4,

929 
	mABI_TRACE
=5,

930 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/rpc/netdb.h

36 #iâdeà
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<ã©u»s.h
>

41 
	#__Ãed_size_t


	)

42 
	~<¡ddef.h
>

44 
__BEGIN_DECLS


46 
	s½ûÁ


48 *
	mr_Çme
;

49 **
	mr_®Ÿ£s
;

50 
	mr_numb”
;

53 
	$£ŒpûÁ
 (
__¡ayİ’
è
__THROW
;

54 
	$’d½ûÁ
 (è
__THROW
;

55 
½ûÁ
 *
	$g‘½cbyÇme
 (cÚ¡ *
__Çme
è
__THROW
;

56 
½ûÁ
 *
	$g‘½cbynumb”
 (
__numb”
è
__THROW
;

57 
½ûÁ
 *
	$g‘½ûÁ
 (è
__THROW
;

59 #ifdeà
__USE_MISC


60 
	$g‘½cbyÇme_r
 (cÚ¡ *
__Çme
, 
½ûÁ
 *
__»suÉ_buf
,

61 *
__bufãr
, 
size_t
 
__buæ’
,

62 
½ûÁ
 **
__»suÉ
è
__THROW
;

64 
	$g‘½cbynumb”_r
 (
__numb”
, 
½ûÁ
 *
__»suÉ_buf
,

65 *
__bufãr
, 
size_t
 
__buæ’
,

66 
½ûÁ
 **
__»suÉ
è
__THROW
;

68 
	$g‘½ûÁ_r
 (
½ûÁ
 *
__»suÉ_buf
, *
__bufãr
,

69 
size_t
 
__buæ’
, 
½ûÁ
 **
__»suÉ
è
__THROW
;

72 
__END_DECLS


	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

54 
	#__STDC_ISO_10646__
 201103L

	)

57 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/xlocale.h

20 #iâdeà
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__loÿË_¡ruù


30 
__loÿË_d©a
 *
	m__loÿËs
[13];

33 cÚ¡ *
	m__ùy³_b
;

34 cÚ¡ *
	m__ùy³_tŞow”
;

35 cÚ¡ *
	m__ùy³_touµ”
;

38 cÚ¡ *
	m__Çmes
[13];

39 } *
	t__loÿË_t
;

42 
__loÿË_t
 
	tloÿË_t
;

	@/usr/include/_G_config.h

4 #iâdeà
_G_cÚfig_h


5 
	#_G_cÚfig_h
 1

	)

9 
	~<b™s/ty³s.h
>

10 
	#__Ãed_size_t


	)

11 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


12 
	#__Ãed_wch¬_t


	)

14 
	#__Ãed_NULL


	)

15 
	~<¡ddef.h
>

16 
	#__Ãed_mb¡©e_t


	)

17 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


18 
	#__Ãed_wšt_t


	)

20 
	~<wch¬.h
>

23 
__off_t
 
	m__pos
;

24 
__mb¡©e_t
 
	m__¡©e
;

25 } 
	t_G_åos_t
;

28 
__off64_t
 
	m__pos
;

29 
__mb¡©e_t
 
	m__¡©e
;

30 } 
	t_G_åos64_t
;

31 #ià
defšed
 
_LIBC
 || defšed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcÚv.h
>

35 
__gcÚv_šfo
 
	m__cd
;

38 
__gcÚv_šfo
 
	m__cd
;

39 
__gcÚv_¡•_d©a
 
	m__d©a
;

40 } 
	m__combšed
;

41 } 
	t_G_icÚv_t
;

46 
	#_G_va_li¡
 
__gnuc_va_li¡


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defšed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/linux/stddef.h

	@/usr/include/linux/sysinfo.h

1 #iâdeà
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysšfo
 {

8 
__k”Ãl_lÚg_t
 
	mu±ime
;

9 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

10 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

11 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

12 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

13 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

14 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

15 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

16 
__u16
 
	m´ocs
;

17 
__u16
 
	m·d
;

18 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

19 
__k”Ãl_ulÚg_t
 
	mä“high
;

20 
__u32
 
	mmem_un™
;

21 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/gconv.h

22 #iâdeà
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<ã©u»s.h
>

26 
	#__Ãed_mb¡©e_t


	)

27 
	#__Ãed_wšt_t


	)

28 
	~<wch¬.h
>

29 
	#__Ãed_size_t


	)

30 
	#__Ãed_wch¬_t


	)

31 
	~<¡ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch¬_t
è0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004

64 
	g__gcÚv_¡•
;

65 
	g__gcÚv_¡•_d©a
;

66 
	g__gcÚv_lßded_objeù
;

67 
	g__gcÚv_Œªs_d©a
;

71 (*
	t__gcÚv_fù
è(
	t__gcÚv_¡•
 *, 
	t__gcÚv_¡•_d©a
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wšt_t
 (*
	t__gcÚv_btowc_fù
è(
	t__gcÚv_¡•
 *, );

79 (*
	t__gcÚv_š™_fù
è(
	t__gcÚv_¡•
 *);

80 (*
	t__gcÚv_’d_fù
è(
	t__gcÚv_¡•
 *);

84 (*
	t__gcÚv_Œªs_fù
è(
	t__gcÚv_¡•
 *,

85 
	t__gcÚv_¡•_d©a
 *, *,

89 
	tsize_t
 *);

92 (*
	t__gcÚv_Œªs_cÚ‹xt_fù
) (*, const *,

97 (*
	t__gcÚv_Œªs_qu”y_fù
) (const *, const ***,

98 
	tsize_t
 *);

101 (*
	t__gcÚv_Œªs_š™_fù
) (**, const *);

102 (*
	t__gcÚv_Œªs_’d_fù
) (*);

104 
	s__gcÚv_Œªs_d©a


107 
__gcÚv_Œªs_fù
 
__Œªs_fù
;

108 
__gcÚv_Œªs_cÚ‹xt_fù
 
__Œªs_cÚ‹xt_fù
;

109 
__gcÚv_Œªs_’d_fù
 
__Œªs_’d_fù
;

110 *
__d©a
;

111 
__gcÚv_Œªs_d©a
 *
__Ãxt
;

116 
	s__gcÚv_¡•


118 
__gcÚv_lßded_objeù
 *
__shlib_hªdË
;

119 cÚ¡ *
__modÇme
;

121 
__couÁ”
;

123 *
__äom_Çme
;

124 *
__to_Çme
;

126 
__gcÚv_fù
 
__fù
;

127 
__gcÚv_btowc_fù
 
__btowc_fù
;

128 
__gcÚv_š™_fù
 
__š™_fù
;

129 
__gcÚv_’d_fù
 
__’d_fù
;

133 
__mš_Ãeded_äom
;

134 
__max_Ãeded_äom
;

135 
__mš_Ãeded_to
;

136 
__max_Ãeded_to
;

139 
__¡©eful
;

141 *
__d©a
;

146 
	s__gcÚv_¡•_d©a


148 *
__outbuf
;

149 *
__outbuãnd
;

153 
__æags
;

157 
__švoÿtiÚ_couÁ”
;

161 
__š‹º®_u£
;

163 
__mb¡©e_t
 *
__¡©•
;

164 
__mb¡©e_t
 
__¡©e
;

168 
__gcÚv_Œªs_d©a
 *
__Œªs
;

173 
	s__gcÚv_šfo


175 
size_t
 
__n¡•s
;

176 
__gcÚv_¡•
 *
__¡•s
;

177 
__ex‹nsiÚ__
 
__gcÚv_¡•_d©a
 
__d©a
 
__æex¬r
;

178 } *
	t__gcÚv_t
;

	@/usr/include/wchar.h

23 #iâdeà
_WCHAR_H


25 #ià!
defšed
 
__Ãed_mb¡©e_t
 && !defšed 
__Ãed_wšt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<ã©u»s.h
>

30 #ifdeà
_WCHAR_H


32 
	#__Ãed___FILE


	)

33 #ià
defšed
 
__USE_UNIX98
 || defšed 
__USE_XOPEN2K


34 
	#__Ãed_FILE


	)

36 
	~<¡dio.h
>

38 
	#__Ãed___va_li¡


	)

39 
	~<¡d¬g.h
>

41 
	~<b™s/wch¬.h
>

44 
	#__Ãed_size_t


	)

45 
	#__Ãed_wch¬_t


	)

46 
	#__Ãed_NULL


	)

48 #ià
defšed
 
_WCHAR_H
 || defšed 
__Ãed_wšt_t
 || !defšed 
__WINT_TYPE__


49 #undeà
__Ãed_wšt_t


50 
	#__Ãed_wšt_t


	)

51 
	~<¡ddef.h
>

55 #iâdeà
_WINT_T


60 
	#_WINT_T


	)

61 
	twšt_t
;

65 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defšed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twšt_t
;

69 
	g__END_NAMESPACE_STD


74 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #ià(
defšed
 
_WCHAR_H
 || defšed 
__Ãed_mb¡©e_t
è&& !defšed 
____mb¡©e_t_defšed


80 
	#____mb¡©e_t_defšed
 1

	)

84 
	m__couÁ
;

87 #ifdeà
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wšt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__v®ue
;

94 } 
	t__mb¡©e_t
;

96 #undeà
__Ãed_mb¡©e_t


101 #ifdeà
_WCHAR_H


103 #iâdeà
__mb¡©e_t_defšed


104 
__BEGIN_NAMESPACE_C99


106 
__mb¡©e_t
 
	tmb¡©e_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mb¡©e_t_defšed
 1

	)

111 #ifdeà
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mb¡©e_t
)

115 #iâdeà
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #iâdeà
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #ià
defšed
 
__USE_XOPEN
 && !defšed 
__USE_UNIX98


128 
	~<wùy³.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch¬_t
 *
	$wcsıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

148 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

150 
wch¬_t
 *
	$wc¢ıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

151 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

152 
__THROW
;

155 
wch¬_t
 *
	$wcsÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

156 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

158 
wch¬_t
 *
	$wc¢ÿt
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

159 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

160 
__THROW
;

163 
	$wcscmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
)

164 
__THROW
 
__©Œibu‹_pu»__
;

166 
	$wc¢cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

167 
__THROW
 
__©Œibu‹_pu»__
;

168 
__END_NAMESPACE_STD


170 #ifdeà
__USE_XOPEN2K8


172 
	$wcsÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

175 
	$wc¢ÿ£cmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

176 
size_t
 
__n
è
__THROW
;

180 
	~<xloÿË.h
>

182 
	$wcsÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

183 
__loÿË_t
 
__loc
è
__THROW
;

185 
	$wc¢ÿ£cmp_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

186 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

189 
__BEGIN_NAMESPACE_STD


192 
	$wcscŞl
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
è
__THROW
;

196 
size_t
 
	$wcsxäm
 (
wch¬_t
 *
__»¡riù
 
__s1
,

197 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

198 
__END_NAMESPACE_STD


200 #ifdeà
__USE_XOPEN2K8


206 
	$wcscŞl_l
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

207 
__loÿË_t
 
__loc
è
__THROW
;

212 
size_t
 
	$wcsxäm_l
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
,

213 
size_t
 
__n
, 
__loÿË_t
 
__loc
è
__THROW
;

216 
wch¬_t
 *
	$wcsdup
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_m®loc__
;

219 
__BEGIN_NAMESPACE_STD


221 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


222 "C++" 
wch¬_t
 *
	$wcschr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

223 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

224 "C++" cÚ¡ 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

225 
__THROW
 
	`__asm
 ("wcschr"è
__©Œibu‹_pu»__
;

227 
wch¬_t
 *
	$wcschr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

228 
__THROW
 
__©Œibu‹_pu»__
;

231 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


232 "C++" 
wch¬_t
 *
	$wc¤chr
 (
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

233 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

234 "C++" cÚ¡ 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

235 
__THROW
 
	`__asm
 ("wc¤chr"è
__©Œibu‹_pu»__
;

237 
wch¬_t
 *
	$wc¤chr
 (cÚ¡ 
wch¬_t
 *
__wcs
, wch¬_ˆ
__wc
)

238 
__THROW
 
__©Œibu‹_pu»__
;

240 
__END_NAMESPACE_STD


242 #ifdeà
__USE_GNU


245 
wch¬_t
 *
	$wcschºul
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__wc
)

246 
__THROW
 
__©Œibu‹_pu»__
;

249 
__BEGIN_NAMESPACE_STD


252 
size_t
 
	$wcsc¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__»jeù
)

253 
__THROW
 
__©Œibu‹_pu»__
;

256 
size_t
 
	$wcs¥n
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

257 
__THROW
 
__©Œibu‹_pu»__
;

259 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


260 "C++" 
wch¬_t
 *
	$wc¥brk
 (
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

261 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

262 "C++" cÚ¡ 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
,

263 cÚ¡ 
wch¬_t
 *
__acû±
)

264 
__THROW
 
	`__asm
 ("wc¥brk"è
__©Œibu‹_pu»__
;

266 
wch¬_t
 *
	$wc¥brk
 (cÚ¡ 
wch¬_t
 *
__wcs
, cÚ¡ wch¬_ˆ*
__acû±
)

267 
__THROW
 
__©Œibu‹_pu»__
;

270 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


271 "C++" 
wch¬_t
 *
	$wcs¡r
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

272 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

273 "C++" cÚ¡ 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

274 cÚ¡ 
wch¬_t
 *
__ÃedË
)

275 
__THROW
 
	`__asm
 ("wcs¡r"è
__©Œibu‹_pu»__
;

277 
wch¬_t
 *
	$wcs¡r
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

278 
__THROW
 
__©Œibu‹_pu»__
;

282 
wch¬_t
 *
	$wc¡ok
 (
wch¬_t
 *
__»¡riù
 
__s
,

283 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__d–im
,

284 
wch¬_t
 **
__»¡riù
 
__±r
è
__THROW
;

287 
size_t
 
	$wc¦’
 (cÚ¡ 
wch¬_t
 *
__s
è
__THROW
 
__©Œibu‹_pu»__
;

288 
__END_NAMESPACE_STD


290 #ifdeà
__USE_XOPEN


292 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


293 "C++" 
wch¬_t
 *
	$wcswcs
 (
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

294 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

295 "C++" cÚ¡ 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
,

296 cÚ¡ 
wch¬_t
 *
__ÃedË
)

297 
__THROW
 
	`__asm
 ("wcswcs"è
__©Œibu‹_pu»__
;

299 
wch¬_t
 *
	$wcswcs
 (cÚ¡ 
wch¬_t
 *
__hay¡ack
, cÚ¡ wch¬_ˆ*
__ÃedË
)

300 
__THROW
 
__©Œibu‹_pu»__
;

304 #ifdeà
__USE_XOPEN2K8


306 
size_t
 
	$wc¢Ën
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__maxËn
)

307 
__THROW
 
__©Œibu‹_pu»__
;

311 
__BEGIN_NAMESPACE_STD


313 #ifdeà
__CORRECT_ISO_CPP_WCHAR_H_PROTO


314 "C++" 
wch¬_t
 *
	$wmemchr
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

315 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

316 "C++" cÚ¡ 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
,

317 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"è
__©Œibu‹_pu»__
;

320 
wch¬_t
 *
	$wmemchr
 (cÚ¡ 
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
)

321 
__THROW
 
__©Œibu‹_pu»__
;

325 
	$wmemcmp
 (cÚ¡ 
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

326 
__THROW
 
__©Œibu‹_pu»__
;

329 
wch¬_t
 *
	$wmemıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

330 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
è
__THROW
;

334 
wch¬_t
 *
	$wmemmove
 (
wch¬_t
 *
__s1
, cÚ¡ wch¬_ˆ*
__s2
, 
size_t
 
__n
)

335 
__THROW
;

338 
wch¬_t
 *
	$wmem£t
 (
wch¬_t
 *
__s
, wch¬_ˆ
__c
, 
size_t
 
__n
è
__THROW
;

339 
__END_NAMESPACE_STD


341 #ifdeà
__USE_GNU


344 
wch¬_t
 *
	$wmempıy
 (
wch¬_t
 *
__»¡riù
 
__s1
,

345 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s2
, 
size_t
 
__n
)

346 
__THROW
;

350 
__BEGIN_NAMESPACE_STD


353 
wšt_t
 
	$btowc
 (
__c
è
__THROW
;

357 
	$wùob
 (
wšt_t
 
__c
è
__THROW
;

361 
	$mbsš™
 (cÚ¡ 
mb¡©e_t
 *
__ps
è
__THROW
 
__©Œibu‹_pu»__
;

365 
size_t
 
	$mb¹owc
 (
wch¬_t
 *
__»¡riù
 
__pwc
,

366 cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

367 
mb¡©e_t
 *
__»¡riù
 
__p
è
__THROW
;

370 
size_t
 
	$wütomb
 (*
__»¡riù
 
__s
, 
wch¬_t
 
__wc
,

371 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

374 
size_t
 
	$__mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

375 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

376 
size_t
 
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

377 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

378 
__END_NAMESPACE_STD


380 #ifdeà
__USE_EXTERN_INLINES


386 
wšt_t
 
	$__btowc_®Ÿs
 (
__c
è
	`__asm
 ("btowc");

387 
__ex‹º_šlše
 
wšt_t


388 
	`__NTH
 (
	$btowc
 (
__c
))

389 {  (
	`__butš_cÚ¡ªt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

390 ? (
wšt_t
è
__c
 : 
	`__btowc_®Ÿs
 (__c)); 
	}
}

392 
	$__wùob_®Ÿs
 (
wšt_t
 
__c
è
	`__asm
 ("wctob");

393 
__ex‹º_šlše
 

394 
	`__NTH
 (
	$wùob
 (
wšt_t
 
__wc
))

395 {  (
	`__butš_cÚ¡ªt_p
 (
__wc
è&& __wø>ğ
L
'\0' && __wc <= L'\x7f'

396 ? (è
__wc
 : 
	`__wùob_®Ÿs
 (__wc)); 
	}
}

398 
__ex‹º_šlše
 
size_t


399 
__NTH
 (
	$mb¾’
 (cÚ¡ *
__»¡riù
 
__s
, 
size_t
 
__n
,

400 
mb¡©e_t
 *
__»¡riù
 
__ps
))

401 {  (
__ps
 !ğ
NULL


402 ? 
	`mb¹owc
 (
NULL
, 
__s
, 
__n
, 
__ps
è: 
	`__mb¾’
 (__s, __n, NULL)); 
	}
}

405 
__BEGIN_NAMESPACE_STD


408 
size_t
 
	$mb¤towcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

409 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

410 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

414 
size_t
 
	$wc¤tombs
 (*
__»¡riù
 
__d¡
,

415 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
, 
size_t
 
__Ën
,

416 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

417 
__END_NAMESPACE_STD


420 #ifdef 
__USE_XOPEN2K8


423 
size_t
 
	$mb¢¹owcs
 (
wch¬_t
 *
__»¡riù
 
__d¡
,

424 cÚ¡ **
__»¡riù
 
__¤c
, 
size_t
 
__nmc
,

425 
size_t
 
__Ën
, 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

429 
size_t
 
	$wc¢¹ombs
 (*
__»¡riù
 
__d¡
,

430 cÚ¡ 
wch¬_t
 **
__»¡riù
 
__¤c
,

431 
size_t
 
__nwc
, size_ˆ
__Ën
,

432 
mb¡©e_t
 *
__»¡riù
 
__ps
è
__THROW
;

437 #ifdeà
__USE_XOPEN


439 
	$wcwidth
 (
wch¬_t
 
__c
è
__THROW
;

443 
	$wcswidth
 (cÚ¡ 
wch¬_t
 *
__s
, 
size_t
 
__n
è
__THROW
;

447 
__BEGIN_NAMESPACE_STD


450 
	$wc¡od
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

451 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

452 
__END_NAMESPACE_STD


454 #ifdeà
__USE_ISOC99


455 
__BEGIN_NAMESPACE_C99


457 
	$wc¡of
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

458 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

459 
	$wc¡Şd
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

460 
wch¬_t
 **
__»¡riù
 
__’d±r
è
__THROW
;

461 
__END_NAMESPACE_C99


465 
__BEGIN_NAMESPACE_STD


468 
	$wc¡Ş
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

469 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
è
__THROW
;

473 
	$wc¡oul
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

474 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

475 
__THROW
;

476 
__END_NAMESPACE_STD


478 #ifdeà
__USE_ISOC99


479 
__BEGIN_NAMESPACE_C99


482 
__ex‹nsiÚ__


483 
	$wc¡Şl
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

484 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

485 
__THROW
;

489 
__ex‹nsiÚ__


490 
	$wc¡ouÎ
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

491 
wch¬_t
 **
__»¡riù
 
__’d±r
,

492 
__ba£
è
__THROW
;

493 
__END_NAMESPACE_C99


496 #ifdeà
__USE_GNU


499 
__ex‹nsiÚ__


500 
	$wc¡oq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

501 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
)

502 
__THROW
;

506 
__ex‹nsiÚ__


507 
	$wc¡ouq
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

508 
wch¬_t
 **
__»¡riù
 
__’d±r
,

509 
__ba£
è
__THROW
;

512 #ifdeà
__USE_GNU


526 
	~<xloÿË.h
>

530 
	$wc¡Ş_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

531 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__ba£
,

532 
__loÿË_t
 
__loc
è
__THROW
;

534 
	$wc¡oul_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

535 
wch¬_t
 **
__»¡riù
 
__’d±r
,

536 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

538 
__ex‹nsiÚ__


539 
	$wc¡Şl_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

540 
wch¬_t
 **
__»¡riù
 
__’d±r
,

541 
__ba£
, 
__loÿË_t
 
__loc
è
__THROW
;

543 
__ex‹nsiÚ__


544 
	$wc¡ouÎ_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

545 
wch¬_t
 **
__»¡riù
 
__’d±r
,

546 
__ba£
, 
__loÿË_t
 
__loc
)

547 
__THROW
;

549 
	$wc¡od_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

550 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

551 
__THROW
;

553 
	$wc¡of_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

554 
wch¬_t
 **
__»¡riù
 
__’d±r
, 
__loÿË_t
 
__loc
)

555 
__THROW
;

557 
	$wc¡Şd_l
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ÅŒ
,

558 
wch¬_t
 **
__»¡riù
 
__’d±r
,

559 
__loÿË_t
 
__loc
è
__THROW
;

563 #ifdeà
__USE_XOPEN2K8


566 
wch¬_t
 *
	$wııy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

567 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
è
__THROW
;

571 
wch¬_t
 *
	$wınıy
 (
wch¬_t
 *
__»¡riù
 
__de¡
,

572 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__¤c
, 
size_t
 
__n
)

573 
__THROW
;

580 
__FILE
 *
	$İ’_wmem¡»am
 (
wch¬_t
 **
__buæoc
, 
size_t
 *
__siz–oc
è
__THROW
;

583 #ià
defšed
 
__USE_ISOC95
 || defšed 
__USE_UNIX98


584 
__BEGIN_NAMESPACE_STD


587 
	$fwide
 (
__FILE
 *
__å
, 
__mode
è
__THROW
;

594 
	`fw´štf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

595 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

601 
	`w´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

604 
	$sw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

605 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

606 
__THROW
 ;

612 
	`vfw´štf
 (
__FILE
 *
__»¡riù
 
__s
,

613 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

614 
__gnuc_va_li¡
 
__¬g
)

620 
	`vw´štf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

621 
__gnuc_va_li¡
 
__¬g
)

625 
	$vsw´štf
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__n
,

626 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

627 
__gnuc_va_li¡
 
__¬g
)

628 
__THROW
 ;

635 
	`fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

636 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

642 
	`wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

645 
	$swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

646 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

647 
__THROW
 ;

649 #ià
defšed
 
__USE_ISOC99
 && !defšed 
__USE_GNU
 \

650 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

651 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

652 #ifdeà
__REDIRECT


656 
	`__REDIRECT
 (
fwsÿnf
, (
__FILE
 *
__»¡riù
 
__¡»am
,

657 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

658 
__isoc99_fwsÿnf
)

660 
	`__REDIRECT
 (
wsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...),

661 
__isoc99_wsÿnf
)

663 
	`__REDIRECT_NTH
 (
swsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

664 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

665 ...), 
__isoc99_swsÿnf
)

668 
	`__isoc99_fwsÿnf
 (
__FILE
 *
__»¡riù
 
__¡»am
,

669 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

670 
	`__isoc99_wsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...);

671 
	$__isoc99_swsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

672 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
, ...)

673 
__THROW
;

674 
	#fwsÿnf
 
__isoc99_fwsÿnf


	)

675 
	#wsÿnf
 
__isoc99_wsÿnf


	)

676 
	#swsÿnf
 
__isoc99_swsÿnf


	)

680 
__END_NAMESPACE_STD


683 #ifdeà
__USE_ISOC99


684 
__BEGIN_NAMESPACE_C99


689 
	`vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

690 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

691 
__gnuc_va_li¡
 
__¬g
)

697 
	`vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

698 
__gnuc_va_li¡
 
__¬g
)

701 
	$vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

702 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

703 
__gnuc_va_li¡
 
__¬g
)

704 
__THROW
 ;

706 #ià!
defšed
 
__USE_GNU
 \

707 && (!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT
) \

708 && (
defšed
 
__STRICT_ANSI__
 || defšed 
__USE_XOPEN2K
)

709 #ifdeà
__REDIRECT


710 
	`__REDIRECT
 (
vfwsÿnf
, (
__FILE
 *
__»¡riù
 
__s
,

711 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

712 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vfwsÿnf
)

714 
	`__REDIRECT
 (
vwsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

715 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vwsÿnf
)

717 
	`__REDIRECT_NTH
 (
vswsÿnf
, (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

718 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

719 
__gnuc_va_li¡
 
__¬g
), 
__isoc99_vswsÿnf
)

722 
	`__isoc99_vfwsÿnf
 (
__FILE
 *
__»¡riù
 
__s
,

723 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

724 
__gnuc_va_li¡
 
__¬g
);

725 
	`__isoc99_vwsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

726 
__gnuc_va_li¡
 
__¬g
);

727 
	$__isoc99_vswsÿnf
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__s
,

728 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

729 
__gnuc_va_li¡
 
__¬g
è
__THROW
;

730 
	#vfwsÿnf
 
__isoc99_vfwsÿnf


	)

731 
	#vwsÿnf
 
__isoc99_vwsÿnf


	)

732 
	#vswsÿnf
 
__isoc99_vswsÿnf


	)

736 
__END_NAMESPACE_C99


740 
__BEGIN_NAMESPACE_STD


745 
wšt_t
 
	`fg‘wc
 (
__FILE
 *
__¡»am
);

746 
wšt_t
 
	`g‘wc
 (
__FILE
 *
__¡»am
);

752 
wšt_t
 
	`g‘wch¬
 ();

759 
wšt_t
 
	`åutwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

760 
wšt_t
 
	`putwc
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

766 
wšt_t
 
	`putwch¬
 (
wch¬_t
 
__wc
);

774 
wch¬_t
 *
	`fg‘ws
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

775 
__FILE
 *
__»¡riù
 
__¡»am
);

781 
	`åutws
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

782 
__FILE
 *
__»¡riù
 
__¡»am
);

789 
wšt_t
 
	`ung‘wc
 (wšt_ˆ
__wc
, 
__FILE
 *
__¡»am
);

790 
__END_NAMESPACE_STD


793 #ifdeà
__USE_GNU


801 
wšt_t
 
	`g‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

802 
wšt_t
 
	`g‘wch¬_uÆocked
 ();

810 
wšt_t
 
	`fg‘wc_uÆocked
 (
__FILE
 *
__¡»am
);

818 
wšt_t
 
	`åutwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

827 
wšt_t
 
	`putwc_uÆocked
 (
wch¬_t
 
__wc
, 
__FILE
 *
__¡»am
);

828 
wšt_t
 
	`putwch¬_uÆocked
 (
wch¬_t
 
__wc
);

837 
wch¬_t
 *
	`fg‘ws_uÆocked
 (wch¬_ˆ*
__»¡riù
 
__ws
, 
__n
,

838 
__FILE
 *
__»¡riù
 
__¡»am
);

846 
	`åutws_uÆocked
 (cÚ¡ 
wch¬_t
 *
__»¡riù
 
__ws
,

847 
__FILE
 *
__»¡riù
 
__¡»am
);

851 
__BEGIN_NAMESPACE_C99


855 
size_t
 
	$wcsáime
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

856 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

857 cÚ¡ 
tm
 *
__»¡riù
 
__
è
__THROW
;

858 
__END_NAMESPACE_C99


860 #ifdeà
__USE_GNU


861 
	~<xloÿË.h
>

865 
size_t
 
	$wcsáime_l
 (
wch¬_t
 *
__»¡riù
 
__s
, 
size_t
 
__maxsize
,

866 cÚ¡ 
wch¬_t
 *
__»¡riù
 
__fÜm©
,

867 cÚ¡ 
tm
 *
__»¡riù
 
__
,

868 
__loÿË_t
 
__loc
è
__THROW
;

877 #ià
defšed
 
__USE_UNIX98
 && !defšed 
__USE_GNU


878 
	#__Ãed_iswxxx


	)

879 
	~<wùy³.h
>

883 #ià
__USE_FORTIFY_LEVEL
 > 0 && 
defšed
 
__fÜtify_funùiÚ


884 
	~<b™s/wch¬2.h
>

887 #ifdeà
__LDBL_COMPAT


888 
	~<b™s/wch¬-ldbl.h
>

891 
__END_DECLS


899 #undeà
__Ãed_mb¡©e_t


900 #undeà
__Ãed_wšt_t


	@/usr/include/wctype.h

23 #iâdeà
_WCTYPE_H


25 
	~<ã©u»s.h
>

26 
	~<b™s/ty³s.h
>

28 #iâdeà
__Ãed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__Ãed_wšt_t


	)

33 
	~<wch¬.h
>

37 #iâdeà
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #undeà
__Ãed_iswxxx


46 #iâdeà
__iswxxx_defšed


47 
	#__iswxxx_defšed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twùy³_t
;

53 
	g__END_NAMESPACE_C99


55 #iâdeà
_ISwb™


60 
	~<’dŸn.h
>

61 #ià
__BYTE_ORDER
 =ğ
__BIG_ENDIAN


62 
	#_ISwb™
(
b™
è(1 << (b™))

	)

64 
	#_ISwb™
(
b™
) \

65 ((
b™
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b™
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b™
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (è((1UL << (
b™
)è>> 24))))

	)

73 
	m__ISwuµ”
 = 0,

74 
	m__ISwlow”
 = 1,

75 
	m__ISw®pha
 = 2,

76 
	m__ISwdig™
 = 3,

77 
	m__ISwxdig™
 = 4,

78 
	m__ISw¥aû
 = 5,

79 
	m__ISw´št
 = 6,

80 
	m__ISwg¿ph
 = 7,

81 
	m__ISwbÏnk
 = 8,

82 
	m__ISwúŒl
 = 9,

83 
	m__ISwpunù
 = 10,

84 
	m__ISw®num
 = 11,

86 
	m_ISwuµ”
 = 
_ISwb™
 (
__ISwuµ”
),

87 
	m_ISwlow”
 = 
_ISwb™
 (
__ISwlow”
),

88 
	m_ISw®pha
 = 
_ISwb™
 (
__ISw®pha
),

89 
	m_ISwdig™
 = 
_ISwb™
 (
__ISwdig™
),

90 
	m_ISwxdig™
 = 
_ISwb™
 (
__ISwxdig™
),

91 
	m_ISw¥aû
 = 
_ISwb™
 (
__ISw¥aû
),

92 
	m_ISw´št
 = 
_ISwb™
 (
__ISw´št
),

93 
	m_ISwg¿ph
 = 
_ISwb™
 (
__ISwg¿ph
),

94 
	m_ISwbÏnk
 = 
_ISwb™
 (
__ISwbÏnk
),

95 
	m_ISwúŒl
 = 
_ISwb™
 (
__ISwúŒl
),

96 
	m_ISwpunù
 = 
_ISwb™
 (
__ISwpunù
),

97 
	m_ISw®num
 = 
_ISwb™
 (
__ISw®num
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$isw®num
 (
wšt_t
 
__wc
è
__THROW
;

117 
	$isw®pha
 (
wšt_t
 
__wc
è
__THROW
;

120 
	$iswúŒl
 (
wšt_t
 
__wc
è
__THROW
;

124 
	$iswdig™
 (
wšt_t
 
__wc
è
__THROW
;

128 
	$iswg¿ph
 (
wšt_t
 
__wc
è
__THROW
;

133 
	$iswlow”
 (
wšt_t
 
__wc
è
__THROW
;

136 
	$isw´št
 (
wšt_t
 
__wc
è
__THROW
;

141 
	$iswpunù
 (
wšt_t
 
__wc
è
__THROW
;

146 
	$isw¥aû
 (
wšt_t
 
__wc
è
__THROW
;

151 
	$iswuµ”
 (
wšt_t
 
__wc
è
__THROW
;

156 
	$iswxdig™
 (
wšt_t
 
__wc
è
__THROW
;

161 #ifdeà
__USE_ISOC99


162 
	$iswbÏnk
 (
wšt_t
 
__wc
è
__THROW
;

171 
wùy³_t
 
	$wùy³
 (cÚ¡ *
__´İ”ty
è
__THROW
;

175 
	$iswùy³
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
è
__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cÚ¡ 
	t__št32_t
 *
	twù¿ns_t
;

187 
__END_NAMESPACE_C99


188 #ifdeà
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wù¿ns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wšt_t
 
	$towlow”
 (
wšt_t
 
__wc
è
__THROW
;

197 
wšt_t
 
	$towuµ”
 (
wšt_t
 
__wc
è
__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifdeà
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wù¿ns_t
 
	$wù¿ns
 (cÚ¡ *
__´İ”ty
è
__THROW
;

221 
wšt_t
 
	$towù¿ns
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
è
__THROW
;

222 
__END_NAMESPACE_C99


224 #ifdeà
__USE_XOPEN2K8


226 
	~<xloÿË.h
>

230 
	$isw®num_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

236 
	$isw®pha_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

239 
	$iswúŒl_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

243 
	$iswdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

247 
	$iswg¿ph_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

252 
	$iswlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

255 
	$isw´št_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

260 
	$iswpunù_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

265 
	$isw¥aû_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

270 
	$iswuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

275 
	$iswxdig™_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

280 
	$iswbÏnk_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

284 
wùy³_t
 
	$wùy³_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

285 
__THROW
;

289 
	$iswùy³_l
 (
wšt_t
 
__wc
, 
wùy³_t
 
__desc
, 
__loÿË_t
 
__loÿË
)

290 
__THROW
;

298 
wšt_t
 
	$towlow”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

301 
wšt_t
 
	$towuµ”_l
 (
wšt_t
 
__wc
, 
__loÿË_t
 
__loÿË
è
__THROW
;

305 
wù¿ns_t
 
	$wù¿ns_l
 (cÚ¡ *
__´İ”ty
, 
__loÿË_t
 
__loÿË
)

306 
__THROW
;

309 
wšt_t
 
	$towù¿ns_l
 (
wšt_t
 
__wc
, 
wù¿ns_t
 
__desc
,

310 
__loÿË_t
 
__loÿË
è
__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
618
24017
code/iptable.c
code/iptable.h
code/main.c
code/network.c
code/network.h
code/nl.c
code/nl.h
get_eth0/interface.c
get_eth0/interface2.c
get_eth0/interface3.c
get_interface/interface.c
get_interface2/interface.c
get_interface3/getinterface.c
get_interface3/libtc/config.h
get_interface3/libtc/include/tc.h
get_interface3/libtc/include/tcalloc.h
get_interface3/libtc/include/tcbyteswap.h
get_interface3/libtc/include/tcconf.h
get_interface3/libtc/include/tcdirent.h
get_interface3/libtc/include/tcendian.h
get_interface3/libtc/include/tchash.h
get_interface3/libtc/include/tclist.h
get_interface3/libtc/include/tcmath.h
get_interface3/libtc/include/tcmempool.h
get_interface3/libtc/include/tcnet.h
get_interface3/libtc/include/tcprioq.h
get_interface3/libtc/include/tcstring.h
get_interface3/libtc/include/tctime.h
get_interface3/libtc/include/tctree.h
get_interface3/libtc/include/tctypes.h
get_interface3/libtc/src/alloc.c
get_interface3/libtc/src/conf-parse.c
get_interface3/libtc/src/conf-parse.l
get_interface3/libtc/src/conf.c
get_interface3/libtc/src/confdump.c
get_interface3/libtc/src/gethostaddr.c
get_interface3/libtc/src/gethostname.c
get_interface3/libtc/src/hash.c
get_interface3/libtc/src/list.c
get_interface3/libtc/src/math.c
get_interface3/libtc/src/mkpath.c
get_interface3/libtc/src/mpool.c
get_interface3/libtc/src/pathfind.c
get_interface3/libtc/src/prioq.c
get_interface3/libtc/src/regex.c
get_interface3/libtc/src/snprintf.c
get_interface3/libtc/src/string.c
get_interface3/libtc/src/strsep.c
get_interface3/libtc/src/strtotime.c
get_interface3/libtc/src/tcc-internal.h
get_interface3/libtc/src/tree.c
get_link/main.c
get_link/nl.c
get_link/nl.h
getaddr/getaddr.c
interface/net-tools/arp.c
interface/net-tools/config.h
interface/net-tools/hostname.c
interface/net-tools/ifconfig.c
interface/net-tools/include/interface.h
interface/net-tools/include/ipx.h
interface/net-tools/include/mii.h
interface/net-tools/include/sockets.h
interface/net-tools/include/util-ank.h
interface/net-tools/intl.h
interface/net-tools/ipmaddr.c
interface/net-tools/iptunnel.c
interface/net-tools/lib/activate.c
interface/net-tools/lib/af.c
interface/net-tools/lib/arcnet.c
interface/net-tools/lib/ash.c
interface/net-tools/lib/ax25.c
interface/net-tools/lib/ax25_gr.c
interface/net-tools/lib/ddp.c
interface/net-tools/lib/ddp_gr.c
interface/net-tools/lib/ec_hw.c
interface/net-tools/lib/econet.c
interface/net-tools/lib/ether.c
interface/net-tools/lib/eui64.c
interface/net-tools/lib/fddi.c
interface/net-tools/lib/frame.c
interface/net-tools/lib/getargs.c
interface/net-tools/lib/getroute.c
interface/net-tools/lib/hdlclapb.c
interface/net-tools/lib/hippi.c
interface/net-tools/lib/hw.c
interface/net-tools/lib/ib.c
interface/net-tools/lib/inet.c
interface/net-tools/lib/inet6.c
interface/net-tools/lib/inet6_gr.c
interface/net-tools/lib/inet6_sr.c
interface/net-tools/lib/inet_gr.c
interface/net-tools/lib/inet_sr.c
interface/net-tools/lib/interface.c
interface/net-tools/lib/ipx.c
interface/net-tools/lib/ipx_gr.c
interface/net-tools/lib/ipx_sr.c
interface/net-tools/lib/irda.c
interface/net-tools/lib/loopback.c
interface/net-tools/lib/masq_info.c
interface/net-tools/lib/net-features.h
interface/net-tools/lib/net-support.h
interface/net-tools/lib/netrom.c
interface/net-tools/lib/netrom_gr.c
interface/net-tools/lib/netrom_sr.c
interface/net-tools/lib/nstrcmp.c
interface/net-tools/lib/pathnames.h
interface/net-tools/lib/ppp.c
interface/net-tools/lib/ppp_ac.c
interface/net-tools/lib/proc.c
interface/net-tools/lib/proc.h
interface/net-tools/lib/rose.c
interface/net-tools/lib/rose_gr.c
interface/net-tools/lib/setroute.c
interface/net-tools/lib/sit.c
interface/net-tools/lib/slip.c
interface/net-tools/lib/slip_ac.c
interface/net-tools/lib/sockets.c
interface/net-tools/lib/strip.c
interface/net-tools/lib/tr.c
interface/net-tools/lib/tunnel.c
interface/net-tools/lib/unix.c
interface/net-tools/lib/util-ank.c
interface/net-tools/lib/util.c
interface/net-tools/lib/util.h
interface/net-tools/lib/x25.c
interface/net-tools/lib/x25_gr.c
interface/net-tools/lib/x25_sr.c
interface/net-tools/mii-tool.c
interface/net-tools/nameif.c
interface/net-tools/netstat.c
interface/net-tools/plipconfig.c
interface/net-tools/rarp.c
interface/net-tools/route.c
interface/net-tools/slattach.c
interface/net-tools/statistics.c
interface/net-tools/version.h
libnl/example_c/interface.c
libnl/example_c/scan_access_points.c
libnl/example_c/show_wifi_interface.c
mylibnl/libnl-3.2.25/include/linux/can/netlink.h
mylibnl/libnl-3.2.25/include/linux/fib_rules.h
mylibnl/libnl-3.2.25/include/linux/gen_stats.h
mylibnl/libnl-3.2.25/include/linux/genetlink.h
mylibnl/libnl-3.2.25/include/linux/if.h
mylibnl/libnl-3.2.25/include/linux/if_addr.h
mylibnl/libnl-3.2.25/include/linux/if_arp.h
mylibnl/libnl-3.2.25/include/linux/if_bridge.h
mylibnl/libnl-3.2.25/include/linux/if_ether.h
mylibnl/libnl-3.2.25/include/linux/if_link.h
mylibnl/libnl-3.2.25/include/linux/if_tunnel.h
mylibnl/libnl-3.2.25/include/linux/if_vlan.h
mylibnl/libnl-3.2.25/include/linux/ip.h
mylibnl/libnl-3.2.25/include/linux/ip_mp_alg.h
mylibnl/libnl-3.2.25/include/linux/ipv6.h
mylibnl/libnl-3.2.25/include/linux/neighbour.h
mylibnl/libnl-3.2.25/include/linux/netfilter.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nf_conntrack_common.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_compat.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_conntrack.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_log.h
mylibnl/libnl-3.2.25/include/linux/netfilter/nfnetlink_queue.h
mylibnl/libnl-3.2.25/include/linux/netlink.h
mylibnl/libnl-3.2.25/include/linux/pkt_cls.h
mylibnl/libnl-3.2.25/include/linux/pkt_sched.h
mylibnl/libnl-3.2.25/include/linux/rtnetlink.h
mylibnl/libnl-3.2.25/include/linux/snmp.h
mylibnl/libnl-3.2.25/include/linux/tc_act/tc_mirred.h
mylibnl/libnl-3.2.25/include/linux/tc_ematch/tc_em_meta.h
mylibnl/libnl-3.2.25/include/netlink-private/cache-api.h
mylibnl/libnl-3.2.25/include/netlink-private/genl.h
mylibnl/libnl-3.2.25/include/netlink-private/netlink.h
mylibnl/libnl-3.2.25/include/netlink-private/object-api.h
mylibnl/libnl-3.2.25/include/netlink-private/route/link/api.h
mylibnl/libnl-3.2.25/include/netlink-private/route/tc-api.h
mylibnl/libnl-3.2.25/include/netlink-private/socket.h
mylibnl/libnl-3.2.25/include/netlink-private/tc.h
mylibnl/libnl-3.2.25/include/netlink-private/types.h
mylibnl/libnl-3.2.25/include/netlink/addr.h
mylibnl/libnl-3.2.25/include/netlink/attr.h
mylibnl/libnl-3.2.25/include/netlink/cache-api.h
mylibnl/libnl-3.2.25/include/netlink/cache.h
mylibnl/libnl-3.2.25/include/netlink/cli/addr.h
mylibnl/libnl-3.2.25/include/netlink/cli/class.h
mylibnl/libnl-3.2.25/include/netlink/cli/cls.h
mylibnl/libnl-3.2.25/include/netlink/cli/ct.h
mylibnl/libnl-3.2.25/include/netlink/cli/exp.h
mylibnl/libnl-3.2.25/include/netlink/cli/link.h
mylibnl/libnl-3.2.25/include/netlink/cli/neigh.h
mylibnl/libnl-3.2.25/include/netlink/cli/qdisc.h
mylibnl/libnl-3.2.25/include/netlink/cli/route.h
mylibnl/libnl-3.2.25/include/netlink/cli/rule.h
mylibnl/libnl-3.2.25/include/netlink/cli/tc.h
mylibnl/libnl-3.2.25/include/netlink/cli/utils.h
mylibnl/libnl-3.2.25/include/netlink/data.h
mylibnl/libnl-3.2.25/include/netlink/errno.h
mylibnl/libnl-3.2.25/include/netlink/fib_lookup/lookup.h
mylibnl/libnl-3.2.25/include/netlink/fib_lookup/request.h
mylibnl/libnl-3.2.25/include/netlink/genl/ctrl.h
mylibnl/libnl-3.2.25/include/netlink/genl/family.h
mylibnl/libnl-3.2.25/include/netlink/genl/genl.h
mylibnl/libnl-3.2.25/include/netlink/genl/mngt.h
mylibnl/libnl-3.2.25/include/netlink/handlers.h
mylibnl/libnl-3.2.25/include/netlink/hash.h
mylibnl/libnl-3.2.25/include/netlink/hashtable.h
mylibnl/libnl-3.2.25/include/netlink/idiag/idiagnl.h
mylibnl/libnl-3.2.25/include/netlink/idiag/meminfo.h
mylibnl/libnl-3.2.25/include/netlink/idiag/msg.h
mylibnl/libnl-3.2.25/include/netlink/idiag/req.h
mylibnl/libnl-3.2.25/include/netlink/idiag/vegasinfo.h
mylibnl/libnl-3.2.25/include/netlink/list.h
mylibnl/libnl-3.2.25/include/netlink/msg.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/ct.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/exp.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/log.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/log_msg.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/netfilter.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/nfnl.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/queue.h
mylibnl/libnl-3.2.25/include/netlink/netfilter/queue_msg.h
mylibnl/libnl-3.2.25/include/netlink/netlink-compat.h
mylibnl/libnl-3.2.25/include/netlink/netlink-kernel.h
mylibnl/libnl-3.2.25/include/netlink/netlink.h
mylibnl/libnl-3.2.25/include/netlink/object-api.h
mylibnl/libnl-3.2.25/include/netlink/object.h
mylibnl/libnl-3.2.25/include/netlink/route/act/mirred.h
mylibnl/libnl-3.2.25/include/netlink/route/action.h
mylibnl/libnl-3.2.25/include/netlink/route/addr.h
mylibnl/libnl-3.2.25/include/netlink/route/class.h
mylibnl/libnl-3.2.25/include/netlink/route/classifier.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/basic.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/cgroup.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/cmp.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/meta.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/nbyte.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/ematch/text.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/fw.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/police.h
mylibnl/libnl-3.2.25/include/netlink/route/cls/u32.h
mylibnl/libnl-3.2.25/include/netlink/route/link.h
mylibnl/libnl-3.2.25/include/netlink/route/link/api.h
mylibnl/libnl-3.2.25/include/netlink/route/link/bonding.h
mylibnl/libnl-3.2.25/include/netlink/route/link/bridge.h
mylibnl/libnl-3.2.25/include/netlink/route/link/can.h
mylibnl/libnl-3.2.25/include/netlink/route/link/inet.h
mylibnl/libnl-3.2.25/include/netlink/route/link/info-api.h
mylibnl/libnl-3.2.25/include/netlink/route/link/ip6tnl.h
mylibnl/libnl-3.2.25/include/netlink/route/link/ipgre.h
mylibnl/libnl-3.2.25/include/netlink/route/link/ipip.h
mylibnl/libnl-3.2.25/include/netlink/route/link/ipvti.h
mylibnl/libnl-3.2.25/include/netlink/route/link/macvlan.h
mylibnl/libnl-3.2.25/include/netlink/route/link/sit.h
mylibnl/libnl-3.2.25/include/netlink/route/link/veth.h
mylibnl/libnl-3.2.25/include/netlink/route/link/vlan.h
mylibnl/libnl-3.2.25/include/netlink/route/link/vxlan.h
mylibnl/libnl-3.2.25/include/netlink/route/neighbour.h
mylibnl/libnl-3.2.25/include/netlink/route/neightbl.h
mylibnl/libnl-3.2.25/include/netlink/route/nexthop.h
mylibnl/libnl-3.2.25/include/netlink/route/pktloc.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/cbq.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/dsmark.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/fifo.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/fq_codel.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/htb.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/netem.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/plug.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/prio.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/red.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/sfq.h
mylibnl/libnl-3.2.25/include/netlink/route/qdisc/tbf.h
mylibnl/libnl-3.2.25/include/netlink/route/route.h
mylibnl/libnl-3.2.25/include/netlink/route/rtnl.h
mylibnl/libnl-3.2.25/include/netlink/route/rule.h
mylibnl/libnl-3.2.25/include/netlink/route/tc-api.h
mylibnl/libnl-3.2.25/include/netlink/route/tc.h
mylibnl/libnl-3.2.25/include/netlink/socket.h
mylibnl/libnl-3.2.25/include/netlink/types.h
mylibnl/libnl-3.2.25/include/netlink/utils.h
mylibnl/libnl-3.2.25/include/netlink/version.h
mylibnl/libnl-3.2.25/lib/addr.c
mylibnl/libnl-3.2.25/lib/attr.c
mylibnl/libnl-3.2.25/lib/cache.c
mylibnl/libnl-3.2.25/lib/cache_mngr.c
mylibnl/libnl-3.2.25/lib/cache_mngt.c
mylibnl/libnl-3.2.25/lib/cli/cls/basic.c
mylibnl/libnl-3.2.25/lib/cli/cls/cgroup.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/bfifo.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/blackhole.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/fq_codel.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/htb.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/ingress.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/pfifo.c
mylibnl/libnl-3.2.25/lib/cli/qdisc/plug.c
mylibnl/libnl-3.2.25/lib/data.c
mylibnl/libnl-3.2.25/lib/defs.h
mylibnl/libnl-3.2.25/lib/error.c
mylibnl/libnl-3.2.25/lib/fib_lookup/lookup.c
mylibnl/libnl-3.2.25/lib/fib_lookup/request.c
mylibnl/libnl-3.2.25/lib/genl/ctrl.c
mylibnl/libnl-3.2.25/lib/genl/family.c
mylibnl/libnl-3.2.25/lib/genl/genl.c
mylibnl/libnl-3.2.25/lib/genl/mngt.c
mylibnl/libnl-3.2.25/lib/handlers.c
mylibnl/libnl-3.2.25/lib/hash.c
mylibnl/libnl-3.2.25/lib/hashtable.c
mylibnl/libnl-3.2.25/lib/idiag/idiag.c
mylibnl/libnl-3.2.25/lib/idiag/idiag_meminfo_obj.c
mylibnl/libnl-3.2.25/lib/idiag/idiag_msg_obj.c
mylibnl/libnl-3.2.25/lib/idiag/idiag_req_obj.c
mylibnl/libnl-3.2.25/lib/idiag/idiag_vegasinfo_obj.c
mylibnl/libnl-3.2.25/lib/msg.c
mylibnl/libnl-3.2.25/lib/netfilter/ct.c
mylibnl/libnl-3.2.25/lib/netfilter/ct_obj.c
mylibnl/libnl-3.2.25/lib/netfilter/exp.c
mylibnl/libnl-3.2.25/lib/netfilter/exp_obj.c
mylibnl/libnl-3.2.25/lib/netfilter/log.c
mylibnl/libnl-3.2.25/lib/netfilter/log_msg.c
mylibnl/libnl-3.2.25/lib/netfilter/log_msg_obj.c
mylibnl/libnl-3.2.25/lib/netfilter/log_obj.c
mylibnl/libnl-3.2.25/lib/netfilter/netfilter.c
mylibnl/libnl-3.2.25/lib/netfilter/nfnl.c
mylibnl/libnl-3.2.25/lib/netfilter/queue.c
mylibnl/libnl-3.2.25/lib/netfilter/queue_msg.c
mylibnl/libnl-3.2.25/lib/netfilter/queue_msg_obj.c
mylibnl/libnl-3.2.25/lib/netfilter/queue_obj.c
mylibnl/libnl-3.2.25/lib/nl.c
mylibnl/libnl-3.2.25/lib/object.c
mylibnl/libnl-3.2.25/lib/route/act.c
mylibnl/libnl-3.2.25/lib/route/act/mirred.c
mylibnl/libnl-3.2.25/lib/route/addr.c
mylibnl/libnl-3.2.25/lib/route/class.c
mylibnl/libnl-3.2.25/lib/route/classid.c
mylibnl/libnl-3.2.25/lib/route/cls.c
mylibnl/libnl-3.2.25/lib/route/cls/basic.c
mylibnl/libnl-3.2.25/lib/route/cls/cgroup.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch/cmp.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch/container.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch/meta.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch/nbyte.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch/text.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.h
mylibnl/libnl-3.2.25/lib/route/cls/ematch_grammar.l
mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.c
mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.h
mylibnl/libnl-3.2.25/lib/route/cls/ematch_syntax.y
mylibnl/libnl-3.2.25/lib/route/cls/fw.c
mylibnl/libnl-3.2.25/lib/route/cls/police.c
mylibnl/libnl-3.2.25/lib/route/cls/u32.c
mylibnl/libnl-3.2.25/lib/route/link.c
mylibnl/libnl-3.2.25/lib/route/link/api.c
mylibnl/libnl-3.2.25/lib/route/link/bonding.c
mylibnl/libnl-3.2.25/lib/route/link/bridge.c
mylibnl/libnl-3.2.25/lib/route/link/can.c
mylibnl/libnl-3.2.25/lib/route/link/dummy.c
mylibnl/libnl-3.2.25/lib/route/link/inet.c
mylibnl/libnl-3.2.25/lib/route/link/inet6.c
mylibnl/libnl-3.2.25/lib/route/link/ip6tnl.c
mylibnl/libnl-3.2.25/lib/route/link/ipgre.c
mylibnl/libnl-3.2.25/lib/route/link/ipip.c
mylibnl/libnl-3.2.25/lib/route/link/ipvti.c
mylibnl/libnl-3.2.25/lib/route/link/macvlan.c
mylibnl/libnl-3.2.25/lib/route/link/sit.c
mylibnl/libnl-3.2.25/lib/route/link/veth.c
mylibnl/libnl-3.2.25/lib/route/link/vlan.c
mylibnl/libnl-3.2.25/lib/route/link/vxlan.c
mylibnl/libnl-3.2.25/lib/route/neigh.c
mylibnl/libnl-3.2.25/lib/route/neightbl.c
mylibnl/libnl-3.2.25/lib/route/nexthop.c
mylibnl/libnl-3.2.25/lib/route/pktloc.c
mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.c
mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.h
mylibnl/libnl-3.2.25/lib/route/pktloc_grammar.l
mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.c
mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.h
mylibnl/libnl-3.2.25/lib/route/pktloc_syntax.y
mylibnl/libnl-3.2.25/lib/route/qdisc.c
mylibnl/libnl-3.2.25/lib/route/qdisc/blackhole.c
mylibnl/libnl-3.2.25/lib/route/qdisc/cbq.c
mylibnl/libnl-3.2.25/lib/route/qdisc/dsmark.c
mylibnl/libnl-3.2.25/lib/route/qdisc/fifo.c
mylibnl/libnl-3.2.25/lib/route/qdisc/fq_codel.c
mylibnl/libnl-3.2.25/lib/route/qdisc/htb.c
mylibnl/libnl-3.2.25/lib/route/qdisc/ingress.c
mylibnl/libnl-3.2.25/lib/route/qdisc/netem.c
mylibnl/libnl-3.2.25/lib/route/qdisc/plug.c
mylibnl/libnl-3.2.25/lib/route/qdisc/prio.c
mylibnl/libnl-3.2.25/lib/route/qdisc/red.c
mylibnl/libnl-3.2.25/lib/route/qdisc/sfq.c
mylibnl/libnl-3.2.25/lib/route/qdisc/tbf.c
mylibnl/libnl-3.2.25/lib/route/route.c
mylibnl/libnl-3.2.25/lib/route/route_obj.c
mylibnl/libnl-3.2.25/lib/route/route_utils.c
mylibnl/libnl-3.2.25/lib/route/rtnl.c
mylibnl/libnl-3.2.25/lib/route/rule.c
mylibnl/libnl-3.2.25/lib/route/tc.c
mylibnl/libnl-3.2.25/lib/socket.c
mylibnl/libnl-3.2.25/lib/utils.c
mylibnl/libnl-3.2.25/lib/version.c
mylibnl/libnl-3.2.25/python/netlink/fixes.h
mylibnl/libnl-3.2.25/python/netlink/utils.h
mylibnl/libnl-3.2.25/src/genl-ctrl-list.c
mylibnl/libnl-3.2.25/src/idiag-socket-details.c
mylibnl/libnl-3.2.25/src/lib/addr.c
mylibnl/libnl-3.2.25/src/lib/class.c
mylibnl/libnl-3.2.25/src/lib/cls.c
mylibnl/libnl-3.2.25/src/lib/ct.c
mylibnl/libnl-3.2.25/src/lib/exp.c
mylibnl/libnl-3.2.25/src/lib/link.c
mylibnl/libnl-3.2.25/src/lib/neigh.c
mylibnl/libnl-3.2.25/src/lib/qdisc.c
mylibnl/libnl-3.2.25/src/lib/route.c
mylibnl/libnl-3.2.25/src/lib/rule.c
mylibnl/libnl-3.2.25/src/lib/tc.c
mylibnl/libnl-3.2.25/src/lib/utils.c
mylibnl/libnl-3.2.25/src/nf-ct-add.c
mylibnl/libnl-3.2.25/src/nf-ct-list.c
mylibnl/libnl-3.2.25/src/nf-exp-add.c
mylibnl/libnl-3.2.25/src/nf-exp-delete.c
mylibnl/libnl-3.2.25/src/nf-exp-list.c
mylibnl/libnl-3.2.25/src/nf-log.c
mylibnl/libnl-3.2.25/src/nf-monitor.c
mylibnl/libnl-3.2.25/src/nf-queue.c
mylibnl/libnl-3.2.25/src/nl-addr-add.c
mylibnl/libnl-3.2.25/src/nl-addr-delete.c
mylibnl/libnl-3.2.25/src/nl-addr-list.c
mylibnl/libnl-3.2.25/src/nl-class-add.c
mylibnl/libnl-3.2.25/src/nl-class-delete.c
mylibnl/libnl-3.2.25/src/nl-class-list.c
mylibnl/libnl-3.2.25/src/nl-classid-lookup.c
mylibnl/libnl-3.2.25/src/nl-cls-add.c
mylibnl/libnl-3.2.25/src/nl-cls-delete.c
mylibnl/libnl-3.2.25/src/nl-cls-list.c
mylibnl/libnl-3.2.25/src/nl-fib-lookup.c
mylibnl/libnl-3.2.25/src/nl-link-enslave.c
mylibnl/libnl-3.2.25/src/nl-link-ifindex2name.c
mylibnl/libnl-3.2.25/src/nl-link-list.c
mylibnl/libnl-3.2.25/src/nl-link-name2ifindex.c
mylibnl/libnl-3.2.25/src/nl-link-release.c
mylibnl/libnl-3.2.25/src/nl-link-set.c
mylibnl/libnl-3.2.25/src/nl-link-stats.c
mylibnl/libnl-3.2.25/src/nl-list-caches.c
mylibnl/libnl-3.2.25/src/nl-list-sockets.c
mylibnl/libnl-3.2.25/src/nl-monitor.c
mylibnl/libnl-3.2.25/src/nl-neigh-add.c
mylibnl/libnl-3.2.25/src/nl-neigh-delete.c
mylibnl/libnl-3.2.25/src/nl-neigh-list.c
mylibnl/libnl-3.2.25/src/nl-neightbl-list.c
mylibnl/libnl-3.2.25/src/nl-pktloc-lookup.c
mylibnl/libnl-3.2.25/src/nl-qdisc-add.c
mylibnl/libnl-3.2.25/src/nl-qdisc-delete.c
mylibnl/libnl-3.2.25/src/nl-qdisc-list.c
mylibnl/libnl-3.2.25/src/nl-route-add.c
mylibnl/libnl-3.2.25/src/nl-route-delete.c
mylibnl/libnl-3.2.25/src/nl-route-get.c
mylibnl/libnl-3.2.25/src/nl-route-list.c
mylibnl/libnl-3.2.25/src/nl-rule-list.c
mylibnl/libnl-3.2.25/src/nl-tctree-list.c
mylibnl/libnl-3.2.25/src/nl-util-addr.c
mylibnl/libnl-3.2.25/tests/check-addr.c
mylibnl/libnl-3.2.25/tests/check-all.c
mylibnl/libnl-3.2.25/tests/check-attr.c
mylibnl/libnl-3.2.25/tests/test-cache-mngr.c
mylibnl/libnl-3.2.25/tests/test-complex-HTB-with-hash-filters.c
mylibnl/libnl-3.2.25/tests/test-create-bond.c
mylibnl/libnl-3.2.25/tests/test-create-bridge.c
mylibnl/libnl-3.2.25/tests/test-create-ip6tnl.c
mylibnl/libnl-3.2.25/tests/test-create-ipgre.c
mylibnl/libnl-3.2.25/tests/test-create-ipip.c
mylibnl/libnl-3.2.25/tests/test-create-ipvti.c
mylibnl/libnl-3.2.25/tests/test-create-sit.c
mylibnl/libnl-3.2.25/tests/test-create-veth.c
mylibnl/libnl-3.2.25/tests/test-create-vlan.c
mylibnl/libnl-3.2.25/tests/test-create-vxlan.c
mylibnl/libnl-3.2.25/tests/test-delete-link.c
mylibnl/libnl-3.2.25/tests/test-genl.c
mylibnl/libnl-3.2.25/tests/test-nf-cache-mngr.c
mylibnl/libnl-3.2.25/tests/test-socket-creation.c
mylibnl/libnl-3.2.25/tests/test-u32-filter-with-actions.c
mylibnl/libnl-3.2.25/tests/util.h
net_interface/interface.c
net_interface/interface.h
net_interface/main.c
net_interface/process_manager.h
net_space/net_space.c
route.c
server/network.c
server/queue.h
server/server.c
/usr/include/alloca.h
/usr/include/arpa/inet.h
/usr/include/arpa/nameser.h
/usr/include/assert.h
/usr/include/byteswap.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/dlfcn.h
/usr/include/endian.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/features.h
/usr/include/fnmatch.h
/usr/include/getopt.h
/usr/include/ifaddrs.h
/usr/include/inttypes.h
/usr/include/libintl.h
/usr/include/limits.h
/usr/include/linux/atalk.h
/usr/include/linux/atm.h
/usr/include/linux/ax25.h
/usr/include/linux/can/netlink.h
/usr/include/linux/ethtool.h
/usr/include/linux/fib_rules.h
/usr/include/linux/gen_stats.h
/usr/include/linux/genetlink.h
/usr/include/linux/if.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_arp.h
/usr/include/linux/if_bridge.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_fddi.h
/usr/include/linux/if_infiniband.h
/usr/include/linux/if_link.h
/usr/include/linux/if_plip.h
/usr/include/linux/if_slip.h
/usr/include/linux/if_tunnel.h
/usr/include/linux/if_vlan.h
/usr/include/linux/in_route.h
/usr/include/linux/inet_diag.h
/usr/include/linux/ip.h
/usr/include/linux/ipv6.h
/usr/include/linux/neighbour.h
/usr/include/linux/netdevice.h
/usr/include/linux/netfilter.h
/usr/include/linux/netfilter/nf_conntrack_common.h
/usr/include/linux/netfilter/nf_conntrack_tcp.h
/usr/include/linux/netfilter/nfnetlink.h
/usr/include/linux/netfilter/nfnetlink_compat.h
/usr/include/linux/netfilter/nfnetlink_conntrack.h
/usr/include/linux/netfilter/nfnetlink_log.h
/usr/include/linux/netfilter/nfnetlink_queue.h
/usr/include/linux/netlink.h
/usr/include/linux/nl80211.h
/usr/include/linux/param.h
/usr/include/linux/pkt_cls.h
/usr/include/linux/pkt_sched.h
/usr/include/linux/rose.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/snmp.h
/usr/include/linux/socket.h
/usr/include/linux/sockios.h
/usr/include/linux/taskstats.h
/usr/include/linux/tc_act/tc_mirred.h
/usr/include/linux/tc_ematch/tc_em_cmp.h
/usr/include/linux/tc_ematch/tc_em_meta.h
/usr/include/linux/tc_ematch/tc_em_nbyte.h
/usr/include/linux/tc_ematch/tc_em_text.h
/usr/include/linux/types.h
/usr/include/linux/version.h
/usr/include/linux/x25.h
/usr/include/locale.h
/usr/include/malloc.h
/usr/include/math.h
/usr/include/net/ethernet.h
/usr/include/net/if.h
/usr/include/net/if_arp.h
/usr/include/net/route.h
/usr/include/netax25/ax25.h
/usr/include/netdb.h
/usr/include/neteconet/ec.h
/usr/include/netinet/if_fddi.h
/usr/include/netinet/in.h
/usr/include/netinet/ip.h
/usr/include/netinet/tcp.h
/usr/include/netipx/ipx.h
/usr/include/paths.h
/usr/include/pthread.h
/usr/include/pwd.h
/usr/include/regex.h
/usr/include/resolv.h
/usr/include/sched.h
/usr/include/search.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/syslog.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/arpa/nameser_compat.h
/usr/include/libio.h
/usr/include/linux/atmapi.h
/usr/include/linux/atmioc.h
/usr/include/linux/atmsap.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/if_packet.h
/usr/include/linux/in.h
/usr/include/linux/in6.h
/usr/include/linux/kernel.h
/usr/include/linux/libc-compat.h
/usr/include/linux/posix_types.h
/usr/include/linux/sysctl.h
/usr/include/rpc/netdb.h
/usr/include/stdc-predef.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/linux/stddef.h
/usr/include/linux/sysinfo.h
/usr/include/gconv.h
/usr/include/wchar.h
/usr/include/wctype.h
